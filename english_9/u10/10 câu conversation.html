<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Ms Mai An ULIS - Speaking Practice</title>
    <link href="https://fonts.googleapis.com/css2?family=Nunito:wght@400;600;700;800&family=Quicksand:wght@500;700&display=swap" rel="stylesheet">
    <style>
        :root {
            --primary-color: #8854C0; /* T√≠m h·ªìng nh·∫°t */
            --secondary-color: #00C9A7; /* Xanh ng·ªçc */
            --correct-color: #00D26A; /* Xanh l√° */
            --wrong-color: #FF4757; /* ƒê·ªè cam */
            --bg-pattern: #f0f3f9;
            --text-color: #2c3e50;
            --card-bg: #ffffff;
        }

        body {
            font-family: 'Nunito', sans-serif;
            background-color: var(--bg-pattern);
            background-image: radial-gradient(#dbe0ea 15%, transparent 16%), radial-gradient(#dbe0ea 15%, transparent 16%);
            background-size: 20px 20px;
            background-position: 0 0, 10px 10px;
            margin: 0;
            padding: 20px;
            color: var(--text-color);
            min-height: 100vh;
        }

        /* Header Styles */
        header {
            text-align: center;
            margin-bottom: 30px;
            background: white;
            padding: 20px;
            border-radius: 20px;
            box-shadow: 0 8px 0 rgba(0,0,0,0.1);
            position: relative;
            overflow: hidden;
            border: 2px solid var(--primary-color);
        }

        h1 {
            color: var(--primary-color);
            margin: 0;
            font-weight: 800;
            font-size: 2rem;
            text-transform: uppercase;
            letter-spacing: 1px;
        }

        .subtitle {
            color: #666;
            font-size: 1.1rem;
            margin-top: 5px;
            font-family: 'Quicksand', sans-serif;
        }

        /* Score Board */
        .score-board {
            position: fixed;
            top: 20px;
            right: 20px;
            background: var(--secondary-color);
            color: white;
            padding: 10px 20px;
            border-radius: 50px;
            font-weight: 800;
            box-shadow: 0 4px 0 #008f7a;
            z-index: 100;
            display: flex;
            align-items: center;
            gap: 10px;
            animation: bounceIn 0.5s;
        }

        /* Quiz Container */
        .quiz-container {
            max-width: 900px;
            margin: 0 auto;
            padding-bottom: 80px;
        }

        /* Question Card */
        .question-card {
            background: var(--card-bg);
            border-radius: 20px;
            padding: 30px;
            margin-bottom: 40px;
            box-shadow: 0 10px 20px rgba(0,0,0,0.05);
            border-bottom: 6px solid #e0e0e0;
            transition: transform 0.3s;
            position: relative;
        }

        .question-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 20px;
            border-bottom: 2px dashed #eee;
            padding-bottom: 10px;
        }

        .q-tag {
            background: var(--primary-color);
            color: white;
            padding: 5px 15px;
            border-radius: 15px;
            font-weight: 700;
            font-size: 0.9rem;
        }

        .question-text {
            font-size: 1.25rem;
            font-weight: 700;
            line-height: 1.6;
            color: #333;
            margin-bottom: 25px;
            white-space: pre-line; /* Gi·ªØ xu·ªëng d√≤ng c·ªßa ƒë·ªÅ g·ªëc */
        }

        /* Options Grid */
        .options-grid {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 15px;
        }

        @media (max-width: 600px) {
            .options-grid {
                grid-template-columns: 1fr;
            }
        }

        .option-btn {
            background: white;
            border: 2px solid #e0e0e0;
            padding: 15px 20px;
            border-radius: 15px;
            font-family: 'Nunito', sans-serif;
            font-size: 1rem;
            font-weight: 600;
            color: #555;
            cursor: pointer;
            transition: all 0.2s;
            text-align: left;
            position: relative;
            box-shadow: 0 4px 0 #ccc;
            display: flex;
            align-items: center;
        }

        .option-btn:hover:not(.disabled) {
            transform: scale(1.02);
            border-color: var(--primary-color);
            color: var(--primary-color);
        }

        .option-btn:active:not(.disabled) {
            transform: translateY(4px);
            box-shadow: none;
        }

        .option-letter {
            background: #eee;
            width: 30px;
            height: 30px;
            display: flex;
            align-items: center;
            justify-content: center;
            border-radius: 50%;
            margin-right: 10px;
            font-weight: 800;
            flex-shrink: 0;
        }

        /* States */
        .option-btn.correct {
            background-color: var(--correct-color);
            color: white;
            border-color: #00a855;
            box-shadow: 0 4px 0 #008f47;
        }
        .option-btn.correct .option-letter {
            background: rgba(255,255,255,0.3);
            color: white;
        }

        .option-btn.wrong {
            background-color: var(--wrong-color);
            color: white;
            border-color: #d63030;
            box-shadow: 0 4px 0 #b32424;
            animation: shake 0.5s;
        }
        .option-btn.wrong .option-letter {
            background: rgba(255,255,255,0.3);
            color: white;
        }

        .option-btn.disabled {
            cursor: default;
            pointer-events: none;
            opacity: 0.7;
        }

        /* Explanation Box */
        .explanation-box {
            margin-top: 25px;
            background: #f8f9fa;
            border: 2px solid var(--secondary-color);
            border-radius: 15px;
            padding: 20px;
            display: none; /* Hidden initially */
            animation: slideDown 0.4s ease-out;
        }

        .explanation-box.show {
            display: block;
        }

        .exp-header {
            color: var(--secondary-color);
            font-weight: 800;
            margin-bottom: 10px;
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .exp-content {
            font-size: 0.95rem;
            line-height: 1.6;
        }

        .exp-content p {
            margin: 5px 0;
        }

        .exp-highlight {
            font-weight: 700;
            color: #d63031;
        }
        
        .exp-translate {
            color: #0984e3;
            font-style: italic;
        }

        /* Animations */
        @keyframes shake {
            0% { transform: translateX(0); }
            25% { transform: translateX(-5px) rotate(-2deg); }
            50% { transform: translateX(5px) rotate(2deg); }
            75% { transform: translateX(-5px) rotate(-2deg); }
            100% { transform: translateX(0); }
        }

        @keyframes slideDown {
            from { opacity: 0; transform: translateY(-10px); }
            to { opacity: 1; transform: translateY(0); }
        }

        @keyframes bounceIn {
            0% { transform: scale(0.3); opacity: 0; }
            50% { transform: scale(1.05); opacity: 1; }
            70% { transform: scale(0.9); }
            100% { transform: scale(1); }
        }

        /* Canvas Confetti */
        #confetti-canvas {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            pointer-events: none;
            z-index: 999;
        }

        /* Footer / Submit */
        .footer-controls {
            text-align: center;
            margin-top: 40px;
        }

        .submit-btn {
            background: var(--primary-color);
            color: white;
            border: none;
            padding: 15px 40px;
            font-size: 1.2rem;
            font-weight: 800;
            border-radius: 50px;
            cursor: pointer;
            box-shadow: 0 6px 0 #5f3a87;
            transition: all 0.2s;
        }

        .submit-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 8px 0 #5f3a87;
        }
        
        .submit-btn:active {
            transform: translateY(4px);
            box-shadow: none;
        }

        /* Summary Modal */
        .modal-overlay {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0,0,0,0.7);
            display: none;
            justify-content: center;
            align-items: center;
            z-index: 1000;
            backdrop-filter: blur(5px);
        }

        .modal-content {
            background: white;
            padding: 40px;
            border-radius: 30px;
            text-align: center;
            max-width: 500px;
            width: 90%;
            box-shadow: 0 20px 50px rgba(0,0,0,0.3);
            animation: bounceIn 0.5s;
            border: 5px solid var(--secondary-color);
        }

        .final-score {
            font-size: 4rem;
            font-weight: 800;
            color: var(--primary-color);
            margin: 20px 0;
        }

        .msg-text {
            font-size: 1.5rem;
            margin-bottom: 20px;
            color: #444;
        }

    </style>
</head>
<body>

    <canvas id="confetti-canvas"></canvas>

    <header>
        <h1>Ms Mai An ULIS</h1>
        <div class="subtitle">Speaking Practice: Conversational Exchanges</div>
    </header>

    <div class="score-board">
        <span>‚≠ê ƒêi·ªÉm:</span>
        <span id="current-score">0</span>
        <span>/</span>
        <span id="total-score">0</span>
    </div>

    <div class="quiz-container" id="quiz-container">
        <!-- Questions will be injected here via JS -->
    </div>

    <div class="footer-controls">
        <button class="submit-btn" onclick="finishQuiz()">N·ªòP B√ÄI & XEM K·∫æT QU·∫¢</button>
    </div>

    <!-- Summary Modal -->
    <div class="modal-overlay" id="summary-modal">
        <div class="modal-content">
            <h2>K·∫æT QU·∫¢ B√ÄI L√ÄM</h2>
            <div class="final-score" id="final-score-display">0/10</div>
            <p class="msg-text" id="final-message">B·∫°n ƒë√£ l√†m r·∫•t t·ªët!</p>
            <button class="submit-btn" onclick="location.reload()" style="background: var(--secondary-color); box-shadow: 0 6px 0 #008f7a;">L√†m l·∫°i b√†i</button>
        </div>
    </div>

    <script>
        // D·ªÆ LI·ªÜU ƒê·ªÄ B√ÄI T·ª™ FILE CUNG C·∫§P
        const quizData = [
            {
                "questionNumber": 1,
                "question": "Exercise 1 - Q1: Mark the letter A, B, C or D to indicate the option that best completes the exchange.\n- Mr. Alverez: ‚ÄúDid you see the documentary about whales yesterday evening?‚Äù\n- Mr. Luan: ‚Äú________‚Äù",
                "answerOptions": [
                    {
                        "text": "No, I was busy preparing the lecture. How was it?",
                        "rationale": "1. Ph√¢n t√≠ch: A. love (v): y√™u th√≠ch; B. busy (adj): b·∫≠n r·ªôn, lecture (n): b√†i gi·∫£ng; C. paying attention (phrase): ch√∫ √Ω; D. adore (v): m√™, th√≠ch.\n2. D·ªãch: 'Kh√¥ng, t√¥i b·∫≠n chu·∫©n b·ªã b√†i gi·∫£ng. N√≥ th·∫ø n√†o?'\n3. Gi·∫£i th√≠ch: C√¢u h·ªèi b·∫Øt ƒë·∫ßu b·∫±ng 'Did you see...?' (B·∫°n c√≥ xem kh√¥ng?). C√¢u tr·∫£ l·ªùi c·∫ßn x√°c nh·∫≠n Yes/No. ƒê√°p √°n B tr·∫£ l·ªùi tr·ª±c ti·∫øp ('No') v√† ƒë∆∞a ra l√Ω do h·ª£p l√Ω, ƒë·ªìng th·ªùi h·ªèi l·∫°i ƒë·ªÉ duy tr√¨ h·ªôi tho·∫°i.",
                        "isCorrect": true
                    },
                    { "text": "Oh, I absolutely love animals! Especially dogs.", "isCorrect": false },
                    { "text": "Actually, I wasn‚Äôt paying attention at all. What did we miss?", "isCorrect": false },
                    { "text": "No, I don‚Äôt adore documentary about whales, but I like the zoo.", "isCorrect": false }
                ]
            },
            {
                "questionNumber": 2,
                "question": "Exercise 1 - Q2: Mark the letter A, B, C or D to indicate the option that best completes the exchange.\n- Mr. Vincent: ‚ÄúI‚Äôm worried about the increasing pollution in our oceans.‚Äù\n- Ms. Ruth: ‚Äú________‚Äù",
                "answerOptions": [
                    {
                        "text": "Agreed. We should definitely protect our marine life.",
                        "rationale": "1. Ph√¢n t√≠ch: A. take out the trash (phrase): v·ª©t r√°c; B. unrestricted harvesting (n.phr): khai th√°c kh√¥ng gi·ªõi h·∫°n; C. marine life (n.phr): sinh v·∫≠t bi·ªÉn; D. economic gain (n.phr): l·ª£i √≠ch kinh t·∫ø.\n2. D·ªãch: 'ƒê·ªìng √Ω. Ch√∫ng ta ch·∫Øc ch·∫Øn n√™n b·∫£o v·ªá s·ª± s·ªëng d∆∞·ªõi bi·ªÉn.'\n3. Gi·∫£i th√≠ch: Mr. Vincent b√†y t·ªè s·ª± lo l·∫Øng (worried). Ms. Ruth c·∫ßn th·ªÉ hi·ªán s·ª± ƒë·ªìng c·∫£m ho·∫∑c ƒë·ªìng √Ω. ƒê√°p √°n C th·ªÉ hi·ªán s·ª± ƒë·ªìng t√¨nh ('Agreed') v√† ƒë∆∞a ra gi·∫£i ph√°p li√™n quan.",
                        "isCorrect": true
                    },
                    { "text": "That reminds me, did you take out the trash?", "isCorrect": false },
                    { "text": "Let‚Äôs open up the seas for unrestricted harvesting.", "isCorrect": false },
                    { "text": "We should prioritize economic gain over environmental concerns.", "isCorrect": false }
                ]
            },
            {
                "questionNumber": 3,
                "question": "Exercise 1 - Q3: Mark the letter A, B, C or D to indicate the option that best completes the exchange.\n- Mr. Alverez: ‚ÄúWow, this sunflower is enormous!‚Äù\n- Mr. James: ‚Äú________‚Äù",
                "answerOptions": [
                    {
                        "text": "Sunflowers are a great source of energy.",
                        "rationale": "1. Ph√¢n t√≠ch: A. source of energy (n.phr): ngu·ªìn nƒÉng l∆∞·ª£ng; B. care for (v): quan t√¢m/th√≠ch; C. prefer (v): th√≠ch h∆°n; D. droopy (adj): r≈© xu·ªëng, last season (idm): l·ªói th·ªùi.\n2. D·ªãch: 'Hoa h∆∞·ªõng d∆∞∆°ng l√† m·ªôt ngu·ªìn nƒÉng l∆∞·ª£ng tuy·ªát v·ªùi.'\n3. Gi·∫£i th√≠ch: C√¢u n√≥i c·ªßa Alverez l√† m·ªôt l·ªùi c·∫£m th√°n v·ªÅ k√≠ch th∆∞·ªõc hoa. ƒê√°p √°n A l√† l·ª±a ch·ªçn ph√π h·ª£p nh·∫•t v·ªÅ m·∫∑t ng·ªØ ph√°p v√† t√≠nh l·ªãch s·ª± (b·ªï sung th√¥ng tin t√≠ch c·ª±c). C√°c ƒë√°p √°n kh√°c sai ng·ªØ ph√°p ph·∫£n h·ªìi ho·∫∑c th√¥ l·ªó.",
                        "isCorrect": true
                    },
                    { "text": "No, I don‚Äôt. I really care for sunflowers.", "isCorrect": false },
                    { "text": "Yes, I do. I much prefer lilies over sunflowers.", "isCorrect": false },
                    { "text": "Those droopy sunflowers are so last season.", "isCorrect": false }
                ]
            },
            {
                "questionNumber": 4,
                "question": "Exercise 1 - Q4: Mark the letter A, B, C or D to indicate the option that best completes the exchange.\n- Lucas: ‚ÄúI‚Äôm so excited about our camping trip this weekend!‚Äù\n- Brian: ‚Äú________‚Äù",
                "answerOptions": [
                    {
                        "text": "Me too! Camping is a great way to connect with nature.",
                        "rationale": "1. Ph√¢n t√≠ch: A. stay home (v): ·ªü nh√†; B. groceries (n): th·ª±c ph·∫©m t·∫°p h√≥a; C. postpone (v): ho√£n l·∫°i; D. connect with nature (phrase): k·∫øt n·ªëi v·ªõi thi√™n nhi√™n.\n2. D·ªãch: 'T·ªõ c≈©ng v·∫≠y! C·∫Øm tr·∫°i l√† c√°ch tuy·ªát v·ªùi ƒë·ªÉ h√≤a m√¨nh v√†o thi√™n nhi√™n.'\n3. Gi·∫£i th√≠ch: Lucas ƒëang h√†o h·ª©ng (excited). Brian c·∫ßn ƒë√°p l·∫°i b·∫±ng th√°i ƒë·ªô t∆∞∆°ng t·ª±. 'Me too!' (T·ªõ c≈©ng th·∫ø) l√† ph·∫£n h·ªìi t·ª± nhi√™n nh·∫•t.",
                        "isCorrect": true
                    },
                    { "text": "Can‚Äôt we just stay home this weekend?", "isCorrect": false },
                    { "text": "Oh no, I forgot to buy groceries again!", "isCorrect": false },
                    { "text": "Disagreed. I should postpone the camping trip.", "isCorrect": false }
                ]
            },
            {
                "questionNumber": 5,
                "question": "Exercise 1 - Q5: Mark the letter A, B, C or D to indicate the option that best completes the exchange.\n- Ms. Ella: ‚ÄúI‚Äôm so hot! I wish it would rain soon.‚Äù\n- Mr. Fritz: ‚Äú________‚Äù",
                "answerOptions": [
                    {
                        "text": "The plants definitely need a drink.",
                        "rationale": "1. Ph√¢n t√≠ch: A. refreshing breeze (n.phr): l√†n gi√≥ m√°t l√†nh; B. need a drink (idm): c·∫ßn t∆∞·ªõi n∆∞·ªõc; C. freezing (adj): l·∫°nh c√≥ng; D. pouring down (v): m∆∞a nh∆∞ tr√∫t.\n2. D·ªãch: 'C√¢y c·ªëi ch·∫Øc ch·∫Øn c≈©ng ƒëang c·∫ßn t∆∞·ªõi n∆∞·ªõc ƒë·∫•y.'\n3. Gi·∫£i th√≠ch: Ms. Ella than n√≥ng v√† mu·ªën m∆∞a. Mr. Fritz ƒë·ªìng t√¨nh b·∫±ng c√°ch ƒë∆∞a ra l√Ω do b·ªï sung (c√¢y c·ªëi c≈©ng c·∫ßn n∆∞·ªõc/m∆∞a).",
                        "isCorrect": true
                    },
                    { "text": "What a refreshing breeze!", "isCorrect": false },
                    { "text": "Yes, this room is freezing!", "isCorrect": false },
                    { "text": "The rain keeps pouring down.", "isCorrect": false }
                ]
            },
            {
                "questionNumber": 6,
                "question": "Exercise 1 - Q6: Mark the letter A, B, C or D to indicate the option that best completes the exchange.\n- A: The local animal shelter is recruiting volunteers. ‚Äú________‚Äù\n- B: OK, I‚Äôll think about that.",
                "answerOptions": [
                    {
                        "text": "Why don‚Äôt you give it a go?",
                        "rationale": "1. Ph√¢n t√≠ch: A. like doing (v): th√≠ch l√†m; B. give it a go (idm): th·ª≠ xem sao; C. free time (n): th·ªùi gian r·∫£nh; D. how (adv): nh∆∞ th·∫ø n√†o.\n2. D·ªãch: 'Sao b·∫°n kh√¥ng th·ª≠ xem sao nh·ªâ?' - 'OK, t√¥i s·∫Ω suy nghƒ© v·ªÅ vi·ªác ƒë√≥.'\n3. Gi·∫£i th√≠ch: C√¢u sau c·ªßa B l√† 'I'll think about that' (T√¥i s·∫Ω suy nghƒ©), ch·ª©ng t·ªè c√¢u tr∆∞·ªõc c·ªßa A ph·∫£i l√† m·ªôt l·ªùi g·ª£i √Ω (suggestion). C·∫•u tr√∫c 'Why don't you...?' l√† l·ªùi g·ª£i √Ω ph·ªï bi·∫øn.",
                        "isCorrect": true
                    },
                    { "text": "What do you like doing there?", "isCorrect": false },
                    { "text": "Do you have any free time?", "isCorrect": false },
                    { "text": "How would you do that?", "isCorrect": false }
                ]
            },
            {
                "questionNumber": 7,
                "question": "Exercise 1 - Q7: Mark the letter A, B, C or D to indicate the option that best completes the exchange.\n- A: How would you feel about going on a hiking trip next month? It‚Äôs going to be an amazing adventure!\n- B: ‚Äú________‚Äù I prefer more relaxed vacations.",
                "answerOptions": [
                    {
                        "text": "Hiking isn‚Äôt really my thing.",
                        "rationale": "1. Ph√¢n t√≠ch: A. not really my thing (idm): kh√¥ng ph·∫£i s·ªü th√≠ch c·ªßa t√¥i; B. go with you (v): ƒëi c√πng b·∫°n; C. feel sorry (v): th·∫•y ti·∫øc; D. sign up (v): ƒëƒÉng k√Ω.\n2. D·ªãch: 'Leo n√∫i kh√¥ng ph·∫£i gu c·ªßa t√¥i l·∫Øm. T√¥i th√≠ch nh·ªØng k·ª≥ ngh·ªâ th∆∞ gi√£n h∆°n.'\n3. Gi·∫£i th√≠ch: V·∫ø sau 'I prefer more relaxed vacations' (T√¥i th√≠ch th∆∞ gi√£n h∆°n) l√† m·ªôt l·ªùi t·ª´ ch·ªëi kh√©o cho l·ªùi r·ªß r√™ ƒëi leo n√∫i (v·ªën m·ªát nh·ªçc). ƒê√°p √°n A l√† l·ªùi t·ª´ ch·ªëi l·ªãch s·ª± ph√π h·ª£p nh·∫•t.",
                        "isCorrect": true
                    },
                    { "text": "Alright. I‚Äôll go with you.", "isCorrect": false },
                    { "text": "I feel so sorry for you.", "isCorrect": false },
                    { "text": "How do I sign up for the trip?", "isCorrect": false }
                ]
            },
            {
                "questionNumber": 8,
                "question": "Exercise 1 - Q8: Mark the letter A, B, C or D to indicate the option that best completes the exchange.\n- A: Hey, I heard you have an exam coming up. ‚Äú________‚Äù\n- B: Thanks a lot.",
                "answerOptions": [
                    {
                        "text": "Good luck with your studies!",
                        "rationale": "1. Ph√¢n t√≠ch: A. study together (v): h·ªçc c√πng nhau; B. teach (v): d·∫°y; C. pass (v): ƒë·∫≠u; D. Good luck (phrase): Ch√∫c may m·∫Øn.\n2. D·ªãch: 'Ch√∫c c·∫≠u h·ªçc t·ªët nh√©!' - 'C·∫£m ∆°n nhi·ªÅu.'\n3. Gi·∫£i th√≠ch: Khi nghe tin ai ƒë√≥ s·∫Øp thi, ph·∫£n x·∫° t·ª± nhi√™n nh·∫•t l√† ch√∫c may m·∫Øn. C√¢u tr·∫£ l·ªùi 'Thanks a lot' x√°c nh·∫≠n ng∆∞·ªùi n√≥i v·ª´a nh·∫≠n ƒë∆∞·ª£c m·ªôt l·ªùi ch√∫c.",
                        "isCorrect": true
                    },
                    { "text": "Let‚Äôs study together later.", "isCorrect": false },
                    { "text": "Would you like to teach me?", "isCorrect": false },
                    { "text": "I hope I can pass this.", "isCorrect": false }
                ]
            },
            {
                "questionNumber": 9,
                "question": "Exercise 1 - Q9: Mark the letter A, B, C or D to indicate the option that best completes the exchange.\n- A: Can we enter this part of the forest?\n- B: ‚Äú________‚Äù This is restricted area.",
                "answerOptions": [
                    {
                        "text": "No, sorry, you can‚Äôt.",
                        "rationale": "1. Ph√¢n t√≠ch: A. welcomed (adj): ƒë∆∞·ª£c ch√†o ƒë√≥n; B. restricted area (n.phr): khu v·ª±c c·∫•m/h·∫°n ch·∫ø; C. thank (v): c·∫£m ∆°n; D. Be my guest (idm): C·ª© t·ª± nhi√™n.\n2. D·ªãch: 'Kh√¥ng, xin l·ªói, b·∫°n kh√¥ng th·ªÉ. ƒê√¢y l√† khu v·ª±c c·∫•m.'\n3. Gi·∫£i th√≠ch: V√¨ v·∫ø sau gi·∫£i th√≠ch 'This is restricted area' (ƒê√¢y l√† khu v·ª±c c·∫•m), n√™n c√¢u tr·∫£ l·ªùi b·∫Øt bu·ªôc ph·∫£i l√† t·ª´ ch·ªëi (No).",
                        "isCorrect": true
                    },
                    { "text": "Sure. You‚Äôre always welcomed.", "isCorrect": false },
                    { "text": "Yes. Thank you so much.", "isCorrect": false },
                    { "text": "Of course. Be my guest.", "isCorrect": false }
                ]
            },
            {
                "questionNumber": 10,
                "question": "Exercise 1 - Q10: Mark the letter A, B, C or D to indicate the option that best completes the exchange.\n- A: I think you should start a vegetable garden in our backyard. You can eat fresh and organic products.\n- B: ‚Äú________‚Äù",
                "answerOptions": [
                    {
                        "text": "I‚Äôm not sure if I have the time to take care of it.",
                        "rationale": "1. Ph√¢n t√≠ch: A. rich (adj): h√†o ph√≥ng/gi√†u (nghƒ©a b√≥ng trong ng·ªØ c·∫£nh n√†y kh√¥ng h·ª£p); B. contribution (n): s·ª± ƒë√≥ng g√≥p; C. take care of (v): chƒÉm s√≥c; D. think about (v): suy nghƒ©.\n2. D·ªãch: 'Em kh√¥ng ch·∫Øc l√† m√¨nh c√≥ th·ªùi gian chƒÉm s√≥c n√≥ kh√¥ng n·ªØa.'\n3. Gi·∫£i th√≠ch: A ƒë∆∞a ra l·ªùi khuy√™n/g·ª£i √Ω l√†m v∆∞·ªùn. B ph·∫£n h·ªìi v·ªÅ t√≠nh kh·∫£ thi c·ªßa g·ª£i √Ω ƒë√≥ (v·∫•n ƒë·ªÅ th·ªùi gian). ƒê√¢y l√† c√°ch ph·∫£n h·ªìi t·ª± nhi√™n nh·∫•t.",
                        "isCorrect": true
                    },
                    { "text": "That‚Äôs very rich of you to do so.", "isCorrect": false },
                    { "text": "Your contribution will help protect the planet.", "isCorrect": false },
                    { "text": "Why don‚Äôt you think about that?", "isCorrect": false }
                ]
            }
        ];

        let score = 0;
        let answeredCount = 0;
        const totalQuestions = quizData.length;

        // Initialize
        document.getElementById('total-score').textContent = totalQuestions;
        const quizContainer = document.getElementById('quiz-container');

        // AUDIO CONTEXT
        const audioCtx = new (window.AudioContext || window.webkitAudioContext)();

        function playSound(type) {
            if (audioCtx.state === 'suspended') audioCtx.resume();
            
            const oscillator = audioCtx.createOscillator();
            const gainNode = audioCtx.createGain();
            
            oscillator.connect(gainNode);
            gainNode.connect(audioCtx.destination);
            
            if (type === 'correct') {
                oscillator.type = 'sine';
                oscillator.frequency.setValueAtTime(600, audioCtx.currentTime);
                oscillator.frequency.exponentialRampToValueAtTime(1000, audioCtx.currentTime + 0.1);
                gainNode.gain.setValueAtTime(0.3, audioCtx.currentTime);
                gainNode.gain.exponentialRampToValueAtTime(0.01, audioCtx.currentTime + 0.5);
                oscillator.start();
                oscillator.stop(audioCtx.currentTime + 0.5);
            } else {
                oscillator.type = 'sawtooth';
                oscillator.frequency.setValueAtTime(200, audioCtx.currentTime);
                oscillator.frequency.linearRampToValueAtTime(150, audioCtx.currentTime + 0.3);
                gainNode.gain.setValueAtTime(0.3, audioCtx.currentTime);
                gainNode.gain.linearRampToValueAtTime(0.01, audioCtx.currentTime + 0.3);
                oscillator.start();
                oscillator.stop(audioCtx.currentTime + 0.3);
            }
        }

        // FORMAT EXPLANATION TEXT
        function formatRationale(text) {
            if (!text) return "";
            let formatted = text
                .replace(/1\. Ph√¢n t√≠ch:/g, '<br><strong>1. Ph√¢n t√≠ch (Vocabulary Analysis):</strong><br>')
                .replace(/2\. D·ªãch:/g, '<br><strong>2. D·ªãch nghƒ©a (Translation):</strong>')
                .replace(/3\. Gi·∫£i th√≠ch:/g, '<br><strong>3. Gi·∫£i th√≠ch chi ti·∫øt (Ms Mai An Explains):</strong>');
            
            if (formatted.startsWith('<br>')) formatted = formatted.substring(4);
            return formatted;
        }

        // FISHER-YATES SHUFFLE ALGORITHM
        function shuffleArray(array) {
            for (let i = array.length - 1; i > 0; i--) {
                const j = Math.floor(Math.random() * (i + 1));
                [array[i], array[j]] = [array[j], array[i]];
            }
            return array;
        }

        // RENDER QUIZ
        function renderQuiz() {
            quizData.forEach((item, index) => {
                const card = document.createElement('div');
                card.className = 'question-card';
                card.id = `q-card-${index}`;

                // Extract Correct Answer for Logic (before shuffle)
                const correctOption = item.answerOptions.find(opt => opt.isCorrect);
                const rationaleText = correctOption ? correctOption.rationale : "Ch∆∞a c·∫≠p nh·∫≠t gi·∫£i th√≠ch.";

                // Clone and SHUFFLE options for Display
                let displayOptions = [...item.answerOptions];
                shuffleArray(displayOptions);

                // Header
                const header = `
                    <div class="question-header">
                        <span class="q-tag">Question ${item.questionNumber}</span>
                    </div>
                    <div class="question-text">${item.question}</div>
                `;

                // Options
                const letters = ['A', 'B', 'C', 'D'];
                let optionsHtml = '<div class="options-grid">';
                
                displayOptions.forEach((opt, optIndex) => {
                    optionsHtml += `
                        <div class="option-btn" 
                             onclick="checkAnswer(${index}, ${optIndex}, ${opt.isCorrect}, this)"
                             data-opt-index="${optIndex}">
                            <div class="option-letter">${letters[optIndex]}</div>
                            ${opt.text}
                        </div>
                    `;
                });
                optionsHtml += '</div>';

                // Explanation Block (Hidden)
                const explanationHtml = `
                    <div class="explanation-box" id="exp-${index}">
                        <div class="exp-header">
                            <span>üéì Ms Mai An gi·∫£i th√≠ch chi ti·∫øt:</span>
                        </div>
                        <div class="exp-content">
                            ${formatRationale(rationaleText)}
                        </div>
                    </div>
                `;

                card.innerHTML = header + optionsHtml + explanationHtml;
                quizContainer.appendChild(card);
            });
        }

        // CHECK ANSWER LOGIC
        function checkAnswer(qIndex, optIndex, isCorrect, btnElement) {
            const card = document.getElementById(`q-card-${qIndex}`);
            // Prevent multiple clicks
            if (card.classList.contains('answered')) return;
            card.classList.add('answered');

            const allOptions = card.querySelectorAll('.option-btn');
            
            // Show Explanation Immediately
            document.getElementById(`exp-${qIndex}`).classList.add('show');
            answeredCount++;

            if (isCorrect) {
                // CORRECT
                score++;
                document.getElementById('current-score').textContent = score;
                btnElement.classList.add('correct');
                playSound('correct');
                fireConfetti();
            } else {
                // WRONG
                btnElement.classList.add('wrong');
                playSound('wrong');
                
                // Find and highlight the correct button (visual search)
                // Since we shuffled, we can't rely on original index. We rely on the text content or isCorrect flag logic passed.
                // But since we don't have the flag in the DOM easily, let's look at the JS object? 
                // Wait, the shuffleArray shuffled the objects.
                // The easiest way is to loop through DOM elements and check if they trigger the correct logic? 
                // No, simpler: Use a data attribute if we had it, OR:
                // We rendered 'isCorrect' into the onclick.
                // We can't access onclick easily.
                // Better way: Re-scan the quizData? No, quizData is unshuffled.
                // Hack: The options rendered correspond to 'displayOptions' which is local scope.
                
                // FIX: Let's find the correct button by text content matching the known correct answer.
                const correctText = quizData[qIndex].answerOptions.find(o => o.isCorrect).text;
                
                allOptions.forEach(btn => {
                    if (btn.innerText.includes(correctText)) {
                        btn.classList.add('correct');
                    }
                });
            }

            // Disable all buttons
            allOptions.forEach(btn => btn.classList.add('disabled'));
        }

        // CONFETTI EFFECT
        function fireConfetti() {
            const canvas = document.getElementById('confetti-canvas');
            const ctx = canvas.getContext('2d');
            canvas.width = window.innerWidth;
            canvas.height = window.innerHeight;

            const particles = [];
            const particleCount = 100;
            const colors = ['#8854C0', '#00C9A7', '#FF4757', '#FFD700', '#FFFFFF'];

            for (let i = 0; i < particleCount; i++) {
                particles.push({
                    x: canvas.width / 2,
                    y: canvas.height / 2,
                    w: Math.random() * 10 + 5,
                    h: Math.random() * 10 + 5,
                    color: colors[Math.floor(Math.random() * colors.length)],
                    vx: (Math.random() - 0.5) * 10,
                    vy: (Math.random() - 0.5) * 10,
                    gravity: 0.2
                });
            }

            function draw() {
                ctx.clearRect(0, 0, canvas.width, canvas.height);
                let active = false;
                particles.forEach((p) => {
                    p.x += p.vx;
                    p.y += p.vy;
                    p.vy += p.gravity;
                    
                    if (p.y < canvas.height) active = true;

                    ctx.fillStyle = p.color;
                    ctx.fillRect(p.x, p.y, p.w, p.h);
                });

                if (active) requestAnimationFrame(draw);
                else ctx.clearRect(0, 0, canvas.width, canvas.height);
            }
            draw();
        }

        // FINISH QUIZ
        function finishQuiz() {
            const modal = document.getElementById('summary-modal');
            const finalScore = document.getElementById('final-score-display');
            const message = document.getElementById('final-message');

            finalScore.textContent = `${score}/${totalQuestions}`;
            
            if (score === totalQuestions) {
                message.textContent = "Xu·∫•t s·∫Øc! B·∫°n l√† thi√™n t√†i Ti·∫øng Anh! üåü";
                fireConfetti();
                fireConfetti(); // Double confetti
            } else if (score >= totalQuestions * 0.7) {
                message.textContent = "R·∫•t t·ªët! C·ªë g·∫Øng th√™m ch√∫t n·ªØa l√† ho√†n h·∫£o! üí™";
            } else {
                message.textContent = "ƒê·ª´ng n·∫£n ch√≠! H√£y xem k·ªπ ph·∫ßn gi·∫£i th√≠ch nh√©! üìö";
            }

            modal.style.display = 'flex';
        }

        // Start
        renderQuiz();

    </script>
</body>
</html>
