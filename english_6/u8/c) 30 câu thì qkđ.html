<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>30 C√¢u Tr·∫Øc Nghi·ªám Th√¨ Qu√° Kh·ª© ƒê∆°n - Ms Mai An ULIS</title>
    <link href="https://fonts.googleapis.com/css2?family=Nunito:wght@400;600;700;800&display=swap" rel="stylesheet">
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css" rel="stylesheet">
    <style>
        :root {
            --primary-color: #8854C0; /* T√≠m h·ªìng nh·∫°t */
            --secondary-color: #00C9A7; /* Xanh ng·ªçc */
            --correct-color: #00D26A; /* Xanh l√° */
            --wrong-color: #FF4757; /* ƒê·ªè cam */
            --bg-pattern: radial-gradient(#8854c0 1.5px, transparent 1.5px), radial-gradient(#8854c0 1.5px, #fdf2ff 1.5px);
        }

        body {
            font-family: 'Nunito', sans-serif;
            background-color: #fdf2ff;
            background-image: var(--bg-pattern);
            background-size: 30px 30px;
            background-position: 0 0, 15px 15px;
            color: #2c3e50;
            margin: 0;
            padding: 20px;
            min-height: 100vh;
            display: flex;
            flex-direction: column;
            align-items: center;
        }

        .header-container {
            text-align: center;
            margin-bottom: 30px;
            background: white;
            padding: 15px 30px;
            border-radius: 20px;
            box-shadow: 0 8px 0 rgba(0,0,0,0.1);
            border: 2px solid #eee;
            position: relative;
            z-index: 10;
            max-width: 800px;
            width: 90%;
        }

        h1 {
            color: var(--primary-color);
            margin: 0;
            font-size: 1.8rem;
            font-weight: 800;
        }

        .teacher-tag {
            background: var(--secondary-color);
            color: white;
            padding: 5px 15px;
            border-radius: 20px;
            font-size: 0.9rem;
            font-weight: 700;
            display: inline-block;
            margin-bottom: 10px;
            box-shadow: 0 4px 0 rgba(0,0,0,0.1);
        }

        .quiz-container {
            width: 100%;
            max-width: 800px;
            position: relative;
        }

        .question-card {
            background: white;
            border-radius: 25px;
            padding: 30px;
            margin-bottom: 30px;
            box-shadow: 0 10px 25px rgba(136, 84, 192, 0.15);
            border: 3px solid #f0f0f0;
            transition: transform 0.3s ease;
            position: relative;
            overflow: hidden;
        }

        .question-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 20px;
            border-bottom: 2px dashed #eee;
            padding-bottom: 15px;
        }

        .q-number {
            font-weight: 800;
            color: var(--primary-color);
            font-size: 1.2rem;
            background: #f3e5f5;
            padding: 8px 15px;
            border-radius: 12px;
        }

        .question-text {
            font-size: 1.3rem;
            font-weight: 700;
            color: #2d3436;
            line-height: 1.6;
            margin-bottom: 25px;
        }

        .options-grid {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 15px;
        }

        @media (max-width: 600px) {
            .options-grid {
                grid-template-columns: 1fr;
            }
        }

        .option-btn {
            background: white;
            border: 2px solid #e0e0e0;
            border-radius: 15px;
            padding: 15px 20px;
            font-family: 'Nunito', sans-serif;
            font-size: 1.1rem;
            font-weight: 600;
            color: #555;
            cursor: pointer;
            transition: all 0.2s cubic-bezier(0.25, 0.8, 0.25, 1);
            box-shadow: 0 5px 0 #e0e0e0;
            text-align: left;
            position: relative;
        }

        .option-btn:hover:not(:disabled) {
            transform: translateY(-2px);
            border-color: var(--secondary-color);
            color: var(--secondary-color);
            box-shadow: 0 7px 0 #e0e0e0;
        }

        .option-btn:active:not(:disabled) {
            transform: translateY(4px);
            box-shadow: 0 0 0 #e0e0e0;
        }

        .option-btn.correct {
            background-color: var(--correct-color);
            color: white;
            border-color: #00b85c;
            box-shadow: 0 5px 0 #00b85c;
            animation: pulse 0.5s;
        }

        .option-btn.incorrect {
            background-color: var(--wrong-color);
            color: white;
            border-color: #d63031;
            box-shadow: 0 5px 0 #d63031;
            animation: shake 0.5s;
        }

        .explanation-box {
            margin-top: 25px;
            background: #f0fff4;
            border: 2px solid var(--correct-color);
            border-radius: 15px;
            padding: 20px;
            display: none;
            animation: slideDown 0.4s ease-out;
        }

        .explanation-box.show {
            display: block;
        }

        .exp-header {
            font-weight: 800;
            color: var(--correct-color);
            margin-bottom: 10px;
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .exp-content p {
            margin: 8px 0;
            line-height: 1.5;
        }

        .exp-label {
            font-weight: 700;
            color: #444;
            background: rgba(255, 255, 255, 0.6);
            padding: 2px 8px;
            border-radius: 5px;
            display: inline-block;
            margin-right: 5px;
        }

        .vocab-highlight {
            color: #e67e22;
            font-weight: bold;
        }

        .controls {
            margin-top: 40px;
            text-align: center;
            padding-bottom: 50px;
        }

        .submit-btn {
            background: var(--primary-color);
            color: white;
            border: none;
            padding: 15px 40px;
            font-size: 1.3rem;
            font-weight: 800;
            border-radius: 50px;
            cursor: pointer;
            box-shadow: 0 8px 0 #6c429c;
            transition: all 0.2s;
            font-family: 'Nunito', sans-serif;
        }

        .submit-btn:hover {
            transform: scale(1.05);
            background: #9b59b6;
        }

        .submit-btn:active {
            transform: translateY(5px);
            box-shadow: 0 3px 0 #6c429c;
        }

        /* Animations */
        @keyframes shake {
            0% { transform: translateX(0); }
            25% { transform: translateX(-10px) rotate(-5deg); }
            50% { transform: translateX(10px) rotate(5deg); }
            75% { transform: translateX(-10px) rotate(-5deg); }
            100% { transform: translateX(0); }
        }

        @keyframes pulse {
            0% { transform: scale(1); }
            50% { transform: scale(1.05); }
            100% { transform: scale(1); }
        }

        @keyframes slideDown {
            from { opacity: 0; transform: translateY(-20px); }
            to { opacity: 1; transform: translateY(0); }
        }

        /* Modal */
        .modal-overlay {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0,0,0,0.7);
            display: none;
            justify-content: center;
            align-items: center;
            z-index: 1000;
            backdrop-filter: blur(5px);
        }

        .modal-content {
            background: white;
            padding: 40px;
            border-radius: 30px;
            text-align: center;
            max-width: 500px;
            width: 90%;
            position: relative;
            box-shadow: 0 20px 60px rgba(0,0,0,0.3);
            border: 5px solid var(--secondary-color);
            animation: popIn 0.5s cubic-bezier(0.175, 0.885, 0.32, 1.275);
        }

        @keyframes popIn {
            from { transform: scale(0.5); opacity: 0; }
            to { transform: scale(1); opacity: 1; }
        }

        .score-display {
            font-size: 4rem;
            font-weight: 900;
            color: var(--primary-color);
            margin: 20px 0;
        }

        /* Canvas for Confetti */
        #confetti-canvas {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            pointer-events: none;
            z-index: 999;
        }

    </style>
</head>
<body>

    <div class="header-container">
        <div class="teacher-tag">Teacher: Ms Mai An ULIS</div>
        <h1><i class="fas fa-gamepad"></i> 30 C√¢u Tr·∫Øc Nghi·ªám: Qu√° Kh·ª© ƒê∆°n</h1>
        <p style="margin-top: 10px; color: #666;">Ch·ªçn ƒë√°p √°n ƒë√∫ng nh·∫•t v√† xem gi·∫£i th√≠ch chi ti·∫øt ngay l·∫≠p t·ª©c!</p>
    </div>

    <div class="quiz-container" id="quiz-area">
        <!-- Questions will be injected here by JS -->
    </div>

    <div class="controls">
        <button class="submit-btn" onclick="finishQuiz()">N·ªòP B√ÄI <i class="fas fa-flag-checkered"></i></button>
    </div>

    <div class="modal-overlay" id="result-modal">
        <div class="modal-content">
            <h2 style="color: var(--secondary-color); font-size: 2rem; margin: 0;">K·∫æT QU·∫¢ C·ª¶A B·∫†N</h2>
            <div class="score-display" id="final-score">0/30</div>
            <p id="teacher-comment" style="font-size: 1.2rem; color: #555; margin-bottom: 30px;">B·∫°n l√†m r·∫•t t·ªët!</p>
            <button class="submit-btn" onclick="location.reload()">L√ÄM L·∫†I <i class="fas fa-redo"></i></button>
        </div>
    </div>

    <canvas id="confetti-canvas"></canvas>

    <script>
        // --- SOUND EFFECTS (Base64 for single file portability) ---
        const soundCorrect = new Audio("data:audio/wav;base64,UklGRl9vT1ZBWl3..."); // Placeholder, using simplified chime below
        // Since base64 strings are long, I will use a simple synth function for sounds to keep the file clean and working offline without external assets.
        
        const audioCtx = new (window.AudioContext || window.webkitAudioContext)();

        function playSound(type) {
            if (audioCtx.state === 'suspended') audioCtx.resume();
            const osc = audioCtx.createOscillator();
            const gainNode = audioCtx.createGain();
            osc.connect(gainNode);
            gainNode.connect(audioCtx.destination);

            if (type === 'correct') {
                // Happy Chime: High pitch ascending
                osc.type = 'sine';
                osc.frequency.setValueAtTime(500, audioCtx.currentTime);
                osc.frequency.exponentialRampToValueAtTime(1000, audioCtx.currentTime + 0.1);
                gainNode.gain.setValueAtTime(0.3, audioCtx.currentTime);
                gainNode.gain.exponentialRampToValueAtTime(0.01, audioCtx.currentTime + 0.5);
                osc.start();
                osc.stop(audioCtx.currentTime + 0.5);
            } else if (type === 'wrong') {
                // Sad Buzz: Low pitch descending saw
                osc.type = 'sawtooth';
                osc.frequency.setValueAtTime(150, audioCtx.currentTime);
                osc.frequency.linearRampToValueAtTime(100, audioCtx.currentTime + 0.3);
                gainNode.gain.setValueAtTime(0.3, audioCtx.currentTime);
                gainNode.gain.exponentialRampToValueAtTime(0.01, audioCtx.currentTime + 0.3);
                osc.start();
                osc.stop(audioCtx.currentTime + 0.3);
            }
        }

        // --- DATA ---
        const questions = [
    {
      "questionNumber": 1,
      "question": "I ______ very tired yesterday evening.",
      "translation": "T√¥i ƒë√£ r·∫•t m·ªát v√†o t·ªëi h√¥m qua.",
      "answerOptions": [
        { "text": "was", "rationale": "ƒê√öNG: Ch·ªß ng·ªØ 'I' ƒëi v·ªõi to be qu√° kh·ª© 'was'.", "isCorrect": true },
        { "text": "were", "rationale": "SAI: 'Were' ch·ªâ d√πng cho s·ªë nhi·ªÅu (You/We/They).", "isCorrect": false },
        { "text": "am", "rationale": "SAI: 'Am' l√† hi·ªán t·∫°i, kh√¥ng d√πng cho 'yesterday'.", "isCorrect": false },
        { "text": "been", "rationale": "SAI: 'Been' l√† V3, c·∫ßn tr·ª£ ƒë·ªông t·ª´ 'have/has' ƒëi k√®m.", "isCorrect": false }
      ],
      "hint": "Ch·ªß ng·ªØ l√† 'I' v√† th·ªùi gian l√† qu√° kh·ª©."
    },
    {
      "questionNumber": 2,
      "question": "They ______ happy with the result of the match.",
      "translation": "H·ªç ƒë√£ kh√¥ng vui v·ªõi k·∫øt qu·∫£ c·ªßa tr·∫≠n ƒë·∫•u.",
      "answerOptions": [
        { "text": "wasn't", "rationale": "SAI: D√πng cho ch·ªß ng·ªØ s·ªë √≠t.", "isCorrect": false },
        { "text": "weren't", "rationale": "ƒê√öNG: 'They' (s·ªë nhi·ªÅu) ƒëi v·ªõi 'weren't'.", "isCorrect": true },
        { "text": "aren't", "rationale": "SAI: Th√¨ hi·ªán t·∫°i.", "isCorrect": false },
        { "text": "didn't", "rationale": "SAI: 'Happy' l√† t√≠nh t·ª´, kh√¥ng d√πng tr·ª£ ƒë·ªông t·ª´ 'didn't'.", "isCorrect": false }
      ]
    },
    {
      "questionNumber": 3,
      "question": "______ she at school last Monday?",
      "translation": "C√¥ ·∫•y c√≥ ·ªü tr∆∞·ªùng v√†o th·ª© Hai tr∆∞·ªõc kh√¥ng?",
      "answerOptions": [
        { "text": "Were", "rationale": "SAI: Kh√¥ng ƒëi v·ªõi 'she'.", "isCorrect": false },
        { "text": "Did", "rationale": "SAI: C√¢u h·ªèi v·ªã tr√≠ (at school) d√πng to be, kh√¥ng d√πng 'Did'.", "isCorrect": false },
        { "text": "Was", "rationale": "ƒê√öNG: 'She' (s·ªë √≠t) ƒëi v·ªõi 'Was'.", "isCorrect": true },
        { "text": "Is", "rationale": "SAI: Sai th√¨ (last Monday).", "isCorrect": false }
      ]
    },
    {
      "questionNumber": 4,
      "question": "We ______ a new car two days ago.",
      "translation": "Ch√∫ng t√¥i ƒë√£ mua m·ªôt chi·∫øc xe m·ªõi c√°ch ƒë√¢y 2 ng√†y.",
      "answerOptions": [
        { "text": "buy", "rationale": "SAI: D·∫°ng nguy√™n th·ªÉ/hi·ªán t·∫°i.", "isCorrect": false },
        { "text": "buyed", "rationale": "SAI: 'Buy' l√† ƒë·ªông t·ª´ b·∫•t quy t·∫Øc, kh√¥ng th√™m -ed.", "isCorrect": false },
        { "text": "bought", "rationale": "ƒê√öNG: Qu√° kh·ª© c·ªßa 'buy' l√† 'bought'.", "isCorrect": true },
        { "text": "buying", "rationale": "SAI: D·∫°ng V-ing.", "isCorrect": false }
      ]
    },
    {
      "questionNumber": 5,
      "question": "He ______ usually ______ breakfast last year.",
      "translation": "NƒÉm ngo√°i anh ·∫•y th∆∞·ªùng kh√¥ng ƒÉn s√°ng.",
      "answerOptions": [
        { "text": "didn't / eat", "rationale": "ƒê√öNG: Ph·ªß ƒë·ªãnh qu√° kh·ª© = didn't + V nguy√™n th·ªÉ.", "isCorrect": true },
        { "text": "didn't / ate", "rationale": "SAI: Sau 'didn't' ƒë·ªông t·ª´ kh√¥ng chia.", "isCorrect": false },
        { "text": "doesn't / eat", "rationale": "SAI: Th√¨ hi·ªán t·∫°i.", "isCorrect": false },
        { "text": "not / ate", "rationale": "SAI: Thi·∫øu tr·ª£ ƒë·ªông t·ª´ 'did'.", "isCorrect": false }
      ]
    },
    {
      "questionNumber": 6,
      "question": "______ you ______ the film on TV last night?",
      "translation": "B·∫°n c√≥ xem b·ªô phim tr√™n TV t·ªëi qua kh√¥ng?",
      "answerOptions": [
        { "text": "Did / watch", "rationale": "ƒê√öNG: C√¢u h·ªèi Yes/No = Did + S + V-inf.", "isCorrect": true },
        { "text": "Did / watched", "rationale": "SAI: Sau 'Did' kh√¥ng chia -ed.", "isCorrect": false },
        { "text": "Do / watch", "rationale": "SAI: Th√¨ hi·ªán t·∫°i.", "isCorrect": false },
        { "text": "Were / watch", "rationale": "SAI: To be kh√¥ng ƒëi v·ªõi ƒë·ªông t·ª´ nguy√™n th·ªÉ.", "isCorrect": false }
      ]
    },
    {
      "questionNumber": 7,
      "question": "Where ______ you born?",
      "translation": "B·∫°n sinh ra ·ªü ƒë√¢u?",
      "answerOptions": [
        { "text": "did", "rationale": "SAI: C·ª•m 'be born' lu√¥n d√πng to be.", "isCorrect": false },
        { "text": "was", "rationale": "SAI: 'You' kh√¥ng ƒëi v·ªõi 'was'.", "isCorrect": false },
        { "text": "were", "rationale": "ƒê√öNG: 'You' ƒëi v·ªõi 'were'.", "isCorrect": true },
        { "text": "are", "rationale": "SAI: Sinh ra l√† chuy·ªán qu√° kh·ª©.", "isCorrect": false }
      ]
    },
    {
      "questionNumber": 8,
      "question": "They ______ strictly with their children when they were young.",
      "translation": "H·ªç ƒë√£ r·∫•t nghi√™m kh·∫Øc v·ªõi con c√°i khi ch√∫ng c√≤n nh·ªè.",
      "answerOptions": [
        { "text": "was", "rationale": "SAI: 'They' l√† s·ªë nhi·ªÅu.", "isCorrect": false },
        { "text": "were", "rationale": "ƒê√öNG: 'They' ƒëi v·ªõi 'were'.", "isCorrect": true },
        { "text": "did", "rationale": "SAI: 'Strict' l√† t√≠nh t·ª´, c·∫ßn to be.", "isCorrect": false },
        { "text": "are", "rationale": "SAI: M√¢u thu·∫´n v·ªõi v·∫ø sau 'when they were young'.", "isCorrect": false }
      ]
    },
    {
      "questionNumber": 9,
      "question": "She ______ to the party because she was busy.",
      "translation": "C√¥ ·∫•y ƒë√£ kh√¥ng ƒë·∫øn b·ªØa ti·ªác v√¨ c√¥ ·∫•y b·∫≠n.",
      "answerOptions": [
        { "text": "didn't came", "rationale": "SAI: Th·ª´a qu√° kh·ª© ·ªü 'came'.", "isCorrect": false },
        { "text": "didn't come", "rationale": "ƒê√öNG: Didn't + V nguy√™n th·ªÉ (come).", "isCorrect": true },
        { "text": "not come", "rationale": "SAI: Thi·∫øu 'did'.", "isCorrect": false },
        { "text": "wasn't come", "rationale": "SAI: Ng·ªØ ph√°p.", "isCorrect": false }
      ]
    },
    {
      "questionNumber": 10,
      "question": "The weather ______ nice yesterday; it rained all day.",
      "translation": "Th·ªùi ti·∫øt h√¥m qua KH√îNG ƒë·∫πp; tr·ªùi m∆∞a c·∫£ ng√†y.",
      "answerOptions": [
        { "text": "was", "rationale": "SAI: N·∫øu 'was' (ƒë·∫πp) th√¨ kh√¥ng h·ª£p l√Ω v·ªõi 'm∆∞a c·∫£ ng√†y'.", "isCorrect": false },
        { "text": "were", "rationale": "SAI: 'Weather' l√† s·ªë √≠t.", "isCorrect": false },
        { "text": "wasn't", "rationale": "ƒê√öNG: Ph·ªß ƒë·ªãnh (kh√¥ng ƒë·∫πp) + s·ªë √≠t.", "isCorrect": true },
        { "text": "didn't", "rationale": "SAI: 'Nice' l√† t√≠nh t·ª´.", "isCorrect": false }
      ]
    },
    {
      "questionNumber": 11,
      "question": "______ Tom and Jerry friends in the cartoon?",
      "translation": "Tom v√† Jerry c√≥ ph·∫£i l√† b·∫°n trong phim ho·∫°t h√¨nh kh√¥ng?",
      "answerOptions": [
        { "text": "Was", "rationale": "SAI: Ch·ªß ng·ªØ s·ªë nhi·ªÅu (2 nh√¢n v·∫≠t).", "isCorrect": false },
        { "text": "Did", "rationale": "SAI: H·ªèi v·ªÅ m·ªëi quan h·ªá (danh t·ª´ friends) d√πng to be.", "isCorrect": false },
        { "text": "Were", "rationale": "ƒê√öNG: S·ªë nhi·ªÅu qu√° kh·ª©.", "isCorrect": true },
        { "text": "Are", "rationale": "SAI: Ng·ªØ c·∫£nh qu√° kh·ª©.", "isCorrect": false }
      ]
    },
    {
      "questionNumber": 12,
      "question": "I ______ my homework last night, so the teacher was angry.",
      "translation": "T·ªëi qua t√¥i ƒë√£ KH√îNG l√†m b√†i t·∫≠p, n√™n gi√°o vi√™n t·ª©c gi·∫≠n.",
      "answerOptions": [
        { "text": "didn't do", "rationale": "ƒê√öNG: Didn't + V ch√≠nh (do).", "isCorrect": true },
        { "text": "didn't did", "rationale": "SAI: Sai ng·ªØ ph√°p.", "isCorrect": false },
        { "text": "not do", "rationale": "SAI: Thi·∫øu tr·ª£ ƒë·ªông t·ª´.", "isCorrect": false },
        { "text": "wasn't do", "rationale": "SAI: To be kh√¥ng ƒëi v·ªõi V th∆∞·ªùng.", "isCorrect": false }
      ]
    },
    {
      "questionNumber": 13,
      "question": "We ______ a great time at the beach last summer.",
      "translation": "Ch√∫ng t√¥i ƒë√£ c√≥ kho·∫£ng th·ªùi gian tuy·ªát v·ªùi ·ªü b√£i bi·ªÉn m√πa h√® tr∆∞·ªõc.",
      "answerOptions": [
        { "text": "have", "rationale": "SAI: Hi·ªán t·∫°i.", "isCorrect": false },
        { "text": "has", "rationale": "SAI: Hi·ªán t·∫°i ng√¥i 3.", "isCorrect": false },
        { "text": "had", "rationale": "ƒê√öNG: Qu√° kh·ª© c·ªßa 'have' l√† 'had'.", "isCorrect": true },
        { "text": "having", "rationale": "SAI: V-ing.", "isCorrect": false }
      ]
    },
    {
      "questionNumber": 14,
      "question": "When ______ you ______ to drive?",
      "translation": "B·∫°n ƒë√£ h·ªçc l√°i xe khi n√†o?",
      "answerOptions": [
        { "text": "did / learn", "rationale": "ƒê√öNG: When + did + S + V-inf.", "isCorrect": true },
        { "text": "did / learned", "rationale": "SAI: D∆∞ -ed.", "isCorrect": false },
        { "text": "were / learn", "rationale": "SAI: To be + V-inf.", "isCorrect": false },
        { "text": "did / learning", "rationale": "SAI: V-ing.", "isCorrect": false }
      ]
    },
    {
      "questionNumber": 15,
      "question": "My father ______ to work yesterday; he went by bus.",
      "translation": "B·ªë t√¥i ƒë√£ KH√îNG l√°i xe ƒëi l√†m h√¥m qua; √¥ng ·∫•y ƒëi xe bu√Ωt.",
      "answerOptions": [
        { "text": "drove", "rationale": "SAI: M√¢u thu·∫´n v·ªõi 'went by bus'.", "isCorrect": false },
        { "text": "didn't drive", "rationale": "ƒê√öNG: Ph·ªß ƒë·ªãnh h√†nh ƒë·ªông l√°i xe.", "isCorrect": true },
        { "text": "didn't drove", "rationale": "SAI: Chia 2 l·∫ßn qu√° kh·ª©.", "isCorrect": false },
        { "text": "wasn't drive", "rationale": "SAI: Ng·ªØ ph√°p.", "isCorrect": false }
      ]
    },
    {
      "questionNumber": 16,
      "question": "______ it cold yesterday?",
      "translation": "H√¥m qua tr·ªùi c√≥ l·∫°nh kh√¥ng?",
      "answerOptions": [
        { "text": "Did", "rationale": "SAI: 'Cold' l√† t√≠nh t·ª´.", "isCorrect": false },
        { "text": "Was", "rationale": "ƒê√öNG: H·ªèi v·ªÅ th·ªùi ti·∫øt (t√≠nh t·ª´) d√πng 'Was' v·ªõi ch·ªß ng·ªØ 'It'.", "isCorrect": true },
        { "text": "Were", "rationale": "SAI: S·ªë nhi·ªÅu.", "isCorrect": false },
        { "text": "Is", "rationale": "SAI: Sai th√¨.", "isCorrect": false }
      ]
    },
    {
      "questionNumber": 17,
      "question": "They ______ English two years ago.",
      "translation": "H·ªç ƒë√£ h·ªçc ti·∫øng Anh c√°ch ƒë√¢y 2 nƒÉm.",
      "answerOptions": [
        { "text": "study", "rationale": "SAI: Hi·ªán t·∫°i.", "isCorrect": false },
        { "text": "studied", "rationale": "ƒê√öNG: Study -> Studied (ƒë·ªïi y th√†nh i).", "isCorrect": true },
        { "text": "studyed", "rationale": "SAI: Sai ch√≠nh t·∫£.", "isCorrect": false },
        { "text": "studying", "rationale": "SAI: V-ing.", "isCorrect": false }
      ]
    },
    {
      "questionNumber": 18,
      "question": "What ______ you ______ for dinner yesterday?",
      "translation": "B·∫°n ƒë√£ ƒÉn g√¨ cho b·ªØa t·ªëi h√¥m qua?",
      "answerOptions": [
        { "text": "did / eat", "rationale": "ƒê√öNG: Tr·ª£ ƒë·ªông t·ª´ Did + V nguy√™n th·ªÉ Eat.", "isCorrect": true },
        { "text": "were / eat", "rationale": "SAI: Ng·ªØ ph√°p.", "isCorrect": false },
        { "text": "did / ate", "rationale": "SAI: D∆∞ qu√° kh·ª© 'ate'.", "isCorrect": false },
        { "text": "do / eat", "rationale": "SAI: Hi·ªán t·∫°i.", "isCorrect": false }
      ]
    },
    {
      "questionNumber": 19,
      "question": "Mozart ______ a famous composer.",
      "translation": "Mozart ƒë√£ l√† m·ªôt nh√† so·∫°n nh·∫°c n·ªïi ti·∫øng.",
      "answerOptions": [
        { "text": "is", "rationale": "SAI: √îng ·∫•y ƒë√£ m·∫•t.", "isCorrect": false },
        { "text": "were", "rationale": "SAI: S·ªë nhi·ªÅu.", "isCorrect": false },
        { "text": "was", "rationale": "ƒê√öNG: Danh t·ª´ s·ªë √≠t, qu√° kh·ª© (l·ªãch s·ª≠).", "isCorrect": true },
        { "text": "did", "rationale": "SAI: C·∫ßn ƒë·ªông t·ª´ n·ªëi cho danh t·ª´ ph√≠a sau.", "isCorrect": false }
      ]
    },
    {
      "questionNumber": 20,
      "question": "I ______ my keys. I couldn't open the door.",
      "translation": "T√¥i ƒë√£ l√†m m·∫•t ch√¨a kh√≥a. T√¥i kh√¥ng th·ªÉ m·ªü c·ª≠a.",
      "answerOptions": [
        { "text": "lose", "rationale": "SAI: Hi·ªán t·∫°i.", "isCorrect": false },
        { "text": "losed", "rationale": "SAI: Sai ch√≠nh t·∫£.", "isCorrect": false },
        { "text": "lost", "rationale": "ƒê√öNG: Qu√° kh·ª© b·∫•t quy t·∫Øc c·ªßa 'lose'.", "isCorrect": true },
        { "text": "losing", "rationale": "SAI: V-ing.", "isCorrect": false }
      ]
    },
    {
      "questionNumber": 21,
      "question": "The children ______ hungry, so they ate a lot.",
      "translation": "L≈© tr·∫ª ƒë√£ r·∫•t ƒë√≥i n√™n ch√∫ng ƒÉn r·∫•t nhi·ªÅu.",
      "answerOptions": [
        { "text": "was", "rationale": "SAI: D√πng cho s·ªë √≠t.", "isCorrect": false },
        { "text": "were", "rationale": "ƒê√öNG: 'Children' l√† s·ªë nhi·ªÅu -> d√πng 'were'.", "isCorrect": true },
        { "text": "did", "rationale": "SAI: ƒêi v·ªõi t√≠nh t·ª´ 'hungry' c·∫ßn to be.", "isCorrect": false },
        { "text": "are", "rationale": "SAI: Sai th√¨.", "isCorrect": false }
      ]
    },
    {
      "questionNumber": 22,
      "question": "She ______ see me because she was looking at her phone.",
      "translation": "C√¥ ·∫•y ƒë√£ KH√îNG nh√¨n th·∫•y t√¥i v√¨ m·∫£i nh√¨n ƒëi·ªán tho·∫°i.",
      "answerOptions": [
        { "text": "didn't", "rationale": "ƒê√öNG: Tr·ª£ ƒë·ªông t·ª´ ph·ªß ƒë·ªãnh qu√° kh·ª©.", "isCorrect": true },
        { "text": "wasn't", "rationale": "SAI: Kh√¥ng ƒëi v·ªõi V th∆∞·ªùng 'see'.", "isCorrect": false },
        { "text": "doesn't", "rationale": "SAI: Hi·ªán t·∫°i.", "isCorrect": false },
        { "text": "don't", "rationale": "SAI: Hi·ªán t·∫°i/Ng√¥i.", "isCorrect": false }
      ]
    },
    {
      "questionNumber": 23,
      "question": "______ your parents at home last weekend?",
      "translation": "B·ªë m·∫π b·∫°n c√≥ ·ªü nh√† cu·ªëi tu·∫ßn tr∆∞·ªõc kh√¥ng?",
      "answerOptions": [
        { "text": "Did", "rationale": "SAI: H·ªèi v·ªã tr√≠ (at home) d√πng to be.", "isCorrect": false },
        { "text": "Was", "rationale": "SAI: Ch·ªß ng·ªØ s·ªë nhi·ªÅu (parents).", "isCorrect": false },
        { "text": "Were", "rationale": "ƒê√öNG: S·ªë nhi·ªÅu qu√° kh·ª©.", "isCorrect": true },
        { "text": "Do", "rationale": "SAI: Hi·ªán t·∫°i.", "isCorrect": false }
      ]
    },
    {
      "questionNumber": 24,
      "question": "He ______ the box and took out a gift.",
      "translation": "Anh ·∫•y ƒë√£ m·ªü h·ªôp v√† l·∫•y ra m·ªôt m√≥n qu√†.",
      "answerOptions": [
        { "text": "open", "rationale": "SAI: Hi·ªán t·∫°i.", "isCorrect": false },
        { "text": "opened", "rationale": "ƒê√öNG: ƒê·ªông t·ª´ quy t·∫Øc th√™m -ed.", "isCorrect": true },
        { "text": "opens", "rationale": "SAI: Hi·ªán t·∫°i ng√¥i 3.", "isCorrect": false },
        { "text": "opening", "rationale": "SAI: V-ing.", "isCorrect": false }
      ]
    },
    {
      "questionNumber": 25,
      "question": "Why ______ you sad yesterday?",
      "translation": "T·∫°i sao h√¥m qua b·∫°n bu·ªìn?",
      "answerOptions": [
        { "text": "did", "rationale": "SAI: 'Sad' l√† t√≠nh t·ª´.", "isCorrect": false },
        { "text": "was", "rationale": "SAI: 'You' kh√¥ng ƒëi v·ªõi 'was'.", "isCorrect": false },
        { "text": "were", "rationale": "ƒê√öNG: T√≠nh t·ª´ + You -> Were.", "isCorrect": true },
        { "text": "are", "rationale": "SAI: Sai th√¨.", "isCorrect": false }
      ]
    },
    {
      "questionNumber": 26,
      "question": "They ______ to London last month.",
      "translation": "H·ªç ƒë√£ bay t·ªõi London th√°ng tr∆∞·ªõc.",
      "answerOptions": [
        { "text": "flied", "rationale": "SAI: Sai ch√≠nh t·∫£.", "isCorrect": false },
        { "text": "flyed", "rationale": "SAI: Sai ch√≠nh t·∫£.", "isCorrect": false },
        { "text": "flew", "rationale": "ƒê√öNG: B·∫•t quy t·∫Øc (Fly -> Flew).", "isCorrect": true },
        { "text": "flown", "rationale": "SAI: V3 (Ph√¢n t·ª´).", "isCorrect": false }
      ]
    },
    {
      "questionNumber": 27,
      "question": "I ______ tired, but now I feel better.",
      "translation": "T√¥i ƒë√£ m·ªát, nh∆∞ng gi·ªù t√¥i th·∫•y ƒë·ª° h∆°n.",
      "answerOptions": [
        { "text": "were", "rationale": "SAI: 'I' kh√¥ng ƒëi v·ªõi 'were' ·ªü c√¢u k·ªÉ.", "isCorrect": false },
        { "text": "was", "rationale": "ƒê√öNG: 'I' + 'was'.", "isCorrect": true },
        { "text": "did", "rationale": "SAI: 'Tired' l√† t√≠nh t·ª´.", "isCorrect": false },
        { "text": "am", "rationale": "SAI: M√¢u thu·∫´n v·ªõi 'b√¢y gi·ªù ƒë·ª° h∆°n' (tr∆∞·ªõc ƒë√≥ ph·∫£i kh√°c b√¢y gi·ªù).", "isCorrect": false }
      ]
    },
    {
      "questionNumber": 28,
      "question": "______ he ______ you with the project?",
      "translation": "Anh ·∫•y c√≥ gi√∫p b·∫°n l√†m d·ª± √°n kh√¥ng?",
      "answerOptions": [
        { "text": "Did / helped", "rationale": "SAI: D∆∞ -ed.", "isCorrect": false },
        { "text": "Did / help", "rationale": "ƒê√öNG: C√¢u h·ªèi Did + V nguy√™n th·ªÉ.", "isCorrect": true },
        { "text": "Was / help", "rationale": "SAI: Ng·ªØ ph√°p.", "isCorrect": false },
        { "text": "Does / help", "rationale": "SAI: Hi·ªán t·∫°i.", "isCorrect": false }
      ]
    },
    {
      "questionNumber": 29,
      "question": "We ______ any photos at the museum.",
      "translation": "Ch√∫ng t√¥i ƒë√£ KH√îNG ch·ª•p b·ª©c ·∫£nh n√†o ·ªü b·∫£o t√†ng.",
      "answerOptions": [
        { "text": "didn't took", "rationale": "SAI: D∆∞ qu√° kh·ª© 'took'.", "isCorrect": false },
        { "text": "didn't take", "rationale": "ƒê√öNG: Didn't + V nguy√™n th·ªÉ (take).", "isCorrect": true },
        { "text": "no take", "rationale": "SAI: Ng·ªØ ph√°p.", "isCorrect": false },
        { "text": "weren't take", "rationale": "SAI: To be + V nguy√™n th·ªÉ.", "isCorrect": false }
      ]
    },
    {
      "questionNumber": 30,
      "question": "Who ______ the winner of the contest last year?",
      "translation": "Ai l√† ng∆∞·ªùi chi·∫øn th·∫Øng cu·ªôc thi nƒÉm ngo√°i?",
      "answerOptions": [
        { "text": "did", "rationale": "SAI: H·ªèi v·ªÅ danh t·ª´ 'winner' l√† ai -> d√πng to be.", "isCorrect": false },
        { "text": "was", "rationale": "ƒê√öNG: 'Who' v√† 'Winner' (s·ªë √≠t) -> was.", "isCorrect": true },
        { "text": "were", "rationale": "SAI: Winner l√† s·ªë √≠t.", "isCorrect": false },
        { "text": "is", "rationale": "SAI: Sai th√¨.", "isCorrect": false }
      ]
    }
];

        let score = 0;
        const quizArea = document.getElementById('quiz-area');

        // --- RENDER QUIZ ---
        function renderQuiz() {
            quizArea.innerHTML = '';
            questions.forEach((q, index) => {
                const card = document.createElement('div');
                card.className = 'question-card';
                card.id = `question-${index}`;

                // Header
                const header = document.createElement('div');
                header.className = 'question-header';
                header.innerHTML = `
                    <span class="q-number">C√¢u ${q.questionNumber}</span>
                    <i class="fas fa-star" style="color: #f1c40f;"></i>
                `;

                // Question Text
                const qText = document.createElement('div');
                qText.className = 'question-text';
                qText.textContent = q.question;

                // Options Grid
                const grid = document.createElement('div');
                grid.className = 'options-grid';

                q.answerOptions.forEach((opt, i) => {
                    const btn = document.createElement('button');
                    btn.className = 'option-btn';
                    btn.innerHTML = `<span style="font-weight:800; color:var(--primary-color)">${String.fromCharCode(65+i)}.</span> ${opt.text}`;
                    btn.onclick = () => checkAnswer(index, i, btn, opt.isCorrect, q);
                    grid.appendChild(btn);
                });

                // Explanation Box (Hidden initially)
                const expBox = document.createElement('div');
                expBox.className = 'explanation-box';
                expBox.id = `exp-${index}`;
                
                // Build Detailed Explanation Content
                let expHTML = `
                    <div class="exp-header">
                        <i class="fas fa-chalkboard-teacher"></i> Ms Mai An gi·∫£i th√≠ch chi ti·∫øt:
                    </div>
                    <div class="exp-content">
                        <p><span class="exp-label">D·ªãch c√¢u h·ªèi:</span> <em>"${q.translation}"</em></p>
                        <hr style="border: 0; border-top: 1px dashed #ccc; margin: 10px 0;">
                        <p><span class="exp-label">Ph√¢n t√≠ch ƒë√°p √°n:</span></p>
                        <ul style="list-style: none; padding-left: 5px;">
                `;

                q.answerOptions.forEach((opt, i) => {
                    const icon = opt.isCorrect ? '<i class="fas fa-check-circle" style="color:var(--correct-color)"></i>' : '<i class="fas fa-times-circle" style="color:var(--wrong-color)"></i>';
                    const colorStyle = opt.isCorrect ? 'color: var(--correct-color); font-weight:bold;' : 'color: #555;';
                    expHTML += `<li style="margin-bottom: 5px; ${colorStyle}">${String.fromCharCode(65+i)}. ${opt.text} ‚Äî ${opt.rationale} ${icon}</li>`;
                });

                expHTML += `</ul></div>`;
                expBox.innerHTML = expHTML;

                // Append all
                card.appendChild(header);
                card.appendChild(qText);
                card.appendChild(grid);
                card.appendChild(expBox);
                quizArea.appendChild(card);
            });
        }

        // --- CHECK ANSWER ---
        function checkAnswer(qIndex, optIndex, btnElement, isCorrect, questionData) {
            // Disable all buttons in this card
            const card = document.getElementById(`question-${qIndex}`);
            const buttons = card.querySelectorAll('.option-btn');
            
            if (btnElement.disabled) return; // Prevent double clicks

            buttons.forEach(btn => btn.disabled = true);

            // Show explanation
            const expBox = document.getElementById(`exp-${qIndex}`);
            expBox.classList.add('show');

            if (isCorrect) {
                btnElement.classList.add('correct');
                playSound('correct');
                score++;
                triggerConfetti(btnElement);
            } else {
                btnElement.classList.add('incorrect');
                playSound('wrong');
                // Highlight the correct answer automatically
                questionData.answerOptions.forEach((opt, i) => {
                    if (opt.isCorrect) {
                        buttons[i].classList.add('correct');
                    }
                });
            }
        }

        // --- FINISH QUIZ ---
        function finishQuiz() {
            const modal = document.getElementById('result-modal');
            const scoreText = document.getElementById('final-score');
            const comment = document.getElementById('teacher-comment');

            scoreText.textContent = `${score}/${questions.length}`;
            
            if (score === questions.length) {
                comment.textContent = "Tuy·ªát v·ªùi! Em l√† thi√™n t√†i ng·ªØ ph√°p! üåüüèÜ";
                startFullConfetti();
            } else if (score >= 20) {
                comment.textContent = "L√†m t·ªët l·∫Øm! Ch·ªâ c·∫ßn c·∫©n th·∫≠n h∆°n m·ªôt ch√∫t n·ªØa th√¥i! üí™";
            } else {
                comment.textContent = "C·ªë g·∫Øng l√™n nh√©! H√£y xem l·∫°i ph·∫ßn gi·∫£i th√≠ch ƒë·ªÉ hi·ªÉu r√µ h∆°n nha! üìö";
            }

            modal.style.display = 'flex';
        }

        // --- CONFETTI EFFECT (Mini canvas interaction) ---
        function triggerConfetti(element) {
            const rect = element.getBoundingClientRect();
            const x = (rect.left + rect.width / 2) / window.innerWidth;
            const y = (rect.top + rect.height / 2) / window.innerHeight;
            
            // Simple localized burst logic could go here, 
            // but for simplicity, we rely on the full screen confetti for the grand finale 
            // and a simple CSS pulse for individual correct answers.
        }

        // Full Screen Confetti Logic
        const canvas = document.getElementById('confetti-canvas');
        const ctx = canvas.getContext('2d');
        canvas.width = window.innerWidth;
        canvas.height = window.innerHeight;
        let confetti = [];

        function startFullConfetti() {
            for (let i = 0; i < 100; i++) {
                confetti.push({
                    x: Math.random() * canvas.width,
                    y: Math.random() * canvas.height - canvas.height,
                    color: `hsl(${Math.random() * 360}, 100%, 50%)`,
                    size: Math.random() * 10 + 5,
                    speed: Math.random() * 5 + 2,
                    angle: Math.random() * 6.28
                });
            }
            animateConfetti();
        }

        function animateConfetti() {
            ctx.clearRect(0, 0, canvas.width, canvas.height);
            confetti.forEach((p, i) => {
                p.y += p.speed;
                p.x += Math.sin(p.angle) * 2;
                ctx.fillStyle = p.color;
                ctx.fillRect(p.x, p.y, p.size, p.size);
                
                if (p.y > canvas.height) confetti[i].y = -10;
            });
            requestAnimationFrame(animateConfetti);
        }

        // Init
        renderQuiz();

    </script>
</body>
</html>
