<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>English Quiz - Ms Mai An ULIS</title>
    <link href="https://fonts.googleapis.com/css2?family=Nunito:wght@400;600;700;800&display=swap" rel="stylesheet">
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdn.jsdelivr.net/npm/canvas-confetti@1.5.1/dist/confetti.browser.min.js"></script>
    <style>
        body {
            font-family: 'Nunito', sans-serif;
            background-color: #f0f2f5;
            background-image: radial-gradient(#8854C0 0.5px, transparent 0.5px), radial-gradient(#8854C0 0.5px, #f0f2f5 0.5px);
            background-size: 20px 20px;
            background-position: 0 0, 10px 10px;
            color: #2d3436;
        }

        .primary-color { color: #8854C0; }
        .secondary-color { color: #00C9A7; }
        .bg-primary { background-color: #8854C0; }
        .bg-secondary { background-color: #00C9A7; }

        .quiz-card {
            background: white;
            border-radius: 24px;
            box-shadow: 0 10px 0 #dfe6e9;
            transition: transform 0.2s;
        }

        .option-btn {
            border: 2px solid #dfe6e9;
            border-bottom: 5px solid #dfe6e9;
            border-radius: 18px;
            transition: all 0.1s ease;
            text-align: left;
            padding: 15px 20px;
            cursor: pointer;
            background: white;
            position: relative;
            overflow: hidden;
        }

        .option-btn:hover {
            transform: scale(1.02);
            background-color: #f9f9f9;
        }

        .option-btn:active {
            transform: translateY(3px);
            border-bottom-width: 2px;
        }

        .option-correct {
            background-color: #d1fae5 !important;
            border-color: #00D26A !important;
            border-bottom-color: #00a854 !important;
            color: #065f46;
        }

        .option-wrong {
            background-color: #fee2e2 !important;
            border-color: #FF4757 !important;
            border-bottom-color: #d63031 !important;
            color: #991b1b;
        }

        .explanation-box {
            display: none;
            animation: slideIn 0.4s ease-out forwards;
            border-left: 6px solid #8854C0;
            background-color: #f3f0ff;
        }

        @keyframes slideIn {
            from { opacity: 0; transform: translateY(10px); }
            to { opacity: 1; transform: translateY(0); }
        }

        @keyframes shake {
            0%, 100% { transform: translateX(0); }
            25% { transform: translateX(-8px); }
            75% { transform: translateX(8px); }
        }

        .shake { animation: shake 0.3s ease-in-out; }

        .progress-bar {
            height: 12px;
            border-radius: 6px;
            background: #e2e8f0;
            overflow: hidden;
        }

        .progress-fill {
            height: 100%;
            background: linear-gradient(90deg, #8854C0, #00C9A7);
            transition: width 0.5s ease;
        }

        .glossary-table th { background-color: #8854C0; color: white; }
        .glossary-table tr:nth-child(even) { background-color: #f8f4ff; }

        /* Custom Popup */
        #result-modal {
            display: none;
            position: fixed;
            inset: 0;
            background: rgba(0,0,0,0.6);
            align-items: center;
            justify-content: center;
            z-index: 50;
        }
    </style>
</head>
<body class="p-4 md:p-8">

    <!-- Header -->
    <header class="text-center mb-8">
        <h1 class="text-4xl md:text-5xl font-extrabold primary-color mb-2">B√ÄI T·∫¨P TI·∫æNG ANH: S·∫ÆP X·∫æP & VI·∫æT L·∫†I C√ÇU</h1>
        <p class="text-lg font-bold text-gray-500">Gi√°o vi√™n t·∫°o: <span class="text-pink-500">Ms Mai An ULIS</span></p>
    </header>

    <main class="max-w-4xl mx-auto">
        <!-- Progress -->
        <div class="mb-6">
            <div class="flex justify-between items-center mb-2 font-bold text-gray-600">
                <span id="progress-text">C√¢u h·ªèi: 1/16</span>
                <span id="score-text">ƒê√∫ng: 0</span>
            </div>
            <div class="progress-bar">
                <div id="progress-fill" class="progress-fill" style="width: 6.25%"></div>
            </div>
        </div>

        <!-- Quiz Container -->
        <div id="quiz-container">
            <!-- Questions will be injected here -->
        </div>

        <!-- Glossary Section -->
        <div class="mt-12 bg-white p-6 rounded-3xl shadow-lg border-2 border-dashed border-purple-200">
            <h3 class="text-2xl font-bold primary-color mb-4 flex items-center">
                <span class="mr-2">üìö</span> B·∫£ng T·ª´ V·ª±ng N√¢ng Cao (Glossary)
            </h3>
            <div class="overflow-x-auto">
                <table class="w-full glossary-table text-left border-collapse rounded-xl overflow-hidden">
                    <thead>
                        <tr>
                            <th class="p-3">T·ª´ v·ª±ng (Word)</th>
                            <th class="p-3">Lo·∫°i t·ª´</th>
                            <th class="p-3">Nghƒ©a ti·∫øng Vi·ªát</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr><td class="p-3 font-bold">Television programme</td><td class="p-3">Noun phrase</td><td class="p-3">Ch∆∞∆°ng tr√¨nh truy·ªÅn h√¨nh</td></tr>
                        <tr><td class="p-3 font-bold">MC (Master of Ceremonies)</td><td class="p-3">Noun</td><td class="p-3">Ng∆∞·ªùi d·∫´n ch∆∞∆°ng tr√¨nh</td></tr>
                        <tr><td class="p-3 font-bold">Spend (time)</td><td class="p-3">Verb</td><td class="p-3">D√†nh (th·ªùi gian)</td></tr>
                        <tr><td class="p-3 font-bold">Cartoon</td><td class="p-3">Noun</td><td class="p-3">Phim ho·∫°t h√¨nh</td></tr>
                        <tr><td class="p-3 font-bold">Favourite</td><td class="p-3">Adjective</td><td class="p-3">ƒê∆∞·ª£c y√™u th√≠ch nh·∫•t</td></tr>
                        <tr><td class="p-3 font-bold">Fond of</td><td class="p-3">Adjective phrase</td><td class="p-3">Th√≠ch th√∫, ham th√≠ch</td></tr>
                        <tr><td class="p-3 font-bold">Novel</td><td class="p-3">Noun</td><td class="p-3">Ti·ªÉu thuy·∫øt</td></tr>
                        <tr><td class="p-3 font-bold">Friendly</td><td class="p-3">Adjective</td><td class="p-3">Th√¢n thi·ªán</td></tr>
                        <tr><td class="p-3 font-bold">Interesting</td><td class="p-3">Adjective</td><td class="p-3">Th√∫ v·ªã</td></tr>
                        <tr><td class="p-3 font-bold">Tonight</td><td class="p-3">Adverb</td><td class="p-3">T·ªëi nay</td></tr>
                    </tbody>
                </table>
            </div>
        </div>

        <!-- Controls -->
        <div class="flex justify-between mt-8">
            <button id="prev-btn" onclick="changeQuestion(-1)" class="bg-gray-400 text-white px-6 py-3 rounded-2xl font-bold opacity-50 cursor-not-allowed">Quay l·∫°i</button>
            <button id="next-btn" onclick="changeQuestion(1)" class="bg-secondary text-white px-8 py-3 rounded-2xl font-bold shadow-lg hover:opacity-90">Ti·∫øp theo</button>
        </div>

        <div class="text-center mt-10">
            <button onclick="finishQuiz()" class="bg-primary text-white text-xl px-12 py-4 rounded-full font-black shadow-xl hover:scale-105 transition-transform">N·ªòP B√ÄI CH·∫§M ƒêI·ªÇM</button>
        </div>
    </main>

    <!-- Result Modal -->
    <div id="result-modal">
        <div class="bg-white p-8 rounded-3xl max-w-sm w-full text-center shadow-2xl m-4">
            <div id="result-icon" class="text-6xl mb-4">üéâ</div>
            <h2 class="text-3xl font-black primary-color mb-2">K·∫æT QU·∫¢</h2>
            <p id="result-score" class="text-5xl font-bold mb-4">0/16</p>
            <p id="result-comment" class="text-gray-600 italic mb-6">"Tuy·ªát v·ªùi! Con ƒë√£ r·∫•t c·ªë g·∫Øng!"</p>
            <button onclick="location.reload()" class="w-full bg-secondary text-white font-bold py-3 rounded-2xl shadow-lg">L√ÄM L·∫†I</button>
        </div>
    </div>

    <!-- Audio (Virtual Synth) -->
    <script>
        const quizData = [
            {
                q: "Arrange the words to make a sentence: <b>on / what / tonight / television / is?</b>",
                options: ["What is on television tonight?", "What is television on tonight?", "What on television is tonight?", "Tonight what is on television?"],
                correct: 0,
                explanation: {
                    vocab: [
                        "A. What is on television tonight? (C√¢u ƒë√∫ng)",
                        "B. What is television on tonight? (Sai: nghƒ©a l√† Tivi ƒëang n·∫±m tr√™n c√°i g√¨)",
                        "C. What on television is tonight? (Sai tr·∫≠t t·ª± ng·ªØ ph√°p)",
                        "D. Tonight what is on television? (Sai: T·ª´ ƒë·ªÉ h·ªèi ph·∫£i ƒë·ª©ng ƒë·∫ßu)"
                    ],
                    meaning: "D·ªãch nghƒ©a: T·ªëi nay tr√™n tivi c√≥ g√¨ th·∫ø?",
                    analysis: "C√¥ Mai An gi·∫£i th√≠ch: Trong c√¢u h·ªèi Wh-, ta d√πng c·∫•u tr√∫c <b>Wh-word + is + prepositional phrase + time?</b>. C·ª•m 'on television' ch·ªâ tr·∫°ng th√°i ph√°t s√≥ng."
                }
            },
            {
                q: "Arrange the words to make a sentence: <b>favourite / MC / your / who / is / television?</b>",
                options: ["Who is your television favourite MC?", "Who is your favourite television MC?", "Who your favourite television MC is?", "Who is MC television your favourite?"],
                correct: 1,
                explanation: {
                    vocab: [
                        "A. ...television favourite MC: Sai tr·∫≠t t·ª± t√≠nh t·ª´.",
                        "B. ...favourite television MC: C√¢u ƒë√∫ng.",
                        "C. ...MC is?: Sai c·∫•u tr√∫c c√¢u h·ªèi (thi·∫øu ƒë·∫£o ng·ªØ).",
                        "D. ...MC television your favourite: Sai ho√†n to√†n."
                    ],
                    meaning: "D·ªãch nghƒ©a: Ai l√† MC truy·ªÅn h√¨nh y√™u th√≠ch c·ªßa b·∫°n?",
                    analysis: "C√¥ Mai An gi·∫£i th√≠ch: C·∫•u tr√∫c c√¢u h·ªèi v·ªõi Who: <b>Who + is + Noun Phrase?</b>. C·ª•m danh t·ª´ 'favourite television MC' s·∫Øp x·∫øp theo th·ª© t·ª±: T√≠nh t·ª´ s·ªü th√≠ch + danh t·ª´ gh√©p."
                }
            },
            {
                q: "Arrange the words to make a sentence: <b>Tina / time / television / does / how much / spend / watching?</b>",
                options: ["How much does Tina spend time watching television?", "How much time Tina does spend watching television?", "How much time does Tina spend watching television?", "Does Tina spend how much time watching television?"],
                correct: 2,
                explanation: {
                    vocab: [
                        "A. How much does Tina...: Sai v√¨ thi·∫øu danh t·ª´ 'time' sau 'How much'.",
                        "B. ...Tina does spend...: Sai v√¨ ch∆∞a ƒë·∫£o tr·ª£ ƒë·ªông t·ª´.",
                        "C. How much time does Tina spend...: C√¢u ƒë√∫ng.",
                        "D. Does Tina spend...: Sai v√¨ t·ª´ ƒë·ªÉ h·ªèi ph·∫£i ƒë·ª©ng ƒë·∫ßu."
                    ],
                    meaning: "D·ªãch nghƒ©a: Tina d√†nh bao nhi√™u th·ªùi gian ƒë·ªÉ xem tivi?",
                    analysis: "C√¥ Mai An gi·∫£i th√≠ch: C·∫•u tr√∫c <b>How much + Noun (kh√¥ng ƒë·∫øm ƒë∆∞·ª£c) + tr·ª£ ƒë·ªông t·ª´ + S + V?</b>. Nh·ªõ l√† spend + time + V-ing nh√©!"
                }
            },
            {
                q: "Arrange the words to make a sentence: <b>they / like / do / why / cartoons / to watch?</b>",
                options: ["Why do they like to watch cartoons?", "Why they do like to watch cartoons?", "Why do they like watch to cartoons?", "Why do they like cartoons to watch?"],
                correct: 0,
                explanation: {
                    vocab: [
                        "A. Why do they like to watch cartoons?: C√¢u ƒë√∫ng.",
                        "B. Why they do like...: Sai v√¨ thi·∫øu ƒë·∫£o ng·ªØ 'do'.",
                        "C. ...like watch to...: Sai c·∫•u tr√∫c 'like to V'.",
                        "D. ...cartoons to watch: Sai tr·∫≠t t·ª± t·ª´."
                    ],
                    meaning: "D·ªãch nghƒ©a: T·∫°i sao h·ªç l·∫°i th√≠ch xem phim ho·∫°t h√¨nh?",
                    analysis: "C√¥ Mai An gi·∫£i th√≠ch: C·∫•u tr√∫c c√¢u h·ªèi <b>Why + do/does + S + V?</b>. Sau 'like' ta c√≥ th·ªÉ d√πng 'to watch' ho·∫∑c 'watching'."
                }
            },
            {
                q: "Arrange the words to make a sentence: <b>best / television / like / what / do / you / programme?</b>",
                options: ["What do you like television programme best?", "What television programme do you like?", "What best television programme do you like?", "What television programme do you like best?"],
                correct: 3,
                explanation: {
                    vocab: [
                        "A. ...like television programme best: Sai v·ªã tr√≠ t√¢n ng·ªØ.",
                        "B. ...do you like?: Thi·∫øu t·ª´ 'best'.",
                        "C. ...best television programme: Sai tr·∫≠t t·ª±.",
                        "D. What television programme do you like best?: C√¢u ƒë√∫ng."
                    ],
                    meaning: "D·ªãch nghƒ©a: B·∫°n th√≠ch ch∆∞∆°ng tr√¨nh truy·ªÅn h√¨nh n√†o nh·∫•t?",
                    analysis: "C√¥ Mai An gi·∫£i th√≠ch: 'What' ƒëi k√®m v·ªõi danh t·ª´ t·∫°o th√†nh c·ª•m t·ª´ ƒë·ªÉ h·ªèi 'What television programme'. 'Best' l√† tr·∫°ng t·ª´ ƒë·ª©ng cu·ªëi ƒë·ªÉ b·ªï nghƒ©a cho 'like'."
                }
            },
            {
                q: "Arrange the words to make a sentence: <b>start / the / game show / what time / does?</b>",
                options: ["What time does the game show start?", "What time the game show does start?", "Does the game show start what time?", "What does the game show start time?"],
                correct: 0,
                explanation: {
                    vocab: [
                        "A. What time does the game show start?: C√¢u ƒë√∫ng.",
                        "B. ...the game show does start: Sai ƒë·∫£o ng·ªØ.",
                        "C. Does the game show start...: Sai v·ªã tr√≠ Wh-.",
                        "D. ...start time?: Sai ng·ªØ ph√°p."
                    ],
                    meaning: "D·ªãch nghƒ©a: Ch∆∞∆°ng tr√¨nh tr√≤ ch∆°i b·∫Øt ƒë·∫ßu l√∫c m·∫•y gi·ªù?",
                    analysis: "C√¥ Mai An gi·∫£i th√≠ch: C·∫•u tr√∫c h·ªèi gi·ªù gi·∫•c: <b>What time + do/does + S + V-inf?</b>."
                }
            },
            {
                q: "Arrange the words to make a sentence: <b>Liz / go to / how often / does / the cinema?</b>",
                options: ["How often Liz does go to the cinema?", "Does Liz go to the cinema how often?", "How often does Liz go to the cinema?", "How often does Liz go the cinema to?"],
                correct: 2,
                explanation: {
                    vocab: [
                        "A. ...Liz does go...: Sai ƒë·∫£o ng·ªØ.",
                        "B. Does Liz go...: Sai v·ªã tr√≠ Wh-.",
                        "C. How often does Liz go to the cinema?: C√¢u ƒë√∫ng.",
                        "D. ...go the cinema to: Sai v·ªã tr√≠ gi·ªõi t·ª´ 'to'."
                    ],
                    meaning: "D·ªãch nghƒ©a: Liz ƒëi xem phim th∆∞·ªùng xuy√™n nh∆∞ th·∫ø n√†o?",
                    analysis: "C√¥ Mai An gi·∫£i th√≠ch: H·ªèi t·∫ßn su·∫•t d√πng 'How often'. C·ª•m c·ªë ƒë·ªãnh l√† 'go to the cinema'."
                }
            },
            {
                q: "Arrange the words to make a sentence: <b>you / watch / do / television / usually / when?</b>",
                options: ["When do you usually watch television?", "When you usually do watch television?", "When do usually you watch television?", "Usually when do you watch television?"],
                correct: 0,
                explanation: {
                    vocab: [
                        "A. When do you usually watch television?: C√¢u ƒë√∫ng.",
                        "B. ...you usually do...: Sai tr·∫≠t t·ª±.",
                        "C. ...do usually you...: Tr·∫°ng t·ª´ t·∫ßn su·∫•t ph·∫£i ƒë·ª©ng sau ch·ªß ng·ªØ trong c√¢u h·ªèi.",
                        "D. Usually when...: Sai v·ªã tr√≠ Wh-."
                    ],
                    meaning: "D·ªãch nghƒ©a: B·∫°n th∆∞·ªùng xem tivi khi n√†o?",
                    analysis: "C√¥ Mai An gi·∫£i th√≠ch: Tr·∫°ng t·ª´ t·∫ßn su·∫•t (usually) ƒë·ª©ng gi·ªØa ch·ªß ng·ªØ v√† ƒë·ªông t·ª´ ch√≠nh trong c√¢u h·ªèi nghi v·∫•n c√≥ tr·ª£ ƒë·ªông t·ª´."
                }
            },
            {
                q: "Complete: <b>What programme do you like best?</b> => What‚Äôs _______________?",
                options: ["...your favourite programme?", "...programme do you like best?", "...you like best programme?", "...your best programme?"],
                correct: 0,
                explanation: {
                    vocab: [
                        "A. ...your favourite programme?: C√¢u ƒë√∫ng.",
                        "B. ...programme do you like best?: Sai v√¨ d∆∞ 'What's' (What is).",
                        "C. ...you like best...: Sai ng·ªØ ph√°p.",
                        "D. ...your best programme?: Sai nghƒ©a (ch∆∞∆°ng tr√¨nh t·ªët nh·∫•t # ch∆∞∆°ng tr√¨nh y√™u th√≠ch)."
                    ],
                    meaning: "D·ªãch nghƒ©a: Ch∆∞∆°ng tr√¨nh y√™u th√≠ch c·ªßa b·∫°n l√† g√¨?",
                    analysis: "C√¥ Mai An gi·∫£i th√≠ch: C·∫•u tr√∫c 'Like something best' t∆∞∆°ng ƒë∆∞∆°ng v·ªõi 'Something is my favourite'."
                }
            },
            {
                q: "Complete: <b>It‚Äôs not good for children to spend too much time watching television.</b> => Children _______________",
                options: ["...must spend too much time...", "...should not spend too much time watching television.", "...should spend too much time...", "...cannot spend too much time..."],
                correct: 1,
                explanation: {
                    vocab: [
                        "A. must: ph·∫£i (sai nghƒ©a).",
                        "B. should not: kh√¥ng n√™n (C√¢u ƒë√∫ng).",
                        "C. should: n√™n (sai nghƒ©a).",
                        "D. cannot: kh√¥ng th·ªÉ (sai s·∫Øc th√°i)."
                    ],
                    meaning: "D·ªãch nghƒ©a: Tr·∫ª em kh√¥ng n√™n d√†nh qu√° nhi·ªÅu th·ªùi gian xem tivi.",
                    analysis: "C√¥ Mai An gi·∫£i th√≠ch: 'It's not good to do sth' l√† m·ªôt l·ªùi khuy√™n, t∆∞∆°ng ƒë∆∞∆°ng v·ªõi 'Should not do sth'."
                }
            },
            {
                q: "Complete: <b>Jim loves animals, so he likes to watch Animal programme.</b> => Jim likes to watch Animal programme _______________",
                options: ["...because he loves animals.", "...so he loves animals.", "...although he loves animals.", "...but he loves animals."],
                correct: 0,
                explanation: {
                    vocab: [
                        "A. because: b·ªüi v√¨ (C√¢u ƒë√∫ng).",
                        "B. so: v√¨ v·∫≠y (sai logic).",
                        "C. although: m·∫∑c d√π (sai logic).",
                        "D. but: nh∆∞ng (sai logic)."
                    ],
                    meaning: "D·ªãch nghƒ©a: Jim th√≠ch xem ch∆∞∆°ng tr√¨nh ƒê·ªông v·∫≠t v√¨ c·∫≠u ·∫•y y√™u ƒë·ªông v·∫≠t.",
                    analysis: "C√¥ Mai An gi·∫£i th√≠ch: 'So' ch·ªâ k·∫øt qu·∫£, 'Because' ch·ªâ nguy√™n nh√¢n. Ta ƒë·∫£o m·ªánh ƒë·ªÅ nguy√™n nh√¢n ra sau th√¨ d√πng 'because'."
                }
            },
            {
                q: "Complete: <b>My sister likes to watch cartoons.</b> => My sister is fond _______________",
                options: ["...in watching cartoons.", "...with watching cartoons.", "...of watching cartoons.", "...about watching cartoons."],
                correct: 2,
                explanation: {
                    vocab: [
                        "A. in: sai gi·ªõi t·ª´ (d√πng cho interested).",
                        "B. with: sai gi·ªõi t·ª´.",
                        "C. of watching cartoons: C√¢u ƒë√∫ng.",
                        "D. about: sai gi·ªõi t·ª´ (d√πng cho crazy)."
                    ],
                    meaning: "D·ªãch nghƒ©a: Ch·ªã g√°i t√¥i th√≠ch xem phim ho·∫°t h√¨nh.",
                    analysis: "C√¥ Mai An gi·∫£i th√≠ch: C·∫•u tr√∫c <b>To be fond of + V-ing</b> ƒë·ªìng nghƒ©a v·ªõi 'To like/love + V-ing'."
                }
            },
            {
                q: "Complete: <b>How much time do you spend watching television?</b> => How many _______________",
                options: ["...times do you spend...?", "...time do you spend...?", "...hours do you spend watching television?", "...long do you spend...?"],
                correct: 2,
                explanation: {
                    vocab: [
                        "A. times: s·ªë l·∫ßn (sai nghƒ©a).",
                        "B. many time: sai ng·ªØ ph√°p (Time kh√¥ng ƒë·∫øm ƒë∆∞·ª£c).",
                        "C. hours: s·ªë gi·ªù (C√¢u ƒë√∫ng).",
                        "D. long: sai c·∫•u tr√∫c."
                    ],
                    meaning: "D·ªãch nghƒ©a: B·∫°n d√†nh bao nhi√™u ti·∫øng ƒë·ªÉ xem tivi?",
                    analysis: "C√¥ Mai An gi·∫£i th√≠ch: 'How much time' h·ªèi v·ªÅ l∆∞·ª£ng th·ªùi gian. Khi chuy·ªÉn sang 'How many' ta ph·∫£i d√πng danh t·ª´ ƒë·∫øm ƒë∆∞·ª£c nh∆∞ 'hours'."
                }
            },
            {
                q: "Complete: <b>How about going to the cinema tonight?</b> => Shall _______________",
                options: ["...we going to the cinema tonight?", "...we go to the cinema tonight?", "...we to go to the cinema tonight?", "...us go to the cinema tonight?"],
                correct: 1,
                explanation: {
                    vocab: [
                        "A. ...we going...: Sai (Shall + V-inf).",
                        "B. ...we go to the cinema tonight?: C√¢u ƒë√∫ng.",
                        "C. ...we to go...: Sai c·∫•u tr√∫c.",
                        "D. ...us go...: Sai ch·ªß ng·ªØ."
                    ],
                    meaning: "D·ªãch nghƒ©a: Ch√∫ng ta ƒëi xem phim t·ªëi nay nh√©?",
                    analysis: "C√¥ Mai An gi·∫£i th√≠ch: 'How about + V-ing' v√† 'Shall we + V-inf' ƒë·ªÅu l√† c√°c c·∫•u tr√∫c ƒë∆∞a ra l·ªùi g·ª£i √Ω."
                }
            },
            {
                q: "Complete: <b>The film is not as interesting as the novel was.</b> => The novel was much _______________",
                options: ["...more interesting than the film.", "...interesting than the film.", "...as interesting as the film.", "...most interesting than the film."],
                correct: 0,
                explanation: {
                    vocab: [
                        "A. more interesting than: th√∫ v·ªã h∆°n (C√¢u ƒë√∫ng).",
                        "B. interesting than: thi·∫øu 'more'.",
                        "C. as interesting as: th√∫ v·ªã b·∫±ng (sai nghƒ©a g·ªëc).",
                        "D. most interesting: so s√°nh nh·∫•t (sai c·∫•u tr√∫c)."
                    ],
                    meaning: "D·ªãch nghƒ©a: Cu·ªën ti·ªÉu thuy·∫øt hay h∆°n b·ªô phim nhi·ªÅu.",
                    analysis: "C√¥ Mai An gi·∫£i th√≠ch: Phim kh√¥ng hay b·∫±ng truy·ªán -> Truy·ªán hay h∆°n phim. Ta d√πng 'much' ƒë·ªÉ nh·∫•n m·∫°nh m·ª©c ƒë·ªô so s√°nh h∆°n."
                }
            },
            {
                q: "Complete: <b>Although he seemed a friendly person, I didn‚Äôt like him.</b> => He seemed _______________",
                options: ["...a friendly person, so I didn‚Äôt like him.", "...a friendly person, but I didn‚Äôt like him.", "...a friendly person, and I didn‚Äôt like him.", "...a friendly person, because I didn‚Äôt like him."],
                correct: 1,
                explanation: {
                    vocab: [
                        "A. so: v√¨ v·∫≠y (sai logic).",
                        "B. but: nh∆∞ng (C√¢u ƒë√∫ng).",
                        "C. and: v√† (kh√¥ng ch·ªâ s·ª± t∆∞∆°ng ph·∫£n).",
                        "D. because: b·ªüi v√¨ (sai logic)."
                    ],
                    meaning: "D·ªãch nghƒ©a: Anh ·∫•y c√≥ v·∫ª th√¢n thi·ªán, nh∆∞ng t√¥i kh√¥ng th√≠ch anh ·∫•y.",
                    analysis: "C√¥ Mai An gi·∫£i th√≠ch: 'Although' ƒë·ª©ng ƒë·∫ßu c√¢u t∆∞∆°ng ƒë∆∞∆°ng v·ªõi vi·ªác d√πng 'but' ·ªü gi·ªØa hai m·ªánh ƒë·ªÅ ƒë·ªÉ ch·ªâ s·ª± ƒë·ªëi l·∫≠p."
                }
            }
        ];

        let currentQ = 0;
        let score = 0;
        let answered = new Array(quizData.length).fill(null);

        function initAudio() {
            window.audioCtx = new (window.AudioContext || window.webkitAudioContext)();
        }

        function playSound(type) {
            if (!window.audioCtx) initAudio();
            const osc = audioCtx.createOscillator();
            const gain = audioCtx.createGain();
            osc.connect(gain);
            gain.connect(audioCtx.destination);

            if (type === 'correct') {
                osc.type = 'sine';
                osc.frequency.setValueAtTime(523.25, audioCtx.currentTime); // C5
                osc.frequency.exponentialRampToValueAtTime(880, audioCtx.currentTime + 0.1);
                gain.gain.setValueAtTime(0.1, audioCtx.currentTime);
                gain.gain.exponentialRampToValueAtTime(0.01, audioCtx.currentTime + 0.3);
                osc.start();
                osc.stop(audioCtx.currentTime + 0.3);
            } else {
                osc.type = 'sawtooth';
                osc.frequency.setValueAtTime(150, audioCtx.currentTime);
                osc.frequency.linearRampToValueAtTime(100, audioCtx.currentTime + 0.2);
                gain.gain.setValueAtTime(0.1, audioCtx.currentTime);
                gain.gain.linearRampToValueAtTime(0.01, audioCtx.currentTime + 0.3);
                osc.start();
                osc.stop(audioCtx.currentTime + 0.3);
            }
        }

        function renderQuestion() {
            const q = quizData[currentQ];
            const container = document.getElementById('quiz-container');
            
            let optionsHTML = q.options.map((opt, i) => `
                <button class="option-btn w-full mb-3 text-lg font-semibold ${answered[currentQ] !== null ? (i === q.correct ? 'option-correct' : (i === answered[currentQ] ? 'option-wrong' : '')) : ''}" 
                        onclick="checkAnswer(${i})" 
                        ${answered[currentQ] !== null ? 'disabled' : ''}>
                    <span class="inline-block w-8 h-8 rounded-full bg-gray-100 text-center leading-8 mr-3 font-bold">${String.fromCharCode(65+i)}</span>
                    ${opt}
                </button>
            `).join('');

            container.innerHTML = `
                <div class="quiz-card p-6 md:p-8" id="card-${currentQ}">
                    <div class="text-sm font-bold uppercase tracking-widest text-gray-400 mb-2">Question ${currentQ + 1}</div>
                    <h2 class="text-xl md:text-2xl font-bold mb-6">${q.q}</h2>
                    <div class="space-y-2">
                        ${optionsHTML}
                    </div>
                    
                    <div id="explanation-${currentQ}" class="explanation-box mt-6 p-6 rounded-2xl overflow-hidden" style="${answered[currentQ] !== null ? 'display: block' : ''}">
                        <h4 class="font-black text-purple-700 mb-3 flex items-center"><span class="mr-2">üí°</span> GI·∫¢I TH√çCH CHI TI·∫æT</h4>
                        <div class="space-y-4 text-gray-700 leading-relaxed">
                            <p class="font-bold text-blue-600">${q.explanation.meaning}</p>
                            <div>
                                <p class="font-bold mb-1">1. Ph√¢n t√≠ch 4 ƒë√°p √°n:</p>
                                <ul class="list-disc ml-5 space-y-1">
                                    ${q.explanation.vocab.map(v => `<li>${v}</li>`).join('')}
                                </ul>
                            </div>
                            <div>
                                <p class="font-bold mb-1">2. T·∫°i sao ch·ªçn ƒë√°p √°n n√†y?</p>
                                <p class="bg-white p-3 rounded-xl italic">${q.explanation.analysis}</p>
                            </div>
                        </div>
                    </div>
                </div>
            `;

            updateProgress();
        }

        function checkAnswer(index) {
            if (answered[currentQ] !== null) return;
            
            const q = quizData[currentQ];
            answered[currentQ] = index;
            
            const btns = document.querySelectorAll('.option-btn');
            const card = document.getElementById(`card-${currentQ}`);

            if (index === q.correct) {
                btns[index].classList.add('option-correct');
                score++;
                playSound('correct');
                confetti({
                    particleCount: 100,
                    spread: 70,
                    origin: { y: 0.6 },
                    colors: ['#8854C0', '#00C9A7', '#FFD700']
                });
            } else {
                btns[index].classList.add('option-wrong');
                btns[q.correct].classList.add('option-correct');
                card.classList.add('shake');
                playSound('wrong');
                setTimeout(() => card.classList.remove('shake'), 500);
            }

            document.getElementById(`explanation-${currentQ}`).style.display = 'block';
            updateProgress();
        }

        function updateProgress() {
            const progress = ((currentQ + 1) / quizData.length) * 100;
            document.getElementById('progress-fill').style.width = `${progress}%`;
            document.getElementById('progress-text').innerText = `C√¢u h·ªèi: ${currentQ + 1}/${quizData.length}`;
            document.getElementById('score-text').innerText = `ƒê√∫ng: ${score}`;

            const prevBtn = document.getElementById('prev-btn');
            if (currentQ === 0) {
                prevBtn.classList.add('opacity-50', 'cursor-not-allowed');
                prevBtn.disabled = true;
            } else {
                prevBtn.classList.remove('opacity-50', 'cursor-not-allowed');
                prevBtn.disabled = false;
            }
        }

        function changeQuestion(step) {
            const nextQ = currentQ + step;
            if (nextQ >= 0 && nextQ < quizData.length) {
                currentQ = nextQ;
                renderQuestion();
            }
        }

        function finishQuiz() {
            const total = quizData.length;
            const modal = document.getElementById('result-modal');
            const scoreDisplay = document.getElementById('result-score');
            const comment = document.getElementById('result-comment');
            const icon = document.getElementById('result-icon');

            scoreDisplay.innerText = `${score}/${total}`;
            modal.style.display = 'flex';

            if (score === total) {
                icon.innerText = "üëë";
                comment.innerText = "Tuy·ªát ƒë·ªânh! Con l√† thi√™n t√†i Ti·∫øng Anh!";
                confetti({ particleCount: 200, spread: 100 });
            } else if (score >= total * 0.8) {
                icon.innerText = "üåü";
                comment.innerText = "Gi·ªèi l·∫Øm! Ch·ªâ thi·∫øu m·ªôt ch√∫t n·ªØa l√† ho√†n h·∫£o r·ªìi!";
            } else if (score >= total * 0.5) {
                icon.innerText = "üëç";
                comment.innerText = "Kh√° t·ªët! Con h√£y ƒë·ªçc k·ªπ ph·∫ßn gi·∫£i th√≠ch c·ªßa c√¥ An nh√©!";
            } else {
                icon.innerText = "üí™";
                comment.innerText = "C·ªë g·∫Øng l√™n n√†o! Xem l·∫°i b√†i v√† l√†m l·∫°i nh√© con!";
            }
        }

        // Initialize
        window.onload = () => {
            renderQuestion();
        };
    </script>
</body>
</html>
