<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Reading Quiz - Our Free-time Activities</title>
    <link href="https://fonts.googleapis.com/css2?family=Quicksand:wght@400;600;700;800&display=swap" rel="stylesheet">
    <style>
        /* --- DYNAMIC THEME & COLOR PALETTE: CREATIVE HOBBIES --- */
        :root {
            --primary: #FF8B94; /* Soft Pink - ƒê·∫°i di·ªán cho Th·ªùi trang/Ngh·ªá thu·∫≠t */
            --accent: #FFD3B6; /* Peach - ·∫§m √°p, nƒÉng ƒë·ªông */
            --secondary: #A8E6CF; /* Mint Green - T∆∞∆°i m·ªõi */
            --correct: #00b894; /* Xanh l√° */
            --incorrect: #d63031; /* ƒê·ªè cam */
            --text-dark: #2d3436;
        }

        /* HI·ªÜU ·ª®NG CHUY·ªÇN M√ÄU N·ªÄN LOANG M∆Ø·ª¢T M√Ä (ANIMATED GRADIENT) */
        body {
            margin: 0;
            padding: 0;
            font-family: 'Quicksand', sans-serif;
            color: var(--text-dark);
            height: 100vh;
            display: flex;
            flex-direction: column;
            overflow: hidden;
            
            background: linear-gradient(-45deg, #FF8B94, #FFD3B6, #A8E6CF, #fdcb6e);
            background-size: 400% 400%;
            animation: gradientBG 15s ease infinite;
            position: relative;
        }

        @keyframes gradientBG {
            0% { background-position: 0% 50%; }
            50% { background-position: 100% 50%; }
            100% { background-position: 0% 50%; }
        }

        /* SVG Pattern l∆° l·ª≠ng n·∫±m ƒë√® l√™n n·ªÅn chuy·ªÉn m√†u */
        body::before {
            content: "";
            position: absolute;
            top: 0; left: 0; right: 0; bottom: 0;
            background-image: url("data:image/svg+xml,%3Csvg width='150' height='150' viewBox='0 0 150 150' xmlns='http://www.w3.org/2000/svg'%3E%3Ctext x='20' y='30' font-size='26' opacity='0.35'%3EüßÅ%3C/text%3E%3Ctext x='100' y='70' font-size='26' opacity='0.35'%3Eüì∏%3C/text%3E%3Ctext x='40' y='120' font-size='24' opacity='0.35'%3Eüëó%3C/text%3E%3Ctext x='110' y='140' font-size='20' opacity='0.35'%3E‚ú®%3C/text%3E%3Ctext x='70' y='40' font-size='24' opacity='0.35'%3Eüé®%3C/text%3E%3C/svg%3E");
            z-index: -1;
            pointer-events: none;
        }

        /* --- HEADER & TIMER --- */
        .top-bar {
            background: rgba(255, 255, 255, 0.95);
            padding: 10px 20px;
            box-shadow: 0 6px 20px rgba(0,0,0,0.15);
            display: flex;
            justify-content: space-between;
            align-items: center;
            z-index: 100;
            border-bottom: 4px solid var(--primary);
        }

        .teacher-title {
            font-size: 16px;
            font-weight: 800;
            color: #d63031;
            background: #ffeaa7;
            padding: 8px 15px;
            border-radius: 20px;
            border: 2px dashed #fdcb6e;
        }

        .timer-container {
            display: flex;
            align-items: center;
            gap: 15px;
        }

        #timerDisplay {
            font-size: 26px;
            font-weight: 800;
            color: var(--incorrect);
            background: white;
            padding: 5px 20px;
            border-radius: 15px;
            border: 3px solid var(--accent);
            box-shadow: 0 4px 0 var(--accent);
        }

        .btn-timer {
            background: var(--primary);
            color: white;
            border: none;
            padding: 12px 25px;
            font-size: 16px;
            font-weight: 800;
            border-radius: 15px;
            cursor: pointer;
            box-shadow: 0 6px 0 #d63031;
            transition: all 0.1s;
            text-transform: uppercase;
        }
        .btn-timer:active {
            transform: translateY(6px);
            box-shadow: 0 0px 0 #d63031;
        }

        /* --- SPLIT SCREEN LAYOUT --- */
        .main-container {
            display: flex;
            flex: 1;
            overflow: hidden;
            padding: 15px;
            gap: 15px;
        }

        .left-panel, .right-panel {
            flex: 1;
            background: rgba(255, 255, 255, 0.92);
            border-radius: 25px;
            padding: 25px;
            overflow-y: auto;
            scroll-behavior: smooth;
            box-shadow: 0 10px 30px rgba(0,0,0,0.2);
            border: 3px solid white;
        }

        /* --- READING CONTENT STYLES --- */
        .passage-title {
            font-size: 32px;
            color: var(--primary);
            text-align: center;
            margin-top: 0;
            margin-bottom: 25px;
            text-transform: uppercase;
            font-weight: 900;
            text-shadow: 2px 2px 0px var(--accent);
            letter-spacing: 1px;
        }

        .paragraph-card {
            background: white;
            border-radius: 20px;
            padding: 25px;
            margin-bottom: 25px;
            box-shadow: 0 8px 0 #e1e5ee;
            border: 2px solid #f1f2f6;
            position: relative;
        }

        .paragraph-card h3 {
            margin-top: 0;
            color: var(--secondary);
            font-size: 24px;
            border-bottom: 3px dashed var(--accent);
            padding-bottom: 10px;
            display: flex;
            align-items: center;
            gap: 10px;
            color: #00b894;
        }

        .text-content {
            font-size: 19px;
            line-height: 1.7;
            color: #4a4a4a;
            font-weight: 600;
        }

        .btn-translate {
            background: #74b9ff;
            color: white;
            border: none;
            padding: 10px 20px;
            font-size: 15px;
            font-weight: 800;
            border-radius: 12px;
            cursor: pointer;
            margin-top: 15px;
            box-shadow: 0 5px 0 #0984e3;
            transition: all 0.1s;
        }
        .btn-translate:active {
            transform: translateY(5px);
            box-shadow: 0 0px 0 #0984e3;
        }

        .translation-text {
            display: none;
            margin-top: 15px;
            padding: 20px;
            background: #f1f2f6;
            border-radius: 15px;
            font-size: 17px;
            color: #2f3640;
            border-left: 6px solid var(--primary);
            font-weight: 600;
            line-height: 1.6;
        }

        /* --- GLOSSARY TABLE --- */
        .glossary-container {
            background: white;
            border-radius: 20px;
            padding: 25px;
            margin-top: 30px;
            box-shadow: 0 8px 0 #e1e5ee;
        }
        .glossary-container h3 {
            color: var(--primary);
            text-align: center;
            font-size: 22px;
            margin-top: 0;
        }
        table {
            width: 100%;
            border-collapse: collapse;
            margin-top: 15px;
        }
        th, td {
            padding: 15px;
            border-bottom: 2px solid #f1f2f6;
            text-align: left;
            font-size: 17px;
            font-weight: 600;
        }
        th {
            background: var(--primary);
            color: white;
            border-radius: 10px 10px 0 0;
        }
        tr:hover { background: #fff0f5; }

        /* --- QUIZ SECTION STYLES --- */
        .question-card {
            background: white;
            border-radius: 20px;
            padding: 30px;
            margin-bottom: 30px;
            box-shadow: 0 10px 0 #dfe4ea;
            border: 3px solid #f1f2f6;
            transition: all 0.3s;
        }

        .question-text {
            font-size: 22px;
            font-weight: 800;
            margin-bottom: 25px;
            color: #2d3436;
            line-height: 1.4;
        }

        .options-grid {
            display: flex;
            flex-direction: column;
            gap: 15px;
        }

        .option-btn {
            background: #f8f9fa;
            border: 3px solid #e9ecef;
            padding: 18px 25px;
            font-size: 20px;
            font-weight: 700;
            border-radius: 18px;
            cursor: pointer;
            text-align: left;
            transition: all 0.2s cubic-bezier(0.175, 0.885, 0.32, 1.275);
            box-shadow: 0 6px 0 #ced4da;
            color: #495057;
            display: flex;
            align-items: center;
        }

        .option-btn .opt-label {
            display: inline-block;
            width: 35px;
            height: 35px;
            line-height: 35px;
            background: #e9ecef;
            border-radius: 50%;
            text-align: center;
            margin-right: 15px;
            color: var(--primary);
            font-weight: 900;
        }

        .option-btn:hover:not(:disabled) {
            transform: scale(1.03) translateY(-4px);
            background: #fff0f5;
            border-color: var(--primary);
            box-shadow: 0 10px 0 var(--primary);
            color: #d63031;
        }
        .option-btn:hover:not(:disabled) .opt-label {
            background: var(--primary);
            color: white;
        }

        .option-btn.correct {
            background: var(--correct) !important;
            color: white !important;
            border-color: #009432 !important;
            box-shadow: 0 6px 0 #009432 !important;
        }
        .option-btn.correct .opt-label { background: white; color: var(--correct); }

        .option-btn.wrong {
            background: var(--incorrect) !important;
            color: white !important;
            border-color: #b33939 !important;
            box-shadow: 0 6px 0 #b33939 !important;
        }
        .option-btn.wrong .opt-label { background: white; color: var(--incorrect); }

        .option-btn:disabled {
            cursor: not-allowed;
        }

        /* Detailed Explanation Box */
        .explanation-box {
            display: none;
            margin-top: 25px;
            padding: 20px;
            background: #f0fdf4;
            border-radius: 15px;
            border: 3px solid var(--correct);
            font-size: 17px;
            line-height: 1.6;
            color: #166534;
            animation: slideDown 0.4s ease;
        }
        
        .exp-title {
            font-weight: 800;
            color: var(--correct);
            margin-bottom: 15px;
            font-size: 20px;
            display: flex;
            align-items: center;
            gap: 8px;
            border-bottom: 2px dashed #bbf7d0;
            padding-bottom: 10px;
        }

        .exp-quote {
            background: white;
            padding: 15px;
            border-radius: 12px;
            font-style: italic;
            margin: 15px 0;
            border-left: 5px solid var(--accent);
            box-shadow: 0 4px 10px rgba(0,0,0,0.05);
            color: #4b5563;
        }

        /* --- ANIMATIONS --- */
        @keyframes slideDown { from { opacity: 0; transform: translateY(-15px); } to { opacity: 1; transform: translateY(0); } }
        
        .shake { animation: shake 0.5s cubic-bezier(.36,.07,.19,.97) both; }
        @keyframes shake {
            10%, 90% { transform: translate3d(-3px, 0, 0); }
            20%, 80% { transform: translate3d(5px, 0, 0); }
            30%, 50%, 70% { transform: translate3d(-8px, 0, 0); }
            40%, 60% { transform: translate3d(8px, 0, 0); }
        }

        /* --- CONFETTI CANVAS --- */
        #confettiCanvas {
            position: fixed; top: 0; left: 0; width: 100%; height: 100%;
            pointer-events: none; z-index: 9999;
        }

        /* --- SUBMIT & MODAL --- */
        .submit-btn-container { text-align: center; margin: 40px 0; }
        .btn-submit {
            background: var(--primary);
            color: white;
            font-size: 26px;
            font-weight: 900;
            padding: 18px 50px;
            border: 4px solid white;
            border-radius: 30px;
            cursor: pointer;
            box-shadow: 0 10px 0 #d63031, 0 15px 20px rgba(0,0,0,0.2);
            transition: all 0.2s;
            text-transform: uppercase;
            font-family: 'Quicksand', sans-serif;
        }
        .btn-submit:hover { transform: scale(1.08) rotate(-2deg); }
        .btn-submit:active { transform: translateY(10px); box-shadow: 0 0px 0 #d63031; }

        .modal-overlay {
            position: fixed; top: 0; left: 0; width: 100%; height: 100%;
            background: rgba(0,0,0,0.7);
            display: none; justify-content: center; align-items: center;
            z-index: 10000; backdrop-filter: blur(8px);
        }
        .modal-content {
            background: white; padding: 50px; border-radius: 30px;
            text-align: center; max-width: 450px;
            box-shadow: 0 20px 50px rgba(0,0,0,0.4);
            animation: bounceIn 0.6s cubic-bezier(0.175, 0.885, 0.32, 1.275);
            border: 5px solid var(--primary);
        }
        @keyframes bounceIn {
            0% { transform: scale(0.3); opacity: 0; }
            50% { transform: scale(1.05); opacity: 1; }
            70% { transform: scale(0.9); }
            100% { transform: scale(1); }
        }
        .score-text { font-size: 60px; font-weight: 900; color: var(--primary); margin: 20px 0; text-shadow: 2px 2px 0 var(--accent); }
        .feedback-text { font-size: 22px; font-weight: 800; color: #636e72; line-height: 1.5; }
        .btn-close-modal {
            margin-top: 30px; background: var(--secondary); color: #2d3436;
            border: none; padding: 15px 35px; font-size: 20px; border-radius: 20px;
            font-weight: 900; cursor: pointer; box-shadow: 0 8px 0 #00b894;
            font-family: 'Quicksand', sans-serif; transition: 0.2s;
        }
        .btn-close-modal:hover { transform: scale(1.05); }

        /* --- SCROLLBAR --- */
        ::-webkit-scrollbar { width: 12px; }
        ::-webkit-scrollbar-track { background: #f1f2f6; border-radius: 10px; margin: 10px; }
        ::-webkit-scrollbar-thumb { background: #b2bec3; border-radius: 10px; border: 3px solid #f1f2f6; }
        ::-webkit-scrollbar-thumb:hover { background: var(--primary); }
    </style>
</head>
<body>

    <canvas id="confettiCanvas"></canvas>

    <div class="top-bar">
        <div class="teacher-title">üë©‚Äçüè´ Gi√°o vi√™n t·∫°o: Ms Mai An ULIS</div>
        <div class="timer-container">
            <div id="timerDisplay">10:00</div>
            <button class="btn-timer" id="btnTimerToggle" onclick="toggleTimer()">B·∫ÆT ƒê·∫¶U T√çNH GI·ªú</button>
        </div>
    </div>

    <div class="main-container">
        <div class="left-panel">
            <h1 class="passage-title">Our Free-Time Activities</h1>
            
            <div class="paragraph-card">
                <h3>üßÅ Lei Wei (Liu Wei)</h3>
                <div class="text-content">
                    I‚Äôve been a member of the school cooking club since I was ten. I‚Äôm best known as a brilliant cake maker. Last year, I made 100 cupcakes for my cousin‚Äôs 18th birthday party and everyone said they were delicious. Cooking is only expensive if you buy unusual food, like Chinese vegetables that you can‚Äôt find in a supermarket. I did this and make a special dinner for my Dad when he was 50.
                </div>
                <button class="btn-translate" onclick="toggleTranslate('trans1')">‚ú® B·∫¢N D·ªäCH ƒê·∫¶Y ƒê·ª¶</button>
                <div class="translation-text" id="trans1">
                    T√¥i ƒë√£ l√† th√†nh vi√™n c·ªßa c√¢u l·∫°c b·ªô n·∫•u ƒÉn c·ªßa tr∆∞·ªùng k·ªÉ t·ª´ khi t√¥i 10 tu·ªïi. T√¥i ƒë∆∞·ª£c bi·∫øt ƒë·∫øn nhi·ªÅu nh·∫•t nh∆∞ m·ªôt ng∆∞·ªùi l√†m b√°nh xu·∫•t s·∫Øc. NƒÉm ngo√°i, t√¥i ƒë√£ l√†m 100 chi·∫øc b√°nh cupcake cho b·ªØa ti·ªác sinh nh·∫≠t l·∫ßn th·ª© 18 c·ªßa anh h·ªç t√¥i v√† m·ªçi ng∆∞·ªùi ƒë·ªÅu khen ch√∫ng r·∫•t ngon. Vi·ªác n·∫•u ƒÉn ch·ªâ t·ªën k√©m n·∫øu b·∫°n mua nh·ªØng lo·∫°i th·ª±c ph·∫©m kh√°c th∆∞·ªùng, ch·∫≥ng h·∫°n nh∆∞ rau Trung Qu·ªëc kh√¥ng th·ªÉ t√¨m th·∫•y ·ªü si√™u th·ªã. T√¥i ƒë√£ l√†m ƒëi·ªÅu n√†y v√† chu·∫©n b·ªã m·ªôt b·ªØa t·ªëi ƒë·∫∑c bi·ªát cho b·ªë t√¥i khi √¥ng tr√≤n 50 tu·ªïi.
                </div>
            </div>

            <div class="paragraph-card">
                <h3>üì∏ Deepak</h3>
                <div class="text-content">
                    When I was younger, I became interested in photography when my uncle let me take photos on his big digital camera. I‚Äôve got my own camera now ‚Äì I saved my pocket money for a year to buy it and it‚Äôs fantastic. I love taking photos of people playing sport ‚Äì it‚Äôs really difficult to catch them at the right moment so I take several photos. The headteacher has asked me to take the photos at the school fashion show, which will be fun.
                </div>
                <button class="btn-translate" onclick="toggleTranslate('trans2')">‚ú® B·∫¢N D·ªäCH ƒê·∫¶Y ƒê·ª¶</button>
                <div class="translation-text" id="trans2">
                    Khi c√≤n nh·ªè, t√¥i b·∫Øt ƒë·∫ßu ƒëam m√™ nhi·∫øp ·∫£nh khi ch√∫ t√¥i cho ph√©p t√¥i ch·ª•p ·∫£nh b·∫±ng chi·∫øc m√°y ·∫£nh k·ªπ thu·∫≠t s·ªë l·ªõn c·ªßa ch√∫ ·∫•y. B√¢y gi·ªù t√¥i ƒë√£ c√≥ m√°y ·∫£nh ri√™ng c·ªßa m√¨nh ‚Äì t√¥i ƒë√£ ti·∫øt ki·ªám ti·ªÅn ti√™u v·∫∑t trong m·ªôt nƒÉm ƒë·ªÉ mua n√≥ v√† n√≥ th·∫≠t tuy·ªát v·ªùi. T√¥i th√≠ch ch·ª•p ·∫£nh nh·ªØng ng∆∞·ªùi ƒëang ch∆°i th·ªÉ thao ‚Äì th·ª±c s·ª± r·∫•t kh√≥ ƒë·ªÉ b·∫Øt ƒë∆∞·ª£c kho·∫£nh kh·∫Øc th√≠ch h·ª£p n√™n t√¥i ph·∫£i ch·ª•p v√†i b·ª©c ·∫£nh li√™n t·ª•c. Th·∫ßy hi·ªáu tr∆∞·ªüng ƒë√£ y√™u c·∫ßu t√¥i ch·ª•p ·∫£nh t·∫°i bu·ªïi tr√¨nh di·ªÖn th·ªùi trang c·ªßa tr∆∞·ªùng, ƒëi·ªÅu n√†y s·∫Ω r·∫•t th√∫ v·ªã.
                </div>
            </div>

            <div class="paragraph-card">
                <h3>üëó Romeo</h3>
                <div class="text-content">
                    My aunt works for a fashion magazine and wears really cool clothes. I‚Äôm different to most boys because I love making clothes for me and my sisters, so I want to study fashion at college. I‚Äôve already got some experience of the fashion world. With my aunt‚Äôs help, I won a competition to help get the clothes ready when a famous American photographer came to take photos of models wearing winter clothes. It was a really interesting day and I could earn some money.
                </div>
                <button class="btn-translate" onclick="toggleTranslate('trans3')">‚ú® B·∫¢N D·ªäCH ƒê·∫¶Y ƒê·ª¶</button>
                <div class="translation-text" id="trans3">
                    D√¨ c·ªßa t√¥i l√†m vi·ªác cho m·ªôt t·∫°p ch√≠ th·ªùi trang v√† m·∫∑c nh·ªØng b·ªô qu·∫ßn √°o th·ª±c s·ª± r·∫•t ng·∫ßu. T√¥i kh√°c v·ªõi h·∫ßu h·∫øt c√°c c·∫≠u b√© kh√°c v√¨ t√¥i th√≠ch may qu·∫ßn √°o cho m√¨nh v√† c√°c ch·ªã em g√°i, v√¨ v·∫≠y t√¥i mu·ªën theo h·ªçc ng√†nh th·ªùi trang ·ªü tr∆∞·ªùng ƒë·∫°i h·ªçc. T√¥i ƒë√£ c√≥ m·ªôt ch√∫t kinh nghi·ªám trong th·∫ø gi·ªõi th·ªùi trang. V·ªõi s·ª± gi√∫p ƒë·ª° c·ªßa d√¨, t√¥i ƒë√£ gi√†nh chi·∫øn th·∫Øng trong m·ªôt cu·ªôc thi h·ªó tr·ª£ chu·∫©n b·ªã trang ph·ª•c khi m·ªôt nhi·∫øp ·∫£nh gia n·ªïi ti·∫øng ng∆∞·ªùi M·ªπ ƒë·∫øn ch·ª•p ·∫£nh c√°c ng∆∞·ªùi m·∫´u m·∫∑c qu·∫ßn √°o m√πa ƒë√¥ng. ƒê√≥ l√† m·ªôt ng√†y th·ª±c s·ª± th√∫ v·ªã v√† t√¥i ƒë√£ c√≥ th·ªÉ ki·∫øm ƒë∆∞·ª£c m·ªôt s·ªë ti·ªÅn.
                </div>
            </div>

            <div class="glossary-container">
                <h3>üìö B·∫£ng T·ª´ V·ª±ng H·ªçc Thu·∫≠t (Glossary)</h3>
                <table>
                    <thead>
                        <tr>
                            <th>T·ª´ v·ª±ng (Word)</th>
                            <th>Lo·∫°i t·ª´ (POS)</th>
                            <th>Nghƒ©a Ti·∫øng Vi·ªát (Meaning)</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr><td>1. Member</td><td>Noun (n)</td><td>Th√†nh vi√™n</td></tr>
                        <tr><td>2. Brilliant</td><td>Adjective (adj)</td><td>T√†i ba, xu·∫•t s·∫Øc</td></tr>
                        <tr><td>3. Delicious</td><td>Adjective (adj)</td><td>R·∫•t ngon mi·ªáng</td></tr>
                        <tr><td>4. Unusual</td><td>Adjective (adj)</td><td>B·∫•t th∆∞·ªùng, hi·∫øm g·∫∑p</td></tr>
                        <tr><td>5. Digital</td><td>Adjective (adj)</td><td>K·ªπ thu·∫≠t s·ªë</td></tr>
                        <tr><td>6. Fantastic</td><td>Adjective (adj)</td><td>Tuy·ªát v·ªùi</td></tr>
                        <tr><td>7. Several</td><td>Determiner</td><td>M·ªôt v√†i, m·ªôt s·ªë</td></tr>
                        <tr><td>8. Magazine</td><td>Noun (n)</td><td>T·∫°p ch√≠</td></tr>
                        <tr><td>9. Competition</td><td>Noun (n)</td><td>Cu·ªôc thi, s·ª± c·∫°nh tranh</td></tr>
                        <tr><td>10. Experience</td><td>Noun (n)</td><td>Kinh nghi·ªám, tr·∫£i nghi·ªám</td></tr>
                    </tbody>
                </table>
            </div>
        </div>

        <div class="right-panel" id="quizContainer">
            <div class="submit-btn-container">
                <button class="btn-submit" onclick="submitQuiz()">üöÄ N·ªòP B√ÄI TH√îI üöÄ</button>
            </div>
        </div>
    </div>

    <div class="modal-overlay" id="resultModal">
        <div class="modal-content">
            <h2>K·∫øt Qu·∫£ C·ªßa B·∫°n</h2>
            <div class="score-text" id="finalScoreText">0/7</div>
            <div class="feedback-text" id="feedbackText">Tuy·ªát v·ªùi!</div>
            <button class="btn-close-modal" onclick="closeModal()">Xem L·∫°i B√†i Ch·ªØa</button>
        </div>
    </div>

    <script>
        /* ================= AUDIO GENERATOR ================= */
        const audioCtx = new (window.AudioContext || window.webkitAudioContext)();
        
        function playCorrectSound() {
            if (audioCtx.state === 'suspended') audioCtx.resume();
            const osc = audioCtx.createOscillator();
            const gainNode = audioCtx.createGain();
            osc.type = 'sine';
            osc.frequency.setValueAtTime(880, audioCtx.currentTime); 
            osc.frequency.exponentialRampToValueAtTime(1760, audioCtx.currentTime + 0.15);
            gainNode.gain.setValueAtTime(0.4, audioCtx.currentTime);
            gainNode.gain.exponentialRampToValueAtTime(0.01, audioCtx.currentTime + 0.5);
            osc.connect(gainNode);
            gainNode.connect(audioCtx.destination);
            osc.start();
            osc.stop(audioCtx.currentTime + 0.5);
        }

        function playWrongSound() {
            if (audioCtx.state === 'suspended') audioCtx.resume();
            const osc = audioCtx.createOscillator();
            const gainNode = audioCtx.createGain();
            osc.type = 'triangle';
            osc.frequency.setValueAtTime(250, audioCtx.currentTime);
            osc.frequency.linearRampToValueAtTime(100, audioCtx.currentTime + 0.4);
            gainNode.gain.setValueAtTime(0.4, audioCtx.currentTime);
            gainNode.gain.exponentialRampToValueAtTime(0.01, audioCtx.currentTime + 0.4);
            osc.connect(gainNode);
            gainNode.connect(audioCtx.destination);
            osc.start();
            osc.stop(audioCtx.currentTime + 0.4);
        }

        /* ================= CONFETTI GENERATOR ================= */
        const canvas = document.getElementById('confettiCanvas');
        const ctx = canvas.getContext('2d');
        canvas.width = window.innerWidth;
        canvas.height = window.innerHeight;
        let particles = [];

        function fireConfetti() {
            particles = [];
            const colors = ['#00b894', '#FFD3B6', '#FF8B94', '#A8E6CF', '#fdcb6e'];
            for(let i=0; i<120; i++) {
                particles.push({
                    x: canvas.width/2,
                    y: canvas.height/2 + 200,
                    r: Math.random() * 8 + 3,
                    dx: Math.random() * 14 - 7,
                    dy: Math.random() * -18 - 5,
                    color: colors[Math.floor(Math.random() * colors.length)]
                });
            }
            animateConfetti();
        }

        function animateConfetti() {
            requestAnimationFrame(animateConfetti);
            ctx.clearRect(0,0,canvas.width,canvas.height);
            particles.forEach((p, index) => {
                p.x += p.dx;
                p.y += p.dy;
                p.dy += 0.4; 
                ctx.beginPath();
                ctx.arc(p.x, p.y, p.r, 0, Math.PI*2);
                ctx.fillStyle = p.color;
                ctx.fill();
                if(p.y > canvas.height) particles.splice(index, 1);
            });
        }

        /* ================= TIMER LOGIC ================= */
        let timeRemaining = 600; 
        let timerInterval;
        let isTimerRunning = false;

        function updateTimerDisplay() {
            let m = Math.floor(timeRemaining / 60).toString().padStart(2, '0');
            let s = (timeRemaining % 60).toString().padStart(2, '0');
            document.getElementById('timerDisplay').innerText = `${m}:${s}`;
        }

        function toggleTimer() {
            const btn = document.getElementById('btnTimerToggle');
            if (isTimerRunning) {
                clearInterval(timerInterval);
                btn.innerText = "TI·∫æP T·ª§C L√ÄM B√ÄI";
                btn.style.background = "#fdcb6e";
                btn.style.color = "#d63031";
                isTimerRunning = false;
            } else {
                btn.innerText = "T·∫†M D·ª™NG";
                btn.style.background = "#FF8B94";
                btn.style.color = "white";
                isTimerRunning = true;
                timerInterval = setInterval(() => {
                    timeRemaining--;
                    updateTimerDisplay();
                    if (timeRemaining <= 0) {
                        clearInterval(timerInterval);
                        alert("‚è∞ ƒê√£ h·∫øt gi·ªù l√†m b√†i. B·∫°n v·∫´n c√≥ th·ªÉ ti·∫øp t·ª•c l√†m, nh∆∞ng nh·ªõ l√† trong ph√≤ng thi th·∫≠t, b·∫°n ch·ªâ n√™n l√†m m·ªôt b√†i nh∆∞ th·∫ø n√†y trong 10 ph√∫t th√¥i nha.");
                        btn.innerText = "H·∫æT GI·ªú";
                        btn.disabled = true;
                        btn.style.background = "#ccc";
                    }
                }, 1000);
            }
        }

        /* ================= TRANSLATION TOGGLE ================= */
        function toggleTranslate(id) {
            const el = document.getElementById(id);
            el.style.display = (el.style.display === "block") ? "none" : "block";
        }

        /* ================= QUIZ DATA & LOGIC ================= */
        const quizData = [
            {
                q: "1. Who got some help with their hobby from a family member?",
                options: [{id:'A', text:'Liu Wei'}, {id:'B', text:'Deepak'}, {id:'C', text:'Romeo'}],
                correct: 'C',
                explanation: `
                    <div class="exp-title">üí° Gi·∫£i th√≠ch chi ti·∫øt (C√¢u 1)</div>
                    <b>1. Ph√¢n t√≠ch c√¢u h·ªèi:</b> Ai ƒë√£ nh·∫≠n ƒë∆∞·ª£c s·ª± gi√∫p ƒë·ª° cho s·ªü th√≠ch c·ªßa h·ªç t·ª´ m·ªôt th√†nh vi√™n trong gia ƒë√¨nh? (help from family member).<br>
                    <b>2. D·∫´n ch·ª©ng trong b√†i (ƒêo·∫°n Romeo):</b> 
                    <div class="exp-quote">"<b>With my aunt‚Äôs help</b>, I won a competition to help get the clothes ready..."</div>
                    <b>3. T·∫°i sao ch·ªçn Romeo?</b> Romeo ƒë√£ tr·ª±c ti·∫øp nh·∫Øc ƒë·∫øn vi·ªác nh·∫≠n ƒë∆∞·ª£c "s·ª± gi√∫p ƒë·ª° c·ªßa d√¨" ƒë·ªÉ chi·∫øn th·∫Øng trong m·ªôt cu·ªôc thi.
                `
            },
            {
                q: "2. Who had success with something they did for their family?",
                options: [{id:'A', text:'Liu Wei'}, {id:'B', text:'Deepak'}, {id:'C', text:'Romeo'}],
                correct: 'A',
                explanation: `
                    <div class="exp-title">üí° Gi·∫£i th√≠ch chi ti·∫øt (C√¢u 2)</div>
                    <b>1. Ph√¢n t√≠ch c√¢u h·ªèi:</b> Ai ƒë√£ th√†nh c√¥ng v·ªõi m·ªôt vi·ªác h·ªç l√†m cho gia ƒë√¨nh m√¨nh? (success with something did for family).<br>
                    <b>2. D·∫´n ch·ª©ng trong b√†i (ƒêo·∫°n Lei Wei / Liu Wei):</b> 
                    <div class="exp-quote">"Last year, I made 100 cupcakes for my <b>cousin‚Äôs</b> 18th birthday party and <b>everyone said they were delicious</b>."</div>
                    <b>3. T·∫°i sao ch·ªçn Liu Wei?</b> Liu Wei l√†m b√°nh cho anh h·ªç (th√†nh vi√™n gia ƒë√¨nh) v√† m·ªçi ng∆∞·ªùi ƒë·ªÅu khen ngon (ƒë√¢y ch√≠nh l√† s·ª± th√†nh c√¥ng).
                `
            },
            {
                q: "3. Who used their own money to get something they needed to do their hobby?",
                options: [{id:'A', text:'Liu Wei'}, {id:'B', text:'Deepak'}, {id:'C', text:'Romeo'}],
                correct: 'B',
                explanation: `
                    <div class="exp-title">üí° Gi·∫£i th√≠ch chi ti·∫øt (C√¢u 3)</div>
                    <b>1. Ph√¢n t√≠ch c√¢u h·ªèi:</b> Ai ƒë√£ s·ª≠ d·ª•ng ti·ªÅn ri√™ng c·ªßa m√¨nh ƒë·ªÉ mua m·ªôt th·ª© h·ªç c·∫ßn cho s·ªü th√≠ch c·ªßa h·ªç? (used own money).<br>
                    <b>2. D·∫´n ch·ª©ng trong b√†i (ƒêo·∫°n Deepak):</b> 
                    <div class="exp-quote">"I <b>saved my pocket money for a year to buy it</b> and it‚Äôs fantastic."</div>
                    <b>3. T·∫°i sao ch·ªçn Deepak?</b> Deepak ƒë√£ ti·∫øt ki·ªám "ti·ªÅn ti√™u v·∫∑t" (ti·ªÅn c·ªßa ch√≠nh m√¨nh) trong m·ªôt nƒÉm ƒë·ªÉ mua chi·∫øc m√°y ·∫£nh.
                `
            },
            {
                q: "4. Whose hobby could be what they choose to learn about in the future?",
                options: [{id:'A', text:'Liu Wei'}, {id:'B', text:'Deepak'}, {id:'C', text:'Romeo'}],
                correct: 'C',
                explanation: `
                    <div class="exp-title">üí° Gi·∫£i th√≠ch chi ti·∫øt (C√¢u 4)</div>
                    <b>1. Ph√¢n t√≠ch c√¢u h·ªèi:</b> S·ªü th√≠ch c·ªßa ai c√≥ th·ªÉ tr·ªü th√†nh ng√†nh h·ªçc h·ªç ch·ªçn trong t∆∞∆°ng lai? (choose to learn about in the future = study at college).<br>
                    <b>2. D·∫´n ch·ª©ng trong b√†i (ƒêo·∫°n Romeo):</b> 
                    <div class="exp-quote">"...so I <b>want to study fashion at college</b>."</div>
                    <b>3. T·∫°i sao ch·ªçn Romeo?</b> Romeo y√™u th√≠ch may v√° v√† c·∫≠u ·∫•y n√≥i r√µ mong mu·ªën "theo h·ªçc ng√†nh th·ªùi trang ·ªü tr∆∞·ªùng ƒë·∫°i h·ªçc" trong t∆∞∆°ng lai.
                `
            },
            {
                q: "5. Whose hobby has allowed them to do some paid work?",
                options: [{id:'A', text:'Liu Wei'}, {id:'B', text:'Deepak'}, {id:'C', text:'Romeo'}],
                correct: 'C',
                explanation: `
                    <div class="exp-title">üí° Gi·∫£i th√≠ch chi ti·∫øt (C√¢u 5)</div>
                    <b>1. Ph√¢n t√≠ch c√¢u h·ªèi:</b> S·ªü th√≠ch c·ªßa ai ƒë√£ cho ph√©p h·ªç l√†m m·ªôt s·ªë c√¥ng vi·ªác ƒë∆∞·ª£c tr·∫£ l∆∞∆°ng? (paid work = earn money).<br>
                    <b>2. D·∫´n ch·ª©ng trong b√†i (ƒêo·∫°n Romeo):</b> 
                    <div class="exp-quote">"It was a really interesting day and I could <b>earn some money</b>."</div>
                    <b>3. T·∫°i sao ch·ªçn Romeo?</b> Tham gia chu·∫©n b·ªã trang ph·ª•c ƒë√£ gi√∫p Romeo "ki·∫øm ƒë∆∞·ª£c m·ªôt s·ªë ti·ªÅn", ƒë·ªìng nghƒ©a v·ªõi c√¥ng vi·ªác ƒë∆∞·ª£c tr·∫£ l∆∞∆°ng.
                `
            },
            {
                q: "6. Whose hobby sometimes costs them a lot of money?",
                options: [{id:'A', text:'Liu Wei'}, {id:'B', text:'Deepak'}, {id:'C', text:'Romeo'}],
                correct: 'A',
                explanation: `
                    <div class="exp-title">üí° Gi·∫£i th√≠ch chi ti·∫øt (C√¢u 6)</div>
                    <b>1. Ph√¢n t√≠ch c√¢u h·ªèi:</b> S·ªü th√≠ch c·ªßa ai th·ªânh tho·∫£ng khi·∫øn h·ªç ti√™u t·ªën r·∫•t nhi·ªÅu ti·ªÅn? (costs a lot of money = is expensive).<br>
                    <b>2. D·∫´n ch·ª©ng trong b√†i (ƒêo·∫°n Lei Wei / Liu Wei):</b> 
                    <div class="exp-quote">"Cooking <b>is only expensive if you buy unusual food</b>... I did this and make a special dinner for my Dad..."</div>
                    <b>3. T·∫°i sao ch·ªçn Liu Wei?</b> Liu Wei gi·∫£i th√≠ch n·∫•u ƒÉn s·∫Ω tr·ªü n√™n ƒë·∫Øt ƒë·ªè (t·ªën k√©m) n·∫øu mua th·ª±c ph·∫©m l·∫°, v√† c·∫≠u ·∫•y ƒë√£ t·ª´ng l√†m th·∫ø ƒë·ªÉ n·∫•u cho b·ªë.
                `
            },
            {
                q: "7. Whose hobby is sometimes hard to do well?",
                options: [{id:'A', text:'Liu Wei'}, {id:'B', text:'Deepak'}, {id:'C', text:'Romeo'}],
                correct: 'B',
                explanation: `
                    <div class="exp-title">üí° Gi·∫£i th√≠ch chi ti·∫øt (C√¢u 7)</div>
                    <b>1. Ph√¢n t√≠ch c√¢u h·ªèi:</b> S·ªü th√≠ch c·ªßa ai ƒë√¥i khi r·∫•t kh√≥ ƒë·ªÉ l√†m t·ªët? (hard to do well = difficult to catch).<br>
                    <b>2. D·∫´n ch·ª©ng trong b√†i (ƒêo·∫°n Deepak):</b> 
                    <div class="exp-quote">"...it‚Äôs <b>really difficult to catch them at the right moment</b> so I take several photos."</div>
                    <b>3. T·∫°i sao ch·ªçn Deepak?</b> Deepak th·∫•y r·∫±ng vi·ªác ch·ª•p ·∫£nh th·ªÉ thao r·∫•t kh√≥ ƒë·ªÉ "b·∫Øt ƒë√∫ng kho·∫£nh kh·∫Øc", n√™n c·∫≠u ·∫•y ph·∫£i ch·ª•p nhi·ªÅu ·∫£nh ƒë·ªÉ l√†m t·ªët.
                `
            }
        ];

        let score = 0;
        let answeredQuestions = new Set();

        function shuffleArray(array) {
            let newArr = [...array];
            for (let i = newArr.length - 1; i > 0; i--) {
                const j = Math.floor(Math.random() * (i + 1));
                [newArr[i], newArr[j]] = [newArr[j], newArr[i]];
            }
            return newArr;
        }

        function renderQuiz() {
            const container = document.getElementById('quizContainer');
            const submitBtn = document.querySelector('.submit-btn-container');
            container.innerHTML = '';

            quizData.forEach((qObj, qIndex) => {
                const card = document.createElement('div');
                card.className = 'question-card';
                card.id = `q-card-${qIndex}`;

                const qText = document.createElement('div');
                qText.className = 'question-text';
                qText.innerHTML = qObj.q;
                card.appendChild(qText);

                const optionsGrid = document.createElement('div');
                optionsGrid.className = 'options-grid';

                let shuffledOptions = shuffleArray(qObj.options);

                shuffledOptions.forEach((opt, index) => {
                    const btn = document.createElement('button');
                    btn.className = 'option-btn';
                    
                    const label = index === 0 ? 'A' : (index === 1 ? 'B' : 'C');
                    btn.innerHTML = `<span class="opt-label">${label}</span> <span>${opt.text}</span>`;
                    
                    // G·∫Øn ID ƒë√°p √°n ng·∫ßm v√†o dataset ƒë·ªÉ check ch√≠nh x√°c
                    btn.dataset.optId = opt.id;
                    btn.onclick = () => handleAnswer(btn, opt.id, qObj.correct, qIndex, card);
                    optionsGrid.appendChild(btn);
                });

                card.appendChild(optionsGrid);

                const expBox = document.createElement('div');
                expBox.className = 'explanation-box';
                expBox.id = `exp-${qIndex}`;
                expBox.innerHTML = qObj.explanation;
                card.appendChild(expBox);

                container.appendChild(card);
            });
            
            container.appendChild(submitBtn);
        }

        function handleAnswer(btn, selectedId, correctId, qIndex, card) {
            const buttons = card.querySelectorAll('.option-btn');
            const expBox = document.getElementById(`exp-${qIndex}`);

            if (selectedId === correctId) {
                btn.classList.add('correct');
                playCorrectSound();
                fireConfetti();
                if (!answeredQuestions.has(qIndex)) {
                    score++;
                    answeredQuestions.add(qIndex);
                }
            } else {
                btn.classList.add('wrong');
                btn.classList.add('shake');
                playWrongSound();
                setTimeout(() => btn.classList.remove('shake'), 500);
                answeredQuestions.add(qIndex); 
                
                // T·ª± ƒë·ªông t√¨m v√† b√¥i xanh n√∫t c√≥ dataset ƒë√∫ng
                buttons.forEach(b => {
                    if (b.dataset.optId === correctId) {
                        b.classList.add('correct');
                    }
                });
            }

            buttons.forEach(b => b.disabled = true);
            expBox.style.display = 'block';
        }

        function submitQuiz() {
            const modal = document.getElementById('resultModal');
            const scoreText = document.getElementById('finalScoreText');
            const feedbackText = document.getElementById('feedbackText');
            
            scoreText.innerText = `${score} / 7`;
            
            let percentage = score / 7;
            if (percentage === 1) {
                feedbackText.innerHTML = "üèÜ ƒê·ªàNH C·ª¶A CH√ìP!<br>Em ph√¢n t√≠ch d·∫´n ch·ª©ng qu√° xu·∫•t s·∫Øc!";
                feedbackText.style.color = "#00b894";
                fireConfetti();
                playCorrectSound();
            } else if (percentage >= 0.7) {
                feedbackText.innerHTML = "üåü R·∫§T T·ªêT!<br>K·ªπ nƒÉng ƒë·ªçc hi·ªÉu c·ªßa em c·ª±c k·ª≥ x·ªãn x√≤!";
                feedbackText.style.color = "#0984e3";
            } else if (percentage >= 0.4) {
                feedbackText.innerHTML = "üëç KH√Å L·∫ÆM!<br>Nh·ªõ g·∫°ch ch√¢n keyword c·∫©n th·∫≠n h∆°n m·ªôt ch√∫t nh√©.";
                feedbackText.style.color = "#e17055";
            } else {
                feedbackText.innerHTML = "üí™ KH√îNG SAO ƒê√ÇU!<br>H√£y ƒë·ªçc k·ªπ l·∫°i ph·∫ßn gi·∫£i th√≠ch ƒë·ªÉ ti·∫øn b·ªô h∆°n nha!";
                feedbackText.style.color = "#d63031";
            }

            modal.style.display = "flex";
            clearInterval(timerInterval);
        }

        function closeModal() {
            document.getElementById('resultModal').style.display = "none";
        }

        // Kh·ªüi ch·∫°y
        window.onload = () => {
            updateTimerDisplay();
            renderQuiz();
        };
    </script>
</body>
</html>