<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Word Form Challenge: Nature - Ms. Mai An</title>
    <!-- Google Fonts: Quicksand for friendly, rounded look -->
    <link href="https://fonts.googleapis.com/css2?family=Quicksand:wght@400;600;700&display=swap" rel="stylesheet">
    <!-- Font Awesome for Icons -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <!-- Confetti Library -->
    <script src="https://cdn.jsdelivr.net/npm/canvas-confetti@1.6.0/dist/confetti.browser.min.js"></script>

    <style>
        :root {
            --primary-purple: #8854C0;
            --primary-teal: #00C9A7;
            --correct-green: #00D26A;
            --wrong-red: #FF4757;
            --bg-pattern: #f0f2f5;
            --text-dark: #2d3436;
            --text-light: #ffffff;
            --card-bg: #ffffff;
        }

        body {
            font-family: 'Quicksand', sans-serif;
            background-color: var(--bg-pattern);
            background-image: radial-gradient(#8854c0 0.5px, transparent 0.5px), radial-gradient(#8854c0 0.5px, var(--bg-pattern) 0.5px);
            background-size: 20px 20px;
            background-position: 0 0, 10px 10px;
            margin: 0;
            min-height: 100vh;
            display: flex;
            justify-content: center;
            align-items: center;
            color: var(--text-dark);
            overflow-x: hidden;
        }

        /* --- Main Layout --- */
        .game-container {
            width: 100%;
            max-width: 800px;
            margin: 20px;
            perspective: 1000px;
        }

        .header-teacher {
            text-align: center;
            margin-bottom: 20px;
            background: linear-gradient(135deg, var(--primary-purple), #a29bfe);
            padding: 15px;
            border-radius: 20px;
            color: white;
            box-shadow: 0 8px 0 rgba(0,0,0,0.1);
            position: relative;
            z-index: 10;
        }

        .header-teacher h1 {
            margin: 0;
            font-size: 1.5rem;
            text-transform: uppercase;
            letter-spacing: 1px;
        }

        .header-teacher p {
            margin: 5px 0 0;
            font-size: 0.9rem;
            opacity: 0.9;
        }

        .card {
            background: var(--card-bg);
            border-radius: 25px;
            padding: 30px;
            box-shadow: 0 10px 25px rgba(0,0,0,0.1);
            position: relative;
            border: 4px solid #fff;
            transition: transform 0.3s ease;
        }

        /* --- Progress Bar --- */
        .progress-container {
            width: 100%;
            background-color: #e0e0e0;
            border-radius: 10px;
            margin-bottom: 25px;
            height: 12px;
            overflow: hidden;
        }

        .progress-bar {
            height: 100%;
            background-color: var(--primary-teal);
            width: 0%;
            transition: width 0.5s ease;
            border-radius: 10px;
        }

        /* --- Question Area --- */
        .question-box {
            font-size: 1.3rem;
            font-weight: 700;
            margin-bottom: 30px;
            line-height: 1.5;
            color: #2c3e50;
        }

        .target-word {
            color: var(--primary-purple);
            text-transform: uppercase;
            font-weight: 800;
            background: rgba(136, 84, 192, 0.1);
            padding: 2px 8px;
            border-radius: 5px;
        }

        .hint-text {
            display: block;
            font-size: 0.9rem;
            color: #636e72;
            margin-top: 10px;
            font-style: italic;
        }

        /* --- Options Grid --- */
        .options-grid {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 15px;
        }

        @media (max-width: 600px) {
            .options-grid {
                grid-template-columns: 1fr;
            }
        }

        .option-btn {
            background: white;
            border: 2px solid #e0e0e0;
            border-radius: 15px;
            padding: 15px 20px;
            font-family: 'Quicksand', sans-serif;
            font-size: 1.1rem;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.2s cubic-bezier(0.25, 0.8, 0.25, 1);
            box-shadow: 0 5px 0 #dcdcdc; /* 3D Effect */
            position: relative;
            text-align: left;
            display: flex;
            align-items: center;
            justify-content: space-between;
        }

        .option-btn:hover:not(:disabled) {
            transform: translateY(-2px);
            box-shadow: 0 7px 0 #dcdcdc;
            border-color: var(--primary-purple);
        }

        .option-btn:active:not(:disabled) {
            transform: translateY(4px);
            box-shadow: 0 1px 0 #dcdcdc;
        }

        /* Correct/Wrong States */
        .option-btn.correct {
            background-color: var(--correct-green);
            color: white;
            border-color: #00b85c;
            box-shadow: 0 5px 0 #00b85c;
        }

        .option-btn.wrong {
            background-color: var(--wrong-red);
            color: white;
            border-color: #ff2e40;
            box-shadow: 0 5px 0 #ff2e40;
            animation: shake 0.5s;
        }

        .option-btn:disabled {
            cursor: default;
            opacity: 0.7;
        }

        /* --- Explanation Box --- */
        .explanation-container {
            margin-top: 25px;
            background: #f8f9fa;
            border-left: 5px solid var(--primary-purple);
            padding: 20px;
            border-radius: 0 15px 15px 0;
            display: none; /* Hidden by default */
            animation: slideIn 0.4s ease-out;
        }

        .teacher-avatar {
            display: flex;
            align-items: center;
            margin-bottom: 10px;
            color: var(--primary-purple);
            font-weight: bold;
        }

        .teacher-avatar i {
            margin-right: 10px;
            font-size: 1.5rem;
        }

        .explanation-content {
            font-size: 1rem;
            line-height: 1.6;
            color: #444;
        }
        
        .explanation-content strong {
            color: var(--primary-purple);
        }

        .next-btn-container {
            margin-top: 20px;
            text-align: right;
            display: none; /* Hidden until answered */
        }

        .next-btn {
            background-color: var(--primary-teal);
            color: white;
            border: none;
            padding: 12px 30px;
            font-size: 1.2rem;
            border-radius: 50px;
            cursor: pointer;
            font-family: 'Quicksand', sans-serif;
            font-weight: bold;
            box-shadow: 0 5px 0 #00a388;
            transition: transform 0.2s;
        }

        .next-btn:hover {
            transform: scale(1.05);
        }
        
        .next-btn:active {
            transform: translateY(4px) scale(1.05);
            box-shadow: 0 1px 0 #00a388;
        }

        /* --- Result Modal/Popup --- */
        .result-overlay {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0,0,0,0.8);
            display: none;
            justify-content: center;
            align-items: center;
            z-index: 100;
        }

        .result-card {
            background: white;
            padding: 40px;
            border-radius: 30px;
            text-align: center;
            max-width: 400px;
            width: 90%;
            animation: popIn 0.5s cubic-bezier(0.175, 0.885, 0.32, 1.275);
        }

        .score-circle {
            width: 120px;
            height: 120px;
            border-radius: 50%;
            background: var(--primary-purple);
            color: white;
            display: flex;
            justify-content: center;
            align-items: center;
            font-size: 2.5rem;
            font-weight: bold;
            margin: 0 auto 20px;
            box-shadow: 0 0 20px rgba(136, 84, 192, 0.5);
        }

        /* --- Animations --- */
        @keyframes shake {
            0% { transform: translateX(0); }
            25% { transform: translateX(-10px) rotate(-5deg); }
            50% { transform: translateX(10px) rotate(5deg); }
            75% { transform: translateX(-10px) rotate(-5deg); }
            100% { transform: translateX(0); }
        }

        @keyframes slideIn {
            from { opacity: 0; transform: translateY(10px); }
            to { opacity: 1; transform: translateY(0); }
        }

        @keyframes popIn {
            from { opacity: 0; transform: scale(0.5); }
            to { opacity: 1; transform: scale(1); }
        }

    </style>
</head>
<body>

    <div class="game-container">
        <!-- Teacher Header -->
        <div class="header-teacher">
            <h1><i class="fas fa-graduation-cap"></i> Ms. Mai An ULIS</h1>
            <p>Word Form Practice: Nature & Environment</p>
        </div>

        <div class="card">
            <!-- Progress -->
            <div class="progress-container">
                <div class="progress-bar" id="progressBar"></div>
            </div>

            <!-- Quiz Area -->
            <div id="quizArea">
                <div class="question-box" id="questionText">
                    Loading question...
                </div>

                <div class="options-grid" id="optionsContainer">
                    <!-- Options generated via JS -->
                </div>

                <!-- Explanation Section -->
                <div class="explanation-container" id="explanationBox">
                    <div class="teacher-avatar">
                        <i class="fas fa-chalkboard-teacher"></i>
                        <span>C√¥ Mai An gi·∫£i th√≠ch:</span>
                    </div>
                    <div class="explanation-content" id="explanationText">
                        <!-- Content goes here -->
                    </div>
                </div>

                <!-- Next Button -->
                <div class="next-btn-container" id="nextBtnContainer">
                    <button class="next-btn" onclick="nextQuestion()">
                        C√¢u ti·∫øp theo <i class="fas fa-arrow-right"></i>
                    </button>
                </div>
            </div>
        </div>
    </div>

    <!-- Result Popup -->
    <div class="result-overlay" id="resultOverlay">
        <div class="result-card">
            <div class="score-circle" id="finalScore">0/10</div>
            <h2 id="finalMessage">Tuy·ªát v·ªùi!</h2>
            <p id="finalComment">B·∫°n ƒë√£ ho√†n th√†nh b√†i ki·ªÉm tra.</p>
            <button class="next-btn" onclick="location.reload()">L√†m l·∫°i b√†i <i class="fas fa-redo"></i></button>
        </div>
    </div>

    <script>
        // --- DATA SOURCE ---
        const quizData = {
          "questions": [
            {
              "questionNumber": 1,
              "question": "The Grand Canyon took millions of years of natural ______________ to reach its current form. <span class='target-word'>(DEVELOP)</span>",
              "answerOptions": [
                {
                  "text": "development",
                  "rationale": "**Ph√¢n t√≠ch ƒë√°p √°n:**<br>- A. develop (v): ph√°t tri·ªÉn<br>- B. development (n): s·ª± ph√°t tri·ªÉn/qu√° tr√¨nh h√¨nh th√†nh<br>- C. developing (adj): ƒëang ph√°t tri·ªÉn<br>- D. developed (adj): ƒë√£ ph√°t tri·ªÉn<br><br>**D·ªãch c√¢u:** H·∫ªm n√∫i Grand Canyon ƒë√£ m·∫•t h√†ng tri·ªáu nƒÉm c·ªßa qu√° tr√¨nh h√¨nh th√†nh t·ª± nhi√™n ƒë·ªÉ ƒë·∫°t ƒë∆∞·ª£c h√¨nh d·∫°ng hi·ªán t·∫°i.<br><br>**Gi·∫£i th√≠ch:** Sau t√≠nh t·ª´ 'natural' (t·ª± nhi√™n), ch√∫ng ta c·∫ßn m·ªôt danh t·ª´ (Noun) ƒë·ªÉ t·∫°o th√†nh c·ª•m danh t·ª´. 'Development' ·ªü ƒë√¢y mang nghƒ©a l√† qu√° tr√¨nh ph√°t tri·ªÉn/h√¨nh th√†nh ƒë·ªãa ch·∫•t.",
                  "isCorrect": true
                },
                {
                  "text": "develop",
                  "rationale": "",
                  "isCorrect": false
                },
                {
                  "text": "developing",
                  "rationale": "",
                  "isCorrect": false
                },
                {
                  "text": "developed",
                  "rationale": "",
                  "isCorrect": false
                }
              ],
              "hint": "We need a noun after the adjective 'natural'."
            },
            {
              "questionNumber": 2,
              "question": "Many countries are promoting ______________ tourism to protect their natural wonders. <span class='target-word'>(SUSTAIN)</span>",
              "answerOptions": [
                {
                  "text": "sustainable",
                  "rationale": "**Ph√¢n t√≠ch ƒë√°p √°n:**<br>- A. sustain (v): duy tr√¨<br>- B. sustainability (n): s·ª± b·ªÅn v·ªØng<br>- C. sustainable (adj): b·ªÅn v·ªØng<br>- D. sustained (adj): ƒë∆∞·ª£c duy tr√¨ li√™n t·ª•c<br><br>**D·ªãch c√¢u:** Nhi·ªÅu qu·ªëc gia ƒëang th√∫c ƒë·∫©y du l·ªãch b·ªÅn v·ªØng ƒë·ªÉ b·∫£o v·ªá c√°c k·ª≥ quan thi√™n nhi√™n c·ªßa h·ªç.<br><br>**Gi·∫£i th√≠ch:** Ch·ªó tr·ªëng ƒë·ª©ng tr∆∞·ªõc danh t·ª´ 'tourism' (du l·ªãch), n√™n c·∫ßn m·ªôt t√≠nh t·ª´ (Adjective) ƒë·ªÉ b·ªï nghƒ©a. C·ª•m t·ª´ 'sustainable tourism' (du l·ªãch b·ªÅn v·ªØng) l√† m·ªôt thu·∫≠t ng·ªØ ph·ªï bi·∫øn.",
                  "isCorrect": true
                },
                {
                  "text": "sustainability",
                  "rationale": "",
                  "isCorrect": false
                },
                {
                  "text": "sustain",
                  "rationale": "",
                  "isCorrect": false
                },
                {
                  "text": "sustained",
                  "rationale": "",
                  "isCorrect": false
                }
              ],
              "hint": "Adjective describing tourism that is good for the environment."
            },
            {
              "questionNumber": 3,
              "question": "The Great Barrier Reef needs better ______________ from pollution and climate change. <span class='target-word'>(PROTECT)</span>",
              "answerOptions": [
                {
                  "text": "protection",
                  "rationale": "**Ph√¢n t√≠ch ƒë√°p √°n:**<br>- A. protect (v): b·∫£o v·ªá<br>- B. protection (n): s·ª± b·∫£o v·ªá<br>- C. protective (adj): mang t√≠nh b·∫£o v·ªá<br>- D. protector (n): ng∆∞·ªùi b·∫£o v·ªá<br><br>**D·ªãch c√¢u:** R·∫°n san h√¥ Great Barrier c·∫ßn s·ª± b·∫£o v·ªá t·ªët h∆°n kh·ªèi √¥ nhi·ªÖm v√† bi·∫øn ƒë·ªïi kh√≠ h·∫≠u.<br><br>**Gi·∫£i th√≠ch:** Sau t√≠nh t·ª´ so s√°nh 'better' v√† l√†m t√¢n ng·ªØ cho ƒë·ªông t·ª´ 'needs', ta c·∫ßn m·ªôt danh t·ª´ (Noun).",
                  "isCorrect": true
                },
                {
                  "text": "protect",
                  "rationale": "",
                  "isCorrect": false
                },
                {
                  "text": "protective",
                  "rationale": "",
                  "isCorrect": false
                },
                {
                  "text": "protector",
                  "rationale": "",
                  "isCorrect": false
                }
              ],
              "hint": "Noun form needed."
            },
            {
              "questionNumber": 4,
              "question": "Human activities are causing the ______________ of many natural habitats around the world. <span class='target-word'>(DESTROY)</span>",
              "answerOptions": [
                {
                  "text": "destruction",
                  "rationale": "**Ph√¢n t√≠ch ƒë√°p √°n:**<br>- A. destroy (v): ph√° h·ªßy<br>- B. destruction (n): s·ª± ph√° h·ªßy/h·ªßy ho·∫°i<br>- C. destructive (adj): c√≥ t√≠nh ph√° ho·∫°i<br>- D. destroyer (n): k·∫ª ph√° ho·∫°i/t√†u khu tr·ª•c<br><br>**D·ªãch c√¢u:** C√°c ho·∫°t ƒë·ªông c·ªßa con ng∆∞·ªùi ƒëang g√¢y ra s·ª± h·ªßy ho·∫°i nhi·ªÅu m√¥i tr∆∞·ªùng s·ªëng t·ª± nhi√™n tr√™n kh·∫Øp th·∫ø gi·ªõi.<br><br>**Gi·∫£i th√≠ch:** C·∫•u tr√∫c 'the ... of' lu√¥n y√™u c·∫ßu m·ªôt danh t·ª´ (Noun) ·ªü gi·ªØa.",
                  "isCorrect": true
                },
                {
                  "text": "destructive",
                  "rationale": "",
                  "isCorrect": false
                },
                {
                  "text": "destroy",
                  "rationale": "",
                  "isCorrect": false
                },
                {
                  "text": "destroyer",
                  "rationale": "",
                  "isCorrect": false
                }
              ],
              "hint": "Noun form ending in -tion."
            },
            {
              "questionNumber": 5,
              "question": "Visitors need special ______________ to camp overnight in Yellowstone National Park. <span class='target-word'>(PERMIT)</span>",
              "answerOptions": [
                {
                  "text": "permission",
                  "rationale": "**Ph√¢n t√≠ch ƒë√°p √°n:**<br>- A. permit (n/v): gi·∫•y ph√©p/cho ph√©p<br>- B. permission (n): s·ª± cho ph√©p<br>- C. permissive (adj): d·ªÖ d√£i<br>- D. permissibly (adv): m·ªôt c√°ch ch·∫•p nh·∫≠n ƒë∆∞·ª£c<br><br>**D·ªãch c√¢u:** Du kh√°ch c·∫ßn s·ª± cho ph√©p ƒë·∫∑c bi·ªát ƒë·ªÉ c·∫Øm tr·∫°i qua ƒë√™m t·∫°i V∆∞·ªùn Qu·ªëc gia Yellowstone.<br><br>**Gi·∫£i th√≠ch:** Sau t√≠nh t·ª´ 'special' c·∫ßn m·ªôt danh t·ª´. 'Permission' (s·ª± cho ph√©p - kh√¥ng ƒë·∫øm ƒë∆∞·ª£c) ho·∫∑c 'permits' (gi·∫•y ph√©p - ƒë·∫øm ƒë∆∞·ª£c). Trong b√†i t·∫≠p Word Form, bi·∫øn ƒë·ªïi t·ª´ ƒë·ªông t·ª´ 'permit' sang danh t·ª´ tr·ª´u t∆∞·ª£ng th∆∞·ªùng l√† 'permission'.",
                  "isCorrect": true
                },
                {
                  "text": "permit",
                  "rationale": "",
                  "isCorrect": false
                },
                {
                  "text": "permissive",
                  "rationale": "",
                  "isCorrect": false
                },
                {
                  "text": "permissibly",
                  "rationale": "",
                  "isCorrect": false
                }
              ],
              "hint": "Noun meaning 'authorization'."
            },
            {
              "questionNumber": 6,
              "question": "Scientists are taking the effects of global warming into ______________ when studying glaciers. <span class='target-word'>(CONSIDER)</span>",
              "answerOptions": [
                {
                  "text": "consideration",
                  "rationale": "**Ph√¢n t√≠ch ƒë√°p √°n:**<br>- A. consider (v): c√¢n nh·∫Øc<br>- B. consideration (n): s·ª± c√¢n nh·∫Øc<br>- C. considerable (adj): ƒë√°ng k·ªÉ<br>- D. considerate (adj): √¢n c·∫ßn/chu ƒë√°o<br><br>**D·ªãch c√¢u:** C√°c nh√† khoa h·ªçc ƒëang xem x√©t/c√¢n nh·∫Øc c√°c t√°c ƒë·ªông c·ªßa s·ª± n√≥ng l√™n to√†n c·∫ßu khi nghi√™n c·ª©u c√°c s√¥ng bƒÉng.<br><br>**Gi·∫£i th√≠ch:** C·ª•m t·ª´ c·ªë ƒë·ªãnh (Idiom): **take sth into consideration** (c√¢n nh·∫Øc k·ªπ ƒëi·ªÅu g√¨).",
                  "isCorrect": true
                },
                {
                  "text": "considerable",
                  "rationale": "",
                  "isCorrect": false
                },
                {
                  "text": "considerate",
                  "rationale": "",
                  "isCorrect": false
                },
                {
                  "text": "consider",
                  "rationale": "",
                  "isCorrect": false
                }
              ],
              "hint": "Idiom: 'Take something into ...'."
            },
            {
              "questionNumber": 7,
              "question": "The government is ______________ young people to learn about protecting natural wonders. <span class='target-word'>(ENCOURAGE)</span>",
              "answerOptions": [
                {
                  "text": "encouraging",
                  "rationale": "**Ph√¢n t√≠ch ƒë√°p √°n:**<br>- A. encourage (v): khuy·∫øn kh√≠ch<br>- B. encouraging (V-ing): ƒëang khuy·∫øn kh√≠ch<br>- C. encouragement (n): s·ª± khuy·∫øn kh√≠ch<br>- D. encouraged (V-ed): b·ªã ƒë·ªông/ƒë√£ khuy·∫øn kh√≠ch<br><br>**D·ªãch c√¢u:** Ch√≠nh ph·ªß ƒëang khuy·∫øn kh√≠ch gi·ªõi tr·∫ª t√¨m hi·ªÉu v·ªÅ vi·ªác b·∫£o v·ªá c√°c k·ª≥ quan thi√™n nhi√™n.<br><br>**Gi·∫£i th√≠ch:** C·∫•u tr√∫c th√¨ Hi·ªán t·∫°i ti·∫øp di·ªÖn: S + is + V-ing. Ch√≠nh ph·ªß th·ª±c hi·ªán h√†nh ƒë·ªông n√†y (ch·ªß ƒë·ªông) n√™n d√πng 'encouraging'.",
                  "isCorrect": true
                },
                {
                  "text": "encourage",
                  "rationale": "",
                  "isCorrect": false
                },
                {
                  "text": "encouragement",
                  "rationale": "",
                  "isCorrect": false
                },
                {
                  "text": "encouraged",
                  "rationale": "",
                  "isCorrect": false
                }
              ],
              "hint": "Present Continuous tense: is + V-ing."
            },
            {
              "questionNumber": 8,
              "question": "Many ______________ species live in the Amazon rainforest and need our help. <span class='target-word'>(ENDANGER)</span>",
              "answerOptions": [
                {
                  "text": "endangered",
                  "rationale": "**Ph√¢n t√≠ch ƒë√°p √°n:**<br>- A. danger (n): s·ª± nguy hi·ªÉm<br>- B. dangerous (adj): nguy hi·ªÉm (g√¢y h·∫°i cho ng∆∞·ªùi kh√°c)<br>- C. endangered (adj): b·ªã ƒëe d·ªça tuy·ªát ch·ªßng/nguy c·∫•p<br>- D. endanger (v): g√¢y nguy hi·ªÉm<br><br>**D·ªãch c√¢u:** Nhi·ªÅu lo√†i c√≥ nguy c∆° tuy·ªát ch·ªßng s·ªëng trong r·ª´ng nhi·ªát ƒë·ªõi Amazon v√† c·∫ßn s·ª± gi√∫p ƒë·ª° c·ªßa ch√∫ng ta.<br><br>**Gi·∫£i th√≠ch:** C·∫ßn m·ªôt t√≠nh t·ª´ b·ªï nghƒ©a cho 'species'. 'Endangered species' l√† thu·∫≠t ng·ªØ ch·ªâ c√°c lo√†i ƒë·ªông v·∫≠t qu√Ω hi·∫øm ƒëang b·ªã ƒëe d·ªça.",
                  "isCorrect": true
                },
                {
                  "text": "dangerous",
                  "rationale": "",
                  "isCorrect": false
                },
                {
                  "text": "danger",
                  "rationale": "",
                  "isCorrect": false
                },
                {
                  "text": "endanger",
                  "rationale": "",
                  "isCorrect": false
                }
              ],
              "hint": "Adjective describing animals at risk of extinction."
            },
            {
              "questionNumber": 9,
              "question": "Volcanic eruptions are natural ______________ that can create new landscapes. <span class='target-word'>(OCCUR)</span>",
              "answerOptions": [
                {
                  "text": "occurrences",
                  "rationale": "**Ph√¢n t√≠ch ƒë√°p √°n:**<br>- A. occur (v): x·∫£y ra<br>- B. occurrence (n): s·ª± vi·ªác/bi·∫øn c·ªë (s·ªë √≠t)<br>- C. occurrences (n): c√°c s·ª± vi·ªác/hi·ªán t∆∞·ª£ng (s·ªë nhi·ªÅu)<br>- D. occurring (V-ing): ƒëang x·∫£y ra<br><br>**D·ªãch c√¢u:** Phun tr√†o n√∫i l·ª≠a l√† nh·ªØng hi·ªán t∆∞·ª£ng t·ª± nhi√™n c√≥ th·ªÉ t·∫°o ra nh·ªØng c·∫£nh quan m·ªõi.<br><br>**Gi·∫£i th√≠ch:** Sau t√≠nh t·ª´ 'natural' c·∫ßn m·ªôt danh t·ª´. Ch·ªß ng·ªØ 'Volcanic eruptions' l√† s·ªë nhi·ªÅu, ƒë·ªông t·ª´ 'are' l√† s·ªë nhi·ªÅu, n√™n danh t·ª´ b·ªï ng·ªØ c≈©ng ph·∫£i ·ªü d·∫°ng s·ªë nhi·ªÅu -> 'occurrences'.",
                  "isCorrect": true
                },
                {
                  "text": "occurrence",
                  "rationale": "",
                  "isCorrect": false
                },
                {
                  "text": "occur",
                  "rationale": "",
                  "isCorrect": false
                },
                {
                  "text": "occurring",
                  "rationale": "",
                  "isCorrect": false
                }
              ],
              "hint": "Plural noun meaning 'events' or 'happenings'."
            },
            {
              "questionNumber": 10,
              "question": "Millions of tourists visit Ha Long Bay every year because of its ______________ beauty. <span class='target-word'>(ADMIRE)</span>",
              "answerOptions": [
                {
                  "text": "admirable",
                  "rationale": "**Ph√¢n t√≠ch ƒë√°p √°n:**<br>- A. admire (v): ng∆∞·ª°ng m·ªô<br>- B. admiration (n): s·ª± ng∆∞·ª°ng m·ªô<br>- C. admirable (adj): ƒë√°ng ng∆∞·ª°ng m·ªô/tuy·ªát v·ªùi<br>- D. admiring (adj): th·ªÉ hi·ªán s·ª± ng∆∞·ª°ng m·ªô (d√πng cho ng∆∞·ªùi)<br><br>**D·ªãch c√¢u:** H√†ng tri·ªáu du kh√°ch ƒë·∫øn thƒÉm V·ªãnh H·∫° Long m·ªói nƒÉm v√¨ v·∫ª ƒë·∫πp ƒë√°ng ng∆∞·ª°ng m·ªô c·ªßa n√≥.<br><br>**Gi·∫£i th√≠ch:** Tr∆∞·ªõc danh t·ª´ 'beauty' c·∫ßn m·ªôt t√≠nh t·ª´. 'Admirable' ch·ªâ t√≠nh ch·∫•t c·ªßa s·ª± v·∫≠t (ƒë√°ng ƒë·ªÉ ng∆∞·ªùi kh√°c ng∆∞·ª°ng m·ªô).",
                  "isCorrect": true
                },
                {
                  "text": "admiring",
                  "rationale": "",
                  "isCorrect": false
                },
                {
                  "text": "admiration",
                  "rationale": "",
                  "isCorrect": false
                },
                {
                  "text": "admire",
                  "rationale": "",
                  "isCorrect": false
                }
              ]
            }
          ]
        };

        // --- GAME STATE & VARIABLES ---
        let currentQuestionIndex = 0;
        let score = 0;
        let isAnswered = false;
        let questions = [];

        // Synthesized sounds using simple AudioContext to avoid external link breakage
        const AudioContext = window.AudioContext || window.webkitAudioContext;
        const audioCtx = new AudioContext();

        function playSound(type) {
            const osc = audioCtx.createOscillator();
            const gainNode = audioCtx.createGain();
            osc.connect(gainNode);
            gainNode.connect(audioCtx.destination);

            if (type === 'correct') {
                // High chime: C6 -> E6
                osc.type = 'sine';
                osc.frequency.setValueAtTime(1046.50, audioCtx.currentTime); // C6
                osc.frequency.exponentialRampToValueAtTime(1318.51, audioCtx.currentTime + 0.1); // E6
                gainNode.gain.setValueAtTime(0.3, audioCtx.currentTime);
                gainNode.gain.exponentialRampToValueAtTime(0.01, audioCtx.currentTime + 0.3);
                osc.start();
                osc.stop(audioCtx.currentTime + 0.3);
            } else if (type === 'wrong') {
                // Low buzz: G2 -> C2
                osc.type = 'sawtooth';
                osc.frequency.setValueAtTime(98, audioCtx.currentTime); // G2
                osc.frequency.linearRampToValueAtTime(65, audioCtx.currentTime + 0.3); // C2
                gainNode.gain.setValueAtTime(0.3, audioCtx.currentTime);
                gainNode.gain.exponentialRampToValueAtTime(0.01, audioCtx.currentTime + 0.3);
                osc.start();
                osc.stop(audioCtx.currentTime + 0.3);
            }
        }

        // --- INITIALIZATION ---
        function initGame() {
            // Shuffle questions
            questions = shuffleArray([...quizData.questions]);
            currentQuestionIndex = 0;
            score = 0;
            updateProgressBar();
            loadQuestion();
        }

        // Fisher-Yates Shuffle
        function shuffleArray(array) {
            for (let i = array.length - 1; i > 0; i--) {
                const j = Math.floor(Math.random() * (i + 1));
                [array[i], array[j]] = [array[j], array[i]];
            }
            return array;
        }

        function updateProgressBar() {
            const percent = ((currentQuestionIndex) / questions.length) * 100;
            document.getElementById('progressBar').style.width = percent + '%';
        }

        function loadQuestion() {
            isAnswered = false;
            const q = questions[currentQuestionIndex];
            
            // Render Question Text
            document.getElementById('questionText').innerHTML = `
                <span style="font-size:0.9em; color:#888;">C√¢u ${currentQuestionIndex + 1}/${questions.length}</span><br>
                ${q.question}
                ${q.hint ? `<div class="hint-text"><i class="fas fa-lightbulb" style="color:#f1c40f"></i> Hint: ${q.hint}</div>` : ''}
            `;

            // Setup Options
            const optionsContainer = document.getElementById('optionsContainer');
            optionsContainer.innerHTML = '';
            
            // Find correct answer object to get full explanation later
            const correctAnswerObj = q.answerOptions.find(opt => opt.isCorrect);

            // Shuffle Options for display
            const displayOptions = shuffleArray([...q.answerOptions]);

            displayOptions.forEach(opt => {
                const btn = document.createElement('button');
                btn.className = 'option-btn';
                btn.innerHTML = `<span>${opt.text}</span>`;
                btn.onclick = () => checkAnswer(btn, opt, correctAnswerObj, q.questionNumber);
                optionsContainer.appendChild(btn);
            });

            // Reset UI
            document.getElementById('explanationBox').style.display = 'none';
            document.getElementById('nextBtnContainer').style.display = 'none';
        }

        function checkAnswer(selectedBtn, selectedOpt, correctOpt, qNum) {
            if (isAnswered) return;
            isAnswered = true;

            const allBtns = document.querySelectorAll('.option-btn');
            let isCorrect = selectedOpt.isCorrect;

            if (isCorrect) {
                // CORRECT
                selectedBtn.classList.add('correct');
                selectedBtn.innerHTML += ` <i class="fas fa-check-circle"></i>`;
                score++;
                playSound('correct');
                
                // Confetti Effect
                confetti({
                    particleCount: 100,
                    spread: 70,
                    origin: { y: 0.6 },
                    colors: ['#00D26A', '#8854C0', '#F1C40F']
                });
            } else {
                // WRONG
                selectedBtn.classList.add('wrong');
                selectedBtn.innerHTML += ` <i class="fas fa-times-circle"></i>`;
                playSound('wrong');

                // Highlight correct one
                allBtns.forEach(btn => {
                    if (btn.innerText.trim() === correctOpt.text) {
                        btn.classList.add('correct');
                        btn.innerHTML += ` <i class="fas fa-check-circle"></i>`;
                    }
                });
            }

            // Disable all buttons
            allBtns.forEach(btn => btn.disabled = true);

            // Show Explanation
            const explanationBox = document.getElementById('explanationBox');
            const explanationText = document.getElementById('explanationText');
            
            // Format markdown text to HTML just in case
            let rawRationale = correctOpt.rationale;
            // The JSON input already has formatted HTML breaks <br> and bolding from my manual mapping, 
            // but let's ensure double asterisks become bold tags if they exist.
            rawRationale = rawRationale.replace(/\*\*(.*?)\*\*/g, '<strong>$1</strong>');
            rawRationale = rawRationale.replace(/\n/g, '<br>');

            explanationText.innerHTML = rawRationale;
            explanationBox.style.display = 'block';

            // Show Next Button
            document.getElementById('nextBtnContainer').style.display = 'block';
            
            // Update progress bar to completed state for this q
            const percent = ((currentQuestionIndex + 1) / questions.length) * 100;
            document.getElementById('progressBar').style.width = percent + '%';
        }

        function nextQuestion() {
            currentQuestionIndex++;
            if (currentQuestionIndex < questions.length) {
                loadQuestion();
            } else {
                showResults();
            }
        }

        function showResults() {
            const overlay = document.getElementById('resultOverlay');
            const scoreDiv = document.getElementById('finalScore');
            const msgDiv = document.getElementById('finalMessage');
            const commentDiv = document.getElementById('finalComment');

            scoreDiv.textContent = `${score}/${questions.length}`;
            
            if (score === questions.length) {
                msgDiv.textContent = "Xu·∫•t s·∫Øc! üåü";
                commentDiv.textContent = "B·∫°n l√† chuy√™n gia ng√¥n ng·ªØ t∆∞∆°ng lai!";
                confetti({ particleCount: 200, spread: 100, origin: { y: 0.6 } });
            } else if (score >= questions.length * 0.7) {
                msgDiv.textContent = "L√†m t·ªët l·∫Øm! üëç";
                commentDiv.textContent = "C·ªë g·∫Øng th√™m m·ªôt ch√∫t n·ªØa l√† ƒë·∫°t ƒëi·ªÉm t·ªëi ƒëa!";
            } else {
                msgDiv.textContent = "C·ªë l√™n nh√©! üí™";
                commentDiv.textContent = "H√£y xem l·∫°i ph·∫ßn gi·∫£i th√≠ch ƒë·ªÉ hi·ªÉu r√µ h∆°n nha.";
            }

            overlay.style.display = 'flex';
        }

        // Start the game
        initGame();

        // Prevent resume audio context issues
        document.body.addEventListener('click', () => {
            if (audioCtx.state === 'suspended') {
                audioCtx.resume();
            }
        }, { once: true });

    </script>
</body>
</html>
