<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Reading Test - Ms Mai An ULIS</title>
    <link href="https://fonts.googleapis.com/css2?family=Quicksand:wght@500;700;900&display=swap" rel="stylesheet">
    <style>
        /* === DYNAMIC THEME & GAMIFICATION BACKGROUND === */
        :root {
            --primary-bg: #e0f7fa;
            --correct-color: #00D26A;
            --correct-shadow: #00A653;
            --wrong-color: #FF4757;
            --wrong-shadow: #D93845;
            --option-bg: #ffffff;
            --option-shadow: #e5e5e5;
            --text-main: #2d3436;
        }

        body {
            margin: 0;
            font-family: 'Quicksand', sans-serif;
            background: linear-gradient(-45deg, #00C9A7, #8854C0, #74b9ff, #FDCB6E);
            background-size: 400% 400%;
            animation: gradientMove 15s ease infinite;
            color: var(--text-main);
            height: 100vh;
            display: flex;
            flex-direction: column;
            overflow: hidden;
            position: relative;
        }

        /* Animated Emoji Background based on 'Ice/Skating' Theme */
        body::before {
            content: "";
            position: absolute;
            top: -50%; left: -50%; width: 200%; height: 200%;
            background-image: url('data:image/svg+xml;utf8,<svg xmlns="http://www.w3.org/2000/svg" width="250" height="250"><text x="20" y="40" font-size="40" opacity="0.6">‚ùÑÔ∏è</text><text x="150" y="100" font-size="40" opacity="0.6">‚õ∏Ô∏è</text><text x="80" y="200" font-size="40" opacity="0.6">üßä</text><text x="200" y="220" font-size="40" opacity="0.6">‚ú®</text></svg>');
            animation: floatPattern 40s linear infinite;
            pointer-events: none;
            z-index: 0;
            mix-blend-mode: overlay;
        }

        @keyframes gradientMove {
            0% { background-position: 0% 50%; }
            50% { background-position: 100% 50%; }
            100% { background-position: 0% 50%; }
        }

        @keyframes floatPattern {
            0% { transform: rotate(0deg) translate(0, 0); }
            100% { transform: rotate(360deg) translate(-100px, -100px); }
        }

        /* === TOP CONTROL BAR === */
        #top-bar {
            height: 60px;
            background: rgba(255, 255, 255, 0.95);
            box-shadow: 0 4px 15px rgba(0,0,0,0.1);
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 0 30px;
            z-index: 10;
            position: relative;
        }

        .header-title {
            font-weight: 900;
            color: #8854C0;
            font-size: 1.2rem;
            margin: 0;
        }

        .timer-container {
            display: flex;
            align-items: center;
            gap: 15px;
        }

        #timer-display {
            font-size: 1.5rem;
            font-weight: 900;
            color: #FF4757;
            background: #ffeaa7;
            padding: 5px 15px;
            border-radius: 12px;
            border: 2px solid #fdcb6e;
        }

        .btn-gamify {
            background: #00C9A7;
            color: white;
            border: none;
            padding: 10px 20px;
            font-size: 1.1rem;
            font-weight: 700;
            font-family: 'Quicksand', sans-serif;
            border-radius: 15px;
            box-shadow: 0 5px 0 #00A653;
            cursor: pointer;
            transition: all 0.1s;
        }
        .btn-gamify:active {
            transform: translateY(5px);
            box-shadow: 0 0 0 #00A653;
        }
        
        /* === SPLIT SCREEN === */
        #main-container {
            display: flex;
            flex: 1;
            overflow: hidden;
            z-index: 1;
            padding: 20px;
            gap: 20px;
        }

        .panel {
            flex: 1;
            background: rgba(255, 255, 255, 0.92);
            border-radius: 20px;
            padding: 30px;
            overflow-y: auto;
            box-shadow: 0 10px 30px rgba(0,0,0,0.15);
            backdrop-filter: blur(10px);
            border: 3px solid rgba(255,255,255,0.5);
        }

        /* Custom Scrollbar */
        ::-webkit-scrollbar { width: 10px; }
        ::-webkit-scrollbar-track { background: #f1f1f1; border-radius: 10px; }
        ::-webkit-scrollbar-thumb { background: #8854C0; border-radius: 10px; }
        ::-webkit-scrollbar-thumb:hover { background: #6a3a9e; }

        /* === READING PASSAGE PANEL === */
        .passage-title {
            font-size: 2rem;
            color: #0984e3;
            text-align: center;
            margin-bottom: 20px;
            font-weight: 900;
        }

        .paragraph-container {
            margin-bottom: 25px;
            line-height: 1.7;
            font-size: 1.15rem;
        }

        .btn-translate {
            background: #74b9ff;
            box-shadow: 0 4px 0 #0984e3;
            font-size: 0.9rem;
            padding: 5px 15px;
            margin-top: 10px;
        }

        .translation-text {
            display: none;
            background: #e0f7fa;
            border-left: 5px solid #00C9A7;
            padding: 15px;
            margin-top: 10px;
            border-radius: 0 10px 10px 0;
            color: #2c3e50;
            font-style: italic;
        }

        /* === GLOSSARY TABLE === */
        .glossary-wrapper {
            margin-top: 40px;
            background: #fff;
            border-radius: 15px;
            padding: 20px;
            box-shadow: 0 5px 15px rgba(0,0,0,0.05);
            border: 2px dashed #8854C0;
        }
        .glossary-wrapper h3 {
            color: #8854C0;
            text-align: center;
            font-size: 1.5rem;
            margin-top: 0;
        }
        table {
            width: 100%;
            border-collapse: collapse;
            font-size: 1.05rem;
        }
        th, td {
            padding: 12px;
            text-align: left;
            border-bottom: 1px solid #eee;
        }
        th { background: #8854C0; color: white; border-radius: 5px; }
        .word-col { font-weight: bold; color: #0984e3; }
        .type-col { color: #e17055; font-style: italic; }

        /* === EXERCISES PANEL === */
        .question-card {
            background: white;
            border-radius: 20px;
            padding: 25px;
            margin-bottom: 30px;
            box-shadow: 0 8px 0 #e5e5e5;
            border: 2px solid #f1f1f1;
        }
        
        .question-text {
            font-size: 1.3rem;
            font-weight: 800;
            margin-bottom: 20px;
            color: #2d3436;
        }

        .options-grid {
            display: flex;
            flex-direction: column;
            gap: 15px;
        }

        .option-btn {
            background: var(--option-bg);
            border: 2px solid #e5e5e5;
            padding: 15px 20px;
            border-radius: 15px;
            font-size: 1.15rem;
            font-family: 'Quicksand', sans-serif;
            font-weight: 700;
            color: #2d3436;
            text-align: left;
            cursor: pointer;
            box-shadow: 0 5px 0 var(--option-shadow);
            transition: all 0.1s ease;
            display: flex;
            align-items: center;
        }
        .option-btn:hover {
            transform: scale(1.02);
            border-color: #74b9ff;
        }
        .option-btn:active {
            transform: translateY(5px) scale(1.02);
            box-shadow: 0 0 0 transparent;
        }

        /* States */
        .option-btn.correct {
            background: var(--correct-color);
            color: white;
            border-color: var(--correct-color);
            box-shadow: 0 5px 0 var(--correct-shadow);
        }
        .option-btn.wrong {
            background: var(--wrong-color);
            color: white;
            border-color: var(--wrong-color);
            box-shadow: 0 5px 0 var(--wrong-shadow);
            animation: shake 0.4s cubic-bezier(.36,.07,.19,.97) both;
        }

        @keyframes shake {
            10%, 90% { transform: translate3d(-1px, 0, 0); }
            20%, 80% { transform: translate3d(2px, 0, 0); }
            30%, 50%, 70% { transform: translate3d(-4px, 0, 0); }
            40%, 60% { transform: translate3d(4px, 0, 0); }
        }

        /* Explanation Box */
        .explanation-box {
            display: none;
            margin-top: 20px;
            padding: 20px;
            background: #fff3cd;
            border-left: 6px solid #fdcb6e;
            border-radius: 10px;
            font-size: 1.05rem;
            line-height: 1.6;
            animation: fadeIn 0.5s ease;
        }
        .explanation-box h4 {
            margin-top: 0;
            color: #d35400;
            font-size: 1.2rem;
        }
        .exp-highlight { font-weight: bold; color: #0984e3; }
        .exp-translation { font-style: italic; color: #27ae60; background: #e8f8f5; padding: 5px; border-radius: 5px;}

        @keyframes fadeIn { from {opacity: 0; transform: translateY(-10px);} to {opacity: 1; transform: translateY(0);} }

        /* Submit Button */
        #btn-submit {
            display: block;
            width: 100%;
            background: #8854C0;
            color: white;
            text-align: center;
            font-size: 1.5rem;
            padding: 20px;
            border-radius: 20px;
            box-shadow: 0 8px 0 #6a3a9e;
            border: none;
            cursor: pointer;
            font-family: 'Quicksand', sans-serif;
            font-weight: 900;
            margin-top: 30px;
            transition: all 0.2s;
        }
        #btn-submit:active { transform: translateY(8px); box-shadow: 0 0 0 transparent; }

        /* === RESULT MODAL === */
        #result-modal {
            display: none;
            position: fixed;
            top: 0; left: 0; width: 100%; height: 100%;
            background: rgba(0,0,0,0.8);
            z-index: 1000;
            justify-content: center;
            align-items: center;
            backdrop-filter: blur(5px);
        }
        .modal-content {
            background: white;
            padding: 50px;
            border-radius: 30px;
            text-align: center;
            max-width: 500px;
            width: 90%;
            box-shadow: 0 15px 50px rgba(0,0,0,0.5);
            animation: popIn 0.5s cubic-bezier(0.175, 0.885, 0.32, 1.275);
        }
        @keyframes popIn { 0% {transform: scale(0.5); opacity: 0;} 100% {transform: scale(1); opacity: 1;} }
        
        .score-circle {
            width: 150px; height: 150px;
            background: linear-gradient(135deg, #00C9A7, #0984e3);
            border-radius: 50%;
            display: flex;
            justify-content: center;
            align-items: center;
            margin: 0 auto 20px;
            color: white;
            font-size: 3rem;
            font-weight: 900;
            border: 10px solid #e0f7fa;
            box-shadow: 0 10px 20px rgba(0,0,0,0.2);
        }
        .feedback-text { font-size: 1.8rem; font-weight: 900; color: #8854C0; margin-bottom: 10px;}
        .sub-feedback { font-size: 1.1rem; color: #636e72; margin-bottom: 30px;}
        
        /* Confetti Canvas */
        #confetti-container {
            position: fixed; top: 0; left: 0; width: 100%; height: 100%;
            pointer-events: none; z-index: 999;
        }
        .confetti-piece {
            position: absolute;
            width: 10px; height: 20px;
            background: #ffd300;
            animation: fall 3s linear forwards;
        }
        @keyframes fall {
            to { transform: translateY(100vh) rotate(720deg); }
        }

    </style>
</head>
<body>

    <div id="confetti-container"></div>

    <div id="top-bar">
        <h3 class="header-title">B√†i thi: Ms Mai An ULIS</h3>
        <div class="timer-container">
            <div id="timer-display">10:00</div>
            <button id="btn-timer" class="btn-gamify">B·∫ÆT ƒê·∫¶U T√çNH GI·ªú</button>
        </div>
    </div>

    <div id="main-container">
        
        <div class="panel" id="left-panel">
            <h1 class="passage-title">‚õ∏Ô∏è Callie Rice ‚Äì ice dancer ‚ùÑÔ∏è</h1>
            
            <div class="paragraph-container">
                <div class="text-content">
                    Growing up, I was in an ice-skating club, and my friends and I did lots of competitions. When I was 18, I entered a big one in Italy, and I came first. The prize was a job as an ice dancer in a big show. That‚Äôs how my career started.
                </div>
                <button class="btn-gamify btn-translate" onclick="toggleTranslation(this)">B·∫¢N D·ªäCH ƒê·∫¶Y ƒê·ª¶</button>
                <div class="translation-text">L·ªõn l√™n, t√¥i tham gia m·ªôt c√¢u l·∫°c b·ªô tr∆∞·ª£t bƒÉng, v√† t√¥i c√πng b·∫°n b√® ƒë√£ tham gia r·∫•t nhi·ªÅu cu·ªôc thi. Khi 18 tu·ªïi, t√¥i tham d·ª± m·ªôt cu·ªôc thi l·ªõn ·ªü √ù v√† ƒë√£ gi√†nh gi·∫£i nh·∫•t. Ph·∫ßn th∆∞·ªüng l√† m·ªôt c√¥ng vi·ªác l√†m v≈© c√¥ng tr∆∞·ª£t bƒÉng ngh·ªá thu·∫≠t trong m·ªôt ch∆∞∆°ng tr√¨nh l·ªõn. S·ª± nghi·ªáp c·ªßa t√¥i ƒë√£ b·∫Øt ƒë·∫ßu nh∆∞ th·∫ø ƒë·∫•y.</div>
            </div>

            <div class="paragraph-container">
                <div class="text-content">
                    One of the things I love about the shows is the beautiful clothes. The only trouble is that sometimes they‚Äôre heavy and I get very hot. Also, I have to change lots of times in one show. The people who make the clothes are very clever ‚Äì it‚Äôs amazing how quickly they work!
                </div>
                <button class="btn-gamify btn-translate" onclick="toggleTranslation(this)">B·∫¢N D·ªäCH ƒê·∫¶Y ƒê·ª¶</button>
                <div class="translation-text">M·ªôt trong nh·ªØng ƒëi·ªÅu t√¥i y√™u th√≠ch ·ªü c√°c bu·ªïi di·ªÖn l√† nh·ªØng b·ªô trang ph·ª•c tuy·ªát ƒë·∫πp. R·∫Øc r·ªëi duy nh·∫•t l√† ƒë√¥i khi ch√∫ng r·∫•t n·∫∑ng v√† l√†m t√¥i th·∫•y r·∫•t n√≥ng. H∆°n n·ªØa, t√¥i ph·∫£i thay ƒë·ªì r·∫•t nhi·ªÅu l·∫ßn trong m·ªôt bu·ªïi di·ªÖn. Nh·ªØng ng∆∞·ªùi th·ª£ may trang ph·ª•c r·∫•t kh√©o l√©o ‚Äì th·∫≠t ƒë√°ng ng·∫°c nhi√™n v·ªÅ t·ªëc ƒë·ªô l√†m vi·ªác c·ªßa h·ªç!</div>
            </div>

            <div class="paragraph-container">
                <div class="text-content">
                    Before the show starts, we get dressed, put our skates on, and wish each other good luck. Then, while I‚Äôm waiting to go on, I like to sit quietly by myself and think about what I‚Äôm going to do. The other skaters chat together or listen to music.
                </div>
                <button class="btn-gamify btn-translate" onclick="toggleTranslation(this)">B·∫¢N D·ªäCH ƒê·∫¶Y ƒê·ª¶</button>
                <div class="translation-text">Tr∆∞·ªõc khi bu·ªïi di·ªÖn b·∫Øt ƒë·∫ßu, ch√∫ng t√¥i m·∫∑c trang ph·ª•c, mang gi√†y tr∆∞·ª£t v√† ch√∫c nhau may m·∫Øn. Sau ƒë√≥, trong khi ch·ªù ƒë·∫øn l∆∞·ª£t ra s√¢n kh·∫•u, t√¥i th√≠ch ng·ªìi tƒ©nh l·∫∑ng m·ªôt m√¨nh v√† suy nghƒ© v·ªÅ nh·ªØng g√¨ m√¨nh s·∫Øp bi·ªÉu di·ªÖn. Nh·ªØng ng∆∞·ªùi tr∆∞·ª£t bƒÉng kh√°c th√¨ tr√≤ chuy·ªán c√πng nhau ho·∫∑c nghe nh·∫°c.</div>
            </div>

            <div class="paragraph-container">
                <div class="text-content">
                    In the shows, we have to dance, sing, and also speak. For me, ice dancing is fine, but I‚Äôm not an actor. I‚Äôm always a bit scared I won‚Äôt remember the words. I‚Äôm not bothered about falling ‚Äì it doesn‚Äôt usually happen. And I really enjoy joining in with all the songs.
                </div>
                <button class="btn-gamify btn-translate" onclick="toggleTranslation(this)">B·∫¢N D·ªäCH ƒê·∫¶Y ƒê·ª¶</button>
                <div class="translation-text">Trong c√°c ch∆∞∆°ng tr√¨nh, ch√∫ng t√¥i ph·∫£i khi√™u v≈©, h√°t v√† c·∫£ n√≥i n·ªØa. V·ªõi t√¥i, tr∆∞·ª£t bƒÉng ngh·ªá thu·∫≠t th√¨ ·ªïn, nh∆∞ng t√¥i kh√¥ng ph·∫£i l√† di·ªÖn vi√™n. T√¥i lu√¥n h∆°i s·ª£ r·∫±ng m√¨nh s·∫Ω kh√¥ng nh·ªõ l·ªùi tho·∫°i. T√¥i kh√¥ng b·∫≠n t√¢m l·∫Øm v·ªÅ vi·ªác b·ªã ng√£ ‚Äì ƒëi·ªÅu ƒë√≥ kh√¥ng th∆∞·ªùng x·∫£y ra. V√† t√¥i th·ª±c s·ª± th√≠ch vi·ªác h√≤a m√¨nh v√†o t·∫•t c·∫£ c√°c b√†i h√°t.</div>
            </div>

            <div class="paragraph-container">
                <div class="text-content">
                    People always ask me if I‚Äôm tired when each show finishes, but I love skating, so I never feel that way. I love listening to the people who came to watch ‚Äì so excited as they leave, talking about what they‚Äôve seen. That‚Äôs when I‚Äôm really happy I chose ice dancing as a career.
                </div>
                <button class="btn-gamify btn-translate" onclick="toggleTranslation(this)">B·∫¢N D·ªäCH ƒê·∫¶Y ƒê·ª¶</button>
                <div class="translation-text">M·ªçi ng∆∞·ªùi lu√¥n h·ªèi t√¥i c√≥ th·∫•y m·ªát khi m·ªói bu·ªïi di·ªÖn k·∫øt th√∫c kh√¥ng, nh∆∞ng t√¥i y√™u tr∆∞·ª£t bƒÉng, n√™n t√¥i ch·∫≥ng bao gi·ªù c·∫£m th·∫•y nh∆∞ v·∫≠y. T√¥i th√≠ch l·∫Øng nghe nh·ªØng kh√°n gi·∫£ ƒë·∫øn xem ‚Äì h·ªç r·∫•t ph·∫•n kh√≠ch khi ra v·ªÅ, b√†n t√°n v·ªÅ nh·ªØng g√¨ h·ªç ƒë√£ xem. ƒê√≥ l√† l√∫c t√¥i th·ª±c s·ª± h·∫°nh ph√∫c v√¨ ƒë√£ ch·ªçn tr∆∞·ª£t bƒÉng ngh·ªá thu·∫≠t l√†m s·ª± nghi·ªáp.</div>
            </div>

            <div class="glossary-wrapper">
                <h3>üìö Academic Glossary (B·∫£ng T·ª´ V·ª±ng B1-C2)</h3>
                <table>
                    <thead>
                        <tr>
                            <th>Vocabulary (T·ª´ v·ª±ng)</th>
                            <th>Part of Speech (Lo·∫°i t·ª´)</th>
                            <th>Vietnamese Meaning (Nghƒ©a)</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr><td class="word-col">1. Competition</td><td class="type-col">noun (n)</td><td>Cu·ªôc thi, s·ª± c·∫°nh tranh (B1)</td></tr>
                        <tr><td class="word-col">2. Career</td><td class="type-col">noun (n)</td><td>S·ª± nghi·ªáp, ngh·ªÅ nghi·ªáp (B1)</td></tr>
                        <tr><td class="word-col">3. Amazing</td><td class="type-col">adjective (adj)</td><td>ƒê√°ng kinh ng·∫°c, tuy·ªát v·ªùi (B1)</td></tr>
                        <tr><td class="word-col">4. Trouble</td><td class="type-col">noun (n)</td><td>V·∫•n ƒë·ªÅ, r·∫Øc r·ªëi (B1)</td></tr>
                        <tr><td class="word-col">5. Chat</td><td class="type-col">verb (v)</td><td>Tr√≤ chuy·ªán, t√°n g·∫´u (A2/B1)</td></tr>
                        <tr><td class="word-col">6. Scared</td><td class="type-col">adjective (adj)</td><td>S·ª£ h√£i, lo l·∫Øng (B1)</td></tr>
                        <tr><td class="word-col">7. Bothered</td><td class="type-col">adjective (adj)</td><td>B·∫≠n t√¢m, phi·ªÅn l√≤ng (B2)</td></tr>
                        <tr><td class="word-col">8. Accident</td><td class="type-col">noun (n)</td><td>Tai n·∫°n, s·ª± c·ªë (A2/B1)</td></tr>
                        <tr><td class="word-col">9. Glad / Pleased</td><td class="type-col">adjective (adj)</td><td>Vui v·∫ª, h√†i l√≤ng, m√£n nguy·ªán (B1)</td></tr>
                        <tr><td class="word-col">10. Join in</td><td class="type-col">phrasal verb</td><td>Tham gia v√†o (m·ªôt ho·∫°t ƒë·ªông) (B1)</td></tr>
                    </tbody>
                </table>
            </div>
        </div>

        <div class="panel" id="right-panel">
            <div id="quiz-container"></div>
            <button id="btn-submit" onclick="submitTest()">üéâ N·ªòP B√ÄI üéâ</button>
        </div>
    </div>

    <div id="result-modal">
        <div class="modal-content">
            <div class="score-circle" id="final-score">0/5</div>
            <div class="feedback-text" id="final-feedback">Tuy·ªát V·ªùi!</div>
            <div class="sub-feedback" id="final-sub">C√¥ Mai An r·∫•t t·ª± h√†o v·ªÅ b·∫°n!</div>
            <button class="btn-gamify" style="width:100%; font-size: 1.2rem;" onclick="location.reload()">L√†m L·∫°i L·∫ßn N·ªØa</button>
        </div>
    </div>

    <script>
        // --- DATA B√ÄI T·∫¨P & GI·∫¢I TH√çCH CHI TI·∫æT ---
        const quizData = [
            {
                id: 1,
                question: "1. How did Callie‚Äôs career as an ice dancer begin?",
                options: [
                    { text: "She won a competition.", isCorrect: true },
                    { text: "She saw an advert for a job.", isCorrect: false },
                    { text: "A friend invited her to join an ice show.", isCorrect: false }
                ],
                explanation: `
                    <h4>GI·∫¢I TH√çCH CHI TI·∫æT C√ÇU 1:</h4>
                    <p><b>1. D·ªãch c√¢u h·ªèi:</b> S·ª± nghi·ªáp v≈© c√¥ng tr∆∞·ª£t bƒÉng c·ªßa Callie b·∫Øt ƒë·∫ßu nh∆∞ th·∫ø n√†o?</p>
                    <p><b>2. D·∫´n ch·ª©ng trong b√†i:</b> ƒêo·∫°n 1: <span class="exp-highlight">"When I was 18, I entered a big one in Italy, and I came first. The prize was a job as an ice dancer..."</span></p>
                    <p class="exp-translation">-> D·ªãch: "Khi 18 tu·ªïi, t√¥i tham d·ª± m·ªôt cu·ªôc thi l·ªõn ·ªü √ù v√† ƒë√£ v·ªÅ nh·∫•t. Ph·∫ßn th∆∞·ªüng l√† c√¥ng vi·ªác v≈© c√¥ng tr∆∞·ª£t bƒÉng..."</p>
                    <p><b>3. Ph√¢n t√≠ch:</b></p>
                    <ul>
                        <li><b>Ch·ªçn ƒë√°p √°n "She won a competition"</b> v√¨ n√≥ kh·ªõp ho√†n to√†n v·ªõi th√¥ng tin "came first" (v·ªÅ nh·∫•t/chi·∫øn th·∫Øng) ·ªü m·ªôt cu·ªôc thi.</li>
                        <li>Lo·∫°i "She saw an advert..." (C√¥ ·∫•y th·∫•y qu·∫£ng c√°o) v√¨ b√†i ƒë·ªçc kh√¥ng h·ªÅ nh·∫Øc ƒë·∫øn qu·∫£ng c√°o (Not Given).</li>
                        <li>Lo·∫°i "A friend invited her..." (B·∫°n b√® m·ªùi) v√¨ b·∫°n b√® ch·ªâ c√πng c√¥ ·∫•y tham gia thi ƒë·∫•u l√∫c nh·ªè, kh√¥ng ph·∫£i m·ªùi v√†o show di·ªÖn.</li>
                    </ul>
                `
            },
            {
                id: 2,
                question: "2. What does Callie say about the clothes she wears?",
                options: [
                    { text: "It‚Äôs hard to skate in them.", isCorrect: true },
                    { text: "Some are prettier than others.", isCorrect: false },
                    { text: "Making them takes a long time.", isCorrect: false }
                ],
                explanation: `
                    <h4>GI·∫¢I TH√çCH CHI TI·∫æT C√ÇU 2:</h4>
                    <p><b>1. D·ªãch c√¢u h·ªèi:</b> Callie n√≥i g√¨ v·ªÅ nh·ªØng b·ªô trang ph·ª•c c√¥ ·∫•y m·∫∑c?</p>
                    <p><b>2. D·∫´n ch·ª©ng trong b√†i:</b> ƒêo·∫°n 2: <span class="exp-highlight">"The only trouble is that sometimes they‚Äôre heavy and I get very hot."</span></p>
                    <p class="exp-translation">-> D·ªãch: "R·∫Øc r·ªëi duy nh·∫•t l√† ƒë√¥i khi ch√∫ng r·∫•t n·∫∑ng v√† l√†m t√¥i th·∫•y r·∫•t n√≥ng."</p>
                    <p><b>3. Ph√¢n t√≠ch:</b></p>
                    <ul>
                        <li><b>Ch·ªçn ƒë√°p √°n "It‚Äôs hard to skate in them" (Kh√≥ ƒë·ªÉ tr∆∞·ª£t khi m·∫∑c ch√∫ng)</b>. ƒê√¢y l√† c√°ch di·ªÖn ƒë·∫°t ƒë·ªìng nghƒ©a (Paraphrase) c·ªßa vi·ªác qu·∫ßn √°o "n·∫∑ng v√† n√≥ng" g√¢y kh√≥ khƒÉn (trouble) cho vi·ªác tr∆∞·ª£t bƒÉng.</li>
                        <li>Lo·∫°i "Some are prettier..." (V√†i b·ªô ƒë·∫πp h∆°n) v√¨ c√¥ ·∫•y khen t·∫•t c·∫£ ƒë·ªÅu ƒë·∫πp ch·ª© kh√¥ng so s√°nh.</li>
                        <li>Lo·∫°i "Making them takes a long time" (M·∫•t nhi·ªÅu th·ªùi gian ƒë·ªÉ l√†m) -> SAI ho√†n to√†n, v√¨ b√†i ƒë·ªçc khen th·ª£ may l√†m r·∫•t nhanh: "how quickly they work!".</li>
                    </ul>
                `
            },
            {
                id: 3,
                question: "3. What does Callie do just before each show?",
                options: [
                    { text: "She takes a moment to be alone.", isCorrect: true },
                    { text: "She talks to the other skaters.", isCorrect: false },
                    { text: "She checks her skates are okay.", isCorrect: false }
                ],
                explanation: `
                    <h4>GI·∫¢I TH√çCH CHI TI·∫æT C√ÇU 3:</h4>
                    <p><b>1. D·ªãch c√¢u h·ªèi:</b> Callie l√†m g√¨ ngay tr∆∞·ªõc m·ªói bu·ªïi bi·ªÉu di·ªÖn?</p>
                    <p><b>2. D·∫´n ch·ª©ng trong b√†i:</b> ƒêo·∫°n 3: <span class="exp-highlight">"...while I‚Äôm waiting to go on, I like to sit quietly by myself and think..."</span></p>
                    <p class="exp-translation">-> D·ªãch: "...trong khi ch·ªù ƒë·∫øn l∆∞·ª£t ra s√¢n kh·∫•u, t√¥i th√≠ch ng·ªìi tƒ©nh l·∫∑ng m·ªôt m√¨nh v√† suy nghƒ©..."</p>
                    <p><b>3. Ph√¢n t√≠ch:</b></p>
                    <ul>
                        <li><b>Ch·ªçn ƒë√°p √°n "She takes a moment to be alone" (D√†nh m·ªôt ch√∫t th·ªùi gian ·ªü m·ªôt m√¨nh)</b> v√¨ kh·ªõp v·ªõi √Ω "sit quietly by myself" (ng·ªìi l·∫∑ng l·∫Ω m·ªôt m√¨nh).</li>
                        <li>Lo·∫°i "She talks to the other skaters" (N√≥i chuy·ªán v·ªõi ng∆∞·ªùi kh√°c) -> Sai, v√¨ ƒë√≥ l√† vi·ªác ng∆∞·ªùi kh√°c l√†m ("The other skaters chat together").</li>
                        <li>Lo·∫°i "She checks her skates..." (Ki·ªÉm tra gi√†y tr∆∞·ª£t) -> B√†i ch·ªâ n√≥i "put skates on" (mang gi√†y v√†o) ch·ª© kh√¥ng ƒë·ªÅ c·∫≠p vi·ªác ki·ªÉm tra.</li>
                    </ul>
                `
            },
            {
                id: 4,
                question: "4. What does Callie worry about?",
                options: [
                    { text: "forgetting what she has to say", isCorrect: true },
                    { text: "having an accident on the ice", isCorrect: false },
                    { text: "dancing and singing at the same time", isCorrect: false }
                ],
                explanation: `
                    <h4>GI·∫¢I TH√çCH CHI TI·∫æT C√ÇU 4:</h4>
                    <p><b>1. D·ªãch c√¢u h·ªèi:</b> Callie lo l·∫Øng ƒëi·ªÅu g√¨?</p>
                    <p><b>2. D·∫´n ch·ª©ng trong b√†i:</b> ƒêo·∫°n 4: <span class="exp-highlight">"I‚Äôm always a bit scared I won‚Äôt remember the words."</span></p>
                    <p class="exp-translation">-> D·ªãch: "T√¥i lu√¥n h∆°i s·ª£ r·∫±ng m√¨nh s·∫Ω kh√¥ng nh·ªõ l·ªùi tho·∫°i."</p>
                    <p><b>3. Ph√¢n t√≠ch:</b></p>
                    <ul>
                        <li><b>Ch·ªçn ƒë√°p √°n "forgetting what she has to say" (qu√™n nh·ªØng g√¨ ph·∫£i n√≥i)</b> v√¨ n√≥ ƒë·ªìng nghƒ©a v·ªõi "won't remember the words".</li>
                        <li>Lo·∫°i "having an accident..." (b·ªã tai n·∫°n/ng√£) -> Sai, v√¨ b√†i ghi r√µ "I'm not bothered about falling" (T√¥i kh√¥ng b·∫≠n t√¢m vi·ªác b·ªã ng√£).</li>
                        <li>Lo·∫°i "dancing and singing..." -> Sai, c√¥ ·∫•y th·∫•y vi·ªác nh·∫£y l√† ·ªïn (fine) v√† th√≠ch vi·ªác h√°t (enjoy joining in with all the songs).</li>
                    </ul>
                `
            },
            {
                id: 5,
                question: "5. How does Callie usually feel after a show?",
                options: [
                    { text: "pleased about making people happy", isCorrect: true },
                    { text: "ready for a rest", isCorrect: false },
                    { text: "glad that she‚Äôs finished", isCorrect: false }
                ],
                explanation: `
                    <h4>GI·∫¢I TH√çCH CHI TI·∫æT C√ÇU 5:</h4>
                    <p><b>1. D·ªãch c√¢u h·ªèi:</b> Callie th∆∞·ªùng c·∫£m th·∫•y th·∫ø n√†o sau bu·ªïi di·ªÖn?</p>
                    <p><b>2. D·∫´n ch·ª©ng trong b√†i:</b> ƒêo·∫°n 5: <span class="exp-highlight">"I love listening to the people... so excited as they leave... That‚Äôs when I‚Äôm really happy I chose ice dancing..."</span></p>
                    <p class="exp-translation">-> D·ªãch: "T√¥i th√≠ch l·∫Øng nghe nh·ªØng kh√°n gi·∫£... h·ªç r·∫•t ph·∫•n kh√≠ch... ƒê√≥ l√† l√∫c t√¥i th·ª±c s·ª± h·∫°nh ph√∫c..."</p>
                    <p><b>3. Ph√¢n t√≠ch:</b></p>
                    <ul>
                        <li><b>Ch·ªçn ƒë√°p √°n "pleased about making people happy" (vui v√¨ l√†m m·ªçi ng∆∞·ªùi h·∫°nh ph√∫c)</b>. "Pleased" = "Happy". Kh√°n gi·∫£ ph·∫•n kh√≠ch khi·∫øn c√¥ ·∫•y h·∫°nh ph√∫c.</li>
                        <li>Lo·∫°i "ready for a rest" (s·∫µn s√†ng ngh·ªâ ng∆°i) -> Sai, c√¥ n√≥i "never feel that way" khi ƒë∆∞·ª£c h·ªèi c√≥ m·ªát kh√¥ng.</li>
                        <li>Lo·∫°i "glad that she's finished" (vui v√¨ ƒë√£ xong vi·ªác) -> Kh√¥ng c√≥ th√¥ng tin n√†y trong b√†i.</li>
                    </ul>
                `
            }
        ];

        // --- GLOBAL VARIABLES ---
        let score = 0;
        let answeredQuestions = new Set();
        let timerInterval;
        let timeRemaining = 600; // 10 minutes in seconds
        let isTimerRunning = false;
        
        // --- WEB AUDIO API (T·∫°o √¢m thanh kh√¥ng c·∫ßn link ngo√†i) ---
        const audioCtx = new (window.AudioContext || window.webkitAudioContext)();
        
        function playCorrectSound() {
            if(audioCtx.state === 'suspended') audioCtx.resume();
            const osc = audioCtx.createOscillator();
            const gainNode = audioCtx.createGain();
            osc.type = 'sine';
            osc.frequency.setValueAtTime(523.25, audioCtx.currentTime); // C5
            osc.frequency.setValueAtTime(659.25, audioCtx.currentTime + 0.1); // E5
            osc.frequency.setValueAtTime(783.99, audioCtx.currentTime + 0.2); // G5
            osc.connect(gainNode);
            gainNode.connect(audioCtx.destination);
            osc.start();
            gainNode.gain.exponentialRampToValueAtTime(0.00001, audioCtx.currentTime + 0.5);
            osc.stop(audioCtx.currentTime + 0.5);
        }

        function playWrongSound() {
            if(audioCtx.state === 'suspended') audioCtx.resume();
            const osc = audioCtx.createOscillator();
            const gainNode = audioCtx.createGain();
            osc.type = 'sawtooth';
            osc.frequency.setValueAtTime(300, audioCtx.currentTime);
            osc.frequency.exponentialRampToValueAtTime(100, audioCtx.currentTime + 0.3);
            osc.connect(gainNode);
            gainNode.connect(audioCtx.destination);
            osc.start();
            gainNode.gain.exponentialRampToValueAtTime(0.00001, audioCtx.currentTime + 0.4);
            osc.stop(audioCtx.currentTime + 0.4);
        }

        // --- CONFETTI EFFECT ---
        function shootConfetti() {
            const colors = ['#00D26A', '#fdcb6e', '#74b9ff', '#8854C0', '#FF4757'];
            const container = document.getElementById('confetti-container');
            for(let i=0; i<30; i++) {
                let confetti = document.createElement('div');
                confetti.classList.add('confetti-piece');
                confetti.style.left = Math.random() * 100 + 'vw';
                confetti.style.backgroundColor = colors[Math.floor(Math.random() * colors.length)];
                confetti.style.animationDuration = (Math.random() * 2 + 2) + 's';
                container.appendChild(confetti);
                setTimeout(() => confetti.remove(), 4000);
            }
        }

        // --- TIMER LOGIC ---
        const btnTimer = document.getElementById('btn-timer');
        const timerDisplay = document.getElementById('timer-display');

        btnTimer.addEventListener('click', () => {
            if(audioCtx.state === 'suspended') audioCtx.resume(); // K√≠ch ho·∫°t AudioContext
            if (isTimerRunning) {
                clearInterval(timerInterval);
                btnTimer.innerText = "TI·∫æP T·ª§C";
                btnTimer.style.background = "#fdcb6e";
                btnTimer.style.boxShadow = "0 5px 0 #e1b12c";
            } else {
                timerInterval = setInterval(updateTimer, 1000);
                btnTimer.innerText = "T·∫†M D·ª™NG";
                btnTimer.style.background = "#FF4757";
                btnTimer.style.boxShadow = "0 5px 0 #D93845";
            }
            isTimerRunning = !isTimerRunning;
        });

        function updateTimer() {
            if (timeRemaining <= 0) {
                clearInterval(timerInterval);
                timerDisplay.innerText = "00:00";
                alert("ƒê√£ h·∫øt gi·ªù l√†m b√†i! B·∫°n v·∫´n c√≥ th·ªÉ ti·∫øp t·ª•c l√†m, nh∆∞ng nh·ªõ l√† trong ph√≤ng thi th·∫≠t, b·∫°n ch·ªâ n√™n l√†m m·ªôt b√†i nh∆∞ th·∫ø n√†y trong 10 ph√∫t th√¥i nha.");
                return;
            }
            timeRemaining--;
            let m = Math.floor(timeRemaining / 60);
            let s = timeRemaining % 60;
            timerDisplay.innerText = (m < 10 ? "0" : "") + m + ":" + (s < 10 ? "0" : "") + s;
        }

        // --- TRANSLATION TOGGLE ---
        function toggleTranslation(btn) {
            let target = btn.nextElementSibling;
            if (target.style.display === "block") {
                target.style.display = "none";
                btn.innerText = "B·∫¢N D·ªäCH ƒê·∫¶Y ƒê·ª¶";
            } else {
                target.style.display = "block";
                btn.innerText = "·∫®N B·∫¢N D·ªäCH";
            }
        }

        // --- SHUFFLE ARRAY ---
        function shuffleArray(array) {
            for (let i = array.length - 1; i > 0; i--) {
                const j = Math.floor(Math.random() * (i + 1));
                [array[i], array[j]] = [array[j], array[i]];
            }
            return array;
        }

        // --- RENDER QUIZ ---
        const quizContainer = document.getElementById('quiz-container');

        function renderQuiz() {
            quizData.forEach((q, index) => {
                let card = document.createElement('div');
                card.classList.add('question-card');
                
                let qText = document.createElement('div');
                qText.classList.add('question-text');
                qText.innerText = q.question;
                card.appendChild(qText);

                let optionsGrid = document.createElement('div');
                optionsGrid.classList.add('options-grid');
                optionsGrid.id = 'opts-' + q.id;

                // Clone and shuffle options dynamically
                let shuffledOptions = shuffleArray([...q.options]);
                const prefixes = ['A. ', 'B. ', 'C. '];

                shuffledOptions.forEach((opt, idx) => {
                    let btn = document.createElement('button');
                    btn.classList.add('option-btn');
                    btn.innerText = prefixes[idx] + opt.text;
                    btn.onclick = () => handleOptionClick(btn, opt, q, optionsGrid, card);
                    optionsGrid.appendChild(btn);
                });

                card.appendChild(optionsGrid);

                let explanationDiv = document.createElement('div');
                explanationDiv.classList.add('explanation-box');
                explanationDiv.id = 'exp-' + q.id;
                explanationDiv.innerHTML = q.explanation;
                card.appendChild(explanationDiv);

                quizContainer.appendChild(card);
            });
        }

        function handleOptionClick(btn, optionData, questionData, grid, card) {
            if (answeredQuestions.has(questionData.id)) return; // Only allow 1 choice

            answeredQuestions.add(questionData.id);
            const explanationBox = document.getElementById('exp-' + questionData.id);
            
            // X·ª≠ l√Ω Giao di·ªán khi ch·ªçn
            if (optionData.isCorrect) {
                btn.classList.add('correct');
                playCorrectSound();
                shootConfetti();
                score++;
            } else {
                btn.classList.add('wrong');
                playWrongSound();
                
                // Show the correct answer automatically
                Array.from(grid.children).forEach(childBtn => {
                    // Check if the text of this button matches the correct option text (ignoring the A,B,C prefix)
                    const correctOpt = questionData.options.find(o => o.isCorrect).text;
                    if (childBtn.innerText.includes(correctOpt)) {
                        childBtn.classList.add('correct');
                    }
                });
            }
            
            // Hi·ªán ph·∫ßn gi·∫£i th√≠ch
            explanationBox.style.display = 'block';
        }

        // --- SUBMIT LOGIC ---
        function submitTest() {
            if (answeredQuestions.size < quizData.length) {
                alert("H√£y ho√†n th√†nh t·∫•t c·∫£ c√°c c√¢u h·ªèi tr∆∞·ªõc khi n·ªôp b√†i nh√©!");
                return;
            }
            clearInterval(timerInterval);
            
            document.getElementById('final-score').innerText = score + "/5";
            let feedback = document.getElementById('final-feedback');
            let subFeedback = document.getElementById('final-sub');

            if (score === 5) {
                feedback.innerText = "THI√äN T√ÄI!";
                feedback.style.color = "#00D26A";
                subFeedback.innerText = "Xu·∫•t s·∫Øc! C√¥ Mai An t·ª± h√†o v·ªÅ b·∫°n!";
                shootConfetti(); shootConfetti();
            } else if (score >= 3) {
                feedback.innerText = "L√ÄM T·ªêT L·∫ÆM!";
                feedback.style.color = "#0984e3";
                subFeedback.innerText = "B·∫°n ƒë√£ hi·ªÉu b√†i kh√° t·ªët, c·ªë g·∫Øng l√™n nh√©!";
                shootConfetti();
            } else {
                feedback.innerText = "C·ªê L√äN NH√â!";
                feedback.style.color = "#FF4757";
                subFeedback.innerText = "H√£y ƒë·ªçc k·ªπ l·∫°i ph·∫ßn gi·∫£i th√≠ch chi ti·∫øt ph√≠a tr√™n ƒë·ªÉ ti·∫øn b·ªô h∆°n!";
            }

            document.getElementById('result-modal').style.display = 'flex';
            playCorrectSound();
        }

        // Init
        window.onload = renderQuiz;
    </script>
</body>
</html>