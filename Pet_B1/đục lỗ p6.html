<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>B√†i Ki·ªÉm Tra Ti·∫øng Anh - Ms Mai An ULIS</title>
    
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Quicksand:wght@400;500;600;700&display=swap" rel="stylesheet">

    <style>
        :root {
            /* Dynamic Theme: Adventure/Nature (Sky + Ocean) */
            --primary-color: #00A8E8; /* Sky Blue */
            --secondary-color: #007EA7; /* Ocean Blue */
            --accent-color: #FFD43B; /* Sun/Sand Yellow */
            --correct-color: #00D26A; /* Green */
            --wrong-color: #FF4757; /* Red/Orange */
            --text-color: #2F3542;
            --bg-gradient: radial-gradient(circle at 50% 50%, rgba(255,255,255,0.9), rgba(240,248,255,0.95));
            --font-main: 'Quicksand', sans-serif;
        }

        /* --- SVG Background Generation --- */
        body {
            font-family: var(--font-main);
            color: var(--text-color);
            margin: 0;
            padding: 0;
            height: 100vh;
            overflow: hidden;
            /* SVG Background with Planes and Sharks embedded */
            background-color: #f0f8ff;
            background-image: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='100' height='100' viewBox='0 0 100 100'%3E%3Ctext x='10' y='30' font-size='20'%3E‚úàÔ∏è%3C/text%3E%3Ctext x='60' y='70' font-size='20'%3Eü¶à%3C/text%3E%3Ctext x='80' y='20' font-size='15'%3E‚òÅÔ∏è%3C/text%3E%3Ctext x='20' y='80' font-size='15'%3Eüåä%3C/text%3E%3C/svg%3E");
            background-size: 150px 150px;
        }

        /* --- Top Control Bar --- */
        .top-bar {
            height: 60px;
            background: white;
            box-shadow: 0 4px 15px rgba(0,0,0,0.1);
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 0 20px;
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            z-index: 1000;
        }

        .teacher-brand {
            font-weight: 700;
            font-size: 1.2rem;
            color: var(--secondary-color);
            display: flex;
            align-items: center;
            gap: 10px;
        }
        
        .teacher-brand span {
            font-size: 0.9rem;
            background: var(--accent-color);
            padding: 2px 8px;
            border-radius: 12px;
            color: #333;
        }

        .timer-container {
            display: flex;
            align-items: center;
            gap: 15px;
        }

        .timer-display {
            font-size: 1.5rem;
            font-weight: 800;
            font-variant-numeric: tabular-nums;
            color: var(--wrong-color);
        }

        .btn-timer {
            background: var(--primary-color);
            color: white;
            border: none;
            padding: 8px 20px;
            border-radius: 20px;
            font-weight: 700;
            cursor: pointer;
            box-shadow: 0 4px 0 #0077b6;
            transition: all 0.2s;
        }

        .btn-timer:active {
            transform: translateY(4px);
            box-shadow: none;
        }

        /* --- Main Layout (Split Screen) --- */
        .main-container {
            display: flex;
            height: calc(100vh - 60px);
            margin-top: 60px;
        }

        .left-panel, .right-panel {
            flex: 1;
            padding: 30px;
            overflow-y: auto;
            scroll-behavior: smooth;
        }

        .left-panel {
            background: rgba(255, 255, 255, 0.95);
            border-right: 2px solid #e1e1e1;
        }

        .right-panel {
            background: rgba(240, 248, 255, 0.8);
        }

        /* --- Reading Content Styles --- */
        .passage-container {
            margin-bottom: 50px;
            background: white;
            padding: 20px;
            border-radius: 15px;
            box-shadow: 0 5px 15px rgba(0,0,0,0.05);
            border-left: 5px solid var(--primary-color);
        }

        h2 {
            color: var(--secondary-color);
            margin-top: 0;
            border-bottom: 2px dashed #ddd;
            padding-bottom: 10px;
        }

        .passage-text {
            font-size: 1.1rem;
            line-height: 1.8;
            text-align: justify;
        }

        .blank-number {
            font-weight: bold;
            color: var(--wrong-color);
            background: #ffeaa7;
            padding: 0 5px;
            border-radius: 4px;
        }

        .btn-translate {
            background: #f1f2f6;
            border: 2px solid #dfe4ea;
            color: #57606f;
            padding: 8px 15px;
            border-radius: 10px;
            cursor: pointer;
            font-weight: 600;
            margin-top: 10px;
            transition: 0.3s;
            display: inline-flex;
            align-items: center;
            gap: 5px;
        }

        .btn-translate:hover {
            background: var(--primary-color);
            color: white;
            border-color: var(--primary-color);
        }

        .translation-box {
            display: none;
            background: #eefbf3;
            padding: 15px;
            border-radius: 10px;
            margin-top: 10px;
            font-style: italic;
            color: #2d3436;
            border-left: 4px solid var(--correct-color);
        }

        /* --- Glossary Styles --- */
        .glossary-table {
            width: 100%;
            border-collapse: collapse;
            margin-top: 20px;
            background: white;
            border-radius: 10px;
            overflow: hidden;
            box-shadow: 0 2px 10px rgba(0,0,0,0.05);
        }

        .glossary-table th {
            background: var(--secondary-color);
            color: white;
            padding: 10px;
            text-align: left;
        }

        .glossary-table td {
            padding: 10px;
            border-bottom: 1px solid #eee;
        }

        .tag-pos {
            font-size: 0.8rem;
            background: #dfe6e9;
            padding: 2px 6px;
            border-radius: 4px;
            color: #636e72;
        }

        /* --- Question Cards Styles --- */
        .question-card {
            background: white;
            border-radius: 15px;
            padding: 20px;
            margin-bottom: 20px;
            box-shadow: 0 8px 0 #dfe4ea, 0 5px 20px rgba(0,0,0,0.1);
            transition: transform 0.2s;
            position: relative;
        }

        .question-header {
            font-weight: 700;
            margin-bottom: 15px;
            color: var(--secondary-color);
            display: flex;
            justify-content: space-between;
        }

        .options-grid {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 15px;
        }

        .option-btn {
            background: white;
            border: 2px solid #e1e1e1;
            padding: 15px;
            border-radius: 12px;
            cursor: pointer;
            font-family: var(--font-main);
            font-size: 1rem;
            font-weight: 600;
            color: #555;
            transition: all 0.2s;
            box-shadow: 0 4px 0 #e1e1e1;
            position: relative;
            text-align: left;
        }

        .option-btn:hover {
            transform: scale(1.02);
            border-color: var(--primary-color);
        }

        .option-btn:active {
            transform: translateY(4px);
            box-shadow: none;
        }

        /* States */
        .option-btn.correct {
            background: var(--correct-color);
            color: white;
            border-color: var(--correct-color);
            box-shadow: 0 4px 0 #00b894;
        }

        .option-btn.wrong {
            background: var(--wrong-color);
            color: white;
            border-color: var(--wrong-color);
            box-shadow: 0 4px 0 #d63031;
            animation: shake 0.5s;
        }

        /* Explanation Box */
        .explanation-box {
            display: none;
            margin-top: 20px;
            background: #f8f9fa;
            border: 1px solid #e9ecef;
            border-radius: 10px;
            padding: 15px;
        }
        
        .ms-mai-an-avatar {
            width: 40px;
            height: 40px;
            border-radius: 50%;
            background: var(--primary-color);
            display: inline-flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-weight: bold;
            margin-right: 10px;
            float: left;
        }

        .explanation-content {
            font-size: 0.95rem;
            color: #2d3436;
        }
        
        .explanation-content strong {
            color: var(--secondary-color);
        }

        /* --- Animations --- */
        @keyframes shake {
            0% { transform: translateX(0); }
            25% { transform: translateX(-5px); }
            50% { transform: translateX(5px); }
            75% { transform: translateX(-5px); }
            100% { transform: translateX(0); }
        }

        @keyframes pop {
            0% { transform: scale(0.8); opacity: 0; }
            100% { transform: scale(1); opacity: 1; }
        }

        /* --- Submit Button & Footer --- */
        .submit-section {
            text-align: center;
            margin-top: 30px;
            margin-bottom: 50px;
        }

        .btn-submit {
            background: linear-gradient(45deg, #6c5ce7, #a29bfe);
            color: white;
            font-size: 1.5rem;
            padding: 15px 50px;
            border: none;
            border-radius: 50px;
            cursor: pointer;
            box-shadow: 0 10px 20px rgba(108, 92, 231, 0.4);
            transition: transform 0.3s;
            font-weight: 800;
        }

        .btn-submit:hover {
            transform: translateY(-5px);
        }

        /* --- Result Modal --- */
        .modal-overlay {
            position: fixed;
            top: 0; left: 0; right: 0; bottom: 0;
            background: rgba(0,0,0,0.7);
            display: none;
            justify-content: center;
            align-items: center;
            z-index: 2000;
            backdrop-filter: blur(5px);
        }

        .modal-content {
            background: white;
            padding: 40px;
            border-radius: 30px;
            text-align: center;
            max-width: 500px;
            width: 90%;
            animation: pop 0.5s cubic-bezier(0.175, 0.885, 0.32, 1.275);
            border: 5px solid white;
            background-clip: padding-box;
        }

        .score-display {
            font-size: 4rem;
            font-weight: 900;
            color: var(--primary-color);
            margin: 20px 0;
        }

        .feedback-text {
            font-size: 1.2rem;
            margin-bottom: 30px;
            color: #555;
        }

        /* Mobile Responsive */
        @media (max-width: 768px) {
            .main-container {
                flex-direction: column;
                height: auto;
            }
            .left-panel, .right-panel {
                overflow: visible;
                height: auto;
            }
            .options-grid {
                grid-template-columns: 1fr;
            }
        }
        
        /* Confetti Canvas */
        #confetti-canvas {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            pointer-events: none;
            z-index: 1500;
        }
    </style>
</head>
<body>

    <canvas id="confetti-canvas"></canvas>

    <div class="top-bar">
        <div class="teacher-brand">
            Ms Mai An ULIS <span>Teacher</span>
        </div>
        <div class="timer-container">
            <div class="timer-display" id="timer">10:00</div>
            <button class="btn-timer" id="btnStart" onclick="toggleTimer()">B·∫ÆT ƒê·∫¶U</button>
        </div>
    </div>

    <div class="main-container">
        <div class="left-panel">
            
            <div class="passage-container" id="passage1">
                <h2>PASSAGE 1: FEAR OF FLYING ‚úàÔ∏è</h2>
                <div class="passage-text">
                    A fear of flying, also known as aerophobia, is said to affect almost 10% of the <span class="blank-number">(1)</span>, although some experts <span class="blank-number">(2)</span> it is much higher than this. Those suffering from this will often avoid flying completely, which has a negative effect on their quality of life. Those who face their fears can end <span class="blank-number">(3)</span> feeling seriously anxious before and during the flight.
                    <br><br>
                    There are generally two different causes. Some people worry about whether they will <span class="blank-number">(4)</span> silly in front of other passengers. The thought of being sick or losing control can be quite frightening. Some people fear the flight itself. The most <span class="blank-number">(5)</span> things people worry about are bad weather conditions, the possibility that the plane will develop a problem or even that the pilot will become ill. The most worrying time of all is often when <span class="blank-number">(6)</span> off and landing, points in the flight when most people will experience a little fear.
                </div>
                
                <button class="btn-translate" onclick="toggleTrans('trans1')">üìñ B·∫¢N D·ªäCH ƒê·∫¶Y ƒê·ª¶</button>
                <div id="trans1" class="translation-box">
                    <strong>N·ªói s·ª£ bay:</strong><br>
                    N·ªói s·ª£ ƒëi m√°y bay, hay c√≤n g·ªçi l√† ch·ª©ng s·ª£ bay, ƒë∆∞·ª£c cho l√† ·∫£nh h∆∞·ªüng ƒë·∫øn g·∫ßn 10% d√¢n s·ªë, m·∫∑c d√π m·ªôt s·ªë chuy√™n gia tin r·∫±ng con s·ªë n√†y cao h∆°n nhi·ªÅu. Nh·ªØng ng∆∞·ªùi m·∫Øc ch·ª©ng n√†y th∆∞·ªùng tr√°nh ƒëi m√°y bay ho√†n to√†n, ƒëi·ªÅu n√†y ·∫£nh h∆∞·ªüng ti√™u c·ª±c ƒë·∫øn ch·∫•t l∆∞·ª£ng cu·ªôc s·ªëng c·ªßa h·ªç. Nh·ªØng ng∆∞·ªùi ƒë·ªëi m·∫∑t v·ªõi n·ªói s·ª£ c√≥ th·ªÉ k·∫øt th√∫c b·∫±ng c·∫£m gi√°c lo l·∫Øng nghi√™m tr·ªçng tr∆∞·ªõc v√† trong chuy·∫øn bay.<br><br>
                    Th∆∞·ªùng c√≥ hai nguy√™n nh√¢n kh√°c nhau. M·ªôt s·ªë ng∆∞·ªùi lo l·∫Øng li·ªáu h·ªç c√≥ tr√¥ng ng·ªõ ng·∫©n tr∆∞·ªõc m·∫∑t c√°c h√†nh kh√°ch kh√°c hay kh√¥ng. √ù nghƒ© b·ªã ·ªëm ho·∫∑c m·∫•t ki·ªÉm so√°t c√≥ th·ªÉ kh√° ƒë√°ng s·ª£. M·ªôt s·ªë ng∆∞·ªùi s·ª£ ch√≠nh chuy·∫øn bay. Nh·ªØng ƒëi·ªÅu ph·ªï bi·∫øn nh·∫•t m√† m·ªçi ng∆∞·ªùi lo l·∫Øng l√† ƒëi·ªÅu ki·ªán th·ªùi ti·∫øt x·∫•u, kh·∫£ nƒÉng m√°y bay g·∫∑p s·ª± c·ªë ho·∫∑c th·∫≠m ch√≠ phi c√¥ng b·ªã ·ªëm. Th·ªùi ƒëi·ªÉm lo l·∫Øng nh·∫•t th∆∞·ªùng l√† khi c·∫•t c√°nh v√† h·∫° c√°nh, nh·ªØng th·ªùi ƒëi·ªÉm trong chuy·∫øn bay m√† h·∫ßu h·∫øt m·ªçi ng∆∞·ªùi ƒë·ªÅu c·∫£m th·∫•y m·ªôt ch√∫t s·ª£ h√£i.
                </div>

                <h3>üìö GLOSSARY (T·ª´ v·ª±ng h·ªçc thu·∫≠t)</h3>
                <table class="glossary-table">
                    <tr><th>T·ª´ v·ª±ng</th><th>Lo·∫°i t·ª´</th><th>Nghƒ©a ti·∫øng Vi·ªát</th></tr>
                    <tr><td>Aerophobia</td><td><span class="tag-pos">noun</span></td><td>Ch·ª©ng s·ª£ bay</td></tr>
                    <tr><td>Expert</td><td><span class="tag-pos">noun</span></td><td>Chuy√™n gia</td></tr>
                    <tr><td>Anxious</td><td><span class="tag-pos">adj</span></td><td>Lo √¢u, b·ªìn ch·ªìn</td></tr>
                    <tr><td>Passenger</td><td><span class="tag-pos">noun</span></td><td>H√†nh kh√°ch</td></tr>
                    <tr><td>Frightening</td><td><span class="tag-pos">adj</span></td><td>ƒê√°ng s·ª£ h√£i</td></tr>
                </table>
            </div>

            <div class="passage-container" id="passage2" style="border-left-color: #FF4757;">
                <h2>PASSAGE 2: THE GREAT WHITE SHARK ü¶à</h2>
                <div class="passage-text">
                    The great white shark is thought of as a killer, but this is not really <span class="blank-number">(7)</span>. True, one look is enough to confirm how frightening these creatures are. They can be anywhere between four and five metres long and have around 300 teeth <span class="blank-number">(8)</span> in rows. They can travel through the water at up to 24 kilometres an hour, speeding up when they attack. 
                    <br><br>
                    However, of the 100 or so shark attacks on humans that are <span class="blank-number">(9)</span> each year, only around a half of these are made by the great white and most of these attacks do not lead to the person losing their life. Research has shown that the shark will often carry <span class="blank-number">(10)</span> a test bite, and in many cases it has been shown they will release a human. Unfortunately, <span class="blank-number">(11)</span> to the size of the creature‚Äôs mouth this can still lead to the person being <span class="blank-number">(12)</span> injured.
                </div>

                <button class="btn-translate" onclick="toggleTrans('trans2')">üìñ B·∫¢N D·ªäCH ƒê·∫¶Y ƒê·ª¶</button>
                <div id="trans2" class="translation-box">
                    <strong>C√° m·∫≠p tr·∫Øng l·ªõn:</strong><br>
                    C√° m·∫≠p tr·∫Øng l·ªõn ƒë∆∞·ª£c coi l√† k·∫ª s√°t nh√¢n, nh∆∞ng ƒëi·ªÅu n√†y kh√¥ng th·ª±c s·ª± c√¥ng b·∫±ng. ƒê√∫ng v·∫≠y, ch·ªâ c·∫ßn nh√¨n m·ªôt l·∫ßn c≈©ng ƒë·ªß ƒë·ªÉ x√°c nh·∫≠n nh·ªØng sinh v·∫≠t n√†y ƒë√°ng s·ª£ ƒë·∫øn m·ª©c n√†o. Ch√∫ng c√≥ th·ªÉ d√†i t·ª´ b·ªën ƒë·∫øn nƒÉm m√©t v√† c√≥ kho·∫£ng 300 chi·∫øc rƒÉng ƒë∆∞·ª£c s·∫Øp x·∫øp th√†nh h√†ng. Ch√∫ng c√≥ th·ªÉ di chuy·ªÉn trong n∆∞·ªõc v·ªõi t·ªëc ƒë·ªô l√™n t·ªõi 24 km m·ªôt gi·ªù, tƒÉng t·ªëc khi t·∫•n c√¥ng.<br><br>
                    Tuy nhi√™n, trong s·ªë kho·∫£ng 100 v·ª• c√° m·∫≠p t·∫•n c√¥ng con ng∆∞·ªùi ƒë∆∞·ª£c b√°o c√°o m·ªói nƒÉm, ch·ªâ c√≥ kho·∫£ng m·ªôt n·ª≠a l√† do c√° m·∫≠p tr·∫Øng l·ªõn g√¢y ra v√† h·∫ßu h·∫øt c√°c cu·ªôc t·∫•n c√¥ng n√†y kh√¥ng d·∫´n ƒë·∫øn t·ª≠ vong. Nghi√™n c·ª©u ƒë√£ ch·ªâ ra r·∫±ng c√° m·∫≠p th∆∞·ªùng s·∫Ω th·ª±c hi·ªán m·ªôt c√∫ c·∫Øn th·ª≠, v√† trong nhi·ªÅu tr∆∞·ªùng h·ª£p, ng∆∞·ªùi ta th·∫•y ch√∫ng s·∫Ω th·∫£ con ng∆∞·ªùi ra. Th·∫≠t kh√¥ng may, do k√≠ch th∆∞·ªõc mi·ªáng c·ªßa sinh v·∫≠t n√†y, ƒëi·ªÅu n√†y v·∫´n c√≥ th·ªÉ d·∫´n ƒë·∫øn vi·ªác n·∫°n nh√¢n b·ªã th∆∞∆°ng n·∫∑ng.
                </div>

                <h3>üìö GLOSSARY (T·ª´ v·ª±ng h·ªçc thu·∫≠t)</h3>
                <table class="glossary-table">
                    <tr><th>T·ª´ v·ª±ng</th><th>Lo·∫°i t·ª´</th><th>Nghƒ©a ti·∫øng Vi·ªát</th></tr>
                    <tr><td>Confirm</td><td><span class="tag-pos">verb</span></td><td>X√°c nh·∫≠n</td></tr>
                    <tr><td>Creature</td><td><span class="tag-pos">noun</span></td><td>Sinh v·∫≠t</td></tr>
                    <tr><td>Release</td><td><span class="tag-pos">verb</span></td><td>Th·∫£ ra, ph√≥ng th√≠ch</td></tr>
                    <tr><td>Injured</td><td><span class="tag-pos">adj</span></td><td>B·ªã th∆∞∆°ng</td></tr>
                    <tr><td>Due to</td><td><span class="tag-pos">prep</span></td><td>B·ªüi v√¨, do</td></tr>
                </table>
            </div>

        </div>

        <div class="right-panel">
            <h3 style="text-align: center; color: #555;">üìù B√ÄI T·∫¨P TH·ª∞C H√ÄNH</h3>
            
            <div id="quiz-container-1"></div>

            <hr style="border: 0; border-top: 2px dashed #ccc; margin: 30px 0;">

            <div id="quiz-container-2"></div>

            <div class="submit-section">
                <button class="btn-submit" onclick="submitTest()">N·ªòP B√ÄI üèÜ</button>
            </div>
        </div>
    </div>

    <div class="modal-overlay" id="resultModal">
        <div class="modal-content">
            <h2>K·∫æT QU·∫¢ C·ª¶A B·∫†N</h2>
            <div class="score-display" id="finalScore">0/12</div>
            <p class="feedback-text" id="feedbackMsg">...</p>
            <button class="btn-timer" onclick="closeModal()">Xem l·∫°i b√†i</button>
        </div>
    </div>

    <audio id="sound-correct" src="https://assets.mixkit.co/active_storage/sfx/2000/2000-preview.mp3"></audio>
    <audio id="sound-wrong" src="https://assets.mixkit.co/active_storage/sfx/2572/2572-preview.mp3"></audio>
    <audio id="sound-finish" src="https://assets.mixkit.co/active_storage/sfx/1435/1435-preview.mp3"></audio>

    <script>
        // --- DATA ---
        const questions1 = [
            {
                id: 1, q: "Question 1 (Blank 1): affect almost 10% of the _____",
                options: ["A. population", "B. people", "C. crowd", "D. society"],
                correct: 0, // Index of correct answer
                explain: "<b>D·ªãch:</b> '...·∫£nh h∆∞·ªüng ƒë·∫øn g·∫ßn 10% d√¢n s·ªë...'<br><b>T·∫°i sao ch·ªçn A?</b><ul><li><b>Population</b>: D√¢n s·ªë (t·ªïng s·ªë ng∆∞·ªùi s·ªëng trong m·ªôt khu v·ª±c/qu·ªëc gia). ƒê√¢y l√† t·ª´ d√πng trong th·ªëng k√™.</li><li>People: M·ªçi ng∆∞·ªùi (chung chung).</li><li>Crowd: ƒê√°m ƒë√¥ng (t·ª• t·∫≠p t·∫°i 1 ch·ªó).</li><li>Society: X√£ h·ªôi (c·ªông ƒë·ªìng t·ªï ch·ª©c).</li></ul>"
            },
            {
                id: 2, q: "Question 2 (Blank 2): some experts _____ it is much higher",
                options: ["A. choose", "B. make", "C. believe", "D. decide"],
                correct: 2,
                explain: "<b>D·ªãch:</b> '...m·∫∑c d√π m·ªôt s·ªë chuy√™n gia tin r·∫±ng con s·ªë n√†y cao h∆°n nhi·ªÅu.'<br><b>T·∫°i sao ch·ªçn C?</b><ul><li>Experts (chuy√™n gia) th∆∞·ªùng ƒë∆∞a ra √Ω ki·∫øn ho·∫∑c ni·ªÅm tin d·ª±a tr√™n nghi√™n c·ª©u -> <b>believe</b>.</li><li>Choose/Decide: L·ª±a ch·ªçn/Quy·∫øt ƒë·ªãnh (kh√¥ng h·ª£p ng·ªØ c·∫£nh ƒë∆∞a ra nh·∫≠n ƒë·ªãnh).</li></ul>"
            },
            {
                id: 3, q: "Question 3 (Blank 3): end _____ feeling seriously anxious",
                options: ["A. at", "B. in", "C. of", "D. up"],
                correct: 3,
                explain: "<b>C·ª•m ƒë·ªông t·ª´ (Phrasal Verb):</b><br><b>End up + V-ing</b>: K·∫øt c·ª•c l√†, r·ªët cu·ªôc l√†.<br>C√°c gi·ªõi t·ª´ kh√°c kh√¥ng ƒëi v·ªõi 'end' ƒë·ªÉ t·∫°o nghƒ©a ph√π h·ª£p trong ng·ªØ c·∫£nh n√†y."
            },
            {
                id: 4, q: "Question 4 (Blank 4): whether they will _____ silly",
                options: ["A. see", "B. work", "C. show", "D. look"],
                correct: 3,
                explain: "<b>C·∫•u tr√∫c:</b> Look + Adjective (T√≠nh t·ª´) -> Tr√¥ng c√≥ v·∫ª nh∆∞ th·∫ø n√†o.<br><b>Look silly</b>: Tr√¥ng ng·ªõ ng·∫©n/ng·ªëc ngh·∫øch.<br>See (nh√¨n), Work (l√†m vi·ªác), Show (th·ªÉ hi·ªán) kh√¥ng ƒëi tr·ª±c ti·∫øp v·ªõi t√≠nh t·ª´ theo c√°ch n√†y."
            },
            {
                id: 5, q: "Question 5 (Blank 5): The most _____ things people worry about",
                options: ["A. high", "B. common", "C. normal", "D. real"],
                correct: 1,
                explain: "<b>D·ªãch:</b> 'Nh·ªØng ƒëi·ªÅu ph·ªï bi·∫øn nh·∫•t m√† m·ªçi ng∆∞·ªùi lo l·∫Øng...'<br><b>T·∫°i sao ch·ªçn B?</b><ul><li><b>Common</b>: Ph·ªï bi·∫øn, th∆∞·ªùng g·∫∑p.</li><li>Normal: B√¨nh th∆∞·ªùng (kh√¥ng l·∫°).</li><li>Real: C√≥ th·∫≠t.</li><li>High: Cao.</li></ul>Trong ng·ªØ c·∫£nh li·ªát k√™ c√°c n·ªói s·ª£ ƒë·∫°i ch√∫ng, 'common' l√† ch√≠nh x√°c nh·∫•t."
            },
            {
                id: 6, q: "Question 6 (Blank 6): when _____ off and landing",
                options: ["A. taking", "B. going", "C. moving", "D. lifting"],
                correct: 0,
                explain: "<b>C·ª•m t·ª´:</b> Take off (m√°y bay c·∫•t c√°nh).<br>Khi r√∫t g·ªçn m·ªánh ƒë·ªÅ ho·∫∑c n√≥i v·ªÅ th·ªùi ƒëi·ªÉm: 'when taking off' (khi ƒëang c·∫•t c√°nh)."
            }
        ];

        const questions2 = [
            {
                id: 7, q: "Question 7 (Blank 1): but this is not really _____",
                options: ["A. gained", "B. won", "C. fair", "D. corrected"],
                correct: 2,
                explain: "<b>D·ªãch:</b> 'C√° m·∫≠p tr·∫Øng b·ªã coi l√† k·∫ª s√°t nh√¢n, nh∆∞ng ƒëi·ªÅu n√†y kh√¥ng th·ª±c s·ª± c√¥ng b·∫±ng.'<br><b>T·∫°i sao ch·ªçn C?</b><ul><li><b>Fair</b>: C√¥ng b·∫±ng (ƒë√∫ng v·ªõi th·ª±c t·∫ø/b·∫£n ch·∫•t).</li><li>Corrected: ƒê∆∞·ª£c s·ª≠a ch·ªØa.</li><li>Won/Gained: Gi√†nh ƒë∆∞·ª£c.</li></ul>√ù t√°c gi·∫£ mu·ªën minh oan cho c√° m·∫≠p."
            },
            {
                id: 8, q: "Question 8 (Blank 2): teeth _____ in rows",
                options: ["A. put", "B. done", "C. made", "D. arranged"],
                correct: 3,
                explain: "<b>D·ªãch:</b> '...rƒÉng ƒë∆∞·ª£c s·∫Øp x·∫øp th√†nh h√†ng.'<br><b>Arrange</b>: S·∫Øp x·∫øp theo tr·∫≠t t·ª±/h√†ng l·ªëi.<br>Put (ƒë·∫∑t), Made (l√†m), Done (l√†m xong) kh√¥ng di·ªÖn t·∫£ s·ª± s·∫Øp x·∫øp c·∫•u tr√∫c gi·∫£i ph·∫´u."
            },
            {
                id: 9, q: "Question 9 (Blank 3): attacks ... that are _____ each year",
                options: ["A. reported", "B. said", "C. told", "D. placed"],
                correct: 0,
                explain: "<b>D·ªãch:</b> '...c√°c v·ª• t·∫•n c√¥ng ƒë∆∞·ª£c b√°o c√°o m·ªói nƒÉm.'<br><b>Reported</b>: ƒê∆∞·ª£c ghi nh·∫≠n/b√°o c√°o (s·ªë li·ªáu).<br>Said/Told: ƒê∆∞·ª£c n√≥i/k·ªÉ (th∆∞·ªùng c·∫ßn t√¢n ng·ªØ gi√°n ti·∫øp ho·∫∑c ng·ªØ c·∫£nh h·ªôi tho·∫°i)."
            },
            {
                id: 10, q: "Question 10 (Blank 4): carry _____ a test bite",
                options: ["A. in", "B. up", "C. out", "D. on"],
                correct: 2,
                explain: "<b>C·ª•m ƒë·ªông t·ª´:</b><br><b>Carry out</b>: Th·ª±c hi·ªán, ti·∫øn h√†nh (m·ªôt h√†nh ƒë·ªông, th√≠ nghi·ªám, ki·ªÉm tra).<br>Carry on: Ti·∫øp t·ª•c."
            },
            {
                id: 11, q: "Question 11 (Blank 5): _____ to the size of the creature‚Äôs mouth",
                options: ["A. due", "B. since", "C. as", "D. for"],
                correct: 0,
                explain: "<b>Ng·ªØ ph√°p:</b><br><b>Due to + Noun Phrase</b>: B·ªüi v√¨, do (ch·ªâ nguy√™n nh√¢n).<br>Since/As + Clause (M·ªánh ƒë·ªÅ).<br>For (ƒë·ªÉ/cho)."
            },
            {
                id: 12, q: "Question 12 (Blank 6): lead to the person being _____ injured",
                options: ["A. mainly", "B. importantly", "C. seriously", "D. strictly"],
                correct: 2,
                explain: "<b>Collocation (K·∫øt h·ª£p t·ª´):</b><br><b>Seriously injured</b>: B·ªã th∆∞∆°ng n·∫∑ng/nghi√™m tr·ªçng.<br>C√°c tr·∫°ng t·ª´ kh√°c kh√¥ng ƒëi k√®m v·ªõi 'injured' theo nghƒ©a m·ª©c ƒë·ªô th∆∞∆°ng t√≠ch."
            }
        ];

        let score = 0;
        let answeredCount = 0;
        let timerInterval;
        let timeLeft = 600; // 10 minutes in seconds
        let isRunning = false;

        // --- RENDER FUNCTIONS ---
        function renderQuestions(data, containerId) {
            const container = document.getElementById(containerId);
            data.forEach((item, index) => {
                const card = document.createElement('div');
                card.className = 'question-card';
                card.innerHTML = `
                    <div class="question-header">
                        <span>${item.q}</span>
                    </div>
                    <div class="options-grid" id="opts-${item.id}">
                        ${item.options.map((opt, i) => `
                            <button class="option-btn" onclick="checkAnswer(${item.id}, ${i}, ${item.correct}, this)">
                                ${opt}
                            </button>
                        `).join('')}
                    </div>
                    <div class="explanation-box" id="explain-${item.id}">
                        <div class="ms-mai-an-avatar">Ms</div>
                        <div class="explanation-content">
                            <strong>Ms Mai An gi·∫£i th√≠ch:</strong><br>
                            ${item.explain}
                        </div>
                    </div>
                `;
                container.appendChild(card);
            });
        }

        // --- INTERACTION LOGIC ---
        function checkAnswer(qId, selectedIndex, correctIndex, btnElement) {
            // Prevent re-answering
            const parentGrid = document.getElementById(`opts-${qId}`);
            if(parentGrid.getAttribute('data-answered') === 'true') return;
            parentGrid.setAttribute('data-answered', 'true');

            const allBtns = parentGrid.querySelectorAll('.option-btn');
            const explanation = document.getElementById(`explain-${qId}`);

            if (selectedIndex === correctIndex) {
                // CORRECT
                btnElement.classList.add('correct');
                document.getElementById('sound-correct').play();
                score++;
                fireConfetti(btnElement);
            } else {
                // WRONG
                btnElement.classList.add('wrong');
                allBtns[correctIndex].classList.add('correct'); // Show correct answer
                document.getElementById('sound-wrong').play();
            }

            // Disable all buttons
            allBtns.forEach(btn => btn.style.cursor = 'default');
            
            // Show explanation with animation
            explanation.style.display = 'block';
            explanation.style.animation = 'pop 0.3s ease-out';
            
            answeredCount++;
        }

        // --- UTILITIES ---
        function toggleTrans(id) {
            const box = document.getElementById(id);
            if (box.style.display === "block") {
                box.style.display = "none";
            } else {
                box.style.display = "block";
                box.style.animation = "pop 0.3s";
            }
        }

        function toggleTimer() {
            const btn = document.getElementById('btnStart');
            if (isRunning) {
                clearInterval(timerInterval);
                btn.textContent = "TI·∫æP T·ª§C";
                btn.style.background = "#ff9f43";
                isRunning = false;
            } else {
                timerInterval = setInterval(updateTimer, 1000);
                btn.textContent = "T·∫†M D·ª™NG";
                btn.style.background = "#FF4757";
                isRunning = true;
            }
        }

        function updateTimer() {
            if (timeLeft <= 0) {
                clearInterval(timerInterval);
                document.getElementById('timer').textContent = "00:00";
                alert("‚è∞ ƒê√£ h·∫øt gi·ªù l√†m b√†i! B·∫°n v·∫´n c√≥ th·ªÉ ti·∫øp t·ª•c l√†m, nh∆∞ng nh·ªõ l√† trong ph√≤ng thi th·∫≠t, b·∫°n ch·ªâ n√™n l√†m m·ªôt b√†i nh∆∞ th·∫ø n√†y trong 10 ph√∫t th√¥i nha.");
                return;
            }
            timeLeft--;
            const m = Math.floor(timeLeft / 60).toString().padStart(2, '0');
            const s = (timeLeft % 60).toString().padStart(2, '0');
            document.getElementById('timer').textContent = `${m}:${s}`;
        }

        function submitTest() {
            clearInterval(timerInterval);
            document.getElementById('sound-finish').play();
            
            const modal = document.getElementById('resultModal');
            const scoreTxt = document.getElementById('finalScore');
            const feedback = document.getElementById('feedbackMsg');
            
            scoreTxt.textContent = `${score}/12`;
            
            if(score === 12) {
                feedback.textContent = "Xu·∫•t s·∫Øc! B·∫°n l√† thi√™n t√†i Reading! üåüüíØ";
                launchMegaConfetti();
            } else if (score >= 9) {
                feedback.textContent = "L√†m t·ªët l·∫Øm! B·∫°n n·∫Øm r·∫•t ch·∫Øc ki·∫øn th·ª©c! üëè";
            } else if (score >= 6) {
                feedback.textContent = "Kh√° ·ªïn, nh∆∞ng c·∫ßn c·∫©n th·∫≠n h∆°n ·ªü ph·∫ßn t·ª´ v·ª±ng nh√©! üí™";
            } else {
                feedback.textContent = "ƒê·ª´ng bu·ªìn, h√£y ƒë·ªçc k·ªπ ph·∫ßn gi·∫£i th√≠ch c·ªßa c√¥ Mai An nh√©! C·ªë l√™n! ‚ù§Ô∏è";
            }
            
            modal.style.display = 'flex';
        }

        function closeModal() {
            document.getElementById('resultModal').style.display = 'none';
        }

        // --- CONFETTI EFFECT (Simple Implementation) ---
        function fireConfetti(element) {
            // Simplified particle burst effect logic would go here
            // For single file simplicity, we rely on the CSS animation pop
        }
        
        function launchMegaConfetti() {
             // Placeholder for full screen celebration
        }

        // --- INITIALIZATION ---
        window.onload = function() {
            renderQuestions(questions1, 'quiz-container-1');
            renderQuestions(questions2, 'quiz-container-2');
        }

    </script>
</body>
</html>