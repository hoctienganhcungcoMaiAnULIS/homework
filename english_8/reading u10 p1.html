<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>B√†i T·∫≠p Ti·∫øng Anh - Ms. Mai An ULIS</title>
    <link href="https://fonts.googleapis.com/css2?family=Nunito:wght@400;600;700;800&display=swap" rel="stylesheet">
    <style>
        :root {
            --primary: #8854C0; /* T√≠m h·ªìng */
            --primary-dark: #6c429c;
            --secondary: #00C9A7; /* Xanh ng·ªçc */
            --secondary-dark: #00a085;
            --correct: #00D26A; /* Xanh l√° */
            --wrong: #FF4757; /* ƒê·ªè cam */
            --bg-pattern: radial-gradient(#e8e8e8 1px, transparent 1px);
            --card-bg: #ffffff;
            --text-main: #2d3436;
        }

        * {
            box-sizing: border-box;
            user-select: none; /* NgƒÉn copy ƒë·ªÉ t·∫≠p trung l√†m b√†i */
        }

        body {
            font-family: 'Nunito', sans-serif;
            background-color: #f0f3f9;
            background-image: var(--bg-pattern);
            background-size: 20px 20px;
            color: var(--text-main);
            margin: 0;
            padding-bottom: 100px; /* Ch·ª´a ch·ªó cho n√∫t Submit */
        }

        /* Header */
        header {
            background: linear-gradient(135deg, var(--primary), var(--secondary));
            color: white;
            padding: 15px 20px;
            text-align: center;
            box-shadow: 0 4px 15px rgba(0,0,0,0.1);
            position: sticky;
            top: 0;
            z-index: 100;
            border-bottom-left-radius: 20px;
            border-bottom-right-radius: 20px;
        }

        header h1 {
            margin: 0;
            font-size: 1.5rem;
            font-weight: 800;
            text-shadow: 2px 2px 0px rgba(0,0,0,0.2);
        }

        header p {
            margin: 5px 0 0;
            font-size: 0.9rem;
            opacity: 0.9;
        }

        /* Container */
        .container {
            max-width: 800px;
            margin: 20px auto;
            padding: 0 15px;
        }

        /* Card Style */
        .card {
            background: var(--card-bg);
            border-radius: 20px;
            padding: 25px;
            margin-bottom: 30px;
            box-shadow: 0 8px 0 rgba(0,0,0,0.05), 0 10px 20px rgba(0,0,0,0.1);
            border: 2px solid #f0f0f0;
            transition: transform 0.3s ease;
        }

        .card:hover {
            transform: translateY(-2px);
        }

        .card-title {
            font-size: 1.2rem;
            font-weight: 800;
            color: var(--primary);
            margin-bottom: 15px;
            border-bottom: 2px dashed #eee;
            padding-bottom: 10px;
            text-transform: uppercase;
        }

        /* Reading Passage Box */
        .reading-box {
            background-color: #f9fdfc;
            border: 2px solid var(--secondary);
            border-radius: 15px;
            padding: 20px;
            margin-bottom: 20px;
            line-height: 1.8;
            font-size: 1.05rem;
            color: #444;
            position: relative;
        }

        .reading-box::before {
            content: "READING PASSAGE";
            position: absolute;
            top: -12px;
            left: 20px;
            background: var(--secondary);
            color: white;
            padding: 2px 10px;
            border-radius: 10px;
            font-size: 0.8rem;
            font-weight: bold;
        }

        /* Glossary Table */
        .glossary-container {
            margin-top: 15px;
            margin-bottom: 25px;
            border-radius: 12px;
            overflow: hidden;
            border: 1px solid #e0e0e0;
        }

        .glossary-table {
            width: 100%;
            border-collapse: collapse;
            font-size: 0.9rem;
        }

        .glossary-table th {
            background-color: #ece4f7;
            color: var(--primary);
            padding: 10px;
            text-align: left;
        }

        .glossary-table td {
            background-color: #fff;
            padding: 8px 10px;
            border-bottom: 1px solid #eee;
        }

        .glossary-table tr:last-child td {
            border-bottom: none;
        }

        /* Question Section */
        .question-block {
            margin-bottom: 25px;
            padding-bottom: 15px;
            border-bottom: 1px solid #eee;
        }
        
        .question-block:last-child {
            border-bottom: none;
        }

        .q-text {
            font-weight: 700;
            margin-bottom: 15px;
            font-size: 1.1rem;
        }

        .options-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 12px;
        }

        /* 3D Buttons */
        .btn-option {
            background-color: white;
            border: 2px solid #e0e0e0;
            border-radius: 15px;
            padding: 12px 15px;
            font-family: 'Nunito', sans-serif;
            font-size: 1rem;
            font-weight: 600;
            color: #555;
            cursor: pointer;
            position: relative;
            box-shadow: 0 4px 0 #dcdcdc; /* 3D effect */
            transition: all 0.1s ease;
            text-align: left;
        }

        .btn-option:active {
            box-shadow: 0 0 0 #dcdcdc;
            transform: translateY(4px);
        }

        .btn-option:hover:not(.disabled) {
            transform: scale(1.02);
            border-color: var(--secondary);
        }

        /* States */
        .btn-option.correct {
            background-color: var(--correct);
            color: white;
            border-color: #00b85c;
            box-shadow: 0 4px 0 #009e4f;
        }

        .btn-option.wrong {
            background-color: var(--wrong);
            color: white;
            border-color: #e03e4d;
            box-shadow: 0 4px 0 #c23542;
            animation: shake 0.4s cubic-bezier(.36,.07,.19,.97) both;
        }

        .btn-option.disabled {
            pointer-events: none;
            opacity: 0.7;
        }

        /* Explanation Box */
        .explanation {
            display: none;
            margin-top: 15px;
            background-color: #fff8e1; /* Light yellow */
            border-left: 5px solid #ffc107;
            padding: 15px;
            border-radius: 8px;
            font-size: 0.95rem;
            animation: slideDown 0.3s ease-out;
        }

        .expl-header {
            font-weight: 800;
            color: #d35400;
            margin-bottom: 5px;
            display: flex;
            align-items: center;
            gap: 5px;
        }

        .expl-content p {
            margin: 5px 0;
            line-height: 1.5;
        }

        .expl-label {
            font-weight: bold;
            color: var(--primary);
        }

        /* Sticky Submit Button */
        .sticky-footer {
            position: fixed;
            bottom: 20px;
            left: 50%;
            transform: translateX(-50%);
            width: 90%;
            max-width: 400px;
            text-align: center;
            z-index: 999;
        }

        .btn-submit {
            background-color: var(--primary);
            color: white;
            font-size: 1.2rem;
            font-weight: 800;
            padding: 15px 40px;
            border: none;
            border-radius: 50px;
            box-shadow: 0 6px 0 var(--primary-dark), 0 10px 20px rgba(0,0,0,0.2);
            cursor: pointer;
            transition: all 0.2s;
            width: 100%;
        }

        .btn-submit:active {
            transform: translateY(6px);
            box-shadow: 0 0 0 var(--primary-dark);
        }

        /* Animations */
        @keyframes shake {
            10%, 90% { transform: translate3d(-1px, 0, 0); }
            20%, 80% { transform: translate3d(2px, 0, 0); }
            30%, 50%, 70% { transform: translate3d(-4px, 0, 0); }
            40%, 60% { transform: translate3d(4px, 0, 0); }
        }

        @keyframes slideDown {
            from { opacity: 0; transform: translateY(-10px); }
            to { opacity: 1; transform: translateY(0); }
        }

        /* Modal */
        .modal-overlay {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0,0,0,0.5);
            display: none;
            justify-content: center;
            align-items: center;
            z-index: 2000;
            backdrop-filter: blur(5px);
        }

        .modal-content {
            background: white;
            padding: 30px;
            border-radius: 25px;
            text-align: center;
            max-width: 400px;
            width: 90%;
            box-shadow: 0 20px 40px rgba(0,0,0,0.2);
            border: 4px solid var(--primary);
            animation: pop 0.4s cubic-bezier(0.175, 0.885, 0.32, 1.275);
        }

        .score-display {
            font-size: 3rem;
            font-weight: 900;
            color: var(--secondary);
            margin: 10px 0;
        }

        .modal-btn {
            background: var(--secondary);
            color: white;
            border: none;
            padding: 10px 25px;
            border-radius: 20px;
            font-weight: bold;
            font-size: 1.1rem;
            cursor: pointer;
            margin-top: 15px;
            box-shadow: 0 4px 0 var(--secondary-dark);
        }

        @keyframes pop {
            0% { transform: scale(0.5); opacity: 0; }
            100% { transform: scale(1); opacity: 1; }
        }

        /* Underline phonetic check */
        u {
            text-decoration: underline;
            text-decoration-color: var(--primary);
            text-decoration-thickness: 2px;
            text-underline-offset: 3px;
        }

        /* Status marker */
        .status-marker {
            display: inline-block;
            width: 25px;
            height: 25px;
            border-radius: 50%;
            text-align: center;
            line-height: 25px;
            color: white;
            font-weight: bold;
            margin-right: 10px;
            font-size: 0.8rem;
        }
        .status-correct { background-color: var(--correct); }
        .status-wrong { background-color: var(--wrong); }
        .status-pending { background-color: #ccc; }

    </style>
</head>
<body>

    <header>
        <h1>ENGLISH TEST</h1>
        <p>Gi√°o vi√™n: Ms. Mai An ULIS</p>
    </header>

    <div class="container">

        <div class="card" id="ex1">
            <div class="card-title">Exercise 1: Gap Fill - Telepathy</div>
            
            <div class="reading-box">
                <b>Telepathy: Mind To Mind Communication</b><br><br>
                The (1) _________ "telepathy" has been derived from the words "tele" meaning "distance‚Äù and "pathy" meaning "feeling". So telepathy actually means getting feelings through a distance. Telepathy is the communication (2) _________ two minds, separated over a distance, without the (3) _________ of the five known senses.<br><br>
                At some point of time or the other, we all have (4) _________ telepathy. Maybe you were thinking of someone you haven't talked to for months and you suddenly get a call from them. Or when two people are together; they might say the same thing at the same time. These are spontaneous mind-to-mind (5) _________ between that tend to occur frequently closely related individuals.
            </div>

            <div class="glossary-container">
                <table class="glossary-table">
                    <thead><tr><th>Word</th><th>Type</th><th>Meaning (Vietnamese)</th></tr></thead>
                    <tbody>
                        <tr><td>Derived</td><td>(v)</td><td>B·∫Øt ngu·ªìn t·ª´, xu·∫•t ph√°t t·ª´</td></tr>
                        <tr><td>Separated</td><td>(v)</td><td>B·ªã ngƒÉn c√°ch, t√°ch bi·ªát</td></tr>
                        <tr><td>Spontaneous</td><td>(adj)</td><td>T·ª± ph√°t, t·ª± nhi√™n</td></tr>
                        <tr><td>Frequently</td><td>(adv)</td><td>Th∆∞·ªùng xuy√™n</td></tr>
                    </tbody>
                </table>
            </div>

            <div class="questions-container" data-ex="1">
                </div>
        </div>

        <div class="card" id="ex2">
            <div class="card-title">Exercise 2: Gap Fill - Communication Types</div>
            
            <div class="reading-box">
                There are a wide range of ways in which we communicate. Here are some major ways of communication. Spoken or (1) _____ communication, which includes face-to-face or telephone conversations, news and stories on the radio or television.<br><br>
                Non-verbal communication, which covers (2) _______ language, how we dress or act, where we stand, and even our scent. There are many subtle ways that we communicate (sometimes unintentionally) with others. For example, the tone of voice can give clues to mood or emotional state (3) ________ hand signals or facial gestures communication, which includes letters, emails, social media, books, (4) _______, the Internet and other media.<br><br>
                Until recently, several writers and publishers were very powerful when it came to communicating the written word. Today, we can all write and publish our ideas online, which has led to an explosion of information and communication possibilities. Visualizations, which (5) ________ graphs, charts, maps, logos, pictures, and many other visual objects to communicate messages.
            </div>

            <div class="glossary-container">
                <table class="glossary-table">
                    <thead><tr><th>Word</th><th>Type</th><th>Meaning (Vietnamese)</th></tr></thead>
                    <tbody>
                        <tr><td>Subtle</td><td>(adj)</td><td>Tinh t·∫ø, kh√≥ th·∫•y</td></tr>
                        <tr><td>Unintentionally</td><td>(adv)</td><td>V√¥ t√¨nh, kh√¥ng c·ªë √Ω</td></tr>
                        <tr><td>Clues</td><td>(n)</td><td>Manh m·ªëi, d·∫•u hi·ªáu</td></tr>
                        <tr><td>Gestures</td><td>(n)</td><td>C·ª≠ ch·ªâ, ƒëi·ªáu b·ªô</td></tr>
                        <tr><td>Visualizations</td><td>(n)</td><td>Tr·ª±c quan h√≥a (h√¨nh ·∫£nh)</td></tr>
                    </tbody>
                </table>
            </div>

            <div class="questions-container" data-ex="2"></div>
        </div>

        <div class="card" id="ex3">
            <div class="card-title">Exercise 3: Reading Comprehension</div>
            
            <div class="reading-box">
                Email and chat rooms let children communicate with friends and family members. They can also allow children to connect with people that they have never met in person. Knowing a little about each of these communication services can help parents keep children safer while online.<br><br>
                Through email, users can easily send and receive messages. These messages may also have text, audio, and picture files attached. Signing up for an email account is simple because most services offer them for free.<br><br>
                Sometimes these messages contain viruses, or other inappropriate content, so parents should warn children to be wary of emails from unknown people.<br><br>
                Chat rooms are online hang-out spots where anyone can talk about anything - current events, books, and other common interests. Users often do not know each other in real life, so it is important that parents keep a close eye on the content of any conversations.
            </div>

            <div class="glossary-container">
                <table class="glossary-table">
                    <thead><tr><th>Word</th><th>Type</th><th>Meaning (Vietnamese)</th></tr></thead>
                    <tbody>
                        <tr><td>In person</td><td>(idiom)</td><td>Tr·ª±c ti·∫øp, m·∫∑t ƒë·ªëi m·∫∑t</td></tr>
                        <tr><td>Attached</td><td>(adj/v)</td><td>ƒê√≠nh k√®m</td></tr>
                        <tr><td>Inappropriate</td><td>(adj)</td><td>Kh√¥ng ph√π h·ª£p</td></tr>
                        <tr><td>Wary (of)</td><td>(adj)</td><td>C·∫£nh gi√°c, ƒë·ªÅ ph√≤ng</td></tr>
                        <tr><td>Common interests</td><td>(n)</td><td>S·ªü th√≠ch chung</td></tr>
                    </tbody>
                </table>
            </div>

            <div class="questions-container" data-ex="3"></div>
        </div>

    </div>

    <div class="sticky-footer">
        <button class="btn-submit" onclick="submitAll()">N·ªòP B√ÄI & XEM ƒêI·ªÇM</button>
    </div>

    <div class="modal-overlay" id="resultModal">
        <div class="modal-content">
            <h2>K·∫æT QU·∫¢ C·ª¶A CON</h2>
            <div class="score-display" id="finalScore">0/15</div>
            <p id="feedbackText">L√†m t·ªët l·∫Øm!</p>
            <button class="modal-btn" onclick="closeModal()">Xem l·∫°i b√†i l√†m</button>
        </div>
    </div>

    <canvas id="confetti-canvas" style="position:fixed;top:0;left:0;width:100%;height:100%;pointer-events:none;z-index:9999;"></canvas>

<script>
    // --- DATA ---
    const exercises = {
        1: [
            {
                id: "1-1",
                q: "1. The (1) _________ 'telepathy' has been derived...",
                options: ["word", "phrase", "letter", "signal"],
                correct: 0,
                explain: `
                    <p><strong>D·ªãch c√¢u:</strong> <span class="expl-label">T·ª´</span> "telepathy" (th·∫ßn giao c√°ch c·∫£m) b·∫Øt ngu·ªìn t·ª´...</p>
                    <p><strong>Ph√¢n t√≠ch ƒë√°p √°n:</strong></p>
                    <ul>
                        <li>A. Word (n): T·ª´</li>
                        <li>B. Phrase (n): C·ª•m t·ª´</li>
                        <li>C. Letter (n): Ch·ªØ c√°i</li>
                        <li>D. Signal (n): T√≠n hi·ªáu</li>
                    </ul>
                    <p><strong>T·∫°i sao ƒê√öNG (A):</strong> "Telepathy" l√† m·ªôt danh t·ª´ ƒë∆°n (m·ªôt t·ª´ v·ª±ng), n√™n d√πng "word" l√† ch√≠nh x√°c nh·∫•t trong ng·ªØ c·∫£nh ƒë·ªãnh nghƒ©a thu·∫≠t ng·ªØ.</p>
                    <p><strong>T·∫°i sao SAI:</strong> "Phrase" ph·∫£i g·ªìm nhi·ªÅu t·ª´. "Letter" ch·ªâ l√† m·ªôt k√Ω t·ª± (a, b, c). "Signal" kh√¥ng d√πng ƒë·ªÉ ch·ªâ m·ªôt ƒë∆°n v·ªã ng√¥n ng·ªØ trong b·ªëi c·∫£nh n√†y.</p>
                `
            },
            {
                id: "1-2",
                q: "2. Telepathy is the communication (2) _________ two minds...",
                options: ["through", "among", "between", "across"],
                correct: 2,
                explain: `
                    <p><strong>D·ªãch c√¢u:</strong> Th·∫ßn giao c√°ch c·∫£m l√† s·ª± giao ti·∫øp <span class="expl-label">gi·ªØa</span> hai t√¢m tr√≠...</p>
                    <p><strong>Ph√¢n t√≠ch ƒë√°p √°n:</strong></p>
                    <ul>
                        <li>A. Through (prep): Xuy√™n qua</li>
                        <li>B. Among (prep): Trong s·ªë (d√πng cho 3 ƒë·ªëi t∆∞·ª£ng tr·ªü l√™n)</li>
                        <li>C. Between (prep): Gi·ªØa (th∆∞·ªùng d√πng cho 2 ƒë·ªëi t∆∞·ª£ng)</li>
                        <li>D. Across (prep): Ngang qua</li>
                    </ul>
                    <p><strong>T·∫°i sao ƒê√öNG (C):</strong> C·∫•u tr√∫c "between... and..." ho·∫∑c "between two..." d√πng ƒë·ªÉ ch·ªâ m·ªëi quan h·ªá gi·ªØa 2 ƒë·ªëi t∆∞·ª£ng c·ª• th·ªÉ (·ªü ƒë√¢y l√† "two minds").</p>
                    <p><strong>T·∫°i sao SAI:</strong> "Among" d√πng cho nh√≥m nhi·ªÅu ng∆∞·ªùi/v·∫≠t. "Through/Across" kh√¥ng ƒëi v·ªõi c·∫•u tr√∫c s·ªü h·ªØu hay quan h·ªá t∆∞∆°ng t√°c tr·ª±c ti·∫øp "communication... two minds" t·ª± nhi√™n nh∆∞ "between".</p>
                `
            },
            {
                id: "1-3",
                q: "3. ...without the (3) _________ of the five known senses.",
                options: ["using", "use", "take", "taking"],
                correct: 1,
                explain: `
                    <p><strong>D·ªãch c√¢u:</strong> ...m√† kh√¥ng c·∫ßn <span class="expl-label">s·ª± s·ª≠ d·ª•ng</span> c·ªßa 5 gi√°c quan ƒë√£ bi·∫øt.</p>
                    <p><strong>Ph√¢n t√≠ch ƒë√°p √°n:</strong></p>
                    <ul>
                        <li>A. Using (V-ing): Vi·ªác s·ª≠ d·ª•ng</li>
                        <li>B. Use (n): S·ª± s·ª≠ d·ª•ng/C√¥ng d·ª•ng</li>
                        <li>C. Take (v): C·∫ßm/n·∫Øm</li>
                        <li>D. Taking (V-ing): Vi·ªác c·∫ßm/n·∫Øm</li>
                    </ul>
                    <p><strong>T·∫°i sao ƒê√öNG (B):</strong> C·ª•m c·ªë ƒë·ªãnh "the use of something" (s·ª± s·ª≠ d·ª•ng c√°i g√¨). Sau m·∫°o t·ª´ "the" c·∫ßn m·ªôt danh t·ª´.</p>
                    <p><strong>T·∫°i sao SAI:</strong> "The using" r·∫•t hi·∫øm g·∫∑p v√† kh√¥ng t·ª± nhi√™n b·∫±ng "The use". "Take/Taking" sai nghƒ©a ho√†n to√†n.</p>
                `
            },
            {
                id: "1-4",
                q: "4. ...we all have (4) _________ telepathy.",
                options: ["experienced", "brought", "made", "taken"],
                correct: 0,
                explain: `
                    <p><strong>D·ªãch c√¢u:</strong> Ch√∫ng ta ƒë·ªÅu ƒë√£ t·ª´ng <span class="expl-label">tr·∫£i nghi·ªám</span> th·∫ßn giao c√°ch c·∫£m.</p>
                    <p><strong>Ph√¢n t√≠ch ƒë√°p √°n:</strong></p>
                    <ul>
                        <li>A. Experienced (v): Tr·∫£i qua, n·∫øm tr·∫£i</li>
                        <li>B. Brought (v): Mang l·∫°i</li>
                        <li>C. Made (v): L√†m ra</li>
                        <li>D. Taken (v): C·∫ßm, l·∫•y</li>
                    </ul>
                    <p><strong>T·∫°i sao ƒê√öNG (A):</strong> "Experience" ƒëi v·ªõi c√°c danh t·ª´ ch·ªâ c·∫£m gi√°c, hi·ªán t∆∞·ª£ng t√¢m l√Ω ƒë·ªÉ ch·ªâ vi·ªác b·∫£n th√¢n ƒë√£ t·ª´ng tr·∫£i qua n√≥.</p>
                    <p><strong>T·∫°i sao SAI:</strong> Ch√∫ng ta kh√¥ng "mang", "l√†m" hay "c·∫ßm" th·∫ßn giao c√°ch c·∫£m ƒë∆∞·ª£c.</p>
                `
            },
            {
                id: "1-5",
                q: "5. These are spontaneous mind-to-mind (5) _________...",
                options: ["ways", "methods", "techniques", "communications"],
                correct: 3,
                explain: `
                    <p><strong>D·ªãch c√¢u:</strong> ƒê√¢y l√† nh·ªØng s·ª± <span class="expl-label">giao ti·∫øp</span> t·ª± ph√°t t·ª´ t√¢m tr√≠ ƒë·∫øn t√¢m tr√≠...</p>
                    <p><strong>Ph√¢n t√≠ch ƒë√°p √°n:</strong></p>
                    <ul>
                        <li>A. Ways (n): C√°ch th·ª©c</li>
                        <li>B. Methods (n): Ph∆∞∆°ng ph√°p (c√≥ h·ªá th·ªëng)</li>
                        <li>C. Techniques (n): K·ªπ thu·∫≠t</li>
                        <li>D. Communications (n): S·ª± giao ti·∫øp/li√™n l·∫°c</li>
                    </ul>
                    <p><strong>T·∫°i sao ƒê√öNG (D):</strong> B√†i ƒë·ªçc n√≥i v·ªÅ "Telepathy" (Communication). C·ª•m "mind-to-mind communication" l√† thu·∫≠t ng·ªØ chu·∫©n. ·ªû ƒë√¢y d√πng s·ªë nhi·ªÅu ƒë·ªÉ ch·ªâ c√°c l·∫ßn giao ti·∫øp/s·ª± vi·ªác x·∫£y ra.</p>
                    <p><strong>T·∫°i sao SAI:</strong> "Ways/Methods/Techniques" √°m ch·ªâ c√°ch l√†m ch·ªß ƒë·ªông, trong khi b√†i n√≥i ƒë√¢y l√† "spontaneous" (t·ª± ph√°t), ph√π h·ª£p v·ªõi "communications" (c√°c s·ª± li√™n l·∫°c) h∆°n.</p>
                `
            }
        ],
        2: [
            {
                id: "2-1",
                q: "1. Spoken or (1) _____ communication...",
                options: ["written", "verbal", "physical", "visual"],
                correct: 1,
                explain: `
                    <p><strong>D·ªãch c√¢u:</strong> Giao ti·∫øp b·∫±ng l·ªùi n√≥i ho·∫∑c <span class="expl-label">b·∫±ng ng√¥n t·ª´</span> (verbal)...</p>
                    <p><strong>Ph√¢n t√≠ch ƒë√°p √°n:</strong></p>
                    <ul>
                        <li>A. Written: Vi·∫øt</li>
                        <li>B. Verbal: Thu·ªôc v·ªÅ t·ª´ ng·ªØ/l·ªùi n√≥i</li>
                        <li>C. Physical: Thu·ªôc v·ªÅ th·ªÉ ch·∫•t</li>
                        <li>D. Visual: Thu·ªôc v·ªÅ th·ªã gi√°c</li>
                    </ul>
                    <p><strong>T·∫°i sao ƒê√öNG (B):</strong> "Spoken or Verbal communication" l√† c√°ch ph√¢n lo·∫°i chung. Verbal bao g·ªìm c·∫£ Spoken (n√≥i) v√† Written (vi·∫øt - d√π ƒëo·∫°n sau li·ªát k√™ written ri√™ng, nh∆∞ng trong ng·ªØ c·∫£nh ƒë·ªëi l·∫≠p v·ªõi Non-verbal ·ªü ƒëo·∫°n d∆∞·ªõi th√¨ Verbal l√† h·ª£p l√Ω nh·∫•t ƒë·ªÉ m·ªü ƒë·∫ßu).</p>
                    <p><strong>T·∫°i sao SAI:</strong> B√†i ƒë·ªçc ph√¢n lo·∫°i ch√≠nh l√† Verbal vs Non-verbal. ƒêo·∫°n sau c√≥ nh·∫Øc ƒë·∫øn "Non-verbal communication", n√™n ch·ªó tr·ªëng n√†y ƒëi·ªÅn "Verbal" ƒë·ªÉ t·∫°o s·ª± ƒë·ªëi x·ª©ng.</p>
                `
            },
            {
                id: "2-2",
                q: "2. Non-verbal communication, which covers (2) _______ language...",
                options: ["spoken", "foreign", "sign", "body"],
                correct: 3,
                explain: `
                    <p><strong>D·ªãch c√¢u:</strong> Giao ti·∫øp phi ng√¥n ng·ªØ, bao g·ªìm <span class="expl-label">ng√¥n ng·ªØ c∆° th·ªÉ</span>...</p>
                    <p><strong>Ph√¢n t√≠ch ƒë√°p √°n:</strong></p>
                    <ul>
                        <li>A. Spoken: N√≥i</li>
                        <li>B. Foreign: N∆∞·ªõc ngo√†i</li>
                        <li>C. Sign: K√Ω hi·ªáu (Sign language l√† ng√¥n ng·ªØ k√Ω hi·ªáu cho ng∆∞·ªùi khi·∫øm th√≠nh)</li>
                        <li>D. Body: C∆° th·ªÉ</li>
                    </ul>
                    <p><strong>T·∫°i sao ƒê√öNG (D):</strong> "Body language" (ng√¥n ng·ªØ c∆° th·ªÉ) l√† th√†nh ph·∫ßn ch√≠nh c·ªßa giao ti·∫øp phi ng√¥n ng·ªØ (c√πng v·ªõi c√°ch ƒÉn m·∫∑c, h√†nh ƒë·ªông...).</p>
                `
            },
            {
                id: "2-3",
                q: "3. ...tone of voice can give clues... (3) ________ hand signals...",
                options: ["while", "so", "during", "when"],
                correct: 0,
                explain: `
                    <p><strong>D·ªãch c√¢u:</strong> Gi·ªçng n√≥i cho manh m·ªëi v·ªÅ c·∫£m x√∫c <span class="expl-label">trong khi</span> t√≠n hi·ªáu tay...</p>
                    <p><strong>Ph√¢n t√≠ch ƒë√°p √°n:</strong></p>
                    <ul>
                        <li>A. While: Trong khi (d√πng ƒë·ªÉ so s√°nh/ƒë·ªëi chi·∫øu 2 v·∫ø)</li>
                        <li>B. So: V√¨ v·∫≠y</li>
                        <li>C. During: Trong su·ªët (ƒëi v·ªõi danh t·ª´, kh√¥ng n·ªëi m·ªánh ƒë·ªÅ theo c√°ch n√†y)</li>
                        <li>D. When: Khi</li>
                    </ul>
                    <p><strong>T·∫°i sao ƒê√öNG (A):</strong> C√¢u n√†y ƒëang li·ªát k√™/ƒë·ªëi chi·∫øu c√°c v√≠ d·ª• kh√°c nhau: Gi·ªçng n√≥i l√†m vi·ªác n√†y, TRONG KHI (while) t√≠n hi·ªáu tay l√†m vi·ªác kh√°c/l√† m·ªôt v√≠ d·ª• kh√°c.</p>
                `
            },
            {
                id: "2-4",
                q: "4. ...letters, emails, social media, books, (4) _______, the Internet...",
                options: ["talks", "paintings", "recordings", "magazines"],
                correct: 3,
                explain: `
                    <p><strong>D·ªãch c√¢u:</strong> ...th∆∞ t·ª´, s√°ch, <span class="expl-label">t·∫°p ch√≠</span>, Internet...</p>
                    <p><strong>Ph√¢n t√≠ch ƒë√°p √°n:</strong></p>
                    <ul>
                        <li>A. Talks: Cu·ªôc tr√≤ chuy·ªán (thu·ªôc Spoken)</li>
                        <li>B. Paintings: Tranh v·∫Ω (thu·ªôc Visual)</li>
                        <li>C. Recordings: B·∫£n ghi √¢m (thu·ªôc Spoken/Audio)</li>
                        <li>D. Magazines: T·∫°p ch√≠ (thu·ªôc Written)</li>
                    </ul>
                    <p><strong>T·∫°i sao ƒê√öNG (D):</strong> ƒêo·∫°n n√†y ƒëang li·ªát k√™ c√°c h√¨nh th·ª©c "Written communication" (giao ti·∫øp vƒÉn b·∫£n). T·∫°p ch√≠ l√† ·∫•n ph·∫©m vƒÉn b·∫£n t∆∞∆°ng t·ª± s√°ch v√† th∆∞.</p>
                `
            },
            {
                id: "2-5",
                q: "5. Visualizations, which (5) ________ graphs, charts...",
                options: ["draws", "affects", "uses", "communicates"],
                correct: 2,
                explain: `
                    <p><strong>D·ªãch c√¢u:</strong> Tr·ª±c quan h√≥a, c√°i m√† <span class="expl-label">s·ª≠ d·ª•ng</span> bi·ªÉu ƒë·ªì, s∆° ƒë·ªì...</p>
                    <p><strong>Ph√¢n t√≠ch ƒë√°p √°n:</strong></p>
                    <ul>
                        <li>A. Draws: V·∫Ω</li>
                        <li>B. Affects: ·∫¢nh h∆∞·ªüng</li>
                        <li>C. Uses: S·ª≠ d·ª•ng</li>
                        <li>D. Communicates: Giao ti·∫øp/truy·ªÅn ƒë·∫°t</li>
                    </ul>
                    <p><strong>T·∫°i sao ƒê√öNG (C):</strong> H√¨nh th·ª©c "Visualizations" (s·ª± tr·ª±c quan h√≥a) S·ª¨ D·ª§NG c√°c c√¥ng c·ª• nh∆∞ bi·ªÉu ƒë·ªì ƒë·ªÉ truy·ªÅn t·∫£i th√¥ng ƒëi·ªáp. (L∆∞u √Ω: ƒê·ªÅ b√†i g·ªëc d√πng 'uses' s·ªë √≠t cho ch·ªß ng·ªØ s·ªë nhi·ªÅu 'Visualizations' c√≥ th·ªÉ l√† l·ªói ng·ªØ ph√°p c·ªßa ƒë·ªÅ, nh∆∞ng x√©t v·ªÅ nghƒ©a, 'uses' l√† h·ª£p l√Ω nh·∫•t).</p>
                `
            }
        ],
        3: [
            {
                id: "3-1",
                q: "1. Email and chat rooms let children __________.",
                options: ["communicate with only friends", "communicate with friends and family members", "communicate with people that they have never met in person", "Both B & C"],
                correct: 3,
                explain: `
                    <p><strong>D·ªãch c√¢u h·ªèi:</strong> Email v√† ph√≤ng chat cho ph√©p tr·∫ª em l√†m g√¨?</p>
                    <p><strong>T·∫°i sao ƒê√öNG (D):</strong></p>
                    <ul>
                        <li>D·∫´n ch·ª©ng 1: "let children communicate with friends and family members" (Gi·ªëng √Ω B).</li>
                        <li>D·∫´n ch·ª©ng 2: "allow children to connect with people that they have never met in person" (Gi·ªëng √Ω C).</li>
                    </ul>
                    <p>=> C·∫£ B v√† C ƒë·ªÅu ƒë√∫ng n√™n ch·ªçn D.</p>
                `
            },
            {
                id: "3-2",
                q: "2. Children will be safer while online if __________.",
                options: ["they know how to use email...", "they don‚Äôt know how to use...", "their parents know a little about email and chat rooms", "their parents don‚Äôt know anything..."],
                correct: 2,
                explain: `
                    <p><strong>D·ªãch c√¢u h·ªèi:</strong> Tr·∫ª em s·∫Ω an to√†n h∆°n khi tr·ª±c tuy·∫øn n·∫øu...?</p>
                    <p><strong>T·∫°i sao ƒê√öNG (C):</strong></p>
                    <ul>
                        <li>D·∫´n ch·ª©ng: "Knowing a little about each of these communication services can help parents keep children safer while online." (Vi·ªác cha m·∫π bi·∫øt m·ªôt ch√∫t v·ªÅ c√°c d·ªãch v·ª• n√†y gi√∫p gi·ªØ tr·∫ª an to√†n).</li>
                    </ul>
                    <p><strong>T·∫°i sao SAI:</strong> C√°c ƒë√°p √°n kh√°c n√≥i v·ªÅ vi·ªác tr·∫ª bi·∫øt d√πng hay cha m·∫π kh√¥ng bi·∫øt g√¨ ƒë·ªÅu tr√°i ng∆∞·ª£c v·ªõi √Ω b√†i ƒë·ªçc.</p>
                `
            },
            {
                id: "3-3",
                q: "3. Users can easily send and receive messages __________.",
                options: ["through email", "through phone", "through video call", "Through face to face conversation"],
                correct: 0,
                explain: `
                    <p><strong>D·ªãch c√¢u h·ªèi:</strong> Ng∆∞·ªùi d√πng c√≥ th·ªÉ d·ªÖ d√†ng g·ª≠i v√† nh·∫≠n tin nh·∫Øn...?</p>
                    <p><strong>T·∫°i sao ƒê√öNG (A):</strong></p>
                    <ul>
                        <li>D·∫´n ch·ª©ng: "Through email, users can easily send and receive messages." (Th√¥ng qua email, ng∆∞·ªùi d√πng c√≥ th·ªÉ d·ªÖ d√†ng g·ª≠i v√† nh·∫≠n tin nh·∫Øn).</li>
                    </ul>
                `
            },
            {
                id: "3-4",
                q: "4. Signing up for an email account is __________.",
                options: ["simple because it is offered for free...", "simple because it has text...", "complex because it contains viruses", "complex because it has inappropriate content"],
                correct: 0,
                explain: `
                    <p><strong>D·ªãch c√¢u h·ªèi:</strong> ƒêƒÉng k√Ω t√†i kho·∫£n email th√¨...?</p>
                    <p><strong>T·∫°i sao ƒê√öNG (A):</strong></p>
                    <ul>
                        <li>D·∫´n ch·ª©ng: "Signing up for an email account is simple because most services offer them for free." (ƒêƒÉng k√Ω ƒë∆°n gi·∫£n v√¨ h·∫ßu h·∫øt d·ªãch v·ª• cung c·∫•p mi·ªÖn ph√≠).</li>
                    </ul>
                `
            },
            {
                id: "3-5",
                q: "5. Parents should warn children __________.",
                options: ["to be cautious about emails from known people", "to be cautious about emails from unknown people", "not to be wary of emails from known people", "not to be wary of emails from unknown people"],
                correct: 1,
                explain: `
                    <p><strong>D·ªãch c√¢u h·ªèi:</strong> Cha m·∫π n√™n c·∫£nh b√°o tr·∫ª em...?</p>
                    <p><strong>T·∫°i sao ƒê√öNG (B):</strong></p>
                    <ul>
                        <li>D·∫´n ch·ª©ng: "...parents should warn children to be wary of emails from unknown people." (C·∫£nh b√°o tr·∫ª n√™n c·∫£nh gi√°c/ƒë·ªÅ ph√≤ng v·ªõi email t·ª´ ng∆∞·ªùi l·∫°).</li>
                        <li>"Cautious" ƒë·ªìng nghƒ©a v·ªõi "Wary".</li>
                    </ul>
                `
            }
        ]
    };

    // --- RENDER FUNCTIONS ---
    function renderQuestions() {
        for (let exId in exercises) {
            const container = document.querySelector(`.questions-container[data-ex="${exId}"]`);
            exercises[exId].forEach((item, index) => {
                const qBlock = document.createElement('div');
                qBlock.className = 'question-block';
                
                let optionsHtml = '';
                item.options.forEach((opt, i) => {
                    optionsHtml += `<button class="btn-option" onclick="checkAnswer(this, '${exId}', ${index}, ${i})">${String.fromCharCode(65+i)}. ${opt}</button>`;
                });

                qBlock.innerHTML = `
                    <div class="q-text">
                        <span class="status-marker" id="status-${item.id}">?</span>
                        ${item.q}
                    </div>
                    <div class="options-grid" id="opts-${item.id}">
                        ${optionsHtml}
                    </div>
                    <div class="explanation" id="expl-${item.id}">
                        <div class="expl-header">
                            <span>üë©‚Äçüè´</span> C√¥ Mai An gi·∫£i th√≠ch:
                        </div>
                        <div class="expl-content">${item.explain}</div>
                    </div>
                `;
                container.appendChild(qBlock);
            });
        }
    }

    // --- SOUND EFFECTS (Synthesized - No external files) ---
    const audioCtx = new (window.AudioContext || window.webkitAudioContext)();

    function playSound(type) {
        if (audioCtx.state === 'suspended') audioCtx.resume();
        const osc = audioCtx.createOscillator();
        const gainNode = audioCtx.createGain();
        osc.connect(gainNode);
        gainNode.connect(audioCtx.destination);

        if (type === 'correct') {
            // Ding sound (High pitch sine)
            osc.type = 'sine';
            osc.frequency.setValueAtTime(800, audioCtx.currentTime);
            osc.frequency.exponentialRampToValueAtTime(1200, audioCtx.currentTime + 0.1);
            gainNode.gain.setValueAtTime(0.3, audioCtx.currentTime);
            gainNode.gain.exponentialRampToValueAtTime(0.01, audioCtx.currentTime + 0.5);
            osc.start();
            osc.stop(audioCtx.currentTime + 0.5);
        } else {
            // Wrong sound (Low pitch saw)
            osc.type = 'sawtooth';
            osc.frequency.setValueAtTime(150, audioCtx.currentTime);
            osc.frequency.linearRampToValueAtTime(100, audioCtx.currentTime + 0.3);
            gainNode.gain.setValueAtTime(0.3, audioCtx.currentTime);
            gainNode.gain.exponentialRampToValueAtTime(0.01, audioCtx.currentTime + 0.3);
            osc.start();
            osc.stop(audioCtx.currentTime + 0.3);
        }
    }

    // --- CHECK LOGIC ---
    let userAnswers = {}; // Store results

    function checkAnswer(btn, exId, qIndex, optIndex) {
        const qData = exercises[exId][qIndex];
        const qId = qData.id;
        
        // Prevent re-clicking
        if (userAnswers[qId] !== undefined) return;

        const optionsDiv = document.getElementById(`opts-${qId}`);
        const allBtns = optionsDiv.querySelectorAll('.btn-option');
        const explDiv = document.getElementById(`expl-${qId}`);
        const statusMarker = document.getElementById(`status-${qId}`);

        // Disable all buttons
        allBtns.forEach(b => b.classList.add('disabled'));

        if (optIndex === qData.correct) {
            // Correct
            btn.classList.add('correct');
            statusMarker.textContent = "‚úì";
            statusMarker.className = "status-marker status-correct";
            userAnswers[qId] = true;
            playSound('correct');
            fireConfetti(btn);
        } else {
            // Wrong
            btn.classList.add('wrong');
            // Highlight correct answer
            allBtns[qData.correct].classList.add('correct');
            statusMarker.textContent = "‚úó";
            statusMarker.className = "status-marker status-wrong";
            userAnswers[qId] = false;
            playSound('wrong');
        }

        // Show explanation
        explDiv.style.display = 'block';
    }

    // --- SCORING & SUBMIT ---
    function submitAll() {
        let correctCount = 0;
        let totalCount = 0;
        let firstUnanswered = null;

        for (let exId in exercises) {
            exercises[exId].forEach(q => {
                totalCount++;
                if (userAnswers[q.id] === true) {
                    correctCount++;
                } else if (userAnswers[q.id] === undefined) {
                    // Mark unanswered
                    const statusMarker = document.getElementById(`status-${q.id}`);
                    statusMarker.parentElement.style.color = "#d35400"; // Warn color
                    if (!firstUnanswered) firstUnanswered = statusMarker;
                    
                    // Auto show correct answer for unanswered
                    const optionsDiv = document.getElementById(`opts-${q.id}`);
                    const allBtns = optionsDiv.querySelectorAll('.btn-option');
                    allBtns[q.correct].classList.add('correct');
                    allBtns.forEach(b => b.classList.add('disabled'));
                    document.getElementById(`expl-${q.id}`).style.display = 'block';
                }
            });
        }

        // Setup Modal
        const modal = document.getElementById('resultModal');
        const scoreDisplay = document.getElementById('finalScore');
        const feedback = document.getElementById('feedbackText');

        scoreDisplay.textContent = `${correctCount}/${totalCount}`;
        
        const percentage = (correctCount / totalCount) * 100;
        if (percentage === 100) {
            feedback.textContent = "Xu·∫•t s·∫Øc! Con l√† thi√™n t√†i ti·∫øng Anh! üåü";
            playSound('correct');
            fireConfetti(document.body);
        } else if (percentage >= 80) {
            feedback.textContent = "L√†m r·∫•t t·ªët! Ch·ªâ sai m·ªôt ch√∫t x√≠u th√¥i! üí™";
        } else {
            feedback.textContent = "C·ªë g·∫Øng l√™n nh√©! Con h√£y xem l·∫°i ph·∫ßn gi·∫£i th√≠ch chi ti·∫øt nha. ‚ù§Ô∏è";
        }

        modal.style.display = 'flex';
    }

    function closeModal() {
        document.getElementById('resultModal').style.display = 'none';
    }

    // --- CONFETTI EFFECT (Simple JS Implementation) ---
    function fireConfetti(element) {
        const canvas = document.getElementById('confetti-canvas');
        const ctx = canvas.getContext('2d');
        canvas.width = window.innerWidth;
        canvas.height = window.innerHeight;

        const pieces = [];
        const numberOfPieces = 100;
        const colors = ['#f00', '#0f0', '#00f', '#ff0', '#0ff'];

        // Get coordinates of element to burst from
        const rect = element.getBoundingClientRect();
        const originX = rect.left + rect.width / 2;
        const originY = rect.top + rect.height / 2;

        for (let i = 0; i < numberOfPieces; i++) {
            pieces.push({
                x: originX,
                y: originY,
                color: colors[Math.floor(Math.random() * colors.length)],
                radius: Math.random() * 5 + 2,
                speedX: Math.random() * 10 - 5,
                speedY: Math.random() * 10 - 10,
                gravity: 0.5
            });
        }

        let animationFrame;

        function update() {
            ctx.clearRect(0, 0, canvas.width, canvas.height);
            let activePieces = 0;

            pieces.forEach(p => {
                if (p.y < canvas.height) {
                    p.x += p.speedX;
                    p.y += p.speedY;
                    p.speedY += p.gravity;

                    ctx.beginPath();
                    ctx.arc(p.x, p.y, p.radius, 0, Math.PI * 2);
                    ctx.fillStyle = p.color;
                    ctx.fill();
                    activePieces++;
                }
            });

            if (activePieces > 0) {
                animationFrame = requestAnimationFrame(update);
            } else {
                ctx.clearRect(0, 0, canvas.width, canvas.height);
            }
        }

        update();
    }

    // Initialize
    renderQuestions();

</script>
</body>
</html>