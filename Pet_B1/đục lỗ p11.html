<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>B√†i t·∫≠p Ti·∫øng Anh - Ms Mai An ULIS</title>
    <link href="https://fonts.googleapis.com/css2?family=Nunito:wght@400;600;700;800&display=swap" rel="stylesheet">
    
    <style>
        :root {
            /* Color Palette based on Topic: Planes & Rain (Blue/White/Gray) */
            --primary-color: #3b82f6; /* Sky Blue */
            --primary-dark: #2563eb;
            --secondary-color: #f1f5f9; /* Cloud White */
            --accent-color: #0ea5e9;
            --correct-color: #22c55e; /* Green */
            --correct-dark: #16a34a;
            --wrong-color: #ef4444; /* Red */
            --wrong-dark: #dc2626;
            --text-color: #1e293b;
            --shadow: 0 4px 0 rgba(0,0,0,0.1);
            --shadow-hover: 0 6px 0 rgba(0,0,0,0.15);
            --shadow-active: 0 0 0 rgba(0,0,0,0.1);
        }

        * {
            box-sizing: border-box;
            margin: 0;
            padding: 0;
        }

        body {
            font-family: 'Nunito', sans-serif;
            color: var(--text-color);
            height: 100vh;
            overflow: hidden;
            /* Auto-generated Background SVG with Emojis */
            background-color: #e0f2fe;
            background-image: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='200' height='200' viewBox='0 0 200 200'%3E%3Ctext x='20' y='40' font-size='30' opacity='0.3'%3E‚úàÔ∏è%3C/text%3E%3Ctext x='120' y='150' font-size='30' opacity='0.3'%3EüåßÔ∏è%3C/text%3E%3Ctext x='150' y='50' font-size='40' opacity='0.2'%3E‚òÅÔ∏è%3C/text%3E%3Ccircle cx='100' cy='100' r='100' fill='url(%23grad)' opacity='0.4'/%3E%3Cdefs%3E%3CradialGradient id='grad' cx='50%25' cy='50%25' r='50%25' fx='50%25' fy='50%25'%3E%3Cstop offset='0%25' style='stop-color:white;stop-opacity:1' /%3E%3Cstop offset='100%25' style='stop-color:%23bae6fd;stop-opacity:0' /%3E%3C/radialGradient%3E%3C/defs%3E%3C/svg%3E");
            background-attachment: fixed;
            display: flex;
            flex-direction: column;
        }

        /* --- Header --- */
        header {
            background: white;
            padding: 10px 20px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
            display: flex;
            justify-content: space-between;
            align-items: center;
            z-index: 100;
        }

        .teacher-name {
            font-size: 0.9rem;
            color: #64748b;
            font-weight: 700;
            text-transform: uppercase;
            letter-spacing: 1px;
        }

        .timer-container {
            display: flex;
            align-items: center;
            gap: 15px;
        }

        #timer-display {
            font-size: 1.5rem;
            font-weight: 800;
            color: var(--primary-color);
            font-variant-numeric: tabular-nums;
        }

        .btn-control {
            background-color: var(--primary-color);
            color: white;
            border: none;
            padding: 8px 20px;
            border-radius: 12px;
            font-weight: 700;
            font-size: 1rem;
            cursor: pointer;
            box-shadow: 0 4px 0 var(--primary-dark);
            transition: all 0.1s;
        }

        .btn-control:active {
            transform: translateY(4px);
            box-shadow: none;
        }

        /* --- Main Container (Split Screen) --- */
        .main-container {
            display: flex;
            flex: 1;
            overflow: hidden;
            height: calc(100vh - 70px);
        }

        /* --- Left Panel: Reading --- */
        .panel-left {
            flex: 1;
            padding: 30px;
            overflow-y: auto;
            border-right: 2px solid #cbd5e1;
            background: rgba(255, 255, 255, 0.9);
        }

        .reading-title {
            font-size: 1.8rem;
            color: var(--primary-dark);
            margin-bottom: 20px;
            text-align: center;
        }

        .reading-text {
            font-size: 1.1rem;
            line-height: 1.8;
            color: #334155;
            margin-bottom: 20px;
            text-align: justify;
        }

        .highlight-gap {
            font-weight: bold;
            color: var(--primary-color);
            background: #e0f2fe;
            padding: 2px 6px;
            border-radius: 4px;
        }

        .btn-translate {
            display: block;
            width: 100%;
            margin: 20px 0;
            padding: 10px;
            background: white;
            border: 2px solid var(--primary-color);
            color: var(--primary-color);
            border-radius: 10px;
            font-weight: bold;
            cursor: pointer;
            transition: 0.3s;
        }

        .btn-translate:hover {
            background: #f0f9ff;
        }

        .translation-content {
            display: none;
            background: #f8fafc;
            padding: 15px;
            border-radius: 10px;
            border-left: 4px solid var(--primary-color);
            margin-bottom: 20px;
            font-style: italic;
            color: #475569;
        }

        /* Glossary Table */
        .glossary-container {
            margin-top: 30px;
        }
        .glossary-title {
            font-size: 1.2rem;
            font-weight: 800;
            color: var(--text-color);
            margin-bottom: 10px;
            border-bottom: 2px solid #e2e8f0;
            padding-bottom: 5px;
        }
        .glossary-table {
            width: 100%;
            border-collapse: collapse;
            font-size: 0.95rem;
        }
        .glossary-table th, .glossary-table td {
            text-align: left;
            padding: 8px;
            border-bottom: 1px solid #e2e8f0;
        }
        .glossary-table th {
            color: var(--primary-dark);
        }
        .glossary-word {
            font-weight: bold;
            color: var(--accent-color);
        }
        .glossary-type {
            font-style: italic;
            font-size: 0.85rem;
            color: #64748b;
        }

        /* --- Right Panel: Exercises --- */
        .panel-right {
            flex: 1;
            padding: 30px;
            overflow-y: auto;
            background: rgba(248, 250, 252, 0.8);
        }

        .question-card {
            background: white;
            border-radius: 16px;
            padding: 20px;
            margin-bottom: 25px;
            box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1);
            border: 2px solid #e2e8f0;
            transition: transform 0.2s;
        }

        .question-card:hover {
            transform: translateY(-2px);
            border-color: var(--primary-color);
        }

        .q-header {
            font-weight: 800;
            color: #94a3b8;
            margin-bottom: 10px;
            font-size: 0.9rem;
        }

        .q-text {
            font-size: 1.1rem;
            font-weight: 700;
            margin-bottom: 15px;
            color: var(--text-color);
        }

        .options-grid {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 12px;
        }

        .option-btn {
            background: white;
            border: 2px solid #e2e8f0;
            border-radius: 12px;
            padding: 12px;
            font-family: inherit;
            font-weight: 600;
            color: var(--text-color);
            cursor: pointer;
            box-shadow: 0 4px 0 #cbd5e1;
            transition: all 0.2s;
            position: relative;
            text-align: left;
        }

        .option-btn:hover:not(:disabled) {
            background: #f1f5f9;
            transform: translateY(-2px);
        }

        .option-btn:active:not(:disabled) {
            transform: translateY(2px);
            box-shadow: 0 0 0 #cbd5e1;
        }

        /* Correct/Wrong States */
        .option-btn.correct {
            background-color: var(--correct-color);
            border-color: var(--correct-dark);
            color: white;
            box-shadow: 0 4px 0 var(--correct-dark);
        }

        .option-btn.wrong {
            background-color: var(--wrong-color);
            border-color: var(--wrong-dark);
            color: white;
            box-shadow: 0 4px 0 var(--wrong-dark);
            animation: shake 0.5s;
        }

        .option-btn:disabled {
            cursor: default;
            opacity: 0.7;
            transform: none !important;
        }

        /* Explanation Box */
        .explanation-box {
            display: none;
            margin-top: 15px;
            padding: 15px;
            background: #f0fdf4;
            border: 2px solid var(--correct-color);
            border-radius: 12px;
            font-size: 0.95rem;
            animation: slideDown 0.3s ease-out;
        }

        .explanation-header {
            font-weight: 800;
            color: var(--correct-dark);
            margin-bottom: 8px;
            display: flex;
            align-items: center;
            gap: 5px;
        }

        .explanation-detail p {
            margin-bottom: 8px;
            line-height: 1.5;
        }
        
        .vocab-note {
            background: #fff;
            padding: 8px;
            border-radius: 8px;
            border-left: 3px solid #f59e0b;
            font-size: 0.9rem;
            margin-top: 5px;
        }

        .submit-section {
            text-align: center;
            margin-top: 30px;
            padding-bottom: 50px;
        }

        .btn-submit {
            background: var(--correct-color);
            color: white;
            font-size: 1.2rem;
            padding: 15px 40px;
            border-radius: 50px;
            border: none;
            font-weight: 800;
            box-shadow: 0 6px 0 var(--correct-dark);
            cursor: pointer;
            transition: 0.2s;
        }

        .btn-submit:active {
            transform: translateY(6px);
            box-shadow: none;
        }

        /* --- Animations --- */
        @keyframes shake {
            0% { transform: translateX(0); }
            25% { transform: translateX(-5px) rotate(-5deg); }
            50% { transform: translateX(5px) rotate(5deg); }
            75% { transform: translateX(-5px) rotate(-5deg); }
            100% { transform: translateX(0); }
        }

        @keyframes slideDown {
            from { opacity: 0; transform: translateY(-10px); }
            to { opacity: 1; transform: translateY(0); }
        }

        /* --- Modals --- */
        .modal-overlay {
            position: fixed;
            top: 0; left: 0; width: 100%; height: 100%;
            background: rgba(0,0,0,0.5);
            display: none;
            justify-content: center;
            align-items: center;
            z-index: 1000;
            backdrop-filter: blur(5px);
        }

        .modal-content {
            background: white;
            padding: 40px;
            border-radius: 20px;
            text-align: center;
            max-width: 500px;
            width: 90%;
            box-shadow: 0 10px 25px rgba(0,0,0,0.2);
            animation: zoomIn 0.3s;
        }

        @keyframes zoomIn {
            from { transform: scale(0.8); opacity: 0; }
            to { transform: scale(1); opacity: 1; }
        }

        .modal-title {
            font-size: 2rem;
            font-weight: 800;
            margin-bottom: 10px;
            color: var(--primary-dark);
        }

        .score-display {
            font-size: 3rem;
            font-weight: 900;
            color: var(--correct-color);
            margin: 20px 0;
        }

        .modal-msg {
            font-size: 1.1rem;
            color: #64748b;
            margin-bottom: 25px;
        }

        /* Canvas for Confetti */
        #confetti-canvas {
            position: fixed;
            top: 0; left: 0;
            width: 100%; height: 100%;
            pointer-events: none;
            z-index: 999;
        }

        /* Responsive */
        @media (max-width: 768px) {
            .main-container {
                flex-direction: column;
                height: auto;
                overflow-y: auto;
            }
            .panel-left, .panel-right {
                height: auto;
                overflow: visible;
                border-right: none;
                border-bottom: 2px solid #cbd5e1;
            }
            body {
                overflow-y: auto;
                height: auto;
            }
        }
    </style>
</head>
<body>

    <canvas id="confetti-canvas"></canvas>

    <header>
        <div class="teacher-name">Gi√°o vi√™n t·∫°o: Ms Mai An ULIS</div>
        <div class="timer-container">
            <span id="timer-display">10:00</span>
            <button class="btn-control" id="btn-timer" onclick="toggleTimer()">B·∫ÆT ƒê·∫¶U</button>
        </div>
    </header>

    <div class="main-container">
        
        <div class="panel-left">
            <h1 class="reading-title">Planes can make it rain</h1>
            
            <div id="passage-content">
                <p class="reading-text">
                    Living next to an airport has always meant having to (1) <span class="highlight-gap">............</span> the noise of planes landing and taking off. Now it seems that (2) <span class="highlight-gap">............</span> residents also have bad weather, according to a (3) <span class="highlight-gap">............</span> published study.
                </p>
                <p class="reading-text">
                    The scientists looked at satellite (4) <span class="highlight-gap">............</span> of clouds above airports, and also studied computer models of the way clouds behave. What they found was that as a plane flies through a very cold cloud, the air behind it expands and then cools (5) <span class="highlight-gap">............</span> rapidly. This sudden drop in temperature, (6) <span class="highlight-gap">............</span> with the hole formed in the cloud where the plane has passed through, can increase the (7) <span class="highlight-gap">............</span> of rain or snow on the ground.
                </p>
                <p class="reading-text">
                    In the case of major airports, with hundreds of flights every day, this can have a significant (8) <span class="highlight-gap">............</span> on weather patterns up to 100 kilometres away. The researchers point out, however, that aircraft passing through clouds are (9) <span class="highlight-gap">............</span> to affect the global climate.
                </p>
            </div>

            <button class="btn-translate" onclick="toggleTranslation()">üåê Xem B·∫£n D·ªãch ƒê·∫ßy ƒê·ªß (Ti·∫øng Vi·ªát)</button>
            
            <div id="translation" class="translation-content">
                <p><strong>ƒêo·∫°n 1:</strong> S·ªëng c·∫°nh s√¢n bay lu√¥n ƒë·ªìng nghƒ©a v·ªõi vi·ªác ph·∫£i ch·ªãu ƒë·ª±ng ti·∫øng ·ªìn c·ªßa m√°y bay c·∫•t c√°nh v√† h·∫° c√°nh. Gi·ªù ƒë√¢y, c√≥ v·∫ª nh∆∞ c∆∞ d√¢n ƒë·ªãa ph∆∞∆°ng c√≤n ph·∫£i ch·ªãu th·ªùi ti·∫øt x·∫•u n·ªØa, theo m·ªôt nghi√™n c·ª©u m·ªõi ƒë∆∞·ª£c c√¥ng b·ªë g·∫ßn ƒë√¢y.</p>
                <br>
                <p><strong>ƒêo·∫°n 2:</strong> C√°c nh√† khoa h·ªçc ƒë√£ xem x√©t c√°c h√¨nh ·∫£nh v·ªá tinh c·ªßa c√°c ƒë√°m m√¢y ph√≠a tr√™n s√¢n bay, v√† c≈©ng nghi√™n c·ª©u c√°c m√¥ h√¨nh m√°y t√≠nh v·ªÅ c√°ch c√°c ƒë√°m m√¢y ho·∫°t ƒë·ªông. Nh·ªØng g√¨ h·ªç t√¨m th·∫•y l√† khi m·ªôt chi·∫øc m√°y bay bay qua m·ªôt ƒë√°m m√¢y r·∫•t l·∫°nh, kh√¥ng kh√≠ ph√≠a sau n√≥ gi√£n n·ªü v√† sau ƒë√≥ ngu·ªôi ƒëi c·ª±c k·ª≥ nhanh ch√≥ng. S·ª± gi·∫£m nhi·ªát ƒë·ªô ƒë·ªôt ng·ªôt n√†y, k·∫øt h·ª£p v·ªõi l·ªó h·ªïng h√¨nh th√†nh trong ƒë√°m m√¢y n∆°i m√°y bay ƒë√£ ƒëi qua, c√≥ th·ªÉ l√†m tƒÉng kh·∫£ nƒÉng c√≥ m∆∞a ho·∫∑c tuy·∫øt tr√™n m·∫∑t ƒë·∫•t.</p>
                <br>
                <p><strong>ƒêo·∫°n 3:</strong> Trong tr∆∞·ªùng h·ª£p c·ªßa c√°c s√¢n bay l·ªõn, v·ªõi h√†ng trƒÉm chuy·∫øn bay m·ªói ng√†y, ƒëi·ªÅu n√†y c√≥ th·ªÉ c√≥ ·∫£nh h∆∞·ªüng ƒë√°ng k·ªÉ ƒë·∫øn c√°c ki·ªÉu th·ªùi ti·∫øt c√°ch ƒë√≥ t·ªõi 100 km. Tuy nhi√™n, c√°c nh√† nghi√™n c·ª©u ch·ªâ ra r·∫±ng m√°y bay bay qua c√°c ƒë√°m m√¢y √≠t c√≥ kh·∫£ nƒÉng ·∫£nh h∆∞·ªüng ƒë·∫øn kh√≠ h·∫≠u to√†n c·∫ßu.</p>
            </div>

            <div class="glossary-container">
                <div class="glossary-title">üìñ GLOSSARY (T·ª´ v·ª±ng h·ªçc thu·∫≠t)</div>
                <table class="glossary-table">
                    <thead>
                        <tr>
                            <th>T·ª´ v·ª±ng</th>
                            <th>Lo·∫°i t·ª´</th>
                            <th>Nghƒ©a ti·∫øng Vi·ªát</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr><td><span class="glossary-word">Resident</span></td><td><span class="glossary-type">noun</span></td><td>C∆∞ d√¢n</td></tr>
                        <tr><td><span class="glossary-word">Satellite</span></td><td><span class="glossary-type">noun</span></td><td>V·ªá tinh</td></tr>
                        <tr><td><span class="glossary-word">Expand</span></td><td><span class="glossary-type">verb</span></td><td>M·ªü r·ªông, gi√£n n·ªü</td></tr>
                        <tr><td><span class="glossary-word">Rapidly</span></td><td><span class="glossary-type">adverb</span></td><td>M·ªôt c√°ch nhanh ch√≥ng</td></tr>
                        <tr><td><span class="glossary-word">Temperature</span></td><td><span class="glossary-type">noun</span></td><td>Nhi·ªát ƒë·ªô</td></tr>
                        <tr><td><span class="glossary-word">Significant</span></td><td><span class="glossary-type">adj</span></td><td>ƒê√°ng k·ªÉ, quan tr·ªçng</td></tr>
                        <tr><td><span class="glossary-word">Pattern</span></td><td><span class="glossary-type">noun</span></td><td>Ki·ªÉu, m√¥ h√¨nh</td></tr>
                        <tr><td><span class="glossary-word">Aircraft</span></td><td><span class="glossary-type">noun</span></td><td>M√°y bay, kh√≠ c·ª• bay</td></tr>
                        <tr><td><span class="glossary-word">Global climate</span></td><td><span class="glossary-type">noun phr</span></td><td>Kh√≠ h·∫≠u to√†n c·∫ßu</td></tr>
                        <tr><td><span class="glossary-word">Influence</span></td><td><span class="glossary-type">noun</span></td><td>S·ª± ·∫£nh h∆∞·ªüng</td></tr>
                    </tbody>
                </table>
            </div>
        </div>

        <div class="panel-right" id="quiz-container">
            </div>
    </div>

    <div id="modal-timeout" class="modal-overlay">
        <div class="modal-content">
            <div class="modal-title">‚è∞ H·∫øt gi·ªù r·ªìi!</div>
            <p class="modal-msg">ƒê√£ h·∫øt gi·ªù l√†m b√†i. B·∫°n v·∫´n c√≥ th·ªÉ ti·∫øp t·ª•c l√†m, nh∆∞ng nh·ªõ l√† trong ph√≤ng thi th·∫≠t, b·∫°n ch·ªâ n√™n l√†m m·ªôt b√†i nh∆∞ th·∫ø n√†y trong 10 ph√∫t th√¥i nha.</p>
            <button class="btn-submit" onclick="closeModal('modal-timeout')">Ti·∫øp t·ª•c l√†m b√†i</button>
        </div>
    </div>

    <div id="modal-result" class="modal-overlay">
        <div class="modal-content">
            <div class="modal-title">üéâ K·∫æT QU·∫¢</div>
            <div class="score-display" id="final-score">0/9</div>
            <p class="modal-msg" id="final-msg">B·∫°n l√†m r·∫•t t·ªët!</p>
            <button class="btn-submit" onclick="location.reload()">L√†m l·∫°i b√†i n√†y</button>
        </div>
    </div>

    <script>
        // --- DATA ---
        const questions = [
            {
                id: 1,
                text: "Living next to an airport has always meant having to (1)‚Ä¶‚Ä¶‚Ä¶‚Ä¶‚Ä¶ the noise of planes...",
                options: ["keep out of", "put up with", "miss out on", "stand up for"],
                answer: 1, // index of correct answer (B)
                explanation: `
                    <strong>Ph√¢n t√≠ch t·ª´ v·ª±ng:</strong><br>
                    A. <em>keep out of</em>: tr√°nh xa.<br>
                    B. <em>put up with</em>: ch·ªãu ƒë·ª±ng (th∆∞·ªùng d√πng cho ƒëi·ªÅu kh√≥ ch·ªãu).<br>
                    C. <em>miss out on</em>: b·ªè l·ª°.<br>
                    D. <em>stand up for</em>: b·∫£o v·ªá, ·ªßng h·ªô.<br>
                    <strong>T·∫°i sao ch·ªçn B?</strong><br>
                    Ng·ªØ c·∫£nh l√† "noise" (ti·∫øng ·ªìn) -> ƒëi·ªÅu ti√™u c·ª±c m√† ng∆∞·ªùi s·ªëng g·∫ßn s√¢n bay ph·∫£i "ch·ªãu ƒë·ª±ng".
                `
            },
            {
                id: 2,
                text: "Now it seems that (2)‚Ä¶‚Ä¶‚Ä¶‚Ä¶‚Ä¶ residents also have bad weather...",
                options: ["neighbouring", "close", "local", "surrounded"],
                answer: 2, // C
                explanation: `
                    <strong>Collocation (C·ª•m t·ª´ c·ªë ƒë·ªãnh):</strong><br>
                    C·ª•m t·ª´ <em>"local residents"</em> (c∆∞ d√¢n ƒë·ªãa ph∆∞∆°ng) l√† m·ªôt collocation r·∫•t ph·ªï bi·∫øn.<br>
                    A. <em>neighbouring</em>: l√¢n c·∫≠n (th∆∞·ªùng c·∫ßn t√¢n ng·ªØ ho·∫∑c d√πng cho ƒë·ªãa ƒëi·ªÉm).<br>
                    B. <em>close</em>: g·∫ßn (th∆∞·ªùng ƒëi v·ªõi 'to').<br>
                    D. <em>surrounded</em>: b·ªã bao v√¢y (th·ªÉ b·ªã ƒë·ªông).
                `
            },
            {
                id: 3,
                text: "...according to a (3)‚Ä¶‚Ä¶‚Ä¶‚Ä¶‚Ä¶ published study.",
                options: ["lately", "recently", "lastly", "freshly"],
                answer: 1, // B
                explanation: `
                    <strong>Ng·ªØ ph√°p & Ng·ªØ nghƒ©a:</strong><br>
                    B. <em>recently</em>: g·∫ßn ƒë√¢y. C·ª•m "recently published" (xu·∫•t b·∫£n g·∫ßn ƒë√¢y) r·∫•t hay d√πng cho s√°ch b√°o, nghi√™n c·ª©u.<br>
                    A. <em>lately</em>: g·∫ßn ƒë√¢y (th∆∞·ªùng ƒë·ª©ng cu·ªëi c√¢u, √≠t khi b·ªï nghƒ©a tr·ª±c ti·∫øp cho qu√° kh·ª© ph√¢n t·ª´ nh∆∞ published).<br>
                    C. <em>lastly</em>: cu·ªëi c√πng (d√πng khi li·ªát k√™).<br>
                    D. <em>freshly</em>: t∆∞∆°i m·ªõi (d√πng cho th·ª±c ph·∫©m, s∆°n...).
                `
            },
            {
                id: 4,
                text: "The scientists looked at satellite (4)‚Ä¶‚Ä¶‚Ä¶‚Ä¶‚Ä¶ of clouds...",
                options: ["images", "figures", "aspects", "portraits"],
                answer: 0, // A
                explanation: `
                    <strong>Collocation:</strong><br>
                    <em>Satellite images</em>: h√¨nh ·∫£nh v·ªá tinh. ƒê√¢y l√† thu·∫≠t ng·ªØ chuy√™n ng√†nh kh√≠ t∆∞·ª£ng/ƒë·ªãa l√Ω.<br>
                    B. <em>figures</em>: s·ªë li·ªáu/nh√¢n v·∫≠t.<br>
                    C. <em>aspects</em>: kh√≠a c·∫°nh.<br>
                    D. <em>portraits</em>: ch√¢n dung (d√πng cho ng∆∞·ªùi).
                `
            },
            {
                id: 5,
                text: "...the air behind it expands and then cools (5)‚Ä¶‚Ä¶‚Ä¶‚Ä¶‚Ä¶ rapidly.",
                options: ["totally", "extremely", "entirely", "perfectly"],
                answer: 1, // B
                explanation: `
                    <strong>Tr·∫°ng t·ª´ ch·ªâ m·ª©c ƒë·ªô:</strong><br>
                    B. <em>extremely</em>: c·ª±c k·ª≥. ƒêi v·ªõi "rapidly" (nhanh ch√≥ng) ƒë·ªÉ nh·∫•n m·∫°nh t·ªëc ƒë·ªô.<br>
                    C√°c t·ª´ c√≤n l·∫°i (A, C, D) mang nghƒ©a "ho√†n to√†n" (completeness), kh√¥ng ph√π h·ª£p ƒë·ªÉ m√¥ t·∫£ t·ªëc ƒë·ªô di·ªÖn ra (gradient).
                `
            },
            {
                id: 6,
                text: "This sudden drop in temperature, (6)‚Ä¶‚Ä¶‚Ä¶‚Ä¶‚Ä¶ with the hole formed in the cloud...",
                options: ["joined", "attached", "composed", "combined"],
                answer: 3, // D
                explanation: `
                    <strong>C·∫•u tr√∫c t·ª´ v·ª±ng:</strong><br>
                    D. <em>combined with</em>: k·∫øt h·ª£p v·ªõi (t·∫°o ra k·∫øt qu·∫£ chung).<br>
                    A. <em>joined</em>: n·ªëi l·∫°i (v·∫≠t l√Ω).<br>
                    B. <em>attached to</em>: ƒë√≠nh k√®m v√†o.<br>
                    C. <em>composed of</em>: bao g·ªìm.
                `
            },
            {
                id: 7,
                text: "...can increase the (7)‚Ä¶‚Ä¶‚Ä¶‚Ä¶‚Ä¶ of rain or snow on the ground.",
                options: ["forecasts", "certainties", "chances", "opportunities"],
                answer: 2, // C
                explanation: `
                    <strong>Ng·ªØ nghƒ©a:</strong><br>
                    C. <em>chances</em>: kh·∫£ nƒÉng (x·∫£y ra vi·ªác g√¨ ƒë√≥). "Increase the chances of..." l√† c·ª•m t·ª´ ƒë√∫ng.<br>
                    A. <em>forecasts</em>: d·ª± b√°o (kh√¥ng th·ªÉ "tƒÉng d·ª± b√°o").<br>
                    B. <em>certainties</em>: s·ª± ch·∫Øc ch·∫Øn (kh√¥ng ph√π h·ª£p ng·ªØ c·∫£nh x√°c su·∫•t).<br>
                    D. <em>opportunities</em>: c∆° h·ªôi (th∆∞·ªùng mang nghƒ©a t√≠ch c·ª±c, trong khi m∆∞a/tuy·∫øt ·ªü ƒë√¢y l√† hi·ªán t∆∞·ª£ng t·ª± nhi√™n trung t√≠nh/ti√™u c·ª±c).
                `
            },
            {
                id: 8,
                text: "...this can have a significant (8)‚Ä¶‚Ä¶‚Ä¶‚Ä¶‚Ä¶ on weather patterns...",
                options: ["result", "influence", "consequence", "impression"],
                answer: 1, // B
                explanation: `
                    <strong>Gi·ªõi t·ª´ ƒëi k√®m (Preposition):</strong><br>
                    B. <em>influence on</em>: ·∫£nh h∆∞·ªüng l√™n c√°i g√¨.<br>
                    A. <em>result of/in</em> (k·∫øt qu·∫£).<br>
                    C. <em>consequence of</em> (h·∫≠u qu·∫£).<br>
                    D. <em>impression on</em> (·∫•n t∆∞·ª£ng - d√πng cho t√¢m l√Ω/ng∆∞·ªùi).
                `
            },
            {
                id: 9,
                text: "...aircraft passing through clouds are (9)‚Ä¶‚Ä¶‚Ä¶‚Ä¶‚Ä¶ to affect the global climate.",
                options: ["doubtful", "unsure", "unlikely", "improbable"],
                answer: 2, // C
                explanation: `
                    <strong>C·∫•u tr√∫c ng·ªØ ph√°p:</strong><br>
                    C. <em>unlikely + to V</em>: √≠t c√≥ kh·∫£ nƒÉng l√†m g√¨. ƒê√¢y l√† t·ª´ duy nh·∫•t trong 4 ƒë√°p √°n ƒëi tr·ª±c ti·∫øp v·ªõi <em>to infinitive</em> theo c√°ch n√†y.<br>
                    A. <em>doubtful about</em>.<br>
                    B. <em>unsure of/about</em>.<br>
                    D. <em>improbable</em>: th∆∞·ªùng d√πng ch·ªß ng·ªØ gi·∫£ (It is improbable that...).
                `
            }
        ];

        let score = 0;
        let answeredCount = 0;
        let timerInterval;
        let timeRemaining = 600; // 10 minutes in seconds
        let isTimerRunning = false;

        // --- AUDIO ---
        const audioCorrect = new Audio('data:audio/mp3;base64,//NExAAAAania...'); // Placeholder used logic below instead
        // Creating simple beeps using AudioContext to keep file single & small
        const audioCtx = new (window.AudioContext || window.webkitAudioContext)();
        
        function playSound(type) {
            if (audioCtx.state === 'suspended') audioCtx.resume();
            const osc = audioCtx.createOscillator();
            const gainNode = audioCtx.createGain();
            osc.connect(gainNode);
            gainNode.connect(audioCtx.destination);

            if (type === 'correct') {
                osc.type = 'sine';
                osc.frequency.setValueAtTime(500, audioCtx.currentTime);
                osc.frequency.exponentialRampToValueAtTime(1000, audioCtx.currentTime + 0.1);
                gainNode.gain.setValueAtTime(0.3, audioCtx.currentTime);
                gainNode.gain.exponentialRampToValueAtTime(0.01, audioCtx.currentTime + 0.5);
                osc.start();
                osc.stop(audioCtx.currentTime + 0.5);
            } else {
                osc.type = 'sawtooth';
                osc.frequency.setValueAtTime(150, audioCtx.currentTime);
                osc.frequency.linearRampToValueAtTime(100, audioCtx.currentTime + 0.3);
                gainNode.gain.setValueAtTime(0.3, audioCtx.currentTime);
                gainNode.gain.exponentialRampToValueAtTime(0.01, audioCtx.currentTime + 0.3);
                osc.start();
                osc.stop(audioCtx.currentTime + 0.3);
            }
        }

        // --- RENDER QUIZ ---
        function renderQuiz() {
            const container = document.getElementById('quiz-container');
            questions.forEach((q, index) => {
                const card = document.createElement('div');
                card.className = 'question-card';
                card.id = `card-${index}`;

                const letters = ['A', 'B', 'C', 'D'];
                let optionsHtml = '';
                q.options.forEach((opt, i) => {
                    optionsHtml += `
                        <button class="option-btn" onclick="checkAnswer(${index}, ${i}, this)">
                            <span style="font-weight:800; color:var(--primary-dark)">${letters[i]}.</span> ${opt}
                        </button>
                    `;
                });

                card.innerHTML = `
                    <div class="q-header">QUESTION ${index + 1}</div>
                    <div class="q-text">${q.text}</div>
                    <div class="options-grid">
                        ${optionsHtml}
                    </div>
                    <div class="explanation-box" id="explain-${index}">
                        <div class="explanation-header">üí° GI·∫¢I TH√çCH CHI TI·∫æT (C√¥ Mai An):</div>
                        <div class="explanation-detail">${q.explanation}</div>
                    </div>
                `;
                container.appendChild(card);
            });

            // Add Submit Button
            const submitDiv = document.createElement('div');
            submitDiv.className = 'submit-section';
            submitDiv.innerHTML = `<button class="btn-submit" onclick="submitQuiz()">N·ªòP B√ÄI & XEM ƒêI·ªÇM</button>`;
            container.appendChild(submitDiv);
        }

        // --- INTERACTION LOGIC ---
        function checkAnswer(qIndex, optIndex, btn) {
            const qData = questions[qIndex];
            const card = document.getElementById(`card-${qIndex}`);
            const buttons = card.querySelectorAll('.option-btn');
            const explanation = document.getElementById(`explain-${qIndex}`);

            // Disable all buttons in this card
            buttons.forEach(b => b.disabled = true);

            if (optIndex === qData.answer) {
                // Correct
                btn.classList.add('correct');
                playSound('correct');
                score++;
                fireConfetti(btn);
            } else {
                // Wrong
                btn.classList.add('wrong');
                playSound('wrong');
                // Highlight correct one
                buttons[qData.answer].classList.add('correct');
            }

            answeredCount++;
            // Show Explanation
            explanation.style.display = 'block';
        }

        function toggleTranslation() {
            const div = document.getElementById('translation');
            const btn = document.querySelector('.btn-translate');
            if (div.style.display === 'block') {
                div.style.display = 'none';
                btn.innerText = 'üåê Xem B·∫£n D·ªãch ƒê·∫ßy ƒê·ªß (Ti·∫øng Vi·ªát)';
            } else {
                div.style.display = 'block';
                btn.innerText = 'üîΩ ·∫®n B·∫£n D·ªãch';
            }
        }

        function submitQuiz() {
            const modal = document.getElementById('modal-result');
            const scoreDisplay = document.getElementById('final-score');
            const msg = document.getElementById('final-msg');

            scoreDisplay.innerText = `${score}/${questions.length}`;

            // Personalized feedback
            const percentage = (score / questions.length) * 100;
            if (percentage === 100) msg.innerText = "Tuy·ªát v·ªùi! B·∫°n ƒë√∫ng l√† thi√™n t√†i ti·∫øng Anh!";
            else if (percentage >= 80) msg.innerText = "L√†m t·ªët l·∫Øm! B·∫°n n·∫Øm r·∫•t ch·∫Øc ki·∫øn th·ª©c.";
            else if (percentage >= 50) msg.innerText = "Kh√° t·ªët, nh∆∞ng h√£y xem k·ªπ l·∫°i ph·∫ßn gi·∫£i th√≠ch nh√©!";
            else msg.innerText = "C·ªë l√™n nh√©! ƒê·ª´ng n·∫£n l√≤ng, h√£y h·ªçc k·ªπ t·ª´ v·ª±ng trong b√†i.";

            modal.style.display = 'flex';
            if (percentage >= 80) fireConfettiFull();
        }

        // --- TIMER ---
        function toggleTimer() {
            const btn = document.getElementById('btn-timer');
            if (isTimerRunning) {
                clearInterval(timerInterval);
                isTimerRunning = false;
                btn.innerText = "TI·∫æP T·ª§C";
                btn.style.backgroundColor = "#f59e0b"; // Warning color
            } else {
                isTimerRunning = true;
                btn.innerText = "T·∫†M D·ª™NG";
                btn.style.backgroundColor = "#ef4444";
                
                timerInterval = setInterval(() => {
                    timeRemaining--;
                    updateTimerDisplay();
                    if (timeRemaining <= 0) {
                        clearInterval(timerInterval);
                        document.getElementById('modal-timeout').style.display = 'flex';
                        playSound('wrong'); // Alert sound
                    }
                }, 1000);
            }
        }

        function updateTimerDisplay() {
            const m = Math.floor(timeRemaining / 60);
            const s = timeRemaining % 60;
            document.getElementById('timer-display').innerText = 
                `${m.toString().padStart(2, '0')}:${s.toString().padStart(2, '0')}`;
        }

        function closeModal(id) {
            document.getElementById(id).style.display = 'none';
        }

        // --- CONFETTI EFFECT (Minimal Version) ---
        function fireConfetti(element) {
            // Check bounding client rect for origin, but simple full screen burst is easier
            fireConfettiFull(0.5); // Small burst
        }

        function fireConfettiFull(duration_sec = 2) {
            const canvas = document.getElementById('confetti-canvas');
            const ctx = canvas.getContext('2d');
            canvas.width = window.innerWidth;
            canvas.height = window.innerHeight;

            const particles = [];
            const colors = ['#f44336', '#e91e63', '#9c27b0', '#673ab7', '#3f51b5', '#2196f3', '#03a9f4', '#00bcd4', '#009688', '#4CAF50', '#8BC34A', '#CDDC39', '#FFEB3B', '#FFC107', '#FF9800', '#FF5722'];

            for (let i = 0; i < 150; i++) {
                particles.push({
                    x: canvas.width / 2,
                    y: canvas.height / 2,
                    w: Math.random() * 10 + 5,
                    h: Math.random() * 10 + 5,
                    vx: (Math.random() - 0.5) * 20,
                    vy: (Math.random() - 0.5) * 20,
                    color: colors[Math.floor(Math.random() * colors.length)],
                    life: 100
                });
            }

            function draw() {
                ctx.clearRect(0, 0, canvas.width, canvas.height);
                let active = false;
                particles.forEach(p => {
                    if (p.life > 0) {
                        p.x += p.vx;
                        p.y += p.vy;
                        p.vy += 0.5; // Gravity
                        p.life--;
                        ctx.fillStyle = p.color;
                        ctx.fillRect(p.x, p.y, p.w, p.h);
                        active = true;
                    }
                });
                if (active) requestAnimationFrame(draw);
                else ctx.clearRect(0,0,canvas.width, canvas.height);
            }
            draw();
        }

        // Init
        renderQuiz();

    </script>
</body>
</html>