<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Reading Test - Ms Mai An ULIS</title>
    <link href="https://fonts.googleapis.com/css2?family=Quicksand:wght@500;700;900&display=swap" rel="stylesheet">
    <style>
        /* === DYNAMIC THEME & GAMIFICATION BACKGROUND (NATURE/RUNNING THEME) === */
        :root {
            --primary-bg: #e8f8f5;
            --correct-color: #00D26A;
            --correct-shadow: #00A653;
            --wrong-color: #FF4757;
            --wrong-shadow: #D93845;
            --option-bg: #ffffff;
            --option-shadow: #e5e5e5;
            --text-main: #2d3436;
        }

        body {
            margin: 0;
            font-family: 'Quicksand', sans-serif;
            /* Ph·ªëi m√†u Thi√™n nhi√™n: Mint Green, Light Green, Sky Blue, Sunlight Yellow */
            background: linear-gradient(-45deg, #00b894, #55efc4, #74b9ff, #ffeaa7);
            background-size: 400% 400%;
            animation: gradientMove 15s ease infinite;
            color: var(--text-main);
            height: 100vh;
            display: flex;
            flex-direction: column;
            overflow: hidden;
            position: relative;
        }

        /* Animated Emoji Background based on 'Nature/Running' Theme */
        body::before {
            content: "";
            position: absolute;
            top: -50%; left: -50%; width: 200%; height: 200%;
            background-image: url('data:image/svg+xml;utf8,<svg xmlns="http://www.w3.org/2000/svg" width="250" height="250"><text x="20" y="40" font-size="40" opacity="0.6">‚òÅÔ∏è</text><text x="150" y="100" font-size="40" opacity="0.6">üå≤</text><text x="80" y="200" font-size="40" opacity="0.6">‚õ∞Ô∏è</text><text x="200" y="220" font-size="40" opacity="0.6">üèÉ</text></svg>');
            animation: floatPattern 40s linear infinite;
            pointer-events: none;
            z-index: 0;
            mix-blend-mode: overlay;
        }

        @keyframes gradientMove {
            0% { background-position: 0% 50%; }
            50% { background-position: 100% 50%; }
            100% { background-position: 0% 50%; }
        }

        @keyframes floatPattern {
            0% { transform: rotate(0deg) translate(0, 0); }
            100% { transform: rotate(360deg) translate(-100px, -100px); }
        }

        /* === TOP CONTROL BAR === */
        #top-bar {
            height: 50px; /* Thu nh·ªè chi·ªÅu cao header */
            background: rgba(255, 255, 255, 0.95);
            box-shadow: 0 4px 15px rgba(0,0,0,0.1);
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 0 30px;
            z-index: 10;
            position: relative;
        }

        .header-title {
            font-weight: 700;
            color: #00b894;
            font-size: 1rem; /* Ch·ªØ nh·ªè ƒë·ªÉ kh√¥ng chi·∫øm giao di·ªán */
            margin: 0;
        }

        .timer-container {
            display: flex;
            align-items: center;
            gap: 15px;
        }

        #timer-display {
            font-size: 1.3rem;
            font-weight: 900;
            color: #FF4757;
            background: #ffeaa7;
            padding: 5px 15px;
            border-radius: 12px;
            border: 2px solid #fdcb6e;
        }

        .btn-gamify {
            background: #00b894;
            color: white;
            border: none;
            padding: 8px 16px;
            font-size: 1rem;
            font-weight: 700;
            font-family: 'Quicksand', sans-serif;
            border-radius: 12px;
            box-shadow: 0 4px 0 #009376;
            cursor: pointer;
            transition: all 0.1s;
        }
        .btn-gamify:active {
            transform: translateY(4px);
            box-shadow: 0 0 0 #009376;
        }
        
        /* === SPLIT SCREEN === */
        #main-container {
            display: flex;
            flex: 1;
            overflow: hidden;
            z-index: 1;
            padding: 20px;
            gap: 20px;
        }

        .panel {
            flex: 1;
            background: rgba(255, 255, 255, 0.92);
            border-radius: 20px;
            padding: 30px;
            overflow-y: auto;
            box-shadow: 0 10px 30px rgba(0,0,0,0.15);
            backdrop-filter: blur(10px);
            border: 3px solid rgba(255,255,255,0.5);
        }

        /* Custom Scrollbar */
        ::-webkit-scrollbar { width: 10px; }
        ::-webkit-scrollbar-track { background: #f1f1f1; border-radius: 10px; }
        ::-webkit-scrollbar-thumb { background: #00b894; border-radius: 10px; }
        ::-webkit-scrollbar-thumb:hover { background: #009376; }

        /* === READING PASSAGE PANEL === */
        .passage-title {
            font-size: 2rem;
            color: #0984e3;
            text-align: center;
            margin-bottom: 20px;
            font-weight: 900;
        }

        .paragraph-container {
            margin-bottom: 25px;
            line-height: 1.7;
            font-size: 1.15rem;
        }

        .btn-translate {
            background: #74b9ff;
            box-shadow: 0 4px 0 #0984e3;
            font-size: 0.9rem;
            padding: 5px 15px;
            margin-top: 10px;
        }

        .translation-text {
            display: none;
            background: #e8f8f5;
            border-left: 5px solid #00b894;
            padding: 15px;
            margin-top: 10px;
            border-radius: 0 10px 10px 0;
            color: #2d3436;
            font-style: italic;
        }

        /* === GLOSSARY TABLE === */
        .glossary-wrapper {
            margin-top: 40px;
            background: #fff;
            border-radius: 15px;
            padding: 20px;
            box-shadow: 0 5px 15px rgba(0,0,0,0.05);
            border: 2px dashed #00b894;
        }
        .glossary-wrapper h3 {
            color: #00b894;
            text-align: center;
            font-size: 1.5rem;
            margin-top: 0;
        }
        table {
            width: 100%;
            border-collapse: collapse;
            font-size: 1.05rem;
        }
        th, td {
            padding: 12px;
            text-align: left;
            border-bottom: 1px solid #eee;
        }
        th { background: #00b894; color: white; border-radius: 5px; }
        .word-col { font-weight: bold; color: #0984e3; }
        .type-col { color: #e17055; font-style: italic; }

        /* === EXERCISES PANEL === */
        .question-card {
            background: white;
            border-radius: 20px;
            padding: 25px;
            margin-bottom: 30px;
            box-shadow: 0 8px 0 #e5e5e5;
            border: 2px solid #f1f1f1;
        }
        
        .question-text {
            font-size: 1.3rem;
            font-weight: 800;
            margin-bottom: 20px;
            color: #2d3436;
        }

        .options-grid {
            display: flex;
            flex-direction: column;
            gap: 15px;
        }

        .option-btn {
            background: var(--option-bg);
            border: 2px solid #e5e5e5;
            padding: 15px 20px;
            border-radius: 15px;
            font-size: 1.15rem;
            font-family: 'Quicksand', sans-serif;
            font-weight: 700;
            color: #2d3436;
            text-align: left;
            cursor: pointer;
            box-shadow: 0 5px 0 var(--option-shadow);
            transition: all 0.1s ease;
            display: flex;
            align-items: center;
        }
        .option-btn:hover {
            transform: scale(1.02);
            border-color: #00b894;
        }
        .option-btn:active {
            transform: translateY(5px) scale(1.02);
            box-shadow: 0 0 0 transparent;
        }

        /* States */
        .option-btn.correct {
            background: var(--correct-color);
            color: white;
            border-color: var(--correct-color);
            box-shadow: 0 5px 0 var(--correct-shadow);
        }
        .option-btn.wrong {
            background: var(--wrong-color);
            color: white;
            border-color: var(--wrong-color);
            box-shadow: 0 5px 0 var(--wrong-shadow);
            animation: shake 0.4s cubic-bezier(.36,.07,.19,.97) both;
        }

        @keyframes shake {
            10%, 90% { transform: translate3d(-1px, 0, 0); }
            20%, 80% { transform: translate3d(2px, 0, 0); }
            30%, 50%, 70% { transform: translate3d(-4px, 0, 0); }
            40%, 60% { transform: translate3d(4px, 0, 0); }
        }

        /* Explanation Box */
        .explanation-box {
            display: none;
            margin-top: 20px;
            padding: 20px;
            background: #fff3cd;
            border-left: 6px solid #fdcb6e;
            border-radius: 10px;
            font-size: 1.05rem;
            line-height: 1.6;
            animation: fadeIn 0.5s ease;
        }
        .explanation-box h4 {
            margin-top: 0;
            color: #d35400;
            font-size: 1.2rem;
        }
        .exp-highlight { font-weight: bold; color: #0984e3; }
        .exp-translation { font-style: italic; color: #27ae60; background: #e8f8f5; padding: 5px; border-radius: 5px;}

        @keyframes fadeIn { from {opacity: 0; transform: translateY(-10px);} to {opacity: 1; transform: translateY(0);} }

        /* Submit Button */
        #btn-submit {
            display: block;
            width: 100%;
            background: #0984e3;
            color: white;
            text-align: center;
            font-size: 1.5rem;
            padding: 20px;
            border-radius: 20px;
            box-shadow: 0 8px 0 #074b83;
            border: none;
            cursor: pointer;
            font-family: 'Quicksand', sans-serif;
            font-weight: 900;
            margin-top: 30px;
            transition: all 0.2s;
        }
        #btn-submit:active { transform: translateY(8px); box-shadow: 0 0 0 transparent; }

        /* === RESULT MODAL === */
        #result-modal {
            display: none;
            position: fixed;
            top: 0; left: 0; width: 100%; height: 100%;
            background: rgba(0,0,0,0.8);
            z-index: 1000;
            justify-content: center;
            align-items: center;
            backdrop-filter: blur(5px);
        }
        .modal-content {
            background: white;
            padding: 50px;
            border-radius: 30px;
            text-align: center;
            max-width: 500px;
            width: 90%;
            box-shadow: 0 15px 50px rgba(0,0,0,0.5);
            animation: popIn 0.5s cubic-bezier(0.175, 0.885, 0.32, 1.275);
        }
        @keyframes popIn { 0% {transform: scale(0.5); opacity: 0;} 100% {transform: scale(1); opacity: 1;} }
        
        .score-circle {
            width: 150px; height: 150px;
            background: linear-gradient(135deg, #00b894, #0984e3);
            border-radius: 50%;
            display: flex;
            justify-content: center;
            align-items: center;
            margin: 0 auto 20px;
            color: white;
            font-size: 3rem;
            font-weight: 900;
            border: 10px solid #e8f8f5;
            box-shadow: 0 10px 20px rgba(0,0,0,0.2);
        }
        .feedback-text { font-size: 1.8rem; font-weight: 900; color: #00b894; margin-bottom: 10px;}
        .sub-feedback { font-size: 1.1rem; color: #636e72; margin-bottom: 30px;}
        
        /* Confetti Canvas */
        #confetti-container {
            position: fixed; top: 0; left: 0; width: 100%; height: 100%;
            pointer-events: none; z-index: 999;
        }
        .confetti-piece {
            position: absolute;
            width: 10px; height: 20px;
            background: #ffd300;
            animation: fall 3s linear forwards;
        }
        @keyframes fall {
            to { transform: translateY(100vh) rotate(720deg); }
        }

    </style>
</head>
<body>

    <div id="confetti-container"></div>

    <div id="top-bar">
        <h3 class="header-title">Gi√°o vi√™n t·∫°o: Ms Mai An ULIS</h3>
        <div class="timer-container">
            <div id="timer-display">10:00</div>
            <button id="btn-timer" class="btn-gamify">B·∫ÆT ƒê·∫¶U T√çNH GI·ªú</button>
        </div>
    </div>

    <div id="main-container">
        
        <div class="panel" id="left-panel">
            <h1 class="passage-title">‚õ∞Ô∏è How I spend my free time üèÉ</h1>
            
            <div class="paragraph-container">
                <div class="text-content">
                    Hill running is the sport of running up and down hills and mountains, through open countryside. It‚Äôs not popular among my friends, but I love it. My dad took me and my brothers out running when we were little, and then when I was about fifteen, I joined a hill running club, called the York Merlins.
                </div>
                <button class="btn-gamify btn-translate" onclick="toggleTranslation(this)">B·∫¢N D·ªäCH ƒê·∫¶Y ƒê·ª¶</button>
                <div class="translation-text">Ch·∫°y tr√™n ƒë·ªìi l√† m√¥n th·ªÉ thao ch·∫°y l√™n v√† xu·ªëng c√°c ng·ªçn ƒë·ªìi v√† n√∫i, xuy√™n qua nh·ªØng v√πng n√¥ng th√¥n r·ªông m·ªü. N√≥ kh√¥ng ph·ªï bi·∫øn trong ƒë√°m b·∫°n c·ªßa t√¥i, nh∆∞ng t√¥i l·∫°i y√™u th√≠ch n√≥. B·ªë ƒë√£ ƒë∆∞a t√¥i v√† c√°c anh em ƒëi ch·∫°y khi ch√∫ng t√¥i c√≤n nh·ªè, v√† sau ƒë√≥ khi t√¥i kho·∫£ng 15 tu·ªïi, t√¥i ƒë√£ tham gia m·ªôt c√¢u l·∫°c b·ªô ch·∫°y tr√™n ƒë·ªìi c√≥ t√™n l√† York Merlins.</div>
            </div>

            <div class="paragraph-container">
                <div class="text-content">
                    There are some excellent runners in the club. When we do our practice runs, I‚Äôm always a long way behind them. But that doesn‚Äôt bother me. They‚Äôre all really nice and often give me advice. What I love is being outdoors and finding all these beautiful places I never knew were there.
                </div>
                <button class="btn-gamify btn-translate" onclick="toggleTranslation(this)">B·∫¢N D·ªäCH ƒê·∫¶Y ƒê·ª¶</button>
                <div class="translation-text">C√≥ m·ªôt s·ªë v·∫≠n ƒë·ªông vi√™n ch·∫°y r·∫•t xu·∫•t s·∫Øc trong c√¢u l·∫°c b·ªô. Khi ch√∫ng t√¥i ch·∫°y t·∫≠p luy·ªán, t√¥i lu√¥n b·ªã b·ªè l·∫°i m·ªôt kho·∫£ng r·∫•t xa ph√≠a sau h·ªç. Nh∆∞ng ƒëi·ªÅu ƒë√≥ kh√¥ng l√†m t√¥i b·∫≠n t√¢m. H·ªç ƒë·ªÅu r·∫•t t·ª≠ t·∫ø v√† th∆∞·ªùng cho t√¥i l·ªùi khuy√™n. ƒêi·ªÅu t√¥i y√™u th√≠ch l√† ƒë∆∞·ª£c ·ªü ngo√†i tr·ªùi v√† kh√°m ph√° ra t·∫•t c·∫£ nh·ªØng ƒë·ªãa ƒëi·ªÉm tuy·ªát ƒë·∫πp m√† t√¥i ch∆∞a t·ª´ng bi·∫øt l√† ch√∫ng t·ªìn t·∫°i.</div>
            </div>

            <div class="paragraph-container">
                <div class="text-content">
                    We race against other clubs at the weekends. In these races, runners are told where to finish, but not how to get there. You need a good map and compass so you don‚Äôt get lost. Everyone starts together at the beginning, but later in the race you often find yourself running alone.
                </div>
                <button class="btn-gamify btn-translate" onclick="toggleTranslation(this)">B·∫¢N D·ªäCH ƒê·∫¶Y ƒê·ª¶</button>
                <div class="translation-text">Ch√∫ng t√¥i thi ƒë·∫•u v·ªõi c√°c c√¢u l·∫°c b·ªô kh√°c v√†o d·ªãp cu·ªëi tu·∫ßn. Trong nh·ªØng cu·ªôc ƒëua n√†y, ng∆∞·ªùi ch·∫°y ƒë∆∞·ª£c cho bi·∫øt v·∫°ch ƒë√≠ch ·ªü ƒë√¢u, nh∆∞ng kh√¥ng ƒë∆∞·ª£c ch·ªâ c√°ch l√†m th·∫ø n√†o ƒë·ªÉ ƒë·∫øn ƒë√≥. B·∫°n c·∫ßn m·ªôt b·∫£n ƒë·ªì v√† la b√†n t·ªët ƒë·ªÉ kh√¥ng b·ªã l·∫°c. M·ªçi ng∆∞·ªùi ƒë·ªÅu xu·∫•t ph√°t c√πng nhau ·ªü v·∫°ch xu·∫•t ph√°t, nh∆∞ng sau ƒë√≥ trong cu·ªôc ƒëua, b·∫°n th∆∞·ªùng th·∫•y m√¨nh ƒëang ph·∫£i ch·∫°y m·ªôt m√¨nh.</div>
            </div>

            <div class="paragraph-container">
                <div class="text-content">
                    Anyone can enter these races ‚Äì you just get there in the morning, pay your ¬£5, and run. There are no T-shirts or medals for the winners. The most you get is a piece of cake! Often there are international hill running champions taking part, but they are just as friendly as everyone else.
                </div>
                <button class="btn-gamify btn-translate" onclick="toggleTranslation(this)">B·∫¢N D·ªäCH ƒê·∫¶Y ƒê·ª¶</button>
                <div class="translation-text">B·∫•t c·ª© ai c≈©ng c√≥ th·ªÉ tham gia nh·ªØng cu·ªôc ƒëua n√†y ‚Äì b·∫°n ch·ªâ c·∫ßn ƒë·∫øn ƒë√≥ v√†o bu·ªïi s√°ng, tr·∫£ 5 b·∫£ng Anh, v√† ch·∫°y. Kh√¥ng c√≥ √°o ph√¥ng hay huy ch∆∞∆°ng n√†o cho ng∆∞·ªùi chi·∫øn th·∫Øng. Th·ª© tuy·ªát nh·∫•t b·∫°n nh·∫≠n ƒë∆∞·ª£c l√† m·ªôt mi·∫øng b√°nh! Th∆∞·ªùng c√≥ c√°c nh√† v√¥ ƒë·ªãch ch·∫°y ƒë·ªìi qu·ªëc t·∫ø tham gia, nh∆∞ng h·ªç c≈©ng th√¢n thi·ªán nh∆∞ bao ng∆∞·ªùi kh√°c.</div>
            </div>

            <div class="paragraph-container">
                <div class="text-content">
                    That doesn‚Äôt mean it‚Äôs an easy sport. Last weekend I did a race in heavy rain and high winds, and I was asking myself what I was doing out there. But I got to the end, and that was an amazing feeling.
                </div>
                <button class="btn-gamify btn-translate" onclick="toggleTranslation(this)">B·∫¢N D·ªäCH ƒê·∫¶Y ƒê·ª¶</button>
                <div class="translation-text">ƒêi·ªÅu ƒë√≥ kh√¥ng c√≥ nghƒ©a ƒë√¢y l√† m·ªôt m√¥n th·ªÉ thao d·ªÖ d√†ng. Cu·ªëi tu·∫ßn tr∆∞·ªõc, t√¥i ƒë√£ tham gia m·ªôt cu·ªôc ƒëua d∆∞·ªõi tr·ªùi m∆∞a to v√† gi√≥ l·ªõn, v√† t√¥i ƒë√£ t·ª± h·ªèi m√¨nh ƒëang l√†m c√°i qu√°i g√¨ ngo√†i ƒë√≥. Nh∆∞ng t√¥i ƒë√£ v·ªÅ ƒë·∫øn ƒë√≠ch, v√† ƒë√≥ l√† m·ªôt c·∫£m gi√°c th·∫≠t tuy·ªát v·ªùi.</div>
            </div>

            <div class="glossary-wrapper">
                <h3>üìö Academic Glossary (B·∫£ng T·ª´ V·ª±ng B1-C2)</h3>
                <table>
                    <thead>
                        <tr>
                            <th>Vocabulary (T·ª´ v·ª±ng)</th>
                            <th>Part of Speech (Lo·∫°i t·ª´)</th>
                            <th>Vietnamese Meaning (Nghƒ©a)</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr><td class="word-col">1. Countryside</td><td class="type-col">noun (n)</td><td>V√πng n√¥ng th√¥n, ƒë·ªìng qu√™ (B1)</td></tr>
                        <tr><td class="word-col">2. Excellent</td><td class="type-col">adjective (adj)</td><td>Xu·∫•t s·∫Øc, tuy·ªát v·ªùi (A2/B1)</td></tr>
                        <tr><td class="word-col">3. Bother</td><td class="type-col">verb (v)</td><td>L√†m phi·ªÅn, g√¢y b·∫≠n t√¢m (B1)</td></tr>
                        <tr><td class="word-col">4. Outdoors</td><td class="type-col">adverb (adv)</td><td>Ngo√†i tr·ªùi (B1)</td></tr>
                        <tr><td class="word-col">5. Compass</td><td class="type-col">noun (n)</td><td>C√°i la b√†n (B2)</td></tr>
                        <tr><td class="word-col">6. International</td><td class="type-col">adjective (adj)</td><td>Qu·ªëc t·∫ø (B1)</td></tr>
                        <tr><td class="word-col">7. Champion</td><td class="type-col">noun (n)</td><td>Nh√† v√¥ ƒë·ªãch, qu√°n qu√¢n (B1)</td></tr>
                        <tr><td class="word-col">8. Enter (a race)</td><td class="type-col">verb (v)</td><td>ƒêƒÉng k√Ω tham gia (m·ªôt cu·ªôc thi) (B1)</td></tr>
                        <tr><td class="word-col">9. Heavy rain</td><td class="type-col">noun phrase</td><td>M∆∞a l·ªõn, m∆∞a n·∫∑ng h·∫°t (A2/B1)</td></tr>
                        <tr><td class="word-col">10. Amazing</td><td class="type-col">adjective (adj)</td><td>Tuy·ªát v·ªùi, ƒë√°ng kinh ng·∫°c (B1)</td></tr>
                    </tbody>
                </table>
            </div>
        </div>

        <div class="panel" id="right-panel">
            <div id="quiz-container"></div>
            <button id="btn-submit" onclick="submitTest()">üéâ N·ªòP B√ÄI üéâ</button>
        </div>
    </div>

    <div id="result-modal">
        <div class="modal-content">
            <div class="score-circle" id="final-score">0/5</div>
            <div class="feedback-text" id="final-feedback">Tuy·ªát V·ªùi!</div>
            <div class="sub-feedback" id="final-sub">C√¥ Mai An r·∫•t t·ª± h√†o v·ªÅ b·∫°n!</div>
            <button class="btn-gamify" style="width:100%; font-size: 1.2rem;" onclick="location.reload()">L√†m L·∫°i L·∫ßn N·ªØa</button>
        </div>
    </div>

    <script>
        // --- DATA B√ÄI T·∫¨P & GI·∫¢I TH√çCH CHI TI·∫æT ---
        const quizData = [
            {
                id: 1,
                question: "1. Jay‚Äôs first experience of hill running was with",
                options: [
                    { text: "his family.", isCorrect: true },
                    { text: "a club.", isCorrect: false },
                    { text: "some friends.", isCorrect: false }
                ],
                explanation: `
                    <h4>GI·∫¢I TH√çCH CHI TI·∫æT C√ÇU 1:</h4>
                    <p><b>1. D·ªãch c√¢u h·ªèi:</b> Tr·∫£i nghi·ªám ch·∫°y tr√™n ƒë·ªìi ƒë·∫ßu ti√™n c·ªßa Jay l√† v·ªõi ai?</p>
                    <p><b>2. D·∫´n ch·ª©ng trong b√†i:</b> ƒêo·∫°n 1: <span class="exp-highlight">"My dad took me and my brothers out running when we were little..."</span></p>
                    <p class="exp-translation">-> D·ªãch: "B·ªë ƒë√£ ƒë∆∞a t√¥i v√† c√°c anh em ƒëi ch·∫°y khi ch√∫ng t√¥i c√≤n nh·ªè..."</p>
                    <p><b>3. Ph√¢n t√≠ch:</b></p>
                    <ul>
                        <li><b>Ch·ªçn ƒë√°p √°n "his family" (gia ƒë√¨nh anh ·∫•y)</b> v√¨ B·ªë (dad) v√† c√°c anh em (brothers) ch√≠nh l√† nh·ªØng th√†nh vi√™n trong gia ƒë√¨nh.</li>
                        <li>Lo·∫°i "a club" v√¨ anh ·∫•y ch·ªâ tham gia c√¢u l·∫°c b·ªô khi 15 tu·ªïi, ƒë√≥ kh√¥ng ph·∫£i l√† l·∫ßn tr·∫£i nghi·ªám ƒë·∫ßu ti√™n.</li>
                        <li>Lo·∫°i "some friends" v√¨ b√†i ƒë·ªçc n√≥i m√¥n th·ªÉ thao n√†y kh√¥ng ph·ªï bi·∫øn v·ªõi b·∫°n b√® anh ·∫•y (not popular among my friends).</li>
                    </ul>
                `
            },
            {
                id: 2,
                question: "2. How does Jay feel about the good runners in his club?",
                options: [
                    { text: "He doesn‚Äôt mind that they are better than him.", isCorrect: true },
                    { text: "He‚Äôd like to be as fast as them one day.", isCorrect: false },
                    { text: "He thinks they should help slower runners improve.", isCorrect: false }
                ],
                explanation: `
                    <h4>GI·∫¢I TH√çCH CHI TI·∫æT C√ÇU 2:</h4>
                    <p><b>1. D·ªãch c√¢u h·ªèi:</b> Jay c·∫£m th·∫•y th·∫ø n√†o v·ªÅ nh·ªØng v·∫≠n ƒë·ªông vi√™n ch·∫°y gi·ªèi trong c√¢u l·∫°c b·ªô?</p>
                    <p><b>2. D·∫´n ch·ª©ng trong b√†i:</b> ƒêo·∫°n 2: <span class="exp-highlight">"...I‚Äôm always a long way behind them. But that doesn‚Äôt bother me. They‚Äôre all really nice and often give me advice."</span></p>
                    <p class="exp-translation">-> D·ªãch: "...t√¥i lu√¥n b·ªã b·ªè l·∫°i m·ªôt kho·∫£ng r·∫•t xa ph√≠a sau h·ªç. Nh∆∞ng ƒëi·ªÅu ƒë√≥ kh√¥ng l√†m t√¥i b·∫≠n t√¢m. H·ªç ƒë·ªÅu r·∫•t t·ª≠ t·∫ø v√† th∆∞·ªùng cho t√¥i l·ªùi khuy√™n."</p>
                    <p><b>3. Ph√¢n t√≠ch:</b></p>
                    <ul>
                        <li><b>Ch·ªçn ƒë√°p √°n "He doesn‚Äôt mind that they are better than him" (Anh ·∫•y kh√¥ng b·∫≠n t√¢m vi·ªác h·ªç gi·ªèi h∆°n m√¨nh)</b>. "Doesn't mind" ch√≠nh l√† c√°ch n√≥i ƒë·ªìng nghƒ©a c·ªßa c·ª•m "doesn't bother me" trong b√†i ƒë·ªçc.</li>
                        <li>Lo·∫°i "He‚Äôd like to be as fast as them..." v√¨ b√†i kh√¥ng ƒë·ªÅ c·∫≠p ƒë·∫øn mong mu·ªën ch·∫°y nhanh b·∫±ng h·ªç.</li>
                        <li>Lo·∫°i "He thinks they should help..." v√¨ h·ªç v·ªën dƒ© ƒë√£ ƒëang gi√∫p ƒë·ª° anh ·∫•y r·ªìi (often give me advice), anh ·∫•y kh√¥ng h·ªÅ ƒë√≤i h·ªèi.</li>
                    </ul>
                `
            },
            {
                id: 3,
                question: "3. What does Jay say is important in the races he enters?",
                options: [
                    { text: "being able to find your way", isCorrect: true },
                    { text: "listening to the instructions", isCorrect: false },
                    { text: "staying close to other runners", isCorrect: false }
                ],
                explanation: `
                    <h4>GI·∫¢I TH√çCH CHI TI·∫æT C√ÇU 3:</h4>
                    <p><b>1. D·ªãch c√¢u h·ªèi:</b> Jay n√≥i ƒëi·ªÅu g√¨ l√† quan tr·ªçng trong c√°c cu·ªôc ƒëua m√† anh ·∫•y tham gia?</p>
                    <p><b>2. D·∫´n ch·ª©ng trong b√†i:</b> ƒêo·∫°n 3: <span class="exp-highlight">"You need a good map and compass so you don‚Äôt get lost."</span></p>
                    <p class="exp-translation">-> D·ªãch: "B·∫°n c·∫ßn m·ªôt b·∫£n ƒë·ªì v√† la b√†n t·ªët ƒë·ªÉ kh√¥ng b·ªã l·∫°c."</p>
                    <p><b>3. Ph√¢n t√≠ch:</b></p>
                    <ul>
                        <li><b>Ch·ªçn ƒë√°p √°n "being able to find your way" (c√≥ kh·∫£ nƒÉng t√¨m ƒë∆∞·ªùng)</b>. Vi·ªác mang b·∫£n ƒë·ªì v√† la b√†n ƒë·ªÉ kh√¥ng b·ªã l·∫°c ch√≠nh l√† vi·ªác t√¨m ƒë∆∞·ªùng ƒëi ƒë√∫ng.</li>
                        <li>Lo·∫°i "listening to the instructions" v√¨ kh√¥ng ai h∆∞·ªõng d·∫´n ƒë∆∞·ªùng ƒëi ("not how to get there").</li>
                        <li>Lo·∫°i "staying close to other runners" v√¨ b√†i ƒë·ªçc n√≥i ng∆∞·ªùi ch·∫°y th∆∞·ªùng xuy√™n ph·∫£i "running alone" (ch·∫°y m·ªôt m√¨nh) ch·ª© kh√¥ng ch·∫°y s√°t nhau ƒë∆∞·ª£c.</li>
                    </ul>
                `
            },
            {
                id: 4,
                question: "4. What do we learn about the races from the fourth paragraph?",
                options: [
                    { text: "They don‚Äôt have big prizes.", isCorrect: true },
                    { text: "They are only for local runners.", isCorrect: false },
                    { text: "They are free for some people to enter.", isCorrect: false }
                ],
                explanation: `
                    <h4>GI·∫¢I TH√çCH CHI TI·∫æT C√ÇU 4:</h4>
                    <p><b>1. D·ªãch c√¢u h·ªèi:</b> Ch√∫ng ta bi·∫øt ƒëi·ªÅu g√¨ v·ªÅ c√°c cu·ªôc ƒëua t·ª´ ƒëo·∫°n vƒÉn th·ª© t∆∞?</p>
                    <p><b>2. D·∫´n ch·ª©ng trong b√†i:</b> ƒêo·∫°n 4: <span class="exp-highlight">"There are no T-shirts or medals for the winners. The most you get is a piece of cake!"</span></p>
                    <p class="exp-translation">-> D·ªãch: "Kh√¥ng c√≥ √°o ph√¥ng hay huy ch∆∞∆°ng n√†o cho ng∆∞·ªùi chi·∫øn th·∫Øng. Th·ª© tuy·ªát nh·∫•t b·∫°n nh·∫≠n ƒë∆∞·ª£c l√† m·ªôt mi·∫øng b√°nh!"</p>
                    <p><b>3. Ph√¢n t√≠ch:</b></p>
                    <ul>
                        <li><b>Ch·ªçn ƒë√°p √°n "They don‚Äôt have big prizes" (Ch√∫ng kh√¥ng c√≥ c√°c gi·∫£i th∆∞·ªüng l·ªõn)</b> v√¨ ng∆∞·ªùi th·∫Øng cu·ªôc c√πng l·∫Øm ch·ªâ nh·∫≠n ƒë∆∞·ª£c mi·∫øng b√°nh ch·ª© kh√¥ng c√≥ huy ch∆∞∆°ng.</li>
                        <li>Lo·∫°i "They are only for local runners" v√¨ c√≥ c·∫£ "international champions" (nh√† v√¥ ƒë·ªãch qu·ªëc t·∫ø) tham gia.</li>
                        <li>Lo·∫°i "They are free for some people..." v√¨ b√†i nh·∫Øc r√µ "pay your ¬£5" (tr·∫£ 5 b·∫£ng Anh), t·ª©c l√† c√≥ thu ph√≠ ch·ª© kh√¥ng mi·ªÖn ph√≠.</li>
                    </ul>
                `
            },
            {
                id: 5,
                question: "5. What does Jay say about the last race he did?",
                options: [
                    { text: "He was very happy when he finished it.", isCorrect: true },
                    { text: "The bad weather made it dangerous.", isCorrect: false },
                    { text: "It wasn‚Äôt as difficult as some races he has done.", isCorrect: false }
                ],
                explanation: `
                    <h4>GI·∫¢I TH√çCH CHI TI·∫æT C√ÇU 5:</h4>
                    <p><b>1. D·ªãch c√¢u h·ªèi:</b> Jay n√≥i g√¨ v·ªÅ cu·ªôc ƒëua g·∫ßn ƒë√¢y nh·∫•t c·ªßa anh ·∫•y?</p>
                    <p><b>2. D·∫´n ch·ª©ng trong b√†i:</b> ƒêo·∫°n 5: <span class="exp-highlight">"But I got to the end, and that was an amazing feeling."</span></p>
                    <p class="exp-translation">-> D·ªãch: "Nh∆∞ng t√¥i ƒë√£ v·ªÅ ƒë·∫øn ƒë√≠ch, v√† ƒë√≥ l√† m·ªôt c·∫£m gi√°c th·∫≠t tuy·ªát v·ªùi."</p>
                    <p><b>3. Ph√¢n t√≠ch:</b></p>
                    <ul>
                        <li><b>Ch·ªçn ƒë√°p √°n "He was very happy when he finished it" (Anh ·∫•y r·∫•t vui khi ho√†n th√†nh n√≥)</b>. C·∫£m gi√°c "amazing" (tuy·ªát v·ªùi) khi "got to the end" (v·ªÅ ƒë√≠ch) ƒë·ªìng nghƒ©a v·ªõi s·ª± vui s∆∞·ªõng h·∫°nh ph√∫c.</li>
                        <li>Lo·∫°i "The bad weather made it dangerous" v√¨ b√†i ch·ªâ n√≥i th·ªùi ti·∫øt x·∫•u (m∆∞a to, gi√≥ l·ªõn) khi·∫øn anh ·∫•y bƒÉn khoƒÉn v·ªÅ l√Ω do m√¨nh tham gia ch·ª© kh√¥ng nh·∫≠n x√©t l√† nguy hi·ªÉm (dangerous).</li>
                        <li>Lo·∫°i "It wasn‚Äôt as difficult..." v√¨ ƒë√¢y r√µ r√†ng l√† m·ªôt th·ª≠ th√°ch l·ªõn khi·∫øn anh ph·∫£i t·ª± h·ªèi b·∫£n th√¢n m√¨nh ("asking myself what I was doing out there"), kh√¥ng h·ªÅ d·ªÖ d√†ng h∆°n.</li>
                    </ul>
                `
            }
        ];

        // --- GLOBAL VARIABLES ---
        let score = 0;
        let answeredQuestions = new Set();
        let timerInterval;
        let timeRemaining = 600; // 10 minutes in seconds
        let isTimerRunning = false;
        
        // --- WEB AUDIO API (T·∫°o √¢m thanh kh√¥ng c·∫ßn link ngo√†i) ---
        const audioCtx = new (window.AudioContext || window.webkitAudioContext)();
        
        function playCorrectSound() {
            if(audioCtx.state === 'suspended') audioCtx.resume();
            const osc = audioCtx.createOscillator();
            const gainNode = audioCtx.createGain();
            osc.type = 'sine';
            osc.frequency.setValueAtTime(523.25, audioCtx.currentTime); // C5
            osc.frequency.setValueAtTime(659.25, audioCtx.currentTime + 0.1); // E5
            osc.frequency.setValueAtTime(783.99, audioCtx.currentTime + 0.2); // G5
            osc.connect(gainNode);
            gainNode.connect(audioCtx.destination);
            osc.start();
            gainNode.gain.exponentialRampToValueAtTime(0.00001, audioCtx.currentTime + 0.5);
            osc.stop(audioCtx.currentTime + 0.5);
        }

        function playWrongSound() {
            if(audioCtx.state === 'suspended') audioCtx.resume();
            const osc = audioCtx.createOscillator();
            const gainNode = audioCtx.createGain();
            osc.type = 'sawtooth';
            osc.frequency.setValueAtTime(300, audioCtx.currentTime);
            osc.frequency.exponentialRampToValueAtTime(100, audioCtx.currentTime + 0.3);
            osc.connect(gainNode);
            gainNode.connect(audioCtx.destination);
            osc.start();
            gainNode.gain.exponentialRampToValueAtTime(0.00001, audioCtx.currentTime + 0.4);
            osc.stop(audioCtx.currentTime + 0.4);
        }

        // --- CONFETTI EFFECT ---
        function shootConfetti() {
            const colors = ['#00D26A', '#fdcb6e', '#74b9ff', '#00b894', '#FF4757'];
            const container = document.getElementById('confetti-container');
            for(let i=0; i<30; i++) {
                let confetti = document.createElement('div');
                confetti.classList.add('confetti-piece');
                confetti.style.left = Math.random() * 100 + 'vw';
                confetti.style.backgroundColor = colors[Math.floor(Math.random() * colors.length)];
                confetti.style.animationDuration = (Math.random() * 2 + 2) + 's';
                container.appendChild(confetti);
                setTimeout(() => confetti.remove(), 4000);
            }
        }

        // --- TIMER LOGIC ---
        const btnTimer = document.getElementById('btn-timer');
        const timerDisplay = document.getElementById('timer-display');

        btnTimer.addEventListener('click', () => {
            if(audioCtx.state === 'suspended') audioCtx.resume(); // K√≠ch ho·∫°t AudioContext
            if (isTimerRunning) {
                clearInterval(timerInterval);
                btnTimer.innerText = "TI·∫æP T·ª§C";
                btnTimer.style.background = "#fdcb6e";
                btnTimer.style.boxShadow = "0 4px 0 #e1b12c";
            } else {
                timerInterval = setInterval(updateTimer, 1000);
                btnTimer.innerText = "T·∫†M D·ª™NG";
                btnTimer.style.background = "#FF4757";
                btnTimer.style.boxShadow = "0 4px 0 #D93845";
            }
            isTimerRunning = !isTimerRunning;
        });

        function updateTimer() {
            if (timeRemaining <= 0) {
                clearInterval(timerInterval);
                timerDisplay.innerText = "00:00";
                alert("ƒê√£ h·∫øt gi·ªù l√†m b√†i! B·∫°n v·∫´n c√≥ th·ªÉ ti·∫øp t·ª•c l√†m, nh∆∞ng nh·ªõ l√† trong ph√≤ng thi th·∫≠t, b·∫°n ch·ªâ n√™n l√†m m·ªôt b√†i nh∆∞ th·∫ø n√†y trong 10 ph√∫t th√¥i nha.");
                return;
            }
            timeRemaining--;
            let m = Math.floor(timeRemaining / 60);
            let s = timeRemaining % 60;
            timerDisplay.innerText = (m < 10 ? "0" : "") + m + ":" + (s < 10 ? "0" : "") + s;
        }

        // --- TRANSLATION TOGGLE ---
        function toggleTranslation(btn) {
            let target = btn.nextElementSibling;
            if (target.style.display === "block") {
                target.style.display = "none";
                btn.innerText = "B·∫¢N D·ªäCH ƒê·∫¶Y ƒê·ª¶";
            } else {
                target.style.display = "block";
                btn.innerText = "·∫®N B·∫¢N D·ªäCH";
            }
        }

        // --- SHUFFLE ARRAY ---
        function shuffleArray(array) {
            for (let i = array.length - 1; i > 0; i--) {
                const j = Math.floor(Math.random() * (i + 1));
                [array[i], array[j]] = [array[j], array[i]];
            }
            return array;
        }

        // --- RENDER QUIZ ---
        const quizContainer = document.getElementById('quiz-container');

        function renderQuiz() {
            quizData.forEach((q, index) => {
                let card = document.createElement('div');
                card.classList.add('question-card');
                
                let qText = document.createElement('div');
                qText.classList.add('question-text');
                qText.innerText = q.question;
                card.appendChild(qText);

                let optionsGrid = document.createElement('div');
                optionsGrid.classList.add('options-grid');
                optionsGrid.id = 'opts-' + q.id;

                // Clone and shuffle options dynamically
                let shuffledOptions = shuffleArray([...q.options]);
                const prefixes = ['A. ', 'B. ', 'C. '];

                shuffledOptions.forEach((opt, idx) => {
                    let btn = document.createElement('button');
                    btn.classList.add('option-btn');
                    btn.innerText = prefixes[idx] + opt.text;
                    btn.onclick = () => handleOptionClick(btn, opt, q, optionsGrid, card);
                    optionsGrid.appendChild(btn);
                });

                card.appendChild(optionsGrid);

                let explanationDiv = document.createElement('div');
                explanationDiv.classList.add('explanation-box');
                explanationDiv.id = 'exp-' + q.id;
                explanationDiv.innerHTML = q.explanation;
                card.appendChild(explanationDiv);

                quizContainer.appendChild(card);
            });
        }

        function handleOptionClick(btn, optionData, questionData, grid, card) {
            if (answeredQuestions.has(questionData.id)) return; // Only allow 1 choice

            answeredQuestions.add(questionData.id);
            const explanationBox = document.getElementById('exp-' + questionData.id);
            
            // X·ª≠ l√Ω Giao di·ªán khi ch·ªçn
            if (optionData.isCorrect) {
                btn.classList.add('correct');
                playCorrectSound();
                shootConfetti();
                score++;
            } else {
                btn.classList.add('wrong');
                playWrongSound();
                
                // Show the correct answer automatically
                Array.from(grid.children).forEach(childBtn => {
                    // Check if the text of this button matches the correct option text (ignoring the A,B,C prefix)
                    const correctOpt = questionData.options.find(o => o.isCorrect).text;
                    if (childBtn.innerText.includes(correctOpt)) {
                        childBtn.classList.add('correct');
                    }
                });
            }
            
            // Hi·ªán ph·∫ßn gi·∫£i th√≠ch
            explanationBox.style.display = 'block';
        }

        // --- SUBMIT LOGIC ---
        function submitTest() {
            if (answeredQuestions.size < quizData.length) {
                alert("H√£y ho√†n th√†nh t·∫•t c·∫£ c√°c c√¢u h·ªèi tr∆∞·ªõc khi n·ªôp b√†i nh√©!");
                return;
            }
            clearInterval(timerInterval);
            
            document.getElementById('final-score').innerText = score + "/5";
            let feedback = document.getElementById('final-feedback');
            let subFeedback = document.getElementById('final-sub');

            if (score === 5) {
                feedback.innerText = "THI√äN T√ÄI!";
                feedback.style.color = "#00D26A";
                subFeedback.innerText = "Xu·∫•t s·∫Øc! C√¥ Mai An t·ª± h√†o v·ªÅ b·∫°n!";
                shootConfetti(); shootConfetti();
            } else if (score >= 3) {
                feedback.innerText = "L√ÄM T·ªêT L·∫ÆM!";
                feedback.style.color = "#0984e3";
                subFeedback.innerText = "B·∫°n ƒë√£ hi·ªÉu b√†i kh√° t·ªët, c·ªë g·∫Øng l√™n nh√©!";
                shootConfetti();
            } else {
                feedback.innerText = "C·ªê L√äN NH√â!";
                feedback.style.color = "#FF4757";
                subFeedback.innerText = "H√£y ƒë·ªçc k·ªπ l·∫°i ph·∫ßn gi·∫£i th√≠ch chi ti·∫øt ph√≠a tr√™n ƒë·ªÉ ti·∫øn b·ªô h∆°n!";
            }

            document.getElementById('result-modal').style.display = 'flex';
            playCorrectSound();
        }

        // Init
        window.onload = renderQuiz;
    </script>
</body>
</html>