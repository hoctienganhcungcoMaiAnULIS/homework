<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Ms Mai An ULIS - Tr·∫Øc nghi·ªám M√¥i tr∆∞·ªùng & Ng·ªØ ph√°p (26-45)</title>
    <link href="https://fonts.googleapis.com/css2?family=Quicksand:wght@500;600;700&display=swap" rel="stylesheet">
    <style>
        :root {
            --primary: #8854C0; /* T√≠m Pastel */
            --secondary: #00C9A7; /* Xanh ng·ªçc */
            --accent: #FF9F43; /* Cam */
            --correct: #00D26A; /* Xanh l√° chu·∫©n */
            --wrong: #FF4757; /* ƒê·ªè cam */
            --bg-pattern: #f0f3f8;
            --text-main: #2f3542;
            --card-bg: #ffffff;
        }

        body {
            font-family: 'Quicksand', sans-serif;
            background-color: #E0EAFC;
            background-image: linear-gradient(135deg, #E0EAFC 0%, #CFDEF3 100%);
            background-attachment: fixed;
            color: var(--text-main);
            margin: 0;
            padding: 20px;
            overflow-x: hidden;
        }

        /* Background Pattern Decoration */
        body::before {
            content: "";
            position: fixed;
            top: 0; left: 0; width: 100%; height: 100%;
            background-image: radial-gradient(#8854c0 10%, transparent 10%), radial-gradient(#00c9a7 10%, transparent 10%);
            background-size: 30px 30px;
            background-position: 0 0, 15px 15px;
            opacity: 0.1;
            z-index: -1;
        }

        .container {
            max-width: 800px;
            margin: 0 auto;
            padding-bottom: 80px;
        }

        /* Header Styles */
        header {
            text-align: center;
            margin-bottom: 40px;
            background: white;
            padding: 20px;
            border-radius: 25px;
            box-shadow: 0 10px 25px rgba(136, 84, 192, 0.2);
            border: 3px solid var(--primary);
            position: relative;
            overflow: hidden;
        }

        header h1 {
            color: var(--primary);
            margin: 0;
            font-size: 2.2em;
            text-transform: uppercase;
            letter-spacing: 1px;
            text-shadow: 2px 2px 0px rgba(0,0,0,0.1);
        }

        header p {
            color: #747d8c;
            font-size: 1.1em;
            margin-top: 10px;
            font-weight: 600;
        }

        .badge-teacher {
            background: var(--secondary);
            color: white;
            padding: 5px 15px;
            border-radius: 20px;
            font-size: 0.9em;
            display: inline-block;
            margin-top: 5px;
            box-shadow: 0 4px 0 #009e82;
        }

        /* Question Card */
        .quiz-card {
            background: var(--card-bg);
            border-radius: 20px;
            padding: 25px;
            margin-bottom: 30px;
            box-shadow: 0 8px 20px rgba(0,0,0,0.08);
            border-bottom: 6px solid #dfe4ea;
            transition: transform 0.3s ease;
            position: relative;
        }

        .quiz-card:hover {
            transform: translateY(-5px);
        }

        .question-number {
            background: var(--primary);
            color: white;
            padding: 8px 16px;
            border-radius: 15px;
            font-weight: bold;
            display: inline-block;
            margin-bottom: 15px;
            box-shadow: 0 4px 0 #6c429c;
        }

        .question-text {
            font-size: 1.3em;
            font-weight: 700;
            color: #2f3542;
            margin-bottom: 25px;
            line-height: 1.5;
        }

        /* Answer Grid */
        .answers-grid {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 15px;
        }

        @media (max-width: 600px) {
            .answers-grid {
                grid-template-columns: 1fr;
            }
        }

        .btn-option {
            background: white;
            border: 2px solid #e1e1e1;
            border-radius: 15px;
            padding: 15px 20px;
            font-size: 1.1em;
            font-family: 'Quicksand', sans-serif;
            font-weight: 600;
            color: #57606f;
            cursor: pointer;
            transition: all 0.2s;
            box-shadow: 0 4px 0 #d1d1d1;
            position: relative;
            text-align: left;
            display: flex;
            align-items: center;
        }

        .btn-option:hover:not(:disabled) {
            transform: translateY(-2px);
            border-color: var(--primary);
            color: var(--primary);
            box-shadow: 0 6px 0 #d1d1d1;
        }

        .btn-option:active:not(:disabled) {
            transform: translateY(2px);
            box-shadow: 0 0 0 #d1d1d1;
        }

        /* Answer States */
        .btn-option.correct {
            background-color: var(--correct);
            color: white;
            border-color: var(--correct);
            box-shadow: 0 4px 0 #00b85c;
        }

        .btn-option.wrong {
            background-color: var(--wrong);
            color: white;
            border-color: var(--wrong);
            box-shadow: 0 4px 0 #d63031;
            animation: shake 0.5s;
        }

        .btn-option.dimmed {
            opacity: 0.6;
            cursor: not-allowed;
            background: #f1f2f6;
        }

        /* Explanation Box */
        .explanation-box {
            margin-top: 20px;
            background: #f0fdf4; /* Xanh l√° c·ª±c nh·∫°t */
            border: 2px dashed var(--correct);
            border-radius: 15px;
            padding: 20px;
            display: none; /* Hidden initially */
            animation: slideDown 0.4s ease-out;
        }

        .explanation-box.show {
            display: block;
        }

        .teacher-avatar {
            font-size: 2em;
            margin-right: 10px;
            vertical-align: middle;
        }

        .exp-header {
            color: var(--correct);
            font-weight: 800;
            font-size: 1.1em;
            margin-bottom: 10px;
            display: flex;
            align-items: center;
        }

        .exp-content {
            font-size: 1em;
            line-height: 1.6;
            color: #333;
            white-space: pre-line; /* Keeps line breaks from JSON */
        }

        .exp-content b {
            color: var(--primary);
        }

        /* Submit Button */
        .submit-container {
            text-align: center;
            margin-top: 40px;
        }

        .btn-submit {
            background: linear-gradient(to bottom, #FF9F43, #EE5A24);
            color: white;
            border: none;
            padding: 15px 50px;
            font-size: 1.5em;
            border-radius: 50px;
            font-family: 'Quicksand', sans-serif;
            font-weight: 700;
            cursor: pointer;
            box-shadow: 0 6px 0 #bf360c;
            transition: all 0.2s;
        }

        .btn-submit:hover {
            transform: scale(1.05);
        }
        
        .btn-submit:active {
            transform: translateY(4px);
            box-shadow: 0 2px 0 #bf360c;
        }

        /* Animations */
        @keyframes shake {
            0% { transform: translateX(0); }
            25% { transform: translateX(-5px) rotate(-2deg); }
            50% { transform: translateX(5px) rotate(2deg); }
            75% { transform: translateX(-5px) rotate(-2deg); }
            100% { transform: translateX(0); }
        }

        @keyframes slideDown {
            from { opacity: 0; transform: translateY(-10px); }
            to { opacity: 1; transform: translateY(0); }
        }

        @keyframes pop {
            0% { transform: scale(1); }
            50% { transform: scale(1.1); }
            100% { transform: scale(1); }
        }

        /* Result Modal */
        .modal-overlay {
            position: fixed;
            top: 0; left: 0; width: 100%; height: 100%;
            background: rgba(0,0,0,0.7);
            display: none;
            justify-content: center;
            align-items: center;
            z-index: 1000;
            backdrop-filter: blur(5px);
        }

        .modal-content {
            background: white;
            padding: 40px;
            border-radius: 30px;
            text-align: center;
            max-width: 500px;
            width: 90%;
            border: 5px solid var(--primary);
            animation: pop 0.5s ease;
        }

        .score-display {
            font-size: 4em;
            font-weight: 800;
            color: var(--primary);
            margin: 10px 0;
            text-shadow: 3px 3px 0px #eee;
        }

        .feedback-text {
            font-size: 1.2em;
            margin-bottom: 20px;
            color: #555;
        }

        .btn-close {
            background: var(--secondary);
            color: white;
            border: none;
            padding: 10px 30px;
            border-radius: 20px;
            font-size: 1.1em;
            cursor: pointer;
            box-shadow: 0 4px 0 #009e82;
        }
    </style>
</head>
<body>

<div class="container">
    <header>
        <h1>B√†i Thi Th·ª≠ M√¥i Tr∆∞·ªùng</h1>
        <div class="badge-teacher">Gi√°o vi√™n: Ms Mai An ULIS</div>
        <p>Th·ª≠ th√°ch Ng·ªØ ph√°p & T·ª´ v·ª±ng (C√¢u 26-45)</p>
    </header>

    <div id="quiz-area">
        <!-- Questions will be injected here via JavaScript -->
    </div>

    <div class="submit-container">
        <button class="btn-submit" onclick="showFinalResult()">N·ªòP B√ÄI & XEM ƒêI·ªÇM</button>
    </div>
</div>

<!-- Final Result Modal -->
<div class="modal-overlay" id="resultModal">
    <div class="modal-content">
        <h2>üéâ K·∫æT QU·∫¢ C·ª¶A B·∫†N üéâ</h2>
        <div class="score-display" id="finalScore">0/20</div>
        <p class="feedback-text" id="feedbackMsg">H√£y c·ªë g·∫Øng h∆°n nh√©!</p>
        <button class="btn-close" onclick="closeModal()">Xem l·∫°i b√†i l√†m</button>
    </div>
</div>

<!-- Canvas Confetti Script (Minified for Single File) -->
<script>
    var confetti={maxCount:150,speed:2,frameInterval:15,alpha:1,gradient:!1,start:null,stop:null,toggle:null,pause:null,resume:null,togglePause:null,remove:null,isPaused:null,isRunning:null};!function(){confetti.start=s,confetti.stop=w,confetti.toggle=function(){e?w():s()},confetti.pause=u,confetti.resume=m,confetti.togglePause=function(){i?m():u()},confetti.isPaused=function(){return i},confetti.remove=r,confetti.isRunning=function(){return e};var t=window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||window.oRequestAnimationFrame||window.msRequestAnimationFrame,n=["rgba(30,144,255,","rgba(107,142,35,","rgba(255,215,0,","rgba(255,192,203,","rgba(106,90,205,","rgba(173,216,230,","rgba(238,130,238,","rgba(152,251,152,","rgba(70,130,180,","rgba(244,164,96,","rgba(210,105,30,","rgba(220,20,60,"];var e=!1,i=!1,o=Date.now(),a=[],c=0,l=null;function d(t,e,i){return t.color=n[Math.random()*n.length|0]+(confetti.alpha+")"),t.color2=n[Math.random()*n.length|0]+(confetti.alpha+")"),t.x=Math.random()*e,t.y=Math.random()*i-i,t.diameter=10*Math.random()+5,t.tilt=10*Math.random()-10,t.tiltAngleIncrement=.07*Math.random()+.05,t.tiltAngle=Math.random()*Math.PI,t}function u(){i=!0}function m(){i=!1,x()}function r(){w(),a=[]}function s(){w(),e=!0,a=[],function(){var t=window.innerWidth,n=window.innerHeight;window.requestAnimationFrame=window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||window.oRequestAnimationFrame||window.msRequestAnimationFrame||function(t){return window.setTimeout(t,1e3/60)};var e={width:t,height:n};window.onresize=function(){e.width=window.innerWidth,e.height=window.innerHeight},l=canvas=document.createElement("canvas"),l.style.position="fixed",l.style.top="0px",l.style.left="0px",l.style.pointerEvents="none",l.style.zIndex="9999",l.width=t,l.height=n,document.body.appendChild(l);var i=null;var o={width:l.width,height:l.height};function r(){if(null!=l){var n=l.getContext("2d");n.clearRect(0,0,l.width,l.height)}}function s(){for(var t=0;t<confetti.maxCount;t++)a.push(d({},o.width,o.height));!function t(){n.clearRect(0,0,l.width,l.height);if(0===a.length)return;for(var e=0;e<confetti.maxCount;e++){var i=a[e];!function(t,n){t.y+=confetti.speed,t.tiltAngle+=t.tiltAngleIncrement,t.tilt=15*Math.sin(t.tiltAngle);var e=t.x+t.tilt;n.beginPath(),n.lineWidth=t.diameter,n.strokeStyle=t.color,n.moveTo(e+t.diameter/2,t.y),n.lineTo(e,t.y+t.tilt+t.diameter/2),n.stroke()}(i,n),i.y>o.height&&(a[e]=d({},o.width,o.height))}requestAnimationFrame(t)}()}requestAnimationFrame(s)}()}function w(){e=!1,l&&(document.body.removeChild(l),l=null)}function x(){if(!i)if(0===a.length)n.clearRect(0,0,window.innerWidth,window.innerHeight),null;else{var t=Date.now(),u=t-o;(!t||u>confetti.frameInterval)&&(n.clearRect(0,0,window.innerWidth,window.innerHeight),function(){for(var t=0;t<confetti.maxCount;t++){var n=a[t];i||(n.y+=confetti.speed),n.tiltAngle+=n.tiltAngleIncrement,n.tilt=15*Math.sin(n.tiltAngle);var e=n.x+n.tilt;c.beginPath(),c.lineWidth=n.diameter,c.strokeStyle=n.color,c.moveTo(e+n.diameter/2,n.y),c.lineTo(e,n.y+n.tilt+n.diameter/2),c.stroke()}}(),o=t-u%confetti.frameInterval),requestAnimationFrame(x)}}window.confetti=confetti}();
</script>

<script>
    // --- AUDIO SYSTEM (Synthesized for reliability) ---
    const AudioContext = window.AudioContext || window.webkitAudioContext;
    const audioCtx = new AudioContext();

    function playSound(type) {
        if (audioCtx.state === 'suspended') audioCtx.resume();
        const oscillator = audioCtx.createOscillator();
        const gainNode = audioCtx.createGain();
        oscillator.connect(gainNode);
        gainNode.connect(audioCtx.destination);

        if (type === 'correct') {
            // Ding sound (High pitch sine wave)
            oscillator.type = 'sine';
            oscillator.frequency.setValueAtTime(800, audioCtx.currentTime);
            oscillator.frequency.exponentialRampToValueAtTime(1200, audioCtx.currentTime + 0.1);
            gainNode.gain.setValueAtTime(0.3, audioCtx.currentTime);
            gainNode.gain.exponentialRampToValueAtTime(0.01, audioCtx.currentTime + 0.5);
            oscillator.start();
            oscillator.stop(audioCtx.currentTime + 0.5);
        } else {
            // Buzz sound (Low pitch sawtooth)
            oscillator.type = 'sawtooth';
            oscillator.frequency.setValueAtTime(150, audioCtx.currentTime);
            oscillator.frequency.linearRampToValueAtTime(100, audioCtx.currentTime + 0.3);
            gainNode.gain.setValueAtTime(0.3, audioCtx.currentTime);
            gainNode.gain.exponentialRampToValueAtTime(0.01, audioCtx.currentTime + 0.3);
            oscillator.start();
            oscillator.stop(audioCtx.currentTime + 0.3);
        }
    }

    // --- DATA ---
    const quizData = [
        {
            "questionNumber": 26,
            "question": "She suffered ______ a serious disease because of drinking contaminated water for a long time.",
            "answerOptions": [
                { "text": "in", "isCorrect": false },
                { "text": "at", "isCorrect": false },
                { "text": "to", "isCorrect": false },
                { "text": "from", "isCorrect": true }
            ],
            "rationale": "Ph√¢n t√≠ch:\n- A. in (prep)\n- B. at (prep)\n- C. to (prep)\n- D. from (prep): t·ª´/b·ªüi.\n\nD·ªãch c√¢u: C√¥ ·∫•y m·∫Øc ph·∫£i m·ªôt cƒÉn b·ªánh nghi√™m tr·ªçng v√¨ u·ªëng n∆∞·ªõc nhi·ªÖm b·∫©n trong th·ªùi gian d√†i.\n\nGi·∫£i th√≠ch: C·∫•u tr√∫c 'suffer from + [disease/problem]' nghƒ©a l√† ch·ªãu ƒë·ª±ng/m·∫Øc ph·∫£i b·ªánh g√¨."
        },
        {
            "questionNumber": 27,
            "question": "We hope more people join our ______ programme.",
            "answerOptions": [
                { "text": "environment", "isCorrect": false },
                { "text": "environmental", "isCorrect": true },
                { "text": "environmentalist", "isCorrect": false },
                { "text": "environmentally", "isCorrect": false }
            ],
            "rationale": "Ph√¢n t√≠ch:\n- A. environment (n): m√¥i tr∆∞·ªùng.\n- B. environmental (adj): thu·ªôc v·ªÅ m√¥i tr∆∞·ªùng.\n- C. environmentalist (n): nh√† m√¥i tr∆∞·ªùng h·ªçc.\n- D. environmentally (adv): v·ªÅ ph∆∞∆°ng di·ªán m√¥i tr∆∞·ªùng.\n\nD·ªãch c√¢u: Ch√∫ng t√¥i hy v·ªçng c√≥ nhi·ªÅu ng∆∞·ªùi tham gia ch∆∞∆°ng tr√¨nh m√¥i tr∆∞·ªùng c·ªßa ch√∫ng t√¥i.\n\nGi·∫£i th√≠ch: Tr∆∞·ªõc danh t·ª´ 'programme', ta c·∫ßn m·ªôt t√≠nh t·ª´ (adj) ƒë·ªÉ b·ªï nghƒ©a."
        },
        {
            "questionNumber": 28,
            "question": "Harmful gases like nitrogen oxides and sulphur oxides are ______ into the atmosphere during the burning of fossil fuels.",
            "answerOptions": [
                { "text": "releases", "isCorrect": false },
                { "text": "released", "isCorrect": true },
                { "text": "release", "isCorrect": false },
                { "text": "releasing", "isCorrect": false }
            ],
            "rationale": "Ph√¢n t√≠ch:\n- A. releases (v-s).\n- B. released (v-ed/v3).\n- C. release (v-inf).\n- D. releasing (v-ing).\n\nD·ªãch c√¢u: C√°c kh√≠ ƒë·ªôc h·∫°i... ƒë∆∞·ª£c th·∫£i v√†o kh√≠ quy·ªÉn trong qu√° tr√¨nh ƒë·ªët nhi√™n li·ªáu h√≥a th·∫°ch.\n\nGi·∫£i th√≠ch: C√¢u b·ªã ƒë·ªông (Passive Voice) v·ªõi c·∫•u tr√∫c 'be + V3/ed'. ·ªû ƒë√¢y l√† 'are released'."
        },
        {
            "questionNumber": 29,
            "question": "The ______ of air pollution are alarming.",
            "answerOptions": [
                { "text": "effective", "isCorrect": false },
                { "text": "affect", "isCorrect": false },
                { "text": "effect", "isCorrect": false },
                { "text": "effects", "isCorrect": true }
            ],
            "rationale": "Ph√¢n t√≠ch:\n- A. effective (adj): hi·ªáu qu·∫£.\n- B. affect (v): t√°c ƒë·ªông/·∫£nh h∆∞·ªüng.\n- C. effect (n): h·∫≠u qu·∫£/t√°c ƒë·ªông (s·ªë √≠t).\n- D. effects (n): c√°c h·∫≠u qu·∫£ (s·ªë nhi·ªÅu).\n\nD·ªãch c√¢u: Nh·ªØng h·∫≠u qu·∫£ c·ªßa √¥ nhi·ªÖm kh√¥ng kh√≠ th·∫≠t ƒë√°ng b√°o ƒë·ªông.\n\nGi·∫£i th√≠ch: Sau 'The' c·∫ßn danh t·ª´. ƒê·ªông t·ª´ 'are' chia s·ªë nhi·ªÅu => ch·ªçn 'effects'."
        },
        {
            "questionNumber": 30,
            "question": "You should drive carefully ______ the road is slippery.",
            "answerOptions": [
                { "text": "because", "isCorrect": true },
                { "text": "while", "isCorrect": false },
                { "text": "although", "isCorrect": false },
                { "text": "after", "isCorrect": false }
            ],
            "rationale": "Ph√¢n t√≠ch:\n- A. because (conj): b·ªüi v√¨.\n- B. while (conj): trong khi.\n- C. although (conj): m·∫∑c d√π.\n- D. after (conj/prep): sau khi.\n\nD·ªãch c√¢u: B·∫°n n√™n l√°i xe c·∫©n th·∫≠n b·ªüi v√¨ ƒë∆∞·ªùng tr∆°n.\n\nGi·∫£i th√≠ch: M·ªánh ƒë·ªÅ sau ch·ªâ nguy√™n nh√¢n cho h√†nh ƒë·ªông l√°i xe c·∫©n th·∫≠n."
        },
        {
            "questionNumber": 31,
            "question": "I will sleep with the window open ______ it's cold.",
            "answerOptions": [
                { "text": "if", "isCorrect": false },
                { "text": "unless", "isCorrect": true },
                { "text": "as", "isCorrect": false },
                { "text": "before", "isCorrect": false }
            ],
            "rationale": "Ph√¢n t√≠ch:\n- A. if (conj): n·∫øu.\n- B. unless (conj): tr·ª´ khi (= if not).\n- C. as (conj): khi/v√¨.\n- D. before (conj): tr∆∞·ªõc khi.\n\nD·ªãch c√¢u: T√¥i s·∫Ω ng·ªß m·ªü c·ª≠a s·ªï tr·ª´ khi tr·ªùi l·∫°nh.\n\nGi·∫£i th√≠ch: H·ª£p l√Ω nh·∫•t v·ªÅ nghƒ©a. B√¨nh th∆∞·ªùng s·∫Ω m·ªü, nh∆∞ng n·∫øu l·∫°nh th√¨ kh√¥ng."
        },
        {
            "questionNumber": 32,
            "question": "We will clean up the beach ______ it stops raining.",
            "answerOptions": [
                { "text": "while", "isCorrect": false },
                { "text": "though", "isCorrect": false },
                { "text": "since", "isCorrect": false },
                { "text": "as soon as", "isCorrect": true }
            ],
            "rationale": "Ph√¢n t√≠ch:\n- A. while (conj): trong khi.\n- B. though (conj): m·∫∑c d√π.\n- C. since (conj): t·ª´ khi/b·ªüi v√¨.\n- D. as soon as (conj phrase): ngay khi.\n\nD·ªãch c√¢u: Ch√∫ng t√¥i s·∫Ω d·ªçn d·∫πp b√£i bi·ªÉn ngay khi tr·ªùi t·∫°nh m∆∞a.\n\nGi·∫£i th√≠ch: D√πng ƒë·ªÉ di·ªÖn t·∫£ h√†nh ƒë·ªông s·∫Ω x·∫£y ra ngay l·∫≠p t·ª©c sau h√†nh ƒë·ªông kh√°c trong t∆∞∆°ng lai."
        },
        {
            "questionNumber": 33,
            "question": "Mary plays with the boy ______ he is naughty.",
            "answerOptions": [
                { "text": "although", "isCorrect": true },
                { "text": "until", "isCorrect": false },
                { "text": "when", "isCorrect": false },
                { "text": "because", "isCorrect": false }
            ],
            "rationale": "Ph√¢n t√≠ch:\n- A. although (conj): m·∫∑c d√π.\n- B. until (conj): cho ƒë·∫øn khi.\n- C. when (conj): khi.\n- D. because (conj): b·ªüi v√¨.\n\nD·ªãch c√¢u: Mary ch∆°i v·ªõi c·∫≠u b√© m·∫∑c d√π c·∫≠u ·∫•y ngh·ªãch ng·ª£m.\n\nGi·∫£i th√≠ch: Hai v·∫ø ƒë·ªëi l·∫≠p: 'ch∆°i c√πng' (t√≠ch c·ª±c) >< 'ngh·ªãch ng·ª£m' (ti√™u c·ª±c)."
        },
        {
            "questionNumber": 34,
            "question": "He won't get paid for time off ______ he hasn't got a doctor's note.",
            "answerOptions": [
                { "text": "unless", "isCorrect": false },
                { "text": "till", "isCorrect": false },
                { "text": "because", "isCorrect": false },
                { "text": "if", "isCorrect": true }
            ],
            "rationale": "Ph√¢n t√≠ch:\n- A. unless (conj): tr·ª´ khi.\n- B. till (conj): ƒë·∫øn khi.\n- C. because (conj): b·ªüi v√¨.\n- D. if (conj): n·∫øu.\n\nD·ªãch c√¢u: Anh ·∫•y s·∫Ω kh√¥ng ƒë∆∞·ª£c tr·∫£ l∆∞∆°ng cho th·ªùi gian ngh·ªâ n·∫øu anh ·∫•y kh√¥ng c√≥ gi·∫•y x√°c nh·∫≠n c·ªßa b√°c sƒ©.\n\nGi·∫£i th√≠ch: ƒê√¢y l√† c√¢u ƒëi·ªÅu ki·ªán lo·∫°i 1 (Condition)."
        },
        {
            "questionNumber": 35,
            "question": "She went to the gym ______ she had finished her work.",
            "answerOptions": [
                { "text": "after", "isCorrect": true },
                { "text": "before", "isCorrect": false },
                { "text": "unless", "isCorrect": false },
                { "text": "while", "isCorrect": false }
            ],
            "rationale": "Ph√¢n t√≠ch:\n- A. after (conj): sau khi.\n- B. before (conj): tr∆∞·ªõc khi.\n- C. unless (conj): tr·ª´ khi.\n- D. while (conj): trong khi.\n\nD·ªãch c√¢u: C√¥ ·∫•y ƒë√£ ƒëi t·∫≠p gym sau khi ho√†n th√†nh c√¥ng vi·ªác.\n\nGi·∫£i th√≠ch: H√†nh ƒë·ªông 'finished' chia th√¨ Qu√° kh·ª© ho√†n th√†nh (Past Perfect) x·∫£y ra tr∆∞·ªõc, h√†nh ƒë·ªông 'went' chia Qu√° kh·ª© ƒë∆°n (Past Simple) x·∫£y ra sau => D√πng 'after'."
        },
        {
            "questionNumber": 36,
            "question": "Don't drink too much water ______ you are having a meal.",
            "answerOptions": [
                { "text": "till", "isCorrect": false },
                { "text": "until", "isCorrect": false },
                { "text": "while", "isCorrect": true },
                { "text": "even though", "isCorrect": false }
            ],
            "rationale": "Ph√¢n t√≠ch:\n- A. till (conj): cho ƒë·∫øn khi.\n- B. until (conj): cho ƒë·∫øn khi.\n- C. while (conj): trong khi.\n- D. even though (conj): m·∫∑c d√π.\n\nD·ªãch c√¢u: ƒê·ª´ng u·ªëng qu√° nhi·ªÅu n∆∞·ªõc trong khi b·∫°n ƒëang ƒÉn.\n\nGi·∫£i th√≠ch: Di·ªÖn t·∫£ h√†nh ƒë·ªông song song x·∫£y ra c√πng l√∫c."
        },
        {
            "questionNumber": 37,
            "question": "Don't forget to turn off the lights ______ you go out.",
            "answerOptions": [
                { "text": "though", "isCorrect": false },
                { "text": "because", "isCorrect": false },
                { "text": "after", "isCorrect": false },
                { "text": "before", "isCorrect": true }
            ],
            "rationale": "Ph√¢n t√≠ch:\n- A. though (conj): m·∫∑c d√π.\n- B. because (conj): v√¨.\n- C. after (conj): sau khi.\n- D. before (conj): tr∆∞·ªõc khi.\n\nD·ªãch c√¢u: ƒê·ª´ng qu√™n t·∫Øt ƒë√®n tr∆∞·ªõc khi b·∫°n ra ngo√†i.\n\nGi·∫£i th√≠ch: Logic tr√¨nh t·ª± h√†nh ƒë·ªông."
        },
        {
            "questionNumber": 38,
            "question": "I don't know the reason ______ you didn‚Äôt go to school.",
            "answerOptions": [
                { "text": "what", "isCorrect": false },
                { "text": "whose", "isCorrect": false },
                { "text": "why", "isCorrect": true },
                { "text": "where", "isCorrect": false }
            ],
            "rationale": "Ph√¢n t√≠ch:\n- A. what (pronoun): c√°i g√¨.\n- B. whose (pronoun): c·ªßa ai.\n- C. why (adv): t·∫°i sao.\n- D. where (adv): ·ªü ƒë√¢u.\n\nD·ªãch c√¢u: T√¥i kh√¥ng bi·∫øt l√Ω do t·∫°i sao b·∫°n kh√¥ng ƒëi h·ªçc.\n\nGi·∫£i th√≠ch: 'Reason' ƒëi v·ªõi tr·∫°ng t·ª´ quan h·ªá 'why'."
        },
        {
            "questionNumber": 39,
            "question": "He was talking about the film ______ he saw last night.",
            "answerOptions": [
                { "text": "that", "isCorrect": true },
                { "text": "how", "isCorrect": false },
                { "text": "who", "isCorrect": false },
                { "text": "when", "isCorrect": false }
            ],
            "rationale": "Ph√¢n t√≠ch:\n- A. that (pronoun): c√°i m√†.\n- B. how (adv): nh∆∞ th·∫ø n√†o.\n- C. who (pronoun): ng∆∞·ªùi m√†.\n- D. when (adv): khi m√†.\n\nD·ªãch c√¢u: Anh ·∫•y ƒëang n√≥i v·ªÅ b·ªô phim c√°i m√† anh ·∫•y ƒë√£ xem t·ªëi qua.\n\nGi·∫£i th√≠ch: 'The film' l√† v·∫≠t, n√™n d√πng ƒë·∫°i t·ª´ quan h·ªá 'that' ho·∫∑c 'which'."
        },
        {
            "questionNumber": 40,
            "question": "______ thermal pollution happens, the water temperature in streams, rivers, lakes, or oceans changes.",
            "answerOptions": [
                { "text": "Until", "isCorrect": false },
                { "text": "When", "isCorrect": true },
                { "text": "Before", "isCorrect": false },
                { "text": "As soon as", "isCorrect": false }
            ],
            "rationale": "Ph√¢n t√≠ch:\n- A. Until (conj): Cho ƒë·∫øn khi.\n- B. When (conj): Khi.\n- C. Before (conj): Tr∆∞·ªõc khi.\n- D. As soon as (conj phrase): Ngay khi.\n\nD·ªãch c√¢u: Khi √¥ nhi·ªÖm nhi·ªát x·∫£y ra, nhi·ªát ƒë·ªô n∆∞·ªõc ·ªü s√¥ng su·ªëi... b·ªã thay ƒë·ªïi.\n\nGi·∫£i th√≠ch: D√πng 'When' ƒë·ªÉ ƒë·ªãnh nghƒ©a th·ªùi ƒëi·ªÉm/ƒëi·ªÅu ki·ªán x·∫£y ra hi·ªán t∆∞·ª£ng."
        },
        {
            "questionNumber": 41,
            "question": "Noise pollution occurs ______ there are too many loud sounds in the environment.",
            "answerOptions": [
                { "text": "while", "isCorrect": false },
                { "text": "and", "isCorrect": false },
                { "text": "because", "isCorrect": true },
                { "text": "so", "isCorrect": false }
            ],
            "rationale": "Ph√¢n t√≠ch:\n- A. while (conj): trong khi.\n- B. and (conj): v√†.\n- C. because (conj): b·ªüi v√¨.\n- D. so (conj): cho n√™n.\n\nD·ªãch c√¢u: √î nhi·ªÖm ti·∫øng ·ªìn x·∫£y ra b·ªüi v√¨ c√≥ qu√° nhi·ªÅu √¢m thanh l·ªõn trong m√¥i tr∆∞·ªùng.\n\nGi·∫£i th√≠ch: M·ªánh ƒë·ªÅ sau gi·∫£i th√≠ch nguy√™n nh√¢n cho m·ªánh ƒë·ªÅ tr∆∞·ªõc."
        },
        {
            "questionNumber": 42,
            "question": "The roads were slippery ______ it started to rain.",
            "answerOptions": [
                { "text": "so", "isCorrect": false },
                { "text": "as soon as", "isCorrect": false },
                { "text": "when", "isCorrect": true },
                { "text": "before", "isCorrect": false }
            ],
            "rationale": "Ph√¢n t√≠ch:\n- A. so (conj): n√™n.\n- B. as soon as (conj): ngay khi.\n- C. when (conj): khi.\n- D. before (conj): tr∆∞·ªõc khi.\n\nD·ªãch c√¢u: Nh·ªØng con ƒë∆∞·ªùng ƒë√£ b·ªã tr∆°n tr∆∞·ª£t khi tr·ªùi b·∫Øt ƒë·∫ßu m∆∞a.\n\nGi·∫£i th√≠ch: 'When' di·ªÖn t·∫£ th·ªùi ƒëi·ªÉm hai s·ª± vi·ªác x·∫£y ra li√™n quan ƒë·∫øn nhau."
        },
        {
            "questionNumber": 43,
            "question": "Renewable ______ of energy, such as solar and wind power, are crucial for a sustainable future.",
            "answerOptions": [
                { "text": "sources", "isCorrect": true },
                { "text": "pollutions", "isCorrect": false },
                { "text": "consumption", "isCorrect": false },
                { "text": "permission", "isCorrect": false }
            ],
            "rationale": "Ph√¢n t√≠ch:\n- A. sources (n): ngu·ªìn.\n- B. pollutions (n): s·ª± √¥ nhi·ªÖm.\n- C. consumption (n): s·ª± ti√™u th·ª•.\n- D. permission (n): s·ª± cho ph√©p.\n\nD·ªãch c√¢u: C√°c ngu·ªìn nƒÉng l∆∞·ª£ng t√°i t·∫°o, nh∆∞ ƒëi·ªán m·∫∑t tr·ªùi v√† gi√≥, r·∫•t quan tr·ªçng...\n\nGi·∫£i th√≠ch: C·ª•m t·ª´ 'renewable sources of energy' (ngu·ªìn nƒÉng l∆∞·ª£ng t√°i t·∫°o)."
        },
        {
            "questionNumber": 44,
            "question": "We should be mindful of our carbon ______ and seek ways to reduce it.",
            "answerOptions": [
                { "text": "handprint", "isCorrect": false },
                { "text": "printer", "isCorrect": false },
                { "text": "fingerprint", "isCorrect": false },
                { "text": "footprint", "isCorrect": true }
            ],
            "rationale": "Ph√¢n t√≠ch:\n- A. handprint (n).\n- B. printer (n).\n- C. fingerprint (n).\n- D. footprint (n).\n\nD·ªãch c√¢u: Ch√∫ng ta n√™n l∆∞u t√¢m ƒë·∫øn d·∫•u ch√¢n carbon c·ªßa m√¨nh v√† t√¨m c√°ch gi·∫£m thi·ªÉu n√≥.\n\nGi·∫£i th√≠ch: Collocation 'Carbon footprint' (l∆∞·ª£ng kh√≠ th·∫£i carbon)."
        },
        {
            "questionNumber": 45,
            "question": "The loss of habitat and climate change contribute to the ______ of species.",
            "answerOptions": [
                { "text": "extinct", "isCorrect": false },
                { "text": "exit", "isCorrect": false },
                { "text": "extinction", "isCorrect": true },
                { "text": "extincted", "isCorrect": false }
            ],
            "rationale": "Ph√¢n t√≠ch:\n- A. extinct (adj): tuy·ªát ch·ªßng.\n- B. exit (n): l·ªëi ra.\n- C. extinction (n): s·ª± tuy·ªát ch·ªßng.\n- D. extincted (sai t·ª´ lo·∫°i/ng·ªØ ph√°p).\n\nD·ªãch c√¢u: Vi·ªác m·∫•t m√¥i tr∆∞·ªùng s·ªëng v√† bi·∫øn ƒë·ªïi kh√≠ h·∫≠u g√≥p ph·∫ßn v√†o s·ª± tuy·ªát ch·ªßng c·ªßa c√°c lo√†i.\n\nGi·∫£i th√≠ch: Sau m·∫°o t·ª´ 'the' c·∫ßn m·ªôt danh t·ª´ (Noun)."
        }
    ];

    let userScore = 0;
    const totalQuestions = quizData.length;

    // --- RENDER LOGIC ---
    function renderQuiz() {
        const quizArea = document.getElementById('quiz-area');
        quizArea.innerHTML = '';

        quizData.forEach((item, index) => {
            const card = document.createElement('div');
            card.className = 'quiz-card';
            card.id = `q-card-${index}`;

            // 1. Question Header
            const qNum = document.createElement('div');
            qNum.className = 'question-number';
            qNum.innerText = `C√¢u ${item.questionNumber}`;
            card.appendChild(qNum);

            // 2. Question Text
            const qText = document.createElement('div');
            qText.className = 'question-text';
            qText.innerHTML = item.question.replace(/______/g, "<u>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</u>");
            card.appendChild(qText);

            // 3. Answer Grid
            const grid = document.createElement('div');
            grid.className = 'answers-grid';

            item.answerOptions.forEach((opt, optIndex) => {
                const btn = document.createElement('button');
                btn.className = 'btn-option';
                // Prefix ABC...
                const prefix = String.fromCharCode(65 + optIndex);
                btn.innerHTML = `<strong>${prefix}.</strong>&nbsp; ${opt.text}`;
                
                // Add click event
                btn.onclick = () => checkAnswer(index, optIndex, btn, item.rationale);
                grid.appendChild(btn);
            });
            card.appendChild(grid);

            // 4. Explanation Box (Initially Hidden)
            const expBox = document.createElement('div');
            expBox.className = 'explanation-box';
            expBox.id = `exp-${index}`;
            expBox.innerHTML = `
                <div class="exp-header">
                    <span class="teacher-avatar">üë©‚Äçüè´</span> L·ªùi gi·∫£i chi ti·∫øt c·ªßa Ms Mai An:
                </div>
                <div class="exp-content">${item.rationale.replace(/\n/g, '<br>')}</div>
            `;
            card.appendChild(expBox);

            quizArea.appendChild(card);
        });
    }

    // --- CHECK ANSWER LOGIC ---
    function checkAnswer(qIndex, optIndex, btnElement, rationale) {
        const currentData = quizData[qIndex];
        const card = document.getElementById(`q-card-${qIndex}`);
        const allButtons = card.querySelectorAll('.btn-option');
        const expBox = document.getElementById(`exp-${qIndex}`);

        // Prevent re-clicking
        if (card.getAttribute('data-answered') === 'true') return;
        card.setAttribute('data-answered', 'true');

        const isCorrect = currentData.answerOptions[optIndex].isCorrect;

        if (isCorrect) {
            btnElement.classList.add('correct');
            playSound('correct');
            confetti.start(1000); // 1 second burst
            userScore++;
        } else {
            btnElement.classList.add('wrong');
            playSound('wrong');
            // Highlight the correct answer automatically
            currentData.answerOptions.forEach((opt, idx) => {
                if (opt.isCorrect) {
                    allButtons[idx].classList.add('correct');
                }
            });
        }

        // Dim other buttons
        allButtons.forEach(btn => {
            if (btn !== btnElement && !btn.classList.contains('correct')) {
                btn.classList.add('dimmed');
            }
            btn.disabled = true;
        });

        // Show Explanation immediately
        expBox.classList.add('show');
    }

    // --- FINISH & MODAL LOGIC ---
    function showFinalResult() {
        const modal = document.getElementById('resultModal');
        const scoreEl = document.getElementById('finalScore');
        const feedbackEl = document.getElementById('feedbackMsg');

        // Check how many questions attempted
        const answeredCount = document.querySelectorAll('.quiz-card[data-answered="true"]').length;
        
        scoreEl.innerText = `${userScore}/${totalQuestions}`;

        if (userScore === totalQuestions) {
            feedbackEl.innerText = "Tuy·ªát v·ªùi! Em l√† m·ªôt thi√™n t√†i ng·ªØ ph√°p! üåü";
            playSound('correct');
            confetti.start(3000);
        } else if (userScore >= totalQuestions * 0.8) {
            feedbackEl.innerText = "L√†m r·∫•t t·ªët! Em n·∫Øm ki·∫øn th·ª©c r·∫•t ch·∫Øc ch·∫Øn. üí™";
        } else if (userScore >= totalQuestions * 0.5) {
            feedbackEl.innerText = "Kh√° l·∫Øm! C·ªë g·∫Øng √¥n l·∫°i c√°c c√¢u sai nh√©. üòä";
        } else {
            feedbackEl.innerText = "ƒê·ª´ng bu·ªìn nh√©! H√£y xem k·ªπ l·ªùi gi·∫£i chi ti·∫øt c·ªßa c√¥ ƒë·ªÉ ti·∫øn b·ªô h∆°n. üçÄ";
        }

        modal.style.display = 'flex';
    }

    function closeModal() {
        document.getElementById('resultModal').style.display = 'none';
        confetti.stop();
    }

    // Init
    renderQuiz();

</script>

</body>
</html>
