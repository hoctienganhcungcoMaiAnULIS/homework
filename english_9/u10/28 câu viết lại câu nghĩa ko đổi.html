<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Ms Mai An ULIS - Writing Practice: Sentence Building</title>
    <link href="https://fonts.googleapis.com/css2?family=Nunito:wght@400;600;700;800&family=Quicksand:wght@500;700&display=swap" rel="stylesheet">
    <style>
        :root {
            --primary-color: #8854C0; /* T√≠m Pastel */
            --secondary-color: #00C9A7; /* Xanh ng·ªçc */
            --accent-color: #FF9F43; /* Cam */
            --correct-color: #00D26A; /* Xanh l√° */
            --wrong-color: #FF4757; /* ƒê·ªè cam */
            --bg-color: #F0F3F7;
            --card-bg: #FFFFFF;
            --text-color: #2F3542;
        }

        * {
            box-sizing: border-box;
            margin: 0;
            padding: 0;
            font-family: 'Nunito', sans-serif;
        }

        body {
            background-color: var(--bg-color);
            background-image: radial-gradient(#dbe3eb 15%, transparent 16%), radial-gradient(#dbe3eb 15%, transparent 16%);
            background-size: 20px 20px;
            background-position: 0 0, 10px 10px;
            color: var(--text-color);
            min-height: 100vh;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            padding: 20px;
            overflow-x: hidden;
        }

        /* --- Header --- */
        header {
            text-align: center;
            margin-bottom: 20px;
            background: #fff;
            padding: 10px 30px;
            border-radius: 20px;
            box-shadow: 0 8px 0 rgba(0,0,0,0.1);
            border: 2px solid #eee;
            position: relative;
            z-index: 10;
        }

        h1 {
            color: var(--primary-color);
            font-weight: 800;
            font-size: 1.8rem;
            margin: 0;
            text-transform: uppercase;
            letter-spacing: 1px;
        }

        .teacher-name {
            font-family: 'Quicksand', sans-serif;
            color: var(--secondary-color);
            font-size: 1rem;
            font-weight: 700;
        }

        /* --- Game Container --- */
        .game-container {
            width: 100%;
            max-width: 800px;
            background: var(--card-bg);
            border-radius: 25px;
            box-shadow: 0 10px 25px rgba(136, 84, 192, 0.15);
            padding: 30px;
            position: relative;
            border: 3px solid #E1E8ED;
        }

        /* --- Progress Bar --- */
        .progress-wrapper {
            width: 100%;
            height: 12px;
            background-color: #E0E0E0;
            border-radius: 10px;
            margin-bottom: 25px;
            overflow: hidden;
            border: 1px solid #ccc;
        }

        .progress-bar {
            height: 100%;
            background-color: var(--secondary-color);
            width: 0%;
            transition: width 0.5s ease;
            border-radius: 10px;
        }

        /* --- Score Board --- */
        .stats-bar {
            display: flex;
            justify-content: space-between;
            margin-bottom: 20px;
            font-weight: 700;
            font-size: 1.1rem;
        }

        .score-display {
            color: var(--accent-color);
            background: #FFF3CD;
            padding: 5px 15px;
            border-radius: 15px;
            border: 2px solid #FFEBA7;
        }

        .question-count {
            color: var(--primary-color);
            background: #EDE4FF;
            padding: 5px 15px;
            border-radius: 15px;
            border: 2px solid #D1C4E9;
        }

        /* --- Question --- */
        .question-box {
            font-size: 1.3rem;
            font-weight: 700;
            margin-bottom: 30px;
            line-height: 1.5;
            color: #2c3e50;
            background: #f8f9fa;
            padding: 20px;
            border-radius: 15px;
            border-left: 5px solid var(--primary-color);
        }

        /* --- Options --- */
        .options-grid {
            display: grid;
            grid-template-columns: 1fr;
            gap: 15px;
        }

        .option-btn {
            background: white;
            border: 2px solid #E0E0E0;
            border-radius: 15px;
            padding: 15px 20px;
            font-size: 1.1rem;
            color: var(--text-color);
            cursor: pointer;
            transition: all 0.2s;
            text-align: left;
            position: relative;
            box-shadow: 0 4px 0 #ccc; /* 3D Effect */
            font-weight: 600;
        }

        .option-btn:hover:not(:disabled) {
            transform: translateY(-2px);
            box-shadow: 0 6px 0 #bbb;
            border-color: var(--primary-color);
            background-color: #F8F0FF;
        }

        .option-btn:active:not(:disabled) {
            transform: translateY(2px);
            box-shadow: 0 2px 0 #ccc;
        }

        /* States */
        .option-btn.correct {
            background-color: var(--correct-color);
            color: white;
            border-color: #00B85C;
            box-shadow: 0 4px 0 #008F47;
        }

        .option-btn.wrong {
            background-color: var(--wrong-color);
            color: white;
            border-color: #FF2E40;
            box-shadow: 0 4px 0 #D11A2B;
            animation: shake 0.5s;
        }

        .option-btn:disabled {
            cursor: default;
            opacity: 0.8;
            transform: none !important;
        }

        /* --- Explanation --- */
        .explanation-container {
            margin-top: 25px;
            background: #F1F9FF;
            border: 2px solid #BEE3F8;
            border-radius: 15px;
            padding: 20px;
            display: none; /* Hidden by default */
            animation: slideDown 0.4s ease-out;
        }

        .explanation-header {
            font-weight: 800;
            color: #3182CE;
            margin-bottom: 10px;
            display: flex;
            align-items: center;
            gap: 10px;
            font-size: 1.1rem;
        }

        .explanation-content {
            font-size: 1rem;
            line-height: 1.6;
            color: #2D3748;
        }
        
        .explanation-content strong {
            color: #C53030;
        }

        .explanation-step {
            margin-bottom: 8px;
            padding-bottom: 8px;
            border-bottom: 1px dashed #cbd5e0;
        }
        .explanation-step:last-child {
            border-bottom: none;
        }
        .explanation-step-title {
            font-weight: 700;
            color: var(--primary-color);
            display: block;
            margin-bottom: 4px;
        }

        /* --- Next Button --- */
        .next-btn {
            display: block;
            width: 100%;
            margin-top: 25px;
            padding: 15px;
            background-color: var(--secondary-color);
            color: white;
            border: none;
            border-radius: 15px;
            font-size: 1.2rem;
            font-weight: 800;
            cursor: pointer;
            box-shadow: 0 5px 0 #009E82;
            transition: transform 0.2s;
            display: none; /* Hidden initially */
        }

        .next-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 7px 0 #009E82;
        }
        
        .next-btn:active {
            transform: translateY(2px);
            box-shadow: 0 2px 0 #009E82;
        }

        /* --- End Screen --- */
        .end-screen {
            text-align: center;
            display: none;
        }

        .end-score {
            font-size: 3rem;
            font-weight: 900;
            color: var(--primary-color);
            margin: 20px 0;
        }

        .restart-btn {
            background-color: var(--accent-color);
            color: white;
            padding: 15px 30px;
            border-radius: 15px;
            font-size: 1.2rem;
            font-weight: bold;
            border: none;
            box-shadow: 0 5px 0 #E58E26;
            cursor: pointer;
        }

        /* --- Animations --- */
        @keyframes shake {
            0% { transform: translateX(0); }
            25% { transform: translateX(-10px); }
            50% { transform: translateX(10px); }
            75% { transform: translateX(-10px); }
            100% { transform: translateX(0); }
        }

        @keyframes slideDown {
            from { opacity: 0; transform: translateY(-10px); }
            to { opacity: 1; transform: translateY(0); }
        }

        /* Mobile Responsive */
        @media (max-width: 600px) {
            .question-box {
                font-size: 1.1rem;
            }
            .option-btn {
                font-size: 0.95rem;
            }
            .game-container {
                padding: 15px;
            }
        }
    </style>
</head>
<body>

    <header>
        <h1>Writing Practice</h1>
        <div class="teacher-name">Ms Mai An (ULIS)</div>
    </header>

    <div class="game-container">
        
        <!-- Progress & Stats -->
        <div class="progress-wrapper">
            <div class="progress-bar" id="progress-bar"></div>
        </div>
        
        <div class="stats-bar">
            <div class="question-count">C√¢u: <span id="current-q">1</span>/<span id="total-q">28</span></div>
            <div class="score-display">ƒêi·ªÉm: <span id="score">0</span></div>
        </div>

        <!-- Gameplay Area -->
        <div id="quiz-area">
            <div class="question-box" id="question-text">
                Loading question...
            </div>

            <div class="options-grid" id="options-container">
                <!-- Options will be injected here -->
            </div>

            <!-- Explanation Box -->
            <div class="explanation-container" id="explanation-box">
                <div class="explanation-header">
                    <span>üí° Gi·∫£i th√≠ch chi ti·∫øt c·ªßa C√¥ Mai An:</span>
                </div>
                <div class="explanation-content" id="explanation-text">
                    <!-- Explanation content -->
                </div>
            </div>

            <button class="next-btn" id="next-btn" onclick="nextQuestion()">C√¢u ti·∫øp theo ‚ûú</button>
        </div>

        <!-- End Screen -->
        <div class="end-screen" id="end-screen">
            <h2>üéâ HO√ÄN TH√ÄNH XU·∫§T S·∫ÆC! üéâ</h2>
            <p>B·∫°n ƒë√£ l√†m r·∫•t t·ªët b√†i t·∫≠p h√¥m nay.</p>
            <div class="end-score" id="final-score">0/0</div>
            <div id="praise-text" style="font-size: 1.2rem; color: #555; margin-bottom: 20px;"></div>
            <button class="restart-btn" onclick="restartQuiz()">L√†m l·∫°i b√†i n√†y</button>
        </div>

    </div>

    <!-- Canvas for Confetti -->
    <canvas id="confetti-canvas" style="position: fixed; top: 0; left: 0; pointer-events: none; z-index: 99;"></canvas>

    <script>
        // --- DATA ---
        const quizData = [
            {
                "question": "Exercise 1 - Q1: Make a complete sentence.\nWe / all / know / single day / 24 / hour / long.",
                "options": [
                    "We all know that a single day is 24 hours long.",
                    "We all know single day are 24 hour long.",
                    "We all knowing a single day is 24 hours length.",
                    "We all know that single day were 24 hours long."
                ],
                "correct": 0,
                "rationale": "<b>1. Ph√¢n t√≠ch:</b> We all know (ch√∫ng ta ƒë·ªÅu bi·∫øt), single day (m·ªôt ng√†y ƒë∆°n l·∫ª), 24 hours (24 gi·ªù), long (d√†i).<br><b>2. D·ªãch:</b> Ch√∫ng ta ƒë·ªÅu bi·∫øt r·∫±ng m·ªôt ng√†y d√†i 24 gi·ªù.<br><b>3. Gi·∫£i th√≠ch:</b> C·∫ßn th√™m 'that' (r·∫±ng) ƒë·ªÉ n·ªëi m·ªánh ƒë·ªÅ (tuy c√≥ th·ªÉ l∆∞·ª£c b·ªè nh∆∞ng trong vƒÉn vi·∫øt n√™n c√≥). 'A single day' l√† ch·ªß ng·ªØ s·ªë √≠t -> ƒë·ªông t·ª´ to be 'is'. '24' l√† s·ªë nhi·ªÅu -> 'hour' ph·∫£i th√™m 's' th√†nh 'hours'."
            },
            {
                "question": "Exercise 1 - Q2: Make a complete sentence.\nHowever, / this / only true / for / day / on / planet Earth.",
                "options": [
                    "However, this is only true for a day on planet Earth.",
                    "However, this only true for day on planet Earth.",
                    "However, this is only true for the day on planet Earth.",
                    "However, this are only true for a day on planet Earth."
                ],
                "correct": 0,
                "rationale": "<b>1. Ph√¢n t√≠ch:</b> However (tuy nhi√™n), true (ƒë√∫ng), planet Earth (tr√°i ƒë·∫•t).<br><b>2. D·ªãch:</b> Tuy nhi√™n, ƒëi·ªÅu n√†y ch·ªâ ƒë√∫ng v·ªõi m·ªôt ng√†y tr√™n Tr√°i ƒë·∫•t.<br><b>3. Gi·∫£i th√≠ch:</b> 'This' l√† ch·ªß ng·ªØ s·ªë √≠t -> c·∫ßn th√™m ƒë·ªông t·ª´ to be 'is' tr∆∞·ªõc t√≠nh t·ª´ 'true'. C·∫ßn th√™m m·∫°o t·ª´ 'a' tr∆∞·ªõc danh t·ª´ s·ªë √≠t ƒë·∫øm ƒë∆∞·ª£c 'day'."
            },
            {
                "question": "Exercise 1 - Q3: Make a complete sentence.\nThat / because / it / take / Earth / 24 / hour / make / one rotation /, or / turn.",
                "options": [
                    "That is because it takes Earth 24 hours to make one rotation, or turn.",
                    "That because it take Earth 24 hours make one rotation, or turn.",
                    "That is because it takes Earth 24 hour to making one rotation, or turn.",
                    "That is because it took Earth 24 hours to make one rotation, or turn."
                ],
                "correct": 0,
                "rationale": "<b>1. Ph√¢n t√≠ch:</b> It takes + [time] + to V (M·∫•t bao l√¢u ƒë·ªÉ l√†m g√¨).<br><b>2. D·ªãch:</b> ƒê√≥ l√† b·ªüi v√¨ Tr√°i ƒë·∫•t m·∫•t 24 gi·ªù ƒë·ªÉ th·ª±c hi·ªán m·ªôt v√≤ng quay, hay m·ªôt l∆∞·ª£t xoay.<br><b>3. Gi·∫£i th√≠ch:</b> C·∫•u tr√∫c 'It takes + O + time + to V'. Ch·ªß ng·ªØ gi·∫£ 'It' ƒëi v·ªõi 'takes' (th√™m s). '24 hours' s·ªë nhi·ªÅu. ƒê·ªông t·ª´ ch·ªâ m·ª•c ƒë√≠ch l√† 'to make'."
            },
            {
                "question": "Exercise 1 - Q4: Make a complete sentence.\nDifferent planets / take / different / amount / of time / rotate.",
                "options": [
                    "Different planets take different amounts of time to rotate.",
                    "Different planets takes different amount of time rotate.",
                    "Different planets take different amount of time rotating.",
                    "Different planets take different amounts of time for rotate."
                ],
                "correct": 0,
                "rationale": "<b>1. Ph√¢n t√≠ch:</b> Different planets (c√°c h√†nh tinh kh√°c nhau), amount of time (l∆∞·ª£ng th·ªùi gian), rotate (xoay).<br><b>2. D·ªãch:</b> C√°c h√†nh tinh kh√°c nhau m·∫•t l∆∞·ª£ng th·ªùi gian kh√°c nhau ƒë·ªÉ t·ª± xoay.<br><b>3. Gi·∫£i th√≠ch:</b> 'Planets' s·ªë nhi·ªÅu -> 'take' gi·ªØ nguy√™n. 'Amounts' n√™n ƒë·ªÉ s·ªë nhi·ªÅu v√¨ n√≥i v·ªÅ nhi·ªÅu h√†nh tinh kh√°c nhau. C·∫•u tr√∫c 'take time TO V' (ƒë·ªÉ xoay)."
            },
            {
                "question": "Exercise 1 - Q5: Make a complete sentence.\nOne day / on / planet Mercury / take / over / 58 / day / in / Earth time.",
                "options": [
                    "One day on planet Mercury takes over 58 days in Earth time.",
                    "One day on planet Mercury take over 58 day in Earth time.",
                    "One day on planet Mercury takes over 58 days on Earth time.",
                    "One day on planet Mercury taking over 58 days in Earth time."
                ],
                "correct": 0,
                "rationale": "<b>1. Ph√¢n t√≠ch:</b> Mercury (sao Th·ªßy), Earth time (gi·ªù Tr√°i ƒë·∫•t).<br><b>2. D·ªãch:</b> M·ªôt ng√†y tr√™n sao Th·ªßy m·∫•t h∆°n 58 ng√†y t√≠nh theo gi·ªù Tr√°i ƒë·∫•t.<br><b>3. Gi·∫£i th√≠ch:</b> Ch·ªß ng·ªØ ch√≠nh l√† 'One day' (s·ªë √≠t) -> ƒë·ªông t·ª´ 'take' ph·∫£i th√™m 's' th√†nh 'takes'. '58' l√† s·ªë nhi·ªÅu -> 'day' ph·∫£i th√™m 's' th√†nh 'days'."
            },
            {
                "question": "Exercise 1 - Q6: Make a complete sentence.\nA day / on / planet Venus / 243 / Earth day / long / -longest day.",
                "options": [
                    "A day on planet Venus is 243 Earth days long - the longest day.",
                    "A day on planet Venus 243 Earth days long - longest day.",
                    "A day on planet Venus is 243 Earth day long - the longest day.",
                    "A day on planet Venus are 243 Earth days long - a longest day."
                ],
                "correct": 0,
                "rationale": "<b>1. Ph√¢n t√≠ch:</b> Venus (sao Kim), longest (d√†i nh·∫•t).<br><b>2. D·ªãch:</b> M·ªôt ng√†y tr√™n sao Kim d√†i 243 ng√†y Tr√°i ƒë·∫•t - ng√†y d√†i nh·∫•t.<br><b>3. Gi·∫£i th√≠ch:</b> C·∫ßn ƒë·ªông t·ª´ 'is' n·ªëi ch·ªß ng·ªØ v√† t√≠nh t·ª´ 'long'. '243' s·ªë nhi·ªÅu -> 'days'. So s√°nh nh·∫•t 'longest' b·∫Øt bu·ªôc ph·∫£i c√≥ m·∫°o t·ª´ 'the'."
            },
            {
                "question": "Exercise 1 - Q7: Make a complete sentence.\nJupiter, / largest planet, / have / shortest day / -just / 9.9 / Earth hour.",
                "options": [
                    "Jupiter, the largest planet, has the shortest day - just 9.9 Earth hours.",
                    "Jupiter, largest planet, have shortest day - just 9.9 Earth hour.",
                    "Jupiter, the largest planet, having the shortest day - just 9.9 Earth hours.",
                    "Jupiter, a largest planet, has a shortest day - just 9.9 Earth hours."
                ],
                "correct": 0,
                "rationale": "<b>1. Ph√¢n t√≠ch:</b> Jupiter (sao M·ªôc), largest (l·ªõn nh·∫•t), shortest (ng·∫Øn nh·∫•t).<br><b>2. D·ªãch:</b> Sao M·ªôc, h√†nh tinh l·ªõn nh·∫•t, c√≥ ng√†y ng·∫Øn nh·∫•t - ch·ªâ 9.9 gi·ªù Tr√°i ƒë·∫•t.<br><b>3. Gi·∫£i th√≠ch:</b> C·ª•m ƒë·ªìng v·ªã ng·ªØ 'largest planet' c·∫ßn 'the' (so s√°nh nh·∫•t). Ch·ªß ng·ªØ Jupiter s·ªë √≠t -> 'has'. 'Shortest day' c·∫ßn 'the'. '9.9' l·ªõn h∆°n 1 -> 'hours' s·ªë nhi·ªÅu."
            },
            {
                "question": "Exercise 2 - Q1: Complete the sentence using GOING.\nWe were on our way home when we saw an elephant crossing the highway.\n-> While __________________________",
                "options": [
                    "While we were going home, we saw an elephant crossing the highway.",
                    "While we went home, we saw an elephant crossing the highway.",
                    "While going home, we saw an elephant crossing the highway.",
                    "While we are going home, we saw an elephant crossing the highway."
                ],
                "correct": 0,
                "rationale": "<b>1. Ph√¢n t√≠ch:</b> 'On our way home' = 'going home'. C·∫•u tr√∫c While + Qu√° kh·ª© ti·∫øp di·ªÖn (h√†nh ƒë·ªông ƒëang x·∫£y ra) -> Qu√° kh·ª© ƒë∆°n (h√†nh ƒë·ªông xen v√†o).<br><b>2. D·ªãch:</b> Khi ch√∫ng t√¥i ƒëang tr√™n ƒë∆∞·ªùng v·ªÅ nh√†, ch√∫ng t√¥i th·∫•y m·ªôt con voi bƒÉng qua ƒë∆∞·ªùng cao t·ªëc.<br><b>3. Gi·∫£i th√≠ch:</b> D√πng 'were going' ƒë·ªÉ thay th·∫ø cho 'were on our way'."
            },
            {
                "question": "Exercise 2 - Q2: Complete the sentence using FIND.\nThe children are always fascinated by wildlife documentaries.\n-> The children __________________________",
                "options": [
                    "The children always find wildlife documentaries fascinating.",
                    "The children always find wildlife documentaries fascinated.",
                    "The children are always find wildlife documentaries fascinating.",
                    "The children find always wildlife documentaries fascinating."
                ],
                "correct": 0,
                "rationale": "<b>1. Ph√¢n t√≠ch:</b> C·∫•u tr√∫c S + find + O + adj (Th·∫•y c√°i g√¨ ƒë√≥ nh∆∞ th·∫ø n√†o).<br><b>2. D·ªãch:</b> L≈© tr·∫ª lu√¥n th·∫•y phim t√†i li·ªáu v·ªÅ ƒë·ªông v·∫≠t hoang d√£ r·∫•t h·∫•p d·∫´n.<br><b>3. Gi·∫£i th√≠ch:</b> 'Fascinated by' (b·ªã cu·ªën h√∫t b·ªüi) chuy·ªÉn th√†nh 'find... fascinating' (th·∫•y... h·∫•p d·∫´n). 'Fascinating' d√πng cho v·∫≠t (documentaries)."
            },
            {
                "question": "Exercise 2 - Q3: Complete the sentence using WHOSE.\nThe cheetah is the fastest land animal on Earth. Its speed can reach up to 70 mph.\n-> The cheetah, __________________________",
                "options": [
                    "The cheetah, whose speed can reach up to 70 mph, is the fastest land animal on Earth.",
                    "The cheetah, whose speed is the fastest land animal on Earth, can reach up to 70 mph.",
                    "The cheetah, whose is the fastest land animal on Earth, speed can reach up to 70 mph.",
                    "The cheetah whose speed can reach up to 70 mph is the fastest land animal on Earth."
                ],
                "correct": 0,
                "rationale": "<b>1. Ph√¢n t√≠ch:</b> D√πng ƒë·∫°i t·ª´ quan h·ªá s·ªü h·ªØu 'whose' thay cho t√≠nh t·ª´ s·ªü h·ªØu 'Its'.<br><b>2. D·ªãch:</b> B√°o Cheetah, lo√†i m√† t·ªëc ƒë·ªô c√≥ th·ªÉ ƒë·∫°t t·ªõi 70 d·∫∑m/gi·ªù, l√† ƒë·ªông v·∫≠t tr√™n c·∫°n nhanh nh·∫•t Tr√°i ƒë·∫•t.<br><b>3. Gi·∫£i th√≠ch:</b> M·ªánh ƒë·ªÅ quan h·ªá 'whose speed can reach...' ƒë∆∞·ª£c ƒë·∫∑t ngay sau ch·ªß ng·ªØ 'The cheetah'. C·∫ßn d·∫•u ph·∫©y v√¨ Cheetah l√† danh t·ª´ x√°c ƒë·ªãnh."
            },
            {
                "question": "Exercise 2 - Q4: Complete the sentence using TOO.\nThe polar regions aren‚Äôt warm enough for trees to grow into dense forests.\n-> The polar regions __________________________",
                "options": [
                    "The polar regions are too cold for trees to grow into dense forests.",
                    "The polar regions are too warm for trees to grow into dense forests.",
                    "The polar regions aren't too warm for trees to grow into dense forests.",
                    "The polar regions are too cold that trees to grow into dense forests."
                ],
                "correct": 0,
                "rationale": "<b>1. Ph√¢n t√≠ch:</b> 'Not warm enough' (kh√¥ng ƒë·ªß ·∫•m) = 'Too cold' (qu√° l·∫°nh).<br><b>2. D·ªãch:</b> C√°c v√πng c·ª±c qu√° l·∫°nh ƒë·ªÉ c√¢y c·ªëi c√≥ th·ªÉ ph√°t tri·ªÉn th√†nh r·ª´ng r·∫≠m.<br><b>3. Gi·∫£i th√≠ch:</b> C·∫•u tr√∫c: S + be + too + adj + (for O) + to V."
            },
            {
                "question": "Exercise 2 - Q5: Complete the sentence using IF.\n‚ÄúCan you imagine how life on a planet without plants would be?‚Äù she said to me.\n-> She asked me __________________________",
                "options": [
                    "She asked me if I could imagine how life on a planet without plants would be.",
                    "She asked me if I can imagine how life on a planet without plants would be.",
                    "She asked me if could I imagine how life on a planet without plants would be.",
                    "She asked me if you could imagine how life on a planet without plants would be."
                ],
                "correct": 0,
                "rationale": "<b>1. Ph√¢n t√≠ch:</b> C√¢u t∆∞·ªùng thu·∫≠t c√¢u h·ªèi Yes/No -> d√πng 'if'.<br><b>2. D·ªãch:</b> C√¥ ·∫•y h·ªèi t√¥i li·ªáu t√¥i c√≥ th·ªÉ t∆∞·ªüng t∆∞·ª£ng cu·ªôc s·ªëng tr√™n m·ªôt h√†nh tinh kh√¥ng c√≥ c√¢y c·ªëi s·∫Ω ra sao kh√¥ng.<br><b>3. Gi·∫£i th√≠ch:</b> ƒê·ªïi ng√¥i 'you' -> 'I', l√πi th√¨ 'Can' -> 'Could'. Kh√¥ng ƒë·∫£o ng·ªØ trong c√¢u t∆∞·ªùng thu·∫≠t."
            },
            {
                "question": "Exercise 2 - Q6: Complete the sentence using WHICH.\nShe is reading a book. The book is about the first Asian to travel into space.\n-> The book __________________________",
                "options": [
                    "The book which she is reading is about the first Asian to travel into space.",
                    "The book which is about the first Asian to travel into space is reading her.",
                    "The book, which she is reading is about the first Asian to travel into space.",
                    "The book about which she is reading is the first Asian to travel into space."
                ],
                "correct": 0,
                "rationale": "<b>1. Ph√¢n t√≠ch:</b> D√πng ƒë·∫°i t·ª´ quan h·ªá 'which' thay cho 'The book' ·ªü c√¢u ƒë·∫ßu.<br><b>2. D·ªãch:</b> Cu·ªën s√°ch m√† c√¥ ·∫•y ƒëang ƒë·ªçc vi·∫øt v·ªÅ ng∆∞·ªùi ch√¢u √Å ƒë·∫ßu ti√™n bay v√†o v≈© tr·ª•.<br><b>3. Gi·∫£i th√≠ch:</b> M·ªánh ƒë·ªÅ quan h·ªá 'which she is reading' b·ªï nghƒ©a cho 'The book'. Kh√¥ng d√πng d·∫•u ph·∫©y v√¨ ƒë√¢y l√† m·ªánh ƒë·ªÅ x√°c ƒë·ªãnh."
            },
            {
                "question": "Exercise 2 - Q7: Complete the sentence using WISH.\nIt‚Äôs a pity we don‚Äôt have any clean-up activities in our neighbourhood.\n-> I __________________________",
                "options": [
                    "I wish we had some clean-up activities in our neighbourhood.",
                    "I wish we have some clean-up activities in our neighbourhood.",
                    "I wish we didn't have any clean-up activities in our neighbourhood.",
                    "I wish we had had some clean-up activities in our neighbourhood."
                ],
                "correct": 0,
                "rationale": "<b>1. Ph√¢n t√≠ch:</b> 'It's a pity' (Th·∫≠t ƒë√°ng ti·∫øc) -> D√πng c·∫•u tr√∫c c√¢u ∆∞·ªõc 'Wish'. Hi·ªán t·∫°i 'don't have' -> ∆Ø·ªõc tr√°i ng∆∞·ª£c hi·ªán t·∫°i d√πng Qu√° kh·ª© ƒë∆°n (had).<br><b>2. D·ªãch:</b> T√¥i ∆∞·ªõc ch√∫ng ta c√≥ v√†i ho·∫°t ƒë·ªông d·ªçn d·∫πp trong khu ph·ªë.<br><b>3. Gi·∫£i th√≠ch:</b> 'Any' trong c√¢u ph·ªß ƒë·ªãnh th∆∞·ªùng ƒë·ªïi th√†nh 'some' trong c√¢u kh·∫≥ng ƒë·ªãnh/c√¢u ∆∞·ªõc."
            },
            {
                "question": "Exercise 2 - Q8: Complete the sentence using UNLESS.\nIf the government doesn‚Äôt take action, half of the rainforest will disappear soon.\n-> Half of the rainforest __________________________",
                "options": [
                    "Half of the rainforest will disappear soon unless the government takes action.",
                    "Half of the rainforest will disappear soon unless the government doesn't take action.",
                    "Half of the rainforest won't disappear soon unless the government takes action.",
                    "Half of the rainforest will disappear soon unless the government take action."
                ],
                "correct": 0,
                "rationale": "<b>1. Ph√¢n t√≠ch:</b> Unless = If... not (Tr·ª´ khi/N·∫øu kh√¥ng).<br><b>2. D·ªãch:</b> M·ªôt n·ª≠a r·ª´ng nhi·ªát ƒë·ªõi s·∫Ω s·ªõm bi·∫øn m·∫•t tr·ª´ khi ch√≠nh ph·ªß h√†nh ƒë·ªông.<br><b>3. Gi·∫£i th√≠ch:</b> 'If the government doesn't take action' = 'Unless the government takes action'. B·ªè 'not', ƒë·ªông t·ª´ 'take' chia theo ng√¥i s·ªë √≠t -> 'takes'."
            },
            {
                "question": "Exercise 2 - Q9: Complete the sentence using NOT.\n‚ÄúYou shouldn‚Äôt use plastic products all the time,‚Äù I said to Anna.\n-> I suggested __________________________",
                "options": [
                    "I suggested that Anna should not use plastic products all the time.",
                    "I suggested Anna not to use plastic products all the time.",
                    "I suggested not using plastic products all the time to Anna.",
                    "I suggested Anna not using plastic products all the time."
                ],
                "correct": 0,
                "rationale": "<b>1. Ph√¢n t√≠ch:</b> C·∫•u tr√∫c Suggest + that + S + (should) + V.<br><b>2. D·ªãch:</b> T√¥i g·ª£i √Ω r·∫±ng Anna kh√¥ng n√™n s·ª≠ d·ª•ng s·∫£n ph·∫©m nh·ª±a m·ªçi l√∫c.<br><b>3. Gi·∫£i th√≠ch:</b> D√πng 'should not' ƒë·ªÉ gi·ªØ nguy√™n √Ω khuy√™n b·∫£o ph·ªß ƒë·ªãnh. ƒê√°p √°n A l√† c·∫•u tr√∫c trang tr·ªçng v√† ch√≠nh x√°c nh·∫•t."
            },
            {
                "question": "Exercise 2 - Q10: Complete the sentence using AS.\nThe rainforest is more biodiverse than the desert.\n-> The desert __________________________",
                "options": [
                    "The desert is not as biodiverse as the rainforest.",
                    "The desert is as biodiverse as the rainforest.",
                    "The desert is not so biodiverse than the rainforest.",
                    "The desert is less biodiverse as the rainforest."
                ],
                "correct": 0,
                "rationale": "<b>1. Ph√¢n t√≠ch:</b> So s√°nh h∆°n (more... than) chuy·ªÉn sang so s√°nh kh√¥ng b·∫±ng (not as... as).<br><b>2. D·ªãch:</b> Sa m·∫°c kh√¥ng ƒëa d·∫°ng sinh h·ªçc b·∫±ng r·ª´ng nhi·ªát ƒë·ªõi.<br><b>3. Gi·∫£i th√≠ch:</b> ƒê·∫£o v·ªã tr√≠ hai ch·ªß ng·ªØ v√† d√πng c·∫•u tr√∫c 'not as + adj + as'."
            },
            {
                "question": "Exercise 3 - Q1: Combine the sentences.\nMars is a rocky planet. It has two moons.",
                "options": [
                    "Mars, which has two moons, is a rocky planet.",
                    "A rocky planet with two moons, Mars is a giant planet.",
                    "As Mars is a rocky planet, it has two moons.",
                    "Two moons orbit Mars, a rocky planet."
                ],
                "correct": 0,
                "rationale": "<b>1. Ph√¢n t√≠ch:</b> Mars (sao H·ªèa), rocky planet (h√†nh tinh ƒë√°).<br><b>2. D·ªãch:</b> Sao H·ªèa, h√†nh tinh c√≥ hai m·∫∑t trƒÉng, l√† m·ªôt h√†nh tinh ƒë√°.<br><b>3. Gi·∫£i th√≠ch:</b> S·ª≠ d·ª•ng m·ªánh ƒë·ªÅ quan h·ªá kh√¥ng x√°c ƒë·ªãnh (c√≥ d·∫•u ph·∫©y v√¨ Mars l√† t√™n ri√™ng). 'Which has two moons' b·ªï sung th√¥ng tin ph·ª•."
            },
            {
                "question": "Exercise 3 - Q2: Combine the sentences.\nThe Sun is a giant star. It is the center of our solar system.",
                "options": [
                    "The Sun, which is the center of our solar system, is a giant star.",
                    "A giant star is the Sun that is at the center of our solar system.",
                    "The giant star, the Sun, is the center of our solar system.",
                    "Because the Sun is the center of our solar system, it is a giant star."
                ],
                "correct": 0,
                "rationale": "<b>1. Ph√¢n t√≠ch:</b> K·∫øt h·ª£p hai c√¢u d√πng m·ªánh ƒë·ªÅ quan h·ªá.<br><b>2. D·ªãch:</b> M·∫∑t tr·ªùi, trung t√¢m c·ªßa h·ªá m·∫∑t tr·ªùi, l√† m·ªôt ng√¥i sao kh·ªïng l·ªì.<br><b>3. Gi·∫£i th√≠ch:</b> D√πng 'which' b·ªï nghƒ©a cho 'The Sun' ƒë·ªÉ t·∫°o m·ªánh ƒë·ªÅ quan h·ªá n·ªëi c√¢u."
            },
            {
                "question": "Exercise 3 - Q3: Combine the sentences.\nMany famous artists have lived in Paris. Their works of art inspire people worldwide.",
                "options": [
                    "Many famous artists, whose works of art inspire people worldwide, have lived in Paris.",
                    "Paris, a city whose history is rich with culture, has been home to many famous artists.",
                    "We visited the Louvre museum in Paris, which houses masterpieces by famous artists.",
                    "Paris, where works of art inspire people worldwide, is home to many famous artists."
                ],
                "correct": 0,
                "rationale": "<b>1. Ph√¢n t√≠ch:</b> 'Their' (c·ªßa h·ªç) -> d√πng ƒë·∫°i t·ª´ quan h·ªá s·ªü h·ªØu 'whose'.<br><b>2. D·ªãch:</b> Nhi·ªÅu ngh·ªá sƒ© n·ªïi ti·∫øng, nh·ªØng ng∆∞·ªùi c√≥ t√°c ph·∫©m truy·ªÅn c·∫£m h·ª©ng to√†n c·∫ßu, ƒë√£ s·ªëng ·ªü Paris.<br><b>3. Gi·∫£i th√≠ch:</b> Whose thay th·∫ø cho t√≠nh t·ª´ s·ªü h·ªØu ch·ªâ ng∆∞·ªùi trong m·ªánh ƒë·ªÅ quan h·ªá."
            },
            {
                "question": "Exercise 3 - Q4: Combine the sentences.\nIsaac Newton observed the falling apple. He developed the theory of gravity.",
                "options": [
                    "Isaac Newton observed a falling apple, which helped him develop the theory of gravity.",
                    "An apple, which was observed by Isaac Newton, helped him to form his theory of gravity.",
                    "The falling apple, which Isaac Newton observed, led to his theory of gravity.",
                    "Isaac Newton, who developed the theory of gravity, observed the falling apple."
                ],
                "correct": 0,
                "rationale": "<b>1. Ph√¢n t√≠ch:</b> K·∫øt h·ª£p h√†nh ƒë·ªông quan s√°t d·∫´n ƒë·∫øn k·∫øt qu·∫£.<br><b>2. D·ªãch:</b> Isaac Newton quan s√°t qu·∫£ t√°o r∆°i, ƒëi·ªÅu n√†y gi√∫p √¥ng ph√°t tri·ªÉn thuy·∫øt v·∫°n v·∫≠t h·∫•p d·∫´n.<br><b>3. Gi·∫£i th√≠ch:</b> 'Which' ·ªü ƒë√¢y thay th·∫ø cho c·∫£ m·ªánh ƒë·ªÅ ph√≠a tr∆∞·ªõc (vi·ªác quan s√°t t√°o). ƒê√¢y l√† c√°ch n·ªëi c√¢u t·ª± nhi√™n nh·∫•t."
            },
            {
                "question": "Exercise 3 - Q5: Combine the sentences.\nLouis Pasteur developed a vaccine for rabies. It saved countless lives.",
                "options": [
                    "Louis Pasteur developed a vaccine for rabies, which saved countless lives.",
                    "The vaccine for rabies, which was developed by Louis Pasteur, saved countless lives.",
                    "Louis Pasteur's work on rabies resulted in a vaccine that saved countless lives.",
                    "Louis Pasteur, who developed a vaccine for rabies, saved countless lives."
                ],
                "correct": 0,
                "rationale": "<b>1. Ph√¢n t√≠ch:</b> Rabies (b·ªánh d·∫°i), countless (v√¥ s·ªë).<br><b>2. D·ªãch:</b> Louis Pasteur ƒë√£ ph√°t tri·ªÉn v·∫Øc-xin b·ªánh d·∫°i, th·ª© ƒë√£ c·ª©u v√¥ s·ªë m·∫°ng s·ªëng.<br><b>3. Gi·∫£i th√≠ch:</b> 'Which' thay th·∫ø cho danh t·ª´ 'vaccine' ngay tr∆∞·ªõc n√≥."
            },
            {
                "question": "Exercise 3 - Q6: Combine the sentences.\nThe Amazon rainforest is a vast jungle. Humans have lived there for thousands of years.",
                "options": [
                    "The Amazon rainforest, where humans have lived for thousands of years, is a vast jungle.",
                    "Humans have lived in the Amazon rainforest for thousands of years, which is a vast jungle.",
                    "Humans have lived in a vast jungle, which is the Amazon rainforest, for thousands of years.",
                    "Humans have lived in a vast jungle for thousands of years when there was the Amazon rainforest."
                ],
                "correct": 0,
                "rationale": "<b>1. Ph√¢n t√≠ch:</b> There (·ªü ƒë√≥) -> ch·ªâ ƒë·ªãa ƒëi·ªÉm -> d√πng 'Where'.<br><b>2. D·ªãch:</b> R·ª´ng m∆∞a Amazon, n∆°i con ng∆∞·ªùi ƒë√£ s·ªëng h√†ng ng√†n nƒÉm, l√† m·ªôt khu r·ª´ng r·ªông l·ªõn.<br><b>3. Gi·∫£i th√≠ch:</b> D√πng 'where' thay th·∫ø cho 'there' v√† t·∫°o th√†nh m·ªánh ƒë·ªÅ quan h·ªá."
            },
            {
                "question": "Exercise 4 - Q1: Choose the CLOSEST meaning.\nEarth is the only planet with liquid water.",
                "options": [
                    "The only planet with liquid water is Earth.",
                    "There is only liquid water on Earth.",
                    "Earth is the planet with liquid water only.",
                    "Earth is much covered with liquid water."
                ],
                "correct": 0,
                "rationale": "<b>1. Ph√¢n t√≠ch:</b> Only (duy nh·∫•t), liquid water (n∆∞·ªõc l·ªèng).<br><b>2. D·ªãch:</b> H√†nh tinh duy nh·∫•t c√≥ n∆∞·ªõc l·ªèng l√† Tr√°i ƒë·∫•t.<br><b>3. Gi·∫£i th√≠ch:</b> C√¢u ƒë·∫£o ng·ªØ gi·ªØ nguy√™n √Ω nghƒ©a kh·∫≥ng ƒë·ªãnh v·ªã th·∫ø duy nh·∫•t c·ªßa Tr√°i ƒë·∫•t. C√°c c√¢u c√≤n l·∫°i sai nghƒ©a."
            },
            {
                "question": "Exercise 4 - Q2: Choose the CLOSEST meaning.\nWater bodies and landforms are essential habitats for plants and animals.",
                "options": [
                    "Plants and animals need water bodies and landforms for their habitats.",
                    "Essential habitats for plants and animals create water bodies and landforms.",
                    "Water bodies and landforms cover all living habitats.",
                    "Water bodies and landforms need plants and animals."
                ],
                "correct": 0,
                "rationale": "<b>1. Ph√¢n t√≠ch:</b> Essential (thi·∫øt y·∫øu) = Need (c·∫ßn).<br><b>2. D·ªãch:</b> Th·ª±c v·∫≠t v√† ƒë·ªông v·∫≠t c·∫ßn c√°c kh·ªëi n∆∞·ªõc v√† ƒë·ªãa h√¨nh l√†m m√¥i tr∆∞·ªùng s·ªëng.<br><b>3. Gi·∫£i th√≠ch:</b> Di·ªÖn ƒë·∫°t l·∫°i √Ω 'l√† m√¥i tr∆∞·ªùng s·ªëng thi·∫øt y·∫øu' b·∫±ng ƒë·ªông t·ª´ 'need'."
            },
            {
                "question": "Exercise 4 - Q3: Choose the CLOSEST meaning.\nHumans often use natural habitats for farming and housing.",
                "options": [
                    "Natural habitats are often used for farming and housing.",
                    "Humans often use land for farming and housing.",
                    "Natural habitats are also land for farming and housing.",
                    "Humans have always used living habitats to farm."
                ],
                "correct": 0,
                "rationale": "<b>1. Ph√¢n t√≠ch:</b> Chuy·ªÉn sang c√¢u b·ªã ƒë·ªông.<br><b>2. D·ªãch:</b> C√°c m√¥i tr∆∞·ªùng s·ªëng t·ª± nhi√™n th∆∞·ªùng ƒë∆∞·ª£c s·ª≠ d·ª•ng cho canh t√°c v√† nh√† ·ªü.<br><b>3. Gi·∫£i th√≠ch:</b> Ch·ªß ƒë·ªông: Humans use habitats -> B·ªã ƒë·ªông: Habitats are used (by humans - l∆∞·ª£c b·ªè)."
            },
            {
                "question": "Exercise 4 - Q4: Choose the CLOSEST meaning.\nThe Arctic Ocean ice and water make up habitats for polar bears.",
                "options": [
                    "The habitats for polar bears are Arctic Ocean ice and water.",
                    "Ice and water in the Arctic Ocean are for polar bears.",
                    "Habitats for polar bears is ice water.",
                    "The Arctic Ocean makes up habitats for animals like polar bears."
                ],
                "correct": 0,
                "rationale": "<b>1. Ph√¢n t√≠ch:</b> Make up (t·∫°o th√†nh) -> Are (l√†/c·∫•u th√†nh).<br><b>2. D·ªãch:</b> M√¥i tr∆∞·ªùng s·ªëng c·ªßa g·∫•u b·∫Øc c·ª±c l√† bƒÉng v√† n∆∞·ªõc B·∫Øc BƒÉng D∆∞∆°ng.<br><b>3. Gi·∫£i th√≠ch:</b> ƒê·∫£o ng·ªØ ƒë·ªÉ nh·∫•n m·∫°nh ƒë·ªãnh nghƒ©a m√¥i tr∆∞·ªùng s·ªëng."
            },
            {
                "question": "Exercise 4 - Q5: Choose the CLOSEST meaning.\nThe flora and fauna on Earth create an ecological balance.",
                "options": [
                    "Thanks to the flora and fauna, there is ecological balance on Earth.",
                    "There is ecological balance due to the flora and fauna.",
                    "Earth creates flora and fauna for ecological balance.",
                    "The flora and fauna are results of an ecological balance."
                ],
                "correct": 0,
                "rationale": "<b>1. Ph√¢n t√≠ch:</b> Create (t·∫°o ra) -> Thanks to... there is (Nh·ªù c√≥... m√† c√≥).<br><b>2. D·ªãch:</b> Nh·ªù c√≥ h·ªá th·ª±c v·∫≠t v√† ƒë·ªông v·∫≠t, c√≥ s·ª± c√¢n b·∫±ng sinh th√°i tr√™n Tr√°i ƒë·∫•t.<br><b>3. Gi·∫£i th√≠ch:</b> Di·ªÖn ƒë·∫°t l·∫°i nguy√™n nh√¢n - k·∫øt qu·∫£. C√¢u A ƒë·∫ßy ƒë·ªß √Ω nghƒ©a (c·∫£ on Earth) nh·∫•t."
            }
        ];

        // --- STATE ---
        let currentQuestion = 0;
        let score = 0;
        const totalQuestions = quizData.length;

        // --- ELEMENTS ---
        const els = {
            questionText: document.getElementById('question-text'),
            optionsContainer: document.getElementById('options-container'),
            explanationBox: document.getElementById('explanation-box'),
            explanationText: document.getElementById('explanation-text'),
            nextBtn: document.getElementById('next-btn'),
            currentQ: document.getElementById('current-q'),
            totalQ: document.getElementById('total-q'),
            score: document.getElementById('score'),
            progressBar: document.getElementById('progress-bar'),
            quizArea: document.getElementById('quiz-area'),
            endScreen: document.getElementById('end-screen'),
            finalScore: document.getElementById('final-score'),
            praiseText: document.getElementById('praise-text')
        };

        // --- AUDIO ENGINE (No external files needed) ---
        const audioCtx = new (window.AudioContext || window.webkitAudioContext)();
        
        function playSound(type) {
            if (audioCtx.state === 'suspended') {
                audioCtx.resume();
            }
            const osc = audioCtx.createOscillator();
            const gainNode = audioCtx.createGain();
            
            osc.connect(gainNode);
            gainNode.connect(audioCtx.destination);
            
            if (type === 'correct') {
                // Ding sound (High sine wave)
                osc.type = 'sine';
                osc.frequency.setValueAtTime(600, audioCtx.currentTime);
                osc.frequency.exponentialRampToValueAtTime(1200, audioCtx.currentTime + 0.1);
                gainNode.gain.setValueAtTime(0.3, audioCtx.currentTime);
                gainNode.gain.exponentialRampToValueAtTime(0.01, audioCtx.currentTime + 0.5);
                osc.start();
                osc.stop(audioCtx.currentTime + 0.5);
            } else {
                // Buzz sound (Low sawtooth)
                osc.type = 'sawtooth';
                osc.frequency.setValueAtTime(150, audioCtx.currentTime);
                osc.frequency.linearRampToValueAtTime(100, audioCtx.currentTime + 0.3);
                gainNode.gain.setValueAtTime(0.3, audioCtx.currentTime);
                gainNode.gain.linearRampToValueAtTime(0.01, audioCtx.currentTime + 0.3);
                osc.start();
                osc.stop(audioCtx.currentTime + 0.3);
            }
        }

        // --- CONFETTI ENGINE ---
        function fireConfetti() {
            const canvas = document.getElementById('confetti-canvas');
            const ctx = canvas.getContext('2d');
            canvas.width = window.innerWidth;
            canvas.height = window.innerHeight;
            
            const particles = [];
            const particleCount = 100;
            const colors = ['#8854C0', '#00C9A7', '#FF9F43', '#FF4757', '#F368E0'];

            for (let i = 0; i < particleCount; i++) {
                particles.push({
                    x: canvas.width / 2,
                    y: canvas.height / 2,
                    w: Math.random() * 10 + 5,
                    h: Math.random() * 5 + 5,
                    color: colors[Math.floor(Math.random() * colors.length)],
                    vx: (Math.random() - 0.5) * 20,
                    vy: (Math.random() - 0.5) * 20,
                    gravity: 0.5
                });
            }

            function draw() {
                ctx.clearRect(0, 0, canvas.width, canvas.height);
                let active = false;
                particles.forEach(p => {
                    p.x += p.vx;
                    p.y += p.vy;
                    p.vy += p.gravity;
                    p.vx *= 0.95;
                    p.vy *= 0.95;

                    ctx.fillStyle = p.color;
                    ctx.fillRect(p.x, p.y, p.w, p.h);

                    if (p.y < canvas.height) active = true;
                });

                if (active) requestAnimationFrame(draw);
                else ctx.clearRect(0,0, canvas.width, canvas.height);
            }
            draw();
        }

        // --- HELPER FUNCTION: SHUFFLE ARRAY ---
        function shuffleArray(array) {
            for (let i = array.length - 1; i > 0; i--) {
                const j = Math.floor(Math.random() * (i + 1));
                [array[i], array[j]] = [array[j], array[i]];
            }
            return array;
        }

        // --- GAME LOGIC ---

        function initQuiz() {
            els.totalQ.innerText = totalQuestions;
            loadQuestion();
        }

        function loadQuestion() {
            const data = quizData[currentQuestion];
            
            // Reset UI
            els.explanationBox.style.display = 'none';
            els.nextBtn.style.display = 'none';
            els.optionsContainer.innerHTML = '';
            
            // Set Progress
            els.currentQ.innerText = currentQuestion + 1;
            els.progressBar.style.width = `${((currentQuestion) / totalQuestions) * 100}%`;

            // Set Text
            // Convert \n to <br> for better display
            els.questionText.innerHTML = data.question.replace(/\n/g, '<br>');

            // --- SHUFFLE OPTIONS LOGIC ---
            // Create options with their original index to track correct answer
            let mappedOptions = data.options.map((opt, i) => ({ text: opt, originalIndex: i }));
            
            // Shuffle the array of options
            shuffleArray(mappedOptions);

            // Create Buttons based on Shuffled Order
            mappedOptions.forEach((optObj, index) => {
                const btn = document.createElement('button');
                btn.className = 'option-btn';
                btn.innerText = optObj.text;
                // Store the original index in dataset to find it later
                btn.dataset.originalIndex = optObj.originalIndex;
                
                // When clicked, check against the original index (which is always 0 for correct in data)
                btn.onclick = () => checkAnswer(optObj.originalIndex, btn);
                els.optionsContainer.appendChild(btn);
            });
        }

        function checkAnswer(originalIndex, btnElement) {
            // Prevent multiple clicks
            const allBtns = document.querySelectorAll('.option-btn');
            allBtns.forEach(b => b.disabled = true);

            const data = quizData[currentQuestion];
            // Compare original index with data.correct (which is 0)
            const isCorrect = originalIndex === data.correct;

            if (isCorrect) {
                btnElement.classList.add('correct');
                score++;
                els.score.innerText = score;
                playSound('correct');
                fireConfetti();
            } else {
                btnElement.classList.add('wrong');
                // Highlight correct answer by searching for button with dataset.originalIndex === 0
                allBtns.forEach(btn => {
                    if (parseInt(btn.dataset.originalIndex) === data.correct) {
                        btn.classList.add('correct');
                    }
                });
                playSound('wrong');
            }

            // Show Explanation
            els.explanationText.innerHTML = data.rationale;
            els.explanationBox.style.display = 'block';
            els.nextBtn.style.display = 'block';

            // Scroll to explanation on mobile
            if(window.innerWidth < 600) {
                setTimeout(() => {
                    els.explanationBox.scrollIntoView({behavior: "smooth"});
                }, 300);
            }
        }

        function nextQuestion() {
            currentQuestion++;
            if (currentQuestion < totalQuestions) {
                loadQuestion();
            } else {
                finishQuiz();
            }
        }

        function finishQuiz() {
            els.quizArea.style.display = 'none';
            els.endScreen.style.display = 'block';
            els.progressBar.style.width = '100%';
            els.finalScore.innerText = `${score}/${totalQuestions}`;
            
            // Praise Logic
            const percentage = (score / totalQuestions) * 100;
            let praise = "";
            if (percentage === 100) praise = "Tuy·ªát v·ªùi! B·∫°n l√† thi√™n t√†i ng·ªØ ph√°p! üåü";
            else if (percentage >= 80) praise = "L√†m r·∫•t t·ªët! C√¥ Mai An r·∫•t t·ª± h√†o v·ªÅ b·∫°n! üåà";
            else if (percentage >= 50) praise = "Kh√° l·∫Øm! C·ªë g·∫Øng luy·ªán t·∫≠p th√™m m·ªôt ch√∫t n·ªØa nh√©! üí™";
            else praise = "ƒê·ª´ng n·∫£n l√≤ng! H√£y xem l·∫°i ph·∫ßn gi·∫£i th√≠ch v√† th·ª≠ l·∫°i nh√©! üçÄ";
            
            els.praiseText.innerText = praise;
            playSound('correct'); // Victory sound
            fireConfetti();
        }

        function restartQuiz() {
            currentQuestion = 0;
            score = 0;
            els.score.innerText = '0';
            els.endScreen.style.display = 'none';
            els.quizArea.style.display = 'block';
            loadQuestion();
        }

        // Start
        initQuiz();

    </script>
</body>
</html>
