<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Luy·ªán t·∫≠p Th√¨ Hi·ªán T·∫°i Ti·∫øp Di·ªÖn - Ms Mai An ULIS</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Nunito:wght@400;600;700;800&display=swap" rel="stylesheet">
    <script src="https://cdn.jsdelivr.net/npm/canvas-confetti@1.6.0/dist/confetti.browser.min.js"></script>
    <style>
        :root {
            --primary: #8854C0;
            --secondary: #00C9A7;
            --correct: #00D26A;
            --wrong: #FF4757;
            --bg-color: #f0f4f8;
        }

        body {
            font-family: 'Nunito', sans-serif;
            background-color: var(--bg-color);
            background-image: radial-gradient(#8854c033 1px, transparent 1px);
            background-size: 20px 20px;
            min-height: 100vh;
            display: flex;
            flex-direction: column;
            align-items: center;
            padding: 20px;
        }

        .header-small {
            font-size: 0.9rem;
            color: var(--primary);
            font-weight: 700;
            margin-bottom: 5px;
            opacity: 0.8;
        }

        .quiz-container {
            width: 100%;
            max-width: 700px;
            perspective: 1000px;
        }

        .card {
            background: white;
            border-radius: 25px;
            padding: 30px;
            box-shadow: 0 10px 0 #d1d9e6;
            transition: all 0.3s ease;
            margin-top: 20px;
        }

        .question-text {
            font-size: 1.4rem;
            font-weight: 800;
            color: #2d3436;
            margin-bottom: 25px;
            line-height: 1.4;
        }

        .option-btn {
            display: block;
            width: 100%;
            padding: 15px 20px;
            margin-bottom: 12px;
            text-align: left;
            background: white;
            border: 3px solid #e0e0e0;
            border-radius: 18px;
            font-size: 1.1rem;
            font-weight: 700;
            color: #4b4b4b;
            cursor: pointer;
            box-shadow: 0 5px 0 #e0e0e0;
            transition: all 0.1s;
            position: relative;
        }

        .option-btn:hover:not(:disabled) {
            transform: translateY(-2px);
            border-color: var(--primary);
            color: var(--primary);
            box-shadow: 0 7px 0 var(--primary);
            scale: 1.02;
        }

        .option-btn:active:not(:disabled) {
            transform: translateY(2px);
            box-shadow: 0 2px 0 var(--primary);
        }

        .option-btn.correct {
            background-color: var(--correct) !important;
            border-color: #009d50 !important;
            color: white !important;
            box-shadow: 0 5px 0 #009d50 !important;
        }

        .option-btn.wrong {
            background-color: var(--wrong) !important;
            border-color: #c0392b !important;
            color: white !important;
            box-shadow: 0 5px 0 #c0392b !important;
        }

        .explanation-box {
            margin-top: 20px;
            padding: 20px;
            border-radius: 18px;
            background: #f1f2f6;
            border-left: 8px solid var(--primary);
            display: none;
            animation: slideIn 0.4s ease-out;
        }

        @keyframes slideIn {
            from { opacity: 0; transform: translateY(10px); }
            to { opacity: 1; transform: translateY(0); }
        }

        .shake {
            animation: shake 0.5s cubic-bezier(.36,.07,.19,.97) both;
        }

        @keyframes shake {
            10%, 90% { transform: translate3d(-1px, 0, 0); }
            20%, 80% { transform: translate3d(2px, 0, 0); }
            30%, 50%, 70% { transform: translate3d(-4px, 0, 0); }
            40%, 60% { transform: translate3d(4px, 0, 0); }
        }

        .progress-bar {
            width: 100%;
            height: 12px;
            background: #e0e0e0;
            border-radius: 10px;
            margin-bottom: 20px;
            overflow: hidden;
        }

        .progress-inner {
            height: 100%;
            background: linear-gradient(to right, var(--secondary), var(--primary));
            width: 0%;
            transition: width 0.3s ease;
        }

        .modal {
            display: none;
            position: fixed;
            z-index: 100;
            left: 0; top: 0; width: 100%; height: 100%;
            background: rgba(0,0,0,0.7);
            backdrop-filter: blur(5px);
            align-items: center;
            justify-content: center;
        }

        .modal-content {
            background: white;
            padding: 40px;
            border-radius: 30px;
            text-align: center;
            max-width: 500px;
            width: 90%;
            animation: popUp 0.5s cubic-bezier(0.175, 0.885, 0.32, 1.275);
        }

        @keyframes popUp {
            from { scale: 0.5; opacity: 0; }
            to { scale: 1; opacity: 1; }
        }

        .btn-next {
            background: var(--primary);
            color: white;
            padding: 12px 30px;
            border-radius: 15px;
            font-weight: 800;
            margin-top: 20px;
            box-shadow: 0 5px 0 #6c449b;
            cursor: pointer;
        }

        .btn-next:hover {
            transform: translateY(-2px);
            box-shadow: 0 7px 0 #6c449b;
        }

        .glossary-table {
            width: 100%;
            border-collapse: collapse;
            margin-top: 15px;
            font-size: 0.9rem;
        }

        .glossary-table th, .glossary-table td {
            border: 1px solid #ddd;
            padding: 8px;
            text-align: left;
        }

        .glossary-table th {
            background-color: var(--secondary);
            color: white;
        }
    </style>
</head>
<body>

    <div class="header-small">Gi√°o vi√™n t·∫°o: Ms Mai An ULIS</div>
    <h1 class="text-3xl font-extrabold text-[#8854C0] mb-6 text-center">Th√¨ Hi·ªán T·∫°i Ti·∫øp Di·ªÖn - Global Success 6</h1>

    <div class="quiz-container">
        <div class="progress-bar">
            <div class="progress-inner" id="progressBar"></div>
        </div>

        <div id="quiz-card" class="card">
            <!-- Content will be injected by JS -->
        </div>

        <div id="explanation" class="explanation-box">
            <!-- Explanation will be injected by JS -->
        </div>

        <div class="flex justify-between items-center mt-6">
            <div class="font-bold text-gray-500" id="question-counter">C√¢u 1/30</div>
            <button id="next-btn" class="btn-next hidden" onclick="loadNextQuestion()">Ti·∫øp theo ‚ûî</button>
            <button id="finish-btn" class="btn-next hidden" onclick="finishQuiz()">N·ªôp b√†i ‚ûî</button>
        </div>
    </div>

    <!-- Final Result Modal -->
    <div id="resultModal" class="modal">
        <div class="modal-content">
            <h2 class="text-4xl font-black text-primary mb-4">Ho√†n th√†nh!</h2>
            <div id="finalScore" class="text-6xl font-black text-[#00C9A7] mb-4">0/30</div>
            <p id="feedbackText" class="text-xl font-bold text-gray-600 mb-6"></p>
            <button onclick="location.reload()" class="btn-next">L√†m l·∫°i b√†i ‚ûî</button>
        </div>
    </div>

    <!-- Sounds (Using Public Chime/Buzz) -->
    <audio id="correctSound" src="https://assets.mixkit.co/active_storage/sfx/2000/2000-preview.mp3"></audio>
    <audio id="wrongSound" src="https://assets.mixkit.co/active_storage/sfx/2020/2020-preview.mp3"></audio>

    <script>
        const quizData = [
            {
                "question": "Look! The students ______ football in the playground.",
                "options": ["are playing", "play", "is playing", "plays"],
                "answer": "are playing",
                "explanation": {
                    "translation": "Nh√¨n k√¨a! C√°c h·ªçc sinh ƒëang ch∆°i b√≥ng ƒë√° trong s√¢n ch∆°i.",
                    "analysis": [
                        "A. are playing (v phrase): ƒëang ch∆°i (ph√π h·ª£p s·ªë nhi·ªÅu).",
                        "B. play (v): ch∆°i (hi·ªán t·∫°i ƒë∆°n - th√≥i quen).",
                        "C. is playing (v phrase): ƒëang ch∆°i (d√†nh cho s·ªë √≠t).",
                        "D. plays (v): ch∆°i (s·ªë √≠t hi·ªán t·∫°i ƒë∆°n)."
                    ],
                    "whyCorrect": "D·∫•u hi·ªáu 'Look!' b√°o hi·ªáu h√†nh ƒë·ªông ƒëang di·ªÖn ra. Ch·ªß ng·ªØ 'The students' l√† danh t·ª´ s·ªë nhi·ªÅu n√™n d√πng tobe 'are' + V-ing.",
                    "whyWrong": "B v√† D d√πng th√¨ Hi·ªán t·∫°i ƒë∆°n l√† sai ng·ªØ c·∫£nh 'Look!'. C sai v√¨ d√πng 'is' cho ch·ªß ng·ªØ s·ªë nhi·ªÅu."
                }
            },
            {
                "question": "My sister ______ her homework right now. She is sleeping.",
                "options": ["isn't doing", "not doing", "doesn't do", "aren't doing"],
                "answer": "isn't doing",
                "explanation": {
                    "translation": "Em g√°i t√¥i ƒëang kh√¥ng l√†m b√†i t·∫≠p v·ªÅ nh√† ngay l√∫c n√†y. Em ·∫•y ƒëang ng·ªß.",
                    "analysis": [
                        "A. isn't doing (v phrase): ƒëang kh√¥ng l√†m (s·ªë √≠t).",
                        "B. not doing: thi·∫øu ƒë·ªông t·ª´ tobe.",
                        "C. doesn't do: hi·ªán t·∫°i ƒë∆°n (sai th√¨).",
                        "D. aren't doing: ƒëang kh√¥ng l√†m (s·ªë nhi·ªÅu)."
                    ],
                    "whyCorrect": "D·∫•u hi·ªáu 'right now'. V·∫ø sau 'She is sleeping' ch·ª©ng t·ªè v·∫ø ƒë·∫ßu ph·∫£i mang nghƒ©a ph·ªß ƒë·ªãnh 'kh√¥ng ƒëang l√†m'. 'My sister' l√† s·ªë √≠t n√™n d√πng 'isn't'.",
                    "whyWrong": "B thi·∫øu 'is'. C sai th√¨. D sai ch·ªß ng·ªØ (s·ªë √≠t d√πng is, kh√¥ng d√πng are)."
                }
            },
            {
                "question": "______ Mai and Lan ______ to music at the moment?",
                "options": ["Are / listening", "Is / listening", "Do / listen", "Does / listen"],
                "answer": "Are / listening",
                "explanation": {
                    "translation": "Mai v√† Lan c√≥ ƒëang nghe nh·∫°c v√†o l√∫c n√†y kh√¥ng?",
                    "analysis": [
                        "A. Are / listening: ƒêang nghe (s·ªë nhi·ªÅu).",
                        "B. Is / listening: ƒêang nghe (s·ªë √≠t).",
                        "C. Do / listen: Hi·ªán t·∫°i ƒë∆°n.",
                        "D. Does / listen: Hi·ªán t·∫°i ƒë∆°n."
                    ],
                    "whyCorrect": "'At the moment' l√† d·∫•u hi·ªáu ti·∫øp di·ªÖn. Mai and Lan (2 ng∆∞·ªùi) l√† s·ªë nhi·ªÅu, d√πng c·∫•u tr√∫c: Are + S + V-ing?",
                    "whyWrong": "B sai tobe. C v√† D sai th√¨."
                }
            },
            {
                "question": "Be quiet! The baby ______ in the bedroom.",
                "options": ["sleeps", "is sleeping", "are sleeping", "sleeping"],
                "answer": "is sleeping",
                "explanation": {
                    "translation": "Tr·∫≠t t·ª± n√†o! Em b√© ƒëang ng·ªß trong ph√≤ng ng·ªß.",
                    "analysis": [
                        "A. sleeps: ng·ªß (hi·ªán t·∫°i ƒë∆°n).",
                        "B. is sleeping: ƒëang ng·ªß (s·ªë √≠t).",
                        "C. are sleeping: ƒëang ng·ªß (s·ªë nhi·ªÅu).",
                        "D. sleeping: thi·∫øu tobe."
                    ],
                    "whyCorrect": "'Be quiet!' l√† m·ªánh l·ªánh th·ª©c, b√°o hi·ªáu h√†nh ƒë·ªông ƒëang di·ªÖn ra. The baby (1 em b√©) l√† s·ªë √≠t -> is sleeping.",
                    "whyWrong": "A sai th√¨. C sai ng√¥i. D sai c·∫•u tr√∫c."
                }
            },
            {
                "question": "What ______ you ______ now?",
                "options": ["are / reading", "do / read", "are / read", "is / reading"],
                "answer": "are / reading",
                "explanation": {
                    "translation": "B·∫°n ƒëang ƒë·ªçc c√°i g√¨ b√¢y gi·ªù v·∫≠y?",
                    "analysis": [
                        "A. are / reading: ƒëang ƒë·ªçc (s·ªë nhi·ªÅu/you).",
                        "B. do / read: hi·ªán t·∫°i ƒë∆°n.",
                        "C. are / read: thi·∫øu V-ing.",
                        "D. is / reading: sai tobe cho 'you'."
                    ],
                    "whyCorrect": "C√≥ 'now' v√† h·ªèi v·ªÅ h√†nh ƒë·ªông hi·ªán t·∫°i. You ƒëi v·ªõi are.",
                    "whyWrong": "B sai th√¨. C sai d·∫°ng ƒë·ªông t·ª´. D sai tobe."
                }
            },
            {
                "question": "We ______ for our school bus right now.",
                "options": ["are waiting", "waiting", "wait", "is waiting"],
                "answer": "are waiting",
                "explanation": {
                    "translation": "Ch√∫ng t√¥i ƒëang ch·ªù xe bu√Ωt c·ªßa tr∆∞·ªùng ngay l√∫c n√†y.",
                    "analysis": [
                        "A. are waiting: ƒëang ch·ªù.",
                        "B. waiting: thi·∫øu tobe.",
                        "C. wait: hi·ªán t·∫°i ƒë∆°n.",
                        "D. is waiting: sai tobe cho 'We'."
                    ],
                    "whyCorrect": "Right now -> Ti·∫øp di·ªÖn. We + are + V-ing.",
                    "whyWrong": "B, C, D ƒë·ªÅu vi ph·∫°m quy t·∫Øc chia ƒë·ªông t·ª´ c·ªßa 'We' ·ªü th√¨ ti·∫øp di·ªÖn."
                }
            },
            {
                "question": "Mr. Nam ______ to work today. He is taking the bus.",
                "options": ["isn't driving", "not driving", "doesn't drive", "don't drive"],
                "answer": "isn't driving",
                "explanation": {
                    "translation": "Th·∫ßy Nam ƒëang kh√¥ng l√°i xe ƒëi l√†m h√¥m nay. Th·∫ßy ·∫•y ƒëang ƒëi xe bu√Ωt.",
                    "analysis": [
                        "A. isn't driving: ƒëang kh√¥ng l√°i.",
                        "B. not driving: thi·∫øu tobe.",
                        "C. doesn't drive: hi·ªán t·∫°i ƒë∆°n.",
                        "D. don't drive: hi·ªán t·∫°i ƒë∆°n."
                    ],
                    "whyCorrect": "D√πng ti·∫øp di·ªÖn ƒë·ªÉ t·∫£ s·ª± thay ƒë·ªïi t·∫°m th·ªùi 'today' (h√¥m nay kh√°c m·ªçi khi). V√¨ ƒëang ƒëi bus n√™n 'kh√¥ng l√°i xe'. Mr. Nam l√† s·ªë √≠t.",
                    "whyWrong": "B thi·∫øu tobe. C, D d√πng cho th√≥i quen l√¢u d√†i, kh√¥ng h·ª£p ng·ªØ c·∫£nh c·ª• th·ªÉ 'today'."
                }
            },
            {
                "question": "Where is your brother? - He ______ in the kitchen.",
                "options": ["cooks", "is cooking", "are cooking", "cooking"],
                "answer": "is cooking",
                "explanation": {
                    "translation": "Anh trai b·∫°n ƒë√¢u r·ªìi? - Anh ·∫•y ƒëang n·∫•u ƒÉn trong b·∫øp.",
                    "analysis": [
                        "A. cooks: n·∫•u (th√≥i quen).",
                        "B. is cooking: ƒëang n·∫•u.",
                        "C. are cooking: sai tobe.",
                        "D. cooking: thi·∫øu tobe."
                    ],
                    "whyCorrect": "H·ªèi 'Where is...?' ng·ª• √Ω h·ªèi h√†nh ƒë·ªông ƒëang l√†m ngay b√¢y gi·ªù. He -> is cooking.",
                    "whyWrong": "A sai th√¨. C sai ng√¥i. D sai c·∫•u tr√∫c."
                }
            },
            {
                "question": "Listen! Someone ______ the piano.",
                "options": ["is playing", "plays", "are playing", "play"],
                "answer": "is playing",
                "explanation": {
                    "translation": "Nghe k√¨a! Ai ƒë√≥ ƒëang ch∆°i ƒë√†n piano.",
                    "analysis": [
                        "A. is playing: ƒëang ch∆°i.",
                        "B. plays: hi·ªán t·∫°i ƒë∆°n.",
                        "C. are playing: s·ªë nhi·ªÅu.",
                        "D. play: hi·ªán t·∫°i ƒë∆°n."
                    ],
                    "whyCorrect": "D·∫•u hi·ªáu 'Listen!'. Someone (ai ƒë√≥) l√† ƒë·∫°i t·ª´ b·∫•t ƒë·ªãnh lu√¥n chia s·ªë √≠t.",
                    "whyWrong": "B, D sai th√¨. C sai v√¨ Someone l√† s·ªë √≠t."
                }
            },
            {
                "question": "They ______ uniforms today. It's Sunday.",
                "options": ["aren't wearing", "don't wear", "isn't wearing", "not wearing"],
                "answer": "aren't wearing",
                "explanation": {
                    "translation": "H·ªç ƒëang kh√¥ng m·∫∑c ƒë·ªìng ph·ª•c h√¥m nay. Nay l√† Ch·ªß nh·∫≠t.",
                    "analysis": [
                        "A. aren't wearing: ƒëang kh√¥ng m·∫∑c.",
                        "B. don't wear: kh√¥ng m·∫∑c (th√≥i quen).",
                        "C. isn't wearing: s·ªë √≠t.",
                        "D. not wearing: thi·∫øu tobe."
                    ],
                    "whyCorrect": "Today + It's Sunday -> h√†nh ƒë·ªông c·ª• th·ªÉ h√¥m nay. They + are not + wearing.",
                    "whyWrong": "B mang nghƒ©a 'th∆∞·ªùng ng√†y kh√¥ng m·∫∑c'. C sai ch·ªß ng·ªØ. D thi·∫øu tobe."
                }
            },
            {
                "question": "______ Hoa ______ English vocabulary right now?",
                "options": ["Is / studying", "Does / study", "Do / study", "Are / studying"],
                "answer": "Is / studying",
                "explanation": {
                    "translation": "Hoa c√≥ ƒëang h·ªçc t·ª´ v·ª±ng ti·∫øng Anh ngay l√∫c n√†y kh√¥ng?",
                    "analysis": [
                        "A. Is / studying: ƒêang h·ªçc.",
                        "B. Does / study: Hi·ªán t·∫°i ƒë∆°n.",
                        "C. Do / study: Hi·ªán t·∫°i ƒë∆°n.",
                        "D. Are / studying: S·ªë nhi·ªÅu."
                    ],
                    "whyCorrect": "Right now -> Ti·∫øp di·ªÖn. Hoa l√† t√™n ri√™ng (s·ªë √≠t) d√πng Is.",
                    "whyWrong": "B, C sai th√¨. D sai ng√¥i."
                }
            },
            {
                "question": "I ______ a letter to my pen friend in London.",
                "options": ["am writing", "am writeing", "write", "writing"],
                "answer": "am writing",
                "explanation": {
                    "translation": "T√¥i ƒëang vi·∫øt m·ªôt l√° th∆∞ cho b·∫°n qua th∆∞ ·ªü London.",
                    "analysis": [
                        "A. am writing: ƒëang vi·∫øt (ƒë√∫ng ch√≠nh t·∫£).",
                        "B. am writeing: sai ch√≠nh t·∫£.",
                        "C. write: vi·∫øt.",
                        "D. writing: thi·∫øu tobe."
                    ],
                    "whyCorrect": "ƒêang di·ªÖn ra. I + am + V-ing. ƒê·ªông t·ª´ t·∫≠n c√πng l√† 'e' ph·∫£i b·ªè 'e' r·ªìi m·ªõi th√™m 'ing'.",
                    "whyWrong": "B sai quy t·∫Øc vi·∫øt. C sai th√¨. D thi·∫øu tobe."
                }
            },
            {
                "question": "Look at the teacher! He ______ a new math problem.",
                "options": ["is explaining", "explains", "explaining", "are explaining"],
                "answer": "is explaining",
                "explanation": {
                    "translation": "Nh√¨n th·∫ßy gi√°o k√¨a! Th·∫ßy ·∫•y ƒëang gi·∫£i th√≠ch m·ªôt b√†i to√°n m·ªõi.",
                    "analysis": [
                        "A. is explaining: ƒëang gi·∫£i th√≠ch.",
                        "B. explains: gi·∫£i th√≠ch.",
                        "C. explaining: thi·∫øu tobe.",
                        "D. are explaining: s·ªë nhi·ªÅu."
                    ],
                    "whyCorrect": "D·∫•u hi·ªáu 'Look at!'. He -> is explaining.",
                    "whyWrong": "B sai th√¨. C thi·∫øu tobe. D sai ng√¥i."
                }
            },
            {
                "question": "The dog ______ under the table. It is playing in the garden.",
                "options": ["isn't lying", "not lying", "doesn't lie", "isn't lieing"],
                "answer": "isn't lying",
                "explanation": {
                    "translation": "Con ch√≥ ƒëang kh√¥ng n·∫±m d∆∞·ªõi g·∫ßm b√†n. N√≥ ƒëang ch∆°i ngo√†i v∆∞·ªùn.",
                    "analysis": [
                        "A. isn't lying: ƒëang kh√¥ng n·∫±m (ƒë√∫ng ch√≠nh t·∫£).",
                        "B. not lying: thi·∫øu tobe.",
                        "C. doesn't lie: hi·ªán t·∫°i ƒë∆°n.",
                        "D. isn't lieing: sai ch√≠nh t·∫£."
                    ],
                    "whyCorrect": "V√¨ n√≥ ƒëang ch∆°i ·ªü v∆∞·ªùn n√™n kh√¥ng n·∫±m d∆∞·ªõi b√†n. 'Lie' t·∫≠n c√πng l√† 'ie' ƒë·ªïi th√†nh 'y' r·ªìi th√™m 'ing' -> lying.",
                    "whyWrong": "D sai quy t·∫Øc bi·∫øn ƒë·ªïi ie -> y."
                }
            },
            {
                "question": "What ______ the students ______ in the classroom?",
                "options": ["are / doing", "is / doing", "do / do", "are / do"],
                "answer": "are / doing",
                "explanation": {
                    "translation": "C√°c h·ªçc sinh ƒëang l√†m g√¨ trong l·ªõp h·ªçc v·∫≠y?",
                    "analysis": [
                        "A. are / doing: ƒëang l√†m.",
                        "B. is / doing: s·ªë √≠t.",
                        "C. do / do: hi·ªán t·∫°i ƒë∆°n.",
                        "D. are / do: thi·∫øu ing."
                    ],
                    "whyCorrect": "H√†nh ƒë·ªông ƒëang di·ªÖn ra. The students (s·ªë nhi·ªÅu) d√πng are.",
                    "whyWrong": "B sai ng√¥i. C sai th√¨. D sai c·∫•u tr√∫c (sau tobe ph·∫£i l√† V-ing)."
                }
            },
            {
                "question": "Be careful! The car ______ very fast.",
                "options": ["is coming", "comes", "coming", "are coming"],
                "answer": "is coming",
                "explanation": {
                    "translation": "C·∫©n th·∫≠n ƒë·∫•y! Chi·∫øc xe ƒëang lao t·ªõi r·∫•t nhanh.",
                    "analysis": [
                        "A. is coming: ƒëang t·ªõi.",
                        "B. comes: hi·ªán t·∫°i ƒë∆°n.",
                        "C. coming: thi·∫øu tobe.",
                        "D. are coming: s·ªë nhi·ªÅu."
                    ],
                    "whyCorrect": "C·∫£nh b√°o 'Be careful!' v·ªÅ m·ªôt h√†nh ƒë·ªông ƒëang t·ªõi. The car (s·ªë √≠t) -> is coming.",
                    "whyWrong": "B sai th√¨. C thi·∫øu tobe. D sai ng√¥i."
                }
            },
            {
                "question": "My father ______ plants in the garden, he is watering them.",
                "options": ["isn't planting", "not planting", "doesn't plant", "don't plant"],
                "answer": "isn't planting",
                "explanation": {
                    "translation": "B·ªë t√¥i ƒëang kh√¥ng tr·ªìng c√¢y trong v∆∞·ªùn, √¥ng ·∫•y ƒëang t∆∞·ªõi ch√∫ng.",
                    "analysis": [
                        "A. isn't planting: ƒëang kh√¥ng tr·ªìng.",
                        "B. not planting: thi·∫øu tobe.",
                        "C. doesn't plant: hi·ªán t·∫°i ƒë∆°n.",
                        "D. don't plant: hi·ªán t·∫°i ƒë∆°n."
                    ],
                    "whyCorrect": "V√¨ √¥ng ·∫•y ƒëang t∆∞·ªõi n√™n kh√¥ng th·ªÉ l√† ƒëang tr·ªìng. 'My father' l√† s·ªë √≠t.",
                    "whyWrong": "B thi·∫øu tobe. C, D sai th√¨."
                }
            },
            {
                "question": "______ your parents ______ TV now?",
                "options": ["Are / watching", "Is / watching", "Do / watch", "Are / watch"],
                "answer": "Are / watching",
                "explanation": {
                    "translation": "B·ªë m·∫π b·∫°n c√≥ ƒëang xem TV b√¢y gi·ªù kh√¥ng?",
                    "analysis": [
                        "A. Are / watching: ƒêang xem (s·ªë nhi·ªÅu).",
                        "B. Is / watching: ƒêang xem (s·ªë √≠t).",
                        "C. Do / watch: Hi·ªán t·∫°i ƒë∆°n.",
                        "D. Are / watch: Thi·∫øu V-ing."
                    ],
                    "whyCorrect": "D·∫•u hi·ªáu 'now'. 'Your parents' l√† s·ªë nhi·ªÅu -> d√πng Are.",
                    "whyWrong": "B sai ng√¥i. C sai th√¨. D sai c·∫•u tr√∫c."
                }
            },
            {
                "question": "Hurry up! The bus ______.",
                "options": ["is leaving", "leaves", "leaving", "are leaving"],
                "answer": "is leaving",
                "explanation": {
                    "translation": "Nhanh l√™n! Xe bu√Ωt ƒëang r·ªùi ƒëi r·ªìi.",
                    "analysis": [
                        "A. is leaving: ƒëang r·ªùi ƒëi.",
                        "B. leaves: hi·ªán t·∫°i ƒë∆°n.",
                        "C. leaving: thi·∫øu tobe.",
                        "D. are leaving: s·ªë nhi·ªÅu."
                    ],
                    "whyCorrect": "Th√∫c gi·ª•c 'Hurry up!' v√¨ xe bu√Ωt ƒëang chuy·ªÉn ƒë·ªông ngay l√∫c n√≥i. The bus -> is leaving.",
                    "whyWrong": "A ƒë√∫ng nh·∫•t. B l√† l·ªãch tr√¨nh (th√¥ng th∆∞·ªùng). C, D sai ng·ªØ ph√°p."
                }
            },
            {
                "question": "Nam and Ba ______ basketball at the moment.",
                "options": ["are playing", "is playing", "play", "plays"],
                "answer": "are playing",
                "explanation": {
                    "translation": "Nam v√† Ba ƒëang ch∆°i b√≥ng r·ªï v√†o l√∫c n√†y.",
                    "analysis": [
                        "A. are playing: ƒëang ch∆°i (s·ªë nhi·ªÅu).",
                        "B. is playing: s·ªë √≠t.",
                        "C. play: hi·ªán t·∫°i ƒë∆°n.",
                        "D. plays: hi·ªán t·∫°i ƒë∆°n."
                    ],
                    "whyCorrect": "'At the moment' -> ti·∫øp di·ªÖn. Nam and Ba l√† 2 ng∆∞·ªùi -> are playing.",
                    "whyWrong": "B, C, D sai ng√¥i/th√¨."
                }
            },
            {
                "question": "Who ______ she ______ to on the phone?",
                "options": ["is / talking", "are / talking", "does / talk", "is / talk"],
                "answer": "is / talking",
                "explanation": {
                    "translation": "C√¥ ·∫•y ƒëang n√≥i chuy·ªán v·ªõi ai tr√™n ƒëi·ªán tho·∫°i v·∫≠y?",
                    "analysis": [
                        "A. is / talking: ƒëang n√≥i chuy·ªán.",
                        "B. are / talking: s·ªë nhi·ªÅu.",
                        "C. does / talk: hi·ªán t·∫°i ƒë∆°n.",
                        "D. is / talk: thi·∫øu V-ing."
                    ],
                    "whyCorrect": "H√†nh ƒë·ªông ƒëang di·ªÖn ra tr√™n ƒëi·ªán tho·∫°i. She ƒëi v·ªõi is.",
                    "whyWrong": "B, C, D sai ng√¥i/th√¨/c·∫•u tr√∫c."
                }
            },
            {
                "question": "I ______ my new school uniform.",
                "options": ["am wearing", "wear", "am wear", "wearing"],
                "answer": "am wearing",
                "explanation": {
                    "translation": "T√¥i ƒëang m·∫∑c b·ªô ƒë·ªìng ph·ª•c tr∆∞·ªùng m·ªõi c·ªßa m√¨nh.",
                    "analysis": [
                        "A. am wearing: ƒëang m·∫∑c.",
                        "B. wear: m·∫∑c (th√≥i quen).",
                        "C. am wear: thi·∫øu ing.",
                        "D. wearing: thi·∫øu tobe."
                    ],
                    "whyCorrect": "Di·ªÖn t·∫£ h√†nh ƒë·ªông ƒëang th·ª±c hi·ªán ngay l√∫c n√†y. I + am + wearing.",
                    "whyWrong": "B mang nghƒ©a th√≥i quen. C, D sai ng·ªØ ph√°p."
                }
            },
            {
                "question": "My friends ______ their bicycles to school now.",
                "options": ["are riding", "is riding", "ride", "are rideing"],
                "answer": "are riding",
                "explanation": {
                    "translation": "C√°c b·∫°n c·ªßa t√¥i ƒëang ƒë·∫°p xe ƒë·∫øn tr∆∞·ªùng b√¢y gi·ªù.",
                    "analysis": [
                        "A. are riding: ƒëang ƒë·∫°p xe.",
                        "B. is riding: s·ªë √≠t.",
                        "C. ride: hi·ªán t·∫°i ƒë∆°n.",
                        "D. are rideing: sai ch√≠nh t·∫£."
                    ],
                    "whyCorrect": "D·∫•u hi·ªáu 'now'. My friends (s·ªë nhi·ªÅu) -> are. Ride (b·ªè e) + ing -> riding.",
                    "whyWrong": "B sai ng√¥i. C sai th√¨. D sai ch√≠nh t·∫£."
                }
            },
            {
                "question": "Look! The cat ______ up the tree.",
                "options": ["is climbing", "climbs", "are climbing", "climbing"],
                "answer": "is climbing",
                "explanation": {
                    "translation": "Nh√¨n k√¨a! Con m√®o ƒëang tr√®o l√™n c√¢y.",
                    "analysis": [
                        "A. is climbing: ƒëang tr√®o.",
                        "B. climbs: hi·ªán t·∫°i ƒë∆°n.",
                        "C. are climbing: s·ªë nhi·ªÅu.",
                        "D. climbing: thi·∫øu tobe."
                    ],
                    "whyCorrect": "D·∫•u hi·ªáu 'Look!'. The cat (s·ªë √≠t) -> is climbing.",
                    "whyWrong": "B, C, D sai ng√¥i/th√¨/c·∫•u tr√∫c."
                }
            },
            {
                "question": "We ______ English. We are studying History.",
                "options": ["aren't studying", "not studying", "don't study", "isn't studying"],
                "answer": "aren't studying",
                "explanation": {
                    "translation": "Ch√∫ng t√¥i ƒëang kh√¥ng h·ªçc Ti·∫øng Anh. Ch√∫ng t√¥i ƒëang h·ªçc L·ªãch s·ª≠.",
                    "analysis": [
                        "A. aren't studying: ƒëang kh√¥ng h·ªçc.",
                        "B. not studying: thi·∫øu tobe.",
                        "C. don't study: hi·ªán t·∫°i ƒë∆°n.",
                        "D. isn't studying: s·ªë √≠t."
                    ],
                    "whyCorrect": "D·ª±a v√†o v·∫ø sau kh·∫≥ng ƒë·ªãnh ƒëang h·ªçc S·ª≠. We -> aren't studying.",
                    "whyWrong": "B, C, D sai ng√¥i/th√¨/c·∫•u tr√∫c."
                }
            },
            {
                "question": "______ it ______ outside?",
                "options": ["Is / raining", "Does / rain", "Is / rain", "Are / raining"],
                "answer": "Is / raining",
                "explanation": {
                    "translation": "Tr·ªùi c√≥ ƒëang m∆∞a b√™n ngo√†i kh√¥ng?",
                    "analysis": [
                        "A. Is / raining: Tr·ªùi ƒëang m∆∞a h·∫£?",
                        "B. Does / rain: Hi·ªán t·∫°i ƒë∆°n.",
                        "C. Is / rain: Thi·∫øu V-ing.",
                        "D. Are / raining: Sai tobe."
                    ],
                    "whyCorrect": "H√†nh ƒë·ªông th·ªùi ti·∫øt ƒëang di·ªÖn ra. It -> Is.",
                    "whyWrong": "B, C, D sai ng√¥i/th√¨/c·∫•u tr√∫c."
                }
            },
            {
                "question": "My mom ______ in the kitchen. She is cooking lunch.",
                "options": ["is standing", "stands", "standing", "are standing"],
                "answer": "is standing",
                "explanation": {
                    "translation": "M·∫π t√¥i ƒëang ƒë·ª©ng trong b·∫øp. B√† ·∫•y ƒëang n·∫•u b·ªØa tr∆∞a.",
                    "analysis": [
                        "A. is standing: ƒëang ƒë·ª©ng.",
                        "B. stands: hi·ªán t·∫°i ƒë∆°n.",
                        "C. standing: thi·∫øu tobe.",
                        "D. are standing: s·ªë nhi·ªÅu."
                    ],
                    "whyCorrect": "Hai h√†nh ƒë·ªông ƒëang song h√†nh. My mom -> is standing.",
                    "whyWrong": "B, C, D sai ng√¥i/th√¨/c·∫•u tr√∫c."
                }
            },
            {
                "question": "Why ______ the baby ______?",
                "options": ["is / crying", "are / crying", "does / cry", "is / cry"],
                "answer": "is / crying",
                "explanation": {
                    "translation": "T·∫°i sao em b√© l·∫°i ƒëang kh√≥c v·∫≠y?",
                    "analysis": [
                        "A. is / crying: ƒëang kh√≥c.",
                        "B. are / crying: s·ªë nhi·ªÅu.",
                        "C. does / cry: hi·ªán t·∫°i ƒë∆°n.",
                        "D. is / cry: thi·∫øu V-ing."
                    ],
                    "whyCorrect": "H·ªèi v·ªÅ h√†nh ƒë·ªông ngay b√¢y gi·ªù. The baby -> is crying.",
                    "whyWrong": "B, C, D sai ng√¥i/th√¨/c·∫•u tr√∫c."
                }
            },
            {
                "question": "Please be quiet! I ______ for the exam.",
                "options": ["am studying", "study", "am study", "studying"],
                "answer": "am studying",
                "explanation": {
                    "translation": "L√†m ∆°n tr·∫≠t t·ª±! T√¥i ƒëang √¥n thi.",
                    "analysis": [
                        "A. am studying: ƒëang h·ªçc b√†i.",
                        "B. study: hi·ªán t·∫°i ƒë∆°n.",
                        "C. am study: thi·∫øu V-ing.",
                        "D. studying: thi·∫øu tobe."
                    ],
                    "whyCorrect": "V√¨ ƒëang √¥n b√†i n√™n m·ªõi y√™u c·∫ßu tr·∫≠t t·ª±. I + am + V-ing.",
                    "whyWrong": "B, C, D sai th√¨/c·∫•u tr√∫c."
                }
            },
            {
                "question": "They ______ to the park right now.",
                "options": ["are running", "are runing", "run", "is running"],
                "answer": "are running",
                "explanation": {
                    "translation": "H·ªç ƒëang ch·∫°y ra c√¥ng vi√™n ngay b√¢y gi·ªù.",
                    "analysis": [
                        "A. are running: ƒëang ch·∫°y (ƒë√∫ng ch√≠nh t·∫£).",
                        "B. are runing: sai ch√≠nh t·∫£.",
                        "C. run: hi·ªán t·∫°i ƒë∆°n.",
                        "D. is running: s·ªë √≠t."
                    ],
                    "whyCorrect": "Right now -> ti·∫øp di·ªÖn. They + are. ƒê·ªông t·ª´ 'run' m·ªôt √¢m ti·∫øt, k·∫øt th√∫c b·∫±ng ph·ª• √¢m-nguy√™n √¢m-ph·ª• √¢m -> g·∫•p ƒë√¥i 'n'.",
                    "whyWrong": "B sai quy t·∫Øc g·∫•p ƒë√¥i ph·ª• √¢m. C, D sai th√¨/ng√¥i."
                }
            }
        ];

        let currentQuestion = 0;
        let score = 0;
        let answered = false;

        const quizCard = document.getElementById('quiz-card');
        const nextBtn = document.getElementById('next-btn');
        const finishBtn = document.getElementById('finish-btn');
        const explBox = document.getElementById('explanation');
        const progressBar = document.getElementById('progressBar');
        const counter = document.getElementById('question-counter');

        function loadQuestion() {
            const data = quizData[currentQuestion];
            answered = false;
            explBox.style.display = 'none';
            nextBtn.classList.add('hidden');
            finishBtn.classList.add('hidden');
            
            counter.innerText = `C√¢u ${currentQuestion + 1}/${quizData.length}`;
            progressBar.style.width = `${((currentQuestion) / quizData.length) * 100}%`;

            let optionsHtml = '';
            data.options.forEach(opt => {
                optionsHtml += `<button class="option-btn" onclick="checkAnswer(this, '${opt}')">${opt}</button>`;
            });

            quizCard.innerHTML = `
                <div class="question-text">Question ${currentQuestion + 1}: ${data.question}</div>
                <div class="options-container">${optionsHtml}</div>
            `;
        }

        function checkAnswer(btn, choice) {
            if (answered) return;
            answered = true;
            const correctAns = quizData[currentQuestion].answer;
            const btns = document.querySelectorAll('.option-btn');

            if (choice === correctAns) {
                score++;
                btn.classList.add('correct');
                document.getElementById('correctSound').play();
                confetti({
                    particleCount: 100,
                    spread: 70,
                    origin: { y: 0.6 },
                    colors: ['#8854C0', '#00C9A7', '#00D26A']
                });
            } else {
                btn.classList.add('wrong');
                quizCard.classList.add('shake');
                document.getElementById('wrongSound').play();
                setTimeout(() => quizCard.classList.remove('shake'), 500);
                
                // Show the correct one
                btns.forEach(b => {
                    if (b.innerText === correctAns) b.classList.add('correct');
                });
            }

            showExplanation();

            if (currentQuestion < quizData.length - 1) {
                nextBtn.classList.remove('hidden');
            } else {
                finishBtn.classList.remove('hidden');
            }
        }

        function showExplanation() {
            const exp = quizData[currentQuestion].explanation;
            explBox.innerHTML = `
                <div class="font-black text-[#8854C0] mb-2">üí° C√¥ Mai An gi·∫£i th√≠ch:</div>
                <div class="mb-3 italic text-gray-700">"${exp.translation}"</div>
                <div class="text-sm font-bold mb-2 text-gray-600">Ph√¢n t√≠ch c√°c ph∆∞∆°ng √°n:</div>
                <ul class="text-sm mb-3 list-disc pl-5 text-gray-600">
                    ${exp.analysis.map(item => `<li>${item}</li>`).join('')}
                </ul>
                <div class="text-sm">
                    <span class="text-green-600 font-bold">‚úì T·∫°i sao ƒê√öNG:</span> ${exp.whyCorrect}<br>
                    <span class="text-red-500 font-bold">‚úó T·∫°i sao SAI:</span> ${exp.whyWrong}
                </div>
            `;
            explBox.style.display = 'block';
        }

        function loadNextQuestion() {
            currentQuestion++;
            loadQuestion();
        }

        function finishQuiz() {
            progressBar.style.width = '100%';
            const modal = document.getElementById('resultModal');
            document.getElementById('finalScore').innerText = `${score}/${quizData.length}`;
            
            let fb = "";
            if(score === quizData.length) fb = "Xu·∫•t s·∫Øc qu√°! Con l√† thi√™n t√†i Hi·ªán t·∫°i ti·∫øp di·ªÖn r·ªìi! üèÜ";
            else if(score > 25) fb = "Gi·ªèi l·∫Øm! Ch·ªâ sai m·ªôt x√≠u th√¥i, con l√†m r·∫•t t·ªët! üåü";
            else if(score > 15) fb = "Kh√° t·ªët! Con h√£y ƒë·ªçc k·ªπ ph·∫ßn gi·∫£i th√≠ch c·ªßa c√¥ ƒë·ªÉ ti·∫øn b·ªô h∆°n nh√©! üëç";
            else fb = "C·ªë g·∫Øng l√™n n√†o! H√£y luy·ªán t·∫≠p l·∫°i ƒë·ªÉ n·∫Øm v·ªØng ki·∫øn th·ª©c nh√©! üí™";
            
            document.getElementById('feedbackText').innerText = fb;
            modal.style.display = 'flex';

            // Big Confetti
            var duration = 5 * 1000;
            var animationEnd = Date.now() + duration;
            var defaults = { startVelocity: 30, spread: 360, ticks: 60, zIndex: 0 };

            function randomInRange(min, max) { return Math.random() * (max - min) + min; }

            var interval = setInterval(function() {
                var timeLeft = animationEnd - Date.now();
                if (timeLeft <= 0) return clearInterval(interval);
                var particleCount = 50 * (timeLeft / duration);
                confetti(Object.assign({}, defaults, { particleCount, origin: { x: randomInRange(0.1, 0.3), y: Math.random() - 0.2 } }));
                confetti(Object.assign({}, defaults, { particleCount, origin: { x: randomInRange(0.7, 0.9), y: Math.random() - 0.2 } }));
            }, 250);
        }

        window.onload = loadQuestion;
    </script>
</body>
</html>
