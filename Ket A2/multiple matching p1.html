<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Reading Quiz - Jobs we'd like to do</title>
    <link href="https://fonts.googleapis.com/css2?family=Nunito:wght@400;700;800;900&display=swap" rel="stylesheet">
    <style>
        /* --- DYNAMIC THEME & COLOR PALETTE --- */
        /* Ch·ªß ƒë·ªÅ: Jobs, Music, Sports, IT. M√†u: Pastel Pink, Blue, Yellow */
        :root {
            --primary: #8854C0; /* T√≠m pastel */
            --secondary: #00C9A7; /* Xanh ng·ªçc */
            --accent: #FDCB6E; /* V√†ng s√°ng */
            --correct: #00D26A; /* Xanh l√° */
            --incorrect: #FF4757; /* ƒê·ªè cam */
            --bg-color: #f7f9fc;
            --text-dark: #2d3436;
        }

        body {
            margin: 0;
            padding: 0;
            font-family: 'Nunito', sans-serif;
            color: var(--text-dark);
            height: 100vh;
            display: flex;
            flex-direction: column;
            overflow: hidden;
            /* Auto-generated SVG Background v·ªõi Emojis: M√°y t√≠nh, Th·ªÉ thao, Nh·∫°c c·ª• */
            background-color: #fceabb;
            background-image: 
                url("data:image/svg+xml,%3Csvg width='120' height='120' viewBox='0 0 120 120' xmlns='http://www.w3.org/2000/svg'%3E%3Ctext x='10' y='30' font-size='20' opacity='0.15'%3Eüíª%3C/text%3E%3Ctext x='60' y='60' font-size='20' opacity='0.15'%3EüèÄ%3C/text%3E%3Ctext x='30' y='90' font-size='20' opacity='0.15'%3Eüé∏%3C/text%3E%3Ctext x='90' y='20' font-size='20' opacity='0.15'%3E‚ú®%3C/text%3E%3Ctext x='80' y='100' font-size='20' opacity='0.15'%3EüöÄ%3C/text%3E%3C/svg%3E"),
                linear-gradient(135deg, #f8b500 0%, #fceabb 100%);
            background-blend-mode: multiply;
        }

        /* --- HEADER & TIMER --- */
        .top-bar {
            background: rgba(255, 255, 255, 0.95);
            padding: 10px 20px;
            box-shadow: 0 4px 15px rgba(0,0,0,0.1);
            display: flex;
            justify-content: space-between;
            align-items: center;
            z-index: 100;
        }

        .teacher-title {
            font-size: 14px;
            font-weight: 800;
            color: var(--primary);
            background: #eee6fa;
            padding: 5px 12px;
            border-radius: 20px;
        }

        .timer-container {
            display: flex;
            align-items: center;
            gap: 15px;
        }

        #timerDisplay {
            font-size: 24px;
            font-weight: 900;
            color: var(--incorrect);
            background: #ffeaa7;
            padding: 5px 15px;
            border-radius: 10px;
            border: 2px solid #fdcb6e;
        }

        .btn-timer {
            background: var(--primary);
            color: white;
            border: none;
            padding: 10px 20px;
            font-size: 16px;
            font-weight: 800;
            border-radius: 12px;
            cursor: pointer;
            box-shadow: 0 5px 0 #5f3a87;
            transition: transform 0.1s, box-shadow 0.1s;
        }
        .btn-timer:active {
            transform: translateY(5px);
            box-shadow: 0 0px 0 #5f3a87;
        }

        /* --- SPLIT SCREEN LAYOUT --- */
        .main-container {
            display: flex;
            flex: 1;
            overflow: hidden;
        }

        .left-panel, .right-panel {
            flex: 1;
            padding: 25px;
            overflow-y: auto;
            scroll-behavior: smooth;
        }

        .left-panel {
            background: rgba(255, 255, 255, 0.85);
            border-right: 4px dashed #dcdde1;
        }

        /* --- READING CONTENT STYLES --- */
        .passage-title {
            font-size: 28px;
            color: var(--primary);
            text-align: center;
            margin-bottom: 20px;
            text-transform: uppercase;
            letter-spacing: 2px;
            text-shadow: 2px 2px 0px #fff;
        }

        .paragraph-card {
            background: white;
            border-radius: 15px;
            padding: 20px;
            margin-bottom: 20px;
            box-shadow: 0 6px 0 #dcdde1;
            border: 2px solid #f5f6fa;
        }

        .paragraph-card h3 {
            margin-top: 0;
            color: var(--secondary);
            font-size: 22px;
            border-bottom: 2px dashed #eee;
            padding-bottom: 10px;
        }

        .text-content {
            font-size: 18px;
            line-height: 1.6;
        }

        .btn-translate {
            background: #74b9ff;
            color: white;
            border: none;
            padding: 8px 15px;
            font-size: 14px;
            font-weight: bold;
            border-radius: 8px;
            cursor: pointer;
            margin-top: 15px;
            box-shadow: 0 4px 0 #0984e3;
            transition: all 0.2s;
        }
        .btn-translate:active {
            transform: translateY(4px);
            box-shadow: 0 0px 0 #0984e3;
        }

        .translation-text {
            display: none;
            margin-top: 15px;
            padding: 15px;
            background: #eccc68;
            border-radius: 10px;
            font-size: 16px;
            color: #2f3640;
            border-left: 5px solid #ff7f50;
            font-style: italic;
        }

        /* --- GLOSSARY TABLE --- */
        .glossary-container {
            background: white;
            border-radius: 15px;
            padding: 20px;
            margin-top: 30px;
            box-shadow: 0 6px 0 #dcdde1;
        }
        .glossary-container h3 {
            color: var(--incorrect);
            text-align: center;
        }
        table {
            width: 100%;
            border-collapse: collapse;
            margin-top: 15px;
        }
        th, td {
            padding: 12px;
            border-bottom: 2px solid #f1f2f6;
            text-align: left;
            font-size: 16px;
        }
        th {
            background: var(--primary);
            color: white;
            font-weight: 800;
        }
        tr:hover { background: #fdfaf6; }

        /* --- QUIZ SECTION STYLES --- */
        .question-card {
            background: white;
            border-radius: 20px;
            padding: 25px;
            margin-bottom: 30px;
            box-shadow: 0 8px 0 #dcdde1;
            border: 3px solid #fff;
            transition: all 0.3s;
        }

        .question-text {
            font-size: 20px;
            font-weight: 800;
            margin-bottom: 20px;
            color: #2d3436;
        }

        .options-grid {
            display: flex;
            flex-direction: column;
            gap: 15px;
        }

        .option-btn {
            background: #f1f2f6;
            border: 2px solid #dfe4ea;
            padding: 15px 20px;
            font-size: 18px;
            font-weight: 700;
            border-radius: 15px;
            cursor: pointer;
            text-align: left;
            transition: all 0.2s cubic-bezier(0.175, 0.885, 0.32, 1.275);
            box-shadow: 0 5px 0 #ced6e0;
            display: flex;
            align-items: center;
        }

        .option-btn:hover:not(:disabled) {
            transform: scale(1.02) translateY(-2px);
            background: #eccc68;
            border-color: #ffa502;
            box-shadow: 0 7px 0 #ffa502;
        }

        .option-btn.correct {
            background: var(--correct) !important;
            color: white;
            border-color: #00b894;
            box-shadow: 0 5px 0 #00b894;
        }

        .option-btn.wrong {
            background: var(--incorrect) !important;
            color: white;
            border-color: #d63031;
            box-shadow: 0 5px 0 #d63031;
        }

        .option-btn:disabled {
            cursor: not-allowed;
            opacity: 0.8;
        }

        /* Detailed Explanation Box */
        .explanation-box {
            display: none;
            margin-top: 20px;
            padding: 20px;
            background: #e0f7fa;
            border-radius: 15px;
            border-left: 6px solid var(--secondary);
            font-size: 16px;
            line-height: 1.6;
            animation: fadeIn 0.5s ease;
        }
        
        .exp-title {
            font-weight: 900;
            color: var(--secondary);
            margin-bottom: 10px;
            font-size: 18px;
            display: flex;
            align-items: center;
            gap: 5px;
        }

        .exp-quote {
            background: white;
            padding: 10px;
            border-radius: 8px;
            font-style: italic;
            margin: 10px 0;
            border: 1px dashed #ccc;
        }

        /* --- ANIMATIONS --- */
        @keyframes fadeIn { from { opacity: 0; transform: translateY(-10px); } to { opacity: 1; transform: translateY(0); } }
        
        .shake {
            animation: shake 0.5s cubic-bezier(.36,.07,.19,.97) both;
        }
        @keyframes shake {
            10%, 90% { transform: translate3d(-2px, 0, 0); }
            20%, 80% { transform: translate3d(4px, 0, 0); }
            30%, 50%, 70% { transform: translate3d(-6px, 0, 0); }
            40%, 60% { transform: translate3d(6px, 0, 0); }
        }

        /* --- CONFETTI CANVAS --- */
        #confettiCanvas {
            position: fixed;
            top: 0; left: 0; width: 100%; height: 100%;
            pointer-events: none;
            z-index: 9999;
        }

        /* --- SUBMIT & MODAL --- */
        .submit-btn-container {
            text-align: center;
            margin: 40px 0;
        }
        .btn-submit {
            background: linear-gradient(45deg, #FF9A9E, #FECFEF);
            color: #d63031;
            font-size: 24px;
            font-weight: 900;
            padding: 15px 40px;
            border: none;
            border-radius: 30px;
            cursor: pointer;
            box-shadow: 0 8px 0 #ff7675;
            transition: all 0.2s;
        }
        .btn-submit:hover { transform: scale(1.05); }
        .btn-submit:active { transform: translateY(8px); box-shadow: 0 0px 0 #ff7675; }

        .modal-overlay {
            position: fixed; top: 0; left: 0; width: 100%; height: 100%;
            background: rgba(0,0,0,0.6);
            display: none; justify-content: center; align-items: center;
            z-index: 10000;
            backdrop-filter: blur(5px);
        }
        .modal-content {
            background: white;
            padding: 40px;
            border-radius: 30px;
            text-align: center;
            max-width: 400px;
            box-shadow: 0 15px 30px rgba(0,0,0,0.3);
            animation: bounceIn 0.5s cubic-bezier(0.175, 0.885, 0.32, 1.275);
        }
        @keyframes bounceIn {
            0% { transform: scale(0.1); opacity: 0; }
            60% { transform: scale(1.1); opacity: 1; }
            100% { transform: scale(1); }
        }
        .score-text { font-size: 48px; font-weight: 900; color: var(--primary); margin: 20px 0; }
        .feedback-text { font-size: 20px; font-weight: 700; color: #636e72; }
        .btn-close-modal {
            margin-top: 25px; background: var(--secondary); color: white;
            border: none; padding: 12px 30px; font-size: 18px; border-radius: 15px;
            font-weight: bold; cursor: pointer; box-shadow: 0 5px 0 #00b894;
        }

        /* --- SCROLLBAR STYLING --- */
        ::-webkit-scrollbar { width: 10px; }
        ::-webkit-scrollbar-track { background: #f1f2f6; border-radius: 5px; }
        ::-webkit-scrollbar-thumb { background: #b2bec3; border-radius: 5px; }
        ::-webkit-scrollbar-thumb:hover { background: #636e72; }
    </style>
</head>
<body>

    <canvas id="confettiCanvas"></canvas>

    <div class="top-bar">
        <div class="teacher-title">‚ú® Gi√°o vi√™n t·∫°o: Ms Mai An ULIS</div>
        <div class="timer-container">
            <div id="timerDisplay">10:00</div>
            <button class="btn-timer" id="btnTimerToggle" onclick="toggleTimer()">B·∫ÆT ƒê·∫¶U T√çNH GI·ªú</button>
        </div>
    </div>

    <div class="main-container">
        <div class="left-panel">
            <h1 class="passage-title">Jobs We'd Like To Do</h1>
            
            <div class="paragraph-card">
                <h3>üë®‚Äçüíª Artur</h3>
                <div class="text-content">
                    I‚Äôve always enjoyed playing computer games and I‚Äôd like to make them when I‚Äôm older. My cousin works in IT and makes cartoons and games so I asked him if I could go to work with him. I learned so much including how to draw a simple cartoon. But it was really tiring ‚Äì all I wanted to do was relax at the end of the day, not play computer games!
                </div>
                <button class="btn-translate" onclick="toggleTranslate('trans1')">üëÅÔ∏è B·∫¢N D·ªäCH ƒê·∫¶Y ƒê·ª¶</button>
                <div class="translation-text" id="trans1">
                    T√¥i lu√¥n th√≠ch ch∆°i tr√≤ ch∆°i m√°y t√≠nh v√† t√¥i mu·ªën t·∫°o ra ch√∫ng khi t√¥i l·ªõn l√™n. Anh h·ªç c·ªßa t√¥i l√†m vi·ªác trong ng√†nh CNTT v√† l√†m phim ho·∫°t h√¨nh c√πng tr√≤ ch∆°i n√™n t√¥i ƒë√£ xin anh ·∫•y cho t√¥i ƒëi l√†m c√πng. T√¥i ƒë√£ h·ªçc ƒë∆∞·ª£c r·∫•t nhi·ªÅu ƒëi·ªÅu bao g·ªìm c·∫£ c√°ch v·∫Ω m·ªôt b·ª©c ho·∫°t h√¨nh ƒë∆°n gi·∫£n. Nh∆∞ng n√≥ th·ª±c s·ª± m·ªát m·ªèi ‚Äì t·∫•t c·∫£ nh·ªØng g√¨ t√¥i mu·ªën l√†m l√† ngh·ªâ ng∆°i v√†o cu·ªëi ng√†y, ch·ª© kh√¥ng ph·∫£i ch∆°i tr√≤ ch∆°i m√°y t√≠nh!
                </div>
            </div>

            <div class="paragraph-card">
                <h3>üèÄ Mika</h3>
                <div class="text-content">
                    I love sport the most and want to teach it when I‚Äôm older. I‚Äôm good at basketball, but I need to work harder in rugby lessons so I can teach different sports. After school, I want to go to college and study sports science. After that, I want to help with after-school clubs and lessons. My uncle is a teacher so I plan to ask him if I can give drinks to the players at the American football club next week.
                </div>
                <button class="btn-translate" onclick="toggleTranslate('trans2')">üëÅÔ∏è B·∫¢N D·ªäCH ƒê·∫¶Y ƒê·ª¶</button>
                <div class="translation-text" id="trans2">
                    T√¥i y√™u th·ªÉ thao nh·∫•t v√† mu·ªën d·∫°y m√¥n n√†y khi t√¥i l·ªõn l√™n. T√¥i gi·ªèi b√≥ng r·ªï, nh∆∞ng t√¥i c·∫ßn n·ªó l·ª±c chƒÉm ch·ªâ h∆°n trong c√°c ti·∫øt h·ªçc b√≥ng b·∫ßu d·ª•c ƒë·ªÉ c√≥ th·ªÉ d·∫°y nhi·ªÅu m√¥n th·ªÉ thao kh√°c nhau. Sau khi tan tr∆∞·ªùng, t√¥i mu·ªën v√†o ƒë·∫°i h·ªçc v√† h·ªçc khoa h·ªçc th·ªÉ thao. Sau ƒë√≥, t√¥i mu·ªën h·ªó tr·ª£ c√°c c√¢u l·∫°c b·ªô v√† l·ªõp h·ªçc ngo·∫°i kh√≥a. Ch√∫ t√¥i l√† m·ªôt gi√°o vi√™n n√™n t√¥i d·ª± ƒë·ªãnh s·∫Ω xin ch√∫ ·∫•y cho t√¥i ƒëi ph√°t n∆∞·ªõc cho c√°c c·∫ßu th·ªß t·∫°i c√¢u l·∫°c b·ªô b√≥ng b·∫ßu d·ª•c M·ªπ v√†o tu·∫ßn t·ªõi.
                </div>
            </div>

            <div class="paragraph-card">
                <h3>üé∏ Henri</h3>
                <div class="text-content">
                    I play a lot of musical instruments including the piano and guitar and would love to have a career in music. Last year, I received a prize for the best young musician in my town. I want to study music at university. I probably won‚Äôt get work as a musician after school so I might have to get a job in a caf√© or restaurant first. My dream is to be paid to play in a group and travel around the world.
                </div>
                <button class="btn-translate" onclick="toggleTranslate('trans3')">üëÅÔ∏è B·∫¢N D·ªäCH ƒê·∫¶Y ƒê·ª¶</button>
                <div class="translation-text" id="trans3">
                    T√¥i ch∆°i r·∫•t nhi·ªÅu nh·∫°c c·ª• bao g·ªìm piano v√† guitar v√† r·∫•t mu·ªën c√≥ m·ªôt s·ª± nghi·ªáp √¢m nh·∫°c. NƒÉm ngo√°i, t√¥i ƒë√£ nh·∫≠n ƒë∆∞·ª£c m·ªôt gi·∫£i th∆∞·ªüng d√†nh cho nh·∫°c sƒ© tr·∫ª xu·∫•t s·∫Øc nh·∫•t th·ªã tr·∫•n. T√¥i mu·ªën h·ªçc √¢m nh·∫°c ·ªü tr∆∞·ªùng ƒë·∫°i h·ªçc. T√¥i c√≥ th·ªÉ s·∫Ω kh√¥ng t√¨m ƒë∆∞·ª£c vi·ªác l√†m nh·∫°c sƒ© ngay sau khi ra tr∆∞·ªùng n√™n t√¥i c√≥ th·ªÉ ph·∫£i t√¨m m·ªôt c√¥ng vi·ªác ·ªü qu√°n c√† ph√™ ho·∫∑c nh√† h√†ng tr∆∞·ªõc. ∆Ø·ªõc m∆° c·ªßa t√¥i l√† ƒë∆∞·ª£c tr·∫£ ti·ªÅn ƒë·ªÉ ch∆°i trong m·ªôt nh√≥m nh·∫°c v√† ƒëi l∆∞u di·ªÖn kh·∫Øp th·∫ø gi·ªõi.
                </div>
            </div>

            <div class="glossary-container">
                <h3>üìñ B·∫£ng T·ª´ V·ª±ng H·ªçc Thu·∫≠t (Glossary)</h3>
                <table>
                    <thead>
                        <tr>
                            <th>T·ª´ v·ª±ng (Word)</th>
                            <th>Lo·∫°i t·ª´ (POS)</th>
                            <th>Nghƒ©a Ti·∫øng Vi·ªát (Meaning)</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr><td>1. Career</td><td>Noun (n)</td><td>S·ª± nghi·ªáp, ngh·ªÅ nghi·ªáp</td></tr>
                        <tr><td>2. Instrument</td><td>Noun (n)</td><td>Nh·∫°c c·ª•, c√¥ng c·ª•</td></tr>
                        <tr><td>3. Musician</td><td>Noun (n)</td><td>Nh·∫°c sƒ©, ng∆∞·ªùi ch∆°i nh·∫°c</td></tr>
                        <tr><td>4. Include</td><td>Verb (v)</td><td>Bao g·ªìm</td></tr>
                        <tr><td>5. Science</td><td>Noun (n)</td><td>Khoa h·ªçc</td></tr>
                        <tr><td>6. Receive</td><td>Verb (v)</td><td>Nh·∫≠n ƒë∆∞·ª£c</td></tr>
                        <tr><td>7. Probably</td><td>Adverb (adv)</td><td>C√≥ l·∫Ω, c√≥ kh·∫£ nƒÉng cao</td></tr>
                        <tr><td>8. Tiring</td><td>Adjective (adj)</td><td>M·ªát m·ªèi (G√¢y ra s·ª± m·ªát m·ªèi)</td></tr>
                        <tr><td>9. Relax</td><td>Verb (v)</td><td>Th∆∞ gi√£n, ngh·ªâ ng∆°i</td></tr>
                        <tr><td>10. Plan</td><td>Verb (v) / Noun (n)</td><td>L√™n k·∫ø ho·∫°ch / K·∫ø ho·∫°ch</td></tr>
                    </tbody>
                </table>
            </div>
        </div>

        <div class="right-panel" id="quizContainer">
            <div class="submit-btn-container">
                <button class="btn-submit" onclick="submitQuiz()">üéâ N·ªòP B√ÄI üéâ</button>
            </div>
        </div>
    </div>

    <div class="modal-overlay" id="resultModal">
        <div class="modal-content">
            <h2>K·∫øt Qu·∫£ C·ªßa B·∫°n</h2>
            <div class="score-text" id="finalScoreText">0/7</div>
            <div class="feedback-text" id="feedbackText">Tuy·ªát v·ªùi!</div>
            <button class="btn-close-modal" onclick="closeModal()">Xem L·∫°i B√†i</button>
        </div>
    </div>

    <script>
        /* ================= AUDIO GENERATOR (WEB AUDIO API) ================= */
        const audioCtx = new (window.AudioContext || window.webkitAudioContext)();
        
        function playCorrectSound() {
            if (audioCtx.state === 'suspended') audioCtx.resume();
            const osc = audioCtx.createOscillator();
            const gainNode = audioCtx.createGain();
            osc.type = 'sine';
            osc.frequency.setValueAtTime(800, audioCtx.currentTime);
            osc.frequency.exponentialRampToValueAtTime(1200, audioCtx.currentTime + 0.1);
            gainNode.gain.setValueAtTime(0.5, audioCtx.currentTime);
            gainNode.gain.exponentialRampToValueAtTime(0.01, audioCtx.currentTime + 0.5);
            osc.connect(gainNode);
            gainNode.connect(audioCtx.destination);
            osc.start();
            osc.stop(audioCtx.currentTime + 0.5);
        }

        function playWrongSound() {
            if (audioCtx.state === 'suspended') audioCtx.resume();
            const osc = audioCtx.createOscillator();
            const gainNode = audioCtx.createGain();
            osc.type = 'sawtooth';
            osc.frequency.setValueAtTime(300, audioCtx.currentTime);
            osc.frequency.exponentialRampToValueAtTime(150, audioCtx.currentTime + 0.4);
            gainNode.gain.setValueAtTime(0.3, audioCtx.currentTime);
            gainNode.gain.exponentialRampToValueAtTime(0.01, audioCtx.currentTime + 0.4);
            osc.connect(gainNode);
            gainNode.connect(audioCtx.destination);
            osc.start();
            osc.stop(audioCtx.currentTime + 0.4);
        }

        /* ================= CONFETTI GENERATOR ================= */
        const canvas = document.getElementById('confettiCanvas');
        const ctx = canvas.getContext('2d');
        canvas.width = window.innerWidth;
        canvas.height = window.innerHeight;
        let particles = [];

        function fireConfetti() {
            particles = [];
            for(let i=0; i<100; i++) {
                particles.push({
                    x: canvas.width/2,
                    y: canvas.height/2 + 200,
                    r: Math.random() * 6 + 2,
                    dx: Math.random() * 10 - 5,
                    dy: Math.random() * -15 - 5,
                    color: `hsl(${Math.random()*360}, 100%, 50%)`
                });
            }
            animateConfetti();
        }

        function animateConfetti() {
            requestAnimationFrame(animateConfetti);
            ctx.clearRect(0,0,canvas.width,canvas.height);
            particles.forEach((p, index) => {
                p.x += p.dx;
                p.y += p.dy;
                p.dy += 0.5; // gravity
                ctx.beginPath();
                ctx.arc(p.x, p.y, p.r, 0, Math.PI*2);
                ctx.fillStyle = p.color;
                ctx.fill();
                if(p.y > canvas.height) particles.splice(index, 1);
            });
        }

        /* ================= TIMER LOGIC ================= */
        let timeRemaining = 600; // 10 minutes
        let timerInterval;
        let isTimerRunning = false;

        function updateTimerDisplay() {
            let m = Math.floor(timeRemaining / 60).toString().padStart(2, '0');
            let s = (timeRemaining % 60).toString().padStart(2, '0');
            document.getElementById('timerDisplay').innerText = `${m}:${s}`;
        }

        function toggleTimer() {
            const btn = document.getElementById('btnTimerToggle');
            if (isTimerRunning) {
                clearInterval(timerInterval);
                btn.innerText = "TI·∫æP T·ª§C L√ÄM B√ÄI";
                btn.style.background = "#ffa502";
                isTimerRunning = false;
            } else {
                btn.innerText = "T·∫†M D·ª™NG";
                btn.style.background = "#ff4757";
                isTimerRunning = true;
                timerInterval = setInterval(() => {
                    timeRemaining--;
                    updateTimerDisplay();
                    if (timeRemaining <= 0) {
                        clearInterval(timerInterval);
                        alert("‚è± ƒê√£ h·∫øt gi·ªù l√†m b√†i! B·∫°n v·∫´n c√≥ th·ªÉ ti·∫øp t·ª•c l√†m, nh∆∞ng nh·ªõ l√† trong ph√≤ng thi th·∫≠t, b·∫°n ch·ªâ n√™n l√†m m·ªôt b√†i nh∆∞ th·∫ø n√†y trong 10 ph√∫t th√¥i nha.");
                        btn.innerText = "H·∫æT GI·ªú";
                        btn.disabled = true;
                    }
                }, 1000);
            }
        }

        /* ================= TRANSLATION TOGGLE ================= */
        function toggleTranslate(id) {
            const el = document.getElementById(id);
            if (el.style.display === "block") {
                el.style.display = "none";
            } else {
                el.style.display = "block";
            }
        }

        /* ================= QUIZ DATA & LOGIC ================= */
        const quizData = [
            {
                q: "1. Who is going to ask a family member for help with their job plans?",
                options: [{id:'A', text:'Artur'}, {id:'B', text:'Mika'}, {id:'C', text:'Henri'}],
                correct: 'B',
                explanation: `
                    <div class="exp-title">üí° Gi·∫£i th√≠ch chi ti·∫øt (C√¢u 1)</div>
                    <b>1. Ph√¢n t√≠ch c√¢u h·ªèi:</b> Ai d·ª± ƒë·ªãnh s·∫Ω nh·ªù m·ªôt th√†nh vi√™n trong gia ƒë√¨nh gi√∫p ƒë·ª° v·ªÅ k·∫ø ho·∫°ch c√¥ng vi·ªác c·ªßa h·ªç?<br>
                    <b>2. D·∫´n ch·ª©ng trong b√†i (ƒêo·∫°n Mika):</b> 
                    <div class="exp-quote">"My uncle is a teacher so I <b>plan to ask him</b> if I can give drinks to the players..."</div>
                    <b>3. T·∫°i sao ch·ªçn Mika?</b> D·ª±a v√†o c·ª•m t·ª´ "plan to ask him" (d·ª± ƒë·ªãnh nh·ªù ch√∫ ·∫•y - th√†nh vi√™n gia ƒë√¨nh) ƒë·ªÉ xin vi·ªác ph√°t n∆∞·ªõc ·ªü c√¢u l·∫°c b·ªô. Do ƒë√≥ Mika l√† ƒë√°p √°n ƒë√∫ng. Artur ƒê√É XIN (asked - qu√° kh·ª©) ch·ª© kh√¥ng ph·∫£i D·ª∞ ƒê·ªäNH (is going to ask).
                `
            },
            {
                q: "2. Who hopes to work in different countries?",
                options: [{id:'A', text:'Artur'}, {id:'B', text:'Mika'}, {id:'C', text:'Henri'}],
                correct: 'C',
                explanation: `
                    <div class="exp-title">üí° Gi·∫£i th√≠ch chi ti·∫øt (C√¢u 2)</div>
                    <b>1. Ph√¢n t√≠ch c√¢u h·ªèi:</b> Ai hy v·ªçng ƒë∆∞·ª£c l√†m vi·ªác ·ªü nhi·ªÅu qu·ªëc gia kh√°c nhau? (work in different countries = travel around the world).<br>
                    <b>2. D·∫´n ch·ª©ng trong b√†i (ƒêo·∫°n Henri):</b> 
                    <div class="exp-quote">"My dream is to be paid to play in a group and <b>travel around the world</b>."</div>
                    <b>3. T·∫°i sao ch·ªçn Henri?</b> ∆Ø·ªõc m∆° c·ªßa Henri l√† ƒë∆∞·ª£c ƒëi l∆∞u di·ªÖn "kh·∫Øp th·∫ø gi·ªõi" (around the world), ƒë·ªìng nghƒ©a v·ªõi vi·ªác l√†m vi·ªác ·ªü nhi·ªÅu qu·ªëc gia kh√°c nhau.
                `
            },
            {
                q: "3. Who has won a competition in their chosen subject?",
                options: [{id:'A', text:'Artur'}, {id:'B', text:'Mika'}, {id:'C', text:'Henri'}],
                correct: 'C',
                explanation: `
                    <div class="exp-title">üí° Gi·∫£i th√≠ch chi ti·∫øt (C√¢u 3)</div>
                    <b>1. Ph√¢n t√≠ch c√¢u h·ªèi:</b> Ai ƒë√£ gi√†nh chi·∫øn th·∫Øng trong m·ªôt cu·ªôc thi v·ªÅ m√¥n h·ªçc h·ªç ch·ªçn? (won a competition = received a prize).<br>
                    <b>2. D·∫´n ch·ª©ng trong b√†i (ƒêo·∫°n Henri):</b> 
                    <div class="exp-quote">"Last year, I <b>received a prize</b> for the best young musician in my town."</div>
                    <b>3. T·∫°i sao ch·ªçn Henri?</b> Henri nh·∫≠n ƒë∆∞·ª£c "gi·∫£i th∆∞·ªüng cho nh·∫°c sƒ© tr·∫ª xu·∫•t s·∫Øc nh·∫•t", ch·ª©ng t·ªè c·∫≠u ·∫•y ƒë√£ chi·∫øn th·∫Øng m·ªôt cu·ªôc thi √¢m nh·∫°c.
                `
            },
            {
                q: "4. Who needs to get better at the school subject they like best?",
                options: [{id:'A', text:'Artur'}, {id:'B', text:'Mika'}, {id:'C', text:'Henri'}],
                correct: 'B',
                explanation: `
                    <div class="exp-title">üí° Gi·∫£i th√≠ch chi ti·∫øt (C√¢u 4)</div>
                    <b>1. Ph√¢n t√≠ch c√¢u h·ªèi:</b> Ai c·∫ßn ph·∫£i h·ªçc t·ªët h∆°n ·ªü m√¥n h·ªçc tr√™n tr∆∞·ªùng m√† h·ªç th√≠ch nh·∫•t? (get better = work harder).<br>
                    <b>2. D·∫´n ch·ª©ng trong b√†i (ƒêo·∫°n Mika):</b> 
                    <div class="exp-quote">"I love sport the most... but I <b>need to work harder</b> in rugby lessons..."</div>
                    <b>3. T·∫°i sao ch·ªçn Mika?</b> Mika th√≠ch th·ªÉ thao nh·∫•t, nh∆∞ng c·∫≠u ·∫•y th·ª´a nh·∫≠n m√¨nh "c·∫ßn n·ªó l·ª±c chƒÉm ch·ªâ h∆°n trong c√°c ti·∫øt b√≥ng b·∫ßu d·ª•c" ƒë·ªÉ ti·∫øn b·ªô.
                `
            },
            {
                q: "5. Who has had some help from their family with their job plans?",
                options: [{id:'A', text:'Artur'}, {id:'B', text:'Mika'}, {id:'C', text:'Henri'}],
                correct: 'A',
                explanation: `
                    <div class="exp-title">üí° Gi·∫£i th√≠ch chi ti·∫øt (C√¢u 5)</div>
                    <b>1. Ph√¢n t√≠ch c√¢u h·ªèi:</b> Ai <b>ƒë√£ ƒë∆∞·ª£c</b> gia ƒë√¨nh gi√∫p ƒë·ª° m·ªôt ch√∫t v·ªÅ k·∫ø ho·∫°ch c√¥ng vi·ªác? (L∆∞u √Ω th√¨ Hi·ªán t·∫°i ho√†n th√†nh: ƒë√£ x·∫£y ra).<br>
                    <b>2. D·∫´n ch·ª©ng trong b√†i (ƒêo·∫°n Artur):</b> 
                    <div class="exp-quote">"My cousin works in IT... so I asked him if I could go to work with him. <b>I learned so much</b>..."</div>
                    <b>3. T·∫°i sao ch·ªçn Artur?</b> Artur ƒë√£ xin anh h·ªç cho ƒëi l√†m c√πng v√† "ƒë√£ h·ªçc ƒë∆∞·ª£c r·∫•t nhi·ªÅu" (s·ª± vi·ªác ƒë√£ di·ªÖn ra v√† nh·∫≠n ƒë∆∞·ª£c s·ª± gi√∫p ƒë·ª°). Mika m·ªõi ch·ªâ d·ª± ƒë·ªãnh nh·ªù ch√∫, ch∆∞a x·∫£y ra.
                `
            },
            {
                q: "6. Who was ready for a break after their experience of working?",
                options: [{id:'A', text:'Artur'}, {id:'B', text:'Mika'}, {id:'C', text:'Henri'}],
                correct: 'A',
                explanation: `
                    <div class="exp-title">üí° Gi·∫£i th√≠ch chi ti·∫øt (C√¢u 6)</div>
                    <b>1. Ph√¢n t√≠ch c√¢u h·ªèi:</b> Ai ƒë√£ s·∫µn s√†ng ƒë·ªÉ ngh·ªâ ng∆°i sau tr·∫£i nghi·ªám l√†m vi·ªác c·ªßa h·ªç? (ready for a break = wanted to relax).<br>
                    <b>2. D·∫´n ch·ª©ng trong b√†i (ƒêo·∫°n Artur):</b> 
                    <div class="exp-quote">"But it was really tiring ‚Äì all I wanted to do was <b>relax</b> at the end of the day..."</div>
                    <b>3. T·∫°i sao ch·ªçn Artur?</b> Artur c·∫£m th·∫•y c√¥ng vi·ªác l√†m game th·ª±c s·ª± m·ªát m·ªèi v√† t·∫•t c·∫£ nh·ªØng g√¨ c·∫≠u ·∫•y mu·ªën l√† "th∆∞ gi√£n/ngh·ªâ ng∆°i" (relax) v√†o cu·ªëi ng√†y.
                `
            },
            {
                q: "7. Who may have to work as a waiter after school?",
                options: [{id:'A', text:'Artur'}, {id:'B', text:'Mika'}, {id:'C', text:'Henri'}],
                correct: 'C',
                explanation: `
                    <div class="exp-title">üí° Gi·∫£i th√≠ch chi ti·∫øt (C√¢u 7)</div>
                    <b>1. Ph√¢n t√≠ch c√¢u h·ªèi:</b> Ai c√≥ th·ªÉ ph·∫£i l√†m b·ªìi b√†n sau khi ra tr∆∞·ªùng? (work as a waiter = get a job in a caf√© or restaurant).<br>
                    <b>2. D·∫´n ch·ª©ng trong b√†i (ƒêo·∫°n Henri):</b> 
                    <div class="exp-quote">"...so I might have to <b>get a job in a caf√© or restaurant</b> first."</div>
                    <b>3. T·∫°i sao ch·ªçn Henri?</b> Henri l∆∞·ªùng tr∆∞·ªõc r·∫±ng vi·ªác l√†m nh·∫°c sƒ© r·∫•t kh√≥, n√™n c·∫≠u ·∫•y nghƒ© m√¨nh c√≥ th·ªÉ ph·∫£i xin vi·ªác ·ªü "qu√°n c√† ph√™ ho·∫∑c nh√† h√†ng" (t∆∞∆°ng ƒë∆∞∆°ng c√¥ng vi·ªác b·ªìi b√†n/waiter).
                `
            }
        ];

        let score = 0;
        let answeredQuestions = new Set(); // Track questions answered on first try

        // Fisher-Yates Shuffle Algorithm ƒë·ªÉ x√°o tr·ªôn ƒë√°p √°n
        function shuffleArray(array) {
            for (let i = array.length - 1; i > 0; i--) {
                const j = Math.floor(Math.random() * (i + 1));
                [array[i], array[j]] = [array[j], array[i]];
            }
            return array;
        }

        function renderQuiz() {
            const container = document.getElementById('quizContainer');
            // X√≥a n·ªôi dung c≈© nh∆∞ng gi·ªØ l·∫°i n√∫t N·ªôp B√†i
            const submitBtn = document.querySelector('.submit-btn-container');
            container.innerHTML = '';

            quizData.forEach((qObj, qIndex) => {
                const card = document.createElement('div');
                card.className = 'question-card';
                card.id = `q-card-${qIndex}`;

                const qText = document.createElement('div');
                qText.className = 'question-text';
                qText.innerHTML = qObj.q;
                card.appendChild(qText);

                const optionsGrid = document.createElement('div');
                optionsGrid.className = 'options-grid';

                // Shuffle options
                let shuffledOptions = shuffleArray([...qObj.options]);

                shuffledOptions.forEach(opt => {
                    const btn = document.createElement('button');
                    btn.className = 'option-btn';
                    // Label A, B, C thay ƒë·ªïi theo th·ª© t·ª± m·ªõi, nh∆∞ng ID th·ª±c t·∫ø map v·ªõi ƒë√°p √°n g·ªëc ƒë∆∞·ª£c gi·ªØ ng·∫ßm
                    btn.innerHTML = `<span><span style="display:inline-block; width:30px; background:#dfe4ea; border-radius:50%; text-align:center; margin-right:15px; color:#2d3436">${shuffledOptions.indexOf(opt) === 0 ? 'A' : (shuffledOptions.indexOf(opt) === 1 ? 'B' : 'C')}</span> ${opt.text}</span>`;
                    
                    btn.onclick = () => handleAnswer(btn, opt.id, qObj.correct, qIndex, card);
                    optionsGrid.appendChild(btn);
                });

                card.appendChild(optionsGrid);

                // Explanation Box
                const expBox = document.createElement('div');
                expBox.className = 'explanation-box';
                expBox.id = `exp-${qIndex}`;
                expBox.innerHTML = qObj.explanation;
                card.appendChild(expBox);

                container.appendChild(card);
            });
            
            container.appendChild(submitBtn);
        }

        function handleAnswer(btn, selectedId, correctId, qIndex, card) {
            const buttons = card.querySelectorAll('.option-btn');
            const expBox = document.getElementById(`exp-${qIndex}`);

            // Ki·ªÉm tra ƒë√∫ng sai
            if (selectedId === correctId) {
                btn.classList.add('correct');
                playCorrectSound();
                fireConfetti();
                // C·ªông ƒëi·ªÉm n·∫øu l√† l·∫ßn tr·∫£ l·ªùi ƒë·∫ßu ti√™n
                if (!answeredQuestions.has(qIndex)) {
                    score++;
                    answeredQuestions.add(qIndex);
                }
            } else {
                btn.classList.add('wrong');
                btn.classList.add('shake');
                playWrongSound();
                setTimeout(() => btn.classList.remove('shake'), 500);
                answeredQuestions.add(qIndex); // ƒê√£ tr·∫£ l·ªùi sai l·∫ßn ƒë·∫ßu, kh√¥ng ƒë∆∞·ª£c c·ªông ƒëi·ªÉm n·ªØa
                
                // T·ª± ƒë·ªông b√¥i xanh ƒë√°p √°n ƒë√∫ng
                buttons.forEach(b => {
                    if (b.onclick.toString().includes(`'${correctId}'`)) {
                        b.classList.add('correct');
                    }
                });
            }

            // Disable all buttons in this card after answer
            buttons.forEach(b => b.disabled = true);

            // Hi·ªán gi·∫£i th√≠ch chi ti·∫øt ngay l·∫≠p t·ª©c
            expBox.style.display = 'block';
        }

        function submitQuiz() {
            const modal = document.getElementById('resultModal');
            const scoreText = document.getElementById('finalScoreText');
            const feedbackText = document.getElementById('feedbackText');
            
            scoreText.innerText = `${score} / 7`;
            
            let percentage = score / 7;
            if (percentage === 1) {
                feedbackText.innerText = "üèÜ XU·∫§T S·∫ÆC! Em ƒë√∫ng l√† Thi√™n T√†i Ph√¢n T√≠ch Ng√¥n Ng·ªØ!";
                feedbackText.style.color = "#00b894";
                fireConfetti();
                playCorrectSound();
            } else if (percentage >= 0.7) {
                feedbackText.innerText = "üåü L√ÄM T·ªêT L·∫ÆM! K·ªπ nƒÉng ƒë·ªçc hi·ªÉu c·ªßa em r·∫•t x·ªãn!";
                feedbackText.style.color = "#0984e3";
            } else if (percentage >= 0.4) {
                feedbackText.innerText = "üëç KH√Å L·∫ÆM! Em nh·ªõ ƒë·ªçc k·ªπ d·∫´n ch·ª©ng h∆°n m·ªôt ch√∫t nha.";
                feedbackText.style.color = "#e17055";
            } else {
                feedbackText.innerText = "üí™ C·ªê L√äN NH√â! H√£y ƒë·ªçc ph·∫ßn Gi·∫£i th√≠ch chi ti·∫øt ƒë·ªÉ r√∫t kinh nghi·ªám n√†o!";
                feedbackText.style.color = "#d63031";
            }

            modal.style.display = "flex";
            clearInterval(timerInterval); // D·ª´ng th·ªùi gian
        }

        function closeModal() {
            document.getElementById('resultModal').style.display = "none";
        }

        // Initialize
        window.onload = () => {
            updateTimerDisplay();
            renderQuiz();
        };
    </script>
</body>
</html>
