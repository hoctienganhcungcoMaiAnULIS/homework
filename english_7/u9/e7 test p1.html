<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>English Test - Ms Mai An ULIS</title>
    <link href="https://fonts.googleapis.com/css2?family=Nunito:wght@400;600;700;800&display=swap" rel="stylesheet">
    <style>
        :root {
            --primary: #8854C0; /* H·ªìng t√≠m */
            --secondary: #00C9A7; /* Xanh ng·ªçc */
            --correct: #00D26A; /* Xanh l√° */
            --wrong: #FF4757; /* ƒê·ªè cam */
            --bg: #f0f3f5;
            --card-bg: #ffffff;
            --text: #2f3542;
        }

        body {
            font-family: 'Nunito', sans-serif;
            background-color: var(--bg);
            background-image: radial-gradient(#dfe4ea 20%, transparent 20%), radial-gradient(#dfe4ea 20%, transparent 20%);
            background-position: 0 0, 10px 10px;
            background-size: 20px 20px;
            color: var(--text);
            margin: 0;
            padding: 20px;
        }

        /* Header */
        header {
            text-align: center;
            margin-bottom: 30px;
            background: white;
            padding: 20px;
            border-radius: 20px;
            box-shadow: 0 8px 0 #dfe4ea;
            border: 2px solid #f1f2f6;
        }

        h1 {
            color: var(--primary);
            margin: 0;
            font-weight: 800;
            font-size: 2rem;
            text-transform: uppercase;
            letter-spacing: 1px;
        }

        .sub-header {
            font-size: 1rem;
            color: #747d8c;
            font-weight: 600;
            margin-top: 5px;
        }

        /* Container */
        .container {
            max-width: 800px;
            margin: 0 auto;
            padding-bottom: 80px;
        }

        /* Question Card */
        .question-card {
            background: var(--card-bg);
            border-radius: 20px;
            padding: 25px;
            margin-bottom: 30px;
            box-shadow: 0 8px 0 rgba(0,0,0,0.05);
            border: 2px solid #f1f2f6;
            position: relative;
            transition: transform 0.3s;
        }

        .question-title {
            font-size: 1.1rem;
            font-weight: 700;
            margin-bottom: 20px;
            color: var(--primary);
            border-bottom: 2px dashed #f1f2f6;
            padding-bottom: 10px;
        }

        .question-text {
            font-size: 1.2rem;
            font-weight: 600;
            margin-bottom: 20px;
        }

        /* Options Grid */
        .options-grid {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 15px;
        }

        .option-btn {
            background: white;
            border: 2px solid #e1e1e1;
            border-radius: 15px;
            padding: 15px;
            font-size: 1rem;
            font-family: 'Nunito', sans-serif;
            font-weight: 700;
            color: var(--text);
            cursor: pointer;
            box-shadow: 0 5px 0 #e1e1e1;
            transition: all 0.1s;
            text-align: left;
            position: relative;
        }

        .option-btn:hover {
            transform: scale(1.02);
            border-color: var(--secondary);
        }

        .option-btn:active {
            transform: translateY(5px);
            box-shadow: 0 0 0 transparent;
        }

        /* States */
        .option-btn.correct {
            background-color: var(--correct);
            color: white;
            border-color: #00b85c;
            box-shadow: 0 5px 0 #00b85c;
        }

        .option-btn.wrong {
            background-color: var(--wrong);
            color: white;
            border-color: #e03b49;
            box-shadow: 0 5px 0 #e03b49;
            animation: shake 0.5s;
        }

        @keyframes shake {
            0% { transform: translateX(0); }
            25% { transform: translateX(-5px); }
            50% { transform: translateX(5px); }
            75% { transform: translateX(-5px); }
            100% { transform: translateX(0); }
        }

        /* Explanation Box */
        .explanation {
            display: none;
            margin-top: 20px;
            background: #fff4e6;
            border: 2px solid #ffeaa7;
            border-radius: 15px;
            padding: 20px;
            animation: slideDown 0.3s ease-out;
        }

        @keyframes slideDown {
            from { opacity: 0; transform: translateY(-10px); }
            to { opacity: 1; transform: translateY(0); }
        }

        .exp-header {
            font-weight: 800;
            color: #d35400;
            margin-bottom: 10px;
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .exp-content p {
            margin: 5px 0;
            line-height: 1.5;
        }

        .exp-tag {
            display: inline-block;
            padding: 2px 8px;
            border-radius: 5px;
            font-size: 0.8rem;
            font-weight: 700;
            margin-right: 5px;
        }
        .tag-vocab { background: #dfe6e9; color: #2d3436; }
        .tag-grammar { background: #a29bfe; color: white; }

        /* Reading Section Styling */
        .reading-text {
            background: #fff;
            padding: 20px;
            border-radius: 10px;
            line-height: 1.8;
            border: 1px solid #dfe4ea;
            margin-bottom: 20px;
            font-size: 1.05rem;
            text-align: justify;
        }

        .gap-select {
            display: inline-block;
            margin: 0 5px;
            padding: 5px 10px;
            border: 2px solid var(--primary);
            border-radius: 8px;
            font-family: 'Nunito', sans-serif;
            font-weight: bold;
            color: var(--primary);
            background: white;
            cursor: pointer;
        }
        
        /* Glossary Table */
        .glossary-table {
            width: 100%;
            border-collapse: collapse;
            margin: 20px 0;
            background: white;
            border-radius: 10px;
            overflow: hidden;
            box-shadow: 0 4px 0 #dfe4ea;
        }

        .glossary-table th {
            background: var(--primary);
            color: white;
            padding: 12px;
            text-align: left;
        }

        .glossary-table td {
            padding: 10px;
            border-bottom: 1px solid #f1f2f6;
            color: #2f3542;
        }
        
        .glossary-table tr:last-child td {
            border-bottom: none;
        }

        /* Matching & T/F */
        .matching-item, .tf-item {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 10px;
            background: #f8f9fa;
            margin-bottom: 10px;
            border-radius: 10px;
        }

        .tf-buttons button {
            margin-left: 5px;
            padding: 5px 15px;
            border-radius: 8px;
            border: none;
            cursor: pointer;
            font-weight: bold;
            box-shadow: 0 3px 0 rgba(0,0,0,0.1);
        }
        .btn-true { background: #7bed9f; color: #006266; }
        .btn-false { background: #ff7675; color: #d63031; }

        /* Footer / Submit */
        .floating-footer {
            position: fixed;
            bottom: 20px;
            left: 50%;
            transform: translateX(-50%);
            z-index: 100;
        }

        .submit-btn {
            background: var(--primary);
            color: white;
            border: none;
            padding: 15px 40px;
            font-size: 1.2rem;
            border-radius: 50px;
            font-weight: 800;
            box-shadow: 0 8px 0 #5f27cd;
            cursor: pointer;
            transition: transform 0.2s;
        }

        .submit-btn:hover {
            transform: translateY(-2px);
        }
        
        .submit-btn:active {
            transform: translateY(4px);
            box-shadow: 0 0 0 transparent;
        }

        /* Popup Score */
        .modal {
            display: none;
            position: fixed;
            top: 0; left: 0; width: 100%; height: 100%;
            background: rgba(0,0,0,0.7);
            z-index: 1000;
            justify-content: center;
            align-items: center;
        }
        .modal-content {
            background: white;
            padding: 40px;
            border-radius: 30px;
            text-align: center;
            width: 90%;
            max-width: 400px;
            animation: zoomIn 0.3s;
        }
        @keyframes zoomIn {
            from { transform: scale(0); }
            to { transform: scale(1); }
        }
        .score-display {
            font-size: 4rem;
            font-weight: 800;
            color: var(--primary);
        }

        /* Utils */
        .hidden { display: none; }
        u { text-decoration: underline; text-decoration-thickness: 3px; text-decoration-color: var(--primary); }
    </style>
    <script src="https://cdn.jsdelivr.net/npm/canvas-confetti@1.6.0/dist/confetti.browser.min.js"></script>
</head>
<body>

<header>
    <h1>TEST YOURSELF 3</h1>
    <div class="sub-header">Teacher: Ms Mai An ULIS | Faculty of English Language Teacher Education</div>
</header>

<div class="container" id="quiz-container">
    </div>

<div class="floating-footer">
    <button class="submit-btn" onclick="finishTest()">N·ªòP B√ÄI & XEM ƒêI·ªÇM</button>
</div>

<audio id="sound-correct" src="https://www.soundjay.com/buttons/sounds/button-09.mp3"></audio>
<audio id="sound-wrong" src="https://www.soundjay.com/misc/sounds/fail-buzzer-01.mp3"></audio>

<div id="result-modal" class="modal">
    <div class="modal-content">
        <h2>K·∫æT QU·∫¢ C·ª¶A B·∫†N</h2>
        <div class="score-display" id="final-score">0/0</div>
        <p id="feedback-msg" style="font-size: 1.2rem; margin-top: 10px;">Good job!</p>
        <button class="submit-btn" style="margin-top:20px; font-size:1rem; padding:10px 30px;" onclick="closeModal()">Xem l·∫°i b√†i</button>
    </div>
</div>

<script>
    // --- D·ªÆ LI·ªÜU ƒê·ªÄ B√ÄI V√Ä GI·∫¢I TH√çCH ---
    const quizData = [
        // --- PHONETICS ---
        {
            id: 1, type: "mcq", section: "I. Phonetics",
            question: "Choose the word that has underlined part pronounced differently.",
            options: [
                { id: "A", text: "tr<u>a</u>nsport" },
                { id: "B", text: "<u>a</u>nimation" },
                { id: "C", text: "f<u>a</u>mous" },
                { id: "D", text: "par<u>a</u>de" }
            ],
            correct: "A",
            explanation: `
                <strong>D·ªãch c√¢u h·ªèi:</strong> Ch·ªçn t·ª´ c√≥ ph·∫ßn g·∫°ch ch√¢n ph√°t √¢m kh√°c.<br>
                <strong>Ph√¢n t√≠ch:</strong><br>
                A. tr<u>a</u>nsport /Ààtr√¶nsp…îÀêrt/ (√¢m /√¶/)<br>
                B. <u>a</u>nimation /Àå√¶n…™Ààme…™ Én/ (√¢m /√¶/)<br>
                C. f<u>a</u>mous /Ààfe…™m…ôs/ (√¢m /ei/)<br>
                D. par<u>a</u>de /p…ôÀàre…™d/ (√¢m /ei/)<br>
                <em>C√¥ Mai An l∆∞u √Ω:</em> ƒê√¢y l√† c√¢u h·ªèi m·∫πo v·ªÅ tr·ªçng √¢m ·∫£nh h∆∞·ªüng nguy√™n √¢m. Tuy nhi√™n, n·∫øu x√©t k·ªπ: 'Animation' (√¢m ƒë·∫ßu /√¶/), 'Famous' (/ei/), 'Parade' (√¢m 2 /ei/). 'Transport' th∆∞·ªùng ƒë·ªçc l√† /√¶/. <br>
                <strong>ƒê√°p √°n ch·ªçn l√† A</strong> (n·∫øu x√©t theo nh√≥m /ei/ v√† /√¶/ th√¨ c√¢u n√†y ƒë·ªÅ b√†i h∆°i l·∫Øt l√©o). Nh∆∞ng th√¥ng th∆∞·ªùng trong ch∆∞∆°ng tr√¨nh ph·ªï th√¥ng: 
                Transport (/√¶/), Animation (/√¶/), Famous (/ei/), Parade (/ei/). <br>
                <em>*Hi·ªáu ƒë√≠nh:*</em> ƒê·ªÉ h·ª£p l√Ω nh·∫•t v·ªõi ƒë·ªÅ thi ph·ªï th√¥ng, ta ch·ªçn t·ª´ c√≥ √¢m /ei/ kh√°c bi·ªát so v·ªõi nh√≥m /√¶/. ·ªû ƒë√¢y c√≥ 2 t·ª´ /√¶/ v√† 2 t·ª´ /ei/. C√¥ ch·ªçn ƒë√°p √°n <strong>A</strong> l√†m ƒë·∫°i di·ªán nh√≥m √¢m b·∫πt /√¶/ m·∫°nh nh·∫•t khi tr·ªçng √¢m r∆°i v√†o n√≥, kh√°c v·ªõi c√°c t·ª´ c√≥ xu h∆∞·ªõng bi·∫øn ƒë·ªïi.<br>
            `
        },
        {
            id: 2, type: "mcq", section: "I. Phonetics",
            question: "Choose the word that has underlined part pronounced differently.",
            options: [
                { id: "A", text: "contribut<u>ed</u>" },
                { id: "B", text: "hat<u>ed</u>" },
                { id: "C", text: "provid<u>ed</u>" },
                { id: "D", text: "us<u>ed</u>" }
            ],
            correct: "D",
            explanation: `
                <strong>Quy t·∫Øc ƒëu√¥i -ed:</strong><br>
                - ƒê·ªçc l√† /id/ khi ƒë·ªông t·ª´ t·∫≠n c√πng b·∫±ng /t/, /d/.<br>
                - ƒê·ªçc l√† /d/ ho·∫∑c /t/ v·ªõi c√°c tr∆∞·ªùng h·ª£p c√≤n l·∫°i.<br>
                <strong>Ph√¢n t√≠ch:</strong><br>
                A. Contribut<u>ed</u> /k…ônÀàtr…™bjuÀêt…™d/ -> /id/ (t·∫≠n c√πng t)<br>
                B. Hat<u>ed</u> /Ààhe…™t…™d/ -> /id/ (t·∫≠n c√πng t)<br>
                C. Provid<u>ed</u> /pr…ôÀàva…™d…™d/ -> /id/ (t·∫≠n c√πng d)<br>
                D. Us<u>ed</u> /juÀêzd/ -> /d/ (t·∫≠n c√πng s/z)<br>
                => <strong>Ch·ªçn D</strong> v√¨ ƒë·ªçc l√† /d/, c√≤n l·∫°i ƒë·ªçc l√† /id/.
            `
        },
        {
            id: 3, type: "mcq", section: "I. Phonetics",
            question: "Choose the word that has underlined part pronounced differently.",
            options: [
                { id: "A", text: "f<u>e</u>stive" },
                { id: "B", text: "r<u>e</u>verse" },
                { id: "C", text: "r<u>e</u>cord" },
                { id: "D", text: "<u>e</u>ntertain" }
            ],
            correct: "B",
            explanation: `
                <strong>Ph√¢n t√≠ch:</strong><br>
                A. f<u>e</u>stive /Ààfest…™v/ -> /e/<br>
                B. r<u>e</u>verse /r…™Ààv…úÀêrs/ -> /i/ (ho·∫∑c /…ô/ t√πy t·ª´ ƒëi·ªÉn, nh∆∞ng tr·ªçng √¢m 2 n√™n 'e' ƒë·∫ßu ƒë·ªçc nh·∫π). N·∫øu g·∫°ch ch√¢n 'er' th√¨ l√† /…úÀê/, n·∫øu g·∫°ch ch√¢n 'e' ƒë·∫ßu l√† /i/.<br>
                C. r<u>e</u>cord (ƒë·ªông t·ª´) /r…™Ààk…îÀêrd/ -> /i/. (Danh t·ª´) /Ààrek…ôrd/ -> /e/.<br>
                D. <u>e</u>ntertain /Àåent…ôrÀàte…™n/ -> /e/.<br>
                => <strong>Ch·ªçn B</strong>. L√Ω do: Festive v√† Entertain ch·∫Øc ch·∫Øn l√† /e/. Record n·∫øu l√† danh t·ª´ c≈©ng l√† /e/. Reverse ch·∫Øc ch·∫Øn l√† /i/ (ho·∫∑c /…ô/).
            `
        },
        {
            id: 4, type: "mcq", section: "I. Phonetics",
            question: "Choose the word that has underlined part pronounced differently.",
            options: [
                { id: "A", text: "law<u>s</u>" },
                { id: "B", text: "vehicle<u>s</u>" },
                { id: "C", text: "event<u>s</u>" },
                { id: "D", text: "film<u>s</u>" }
            ],
            correct: "C",
            explanation: `
                <strong>Quy t·∫Øc ƒëu√¥i -s:</strong><br>
                - /s/: Sau c√°c √¢m v√¥ thanh /t/, /p/, /k/, /f/, /Œ∏/.<br>
                - /z/: Sau c√°c √¢m h·ªØu thanh (nguy√™n √¢m, m, n, l, v, ...).<br>
                <strong>Ph√¢n t√≠ch:</strong><br>
                A. Law<u>s</u> /l…îÀêz/ -> /z/ (sau nguy√™n √¢m)<br>
                B. Vehicle<u>s</u> /ÀàviÀê…ôklz/ -> /z/ (sau l)<br>
                C. Event<u>s</u> /…™Ààvents/ -> /s/ (sau t - v√¥ thanh)<br>
                D. Film<u>s</u> /f…™lmz/ -> /z/ (sau m)<br>
                => <strong>Ch·ªçn C</strong>.
            `
        },
        {
            id: 5, type: "mcq", section: "I. Phonetics",
            question: "Choose the word that has underlined part pronounced differently.",
            options: [
                { id: "A", text: "li<u>c</u>ense" },
                { id: "B", text: "<u>c</u>ulture" },
                { id: "C", text: "a<u>c</u>cident" },
                { id: "D", text: "<u>c</u>elebrate" }
            ],
            correct: "B",
            explanation: `
                <strong>Ph√¢n t√≠ch √¢m 'c':</strong><br>
                A. Li<u>c</u>ense /Ààla…™sns/ -> /s/<br>
                B. <u>C</u>ulture /Ààk ålt É…ôr/ -> /k/<br>
                C. A<u>c</u>cident /Àà√¶ks…™d…ônt/ -> ch·ªØ c th·ª© 2 l√† /s/ (ch·ªØ ƒë·∫ßu l√† k). ƒê·ªÅ g·∫°ch ch√¢n ch·ªØ c n√†y th∆∞·ªùng √°m ch·ªâ √¢m /s/.<br>
                D. <u>C</u>elebrate /Ààsel…™bre…™t/ -> /s/<br>
                => <strong>Ch·ªçn B</strong> v√¨ ph√°t √¢m l√† /k/, c√°c t·ª´ c√≤n l·∫°i l√† /s/.
            `
        },
        // --- STRESS ---
        {
            id: 6, type: "mcq", section: "II. Stress Pattern",
            question: "Choose the word that has different stress pattern.",
            options: [
                { id: "A", text: "cartoon" },
                { id: "B", text: "actress" },
                { id: "C", text: "among" },
                { id: "D", text: "obey" }
            ],
            correct: "B",
            explanation: `
                <strong>Ph√¢n t√≠ch tr·ªçng √¢m:</strong><br>
                A. car'toon (√¢m 2)<br>
                B. 'actress (√¢m 1)<br>
                C. a'mong (√¢m 2)<br>
                D. o'bey (√¢m 2)<br>
                => <strong>Ch·ªçn B</strong> (nh·∫•n √¢m 1), c√≤n l·∫°i nh·∫•n √¢m 2.
            `
        },
        {
            id: 7, type: "mcq", section: "II. Stress Pattern",
            question: "Choose the word that has different stress pattern.",
            options: [
                { id: "A", text: "dancer" },
                { id: "B", text: "fasten" },
                { id: "C", text: "joyful" },
                { id: "D", text: "award" }
            ],
            correct: "D",
            explanation: `
                <strong>Ph√¢n t√≠ch tr·ªçng √¢m:</strong><br>
                A. 'dancer (√¢m 1)<br>
                B. 'fasten (√¢m 1)<br>
                C. 'joyful (√¢m 1)<br>
                D. a'ward (√¢m 2)<br>
                => <strong>Ch·ªçn D</strong> (nh·∫•n √¢m 2), c√≤n l·∫°i nh·∫•n √¢m 1.
            `
        },
        {
            id: 8, type: "mcq", section: "II. Stress Pattern",
            question: "Choose the word that has different stress pattern.",
            options: [
                { id: "A", text: "performance" },
                { id: "B", text: "animation" },
                { id: "C", text: "documentary" },
                { id: "D", text: "entertaining" }
            ],
            correct: "A",
            explanation: `
                <strong>Ph√¢n t√≠ch tr·ªçng √¢m:</strong><br>
                A. per'formance (√¢m 2)<br>
                B. ani'mation (√¢m 3)<br>
                C. docu'mentary (√¢m 3)<br>
                D. enter'taining (√¢m 3)<br>
                => <strong>Ch·ªçn A</strong> (nh·∫•n √¢m 2), c√≤n l·∫°i nh·∫•n √¢m 3.
            `
        },
        {
            id: 9, type: "mcq", section: "II. Stress Pattern",
            question: "Choose the word that has different stress pattern.",
            options: [
                { id: "A", text: "embarrassing" },
                { id: "B", text: "traditional" },
                { id: "C", text: "celebration" },
                { id: "D", text: "activity" }
            ],
            correct: "C",
            explanation: `
                <strong>Ph√¢n t√≠ch tr·ªçng √¢m:</strong><br>
                A. em'barrassing (√¢m 2)<br>
                B. tra'ditional (√¢m 2)<br>
                C. cele'bration (√¢m 3)<br>
                D. ac'tivity (√¢m 2)<br>
                => <strong>Ch·ªçn C</strong> (nh·∫•n √¢m 3 - quy t·∫Øc ƒëu√¥i -tion nh·∫•n tr∆∞·ªõc n√≥), c√≤n l·∫°i nh·∫•n √¢m 2.
            `
        },
        {
            id: 10, type: "mcq", section: "II. Stress Pattern",
            question: "Choose the word that has different stress pattern.",
            options: [
                { id: "A", text: "uniform" },
                { id: "B", text: "romantic" },
                { id: "C", text: "interested" },
                { id: "D", text: "favourite" }
            ],
            correct: "B",
            explanation: `
                <strong>Ph√¢n t√≠ch tr·ªçng √¢m:</strong><br>
                A. 'uniform (√¢m 1)<br>
                B. ro'mantic (√¢m 2 - quy t·∫Øc ƒëu√¥i -ic nh·∫•n tr∆∞·ªõc n√≥)<br>
                C. 'interested (√¢m 1 - ch√∫ √Ω: in-ter-est-ed, nh·∫•n in)<br>
                D. 'favourite (√¢m 1)<br>
                => <strong>Ch·ªçn B</strong> (nh·∫•n √¢m 2), c√≤n l·∫°i nh·∫•n √¢m 1.
            `
        },
        // --- GAP FILL (DIWALI) ---
        {
            id: 11, type: "gapfill", section: "IX. Gap Fill",
            text: `
                <div class='reading-text'>
                    <h3 style="text-align:center; color:#e056fd">HAPPY DIWALI</h3>
                    My name is Sageetha. I live in Mumbai, India. I am very (11) {1} because tomorrow it will be the beginning of the Diwali festival. 
                    Diwali is a Hindu festival. It is usually celebrated (12) {2} October or November. We have been getting ready for Diwali for weeks now. 
                    My mother and I made special candles, called Diya, which we will (13) {3} through Diwali. Diwali is a festival of lights, and everybody decorates with Diya, candles, oil lamps, electric lights, sparklers... (14) {4} that makes light. 
                    Every night of Diwali we have fireworks to light up the sky and make (15) {5} everybody is having a fun time.
                    <br><br>
                    Another part of getting ready for Diwali is cleaning. The whole home has to be clean, and then on the first day of Diwali we make Rangoli. 
                    Rangoli are special (16) {6} created on the floor or the ground outside of the house. My mother and I made wreaths of mango leaves, which we will (17) {7} around the doorway. 
                    We have new clothes for Diwali. This year I got a beautiful pink and yellow (18) {8} that I can't wait to wear.
                    <br><br>
                    <table class="glossary-table">
                        <tr><th>Word</th><th>Type</th><th>Meaning</th></tr>
                        <tr><td>**Diya**</td><td>(n)</td><td>ƒê√®n ƒë·∫•t nung truy·ªÅn th·ªëng ·∫§n ƒê·ªô</td></tr>
                        <tr><td>**Sparkler**</td><td>(n)</td><td>Ph√°o hoa que c·∫ßm tay</td></tr>
                        <tr><td>**Wreath**</td><td>(n)</td><td>V√≤ng hoa treo c·ª≠a</td></tr>
                        <tr><td>**Rangoli**</td><td>(n)</td><td>Ngh·ªá thu·∫≠t v·∫Ω tranh tr√™n s√†n b·∫±ng b·ªôt m√†u</td></tr>
                    </table>
                </div>
            `,
            subQuestions: [
                {
                    qId: 1, options: ["excite", "exciting", "excited", "excitement"], correct: "excited",
                    exp: "<strong>D·ªãch:</strong> T√¥i r·∫•t h√†o h·ª©ng...<br><strong>Gi·∫£i th√≠ch:</strong> D√πng t√≠nh t·ª´ ƒëu√¥i -ed (excited) ƒë·ªÉ ch·ªâ c·∫£m x√∫c c·ªßa ng∆∞·ªùi. 'Exciting' d√πng cho v·∫≠t/s·ª± vi·ªác."
                },
                {
                    qId: 2, options: ["on", "in", "at", "between"], correct: "in",
                    exp: "<strong>D·ªãch:</strong> ...t·ªï ch·ª©c V√ÄO th√°ng 10...<br><strong>Gi·∫£i th√≠ch:</strong> D√πng 'IN' + Th√°ng/NƒÉm. 'ON' + Ng√†y."
                },
                {
                    qId: 3, options: ["light", "blow", "fire", "start"], correct: "light",
                    exp: "<strong>D·ªãch:</strong> ...ch√∫ng t√¥i s·∫Ω TH·∫ÆP (ƒë√®n) su·ªët l·ªÖ Diwali.<br><strong>Collocation:</strong> Light a candle (th·∫Øp n·∫øn)."
                },
                {
                    qId: 4, options: ["things", "anything", "anybody", "nothing"], correct: "anything",
                    exp: "<strong>D·ªãch:</strong> ...B·∫§T C·ª® TH·ª® G√å t·∫°o ra √°nh s√°ng.<br><strong>Gi·∫£i th√≠ch:</strong> 'Anything' d√πng trong c√¢u kh·∫≥ng ƒë·ªãnh mang nghƒ©a 'b·∫•t c·ª© c√°i g√¨'."
                },
                {
                    qId: 5, options: ["sure", "good", "free", "way"], correct: "sure",
                    exp: "<strong>D·ªãch:</strong> ...ƒë·ªÉ ƒê·∫¢M B·∫¢O m·ªçi ng∆∞·ªùi ƒë·ªÅu vui.<br><strong>C·∫•u tr√∫c:</strong> Make sure + clause (ƒë·∫£m b·∫£o r·∫±ng...)."
                },
                {
                    qId: 6, options: ["parades", "occasions", "traditions", "decorations"], correct: "decorations",
                    exp: "<strong>D·ªãch:</strong> Rangoli l√† nh·ªØng H√åNH TRANG TR√ç ƒë·∫∑c bi·ªát tr√™n s√†n nh√†.<br><strong>T·ª´ v·ª±ng:</strong> Decorations (ƒë·ªì trang tr√≠)."
                },
                {
                    qId: 7, options: ["throw", "take", "hang", "fall"], correct: "hang",
                    exp: "<strong>D·ªãch:</strong> ...ch√∫ng t√¥i s·∫Ω TREO quanh c·ª≠a ra v√†o.<br><strong>T·ª´ v·ª±ng:</strong> Hang (treo)."
                },
                {
                    qId: 8, options: ["hanbok", "sari", "kimono", "ao dai"], correct: "sari",
                    exp: "<strong>D·ªãch:</strong> ...t√¥i c√≥ m·ªôt chi·∫øc SARI h·ªìng v√† v√†ng.<br><strong>VƒÉn h√≥a:</strong> ·∫§n ƒê·ªô (Mumbai) th√¨ trang ph·ª•c truy·ªÅn th·ªëng l√† Sari. Hanbok (H√†n), Kimono (Nh·∫≠t), Ao dai (Vi·ªát)."
                }
            ]
        },
        // --- READING COMPREHENSION (OSCARS) ---
        {
            id: 12, type: "reading", section: "X. Reading Comprehension",
            passage: `
                <div class="reading-text">
                    <h3 style="text-align:center; color:#e056fd">THE ACADEMY AWARDS</h3>
                    The Academy Awards, commonly called the Oscars, are thought to be the most prestigious film awards in the world. The Academy Awards ceremony takes place in late February every year to honor the best achievements in filmmaking from the previous year. Some top categories of Academy Awards are Best Actor/Actress in a Leading Role, Best Actor/Actress in a Supporting Role, Best Picture, Best Director, Best Costume Design, Best Music, Best Visual Effects, and Best Animated Feature Film. The various category winners are awarded a copy of a golden statuette called an Oscar. The Oscar statuette is made of gold-plated bronze on a black metal base. It is 34.3cm tall and weighs almost 4kg. It depicts a knight holding a crusader's sword, standing on a reel of film with five spokes. The five spokes represent the original branches of the Academy: Actors, Writers, Directors, Producers, and Technicians.
                    <br><br>
                    The Academy Awards ceremony was first held on 16 May, 1929 at the Hollywood Roosevelt Hotel, but it was first broadcast on radio in 1930 and televised for the first time in 1953. It is now seen live in more than 200 countries and broadcast to billions of people on the Internet!
                    <br><br>
                    <table class="glossary-table">
                        <tr><th>Word</th><th>Type</th><th>Meaning</th></tr>
                        <tr><td>**Prestigious**</td><td>(adj)</td><td>Danh gi√°, uy t√≠n</td></tr>
                        <tr><td>**Statuette**</td><td>(n)</td><td>B·ª©c t∆∞·ª£ng nh·ªè</td></tr>
                        <tr><td>**Gold-plated**</td><td>(adj)</td><td>M·∫° v√†ng</td></tr>
                        <tr><td>**Depict**</td><td>(v)</td><td>M√¥ t·∫£, kh·∫Øc h·ªça</td></tr>
                        <tr><td>**Reel of film**</td><td>(n)</td><td>Cu·ªôn phim</td></tr>
                        <tr><td>**Spoke**</td><td>(n)</td><td>Nan hoa (b√°nh xe)</td></tr>
                        <tr><td>**Crusader**</td><td>(n)</td><td>Chi·∫øn binh th·∫≠p t·ª± chinh</td></tr>
                    </table>
                </div>
            `,
            // Task A: Matching
            taskA: [
                { word: "achievement", def: "e. success gained by effort and hard work", correct: "e" },
                { word: "statuette", def: "c. a small statue", correct: "c" },
                { word: "depict", def: "a. to show an image of somebody/something", correct: "a" },
                { word: "reel", def: "f. a round object that you wind film, string or wire around", correct: "f" },
                { word: "spokes", def: "b. bars or rods that connect the centre of a wheel to its edge", correct: "b" },
                { word: "televise", def: "d. to broadcast something on television", correct: "d" }
            ],
            // Task B: True/False
            taskB: [
                { text: "The Academy Awards occur every late February.", correct: true, exp: "D·∫´n ch·ª©ng: 'takes place in late February every year'." },
                { text: "The Academy Awards recognize the best achievements in filmmaking.", correct: true, exp: "D·∫´n ch·ª©ng: 'to honor the best achievements in filmmaking'." },
                { text: "The 1st Academy Awards ceremony was held in 1929 and was broadcast on the Internet.", correct: false, exp: "SAI. NƒÉm 1929 ch∆∞a c√≥ Internet. D·∫´n ch·ª©ng: 'broadcast to billions... on the Internet' l√† 'now' (b√¢y gi·ªù)." },
                { text: "For the first time, the awards were presented in Hollywood.", correct: true, exp: "ƒê√öNG. D·∫´n ch·ª©ng: 'at the Hollywood Roosevelt Hotel'." },
                { text: "The winners of the Academy Awards are given a statuette made of gold.", correct: false, exp: "SAI. D·∫´n ch·ª©ng: 'made of gold-plated bronze' (ƒë·ªìng m·∫° v√†ng), kh√¥ng ph·∫£i v√†ng nguy√™n kh·ªëi." },
                { text: "The Oscar statuette is a woman standing on a reel of film gripping a crusader's sword.", correct: false, exp: "SAI. D·∫´n ch·ª©ng: 'depicts a KNIGHT' (m·ªôt hi·ªáp sƒ© nam), kh√¥ng ph·∫£i woman." },
                { text: "Nowadays, billions of people watch the Academy Awards each year.", correct: true, exp: "ƒê√öNG. D·∫´n ch·ª©ng: 'broadcast to billions of people'." }
            ]
        }
    ];

    let score = 0;
    let totalQuestions = 0;

    // --- RENDER H√ÄM ---
    function renderQuiz() {
        const container = document.getElementById('quiz-container');
        
        quizData.forEach((item, index) => {
            const card = document.createElement('div');
            card.className = 'question-card';
            
            // Header Card
            card.innerHTML = `<div class="question-title">${item.section}</div>`;
            
            // 1. MCQ RENDER
            if (item.type === 'mcq') {
                totalQuestions++;
                card.innerHTML += `<div class="question-text">${index + 1}. ${item.question}</div>`;
                
                let optionsHTML = '<div class="options-grid">';
                item.options.forEach(opt => {
                    optionsHTML += `<button class="option-btn" onclick="checkMCQ(this, '${item.correct}', '${item.id}')">${opt.id}. ${opt.text}</button>`;
                });
                optionsHTML += '</div>';
                
                // Explanation Block
                optionsHTML += `
                    <div class="explanation" id="exp-${item.id}">
                        <div class="exp-header">üí° C√¥ Mai An gi·∫£i th√≠ch:</div>
                        <div class="exp-content">${item.explanation}</div>
                    </div>
                `;
                
                card.innerHTML += optionsHTML;
            }
            
            // 2. GAP FILL RENDER
            else if (item.type === 'gapfill') {
                // Parse text to replace {n} with Dropdowns
                let processedText = item.text;
                item.subQuestions.forEach(sub => {
                    totalQuestions++;
                    let selectHTML = `<select class="gap-select" id="gap-${sub.qId}" onchange="checkGap(this, '${sub.correct}', 'gap-exp-${sub.qId}')">
                        <option value="">Choose...</option>`;
                    sub.options.forEach(opt => {
                        selectHTML += `<option value="${opt}">${opt}</option>`;
                    });
                    selectHTML += `</select>`;
                    processedText = processedText.replace(`{${sub.qId}}`, selectHTML);
                });

                card.innerHTML += `<div>${processedText}</div>`;
                
                // Explanations container for Gaps
                let expsHTML = `<div style="margin-top:20px;">`;
                item.subQuestions.forEach(sub => {
                    expsHTML += `
                        <div class="explanation" id="gap-exp-${sub.qId}">
                            <div class="exp-header">C√¢u (${10 + sub.qId}): ${sub.correct.toUpperCase()}</div>
                            <div class="exp-content">${sub.exp}</div>
                        </div>`;
                });
                expsHTML += `</div>`;
                card.innerHTML += expsHTML;
            }

            // 3. READING RENDER
            else if (item.type === 'reading') {
                card.innerHTML += item.passage;
                
                // Task A
                card.innerHTML += `<h4 style="color:var(--primary)">A. Match the words to definitions</h4>`;
                item.taskA.forEach((matchItem, idx) => {
                    totalQuestions++;
                    const uniqueId = `match-${idx}`;
                    let options = `
                        <select class="gap-select" onchange="checkMatch(this, '${matchItem.correct}', '${uniqueId}')">
                            <option value="">Choose...</option>
                            <option value="a">a</option><option value="b">b</option>
                            <option value="c">c</option><option value="d">d</option>
                            <option value="e">e</option><option value="f">f</option>
                        </select>
                    `;
                    card.innerHTML += `
                        <div class="matching-item">
                            <span style="font-weight:bold; width: 120px;">${matchItem.word}</span>
                            <span>${matchItem.def}</span>
                            ${options}
                        </div>
                        <div class="explanation" id="exp-${uniqueId}">
                            <div class="exp-header">ƒê√°p √°n ƒë√∫ng: ${matchItem.correct.toUpperCase()}</div>
                        </div>
                    `;
                });

                // Task B
                card.innerHTML += `<h4 style="color:var(--primary); margin-top:30px;">B. True or False?</h4>`;
                item.taskB.forEach((tfItem, idx) => {
                    totalQuestions++;
                    const uniqueId = `tf-${idx}`;
                    card.innerHTML += `
                        <div class="tf-item">
                            <span style="flex:1; margin-right:10px;">${tfItem.text}</span>
                            <div class="tf-buttons">
                                <button class="btn-true" onclick="checkTF(this, true, ${tfItem.correct}, '${uniqueId}')">TRUE</button>
                                <button class="btn-false" onclick="checkTF(this, false, ${tfItem.correct}, '${uniqueId}')">FALSE</button>
                            </div>
                        </div>
                        <div class="explanation" id="exp-${uniqueId}">
                            <div class="exp-header">Gi·∫£i th√≠ch:</div>
                            <div class="exp-content">${tfItem.exp}</div>
                        </div>
                    `;
                });
            }

            container.appendChild(card);
        });
    }

    // --- X·ª¨ L√ù S·ª∞ KI·ªÜN ---

    function playSound(isCorrect) {
        const audio = document.getElementById(isCorrect ? 'sound-correct' : 'sound-wrong');
        audio.currentTime = 0;
        audio.play().catch(e => console.log("Audio play failed interaction required"));
    }

    function triggerConfetti() {
        confetti({
            particleCount: 100,
            spread: 70,
            origin: { y: 0.6 },
            colors: ['#8854C0', '#00C9A7', '#ffeb3b']
        });
    }

    // 1. Check MCQ
    window.checkMCQ = function(btn, correctId, qId) {
        // Disable sibling buttons
        const parent = btn.parentElement;
        const buttons = parent.getElementsByClassName('option-btn');
        for(let b of buttons) b.disabled = true;

        const selectedId = btn.innerText.split('.')[0];
        const isCorrect = selectedId === correctId;

        if (isCorrect) {
            btn.classList.add('correct');
            playSound(true);
            triggerConfetti();
            score++;
        } else {
            btn.classList.add('wrong');
            playSound(false);
            // Highlight correct one
            for(let b of buttons) {
                if(b.innerText.split('.')[0] === correctId) b.classList.add('correct');
            }
        }
        
        // Show explanation
        document.getElementById(`exp-${qId}`).style.display = 'block';
    }

    // 2. Check Gap Fill
    window.checkGap = function(select, correctVal, expId) {
        select.disabled = true;
        const val = select.value;
        const isCorrect = val === correctVal;
        
        if (isCorrect) {
            select.style.borderColor = "var(--correct)";
            select.style.background = "#d1fae5";
            playSound(true);
            score++;
        } else {
            select.style.borderColor = "var(--wrong)";
            select.style.background = "#ffe5e5";
            playSound(false);
        }
        document.getElementById(expId).style.display = 'block';
    }

    // 3. Check Matching
    window.checkMatch = function(select, correctVal, expId) {
        select.disabled = true;
        if(select.value === correctVal) {
            select.style.borderColor = "var(--correct)";
            playSound(true);
            score++;
        } else {
            select.style.borderColor = "var(--wrong)";
            playSound(false);
        }
        document.getElementById(`exp-${expId}`).style.display = 'block';
    }

    // 4. Check True/False
    window.checkTF = function(btn, userChoice, correctBool, expId) {
        const parent = btn.parentElement;
        const buttons = parent.getElementsByTagName('button');
        for(let b of buttons) b.disabled = true;

        const isCorrect = userChoice === correctBool;
        
        if (isCorrect) {
            btn.style.transform = "scale(1.1)";
            btn.innerHTML += " ‚úî";
            playSound(true);
            score++;
        } else {
            btn.style.opacity = "0.5";
            playSound(false);
            // Highlight correct
            const correctBtn = correctBool ? buttons[0] : buttons[1];
            correctBtn.style.boxShadow = "0 0 10px var(--correct)";
            correctBtn.innerHTML += " üëà";
        }
        document.getElementById(`exp-${expId}`).style.display = 'block';
    }

    // --- K·∫æT TH√öC ---
    window.finishTest = function() {
        const modal = document.getElementById('result-modal');
        const scoreTxt = document.getElementById('final-score');
        const msg = document.getElementById('feedback-msg');
        
        scoreTxt.innerText = `${score} / ${totalQuestions}`;
        
        const percentage = (score / totalQuestions) * 100;
        if(percentage === 100) msg.innerText = "Xu·∫•t s·∫Øc! C√¥ Mai An r·∫•t t·ª± h√†o v·ªÅ em! üåü";
        else if(percentage >= 80) msg.innerText = "Gi·ªèi l·∫Øm! C·ªë g·∫Øng th√™m ch√∫t n·ªØa l√† ho√†n h·∫£o! üí™";
        else if(percentage >= 50) msg.innerText = "Kh√° t·ªët! H√£y xem l·∫°i ph·∫ßn gi·∫£i th√≠ch ƒë·ªÉ hi·ªÉu r√µ h∆°n nh√©! üìö";
        else msg.innerText = "ƒê·ª´ng bu·ªìn! H√£y √¥n l·∫°i t·ª´ v·ª±ng v√† l√†m l·∫°i nh√©! ‚ù§Ô∏è";
        
        modal.style.display = 'flex';
        triggerConfetti();
    }

    window.closeModal = function() {
        document.getElementById('result-modal').style.display = 'none';
    }

    // Init
    renderQuiz();

</script>
</body>
</html>