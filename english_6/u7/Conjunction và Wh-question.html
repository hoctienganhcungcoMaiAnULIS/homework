<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Ti·∫øng Anh Ms Mai An - Conjunctions & Wh- Questions</title>
    <link href="https://fonts.googleapis.com/css2?family=Nunito:wght@400;600;700;800&display=swap" rel="stylesheet">
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdn.jsdelivr.net/npm/canvas-confetti@1.6.0/dist/confetti.browser.min.js"></script>
    <style>
        :root {
            --primary: #8854C0;
            --secondary: #00C9A7;
            --correct: #00D26A;
            --incorrect: #FF4757;
            --bg-pattern: #f0f4f8;
        }

        body {
            font-family: 'Nunito', sans-serif;
            background-color: var(--bg-pattern);
            background-image: radial-gradient(#d1d5db 1px, transparent 1px);
            background-size: 20px 20px;
            color: #2d3436;
            min-height: 100vh;
            display: flex;
            flex-direction: column;
            overflow-x: hidden;
        }

        .header-small {
            font-size: 0.9rem;
            color: #636e72;
            text-align: center;
            margin-top: 5px;
        }

        .quiz-container {
            max-width: 800px;
            width: 95%;
            margin: 20px auto;
            perspective: 1000px;
        }

        .card {
            background: white;
            border-radius: 25px;
            box-shadow: 0 15px 0 rgba(0,0,0,0.05);
            padding: 30px;
            border: 3px solid #e2e8f0;
            transition: all 0.3s ease;
        }

        .option-btn {
            width: 100%;
            text-align: left;
            padding: 15px 20px;
            margin-bottom: 12px;
            border-radius: 18px;
            border: 3px solid #e2e8f0;
            background: white;
            box-shadow: 0 6px 0 #e2e8f0;
            font-weight: 700;
            font-size: 1.1rem;
            transition: all 0.1s ease;
            cursor: pointer;
            position: relative;
            display: flex;
            align-items: center;
        }

        .option-btn:hover:not(:disabled) {
            transform: translateY(-2px);
            box-shadow: 0 8px 0 #cbd5e1;
            background-color: #f8fafc;
            border-color: #cbd5e1;
        }

        .option-btn:active:not(:disabled) {
            transform: translateY(4px);
            box-shadow: 0 2px 0 #cbd5e1;
        }

        .option-btn.correct {
            background-color: #dcfce7 !important;
            border-color: var(--correct) !important;
            box-shadow: 0 6px 0 #16a34a !important;
            color: #166534 !important;
        }

        .option-btn.incorrect {
            background-color: #fee2e2 !important;
            border-color: var(--incorrect) !important;
            box-shadow: 0 6px 0 #dc2626 !important;
            color: #991b1b !important;
        }

        .explanation-box {
            margin-top: 20px;
            padding: 20px;
            border-radius: 20px;
            background: #fdf4ff;
            border-left: 8px solid var(--primary);
            display: none;
            animation: slideIn 0.4s ease-out;
        }

        @keyframes slideIn {
            from { opacity: 0; transform: translateY(10px); }
            to { opacity: 1; transform: translateY(0); }
        }

        @keyframes shake {
            0%, 100% { transform: translateX(0); }
            25% { transform: translateX(-8px); }
            75% { transform: translateX(8px); }
        }

        .shake { animation: shake 0.3s ease-in-out; }

        .progress-bar {
            height: 12px;
            background: #e2e8f0;
            border-radius: 10px;
            overflow: hidden;
            margin-bottom: 20px;
        }

        .progress-fill {
            height: 100%;
            background: linear-gradient(90deg, var(--primary), var(--secondary));
            width: 0%;
            transition: width 0.5s ease;
        }

        .badge-teacher {
            background: var(--primary);
            color: white;
            padding: 4px 12px;
            border-radius: 50px;
            font-size: 0.8rem;
            font-weight: 800;
            display: inline-block;
            margin-bottom: 10px;
        }

        .modal-overlay {
            position: fixed;
            top: 0; left: 0; width: 100%; height: 100%;
            background: rgba(0,0,0,0.7);
            display: none;
            justify-content: center;
            align-items: center;
            z-index: 1000;
            backdrop-filter: blur(5px);
        }

        .modal-content {
            background: white;
            padding: 40px;
            border-radius: 30px;
            text-align: center;
            max-width: 500px;
            width: 90%;
            border: 5px solid var(--secondary);
        }

        .letter-tag {
            background: #f1f5f9;
            width: 32px;
            height: 32px;
            display: inline-flex;
            align-items: center;
            justify-content: center;
            border-radius: 8px;
            margin-right: 15px;
            color: #64748b;
            font-size: 0.9rem;
        }
    </style>
</head>
<body>

    <header class="py-6 px-4">
        <h1 class="text-3xl font-extrabold text-center text-[#8854C0]">B√ÄI KI·ªÇM TRA: CONJUNCTIONS & WH- QUESTIONS</h1>
        <p class="header-small">Gi√°o vi√™n t·∫°o: <span class="font-bold">Ms Mai An ULIS</span> (M.A in TESOL)</p>
    </header>

    <main class="quiz-container">
        <div class="progress-bar">
            <div id="progressFill" class="progress-fill"></div>
        </div>
        
        <div id="quizCard" class="card">
            <div id="questionArea">
                <span class="badge-teacher">C√¥ Mai An g·ªçi t√™n c√¢u h·ªèi: <span id="qNumber">1</span></span>
                <h2 id="questionText" class="text-xl font-bold mb-6 text-gray-800">ƒêang t·∫£i c√¢u h·ªèi...</h2>
                
                <div id="optionsList" class="space-y-3">
                    <!-- Options will be injected here -->
                </div>

                <div id="explanationArea" class="explanation-box">
                    <h3 class="font-extrabold text-[#8854C0] mb-2">üí° C√¥ Mai An gi·∫£i th√≠ch:</h3>
                    <div id="explanationContent" class="text-sm space-y-3 leading-relaxed">
                        <!-- Content injected -->
                    </div>
                </div>

                <div class="mt-8 flex justify-between items-center">
                    <button id="nextBtn" class="hidden bg-[#00C9A7] hover:bg-[#00b395] text-white font-extrabold py-3 px-8 rounded-2xl shadow-[0_6px_0_#008f76] transition-all active:translate-y-1 active:shadow-none">
                        C√ÇU TI·∫æP THEO ‚ûú
                    </button>
                </div>
            </div>
        </div>
    </main>

    <!-- Modal K·∫øt th√∫c -->
    <div id="resultModal" class="modal-overlay">
        <div class="modal-content">
            <h2 class="text-4xl font-black mb-4 text-[#8854C0]">XU·∫§T S·∫ÆC! üéâ</h2>
            <div class="text-6xl mb-4">üèÜ</div>
            <p class="text-xl mb-2">B·∫°n ƒë√£ ho√†n th√†nh b√†i thi c·ªßa Ms Mai An</p>
            <p id="scoreText" class="text-3xl font-bold text-[#00C9A7] mb-6">ƒêi·ªÉm: 0/0</p>
            <p id="feedbackText" class="italic text-gray-600 mb-8">"L·ªùi khen ng·∫´u nhi√™n"</p>
            <button onclick="location.reload()" class="bg-[#8854C0] text-white font-bold py-3 px-10 rounded-2xl shadow-[0_6px_0_#6a3da1]">
                L√ÄM L·∫†I B√ÄI THI
            </button>
        </div>
    </div>

    <!-- √Çm thanh -->
    <audio id="audioCorrect" src="https://assets.mixkit.co/active_storage/sfx/2013/2013-preview.mp3"></audio>
    <audio id="audioIncorrect" src="https://assets.mixkit.co/active_storage/sfx/2019/2019-preview.mp3"></audio>

    <script>
        const quizData = [
            {
                q: "My brother likes football, _________he watches sports programmes every Sunday.",
                options: ["and", "but", "so", "or"],
                correct: 2,
                explanation: {
                    translation: "Anh trai t√¥i th√≠ch b√≥ng ƒë√°, v√¨ v·∫≠y anh ·∫•y xem c√°c ch∆∞∆°ng tr√¨nh th·ªÉ thao v√†o m·ªói Ch·ªß nh·∫≠t.",
                    analysis: [
                        "A. and (conj): v√† (b·ªï sung th√¥ng tin)",
                        "B. but (conj): nh∆∞ng (di·ªÖn t·∫£ s·ª± ƒë·ªëi l·∫≠p)",
                        "C. so (conj): v√¨ v·∫≠y, cho n√™n (di·ªÖn t·∫£ k·∫øt qu·∫£)",
                        "D. or (conj): ho·∫∑c (ƒë∆∞a ra s·ª± l·ª±a ch·ªçn)"
                    ],
                    why: "M·ªánh ƒë·ªÅ sau l√† k·∫øt qu·∫£ logic c·ªßa m·ªánh ƒë·ªÅ tr∆∞·ªõc (th√≠ch b√≥ng ƒë√° -> h·ªá qu·∫£ l√† xem th·ªÉ thao), n√™n ta d√πng 'so'.",
                    error: "Lo·∫°i A, B, D v√¨ kh√¥ng h·ª£p ng·ªØ nghƒ©a ch·ªâ k·∫øt qu·∫£ trong ng·ªØ c·∫£nh n√†y."
                }
            },
            {
                q: "I have a lot of homework, _________I don't watch TV on weekdays.",
                options: ["but", "so", "and", "or"],
                correct: 1,
                explanation: {
                    translation: "T√¥i c√≥ r·∫•t nhi·ªÅu b√†i t·∫≠p v·ªÅ nh√†, v√¨ v·∫≠y t√¥i kh√¥ng xem TV v√†o c√°c ng√†y trong tu·∫ßn.",
                    analysis: [
                        "A. but (conj): nh∆∞ng",
                        "B. so (conj): v√¨ v·∫≠y",
                        "C. and (conj): v√†",
                        "D. or (conj): ho·∫∑c"
                    ],
                    why: "Vi·ªác 'kh√¥ng xem TV' l√† h·ªá qu·∫£ tr·ª±c ti·∫øp c·ªßa vi·ªác 'c√≥ nhi·ªÅu b√†i t·∫≠p'. D√πng 'so' ƒë·ªÉ n·ªëi nguy√™n nh√¢n - k·∫øt qu·∫£.",
                    error: "C·∫•u tr√∫c kh√¥ng mang t√≠nh ƒë·ªëi l·∫≠p hay l·ª±a ch·ªçn n√™n lo·∫°i A, D."
                }
            },
            {
                q: "I usually watch the news, _________I watch wildlife programmes, too.",
                options: ["so", "and", "but", "because"],
                correct: 1,
                explanation: {
                    translation: "T√¥i th∆∞·ªùng xem tin t·ª©c, v√† t√¥i c≈©ng xem c√°c ch∆∞∆°ng tr√¨nh th·∫ø gi·ªõi ƒë·ªông v·∫≠t n·ªØa.",
                    analysis: [
                        "A. so (conj): v√¨ v·∫≠y",
                        "B. and (conj): v√†",
                        "C. but (conj): nh∆∞ng",
                        "D. because (conj): b·ªüi v√¨"
                    ],
                    why: "T·ª´ 'too' (c≈©ng v·∫≠y) ·ªü cu·ªëi c√¢u l√† d·∫•u hi·ªáu m·∫°nh m·∫Ω c·ªßa vi·ªác b·ªï sung th√¥ng tin t∆∞∆°ng ƒë·ªìng, ta d√πng 'and'.",
                    error: "Kh√¥ng c√≥ quan h·ªá nguy√™n nh√¢n (so/because) hay ƒë·ªëi l·∫≠p (but) ·ªü ƒë√¢y."
                }
            },
            {
                q: "My classmate is interested in films, _________he never watches films on TV.",
                options: ["so", "and", "or", "but"],
                correct: 3,
                explanation: {
                    translation: "B·∫°n c√πng l·ªõp c·ªßa t√¥i th√≠ch phim ·∫£nh, nh∆∞ng c·∫≠u ·∫•y kh√¥ng bao gi·ªù xem phim tr√™n TV.",
                    analysis: [
                        "A. so (conj): v√¨ v·∫≠y",
                        "B. and (conj): v√†",
                        "C. or (conj): ho·∫∑c",
                        "D. but (conj): nh∆∞ng"
                    ],
                    why: "Hai v·∫ø mang √Ω nghƒ©a tr√°i ng∆∞·ª£c nhau ho√†n to√†n: Th√≠ch phim >< Kh√¥ng bao gi·ªù xem tr√™n TV. D√πng 'but' ƒë·ªÉ ch·ªâ s·ª± t∆∞∆°ng ph·∫£n.",
                    error: "D√πng 'so' ·ªü ƒë√¢y s·∫Ω v√¥ l√Ω v·ªÅ m·∫∑t logic."
                }
            },
            {
                q: "My father usually comes home at six o'clock, _________then he watches TV for an hour.",
                options: ["and", "but", "so", "or"],
                correct: 0,
                explanation: {
                    translation: "B·ªë t√¥i th∆∞·ªùng v·ªÅ nh√† l√∫c 6 gi·ªù, v√† sau ƒë√≥ √¥ng ·∫•y xem TV kho·∫£ng m·ªôt ti·∫øng.",
                    analysis: [
                        "A. and (conj): v√†",
                        "B. but (conj): nh∆∞ng",
                        "C. so (conj): v√¨ v·∫≠y",
                        "D. or (conj): ho·∫∑c"
                    ],
                    why: "Di·ªÖn t·∫£ m·ªôt chu·ªói h√†nh ƒë·ªông li√™n ti·∫øp theo th·ªùi gian (v·ªÅ nh√† -> sau ƒë√≥ l√†m g√¨ ƒë√≥). D√πng 'and' l√† t·ª± nhi√™n nh·∫•t.",
                    error: "C√°c li√™n t·ª´ kh√°c khi·∫øn c√¢u tr·ªü n√™n r·ªùi r·∫°c ho·∫∑c sai logic h√†nh ƒë·ªông."
                }
            },
            {
                q: "The characters of the film are very nice, _________the music doesn't sound very modern.",
                options: ["and", "so", "but", "or"],
                correct: 2,
                explanation: {
                    translation: "C√°c nh√¢n v·∫≠t trong phim r·∫•t tuy·ªát, nh∆∞ng √¢m nh·∫°c nghe kh√¥ng hi·ªán ƒë·∫°i l·∫Øm.",
                    analysis: [
                        "A. and (conj): v√†",
                        "B. so (conj): v√¨ v·∫≠y",
                        "C. but (conj): nh∆∞ng",
                        "D. or (conj): ho·∫∑c"
                    ],
                    why: "C√¢u n√†y c√≥ s·ª± ƒë·ªëi l·∫≠p v·ªÅ ƒë√°nh gi√°: Nh√¢n v·∫≠t (khen - nice) >< √Çm nh·∫°c (ch√™ - not modern). Ta d√πng 'but'.",
                    error: "N·∫øu d√πng 'and' s·∫Ω kh√¥ng l√†m n·ªïi b·∫≠t ƒë∆∞·ª£c s·ª± kh√°c bi·ªát gi·ªØa hai nh·∫≠n x√©t n√†y."
                }
            },
            {
                q: "Mr. Wealthy is very rich, _________he never feels happy.",
                options: ["so", "but", "and", "or"],
                correct: 1,
                explanation: {
                    translation: "√îng Wealthy r·∫•t gi√†u, nh∆∞ng √¥ng ·∫•y kh√¥ng bao gi·ªù c·∫£m th·∫•y h·∫°nh ph√∫c.",
                    analysis: [
                        "A. so (conj): v√¨ v·∫≠y",
                        "B. but (conj): nh∆∞ng",
                        "C. and (conj): v√†",
                        "D. or (conj): ho·∫∑c"
                    ],
                    why: "Th√¥ng th∆∞·ªùng gi√†u s·∫Ω ƒëi ƒë√¥i v·ªõi h·∫°nh ph√∫c/tho·∫£i m√°i, nh∆∞ng ·ªü ƒë√¢y l·∫°i kh√¥ng. S·ª± t∆∞∆°ng ph·∫£n n√†y c·∫ßn 'but'.",
                    error: "Gi√†u kh√¥ng ph·∫£i nguy√™n nh√¢n c·ªßa vi·ªác kh√¥ng h·∫°nh ph√∫c n√™n kh√¥ng d√πng 'so'."
                }
            },
            {
                q: "Minh studies very hard, _________he always gets good grades.",
                options: ["but", "or", "so", "because"],
                correct: 2,
                explanation: {
                    translation: "Minh h·ªçc r·∫•t chƒÉm ch·ªâ, v√¨ v·∫≠y c·∫≠u ·∫•y lu√¥n ƒë·∫°t ƒëi·ªÉm cao.",
                    analysis: [
                        "A. but (conj): nh∆∞ng",
                        "B. or (conj): ho·∫∑c",
                        "C. so (conj): v√¨ v·∫≠y",
                        "D. because (conj): b·ªüi v√¨"
                    ],
                    why: "ƒêi·ªÉm cao l√† k·∫øt qu·∫£ t·∫•t y·∫øu c·ªßa vi·ªác h·ªçc t·∫≠p chƒÉm ch·ªâ. Ta d√πng 'so' ƒë·ªÉ n·ªëi v·∫ø k·∫øt qu·∫£.",
                    error: "L∆∞u √Ω: N·∫øu d√πng 'because' th√¨ ph·∫£i ƒë·ª©ng tr∆∞·ªõc v·∫ø nguy√™n nh√¢n (Minh gets good grades because he studies hard)."
                }
            },
            {
                q: "________________is the new weather‚Äôs man name?",
                options: ["What", "Who", "Where", "How"],
                correct: 0,
                explanation: {
                    translation: "T√™n c·ªßa ng∆∞·ªùi d·∫´n ch∆∞∆°ng tr√¨nh th·ªùi ti·∫øt m·ªõi l√† g√¨?",
                    analysis: [
                        "A. What: C√°i g√¨",
                        "B. Who: Ai",
                        "C. Where: ·ªû ƒë√¢u",
                        "D. How: Nh∆∞ th·∫ø n√†o"
                    ],
                    why: "M·∫∑c d√π h·ªèi v·ªÅ ng∆∞·ªùi, nh∆∞ng danh t·ª´ ch√≠nh ·ªü ƒë√¢y l√† 'name' (t√™n). Khi h·ªèi t√™n, c·∫•u tr√∫c lu√¥n l√† 'What is... name?'.",
                    error: "Kh√¥ng d√πng 'Who' ƒë·ªÉ h·ªèi cho danh t·ª´ 'name'."
                }
            },
            {
                q: "________________of these channels do you like most?",
                options: ["Which", "What", "Who", "Where"],
                correct: 0,
                explanation: {
                    translation: "B·∫°n th√≠ch k√™nh n√†o nh·∫•t trong s·ªë c√°c k√™nh n√†y?",
                    analysis: [
                        "A. Which: C√°i n√†o (trong m·ªôt nh√≥m c·ª• th·ªÉ)",
                        "B. What: C√°i g√¨ (chung chung)",
                        "C. Who: Ai",
                        "D. Where: ·ªû ƒë√¢u"
                    ],
                    why: "C·ª•m 'of these channels' x√°c ƒë·ªãnh m·ªôt nh√≥m ƒë·ªëi t∆∞·ª£ng c·ª• th·ªÉ. ƒê·ªÉ h·ªèi s·ª± l·ª±a ch·ªçn trong m·ªôt nh√≥m c√≥ gi·ªõi h·∫°n, ta d√πng 'Which'.",
                    error: "D√πng 'What' khi kh√¥ng c√≥ danh s√°ch l·ª±a ch·ªçn r√µ r√†ng tr∆∞·ªõc m·∫∑t."
                }
            },
            {
                q: "________________did you leave before the programme ended?",
                options: ["What", "Why", "Where", "Who"],
                correct: 1,
                explanation: {
                    translation: "T·∫°i sao b·∫°n l·∫°i v·ªÅ tr∆∞·ªõc khi ch∆∞∆°ng tr√¨nh k·∫øt th√∫c?",
                    analysis: [
                        "A. What: C√°i g√¨",
                        "B. Why: T·∫°i sao",
                        "C. Where: ·ªû ƒë√¢u",
                        "D. Who: Ai"
                    ],
                    why: "C√¢u h·ªèi y√™u c·∫ßu gi·∫£i th√≠ch nguy√™n nh√¢n cho h√†nh ƒë·ªông 'r·ªùi ƒëi s·ªõm', n√™n d√πng 'Why'.",
                    error: "C√°c t·ª´ kh√°c kh√¥ng ph√π h·ª£p ƒë·ªÉ h·ªèi l√Ω do."
                }
            },
            {
                q: "________________does the game show begin? ‚Äì At 6p.m. I think.",
                options: ["Where", "What time", "How", "Who"],
                correct: 1,
                explanation: {
                    translation: "Tr√≤ ch∆°i truy·ªÅn h√¨nh b·∫Øt ƒë·∫ßu l√∫c m·∫•y gi·ªù? ‚Äì T√¥i nghƒ© l√† 6 gi·ªù t·ªëi.",
                    analysis: [
                        "A. Where: ·ªû ƒë√¢u",
                        "B. What time: M·∫•y gi·ªù",
                        "C. How: Nh∆∞ th·∫ø n√†o",
                        "D. Who: Ai"
                    ],
                    why: "C√¢u tr·∫£ l·ªùi l√† 'At 6p.m' (v√†o l√∫c 6 gi·ªù t·ªëi) - ch·ªâ m·ªëc th·ªùi gian c·ª• th·ªÉ, n√™n d√πng 'What time'.",
                    error: "Where h·ªèi ƒë·ªãa ƒëi·ªÉm, How h·ªèi c√°ch th·ª©c ƒë·ªÅu sai."
                }
            },
            {
                q: "________________your father watch TV? ‚Äì Twice a day.",
                options: ["How often", "How long", "When", "What"],
                correct: 0,
                explanation: {
                    translation: "B·ªë c·ªßa b·∫°n xem TV th∆∞·ªùng xuy√™n nh∆∞ th·∫ø n√†o? ‚Äì Hai l·∫ßn m·ªôt ng√†y.",
                    analysis: [
                        "A. How often: Bao l√¢u m·ªôt l·∫ßn (t·∫ßn su·∫•t)",
                        "B. How long: Bao l√¢u (kho·∫£ng th·ªùi gian)",
                        "C. When: Khi n√†o (m·ªëc th·ªùi gian)",
                        "D. What: C√°i g√¨"
                    ],
                    why: "C√¢u tr·∫£ l·ªùi 'Twice a day' (2 l·∫ßn/ng√†y) ch·ªâ t·∫ßn su·∫•t th·ª±c hi·ªán h√†nh ƒë·ªông, ta d√πng 'How often'.",
                    error: "'How long' h·ªèi ƒë·ªô d√†i (v√≠ d·ª•: 2 ti·∫øng), kh√¥ng h·ªèi s·ªë l·∫ßn."
                }
            },
            {
                q: "________________is your favorite MC?",
                options: ["What", "Which", "Who", "Where"],
                correct: 2,
                explanation: {
                    translation: "Ai l√† ng∆∞·ªùi d·∫´n ch∆∞∆°ng tr√¨nh y√™u th√≠ch c·ªßa b·∫°n?",
                    analysis: [
                        "A. What: C√°i g√¨",
                        "B. Which: C√°i n√†o",
                        "C. Who: Ai",
                        "D. Where: ·ªû ƒë√¢u"
                    ],
                    why: "MC (Master of Ceremonies) l√† danh t·ª´ ch·ªâ ng∆∞·ªùi, ta d√πng 'Who' ƒë·ªÉ h·ªèi.",
                    error: "Kh√¥ng d√πng What cho ng∆∞·ªùi trong ng·ªØ c·∫£nh h·ªèi ƒë·ªãnh danh n√†y."
                }
            },
            {
                q: "________________does the animal programme last? ‚Äì About 90 minutes.",
                options: ["How often", "How many", "How long", "When"],
                correct: 2,
                explanation: {
                    translation: "Ch∆∞∆°ng tr√¨nh th·∫ø gi·ªõi ƒë·ªông v·∫≠t k√©o d√†i bao l√¢u? ‚Äì Kho·∫£ng 90 ph√∫t.",
                    analysis: [
                        "A. How often: T·∫ßn su·∫•t",
                        "B. How many: S·ªë l∆∞·ª£ng",
                        "C. How long: Bao l√¢u (th·ªùi l∆∞·ª£ng)",
                        "D. When: Khi n√†o"
                    ],
                    why: "ƒê·ªông t·ª´ 'last' (k√©o d√†i) k·∫øt h·ª£p v·ªõi c√¢u tr·∫£ l·ªùi '90 minutes' cho th·∫•y ƒë√¢y l√† c√¢u h·ªèi v·ªÅ th·ªùi l∆∞·ª£ng, ta d√πng 'How long'.",
                    error: "'When' ch·ªâ h·ªèi l√∫c b·∫Øt ƒë·∫ßu ho·∫∑c k·∫øt th√∫c, kh√¥ng h·ªèi c·∫£ qu√° tr√¨nh d√†i bao nhi√™u."
                }
            },
            {
                q: "________________should we place the new TV? ‚Äì In the kitchen.",
                options: ["When", "Where", "Why", "How"],
                correct: 1,
                explanation: {
                    translation: "Ch√∫ng ta n√™n ƒë·∫∑t chi·∫øc TV m·ªõi ·ªü ƒë√¢u? ‚Äì Trong nh√† b·∫øp.",
                    analysis: [
                        "A. When: Khi n√†o",
                        "B. Where: ·ªû ƒë√¢u",
                        "C. Why: T·∫°i sao",
                        "D. How: Nh∆∞ th·∫ø n√†o"
                    ],
                    why: "C√¢u tr·∫£ l·ªùi 'In the kitchen' (trong b·∫øp) l√† m·ªôt c·ª•m t·ª´ ch·ªâ v·ªã tr√≠, ta d√πng 'Where'.",
                    error: "C√°c t·ª´ kh√°c kh√¥ng d√πng ƒë·ªÉ h·ªèi n∆°i ch·ªën."
                }
            },
            {
                q: "________________programmes does the local television have?",
                options: ["How many", "How much", "How long", "How often"],
                correct: 0,
                explanation: {
                    translation: "ƒê√†i truy·ªÅn h√¨nh ƒë·ªãa ph∆∞∆°ng c√≥ bao nhi√™u ch∆∞∆°ng tr√¨nh?",
                    analysis: [
                        "A. How many: Bao nhi√™u (cho danh t·ª´ ƒë·∫øm ƒë∆∞·ª£c s·ªë nhi·ªÅu)",
                        "B. How much: Bao nhi√™u (cho danh t·ª´ kh√¥ng ƒë·∫øm ƒë∆∞·ª£c)",
                        "C. How long: Bao l√¢u",
                        "D. How often: T·∫ßn su·∫•t"
                    ],
                    why: "'Programmes' l√† danh t·ª´ ƒë·∫øm ƒë∆∞·ª£c s·ªë nhi·ªÅu (c√≥ ƒëu√¥i -s), n√™n d√πng 'How many' ƒë·ªÉ h·ªèi s·ªë l∆∞·ª£ng.",
                    error: "'How much' d√πng cho ti·ªÅn b·∫°c ho·∫∑c c√°c danh t·ª´ nh∆∞ water, sugar..."
                }
            },
            {
                q: "________________does cable TV cost per month?",
                options: ["How many", "How much", "What", "Which"],
                correct: 1,
                explanation: {
                    translation: "Truy·ªÅn h√¨nh c√°p t·ªën bao nhi√™u ti·ªÅn m·ªói th√°ng?",
                    analysis: [
                        "A. How many: Bao nhi√™u (ƒë·∫øm ƒë∆∞·ª£c)",
                        "B. How much: Bao nhi√™u (gi√° c·∫£/kh√¥ng ƒë·∫øm ƒë∆∞·ª£c)",
                        "C. What: C√°i g√¨",
                        "D. Which: C√°i n√†o"
                    ],
                    why: "ƒê·ªông t·ª´ 'cost' (c√≥ gi√° l√†) d√πng ƒë·ªÉ h·ªèi v·ªÅ s·ªë ti·ªÅn, c·∫•u tr√∫c chu·∫©n l√† 'How much does it cost?'.",
                    error: "Ti·ªÅn l√† danh t·ª´ kh√¥ng ƒë·∫øm ƒë∆∞·ª£c n√™n ph·∫£i d√πng much."
                }
            },
            {
                q: "________________do you prefer ‚Äì The Lion King or Tom and Jerry?",
                options: ["What", "Which", "Who", "Where"],
                correct: 1,
                explanation: {
                    translation: "B·∫°n th√≠ch phim n√†o h∆°n ‚Äì Vua S∆∞ T·ª≠ hay Tom v√† Jerry?",
                    analysis: [
                        "A. What: C√°i g√¨",
                        "B. Which: C√°i n√†o (trong s·ªë c√°c l·ª±a ch·ªçn c√≥ s·∫µn)",
                        "C. Who: Ai",
                        "D. Where: ·ªû ƒë√¢u"
                    ],
                    why: "Khi c√¢u h·ªèi ƒë∆∞a ra c√°c l·ª±a ch·ªçn c·ª• th·ªÉ ph√≠a sau (A or B), ta d√πng 'Which' ƒë·ªÉ h·ªèi s·ª± ∆∞u ti√™n.",
                    error: "'What' mang t√≠nh ch·∫•t qu√° r·ªông, kh√¥ng nh·∫•n m·∫°nh v√†o s·ª± l·ª±a ch·ªçn ƒë·ªëi t∆∞·ª£ng c√≥ s·∫µn."
                }
            },
            {
                q: "________________does this programme finish?",
                options: ["Who", "What time", "Where", "How many"],
                correct: 1,
                explanation: {
                    translation: "Ch∆∞∆°ng tr√¨nh n√†y k·∫øt th√∫c l√∫c m·∫•y gi·ªù?",
                    analysis: [
                        "A. Who: Ai",
                        "B. What time: M·∫•y gi·ªù",
                        "C. Where: ·ªû ƒë√¢u",
                        "D. How many: Bao nhi√™u"
                    ],
                    why: "H·ªèi v·ªÅ th·ªùi ƒëi·ªÉm k·∫øt th√∫c c·ªßa m·ªôt l·ªãch tr√¨nh, ta d√πng 'What time' (ho·∫∑c When).",
                    error: "C√°c ph∆∞∆°ng √°n kh√°c ho√†n to√†n sai v·ªÅ m·∫∑t ng·ªØ nghƒ©a."
                }
            },
            {
                q: "________________is the best actor in your country?",
                options: ["What", "Where", "Who", "When"],
                correct: 2,
                explanation: {
                    translation: "Ai l√† di·ªÖn vi√™n xu·∫•t s·∫Øc nh·∫•t ·ªü ƒë·∫•t n∆∞·ªõc b·∫°n?",
                    analysis: [
                        "A. What: C√°i g√¨",
                        "B. Where: ·ªû ƒë√¢u",
                        "C. Who: Ai",
                        "D. When: Khi n√†o"
                    ],
                    why: "'Actor' (di·ªÖn vi√™n) l√† ng∆∞·ªùi, t·ª´ ƒë·ªÉ h·ªèi t∆∞∆°ng ·ª©ng duy nh·∫•t l√† 'Who'.",
                    error: "Kh√¥ng d√πng What ƒë·ªÉ h·ªèi v·ªÅ danh t√≠nh m·ªôt con ng∆∞·ªùi c·ª• th·ªÉ."
                }
            },
            {
                q: "________________was the weather like last Sunday?",
                options: ["How", "What", "Which", "Where"],
                correct: 1,
                explanation: {
                    translation: "Th·ªùi ti·∫øt Ch·ªß nh·∫≠t tu·∫ßn tr∆∞·ªõc nh∆∞ th·∫ø n√†o?",
                    analysis: [
                        "A. How: Nh∆∞ th·∫ø n√†o (kh√¥ng ƒëi v·ªõi like)",
                        "B. What: C√°i g√¨/Nh∆∞ th·∫ø n√†o (khi ƒëi v·ªõi like)",
                        "C. Which: C√°i n√†o",
                        "D. Where: ·ªû ƒë√¢u"
                    ],
                    why: "C·∫•u tr√∫c h·ªèi t√≠nh ch·∫•t: 'What + be + S + like?'. N·∫øu d√πng 'How' th√¨ kh√¥ng ƒë∆∞·ª£c c√≥ 'like' ·ªü cu·ªëi.",
                    error: "L·ªói ph·ªï bi·∫øn l√† d√πng 'How was it like?' -> Sai."
                }
            },
            {
                q: "________________don‚Äôt you like this comedy?",
                options: ["Why", "What", "Where", "Who"],
                correct: 0,
                explanation: {
                    translation: "T·∫°i sao b·∫°n kh√¥ng th√≠ch phim h√†i n√†y?",
                    analysis: [
                        "A. Why: T·∫°i sao",
                        "B. What: C√°i g√¨",
                        "C. Where: ·ªû ƒë√¢u",
                        "D. Who: Ai"
                    ],
                    why: "C·∫ßn m·ªôt l√Ω do ƒë·ªÉ gi·∫£i th√≠ch cho c·∫£m x√∫c 'kh√¥ng th√≠ch', d√πng 'Why'.",
                    error: "ƒê√¢y l√† c√¢u h·ªèi m·ªü ƒë·∫ßu cho m·ªôt l·ªùi gi·∫£i th√≠ch l√Ω do."
                }
            }
        ];

        let currentQ = 0;
        let score = 0;
        let answered = false;

        const qNumberSpan = document.getElementById('qNumber');
        const questionText = document.getElementById('questionText');
        const optionsList = document.getElementById('optionsList');
        const nextBtn = document.getElementById('nextBtn');
        const explanationArea = document.getElementById('explanationArea');
        const explanationContent = document.getElementById('explanationContent');
        const progressFill = document.getElementById('progressFill');
        const resultModal = document.getElementById('resultModal');
        const scoreText = document.getElementById('scoreText');
        const feedbackText = document.getElementById('feedbackText');
        const audioCorrect = document.getElementById('audioCorrect');
        const audioIncorrect = document.getElementById('audioIncorrect');

        const feedbacks = [
            "Tuy·ªát v·ªùi! B·∫°n l√† m·ªôt ng√¥i sao s√°ng! ‚≠ê",
            "L√†m t·ªët l·∫Øm! Ki·∫øn th·ª©c c·ªßa b·∫°n r·∫•t ch·∫Øc ch·∫Øn. üöÄ",
            "Ms Mai An r·∫•t t·ª± h√†o v·ªÅ n·ªó l·ª±c c·ªßa b·∫°n! üíñ",
            "Ti·∫øp t·ª•c ph√°t huy nh√©, b·∫°n ƒëang ƒëi ƒë√∫ng h∆∞·ªõng r·ªìi! üåà"
        ];

        function initQuiz() {
            renderQuestion();
        }

        function renderQuestion() {
            answered = false;
            const data = quizData[currentQ];
            qNumberSpan.innerText = currentQ + 1;
            questionText.innerText = data.q;
            optionsList.innerHTML = '';
            explanationArea.style.display = 'none';
            nextBtn.classList.add('hidden');
            
            // C·∫≠p nh·∫≠t Progress
            const progress = ((currentQ) / quizData.length) * 100;
            progressFill.style.width = `${progress}%`;

            data.options.forEach((opt, index) => {
                const btn = document.createElement('button');
                btn.className = 'option-btn';
                btn.innerHTML = `<span class="letter-tag">${String.fromCharCode(65 + index)}</span> <span>${opt}</span>`;
                btn.onclick = () => checkAnswer(index, btn);
                optionsList.appendChild(btn);
            });
        }

        function checkAnswer(selectedIndex, btnElement) {
            if (answered) return;
            answered = true;
            
            const data = quizData[currentQ];
            const allButtons = optionsList.querySelectorAll('.option-btn');
            
            // Kh√≥a c√°c n√∫t
            allButtons.forEach(btn => btn.disabled = true);

            if (selectedIndex === data.correct) {
                // ƒê√öNG
                score++;
                btnElement.classList.add('correct');
                audioCorrect.play();
                triggerConfetti();
            } else {
                // SAI
                btnElement.classList.add('incorrect');
                document.getElementById('quizCard').classList.add('shake');
                setTimeout(() => document.getElementById('quizCard').classList.remove('shake'), 500);
                
                // Hi·ªán ƒë√°p √°n ƒë√∫ng
                allButtons[data.correct].classList.add('correct');
                audioIncorrect.play();
            }

            showExplanation(data.explanation);
            nextBtn.classList.remove('hidden');
            
            if (currentQ === quizData.length - 1) {
                nextBtn.innerText = "XEM K·∫æT QU·∫¢ T·ªîNG K·∫æT üèÅ";
            }
        }

        function showExplanation(exp) {
            explanationArea.style.display = 'block';
            explanationContent.innerHTML = `
                <p><strong>1. Ph√¢n t√≠ch 4 ƒë√°p √°n:</strong></p>
                <ul class="list-disc ml-5 mb-2">
                    ${exp.analysis.map(item => `<li>${item}</li>`).join('')}
                </ul>
                <p><strong>2. D·ªãch to√†n c√¢u:</strong> <em>"${exp.translation}"</em></p>
                <p><strong>3. T·∫°i sao ch·ªçn?</strong> ${exp.why}</p>
                <p class="text-red-500"><strong>‚ö†Ô∏è L∆∞u √Ω:</strong> ${exp.error}</p>
            `;
            // Scroll xu·ªëng ch·ªó gi·∫£i th√≠ch n·∫øu tr√™n mobile
            explanationArea.scrollIntoView({ behavior: 'smooth', block: 'nearest' });
        }

        function triggerConfetti() {
            confetti({
                particleCount: 100,
                spread: 70,
                origin: { y: 0.6 },
                colors: ['#8854C0', '#00C9A7', '#FFD700']
            });
        }

        nextBtn.onclick = () => {
            if (currentQ < quizData.length - 1) {
                currentQ++;
                renderQuestion();
            } else {
                showFinalResult();
            }
        };

        function showFinalResult() {
            progressFill.style.width = `100%`;
            scoreText.innerText = `ƒêi·ªÉm c·ªßa b·∫°n: ${score} / ${quizData.length}`;
            const randomFeedback = feedbacks[Math.floor(Math.random() * feedbacks.length)];
            feedbackText.innerText = `"${randomFeedback}"`;
            resultModal.style.display = 'flex';
            triggerConfetti();
        }

        window.onload = initQuiz;
    </script>
</body>
</html>
