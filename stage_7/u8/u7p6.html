<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Connectors Quiz - Ms Mai An ULIS</title>
    <!-- Google Fonts -->
    <link href="https://fonts.googleapis.com/css2?family=Nunito:wght@400;600;700;800&family=Quicksand:wght@500;700&display=swap" rel="stylesheet">
    <style>
        :root {
            --primary-purple: #8854C0;
            --primary-teal: #00C9A7;
            --correct-green: #00D26A;
            --correct-dark: #00a855;
            --wrong-red: #FF4757;
            --wrong-dark: #cc3946;
            --bg-color: #F0F4F8;
            --card-bg: #FFFFFF;
            --text-color: #2D3436;
        }

        * {
            box-sizing: border-box;
            margin: 0;
            padding: 0;
        }

        body {
            font-family: 'Nunito', sans-serif;
            background-color: var(--bg-color);
            background-image: 
                radial-gradient(var(--primary-purple) 2px, transparent 2px), 
                radial-gradient(var(--primary-teal) 2px, transparent 2px);
            background-size: 30px 30px;
            background-position: 0 0, 15px 15px;
            color: var(--text-color);
            min-height: 100vh;
            padding-bottom: 50px;
        }

        .header-container {
            text-align: center;
            padding: 30px 20px;
            background: linear-gradient(135deg, var(--primary-purple), #a270d6);
            color: white;
            border-bottom-left-radius: 30px;
            border-bottom-right-radius: 30px;
            box-shadow: 0 8px 0 rgba(0,0,0,0.1);
            margin-bottom: 30px;
            position: relative;
            overflow: hidden;
        }

        .header-container h1 {
            font-family: 'Quicksand', sans-serif;
            font-weight: 800;
            font-size: 2rem;
            text-shadow: 2px 2px 0px rgba(0,0,0,0.1);
            margin-bottom: 10px;
        }

        .header-container p {
            font-size: 1.1rem;
            opacity: 0.9;
        }

        .quiz-container {
            max-width: 800px;
            margin: 0 auto;
            padding: 0 15px;
        }

        /* Card Styles */
        .question-card {
            background: var(--card-bg);
            border-radius: 20px;
            padding: 25px;
            margin-bottom: 30px;
            box-shadow: 0 8px 0 rgba(0,0,0,0.05), 0 10px 20px rgba(0,0,0,0.1);
            border: 2px solid #fff;
            position: relative;
            transition: transform 0.3s ease;
        }

        .question-number {
            display: inline-block;
            background: var(--primary-purple);
            color: white;
            padding: 5px 15px;
            border-radius: 15px;
            font-weight: 800;
            font-size: 0.9rem;
            margin-bottom: 15px;
            box-shadow: 0 4px 0 rgba(0,0,0,0.1);
        }

        .question-text {
            font-size: 1.25rem;
            font-weight: 700;
            color: #2c3e50;
            margin-bottom: 25px;
            line-height: 1.5;
        }

        .options-grid {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 15px;
        }

        @media (max-width: 600px) {
            .options-grid {
                grid-template-columns: 1fr;
            }
        }

        /* Button Styles */
        .option-btn {
            background: #fff;
            border: 2px solid #e0e0e0;
            border-bottom: 5px solid #e0e0e0;
            border-radius: 15px;
            padding: 15px 20px;
            font-family: 'Nunito', sans-serif;
            font-size: 1rem;
            font-weight: 700;
            color: #555;
            cursor: pointer;
            transition: all 0.1s ease;
            text-align: left;
            position: relative;
            outline: none;
        }

        .option-btn:hover:not(:disabled) {
            transform: translateY(-2px);
            border-color: var(--primary-teal);
            border-bottom-color: var(--primary-teal);
            color: var(--primary-teal);
        }

        .option-btn:active:not(:disabled) {
            transform: translateY(2px);
            border-bottom-width: 2px;
            margin-top: 3px;
        }

        /* Correct State */
        .option-btn.correct {
            background-color: var(--correct-green);
            border-color: var(--correct-green);
            border-bottom-color: var(--correct-dark);
            color: white;
            animation: pop 0.4s cubic-bezier(0.175, 0.885, 0.32, 1.275);
        }

        /* Incorrect State */
        .option-btn.incorrect {
            background-color: var(--wrong-red);
            border-color: var(--wrong-red);
            border-bottom-color: var(--wrong-dark);
            color: white;
            animation: shake 0.5s cubic-bezier(0.36, 0.07, 0.19, 0.97) both;
        }

        .option-btn:disabled {
            cursor: default;
            opacity: 0.7;
        }

        /* Explanation Box */
        .explanation-box {
            display: none; /* Hidden by default */
            margin-top: 25px;
            background-color: #f9fbfd;
            border: 2px dashed var(--primary-teal);
            border-radius: 15px;
            padding: 20px;
            animation: slideDown 0.5s ease;
        }

        .explanation-header {
            font-weight: 800;
            color: var(--primary-purple);
            margin-bottom: 10px;
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .explanation-content {
            font-size: 0.95rem;
            line-height: 1.6;
            color: #4a4a4a;
            white-space: pre-line; /* Respect line breaks */
        }
        
        .explanation-content strong {
            color: #2d3436;
        }

        /* Submit Section */
        .submit-section {
            text-align: center;
            margin-top: 40px;
        }

        .submit-btn {
            background-color: var(--primary-purple);
            color: white;
            font-family: 'Quicksand', sans-serif;
            font-weight: 700;
            font-size: 1.2rem;
            padding: 15px 40px;
            border: none;
            border-bottom: 6px solid #6c429c;
            border-radius: 50px;
            cursor: pointer;
            transition: all 0.2s;
            box-shadow: 0 10px 20px rgba(136, 84, 192, 0.3);
        }

        .submit-btn:hover {
            transform: scale(1.05);
            background-color: #9b6ad3;
        }

        .submit-btn:active {
            transform: translateY(4px);
            border-bottom-width: 2px;
        }

        /* Animations */
        @keyframes pop {
            0% { transform: scale(1); }
            50% { transform: scale(1.05); }
            100% { transform: scale(1); }
        }

        @keyframes shake {
            10%, 90% { transform: translate3d(-1px, 0, 0); }
            20%, 80% { transform: translate3d(2px, 0, 0); }
            30%, 50%, 70% { transform: translate3d(-4px, 0, 0); }
            40%, 60% { transform: translate3d(4px, 0, 0); }
        }

        @keyframes slideDown {
            from { opacity: 0; transform: translateY(-10px); }
            to { opacity: 1; transform: translateY(0); }
        }

        /* Modal Score */
        .modal-overlay {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0,0,0,0.6);
            display: none;
            justify-content: center;
            align-items: center;
            z-index: 1000;
            backdrop-filter: blur(5px);
        }

        .score-modal {
            background: white;
            padding: 40px;
            border-radius: 30px;
            text-align: center;
            max-width: 90%;
            width: 400px;
            box-shadow: 0 20px 50px rgba(0,0,0,0.2);
            animation: pop 0.5s ease;
            position: relative;
        }

        .score-circle {
            width: 120px;
            height: 120px;
            border-radius: 50%;
            background: var(--primary-teal);
            color: white;
            display: flex;
            justify-content: center;
            align-items: center;
            font-size: 2.5rem;
            font-weight: 800;
            margin: 0 auto 20px;
            border: 5px solid #00a885;
        }

        .score-message {
            font-size: 1.5rem;
            font-weight: 700;
            color: var(--primary-purple);
            margin-bottom: 20px;
        }

        .close-btn {
            background: #eee;
            border: none;
            padding: 10px 20px;
            border-radius: 20px;
            font-weight: 700;
            cursor: pointer;
            font-size: 1rem;
        }

        /* Confetti Canvas */
        #confetti-canvas {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            pointer-events: none;
            z-index: 999;
        }

        /* Highlight keywords in explanation */
        .highlight-word {
            color: var(--primary-purple);
            font-weight: 700;
            background: #f3e5f5;
            padding: 0 4px;
            border-radius: 4px;
        }
    </style>
</head>
<body>

    <div class="header-container">
        <h1>B√ÄI T·∫¨P LI√äN T·ª™ & TR·∫†NG T·ª™ LI√äN K·∫æT</h1>
        <p>Gi√°o vi√™n: Ms Mai An ULIS | Ex 2</p>
    </div>

    <div class="quiz-container" id="quiz-output">
        <!-- Questions will be injected here by JS -->
    </div>

    <div class="submit-section">
        <button class="submit-btn" onclick="finishQuiz()">N·ªòP B√ÄI & XEM ƒêI·ªÇM</button>
    </div>

    <!-- Score Modal -->
    <div class="modal-overlay" id="scoreModal">
        <div class="score-modal">
            <div class="score-circle" id="finalScore">0/20</div>
            <div class="score-message" id="scoreMessage">L√†m t·ªët l·∫Øm!</div>
            <button class="close-btn" onclick="closeModal()">Xem l·∫°i b√†i l√†m</button>
        </div>
    </div>

    <canvas id="confetti-canvas"></canvas>

    <script>
        // --- DATA SOURCE ---
        const quizData = [
    {
      "questionNumber": 1,
      "question": "__________ it was raining heavily, we decided to cancel the picnic.",
      "imageUrl": null,
      "answerOptions": [
        {
          "text": "As",
          "rationale": "1. D·ªãch c√¢u: V√¨ tr·ªùi m∆∞a to, ch√∫ng t√¥i quy·∫øt ƒë·ªãnh h·ªßy bu·ªïi d√£ ngo·∫°i.\n2. Ph√¢n t√≠ch ƒë√°p √°n:\n- As (conj - li√™n t·ª´): b·ªüi v√¨/khi\n- Although (conj - li√™n t·ª´): m·∫∑c d√π\n- So that (conj - li√™n t·ª´): ƒë·ªÉ m√†\n- However (adv - tr·∫°ng t·ª´): tuy nhi√™n\n3. Gi·∫£i th√≠ch: M·ªánh ƒë·ªÅ ƒë·∫ßu ch·ªâ nguy√™n nh√¢n (tr·ªùi m∆∞a) d·∫´n ƒë·∫øn k·∫øt qu·∫£ (h·ªßy picnic). 'As' ƒë·ª©ng ƒë·∫ßu c√¢u d√πng ƒë·ªÉ ch·ªâ nguy√™n nh√¢n.",
          "isCorrect": true
        },
        {
          "text": "Although",
          "rationale": "Although d√πng cho c√¢u m·ªánh ƒë·ªÅ nh∆∞·ª£ng b·ªô (m·∫∑c d√π), kh√¥ng ph√π h·ª£p v·ªÅ nghƒ©a nguy√™n nh√¢n - k·∫øt qu·∫£.",
          "isCorrect": false
        },
        {
          "text": "So that",
          "rationale": "So that d√πng ƒë·ªÉ ch·ªâ m·ª•c ƒë√≠ch, kh√¥ng ph√π h·ª£p ng·ªØ c·∫£nh.",
          "isCorrect": false
        },
        {
          "text": "However",
          "rationale": "However l√† tr·∫°ng t·ª´ li√™n k·∫øt, th∆∞·ªùng ƒë·ª©ng sau d·∫•u ch·∫•m ho·∫∑c ch·∫•m ph·∫©y, kh√¥ng ƒë·ª©ng ƒë·∫ßu m·ªánh ƒë·ªÅ nguy√™n nh√¢n nh∆∞ n√†y.",
          "isCorrect": false
        }
      ],
      "hint": "C·∫ßn m·ªôt t·ª´ ch·ªâ nguy√™n nh√¢n (b·ªüi v√¨) ƒë·ª©ng ƒë·∫ßu c√¢u."
    },
    {
      "questionNumber": 2,
      "question": "He studied very hard for the exam. __________, he got a low score.",
      "imageUrl": null,
      "answerOptions": [
        {
          "text": "Therefore",
          "rationale": "Therefore ch·ªâ k·∫øt qu·∫£ (do ƒë√≥), nh∆∞ng ·ªü ƒë√¢y k·∫øt qu·∫£ tr√°i ng∆∞·ª£c v·ªõi h√†nh ƒë·ªông.",
          "isCorrect": false
        },
        {
          "text": "However",
          "rationale": "1. D·ªãch c√¢u: Anh ·∫•y ƒë√£ h·ªçc r·∫•t chƒÉm ch·ªâ cho k·ª≥ thi. Tuy nhi√™n, anh ·∫•y l·∫°i b·ªã ƒëi·ªÉm th·∫•p.\n2. Ph√¢n t√≠ch ƒë√°p √°n:\n- Therefore (adv): do ƒë√≥\n- However (adv): tuy nhi√™n\n- Because (conj): b·ªüi v√¨\n- So that (conj): ƒë·ªÉ m√†\n3. Gi·∫£i th√≠ch: Hai c√¢u c√≥ √Ω nghƒ©a t∆∞∆°ng ph·∫£n (h·ªçc chƒÉm - ƒëi·ªÉm th·∫•p). Ch·ªó tr·ªëng ƒë·ª©ng sau d·∫•u ch·∫•m v√† tr∆∞·ªõc d·∫•u ph·∫©y, c·∫ßn m·ªôt tr·∫°ng t·ª´ li√™n k·∫øt ch·ªâ s·ª± t∆∞∆°ng ph·∫£n.",
          "isCorrect": true
        },
        {
          "text": "Because",
          "rationale": "Because l√† li√™n t·ª´, kh√¥ng ƒë·ª©ng ƒë·∫ßu c√¢u th·ª© hai ngƒÉn c√°ch b·ªüi d·∫•u ch·∫•m v√† ph·∫©y nh∆∞ v·∫≠y ƒë·ªÉ n·ªëi √Ω t∆∞∆°ng ph·∫£n.",
          "isCorrect": false
        },
        {
          "text": "So that",
          "rationale": "So that ch·ªâ m·ª•c ƒë√≠ch, kh√¥ng ph√π h·ª£p ng·ªØ ph√°p v√† ng·ªØ nghƒ©a.",
          "isCorrect": false
        }
      ],
      "hint": "T·ª´ n√†y d√πng ƒë·ªÉ n·ªëi hai c√¢u c√≥ √Ω nghƒ©a tr√°i ng∆∞·ª£c nhau, th∆∞·ªùng ƒëi sau d·∫•u ch·∫•m v√† tr∆∞·ªõc d·∫•u ph·∫©y."
    },
    {
      "questionNumber": 3,
      "question": "I wore a thick coat __________ I wouldn't get cold.",
      "imageUrl": null,
      "answerOptions": [
        {
          "text": "because",
          "rationale": "Because ch·ªâ nguy√™n nh√¢n. M·∫∑c d√π nghe c√≥ v·∫ª h·ª£p l√Ω nh∆∞ng 'wouldn't get cold' l√† m·ª•c ƒë√≠ch c·ªßa vi·ªác m·∫∑c √°o.",
          "isCorrect": false
        },
        {
          "text": "so that",
          "rationale": "1. D·ªãch c√¢u: T√¥i m·∫∑c m·ªôt chi·∫øc √°o kho√°c d√†y ƒë·ªÉ t√¥i kh√¥ng b·ªã l·∫°nh.\n2. Ph√¢n t√≠ch ƒë√°p √°n:\n- because (conj): b·ªüi v√¨\n- so that (conj): ƒë·ªÉ m√† (ch·ªâ m·ª•c ƒë√≠ch)\n- although (conj): m·∫∑c d√π\n- however (adv): tuy nhi√™n\n3. Gi·∫£i th√≠ch: M·ªánh ƒë·ªÅ sau ch·ªâ m·ª•c ƒë√≠ch c·ªßa h√†nh ƒë·ªông tr∆∞·ªõc ƒë√≥ (m·∫∑c √°o -> ƒë·ªÉ kh√¥ng l·∫°nh).",
          "isCorrect": true
        },
        {
          "text": "although",
          "rationale": "Although ch·ªâ s·ª± nh∆∞·ª£ng b·ªô, kh√¥ng h·ª£p nghƒ©a.",
          "isCorrect": false
        },
        {
          "text": "however",
          "rationale": "However kh√¥ng d√πng ƒë·ªÉ n·ªëi m·ªánh ƒë·ªÅ m·ª•c ƒë√≠ch.",
          "isCorrect": false
        }
      ],
      "hint": "C·ª•m t·ª´ n√†y d√πng ƒë·ªÉ ch·ªâ m·ª•c ƒë√≠ch (ƒë·ªÉ m√†)."
    },
    {
      "questionNumber": 4,
      "question": "__________ the weather was bad, we enjoyed our trip.",
      "imageUrl": null,
      "answerOptions": [
        {
          "text": "Because",
          "rationale": "Because ch·ªâ nguy√™n nh√¢n, n·∫øu d√πng s·∫Ω v√¥ l√Ω (V√¨ th·ªùi ti·∫øt x·∫•u n√™n ch√∫ng t√¥i th√≠ch chuy·∫øn ƒëi).",
          "isCorrect": false
        },
        {
          "text": "Therefore",
          "rationale": "Therefore kh√¥ng ƒë·ª©ng ƒë·∫ßu m·ªánh ƒë·ªÅ ph·ª• thu·ªôc.",
          "isCorrect": false
        },
        {
          "text": "Although",
          "rationale": "1. D·ªãch c√¢u: M·∫∑c d√π th·ªùi ti·∫øt x·∫•u, ch√∫ng t√¥i v·∫´n t·∫≠n h∆∞·ªüng chuy·∫øn ƒëi.\n2. Ph√¢n t√≠ch ƒë√°p √°n:\n- Because (conj): b·ªüi v√¨\n- Therefore (adv): do ƒë√≥\n- Although (conj): m·∫∑c d√π\n- So that (conj): ƒë·ªÉ m√†\n3. Gi·∫£i th√≠ch: Hai m·ªánh ƒë·ªÅ c√≥ √Ω nghƒ©a t∆∞∆°ng ph·∫£n (th·ªùi ti·∫øt x·∫•u >< v·∫´n vui). C·∫ßn li√™n t·ª´ nh∆∞·ª£ng b·ªô.",
          "isCorrect": true
        },
        {
          "text": "So that",
          "rationale": "So that ch·ªâ m·ª•c ƒë√≠ch, kh√¥ng h·ª£p nghƒ©a.",
          "isCorrect": false
        }
      ],
      "hint": "D√πng ƒë·ªÉ n·ªëi hai v·∫ø c√¢u c√≥ √Ω nghƒ©a tr√°i ng∆∞·ª£c (M·∫∑c d√π...)."
    },
    {
      "questionNumber": 5,
      "question": "It was very hot in the room; __________, I opened the window.",
      "imageUrl": null,
      "answerOptions": [
        {
          "text": "however",
          "rationale": "However ch·ªâ s·ª± t∆∞∆°ng ph·∫£n, ·ªü ƒë√¢y l√† quan h·ªá nguy√™n nh√¢n - k·∫øt qu·∫£ thu·∫≠n.",
          "isCorrect": false
        },
        {
          "text": "therefore",
          "rationale": "1. D·ªãch c√¢u: Trong ph√≤ng r·∫•t n√≥ng; do ƒë√≥, t√¥i ƒë√£ m·ªü c·ª≠a s·ªï.\n2. Ph√¢n t√≠ch ƒë√°p √°n:\n- however (adv): tuy nhi√™n\n- therefore (adv): do ƒë√≥/v√¨ v·∫≠y\n- although (conj): m·∫∑c d√π\n- because (conj): b·ªüi v√¨\n3. Gi·∫£i th√≠ch: H√†nh ƒë·ªông m·ªü c·ª≠a s·ªï l√† k·∫øt qu·∫£ c·ªßa vi·ªác ph√≤ng n√≥ng. V·ªã tr√≠ sau d·∫•u ch·∫•m ph·∫©y v√† tr∆∞·ªõc d·∫•u ph·∫©y c·∫ßn tr·∫°ng t·ª´ li√™n k·∫øt ch·ªâ k·∫øt qu·∫£.",
          "isCorrect": true
        },
        {
          "text": "although",
          "rationale": "Although l√† li√™n t·ª´, kh√¥ng d√πng gi·ªØa d·∫•u ch·∫•m ph·∫©y v√† d·∫•u ph·∫©y nh∆∞ v·∫≠y.",
          "isCorrect": false
        },
        {
          "text": "because",
          "rationale": "Because l√† li√™n t·ª´ ch·ªâ nguy√™n nh√¢n, kh√¥ng ph√π h·ª£p v·ªã tr√≠ v√† c·∫•u tr√∫c n√†y.",
          "isCorrect": false
        }
      ],
      "hint": "T·ª´ n√†y ch·ªâ k·∫øt qu·∫£, ƒë·ª©ng sau d·∫•u ch·∫•m ph·∫©y (;). Nghƒ©a l√† 'v√¨ v·∫≠y'."
    },
    {
      "questionNumber": 6,
      "question": "Lan is very tired __________ she stayed up late watching TV last night.",
      "imageUrl": null,
      "answerOptions": [
        {
          "text": "so that",
          "rationale": "So that ch·ªâ m·ª•c ƒë√≠ch.",
          "isCorrect": false
        },
        {
          "text": "because",
          "rationale": "1. D·ªãch c√¢u: Lan r·∫•t m·ªát v√¨ c√¥ ·∫•y th·ª©c khuya xem TV t·ªëi qua.\n2. Ph√¢n t√≠ch ƒë√°p √°n:\n- so that (conj): ƒë·ªÉ m√†\n- because (conj): b·ªüi v√¨\n- although (conj): m·∫∑c d√π\n- however (adv): tuy nhi√™n\n3. Gi·∫£i th√≠ch: M·ªánh ƒë·ªÅ sau gi·∫£i th√≠ch nguy√™n nh√¢n cho m·ªánh ƒë·ªÅ tr∆∞·ªõc (m·ªát -> v√¨ th·ª©c khuya).",
          "isCorrect": true
        },
        {
          "text": "although",
          "rationale": "Although ch·ªâ s·ª± nh∆∞·ª£ng b·ªô, kh√¥ng h·ª£p nghƒ©a.",
          "isCorrect": false
        },
        {
          "text": "however",
          "rationale": "However kh√¥ng ph·∫£i l√† li√™n t·ª´ n·ªëi m·ªánh ƒë·ªÅ nguy√™n nh√¢n trong tr∆∞·ªùng h·ª£p n√†y.",
          "isCorrect": false
        }
      ],
      "hint": "ƒêi·ªÅn t·ª´ ch·ªâ nguy√™n nh√¢n."
    },
    {
      "questionNumber": 7,
      "question": "__________ he is rich, he is not happy.",
      "imageUrl": null,
      "answerOptions": [
        {
          "text": "Although",
          "rationale": "1. D·ªãch c√¢u: M·∫∑c d√π √¥ng ·∫•y gi√†u, √¥ng ·∫•y kh√¥ng h·∫°nh ph√∫c.\n2. Ph√¢n t√≠ch ƒë√°p √°n:\n- Although (conj): m·∫∑c d√π\n- Because (conj): b·ªüi v√¨\n- Therefore (adv): do ƒë√≥\n- So that (conj): ƒë·ªÉ m√†\n3. Gi·∫£i th√≠ch: Hai v·∫ø c√¢u t∆∞∆°ng ph·∫£n (gi√†u >< kh√¥ng vui). C·∫ßn li√™n t·ª´ nh∆∞·ª£ng b·ªô ƒë·ª©ng ƒë·∫ßu.",
          "isCorrect": true
        },
        {
          "text": "Because",
          "rationale": "Because ch·ªâ nguy√™n nh√¢n, kh√¥ng h·ª£p l√Ω (V√¨ gi√†u n√™n kh√¥ng vui).",
          "isCorrect": false
        },
        {
          "text": "Therefore",
          "rationale": "Therefore kh√¥ng ƒë·ª©ng ƒë·∫ßu m·ªánh ƒë·ªÅ ph·ª• thu·ªôc.",
          "isCorrect": false
        },
        {
          "text": "So that",
          "rationale": "So that ch·ªâ m·ª•c ƒë√≠ch.",
          "isCorrect": false
        }
      ],
      "hint": "T·ª´ ch·ªâ s·ª± nh∆∞·ª£ng b·ªô (m·∫∑c d√π)."
    },
    {
      "questionNumber": 8,
      "question": "I want to learn English __________ I can travel around the world.",
      "imageUrl": null,
      "answerOptions": [
        {
          "text": "so that",
          "rationale": "1. D·ªãch c√¢u: T√¥i mu·ªën h·ªçc ti·∫øng Anh ƒë·ªÉ t√¥i c√≥ th·ªÉ ƒëi du l·ªãch v√≤ng quanh th·∫ø gi·ªõi.\n2. Ph√¢n t√≠ch ƒë√°p √°n:\n- so that (conj): ƒë·ªÉ m√†\n- because (conj): b·ªüi v√¨\n- although (conj): m·∫∑c d√π\n- therefore (adv): do ƒë√≥\n3. Gi·∫£i th√≠ch: M·ªánh ƒë·ªÅ sau ch·ªâ m·ª•c ƒë√≠ch c·ªßa vi·ªác h·ªçc ti·∫øng Anh. 'So that' th∆∞·ªùng ƒëi k√®m v·ªõi can/could.",
          "isCorrect": true
        },
        {
          "text": "because",
          "rationale": "Because ch·ªâ nguy√™n nh√¢n. Tuy nhi√™n 'so that' ƒëi v·ªõi 'can' di·ªÖn t·∫£ m·ª•c ƒë√≠ch r√µ r√†ng h∆°n.",
          "isCorrect": false
        },
        {
          "text": "although",
          "rationale": "Although kh√¥ng h·ª£p nghƒ©a.",
          "isCorrect": false
        },
        {
          "text": "therefore",
          "rationale": "Therefore l√† tr·∫°ng t·ª´, kh√¥ng n·ªëi hai m·ªánh ƒë·ªÅ theo c√°ch n√†y.",
          "isCorrect": false
        }
      ],
      "hint": "C·ª•m t·ª´ ch·ªâ m·ª•c ƒë√≠ch, th∆∞·ªùng ƒëi k√®m v·ªõi 'can' ho·∫∑c 'could' ·ªü v·∫ø sau."
    },
    {
      "questionNumber": 9,
      "question": "He didn't eat breakfast. __________, he is very hungry now.",
      "imageUrl": null,
      "answerOptions": [
        {
          "text": "However",
          "rationale": "However ch·ªâ s·ª± t∆∞∆°ng ph·∫£n, ·ªü ƒë√¢y l√† quan h·ªá nh√¢n qu·∫£.",
          "isCorrect": false
        },
        {
          "text": "Therefore",
          "rationale": "1. D·ªãch c√¢u: Anh ·∫•y ƒë√£ kh√¥ng ƒÉn s√°ng. V√¨ v·∫≠y, b√¢y gi·ªù anh ·∫•y r·∫•t ƒë√≥i.\n2. Ph√¢n t√≠ch ƒë√°p √°n:\n- However (adv): tuy nhi√™n\n- Therefore (adv): v√¨ v·∫≠y/do ƒë√≥\n- Although (conj): m·∫∑c d√π\n- As (conj): khi/b·ªüi v√¨\n3. Gi·∫£i th√≠ch: Kh√¥ng ƒÉn s√°ng -> d·∫´n ƒë·∫øn k·∫øt qu·∫£ l√† ƒë√≥i. V·ªã tr√≠ ƒë·∫ßu c√¢u th·ª© 2 c·∫ßn tr·∫°ng t·ª´ li√™n k·∫øt ch·ªâ k·∫øt qu·∫£.",
          "isCorrect": true
        },
        {
          "text": "Although",
          "rationale": "Although l√† li√™n t·ª´, kh√¥ng ƒë·ª©ng ƒë·ªôc l·∫≠p ƒë·∫ßu c√¢u nh∆∞ tr·∫°ng t·ª´ li√™n k·∫øt.",
          "isCorrect": false
        },
        {
          "text": "As",
          "rationale": "As l√† li√™n t·ª´, c·∫ßn n·ªëi hai m·ªánh ƒë·ªÅ trong c√πng m·ªôt c√¢u, kh√¥ng ƒë·ª©ng t√°ch bi·ªát d·∫•u ch·∫•m nh∆∞ n√†y.",
          "isCorrect": false
        }
      ],
      "hint": "T·ª´ ch·ªâ k·∫øt qu·∫£ (v√¨ v·∫≠y), ƒë·ª©ng ƒë·∫ßu c√¢u sau."
    },
    {
      "questionNumber": 10,
      "question": "__________ I was walking in the park, I met my best friend.",
      "imageUrl": null,
      "answerOptions": [
        {
          "text": "As",
          "rationale": "1. D·ªãch c√¢u: Khi t√¥i ƒëang ƒëi d·∫°o trong c√¥ng vi√™n, t√¥i g·∫∑p ng∆∞·ªùi b·∫°n th√¢n nh·∫•t c·ªßa m√¨nh.\n2. Ph√¢n t√≠ch ƒë√°p √°n:\n- As (conj): khi/trong khi (ch·ªâ th·ªùi gian)\n- Because (conj): b·ªüi v√¨\n- Although (conj): m·∫∑c d√π\n- Therefore (adv): do ƒë√≥\n3. Gi·∫£i th√≠ch: 'As' ·ªü ƒë√¢y ƒë√≥ng vai tr√≤ ch·ªâ th·ªùi gian (t∆∞∆°ng ƒë∆∞∆°ng When/While), di·ªÖn t·∫£ h√†nh ƒë·ªông ƒëang x·∫£y ra th√¨ h√†nh ƒë·ªông kh√°c xen v√†o.",
          "isCorrect": true
        },
        {
          "text": "Because",
          "rationale": "Because ch·ªâ nguy√™n nh√¢n, kh√¥ng h·ª£p ng·ªØ c·∫£nh (G·∫∑p b·∫°n KH√îNG PH·∫¢I V√å ƒëang ƒëi b·ªô).",
          "isCorrect": false
        },
        {
          "text": "Although",
          "rationale": "Although ch·ªâ nh∆∞·ª£ng b·ªô, kh√¥ng h·ª£p nghƒ©a.",
          "isCorrect": false
        },
        {
          "text": "Therefore",
          "rationale": "Therefore kh√¥ng ƒë·ª©ng ƒë·∫ßu m·ªánh ƒë·ªÅ ph·ª• thu·ªôc.",
          "isCorrect": false
        }
      ],
      "hint": "Trong tr∆∞·ªùng h·ª£p n√†y, t·ª´ n√†y c√≥ nghƒ©a l√† 'Khi' ho·∫∑c 'Trong khi'."
    },
    {
      "questionNumber": 11,
      "question": "My computer is broken; __________, I cannot finish my work.",
      "imageUrl": null,
      "answerOptions": [
        {
          "text": "however",
          "rationale": "However ch·ªâ t∆∞∆°ng ph·∫£n.",
          "isCorrect": false
        },
        {
          "text": "therefore",
          "rationale": "1. D·ªãch c√¢u: M√°y t√≠nh c·ªßa t√¥i b·ªã h·ªèng; do ƒë√≥, t√¥i kh√¥ng th·ªÉ ho√†n th√†nh c√¥ng vi·ªác.\n2. Ph√¢n t√≠ch ƒë√°p √°n:\n- however (adv): tuy nhi√™n\n- therefore (adv): do ƒë√≥\n- because (conj): b·ªüi v√¨\n- as (conj): b·ªüi v√¨/khi\n3. Gi·∫£i th√≠ch: M√°y h·ªèng -> k·∫øt qu·∫£ l√† kh√¥ng l√†m xong vi·ªác. C·∫•u tr√∫c ; ... , c·∫ßn tr·∫°ng t·ª´ li√™n k·∫øt ch·ªâ k·∫øt qu·∫£.",
          "isCorrect": true
        },
        {
          "text": "because",
          "rationale": "Because l√† li√™n t·ª´, sai ng·ªØ ph√°p ·ªü v·ªã tr√≠ n√†y.",
          "isCorrect": false
        },
        {
          "text": "as",
          "rationale": "As l√† li√™n t·ª´, sai ng·ªØ ph√°p ·ªü v·ªã tr√≠ n√†y.",
          "isCorrect": false
        }
      ],
      "hint": "T·ª´ n·ªëi ch·ªâ k·∫øt qu·∫£, ƒë·ª©ng sau d·∫•u ch·∫•m ph·∫©y."
    },
    {
      "questionNumber": 12,
      "question": "She didn't buy the dress __________ it was too expensive.",
      "imageUrl": null,
      "answerOptions": [
        {
          "text": "although",
          "rationale": "Although ch·ªâ s·ª± t∆∞∆°ng ph·∫£n.",
          "isCorrect": false
        },
        {
          "text": "because",
          "rationale": "1. D·ªãch c√¢u: C√¥ ·∫•y ƒë√£ kh√¥ng mua chi·∫øc v√°y v√¨ n√≥ qu√° ƒë·∫Øt.\n2. Ph√¢n t√≠ch ƒë√°p √°n:\n- although (conj): m·∫∑c d√π\n- because (conj): b·ªüi v√¨\n- so that (conj): ƒë·ªÉ m√†\n- however (adv): tuy nhi√™n\n3. Gi·∫£i th√≠ch: M·ªánh ƒë·ªÅ sau gi·∫£i th√≠ch l√Ω do cho h√†nh ƒë·ªông tr∆∞·ªõc (kh√¥ng mua -> v√¨ ƒë·∫Øt).",
          "isCorrect": true
        },
        {
          "text": "so that",
          "rationale": "So that ch·ªâ m·ª•c ƒë√≠ch.",
          "isCorrect": false
        },
        {
          "text": "however",
          "rationale": "However kh√¥ng n·ªëi m·ªánh ƒë·ªÅ nguy√™n nh√¢n ·ªü v·ªã tr√≠ n√†y.",
          "isCorrect": false
        }
      ],
      "hint": "T·ª´ ch·ªâ l√Ω do."
    },
    {
      "questionNumber": 13,
      "question": "The film was boring. __________, I watched it until the end.",
      "imageUrl": null,
      "answerOptions": [
        {
          "text": "Therefore",
          "rationale": "Therefore ch·ªâ k·∫øt qu·∫£ thu·∫≠n (Phim ch√°n -> n√™n t·∫Øt ƒëi m·ªõi ƒë√∫ng).",
          "isCorrect": false
        },
        {
          "text": "However",
          "rationale": "1. D·ªãch c√¢u: B·ªô phim r·∫•t ch√°n. Tuy nhi√™n, t√¥i v·∫´n xem n√≥ ƒë·∫øn cu·ªëi.\n2. Ph√¢n t√≠ch ƒë√°p √°n:\n- Therefore (adv): do ƒë√≥\n- However (adv): tuy nhi√™n\n- Because (conj): b·ªüi v√¨\n- As (conj): khi/b·ªüi v√¨\n3. Gi·∫£i th√≠ch: Hai c√¢u c√≥ √Ω t∆∞∆°ng ph·∫£n (ch√°n >< xem ƒë·∫øn cu·ªëi). C·∫ßn tr·∫°ng t·ª´ li√™n k·∫øt ch·ªâ s·ª± t∆∞∆°ng ph·∫£n.",
          "isCorrect": true
        },
        {
          "text": "Because",
          "rationale": "Because kh√¥ng ƒë·ª©ng ƒë·∫ßu c√¢u ƒë·ªôc l·∫≠p th·ª© 2 nh∆∞ n√†y.",
          "isCorrect": false
        },
        {
          "text": "As",
          "rationale": "As kh√¥ng d√πng ·ªü v·ªã tr√≠ n√†y.",
          "isCorrect": false
        }
      ],
      "hint": "T·ª´ n·ªëi ch·ªâ s·ª± t∆∞∆°ng ph·∫£n, ƒë·ª©ng ƒë·∫ßu c√¢u sau."
    },
    {
      "questionNumber": 14,
      "question": "Please turn off the lights __________ we can save electricity.",
      "imageUrl": null,
      "answerOptions": [
        {
          "text": "because",
          "rationale": "Because ch·ªâ nguy√™n nh√¢n. D√π c√≥ th·ªÉ hi·ªÉu ƒë∆∞·ª£c, nh∆∞ng 'so that' ƒëi v·ªõi 'can' chu·∫©n x√°c h∆°n v·ªÅ m·ª•c ƒë√≠ch.",
          "isCorrect": false
        },
        {
          "text": "so that",
          "rationale": "1. D·ªãch c√¢u: L√†m ∆°n t·∫Øt ƒë√®n ƒë·ªÉ ch√∫ng ta c√≥ th·ªÉ ti·∫øt ki·ªám ƒëi·ªán.\n2. Ph√¢n t√≠ch ƒë√°p √°n:\n- because (conj): b·ªüi v√¨\n- so that (conj): ƒë·ªÉ m√†\n- although (conj): m·∫∑c d√π\n- however (adv): tuy nhi√™n\n3. Gi·∫£i th√≠ch: M·ªánh ƒë·ªÅ sau ch·ªâ m·ª•c ƒë√≠ch c·ªßa m·ªánh ƒë·ªÅ y√™u c·∫ßu tr∆∞·ªõc ƒë√≥. C·∫•u tr√∫c 'so that + S + can + V'.",
          "isCorrect": true
        },
        {
          "text": "although",
          "rationale": "Although kh√¥ng ph√π h·ª£p ng·ªØ nghƒ©a.",
          "isCorrect": false
        },
        {
          "text": "however",
          "rationale": "However kh√¥ng ph√π h·ª£p ng·ªØ ph√°p v√† nghƒ©a.",
          "isCorrect": false
        }
      ],
      "hint": "C·ª•m t·ª´ ch·ªâ m·ª•c ƒë√≠ch, theo sau th∆∞·ªùng c√≥ 'can'."
    },
    {
      "questionNumber": 15,
      "question": "__________ Ba is young, he is a very talented artist.",
      "imageUrl": null,
      "answerOptions": [
        {
          "text": "As",
          "rationale": "As ch·ªâ nguy√™n nh√¢n (V√¨ tr·∫ª n√™n t√†i nƒÉng) -> Kh√¥ng h·ª£p logic l·∫Øm.",
          "isCorrect": false
        },
        {
          "text": "Therefore",
          "rationale": "Therefore kh√¥ng ƒë·ª©ng ƒë·∫ßu c√¢u trong c·∫•u tr√∫c n√†y.",
          "isCorrect": false
        },
        {
          "text": "Although",
          "rationale": "1. D·ªãch c√¢u: M·∫∑c d√π Ba c√≤n tr·∫ª, c·∫≠u ·∫•y l√† m·ªôt ngh·ªá sƒ© r·∫•t t√†i nƒÉng.\n2. Ph√¢n t√≠ch ƒë√°p √°n:\n- As (conj): b·ªüi v√¨/khi\n- Therefore (adv): do ƒë√≥\n- Although (conj): m·∫∑c d√π\n- So that (conj): ƒë·ªÉ m√†\n3. Gi·∫£i th√≠ch: Tu·ªïi tr·∫ª th∆∞·ªùng ƒëi k√®m √≠t kinh nghi·ªám, nh∆∞ng ·ªü ƒë√¢y l·∫°i t√†i nƒÉng -> T∆∞∆°ng ph·∫£n. D√πng Although.",
          "isCorrect": true
        },
        {
          "text": "So that",
          "rationale": "So that ch·ªâ m·ª•c ƒë√≠ch.",
          "isCorrect": false
        }
      ],
      "hint": "T·ª´ ch·ªâ s·ª± nh∆∞·ª£ng b·ªô (M·∫∑c d√π)."
    },
    {
      "questionNumber": 16,
      "question": "Tuan has a toothache; __________, he has to go to the dentist.",
      "imageUrl": null,
      "answerOptions": [
        {
          "text": "however",
          "rationale": "However ch·ªâ t∆∞∆°ng ph·∫£n.",
          "isCorrect": false
        },
        {
          "text": "therefore",
          "rationale": "1. D·ªãch c√¢u: Tu·∫•n b·ªã ƒëau rƒÉng; do ƒë√≥, anh ·∫•y ph·∫£i ƒëi nha sƒ©.\n2. Ph√¢n t√≠ch ƒë√°p √°n:\n- however (adv): tuy nhi√™n\n- therefore (adv): do ƒë√≥\n- although (conj): m·∫∑c d√π\n- because (conj): b·ªüi v√¨\n3. Gi·∫£i th√≠ch: ƒêau rƒÉng -> k·∫øt qu·∫£ l√† ƒëi nha sƒ©. C·∫•u tr√∫c ;..., d√πng Therefore.",
          "isCorrect": true
        },
        {
          "text": "although",
          "rationale": "Although sai c·∫•u tr√∫c.",
          "isCorrect": false
        },
        {
          "text": "because",
          "rationale": "Because sai c·∫•u tr√∫c.",
          "isCorrect": false
        }
      ],
      "hint": "T·ª´ ch·ªâ k·∫øt qu·∫£ (v√¨ th·∫ø)."
    },
    {
      "questionNumber": 17,
      "question": "I like living in the city __________ there are many shops and cinemas.",
      "imageUrl": null,
      "answerOptions": [
        {
          "text": "because",
          "rationale": "1. D·ªãch c√¢u: T√¥i th√≠ch s·ªëng ·ªü th√†nh ph·ªë v√¨ c√≥ nhi·ªÅu c·ª≠a h√†ng v√† r·∫°p chi·∫øu phim.\n2. Ph√¢n t√≠ch ƒë√°p √°n:\n- because (conj): b·ªüi v√¨\n- although (conj): m·∫∑c d√π\n- therefore (adv): do ƒë√≥\n- however (adv): tuy nhi√™n\n3. Gi·∫£i th√≠ch: M·ªánh ƒë·ªÅ sau gi·∫£i th√≠ch l√Ω do cho m·ªánh ƒë·ªÅ tr∆∞·ªõc.",
          "isCorrect": true
        },
        {
          "text": "although",
          "rationale": "Although ch·ªâ t∆∞∆°ng ph·∫£n, kh√¥ng h·ª£p nghƒ©a.",
          "isCorrect": false
        },
        {
          "text": "therefore",
          "rationale": "Therefore sai c·∫•u tr√∫c (kh√¥ng d√πng nh∆∞ li√™n t·ª´ ph·ª• thu·ªôc).",
          "isCorrect": false
        },
        {
          "text": "however",
          "rationale": "However sai c·∫•u tr√∫c.",
          "isCorrect": false
        }
      ],
      "hint": "T·ª´ ch·ªâ nguy√™n nh√¢n/l√Ω do."
    },
    {
      "questionNumber": 18,
      "question": "The car is very old. __________, it runs very fast.",
      "imageUrl": null,
      "answerOptions": [
        {
          "text": "Therefore",
          "rationale": "Therefore ch·ªâ k·∫øt qu·∫£ (Xe c≈© -> ch·∫°y ch·∫≠m m·ªõi ƒë√∫ng logic th∆∞·ªùng).",
          "isCorrect": false
        },
        {
          "text": "However",
          "rationale": "1. D·ªãch c√¢u: Chi·∫øc xe n√†y r·∫•t c≈©. Tuy nhi√™n, n√≥ ch·∫°y r·∫•t nhanh.\n2. Ph√¢n t√≠ch ƒë√°p √°n:\n- Therefore (adv): do ƒë√≥\n- However (adv): tuy nhi√™n\n- Because (conj): b·ªüi v√¨\n- So that (conj): ƒë·ªÉ m√†\n3. Gi·∫£i th√≠ch: Hai c√¢u t∆∞∆°ng ph·∫£n v·ªÅ nghƒ©a (c≈© >< nhanh).",
          "isCorrect": true
        },
        {
          "text": "Because",
          "rationale": "Because sai c·∫•u tr√∫c (kh√¥ng ƒë·ª©ng ƒë·∫ßu c√¢u ƒë·ªôc l·∫≠p th·ª© 2).",
          "isCorrect": false
        },
        {
          "text": "So that",
          "rationale": "So that sai nghƒ©a v√† c·∫•u tr√∫c.",
          "isCorrect": false
        }
      ],
      "hint": "T·ª´ ch·ªâ s·ª± t∆∞∆°ng ph·∫£n, ƒë·ª©ng ƒë·∫ßu c√¢u sau."
    },
    {
      "questionNumber": 19,
      "question": "He spoke loudly __________ everyone could hear him clearly.",
      "imageUrl": null,
      "answerOptions": [
        {
          "text": "so that",
          "rationale": "1. D·ªãch c√¢u: Anh ·∫•y n√≥i to ƒë·ªÉ m·ªçi ng∆∞·ªùi c√≥ th·ªÉ nghe r√µ anh ·∫•y.\n2. Ph√¢n t√≠ch ƒë√°p √°n:\n- so that (conj): ƒë·ªÉ m√†\n- because (conj): b·ªüi v√¨\n- although (conj): m·∫∑c d√π\n- however (adv): tuy nhi√™n\n3. Gi·∫£i th√≠ch: N√≥i to l√† h√†nh ƒë·ªông, ƒë·ªÉ m·ªçi ng∆∞·ªùi nghe th·∫•y l√† m·ª•c ƒë√≠ch. C√≥ 'could' l√† d·∫•u hi·ªáu c·ªßa m·ªánh ƒë·ªÅ m·ª•c ƒë√≠ch.",
          "isCorrect": true
        },
        {
          "text": "because",
          "rationale": "Because ch·ªâ nguy√™n nh√¢n. Ng·ªØ c·∫£nh n√†y m·ª•c ƒë√≠ch ph√π h·ª£p h∆°n.",
          "isCorrect": false
        },
        {
          "text": "although",
          "rationale": "Although kh√¥ng h·ª£p nghƒ©a.",
          "isCorrect": false
        },
        {
          "text": "however",
          "rationale": "However sai ng·ªØ ph√°p.",
          "isCorrect": false
        }
      ],
      "hint": "C·ª•m t·ª´ ch·ªâ m·ª•c ƒë√≠ch."
    },
    {
      "questionNumber": 20,
      "question": "The test was very difficult; __________, no one got a perfect score.",
      "imageUrl": null,
      "answerOptions": [
        {
          "text": "however",
          "rationale": "However ch·ªâ t∆∞∆°ng ph·∫£n.",
          "isCorrect": false
        },
        {
          "text": "therefore",
          "rationale": "1. D·ªãch c√¢u: B√†i ki·ªÉm tra r·∫•t kh√≥; do ƒë√≥, kh√¥ng ai ƒë·∫°t ƒëi·ªÉm tuy·ªát ƒë·ªëi.\n2. Ph√¢n t√≠ch ƒë√°p √°n:\n- however (adv): tuy nhi√™n\n- therefore (adv): do ƒë√≥\n- because (conj): b·ªüi v√¨\n- as (conj): b·ªüi v√¨\n3. Gi·∫£i th√≠ch: B√†i kh√≥ -> k·∫øt qu·∫£ l√† kh√¥ng ai ƒëi·ªÉm cao. D·∫•u hi·ªáu ;..., ch·ªçn Therefore.",
          "isCorrect": true
        },
        {
          "text": "because",
          "rationale": "Because sai c·∫•u tr√∫c.",
          "isCorrect": false
        },
        {
          "text": "as",
          "rationale": "As sai c·∫•u tr√∫c.",
          "isCorrect": false
        }
      ],
      "hint": "T·ª´ ch·ªâ k·∫øt qu·∫£."
    }
  ];

        // --- GAME LOGIC ---
        
        let shuffledQuizData = [];
        let score = 0;
        let answeredCount = 0;

        // Shuffle function (Fisher-Yates)
        function shuffleArray(array) {
            for (let i = array.length - 1; i > 0; i--) {
                const j = Math.floor(Math.random() * (i + 1));
                [array[i], array[j]] = [array[j], array[i]];
            }
            return array;
        }

        // Initialize Quiz
        function initQuiz() {
            // Create a deep copy to not mess up original order if we replay
            shuffledQuizData = JSON.parse(JSON.stringify(quizData));
            // Shuffle questions
            shuffleArray(shuffledQuizData);
            
            const container = document.getElementById('quiz-output');
            container.innerHTML = '';

            shuffledQuizData.forEach((item, index) => {
                const questionIndex = index + 1;
                const card = document.createElement('div');
                card.className = 'question-card';
                card.id = `q-card-${index}`;

                // Process rationale text to be HTML safe and formatted
                const correctOption = item.answerOptions.find(opt => opt.isCorrect);
                const explanationText = correctOption.rationale.replace(/\n/g, '<br>').replace(/\*\*(.*?)\*\*/g, '<strong>$1</strong>');

                let optionsHtml = '';
                item.answerOptions.forEach((opt, optIndex) => {
                    optionsHtml += `<button class="option-btn" onclick="checkAnswer(this, ${item.isCorrect}, ${opt.isCorrect}, '${correctOption.text}', 'expl-${index}', ${index})">${opt.text}</button>`;
                });

                card.innerHTML = `
                    <div class="question-number">C√¢u h·ªèi ${questionIndex}</div>
                    <div class="question-text">${item.question}</div>
                    <div class="options-grid">
                        ${optionsHtml}
                    </div>
                    <div class="explanation-box" id="expl-${index}">
                        <div class="explanation-header">
                            <span>üí°</span> Gi·∫£i th√≠ch chi ti·∫øt c·ªßa c√¥ Mai An:
                        </div>
                        <div class="explanation-content">
                            ${explanationText}
                        </div>
                    </div>
                `;
                container.appendChild(card);
            });
        }

        // --- AUDIO ENGINE (Web Audio API - No external files) ---
        const audioCtx = new (window.AudioContext || window.webkitAudioContext)();

        function playSound(type) {
            if (audioCtx.state === 'suspended') audioCtx.resume();
            
            const osc = audioCtx.createOscillator();
            const gainNode = audioCtx.createGain();
            
            osc.connect(gainNode);
            gainNode.connect(audioCtx.destination);

            if (type === 'correct') {
                // Ding sound (High sine wave)
                osc.type = 'sine';
                osc.frequency.setValueAtTime(523.25, audioCtx.currentTime); // C5
                osc.frequency.exponentialRampToValueAtTime(1046.5, audioCtx.currentTime + 0.1); // C6
                gainNode.gain.setValueAtTime(0.3, audioCtx.currentTime);
                gainNode.gain.exponentialRampToValueAtTime(0.01, audioCtx.currentTime + 0.5);
                osc.start();
                osc.stop(audioCtx.currentTime + 0.5);
            } else {
                // Buzz sound (Low sawtooth)
                osc.type = 'sawtooth';
                osc.frequency.setValueAtTime(150, audioCtx.currentTime);
                osc.frequency.linearRampToValueAtTime(100, audioCtx.currentTime + 0.3);
                gainNode.gain.setValueAtTime(0.3, audioCtx.currentTime);
                gainNode.gain.exponentialRampToValueAtTime(0.01, audioCtx.currentTime + 0.4);
                osc.start();
                osc.stop(audioCtx.currentTime + 0.4);
            }
        }

        // --- INTERACTION ---

        function checkAnswer(btn, qCorrect, isCorrect, correctText, explId, cardIndex) {
            const card = document.getElementById(`q-card-${cardIndex}`);
            const buttons = card.querySelectorAll('.option-btn');
            
            // Disable all buttons in this card
            buttons.forEach(b => b.disabled = true);

            const explanationBox = document.getElementById(explId);
            explanationBox.style.display = 'block';

            if (isCorrect) {
                btn.classList.add('correct');
                playSound('correct');
                score++;
                fireConfetti();
            } else {
                btn.classList.add('incorrect');
                playSound('wrong');
                // Highlight the correct one
                buttons.forEach(b => {
                    if (b.innerText.trim() === correctText) {
                        b.classList.add('correct');
                    }
                });
            }
            answeredCount++;
        }

        // --- CONFETTI ENGINE (Simple Canvas) ---
        function fireConfetti() {
            const canvas = document.getElementById('confetti-canvas');
            const ctx = canvas.getContext('2d');
            canvas.width = window.innerWidth;
            canvas.height = window.innerHeight;

            const particles = [];
            const particleCount = 100;
            const colors = ['#8854C0', '#00C9A7', '#FF4757', '#FFD700'];

            for (let i = 0; i < particleCount; i++) {
                particles.push({
                    x: canvas.width / 2,
                    y: canvas.height / 2,
                    w: Math.random() * 10 + 5,
                    h: Math.random() * 10 + 5,
                    color: colors[Math.floor(Math.random() * colors.length)],
                    vx: (Math.random() - 0.5) * 10,
                    vy: (Math.random() - 0.5) * 10 - 5,
                    grav: 0.2
                });
            }

            function update() {
                ctx.clearRect(0, 0, canvas.width, canvas.height);
                let active = false;
                particles.forEach(p => {
                    p.x += p.vx;
                    p.y += p.vy;
                    p.vy += p.grav;
                    if (p.y < canvas.height) active = true;
                    
                    ctx.fillStyle = p.color;
                    ctx.fillRect(p.x, p.y, p.w, p.h);
                });
                
                if (active) requestAnimationFrame(update);
                else ctx.clearRect(0, 0, canvas.width, canvas.height);
            }
            update();
        }

        // --- SCORING ---
        function finishQuiz() {
            const modal = document.getElementById('scoreModal');
            const scoreDisplay = document.getElementById('finalScore');
            const msgDisplay = document.getElementById('scoreMessage');
            
            scoreDisplay.textContent = `${score}/${quizData.length}`;
            
            const percentage = (score / quizData.length) * 100;
            if (percentage === 100) msgDisplay.textContent = "Xu·∫•t s·∫Øc! B·∫°n l√† thi√™n t√†i!";
            else if (percentage >= 80) msgDisplay.textContent = "Gi·ªèi l·∫Øm! C·ªë g·∫Øng ph√°t huy!";
            else if (percentage >= 50) msgDisplay.textContent = "Kh√° t·ªët, nh∆∞ng c·∫ßn √¥n l·∫°i nh√©!";
            else msgDisplay.textContent = "C·ªë l√™n! H√£y ƒë·ªçc k·ªπ ph·∫ßn gi·∫£i th√≠ch nh√©!";

            modal.style.display = 'flex';
            if(percentage >= 50) fireConfetti();
        }

        function closeModal() {
            document.getElementById('scoreModal').style.display = 'none';
        }

        // Start
        window.onload = initQuiz;
    </script>
</body>
</html>
