<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Ms Mai An ULIS - Reading Challenge</title>
    <link href="https://fonts.googleapis.com/css2?family=Nunito:wght@400;700;800;900&display=swap" rel="stylesheet">
    <style>
        :root {
            --primary: #8854C0;
            --secondary: #00C9A7;
            --accent: #FDCB6E;
            --correct: #00D26A;
            --wrong: #FF4757;
            --text-dark: #2d3436;
            --bg-light: rgba(255, 255, 255, 0.9);
        }

        * {
            box-sizing: border-box;
            font-family: 'Nunito', sans-serif;
            margin: 0;
            padding: 0;
        }

        body {
            overflow: hidden;
            color: var(--text-dark);
            /* Dynamic animated gradient background */
            background: linear-gradient(-45deg, #FF9A9E, #FECFEF, #a8cbf0, #b8e6d1);
            background-size: 400% 400%;
            animation: gradientBG 15s ease infinite;
            height: 100vh;
        }

        @keyframes gradientBG {
            0% { background-position: 0% 50%; }
            50% { background-position: 100% 50%; }
            100% { background-position: 0% 50%; }
        }

        /* SVG Pattern Overlay with emojis: City, Music, Bus */
        .pattern-overlay {
            position: fixed;
            top: 0; left: 0; width: 100%; height: 100%;
            background-image: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='200' height='200'%3E%3Ctext x='20' y='50' font-size='30'%3EüèôÔ∏è%3C/text%3E%3Ctext x='120' y='140' font-size='35'%3Eüé§%3C/text%3E%3Ctext x='150' y='60' font-size='25'%3Eüöå%3C/text%3E%3Ctext x='40' y='160' font-size='20'%3E‚ú®%3C/text%3E%3C/svg%3E");
            opacity: 0.3;
            pointer-events: none;
            z-index: 0;
            animation: floatPattern 40s linear infinite;
        }

        @keyframes floatPattern {
            from { background-position: 0 0; }
            to { background-position: 400px 400px; }
        }

        /* Top Bar */
        header {
            position: relative;
            z-index: 10;
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 15px 30px;
            background: rgba(255, 255, 255, 0.95);
            box-shadow: 0 4px 15px rgba(0,0,0,0.1);
            border-bottom: 4px solid var(--primary);
        }

        .header-title {
            font-size: 1.2rem;
            color: var(--primary);
            font-weight: 800;
        }

        .timer-container {
            display: flex;
            align-items: center;
            gap: 15px;
        }

        .btn-action {
            padding: 10px 20px;
            border: none;
            border-radius: 12px;
            font-size: 1rem;
            font-weight: 800;
            cursor: pointer;
            transition: all 0.2s;
            box-shadow: 0 5px 0 rgba(0,0,0,0.15);
        }

        .btn-start {
            background-color: var(--accent);
            color: #d35400;
        }

        .btn-start:active {
            transform: translateY(5px);
            box-shadow: none;
        }

        #timer-display {
            font-size: 1.8rem;
            font-weight: 900;
            color: var(--primary);
            min-width: 100px;
            text-align: center;
        }

        /* Split Screen Layout */
        .main-container {
            display: flex;
            height: calc(100vh - 75px);
            position: relative;
            z-index: 5;
        }

        .panel {
            flex: 1;
            overflow-y: auto;
            padding: 30px;
            scroll-behavior: smooth;
        }

        .left-panel {
            background: rgba(255, 255, 255, 0.6);
            backdrop-filter: blur(10px);
            border-right: 3px dashed var(--primary);
        }

        .right-panel {
            background: transparent;
        }

        /* Reading Content Styling */
        .passage-title {
            font-size: 2.5rem;
            color: var(--primary);
            margin-bottom: 20px;
            text-align: center;
            text-shadow: 2px 2px 0px rgba(255,255,255,0.8);
        }

        .paragraph-box {
            background: #fff;
            padding: 20px;
            border-radius: 15px;
            margin-bottom: 20px;
            box-shadow: 0 8px 0 rgba(0,0,0,0.05);
            border: 2px solid #eee;
            font-size: 1.2rem;
            line-height: 1.7;
        }

        .btn-translate {
            background: var(--secondary);
            color: white;
            border: none;
            padding: 8px 15px;
            border-radius: 10px;
            font-weight: 700;
            margin-top: 10px;
            cursor: pointer;
            box-shadow: 0 4px 0 #00967d;
            transition: 0.2s;
        }
        .btn-translate:active { transform: translateY(4px); box-shadow: none; }

        .translation-text {
            display: none;
            margin-top: 15px;
            padding: 15px;
            background: #e8f8f5;
            border-left: 5px solid var(--secondary);
            border-radius: 8px;
            font-size: 1.1rem;
            color: #16a085;
            font-weight: 600;
        }

        /* Glossary Table */
        .glossary-wrapper {
            background: white;
            border-radius: 20px;
            padding: 20px;
            margin-top: 40px;
            box-shadow: 0 8px 0 rgba(0,0,0,0.05);
            border: 3px solid var(--primary);
        }
        .glossary-title {
            color: var(--primary);
            text-align: center;
            font-size: 1.5rem;
            margin-bottom: 15px;
        }
        table {
            width: 100%;
            border-collapse: collapse;
        }
        th, td {
            padding: 12px;
            text-align: left;
            border-bottom: 1px solid #eee;
        }
        th {
            background: var(--primary);
            color: white;
            font-weight: 800;
        }
        tr:nth-child(even) { background-color: #f9f9f9; }

        /* Quiz Styling */
        .question-card {
            background: white;
            border-radius: 20px;
            padding: 25px;
            margin-bottom: 30px;
            box-shadow: 0 10px 0 rgba(0,0,0,0.08);
            border: 3px solid #eee;
            transition: transform 0.3s;
        }
        .question-card:hover {
            transform: translateY(-5px);
        }

        .question-text {
            font-size: 1.3rem;
            font-weight: 800;
            color: #2c3e50;
            margin-bottom: 20px;
        }

        .options-grid {
            display: flex;
            flex-direction: column;
            gap: 15px;
        }

        .option-btn {
            background: white;
            border: 3px solid #dfe6e9;
            padding: 15px 20px;
            border-radius: 15px;
            font-size: 1.2rem;
            font-weight: 700;
            color: #2d3436;
            cursor: pointer;
            text-align: left;
            transition: all 0.2s cubic-bezier(0.175, 0.885, 0.32, 1.275);
            box-shadow: 0 6px 0 #dfe6e9;
            display: flex;
            align-items: center;
        }

        .option-btn:hover:not(:disabled) {
            transform: scale(1.02);
            border-color: var(--primary);
            box-shadow: 0 6px 0 var(--primary);
        }

        .option-btn:active:not(:disabled) {
            transform: translateY(6px);
            box-shadow: none;
        }

        .option-btn.correct {
            background: var(--correct);
            border-color: #00b85c;
            color: white;
            box-shadow: 0 6px 0 #00b85c;
        }

        .option-btn.wrong {
            background: var(--wrong);
            border-color: #e03c4a;
            color: white;
            box-shadow: 0 6px 0 #e03c4a;
        }

        /* Animations */
        @keyframes shake {
            0%, 100% { transform: translateX(0); }
            20%, 60% { transform: translateX(-10px); }
            40%, 80% { transform: translateX(10px); }
        }
        .shake { animation: shake 0.5s; }

        /* Explanation Box */
        .explanation-box {
            display: none;
            margin-top: 20px;
            padding: 20px;
            background: #fdf2e9;
            border: 3px solid #e67e22;
            border-radius: 15px;
            animation: fadeIn 0.5s;
        }
        @keyframes fadeIn { from { opacity: 0; transform: translateY(-10px); } to { opacity: 1; transform: translateY(0); } }

        .explanation-box h4 {
            color: #d35400;
            margin-bottom: 10px;
            font-size: 1.2rem;
        }
        
        .explanation-box p, .explanation-box ul {
            font-size: 1.1rem;
            line-height: 1.6;
            margin-bottom: 10px;
            color: #34495e;
        }
        .explanation-box .highlight {
            background: #ffeaa7;
            padding: 2px 5px;
            border-radius: 4px;
            font-weight: bold;
        }

        /* Submit Button */
        .btn-submit {
            display: block;
            width: 100%;
            background: var(--primary);
            color: white;
            font-size: 1.5rem;
            font-weight: 900;
            padding: 20px;
            border: none;
            border-radius: 20px;
            cursor: pointer;
            box-shadow: 0 8px 0 #6c4298;
            margin-top: 30px;
            transition: all 0.2s;
            text-transform: uppercase;
        }
        .btn-submit:hover { transform: scale(1.02); }
        .btn-submit:active { transform: translateY(8px); box-shadow: none; }

        /* Modal Result */
        #result-modal {
            display: none;
            position: fixed;
            top: 0; left: 0; width: 100%; height: 100%;
            background: rgba(0,0,0,0.8);
            z-index: 100;
            justify-content: center;
            align-items: center;
        }
        .modal-content {
            background: white;
            padding: 40px;
            border-radius: 30px;
            text-align: center;
            max-width: 500px;
            width: 90%;
            box-shadow: 0 15px 50px rgba(0,0,0,0.3);
            border: 5px solid var(--accent);
            animation: popIn 0.5s cubic-bezier(0.175, 0.885, 0.32, 1.275);
        }
        @keyframes popIn {
            0% { transform: scale(0.5); opacity: 0; }
            100% { transform: scale(1); opacity: 1; }
        }
        .score-circle {
            width: 150px;
            height: 150px;
            background: var(--accent);
            border-radius: 50%;
            display: flex;
            justify-content: center;
            align-items: center;
            font-size: 3rem;
            font-weight: 900;
            color: white;
            margin: 0 auto 20px;
            border: 8px solid #f39c12;
        }

        /* Custom Scrollbar */
        ::-webkit-scrollbar { width: 12px; }
        ::-webkit-scrollbar-track { background: rgba(0,0,0,0.05); }
        ::-webkit-scrollbar-thumb { background: var(--primary); border-radius: 10px; }
        ::-webkit-scrollbar-thumb:hover { background: #6c4298; }

        /* Confetti Canvas */
        #confetti-canvas {
            position: fixed;
            top: 0; left: 0; width: 100%; height: 100%;
            pointer-events: none;
            z-index: 999;
        }
    </style>
</head>
<body>

    <div class="pattern-overlay"></div>
    <canvas id="confetti-canvas"></canvas>

    <header>
        <div class="header-title">‚ú® Ms Mai An ULIS | Reading Challenge</div>
        <div class="timer-container">
            <div id="timer-display">10:00</div>
            <button class="btn-action btn-start" id="btn-timer" onclick="toggleTimer()">B·∫ÆT ƒê·∫¶U T√çNH GI·ªú</button>
        </div>
    </header>

    <div class="main-container">
        <div class="panel left-panel">
            <h1 class="passage-title">üèôÔ∏è My City</h1>
            <p style="text-align: center; font-style: italic; margin-bottom: 20px;">Pop singer Charlotte Bond talks about living in London.</p>

            <div class="paragraph-box">
                <p>I live in the centre of London. I love it because there‚Äôs always something happening and there are people around whatever time it is. Famous people like it too ‚Äì they often come here for the restaurants and shops.</p>
                <button class="btn-translate" onclick="toggleTranslation(this)">B·∫¢N D·ªäCH ƒê·∫¶Y ƒê·ª¶</button>
                <div class="translation-text">T√¥i s·ªëng ·ªü trung t√¢m th·ªß ƒë√¥ Lu√¢n ƒê√¥n. T√¥i y√™u n∆°i n√†y v√¨ lu√¥n c√≥ c√°c s·ª± ki·ªán di·ªÖn ra v√† lu√¥n c√≥ ng∆∞·ªùi xung quanh b·∫•t k·ªÉ l√† l√∫c n√†o. Nh·ªØng ng∆∞·ªùi n·ªïi ti·∫øng c≈©ng th√≠ch n∆°i n√†y ‚Äì h·ªç th∆∞·ªùng ƒë·∫øn ƒë√¢y v√¨ c√°c nh√† h√†ng v√† c·ª≠a hi·ªáu.</div>
            </div>

            <div class="paragraph-box">
                <p>I‚Äôve lived here all my life. When I was little, I had singing lessons at a place near where I live now. I was afraid of the teacher at first, and some of the songs we did together were quite hard to learn. But she was good at what she did and I learned a lot of things that have helped me in my career.</p>
                <button class="btn-translate" onclick="toggleTranslation(this)">B·∫¢N D·ªäCH ƒê·∫¶Y ƒê·ª¶</button>
                <div class="translation-text">T√¥i ƒë√£ s·ªëng ·ªü ƒë√¢y su·ªët c·∫£ cu·ªôc ƒë·ªùi. Khi c√≤n nh·ªè, t√¥i t·ª´ng h·ªçc h√°t ·ªü m·ªôt n∆°i g·∫ßn ch·ªó t√¥i s·ªëng hi·ªán t·∫°i. L√∫c ƒë·∫ßu t√¥i kh√° s·ª£ c√¥ gi√°o, v√† m·ªôt v√†i b√†i h√°t ch√∫ng t√¥i luy·ªán t·∫≠p c√πng nhau kh√° l√† kh√≥ h·ªçc. Nh∆∞ng c√¥ ·∫•y r·∫•t gi·ªèi chuy√™n m√¥n v√† t√¥i ƒë√£ h·ªçc ƒë∆∞·ª£c r·∫•t nhi·ªÅu ƒëi·ªÅu gi√∫p √≠ch cho s·ª± nghi·ªáp c·ªßa m√¨nh.</div>
            </div>

            <div class="paragraph-box">
                <p>When friends visit me now, I enjoy taking them sightseeing. You can get a bus around the city, but we prefer to walk. I‚Äôve got a little car and I love driving, but there‚Äôs so much traffic here, and it‚Äôs hard to find parking spaces.</p>
                <button class="btn-translate" onclick="toggleTranslation(this)">B·∫¢N D·ªäCH ƒê·∫¶Y ƒê·ª¶</button>
                <div class="translation-text">B√¢y gi·ªù khi b·∫°n b√® ƒë·∫øn thƒÉm, t√¥i th√≠ch ƒë∆∞a h·ªç ƒëi ng·∫Øm c·∫£nh. B·∫°n c√≥ th·ªÉ b·∫Øt xe bu√Ωt ƒëi quanh th√†nh ph·ªë, nh∆∞ng ch√∫ng t√¥i th√≠ch ƒëi b·ªô h∆°n. T√¥i c√≥ m·ªôt chi·∫øc √¥ t√¥ nh·ªè v√† t√¥i th√≠ch l√°i xe, nh∆∞ng ·ªü ƒë√¢y xe c·ªô ƒë√¥ng ƒë√∫c qu√°, v√† r·∫•t kh√≥ ƒë·ªÉ t√¨m ƒë∆∞·ª£c ch·ªó ƒë·∫≠u xe.</div>
            </div>

            <div class="paragraph-box">
                <p>One building I love is the Natural History Museum. They sometimes hold parties there, and last December my band and I played at one. I‚Äôll never forget it. When I go to exhibitions at the museum with my friends, I tell them all about that night and how amazing it was.</p>
                <button class="btn-translate" onclick="toggleTranslation(this)">B·∫¢N D·ªäCH ƒê·∫¶Y ƒê·ª¶</button>
                <div class="translation-text">M·ªôt t√≤a nh√† m√† t√¥i v√¥ c√πng y√™u th√≠ch l√† B·∫£o t√†ng L·ªãch s·ª≠ T·ª± nhi√™n. ƒê√¥i khi h·ªç t·ªï ch·ª©c ti·ªác ·ªü ƒë√≥, v√† th√°ng 12 nƒÉm ngo√°i ban nh·∫°c c·ªßa t√¥i v√† t√¥i ƒë√£ bi·ªÉu di·ªÖn t·∫°i m·ªôt b·ªØa ti·ªác nh∆∞ v·∫≠y. T√¥i s·∫Ω kh√¥ng bao gi·ªù qu√™n ƒëi·ªÅu ƒë√≥. Khi t√¥i ƒë·∫øn c√°c bu·ªïi tri·ªÉn l√£m ·ªü b·∫£o t√†ng c√πng b·∫°n b√®, t√¥i k·ªÉ cho h·ªç nghe t·∫•t c·∫£ v·ªÅ ƒë√™m h√¥m ƒë√≥ v√† n√≥ tuy·ªát v·ªùi nh∆∞ th·∫ø n√†o.</div>
            </div>

            <div class="paragraph-box">
                <p>Soon I‚Äôll be leaving London to go on tour with my band. We‚Äôre playing in lots of new cities and I can‚Äôt wait to explore them. We‚Äôve sold lots of tickets, which is great. I‚Äôll be away from my family for six months, but they‚Äôre coming to see me sing, so it‚Äôs fine.</p>
                <button class="btn-translate" onclick="toggleTranslation(this)">B·∫¢N D·ªäCH ƒê·∫¶Y ƒê·ª¶</button>
                <div class="translation-text">S·∫Øp t·ªõi, t√¥i s·∫Ω r·ªùi Lu√¢n ƒê√¥n ƒë·ªÉ ƒëi l∆∞u di·ªÖn c√πng ban nh·∫°c c·ªßa m√¨nh. Ch√∫ng t√¥i s·∫Ω ch∆°i ·ªü nhi·ªÅu th√†nh ph·ªë m·ªõi v√† t√¥i r·∫•t n√≥ng l√≤ng ƒë∆∞·ª£c kh√°m ph√° ch√∫ng. Ch√∫ng t√¥i ƒë√£ b√°n ƒë∆∞·ª£c r·∫•t nhi·ªÅu v√©, ƒëi·ªÅu ƒë√≥ th·∫≠t tuy·ªát. T√¥i s·∫Ω ph·∫£i xa gia ƒë√¨nh trong s√°u th√°ng, nh∆∞ng h·ªç s·∫Ω ƒë·∫øn xem t√¥i h√°t n√™n m·ªçi chuy·ªán v·∫´n ·ªïn.</div>
            </div>

            <div class="glossary-wrapper">
                <h3 class="glossary-title">üìö Magical Vocabulary (B1-C2)</h3>
                <table>
                    <thead>
                        <tr>
                            <th>T·ª´ v·ª±ng</th>
                            <th>Lo·∫°i t·ª´</th>
                            <th>Nghƒ©a Ti·∫øng Vi·ªát</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr><td>1. Centre</td><td>Noun (Danh t·ª´)</td><td>Trung t√¢m</td></tr>
                        <tr><td>2. Sightseeing</td><td>Noun (Danh t·ª´)</td><td>S·ª± tham quan, ng·∫Øm c·∫£nh</td></tr>
                        <tr><td>3. Prefer (+ to V/ V-ing)</td><td>Verb (ƒê·ªông t·ª´)</td><td>Th√≠ch ... h∆°n</td></tr>
                        <tr><td>4. Traffic</td><td>Noun (Danh t·ª´)</td><td>Giao th√¥ng, l∆∞·ª£ng xe c·ªô</td></tr>
                        <tr><td>5. Exhibition</td><td>Noun (Danh t·ª´)</td><td>Cu·ªôc tri·ªÉn l√£m</td></tr>
                        <tr><td>6. Amazing</td><td>Adjective (T√≠nh t·ª´)</td><td>Kinh ng·∫°c, tuy·ªát v·ªùi (B1)</td></tr>
                        <tr><td>7. Explore</td><td>Verb (ƒê·ªông t·ª´)</td><td>Kh√°m ph√°, th√°m hi·ªÉm (B1)</td></tr>
                        <tr><td>8. Career</td><td>Noun (Danh t·ª´)</td><td>S·ª± nghi·ªáp</td></tr>
                        <tr><td>9. Whatever</td><td>Pronoun (ƒê·∫°i t·ª´)</td><td>B·∫•t c·ª© ƒëi·ªÅu g√¨ / B·∫•t k·ªÉ</td></tr>
                        <tr><td>10. On tour</td><td>Phrase (C·ª•m t·ª´)</td><td>ƒêi l∆∞u di·ªÖn</td></tr>
                    </tbody>
                </table>
            </div>
        </div>

        <div class="panel right-panel">
            <div id="quiz-container">
                </div>
            <button class="btn-submit" onclick="submitQuiz()">üéâ N·ªòP B√ÄI TH√îI! üéâ</button>
        </div>
    </div>

    <div id="result-modal">
        <div class="modal-content">
            <h2 style="color: var(--primary); font-size: 2rem; margin-bottom: 20px;">K·∫æT QU·∫¢ C·ª¶A B·∫†N</h2>
            <div class="score-circle" id="final-score">0/5</div>
            <h3 id="feedback-msg" style="color: #2c3e50; margin-bottom: 20px; font-size: 1.5rem;"></h3>
            <p style="color: #7f8c8d; margin-bottom: 30px;">Nh·ªõ xem l·∫°i c√°c c√¢u sai ·ªü ph·∫ßn gi·∫£i th√≠ch si√™u chi ti·∫øt nh√©!</p>
            <button class="btn-action btn-start" onclick="location.reload()" style="width: 100%;">L√ÄM L·∫†I B√ÄI</button>
        </div>
    </div>

    <script>
        // --- 1. QUIZ DATA & LOGIC ---
        const quizData = [
            {
                id: 1,
                question: "1. What does Charlotte love about the centre of London?",
                options: [
                    { text: "It is always busy.", isCorrect: true, label: "A" },
                    { text: "Famous people often visit.", isCorrect: false, label: "B" },
                    { text: "The shops are very good.", isCorrect: false, label: "C" }
                ],
                explanation: `
                    <h4>Ph√¢n t√≠ch chi ti·∫øt C√¢u 1:</h4>
                    <ul>
                        <li><strong>D·ªãch c√¢u h·ªèi:</strong> Charlotte y√™u th√≠ch ƒëi·ªÅu g√¨ ·ªü trung t√¢m Lu√¢n ƒê√¥n?</li>
                        <li><strong>T·∫°i sao ch·ªçn ƒë√°p √°n ƒë√∫ng:</strong> D·ª±a v√†o c√¢u trong b√†i: <span class="highlight">"I love it because there‚Äôs always something happening and there are people around whatever time it is."</span> (T√¥i y√™u n∆°i n√†y v√¨ lu√¥n c√≥ c√°c s·ª± ki·ªán di·ªÖn ra v√† lu√¥n c√≥ ng∆∞·ªùi xung quanh b·∫•t k·ªÉ l√† l√∫c n√†o). ƒêi·ªÅu n√†y ƒë·ªìng nghƒ©a v·ªõi vi·ªác n∆°i ƒë√¢y "always busy" (lu√¥n b·∫≠n r·ªôn/t·∫•p n·∫≠p).</li>
                        <li><strong>Lo·∫°i c√°c ƒë√°p √°n sai:</strong>
                            <br>- B (Ng∆∞·ªùi n·ªïi ti·∫øng th∆∞·ªùng gh√© thƒÉm): Sai. B√†i ƒë·ªçc c√≥ n√≥i ng∆∞·ªùi n·ªïi ti·∫øng th√≠ch n∆°i n√†y, nh∆∞ng <b>KH√îNG</b> ph·∫£i l√† l√Ω do Charlotte y√™u n√≥.
                            <br>- C (C√°c c·ª≠a h√†ng r·∫•t tuy·ªát): Sai. C√¥ ·∫•y n√≥i ng∆∞·ªùi n·ªïi ti·∫øng ƒë·∫øn v√¨ c·ª≠a h√†ng, ch·ª© kh√¥ng ph·∫£i l√Ω do c·ªßa b·∫£n th√¢n c√¥ ·∫•y.
                        </li>
                    </ul>
                `
            },
            {
                id: 2,
                question: "2. How does Charlotte feel about the singing lessons she had?",
                options: [
                    { text: "She‚Äôs surprised she can remember them.", isCorrect: false, label: "A" },
                    { text: "She‚Äôs sorry she didn‚Äôt try harder.", isCorrect: false, label: "B" },
                    { text: "She‚Äôs glad she did them.", isCorrect: true, label: "C" }
                ],
                explanation: `
                    <h4>Ph√¢n t√≠ch chi ti·∫øt C√¢u 2:</h4>
                    <ul>
                        <li><strong>D·ªãch c√¢u h·ªèi:</strong> Charlotte c·∫£m th·∫•y th·∫ø n√†o v·ªÅ nh·ªØng b√†i h·ªçc h√°t m√† c√¥ t·ª´ng h·ªçc?</li>
                        <li><strong>T·∫°i sao ch·ªçn ƒë√°p √°n ƒë√∫ng:</strong> D·ª±a v√†o c√¢u: <span class="highlight">"...I learned a lot of things that have helped me in my career."</span> (...t√¥i ƒë√£ h·ªçc ƒë∆∞·ª£c r·∫•t nhi·ªÅu ƒëi·ªÅu gi√∫p √≠ch cho s·ª± nghi·ªáp c·ªßa m√¨nh). Vi·ªác h·ªçc ƒë∆∞·ª£c k·ªπ nƒÉng gi√∫p √≠ch cho s·ª± nghi·ªáp ch·ª©ng t·ªè c√¥ ·∫•y r·∫•t vui/h√†i l√≤ng v√¨ ƒë√£ h·ªçc ("glad she did them").</li>
                        <li><strong>Lo·∫°i c√°c ƒë√°p √°n sai:</strong>
                            <br>- A (Ng·∫°c nhi√™n v√¨ c√≤n nh·ªõ): Sai. C√¥ ·∫•y ch·ªâ n√≥i b√†i h√°t kh√≥ h·ªçc ch·ª© kh√¥ng n√≥i ng·∫°c nhi√™n v√¨ nh·ªõ ƒë∆∞·ª£c.
                            <br>- B (Ti·∫øc v√¨ kh√¥ng c·ªë g·∫Øng h∆°n): Sai. M·∫∑c d√π ban ƒë·∫ßu s·ª£ gi√°o vi√™n v√† b√†i kh√≥, nh∆∞ng c√¥ ·∫•y ƒë√£ h·ªçc ƒë∆∞·ª£c nhi·ªÅu ƒëi·ªÅu ch·ª© kh√¥ng h·ªÅ h·ªëi ti·∫øc.
                        </li>
                    </ul>
                `
            },
            {
                id: 3,
                question: "3. What does Charlotte think is the best way to see the city?",
                options: [
                    { text: "by car", isCorrect: false, label: "A" },
                    { text: "on foot", isCorrect: true, label: "B" },
                    { text: "by bus", isCorrect: false, label: "C" }
                ],
                explanation: `
                    <h4>Ph√¢n t√≠ch chi ti·∫øt C√¢u 3:</h4>
                    <ul>
                        <li><strong>D·ªãch c√¢u h·ªèi:</strong> Charlotte nghƒ© c√°ch t·ªët nh·∫•t ƒë·ªÉ ng·∫Øm th√†nh ph·ªë l√† g√¨?</li>
                        <li><strong>T·∫°i sao ch·ªçn ƒë√°p √°n ƒë√∫ng:</strong> Trong b√†i vi·∫øt: <span class="highlight">"You can get a bus around the city, but we prefer to walk."</span> (...nh∆∞ng ch√∫ng t√¥i th√≠ch ƒëi b·ªô h∆°n). "Walk" ch√≠nh l√† "on foot" (ƒëi b·ªô).</li>
                        <li><strong>Lo·∫°i c√°c ƒë√°p √°n sai:</strong>
                            <br>- A (b·∫±ng √¥ t√¥): Sai. C√¥ ·∫•y th√≠ch l√°i xe, nh∆∞ng ƒë∆∞·ªùng qu√° ƒë√¥ng (too much traffic) v√† kh√≥ t√¨m ch·ªó ƒë·ªó (hard to find parking spaces).
                            <br>- C (b·∫±ng xe bu√Ωt): Sai. C√¥ ·∫•y c√≥ nh·∫Øc ƒë·∫øn xe bu√Ωt, nh∆∞ng nh·∫•n m·∫°nh r·∫±ng m√¨nh th√≠ch ƒëi b·ªô h∆°n (prefer to walk).
                        </li>
                    </ul>
                `
            },
            {
                id: 4,
                question: "4. Why does Charlotte love the Natural History Museum?",
                options: [
                    { text: "She had a special experience there.", isCorrect: true, label: "A" },
                    { text: "She thinks the building is beautiful.", isCorrect: false, label: "B" },
                    { text: "She enjoys visiting the exhibitions.", isCorrect: false, label: "C" }
                ],
                explanation: `
                    <h4>Ph√¢n t√≠ch chi ti·∫øt C√¢u 4:</h4>
                    <ul>
                        <li><strong>D·ªãch c√¢u h·ªèi:</strong> T·∫°i sao Charlotte l·∫°i y√™u th√≠ch B·∫£o t√†ng L·ªãch s·ª≠ T·ª± nhi√™n?</li>
                        <li><strong>T·∫°i sao ch·ªçn ƒë√°p √°n ƒë√∫ng:</strong> T√°c gi·∫£ k·ªÉ l·∫°i: <span class="highlight">"...last December my band and I played at one. I‚Äôll never forget it."</span> (Th√°ng 12 nƒÉm ngo√°i ban nh·∫°c c·ªßa t√¥i ƒë√£ bi·ªÉu di·ªÖn... T√¥i s·∫Ω kh√¥ng bao gi·ªù qu√™n). ƒê√¢y ch√≠nh l√† m·ªôt "special experience" (tr·∫£i nghi·ªám ƒë·∫∑c bi·ªát).</li>
                        <li><strong>Lo·∫°i c√°c ƒë√°p √°n sai:</strong>
                            <br>- B (T√≤a nh√† ƒë·∫πp): Sai. D√π c√¥ n√≥i "One building I love is...", nh∆∞ng c√¥ kh√¥ng h·ªÅ mi√™u t·∫£ v·∫ª ƒë·∫πp ki·∫øn tr√∫c c·ªßa n√≥ l√†m l√Ω do.
                            <br>- C (Th√≠ch ƒëi xem tri·ªÉn l√£m): Sai. C√¥ ·∫•y c√≥ ƒëi xem tri·ªÉn l√£m v·ªõi b·∫°n, nh∆∞ng m·ª•c ƒë√≠ch k·ªÉ ra l√† ƒë·ªÉ khoe/√¥n l·∫°i k·ª∑ ni·ªám di·ªÖn nh·∫°c t·ªëi h√¥m ƒë√≥, ch·ª© kh√¥ng ph·∫£i v√¨ th√≠ch b·∫£n th√¢n c√°c cu·ªôc tri·ªÉn l√£m.
                        </li>
                    </ul>
                `
            },
            {
                id: 5,
                question: "5. What does Charlotte say about going on tour with her band?",
                options: [
                    { text: "She hopes lots of people will buy tickets for her shows.", isCorrect: false, label: "A" },
                    { text: "She feels excited about seeing new places.", isCorrect: true, label: "B" },
                    { text: "She‚Äôs worried she‚Äôll miss her family.", isCorrect: false, label: "C" }
                ],
                explanation: `
                    <h4>Ph√¢n t√≠ch chi ti·∫øt C√¢u 5:</h4>
                    <ul>
                        <li><strong>D·ªãch c√¢u h·ªèi:</strong> Charlotte n√≥i g√¨ v·ªÅ chuy·∫øn l∆∞u di·ªÖn c√πng ban nh·∫°c?</li>
                        <li><strong>T·∫°i sao ch·ªçn ƒë√°p √°n ƒë√∫ng:</strong> D·ª±a v√†o c√¢u: <span class="highlight">"We‚Äôre playing in lots of new cities and I can‚Äôt wait to explore them."</span> (T√¥i r·∫•t n√≥ng l√≤ng ƒë∆∞·ª£c kh√°m ph√° ch√∫ng). C·ª•m "can't wait to" th·ªÉ hi·ªán s·ª± h√†o h·ª©ng (excited) v·ªÅ vi·ªác ƒë·∫øn nh·ªØng n∆°i m·ªõi (new places).</li>
                        <li><strong>Lo·∫°i c√°c ƒë√°p √°n sai:</strong>
                            <br>- A (Hy v·ªçng nhi·ªÅu ng∆∞·ªùi mua v√©): Sai. C√¥ ·∫•y n√≥i "We've sold lots of tickets" (Ch√∫ng t√¥i ƒê√É b√°n ƒë∆∞·ª£c nhi·ªÅu v√© r·ªìi).
                            <br>- C (Lo l·∫Øng nh·ªõ gia ƒë√¨nh): Sai. C√¥ ·∫•y n√≥i ph·∫£i ƒëi xa 6 th√°ng "but they're coming to see me sing, so it's fine" (nh∆∞ng h·ªç s·∫Ω ƒë·∫øn xem t√¥i h√°t, n√™n m·ªçi chuy·ªán ·ªîN). T·ª©c l√† kh√¥ng h·ªÅ lo l·∫Øng.
                        </li>
                    </ul>
                `
            }
        ];

        let score = 0;
        let answeredQuestions = new Set();

        // X√°o tr·ªôn m·∫£ng (Shuffle array)
        function shuffleArray(array) {
            for (let i = array.length - 1; i > 0; i--) {
                const j = Math.floor(Math.random() * (i + 1));
                [array[i], array[j]] = [array[j], array[i]];
            }
            return array;
        }

        // Render c√¢u h·ªèi
        function renderQuiz() {
            const container = document.getElementById('quiz-container');
            container.innerHTML = '';

            quizData.forEach((q, index) => {
                // X√°o tr·ªôn ƒë√°p √°n tr∆∞·ªõc khi hi·ªÉn th·ªã
                const shuffledOptions = shuffleArray([...q.options]);

                const card = document.createElement('div');
                card.className = 'question-card';
                card.id = `question-${index}`;

                const questionText = document.createElement('div');
                questionText.className = 'question-text';
                questionText.innerText = q.question;
                card.appendChild(questionText);

                const optionsGrid = document.createElement('div');
                optionsGrid.className = 'options-grid';

                shuffledOptions.forEach(opt => {
                    const btn = document.createElement('button');
                    btn.className = 'option-btn';
                    // Hi·ªÉn th·ªã ƒë·∫ßy ƒë·ªß ch·ªØ thay v√¨ ch·ªâ A, B, C
                    btn.innerHTML = `<span>${opt.text}</span>`;
                    
                    btn.onclick = () => handleAnswer(btn, opt.isCorrect, index, q.explanation, optionsGrid);
                    optionsGrid.appendChild(btn);
                });

                card.appendChild(optionsGrid);

                // H·ªôp gi·∫£i th√≠ch (·∫©n ƒëi ban ƒë·∫ßu)
                const explBox = document.createElement('div');
                explBox.className = 'explanation-box';
                explBox.id = `expl-${index}`;
                explBox.innerHTML = q.explanation;
                card.appendChild(explBox);

                container.appendChild(card);
            });
        }

        // --- 2. T∆Ø∆†NG T√ÅC √ÇM THANH & HI·ªÜU ·ª®NG ---
        const AudioContext = window.AudioContext || window.webkitAudioContext;
        let audioCtx;

        function initAudio() {
            if (!audioCtx) audioCtx = new AudioContext();
            if (audioCtx.state === 'suspended') audioCtx.resume();
        }

        function playSound(type) {
            initAudio();
            const osc = audioCtx.createOscillator();
            const gainNode = audioCtx.createGain();
            osc.connect(gainNode);
            gainNode.connect(audioCtx.destination);

            if (type === 'correct') {
                osc.type = 'sine';
                osc.frequency.setValueAtTime(523.25, audioCtx.currentTime); // C5
                osc.frequency.exponentialRampToValueAtTime(880, audioCtx.currentTime + 0.1);
                gainNode.gain.setValueAtTime(0.5, audioCtx.currentTime);
                gainNode.gain.exponentialRampToValueAtTime(0.01, audioCtx.currentTime + 0.5);
                osc.start();
                osc.stop(audioCtx.currentTime + 0.5);
            } else {
                // Wrong sound: T√©o t√®o t√®o
                osc.type = 'sawtooth';
                osc.frequency.setValueAtTime(150, audioCtx.currentTime);
                osc.frequency.linearRampToValueAtTime(100, audioCtx.currentTime + 0.3);
                gainNode.gain.setValueAtTime(0.5, audioCtx.currentTime);
                gainNode.gain.exponentialRampToValueAtTime(0.01, audioCtx.currentTime + 0.3);
                osc.start();
                osc.stop(audioCtx.currentTime + 0.3);
            }
        }

        function handleAnswer(btn, isCorrect, qIndex, explanationHTML, grid) {
            if (answeredQuestions.has(qIndex)) return; // Kh√¥ng cho click l·∫°i

            answeredQuestions.add(qIndex);
            initAudio();

            // Disable t·∫•t c·∫£ c√°c n√∫t trong c√¢u n√†y
            const allBtns = grid.querySelectorAll('.option-btn');
            allBtns.forEach(b => b.disabled = true);

            if (isCorrect) {
                btn.classList.add('correct');
                playSound('correct');
                fireConfetti();
                score++;
            } else {
                btn.classList.add('wrong');
                btn.classList.add('shake');
                playSound('wrong');
                
                // Hi·ªÉn th·ªã ƒë√°p √°n ƒë√∫ng
                quizData[qIndex].options.forEach(opt => {
                    if (opt.isCorrect) {
                        Array.from(allBtns).forEach(b => {
                            if (b.innerText === opt.text) {
                                b.classList.add('correct');
                                b.style.opacity = '0.7';
                            }
                        });
                    }
                });

                // Hi·ªán gi·∫£i th√≠ch chi ti·∫øt ngay l·∫≠p t·ª©c
                document.getElementById(`expl-${qIndex}`).style.display = 'block';
            }
        }

        // --- 3. ƒê·∫æM NG∆Ø·ª¢C TH·ªúI GIAN ---
        let timerInterval;
        let timeLeft = 600; // 10 minutes
        let isTimerRunning = false;

        function updateTimerDisplay() {
            const m = Math.floor(timeLeft / 60);
            const s = timeLeft % 60;
            document.getElementById('timer-display').innerText = `${m.toString().padStart(2, '0')}:${s.toString().padStart(2, '0')}`;
        }

        function toggleTimer() {
            const btn = document.getElementById('btn-timer');
            if (isTimerRunning) {
                clearInterval(timerInterval);
                btn.innerText = "TI·∫æP T·ª§C L√ÄM B√ÄI";
                btn.style.backgroundColor = "#FDCB6E";
            } else {
                btn.innerText = "T·∫†M D·ª™NG";
                btn.style.backgroundColor = "#e74c3c";
                btn.style.color = "white";
                timerInterval = setInterval(() => {
                    timeLeft--;
                    updateTimerDisplay();
                    if (timeLeft <= 0) {
                        clearInterval(timerInterval);
                        alert("‚è∞ ƒê√£ h·∫øt gi·ªù l√†m b√†i! B·∫°n v·∫´n c√≥ th·ªÉ ti·∫øp t·ª•c l√†m, nh∆∞ng nh·ªõ l√† trong ph√≤ng thi th·∫≠t, b·∫°n ch·ªâ n√™n l√†m m·ªôt b√†i nh∆∞ th·∫ø n√†y trong 10 ph√∫t th√¥i nha.");
                    }
                }, 1000);
            }
            isTimerRunning = !isTimerRunning;
        }

        // --- 4. T√çNH NƒÇNG D·ªäCH THU·∫¨T ---
        function toggleTranslation(btn) {
            const translationDiv = btn.nextElementSibling;
            if (translationDiv.style.display === 'block') {
                translationDiv.style.display = 'none';
                btn.innerText = "B·∫¢N D·ªäCH ƒê·∫¶Y ƒê·ª¶";
            } else {
                translationDiv.style.display = 'block';
                btn.innerText = "ƒê√ìNG B·∫¢N D·ªäCH";
            }
        }

        // --- 5. N·ªòP B√ÄI & T·ªîNG K·∫æT ---
        function submitQuiz() {
            if (answeredQuestions.size < quizData.length) {
                const cf = confirm("B·∫°n ch∆∞a l√†m h·∫øt c√°c c√¢u h·ªèi. B·∫°n c√≥ ch·∫Øc ch·∫Øn mu·ªën n·ªôp b√†i kh√¥ng?");
                if (!cf) return;
            }

            clearInterval(timerInterval); // D·ª´ng th·ªùi gian
            const modal = document.getElementById('result-modal');
            const scoreDisplay = document.getElementById('final-score');
            const feedbackMsg = document.getElementById('feedback-msg');

            scoreDisplay.innerText = `${score}/${quizData.length}`;
            
            if (score === 5) {
                feedbackMsg.innerText = "üèÜ THI√äN T√ÄI READING ƒê√ÇY R·ªíI! üèÜ\nEm l√†m xu·∫•t s·∫Øc l·∫Øm!";
                for(let i=0; i<3; i++) setTimeout(fireConfetti, i*300);
            } else if (score >= 3) {
                feedbackMsg.innerText = "‚ú® L√ÄM T·ªêT L·∫ÆM! ‚ú®\nCh·ªâ c·∫ßn c·∫©n th·∫≠n ch√∫t x√≠u n·ªØa l√† ho√†n h·∫£o!";
                fireConfetti();
            } else {
                feedbackMsg.innerText = "üí™ C·ªê L√äN NH√â! üí™\nH√£y ƒë·ªçc k·ªπ ph·∫ßn gi·∫£i th√≠ch chi ti·∫øt ƒë·ªÉ r√∫t kinh nghi·ªám nha!";
            }

            modal.style.display = 'flex';
        }

        // --- 6. HI·ªÜU ·ª®NG PH√ÅO GI·∫§Y (CONFETTI) ---
        const canvas = document.getElementById('confetti-canvas');
        const ctx = canvas.getContext('2d');
        canvas.width = window.innerWidth;
        canvas.height = window.innerHeight;

        let confettis = [];
        const colors = ['#00D26A', '#FDCB6E', '#FF4757', '#00C9A7', '#8854C0'];

        function fireConfetti() {
            for (let i = 0; i < 100; i++) {
                confettis.push({
                    x: canvas.width / 2,
                    y: canvas.height / 2 + 100,
                    r: Math.random() * 6 + 4,
                    dx: Math.random() * 10 - 5,
                    dy: Math.random() * -15 - 5,
                    color: colors[Math.floor(Math.random() * colors.length)],
                    tilt: Math.floor(Math.random() * 10) - 10,
                    tiltAngleInc: (Math.random() * 0.07) + 0.05,
                    tiltAngle: 0
                });
            }
            if(confettis.length <= 100) animateConfetti();
        }

        function animateConfetti() {
            requestAnimationFrame(animateConfetti);
            ctx.clearRect(0, 0, canvas.width, canvas.height);
            
            confettis.forEach((c, index) => {
                c.tiltAngle += c.tiltAngleInc;
                c.y += (Math.cos(c.tiltAngle) + 1 + c.r / 2) / 2;
                c.x += Math.sin(c.tiltAngle) * 2;
                c.dy += 0.2; // gravity
                c.y += c.dy;

                ctx.beginPath();
                ctx.lineWidth = c.r;
                ctx.strokeStyle = c.color;
                ctx.moveTo(c.x + c.tilt + c.r, c.y);
                ctx.lineTo(c.x + c.tilt, c.y + c.tilt + c.r);
                ctx.stroke();

                if (c.y > canvas.height) confettis.splice(index, 1);
            });
        }

        // Resize canvas on window resize
        window.addEventListener('resize', () => {
            canvas.width = window.innerWidth;
            canvas.height = window.innerHeight;
        });

        // Kh·ªüi t·∫°o b√†i khi t·∫£i trang
        window.onload = () => {
            renderQuiz();
        };
    </script>
</body>
</html>