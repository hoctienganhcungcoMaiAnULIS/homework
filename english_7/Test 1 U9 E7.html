<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Unit 9: Festivals Around The World - Ms Mai An ULIS</title>
    <style>
        :root {
            --primary: #0056b3;
            --secondary: #004494;
            --success: #28a745;
            --danger: #dc3545;
            --warning: #ffc107;
            --light: #f8f9fa;
            --dark: #343a40;
            --shadow: 0 4px 6px rgba(0,0,0,0.1);
            --font-main: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        }

        * { box-sizing: border-box; }

        body {
            font-family: var(--font-main);
            background-color: #f0f2f5;
            color: var(--dark);
            margin: 0;
            padding-bottom: 80px; /* Space for footer */
            line-height: 1.6;
        }

        .container {
            max-width: 800px;
            margin: 0 auto;
            padding: 20px;
        }

        /* HEADER */
        header {
            text-align: center;
            margin-bottom: 30px;
            background: white;
            padding: 20px;
            border-radius: 10px;
            box-shadow: var(--shadow);
            border-top: 5px solid var(--primary);
        }

        h1 { color: var(--primary); margin: 0; font-size: 1.8rem; }
        h2 { color: #666; font-size: 1rem; font-weight: normal; margin-top: 5px; }
        .test-info { font-weight: bold; margin-top: 10px; color: var(--secondary); }

        /* CARDS & SECTIONS */
        .section-title {
            background: var(--primary);
            color: white;
            padding: 10px 15px;
            border-radius: 5px;
            margin-top: 30px;
            margin-bottom: 15px;
            font-size: 1.1rem;
            font-weight: 600;
        }

        .question-card {
            background: white;
            border-radius: 8px;
            padding: 20px;
            margin-bottom: 20px;
            box-shadow: var(--shadow);
            border-left: 4px solid transparent;
            transition: all 0.3s ease;
        }

        .question-card:hover { transform: translateY(-2px); }

        .q-text { font-weight: 600; margin-bottom: 15px; font-size: 1.05rem; }
        .q-number { color: var(--primary); margin-right: 5px; }

        /* OPTIONS */
        .options-grid {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 10px;
        }
        
        @media (max-width: 600px) {
            .options-grid { grid-template-columns: 1fr; }
        }

        .option {
            padding: 10px 15px;
            border: 1px solid #ddd;
            border-radius: 5px;
            cursor: pointer;
            transition: all 0.2s;
            display: flex;
            align-items: center;
        }

        .option:hover { background-color: #e9ecef; }
        .option.selected { background-color: #cce5ff; border-color: var(--primary); font-weight: 500; }
        
        /* FEEDBACK STATES */
        .correct-answer { background-color: #d4edda !important; border-color: var(--success) !important; color: #155724; }
        .wrong-answer { background-color: #f8d7da !important; border-color: var(--danger) !important; color: #721c24; }
        
        /* DATA BOX (READING) */
        .data-box {
            background-color: #fff;
            border: 1px solid #dee2e6;
            border-left: 5px solid var(--warning);
            padding: 20px;
            margin-bottom: 20px;
            border-radius: 5px;
            font-family: 'Georgia', serif; /* Serif for reading passages */
            font-size: 1.05rem;
        }

        /* GAP FILL LAYOUT */
        .gap-fill-wrapper {
            background: white;
            padding: 15px;
            border-radius: 8px;
            box-shadow: var(--shadow);
            margin-bottom: 20px;
        }
        .gf-options-box {
            background: #e9ecef;
            padding: 15px;
            border-radius: 5px;
            margin-bottom: 15px;
            font-weight: bold;
            color: var(--secondary);
        }
        .gf-text-box {
            line-height: 1.8;
            margin-bottom: 20px;
            font-size: 1.05rem;
        }
        .gf-answer-area {
            display: grid;
            gap: 15px;
            border-top: 1px solid #eee;
            padding-top: 15px;
        }

        /* GLOSSARY */
        .glossary {
            margin-top: 15px;
            border-collapse: collapse;
            width: 100%;
            font-size: 0.9rem;
        }
        .glossary th, .glossary td {
            border: 1px solid #ddd;
            padding: 8px;
            text-align: left;
        }
        .glossary th { background-color: #f2f2f2; color: var(--primary); }

        /* EXPLANATION */
        .explanation {
            display: none;
            margin-top: 15px;
            padding: 15px;
            background-color: #f1f8ff;
            border-radius: 5px;
            border: 1px dashed var(--primary);
            font-size: 0.95rem;
        }
        .expl-title { font-weight: bold; color: var(--primary); margin-bottom: 5px; display: block; }
        .expl-detail { margin-bottom: 5px; }
        .trans { color: #555; font-style: italic; }
        
        .badge {
            display: inline-block;
            padding: 2px 6px;
            font-size: 0.75rem;
            border-radius: 4px;
            margin-right: 5px;
            color: white;
        }
        .bg-n { background: #17a2b8; } /* Noun */
        .bg-v { background: #28a745; } /* Verb */
        .bg-adj { background: #fd7e14; } /* Adj */
        .bg-adv { background: #6f42c1; } /* Adv */

        /* BUTTONS */
        .btn-check {
            margin-top: 10px;
            padding: 8px 16px;
            background-color: var(--secondary);
            color: white;
            border: none;
            border-radius: 4px;
            cursor: pointer;
            font-size: 0.9rem;
        }
        .btn-check:hover { background-color: var(--primary); }

        /* STICKY FOOTER */
        .footer-bar {
            position: fixed;
            bottom: 0;
            left: 0;
            width: 100%;
            background: white;
            box-shadow: 0 -2px 10px rgba(0,0,0,0.1);
            padding: 15px;
            display: flex;
            justify-content: space-between;
            align-items: center;
            z-index: 100;
        }
        
        .btn-submit {
            background: var(--primary);
            color: white;
            border: none;
            padding: 12px 30px;
            font-size: 1.1rem;
            border-radius: 30px;
            font-weight: bold;
            cursor: pointer;
            box-shadow: 0 4px 10px rgba(0,86,179,0.3);
            transition: transform 0.2s;
        }
        .btn-submit:hover { transform: scale(1.05); }
        .score-display { font-size: 1.2rem; font-weight: bold; color: var(--dark); display: none; }

        /* CSS DRAWINGS FOR IMAGES (Q29, Q30) */
        .sale-sign {
            width: 100%;
            max-width: 300px;
            background: #e6f2ff;
            padding: 20px;
            text-align: center;
            border: 1px solid #b3d7ff;
            margin: 10px auto;
            box-shadow: 2px 2px 5px rgba(0,0,0,0.1);
        }
        .sale-header { color: #0056b3; font-weight: bold; font-size: 1.2rem; margin-bottom: 10px; }
        .sale-text { font-size: 0.9rem; margin-bottom: 5px; }
        .sale-note { font-style: italic; color: #555; font-size: 0.85rem; margin-top: 10px; }

        .phone-frame {
            width: 280px;
            background: #222;
            border-radius: 20px;
            padding: 40px 10px 40px 10px;
            margin: 10px auto;
            color: #333;
        }
        .phone-screen {
            background: white;
            border-radius: 5px;
            padding: 15px;
            font-family: sans-serif;
            min-height: 200px;
            position: relative;
        }
        .sms-bubble {
            background: #e9e9eb; /* iOS gray */
            padding: 10px;
            border-radius: 15px;
            font-size: 0.9rem;
            line-height: 1.3;
        }

    </style>
</head>
<body>

<div class="container">
    <header>
        <h1>ENGLISH ONLINE TEST</h1>
        <h2>Ms Mai An ULIS</h2>
        <div class="test-info">UNIT 9: FESTIVAL AROUND THE WORLD - TEST 01</div>
    </header>

    <div class="section-title">PHONETICS</div>
    <div id="phonetics-area"></div>

    <div class="section-title">STRESS</div>
    <div id="stress-area"></div>

    <div class="section-title">GRAMMAR & VOCABULARY</div>
    <div id="grammar-area"></div>

    <div class="section-title">READING 1: GAP FILL</div>
    <div class="data-box">
        <h3 style="text-align: center; color: var(--primary);">SPRING FESTIVAL INVITATION</h3>
        <p>The town’s Cultural Department is (13) _____ to host a wonderful Spring Festival next weekend.</p>
        <p>Details include:</p>
        <ul>
            <li>The festival will (14) _____ at the central park.</li>
            <li>Activities include music, games, and (15) _____ performances by local artists.</li>
            <li>Entrance is free, (16) _____ all visitors must attend beforehand.</li>
        </ul>
        
        <table class="glossary">
            <tr><th colspan="2">Vocabulary Glossary</th></tr>
            <tr><td><b>Host</b> (v)</td><td>Đăng cai, tổ chức</td></tr>
            <tr><td><b>Performance</b> (n)</td><td>Màn trình diễn</td></tr>
        </table>
    </div>
    <div id="reading1-area"></div>

    <div class="section-title">SENTENCE ARRANGEMENT & COMPREHENSION</div>
    <div id="arrangement-area"></div>

    <div class="section-title">READING 2: SONGKRAN FESTIVAL</div>
    <div class="data-box">
        <p>Songkran is a water festival to mark the beginning of the New Year in the Thai Buddhist calendar. Although the festival (19) _____ on April 13 and usually lasts three days, festivities can start earlier than that.</p>
        <p>Water plays a major (20) _____ in the festival. Water is the symbol of power (21) _____ it washes away the (22) _____ year and gets people ready for the new year. People use water to clean homes. They also pour water on Buddha statues and the hands of elders. In the street, there is a giant (23) _____ water fight with people throwing buckets of water at each other.</p>
        <p>Songkran is also a time for family reunions. Many Thai people travel home for the holiday, (24) _____ with their family, and enjoy water events in their hometown.</p>
        
        <table class="glossary">
            <tr><th colspan="2">Vocabulary Glossary</th></tr>
            <tr><td><b>Festivity</b> (n)</td><td>Hoạt động lễ hội</td></tr>
            <tr><td><b>Symbol</b> (n)</td><td>Biểu tượng</td></tr>
            <tr><td><b>Statue</b> (n)</td><td>Bức tượng</td></tr>
            <tr><td><b>Reunion</b> (n)</td><td>Sự đoàn tụ</td></tr>
        </table>
    </div>
    <div id="reading2-area"></div>

    <div class="section-title">SENTENCE TRANSFORMATION</div>
    <div id="writing-area"></div>

    <div class="section-title">VISUAL COMPREHENSION</div>
    
    <div class="question-card" id="q29-card">
        <div class="q-text">
            <span class="q-number">Question 29:</span> Which of the following items is NOT included in the half-price sale?
        </div>
        <div class="sale-sign">
            <div class="sale-header">Summer Sale</div>
            <div class="sale-text">All clothes are half-price.</div>
            <div class="sale-text" style="font-weight:bold; color:red;">Today only!</div>
            <div class="sale-note">The sale doesn't include shoes.</div>
        </div>
        <div class="options-grid" id="opts-29">
            </div>
        <button class="btn-check" onclick="checkSingleQuestion(28)">Kiểm tra</button> <div class="explanation" id="expl-28"></div>
    </div>

    <div class="question-card" id="q30-card">
        <div class="q-text">
            <span class="q-number">Question 30:</span> What is Gemma asking Simon to do?
        </div>
        <div class="phone-frame">
            <div class="phone-screen">
                <div class="sms-bubble">
                    <b>Simon,</b><br>
                    Don't forget to bring that book I lent you to school tomorrow.<br>
                    It was so good I want to read it again.<br>
                    <b>Gemma</b>
                </div>
            </div>
        </div>
        <div class="options-grid" id="opts-30">
            </div>
        <button class="btn-check" onclick="checkSingleQuestion(29)">Kiểm tra</button>
        <div class="explanation" id="expl-29"></div>
    </div>

    <div class="section-title">READING 3: COMPREHENSION</div>
    <div class="data-box">
        <h4 style="margin-top:0;">The Pacific Rim Whale Festival</h4>
        <p>Every year, about 20,000 grey whales swim past the west coast of Vancouver Island. The whales travel from Mexico to the Arctic and back again. The whole trip is about 16,000 kilometres. Every March, the people who live around the Pacific Rim National Park have a festival to celebrate the whales’ journey. The festival is the Pacific Rim Whale Festival. The whales travel very close to the shore as they swim north. This allows people to gather together to watch the whales from land and from boats.</p>
        
        <h4>Nanaimo Bathtub Race</h4>
        <p>On the east coast of Vancouver Island, you can see people moving through the water in a strange type of boat. In the Nanaimo Bathtub Race, all the boats are made from bathtubs. The city of Nanaimo is home to the oldest and most famous bathtub boat race in the world. Today, Nanaimo World Championship Bathtub Race is a serious sport that attracts many racers and visitors from around the world.</p>
        
        <table class="glossary">
            <tr><th colspan="2">Vocabulary Glossary</th></tr>
            <tr><td><b>Coast</b> (n)</td><td>Bờ biển</td></tr>
            <tr><td><b>Arctic</b> (n)</td><td>Bắc Cực</td></tr>
            <tr><td><b>Shore</b> (n)</td><td>Bờ (biển, hồ)</td></tr>
            <tr><td><b>Bathtub</b> (n)</td><td>Bồn tắm</td></tr>
        </table>
    </div>
    <div id="reading3-area"></div>

    <div class="section-title">READING 4: SENTENCE INSERTION</div>
    <div class="gap-fill-wrapper">
        <div class="gf-options-box">
            <p>A – This is what is meant by a “White Christmas”</p>
            <p>B – but live where it is warm</p>
            <p>C – All these are Christmas traditions</p>
            <p>D – Hundreds of singers and musicians have recorded it</p>
        </div>
        
        <div class="gf-text-box">
            Christmas is almost here. Holiday music fills the air. Colourful lights shine brightly in windows. The stores are crowded with people buying last-minute gifts. <b>(37) _____</b>. Another tradition is snow. Christmas in the northern part of the world comes a few days after the start of winter. So, in many places, a blanket of clean white snow covers the ground on Christmas Day. <b>(38) _____</b>.<br><br>
            Of course, many places do not get snow in December. In fact, they may be very warm at that time of year. People who like snow – <b>(39) _____</b> - dream of having a white Christmas. American songwriter Irving Berlin captured these feelings in his song “White Christmas”. “White Christmas” is one of the most popular songs of all times. <b>(40) _____</b> . Perhaps the most famous version was sung by Bing Crosby. Songwriter Irving Berlin was Jewish. He did not celebrate Christmas as a religious holiday. But in his Christmas song, he shares a message of peace and happiness which all people can joy.
            <br><br>So from all of us - to all of you - we wish the happiest and most joyful holiday.
        </div>
        
        <div id="gap-fill-questions" class="gf-answer-area">
            </div>
    </div>

</div>

<div class="footer-bar">
    <div id="result-text">Total Questions: 40</div>
    <button class="btn-submit" onclick="submitAll()">NỘP BÀI (SUBMIT)</button>
</div>

<script>
    // --- DATA ---
    const quizData = [
        // PHONETICS (1-2)
        {
            id: 1, type: 'mcq', q: 'Choose the word whose underlined part differs from the other three in pronunciation.',
            options: [
                { text: 'A. decor<u>a</u>te', correct: false },
                { text: 'B. d<u>a</u>nce', correct: false },
                { text: 'C. chocol<u>a</u>te', correct: true },
                { text: 'D. par<u>a</u>de', correct: false }
            ],
            expl: '<b>Đáp án C.</b><br>A. decor<u>a</u>te /ˈdekəreɪt/ (âm /eɪ/)<br>B. d<u>a</u>nce /dɑːns/ (Anh-Anh) hoặc /dæns/ (Anh-Mỹ) (âm /ɑː/ hoặc /æ/) - Tuy nhiên trong các bài thi thường phân biệt âm /eɪ/ với các âm khác. Ở đây từ Chocolate có âm "ate" đọc là /ət/.<br>C. chocol<u>a</u>te /ˈtʃɒklət/ (âm /ə/)<br>D. par<u>a</u>de /pəˈreɪd/ (âm /eɪ/)<br>=> Phần gạch chân (đuôi -ate hoặc âm a) của C được phát âm là /ə/, các từ còn lại (A, D) là /eɪ/. Dance là ngoại lệ nhưng Chocolate rõ ràng nhất về sự biến âm của đuôi -ate.'
        },
        {
            id: 2, type: 'mcq', q: 'Choose the word whose underlined part differs from the other three in pronunciation.',
            options: [
                { text: 'A. g<u>i</u>ve', correct: false },
                { text: 'B. g<u>i</u>ft', correct: false },
                { text: 'C. f<u>i</u>rework', correct: true },
                { text: 'D. d<u>i</u>splay', correct: false }
            ],
            expl: '<b>Đáp án C.</b><br>A. g<u>i</u>ve /ɡɪv/ (âm /ɪ/)<br>B. g<u>i</u>ft /ɡɪft/ (âm /ɪ/)<br>C. f<u>i</u>rework /ˈfaɪəwɜːk/ (âm /aɪ/)<br>D. d<u>i</u>splay /dɪˈspleɪ/ (âm /ɪ/)<br>=> C đọc là /aɪ/, còn lại đọc là /ɪ/.'
        },
        // STRESS (3-4)
        {
            id: 3, type: 'mcq', q: 'Choose the word that differs from the other three in the position of primary stress.',
            options: [
                { text: 'A. decrease', correct: false },
                { text: 'B. estate', correct: false },
                { text: 'C. happen', correct: true },
                { text: 'D. today', correct: false }
            ],
            expl: '<b>Đáp án C.</b><br>A. decrease (v) /dɪˈkriːs/ (trọng âm 2)<br>B. estate (n) /ɪˈsteɪt/ (trọng âm 2)<br>C. happen (v) /ˈhæpən/ (trọng âm 1)<br>D. today (n/adv) /təˈdeɪ/ (trọng âm 2)<br>=> C trọng âm 1, còn lại trọng âm 2.'
        },
        {
            id: 4, type: 'mcq', q: 'Choose the word that differs from the other three in the position of primary stress.',
            options: [
                { text: 'A. criminal', correct: false },
                { text: 'B. average', correct: false },
                { text: 'C. skyscraper', correct: false },
                { text: 'D. physician', correct: true }
            ],
            expl: '<b>Đáp án D.</b><br>A. criminal /ˈkrɪmɪnl/ (trọng âm 1)<br>B. average /ˈævərɪdʒ/ (trọng âm 1)<br>C. skyscraper /ˈskaɪskreɪpər/ (trọng âm 1)<br>D. physician /fɪˈzɪʃn/ (trọng âm 2)<br>=> D trọng âm 2, còn lại trọng âm 1.'
        },
        // GRAMMAR (5-12)
        {
            id: 5, type: 'mcq', q: 'The festival is _________ every year at the end of October.',
            options: [
                { text: 'A. Taken', correct: false },
                { text: 'B. Held', correct: true },
                { text: 'C. Made', correct: false },
                { text: 'D. Done', correct: false }
            ],
            expl: '<b>Đáp án B. held</b><br>Cấu trúc: <i>to hold a festival</i> (tổ chức lễ hội).<br>Câu bị động: <i>is held</i> (được tổ chức).<br>Dịch: Lễ hội được tổ chức hàng năm vào cuối tháng 10.'
        },
        {
            id: 6, type: 'mcq', q: 'Festival of lights is a ________ festival in India.',
            options: [
                { text: 'A. Religion (n)', correct: false },
                { text: 'B. Culture (n)', correct: false },
                { text: 'C. Nation (n)', correct: false },
                { text: 'D. Religious (adj)', correct: true }
            ],
            expl: '<b>Đáp án D. religious</b><br>Vị trí trước danh từ "festival" cần một tính từ (Adjective).<br>A, B, C là danh từ.<br>D. Religious (thuộc về tôn giáo).<br>Dịch: Lễ hội ánh sáng là một lễ hội tôn giáo ở Ấn Độ.'
        },
        {
            id: 7, type: 'mcq', q: 'People _______the festival by throwing water to wish everyone happiness.',
            options: [
                { text: 'A. Celebrate', correct: true },
                { text: 'B. Have', correct: false },
                { text: 'C. Organize', correct: false },
                { text: 'D. Complete', correct: false }
            ],
            expl: '<b>Đáp án A. celebrate</b><br>Collocation: <i>Celebrate a festival</i> (Ăn mừng/kỷ niệm lễ hội).<br>Dịch: Mọi người ăn mừng lễ hội bằng cách tát nước để cầu chúc hạnh phúc.'
        },
        {
            id: 8, type: 'mcq', q: 'She wore a beautiful traditional ________.',
            options: [
                { text: 'A. Firework', correct: false },
                { text: 'B. Parade', correct: false },
                { text: 'C. Display', correct: false },
                { text: 'D. Costume', correct: true }
            ],
            expl: '<b>Đáp án D. costume</b><br>Cụm từ: <i>Traditional costume</i> (Trang phục truyền thống).<br>Dịch: Cô ấy mặc một bộ trang phục truyền thống xinh đẹp.'
        },
        {
            id: 9, type: 'mcq', q: '_____ they watch the fireworks display last night?',
            options: [
                { text: 'A. Will', correct: false },
                { text: 'B. Did', correct: true },
                { text: 'C. Can', correct: false },
                { text: 'D. Are', correct: false }
            ],
            expl: '<b>Đáp án B. Did</b><br>Dấu hiệu: "last night" (tối qua) -> Quá khứ đơn.<br>Câu hỏi nghi vấn động từ thường "watch" -> Mượn trợ động từ "Did".'
        },
        {
            id: 10, type: 'mcq', q: '______ the girl in the fitting room?',
            options: [
                { text: 'A. Do', correct: false },
                { text: 'B. Does', correct: false },
                { text: 'C. Are', correct: false },
                { text: 'D. Is', correct: true }
            ],
            expl: '<b>Đáp án D. Is</b><br>Chủ ngữ "the girl" là số ít.<br>Câu không có động từ thường, chỉ vị trí (in the fitting room) -> Dùng động từ to be "Is".'
        },
        {
            id: 11, type: 'mcq', q: '_________ the cats in the garden? – Yes, ______.',
            options: [
                { text: 'A. Is – it is', correct: false },
                { text: 'B. Are – the cats are', correct: false },
                { text: 'C. Are – they are', correct: true },
                { text: 'D. Do – they do', correct: false }
            ],
            expl: '<b>Đáp án C. Are – they are</b><br>"The cats" là số nhiều -> To be là "Are".<br>Trả lời ngắn: Yes, they are.'
        },
        {
            id: 12, type: 'mcq', q: 'Mark: “ Did you go anywhere last weekend, Trang?”<br>Trang: “ ___________.”',
            options: [
                { text: 'A. I don’t know', correct: false },
                { text: 'B. I went to my uncle’s house', correct: true },
                { text: 'C. I was busy', correct: false },
                { text: 'D. Let’s go to the cinema', correct: false }
            ],
            expl: '<b>Đáp án B.</b><br>Câu hỏi: "Bạn có đi đâu cuối tuần trước không?"<br>A. Tôi không biết.<br>B. Tôi đã đến nhà chú tôi. (Trả lời trực tiếp cho câu hỏi đi đâu).<br>C. Tôi bận (Thường dùng để từ chối lời mời).<br>D. Hãy đi xem phim đi (Lời rủ rê).'
        },
        // READING 1 (13-16)
        {
            id: 13, type: 'mcq', q: 'Question 13',
            options: [
                { text: 'A. glad (adj)', correct: true },
                { text: 'B. gladness (n)', correct: false },
                { text: 'C. gladly (adv)', correct: false },
                { text: 'D. gladden (v)', correct: false }
            ],
            expl: '<b>Đáp án A. glad</b><br>Cấu trúc: <i>be + adj + to V</i> (vui lòng làm gì).<br>Dịch: Sở Văn hóa thị trấn rất vui mừng được tổ chức...'
        },
        {
            id: 14, type: 'mcq', q: 'Question 14',
            options: [
                { text: 'A. take part', correct: false },
                { text: 'B. take place', correct: true },
                { text: 'C. take after', correct: false },
                { text: 'D. take off', correct: false }
            ],
            expl: '<b>Đáp án B. take place</b><br>Take place: diễn ra (dùng cho sự kiện).<br>Take part (in): tham gia.<br>Take after: giống (ai đó).<br>Take off: cất cánh/cởi đồ.<br>Dịch: Lễ hội sẽ diễn ra tại công viên trung tâm.'
        },
        {
            id: 15, type: 'mcq', q: 'Question 15',
            options: [
                { text: 'A. live', correct: true },
                { text: 'B. lively', correct: false },
                { text: 'C. living', correct: false },
                { text: 'D. lives', correct: false }
            ],
            expl: '<b>Đáp án A. live</b><br>Cụm từ: <i>Live performance</i> (Biểu diễn trực tiếp/nhạc sống).<br>Dịch: Các hoạt động bao gồm âm nhạc, trò chơi và biểu diễn trực tiếp.'
        },
        {
            id: 16, type: 'mcq', q: 'Question 16',
            options: [
                { text: 'A. so', correct: false },
                { text: 'B. but', correct: true },
                { text: 'C. in', correct: false },
                { text: 'D. however', correct: false }
            ],
            expl: '<b>Đáp án B. but</b><br>Câu mang nghĩa tương phản: Vào cửa miễn phí, **nhưng** du khách phải đăng ký/có mặt trước.<br>Tuy nhiên câu gốc dùng từ "attend beforehand" hơi lạ, ngữ cảnh này ý nói cần đăng ký hoặc đến sớm. "But" là liên từ nối hợp lý nhất.'
        },
        // ARRANGEMENT (17-18)
        {
            id: 17, type: 'mcq', q: 'Question 17: This year, our school organized a cultural festival. Everyone was excited about it, but _____. <br>(a) The weather was imperfect for the event.<br>(b) It started raining heavily.<br>(c) Many performances were cancelled because of the rain.',
            options: [
                { text: 'A. a-b-c', correct: true },
                { text: 'B. b-c-a', correct: false },
                { text: 'C. c-a-b', correct: false },
                { text: 'D. a-c-b', correct: false }
            ],
            expl: '<b>Đáp án A. a-b-c</b><br>Logic trần thuật:<br>1. (a) Nhận xét chung: Thời tiết không hoàn hảo.<br>2. (b) Chi tiết: Trời bắt đầu mưa to.<br>3. (c) Hậu quả: Nhiều màn trình diễn bị hủy.'
        },
        {
            id: 18, type: 'mcq', q: 'Question 18: Choose the sentence that can end the text in question 17.',
            options: [
                { text: 'A. The festival had to be cancelled, and everyone was disappointed.', correct: true },
                { text: 'B. Despite the rain, everyone still enjoyed the festival.', correct: false },
                { text: 'C. The weather still rain until today.', correct: false },
                { text: 'D. Half of the crowd came back home.', correct: false }
            ],
            expl: '<b>Đáp án A.</b><br>Do câu trước nói "Performances were cancelled" (bị hủy), nên kết bài phù hợp nhất là nói về cảm xúc thất vọng.<br>Dịch: Lễ hội phải bị hủy bỏ và mọi người đều thất vọng.'
        },
        // READING 2 (19-24)
        {
            id: 19, type: 'mcq', q: 'Question 19',
            options: [
                { text: 'A. ends', correct: false },
                { text: 'B. finishes', correct: false },
                { text: 'C. begins', correct: true },
                { text: 'D. is', correct: false }
            ],
            expl: '<b>Đáp án C. begins</b><br>Ngữ cảnh: "festivities can start earlier than that" (lễ hội có thể bắt đầu sớm hơn).<br>-> Mặc dù lễ hội **bắt đầu** vào ngày 13/4...<br>Note: "Is" cũng đúng ngữ pháp nhưng "Begins" đối lập tốt hơn với "Lasts" và "Start earlier".'
        },
        {
            id: 20, type: 'mcq', q: 'Question 20',
            options: [
                { text: 'A. act', correct: false },
                { text: 'B. repair', correct: false },
                { text: 'C. half', correct: false },
                { text: 'D. role', correct: true }
            ],
            expl: '<b>Đáp án D. role</b><br>Collocation: <i>Play a major role</i> (Đóng vai trò quan trọng).<br>Dịch: Nước đóng vai trò quan trọng trong lễ hội.'
        },
        {
            id: 21, type: 'mcq', q: 'Question 21',
            options: [
                { text: 'A. because', correct: true },
                { text: 'B. although', correct: false },
                { text: 'C. so', correct: false },
                { text: 'D. despite', correct: false }
            ],
            expl: '<b>Đáp án A. because</b><br>Giải thích lý do: Nước là biểu tượng sức mạnh **bởi vì** nó rửa trôi năm cũ...'
        },
        {
            id: 22, type: 'mcq', q: 'Question 22',
            options: [
                { text: 'A. previous', correct: true },
                { text: 'B. annoy', correct: false },
                { text: 'C. current', correct: false },
                { text: 'D. next', correct: false }
            ],
            expl: '<b>Đáp án A. previous</b><br>Dịch: Rửa trôi năm **cũ/trước đó** (previous year) và chuẩn bị cho năm mới.'
        },
        {
            id: 23, type: 'mcq', q: 'Question 23',
            options: [
                { text: 'A. friendly', correct: true },
                { text: 'B. frightening', correct: false },
                { text: 'C. soldier', correct: false },
                { text: 'D. huge', correct: false }
            ],
            expl: '<b>Đáp án A. friendly</b><br>Dịch: Một cuộc chiến nước **thân thiện** khổng lồ (giant friendly water fight).<br>Huge bị lặp nghĩa với Giant. Frightening (đáng sợ) không phù hợp không khí lễ hội.'
        },
        {
            id: 24, type: 'mcq', q: 'Question 24',
            options: [
                { text: 'A. depart', correct: false },
                { text: 'B. gather', correct: true },
                { text: 'C. study', correct: false },
                { text: 'D. fight', correct: false }
            ],
            expl: '<b>Đáp án B. gather</b><br>Ngữ cảnh: Family reunions (đoàn tụ gia đình).<br>Dịch: Nhiều người Thái về nhà, **tụ họp** (gather) với gia đình.'
        },
        // TRANSFORMATION (25-28)
        {
            id: 25, type: 'mcq', q: 'Question 25: It took us three months to prepare for this festival.',
            options: [
                { text: 'A. We spent three months preparing for this festival.', correct: true },
                { text: 'B. We spent three months to prepare for this festival', correct: false },
                { text: 'C. We spent three months in preparing for this festival', correct: false },
                { text: 'D. The festival lasted three months.', correct: false }
            ],
            expl: '<b>Đáp án A.</b><br>Cấu trúc: <i>It takes sb + time + to V</i> = <i>S + spend + time + V-ing</i>.<br>Dịch: Chúng tôi mất 3 tháng để chuẩn bị cho lễ hội này.'
        },
        {
            id: 26, type: 'mcq', q: 'Question 26: Whose luggage is this?',
            options: [
                { text: 'A. Who is this luggage belong to?', correct: false },
                { text: 'B. Who does this luggage belong to?', correct: true },
                { text: 'C. Who does sell this luggage?', correct: false },
                { text: 'D. What is the price of this luggage?', correct: false }
            ],
            expl: '<b>Đáp án B.</b><br>Câu hỏi sở hữu: <i>Whose + N + is this?</i> = <i>Who does + N + belong to?</i> (Cái này thuộc về ai?).'
        },
        {
            id: 27, type: 'mcq', q: 'Question 27: She/ participate/ Boryeong Mud Festival/ three/ year/ ago.',
            options: [
                { text: 'A. She participated Boryeong Mud Festival three times year ago.', correct: false },
                { text: 'B. She participated Boryeong Mud Festival three years ago.', correct: true },
                { text: 'C. She participates Boryeong Mud Festival three times years ago.', correct: false },
                { text: 'D. She participated Boryeong Mud Festival three times in a year ago.', correct: false }
            ],
            expl: '<b>Đáp án B.</b><br>Thời gian: "ago" -> Quá khứ đơn (participated).<br>Cụm thời gian: "three years ago" (3 năm trước).<br>Lưu ý: Câu đúng ngữ pháp hoàn chỉnh phải là "participated <b>in</b>...", nhưng trong các đáp án được cho, B là đáp án sát nghĩa và đúng cấu trúc thời gian nhất.'
        },
        {
            id: 28, type: 'mcq', q: 'Question 28: It/ be/ originally/ provide people / cosmetics/ use/ mud/ area.',
            options: [
                { text: 'A. It was originally to provide people with cosmetics using mud in the area.', correct: true },
                { text: 'B. It originally provided people cosmetics used in the area with mud.', correct: false },
                { text: 'C. It was originally providing people cosmetics using mud from the area.', correct: false },
                { text: 'D. It originally provides people with cosmetics use mud in the area.', correct: false }
            ],
            expl: '<b>Đáp án A.</b><br>Cấu trúc: <i>Provide sb with sth</i> (Cung cấp cho ai cái gì).<br>Dịch: Ban đầu nó nhằm mục đích cung cấp cho mọi người các loại mỹ phẩm sử dụng bùn trong khu vực.'
        },
        // VISUAL COMPREHENSION (29-30) - Handled separately in DOM
        {
            id: 29, type: 'mcq', q: 'Which of the following items is NOT included in the half-price sale?',
            options: [
                { text: 'A. Dresses', correct: false },
                { text: 'B. T-shirts', correct: false },
                { text: 'C. Shoes', correct: true },
                { text: 'D. Pants', correct: false }
            ],
            expl: '<b>Đáp án C. Shoes</b><br>Thông tin trong ảnh: "The sale doesn\'t include shoes" (Đợt giảm giá không bao gồm giày).<br>Câu hỏi: Mục nào KHÔNG được bao gồm? -> Shoes.'
        },
        {
            id: 30, type: 'mcq', q: 'What is Gemma asking Simon to do?',
            options: [
                { text: 'A. Return a book to the library', correct: false },
                { text: 'B. Bring a borrowed book to school tomorrow', correct: true },
                { text: 'C. Read a book again', correct: false },
                { text: 'D. Buy a new book for school', correct: false }
            ],
            expl: '<b>Đáp án B.</b><br>Thông tin trong tin nhắn: "Don\'t forget to bring that book I lent you to school tomorrow" (Đừng quên mang cuốn sách tớ cho mượn đến trường ngày mai).<br>-> Yêu cầu Simon mang sách đã mượn đi học.'
        },
        // READING 3 (31-36)
        {
            id: 31, type: 'mcq', q: 'Question 31. What is the main idea of the text?',
            options: [
                { text: 'A. Vancouver Island has many interesting tourist attractions.', correct: true },
                { text: 'B. The Pacific Rim Whale Festival celebrates the grey whales\' journey.', correct: false },
                { text: 'C. Nanaimo is famous for its bathtub factories.', correct: false },
                { text: 'D. People in Vancouver enjoy festivals throughout the year.', correct: false }
            ],
            expl: '<b>Đáp án A.</b><br>Bài đọc nói về 2 sự kiện: Lễ hội cá voi và Cuộc đua thuyền bồn tắm tại đảo Vancouver.<br>Ý B chỉ nói về 1 lễ hội. Ý C và D không chính xác hoặc quá rộng.<br>Ý A bao quát nhất: Đảo Vancouver có nhiều điểm thu hút thú vị.'
        },
        {
            id: 32, type: 'mcq', q: 'Question 32. Which word is CLOSEST in meaning to “journey” in the text?',
            options: [
                { text: 'A. Adventure', correct: false },
                { text: 'B. Voyage', correct: true },
                { text: 'C. Game', correct: false },
                { text: 'D. Goal', correct: false }
            ],
            expl: '<b>Đáp án B. Voyage</b><br>Journey (Hành trình) = Voyage (Chuyến đi dài, thường trên biển).<br>Context: Cá voi bơi từ Mexico đến Bắc Cực.'
        },
        {
            id: 33, type: 'mcq', q: 'Question 33. Which word is OPPOSITE in meaning to “oldest” in the text?',
            options: [
                { text: 'A. Youngest', correct: false },
                { text: 'B. Biggest', correct: false },
                { text: 'C. Latest', correct: true },
                { text: 'D. Shortest', correct: false }
            ],
            expl: '<b>Đáp án C. Latest</b><br>Oldest (Cũ nhất/Lâu đời nhất).<br>Opposite: Latest (Mới nhất/Gần đây nhất).<br>Youngest thường dùng cho tuổi tác con người.'
        },
        {
            id: 34, type: 'mcq', q: 'Question 34. Which of the following is NOT true according to the text?',
            options: [
                { text: 'A. Grey whales swim about 16,000 kilometres every year.', correct: false },
                { text: 'B. The Nanaimo Bathtub Race involves boats made from bathtubs.', correct: false },
                { text: 'C. The Pacific Rim Whale Festival takes place in April.', correct: true },
                { text: 'D. The Nanaimo Bathtub Race attracts participants from around the world.', correct: false }
            ],
            expl: '<b>Đáp án C.</b><br>Dẫn chứng: "Every <b>March</b>, the people... have a festival" (Tháng 3 hàng năm).<br>Đáp án C nói "In April" (Tháng 4) là sai.'
        },
        {
            id: 35, type: 'mcq', q: 'Question 35. According to the reading, why is it easy for people to see whales?',
            options: [
                { text: 'A. The people use binoculars.', correct: false },
                { text: 'B. The whales swim close to land.', correct: true },
                { text: 'C. The people are also swimming in the water', correct: false },
                { text: 'D. They fly over the whales in helicopters.', correct: false }
            ],
            expl: '<b>Đáp án B.</b><br>Dẫn chứng: "The whales travel very close to the shore... This allows people to gather together to watch..." (Cá voi bơi rất gần bờ).'
        },
        {
            id: 36, type: 'mcq', q: 'Question 36. What is special about every boat in the race?',
            options: [
                { text: 'A. Each boat can carry three people', correct: false },
                { text: 'B. Every boat is made from a bathtub.', correct: true },
                { text: 'C. Every boat gets a safety inspection', correct: false },
                { text: 'D. All the boats have sails.', correct: false }
            ],
            expl: '<b>Đáp án B.</b><br>Dẫn chứng: "all the boats are made from bathtubs" (tất cả thuyền đều làm từ bồn tắm).'
        },
        // READING 4: GAP FILL INSERTION (37-40)
        {
            id: 37, type: 'mcq', q: 'Question 37',
            options: [
                { text: 'A', correct: false },
                { text: 'B', correct: false },
                { text: 'C', correct: true },
                { text: 'D', correct: false }
            ],
            expl: '<b>Đáp án C. All these are Christmas traditions</b><br>Ngữ cảnh trước: Đèn sáng, cửa hàng đông đúc...<br>Ngữ cảnh sau: "Another tradition is snow." (Một truyền thống <i>khác</i> là tuyết).<br>-> Cần một câu tổng hợp các ý trước là "truyền thống" để dẫn sang truyền thống tiếp theo.'
        },
        {
            id: 38, type: 'mcq', q: 'Question 38',
            options: [
                { text: 'A', correct: true },
                { text: 'B', correct: false },
                { text: 'C', correct: false },
                { text: 'D', correct: false }
            ],
            expl: '<b>Đáp án A. This is what is meant by a “White Christmas”</b><br>Ngữ cảnh trước: Tuyết trắng bao phủ mặt đất vào ngày Giáng sinh.<br>-> Đây chính là ý nghĩa của cụm từ "Giáng sinh trắng".'
        },
        {
            id: 39, type: 'mcq', q: 'Question 39',
            options: [
                { text: 'A', correct: false },
                { text: 'B', correct: true },
                { text: 'C', correct: false },
                { text: 'D', correct: false }
            ],
            expl: '<b>Đáp án B. but live where it is warm</b><br>Ngữ cảnh: "People who like snow - ... - dream of having a white Christmas".<br>Những người thích tuyết - <b>nhưng sống ở nơi ấm áp</b> - mơ ước có giáng sinh trắng.<br>Phù hợp với câu trước đó nói về những nơi không có tuyết.'
        },
        {
            id: 40, type: 'mcq', q: 'Question 40',
            options: [
                { text: 'A', correct: false },
                { text: 'B', correct: false },
                { text: 'C', correct: false },
                { text: 'D', correct: true }
            ],
            expl: '<b>Đáp án D. Hundreds of singers and musicians have recorded it</b><br>Ngữ cảnh trước: "White Christmas" là bài hát nổi tiếng nhất mọi thời đại.<br>Ngữ cảnh sau: "Perhaps the most famous version was sung by Bing Crosby." (Có lẽ phiên bản nổi tiếng nhất là của Bing Crosby).<br>-> Câu D (Hàng trăm ca sĩ đã thu âm nó) làm cầu nối hoàn hảo.'
        }
    ];

    // --- RENDER FUNCTIONS ---
    function renderQuiz() {
        const phoneticsArea = document.getElementById('phonetics-area');
        const stressArea = document.getElementById('stress-area');
        const grammarArea = document.getElementById('grammar-area');
        const reading1Area = document.getElementById('reading1-area');
        const reading2Area = document.getElementById('reading2-area');
        const reading3Area = document.getElementById('reading3-area');
        const writingArea = document.getElementById('writing-area');
        const arrangementArea = document.getElementById('arrangement-area');
        const gapFillQs = document.getElementById('gap-fill-questions');
        const q29Opts = document.getElementById('opts-29');
        const q30Opts = document.getElementById('opts-30');

        quizData.forEach((item, index) => {
            if (index >= 28 && index <= 29) { // Q29, Q30 handled specially
                renderOptionsSpecial(item, index === 28 ? q29Opts : q30Opts);
                // Fill explanations div
                const explDiv = document.getElementById(index === 28 ? 'expl-28' : 'expl-29');
                explDiv.innerHTML = `<span class="expl-title">Teacher's Explanation:</span> ${item.expl}`;
                return;
            }

            // Create Card
            const card = document.createElement('div');
            card.className = 'question-card';
            card.id = `q-card-${item.id}`;

            // Question Text
            let qHTML = `<div class="q-text"><span class="q-number">Question ${item.id}:</span> ${item.q}</div>`;
            
            // Options Grid
            let optionsHTML = `<div class="options-grid">`;
            item.options.forEach((opt, optIndex) => {
                optionsHTML += `
                    <div class="option" onclick="selectOption(${item.id}, ${optIndex}, this)">
                        ${opt.text}
                    </div>
                `;
            });
            optionsHTML += `</div>`;

            // Check Button
            const checkBtn = `<button class="btn-check" onclick="checkSingleQuestion(${index})">Kiểm tra (Check)</button>`;

            // Explanation
            const explHTML = `
                <div class="explanation" id="expl-${index}">
                    <span class="expl-title">Teacher's Explanation:</span>
                    ${item.expl}
                </div>
            `;

            card.innerHTML = qHTML + optionsHTML + checkBtn + explHTML;

            // Append to correct area
            if (item.id <= 2) phoneticsArea.appendChild(card);
            else if (item.id <= 4) stressArea.appendChild(card);
            else if (item.id <= 12) grammarArea.appendChild(card);
            else if (item.id <= 16) reading1Area.appendChild(card);
            else if (item.id <= 18) arrangementArea.appendChild(card);
            else if (item.id <= 24) reading2Area.appendChild(card);
            else if (item.id <= 28) writingArea.appendChild(card);
            else if (item.id <= 36) reading3Area.appendChild(card);
            else if (item.id <= 40) {
                // Gap fill visual is different, minimal card
                const gfCard = document.createElement('div');
                gfCard.style.borderBottom = "1px solid #eee";
                gfCard.style.paddingBottom = "10px";
                gfCard.innerHTML = `
                    <div style="font-weight:bold; margin-bottom:5px;">Question ${item.id}:</div>
                    <div class="options-grid" style="grid-template-columns: repeat(4, 1fr);">
                        ${item.options.map((opt, i) => `
                            <div class="option" onclick="selectOption(${item.id}, ${i}, this)" style="justify-content:center;">${opt.text}</div>
                        `).join('')}
                    </div>
                    <button class="btn-check" onclick="checkSingleQuestion(${index})" style="margin-top:5px; font-size:0.8rem;">Check</button>
                    <div class="explanation" id="expl-${index}"><span class="expl-title">Giải thích:</span> ${item.expl}</div>
                `;
                gapFillQs.appendChild(gfCard);
            }
        });
    }

    function renderOptionsSpecial(item, container) {
        let html = '';
        item.options.forEach((opt, i) => {
            html += `<div class="option" onclick="selectOption(${item.id}, ${i}, this)">${opt.text}</div>`;
        });
        container.innerHTML = html;
    }

    // --- LOGIC FUNCTIONS ---
    let userAnswers = {}; // { qId: optionIndex }

    function selectOption(qId, optIndex, element) {
        // Remove selected class from siblings
        const parent = element.parentNode;
        const siblings = parent.querySelectorAll('.option');
        siblings.forEach(sib => sib.classList.remove('selected'));
        
        // Add selected to this
        element.classList.add('selected');
        
        // Save answer
        userAnswers[qId] = optIndex;
    }

    function checkSingleQuestion(dataIndex) {
        const item = quizData[dataIndex];
        const userChoice = userAnswers[item.id];
        
        // Locate Options Container
        let optionsContainer;
        if (item.id === 29) optionsContainer = document.getElementById('opts-29');
        else if (item.id === 30) optionsContainer = document.getElementById('opts-30');
        else if (item.id >= 37) {
             // Tricky selection for GF
             const gfWrapper = document.getElementById('gap-fill-questions');
             // Find the specific div for this question
             // Since they are appended in order, we can find by index relative to 37
             const relativeIndex = item.id - 37;
             optionsContainer = gfWrapper.children[relativeIndex].querySelector('.options-grid');
        } else {
            optionsContainer = document.getElementById(`q-card-${item.id}`).querySelector('.options-grid');
        }

        const options = optionsContainer.querySelectorAll('.option');

        // Validation
        if (userChoice === undefined) {
            alert("Vui lòng chọn một đáp án trước khi kiểm tra!");
            return;
        }

        // Show result visual
        options.forEach((opt, idx) => {
            opt.classList.remove('correct-answer', 'wrong-answer'); // Reset
            
            if (item.options[idx].correct) {
                opt.classList.add('correct-answer'); // Show correct
            }
            
            if (idx === userChoice && !item.options[idx].correct) {
                opt.classList.add('wrong-answer'); // Show wrong if user chose it
            }
        });

        // Show Explanation
        document.getElementById(`expl-${dataIndex}`).style.display = 'block';
    }

    function submitAll() {
        let score = 0;
        let unanswered = 0;

        quizData.forEach((item, index) => {
            const userChoice = userAnswers[item.id];
            
            // Check if answered
            if (userChoice === undefined) {
                unanswered++;
                // Highlight yellow/warning if needed, or just force check
            } else if (item.options[userChoice].correct) {
                score++;
            }
            
            // Force check visual for all
            if (userChoice !== undefined) {
                checkSingleQuestion(index);
            } else {
                // If unanswered, just show the explanation and correct answer
                const explDiv = document.getElementById(`expl-${index}`);
                explDiv.style.display = 'block';
                
                // Highlight correct answer
                let optionsContainer;
                if (item.id === 29) optionsContainer = document.getElementById('opts-29');
                else if (item.id === 30) optionsContainer = document.getElementById('opts-30');
                else if (item.id >= 37) {
                     const gfWrapper = document.getElementById('gap-fill-questions');
                     optionsContainer = gfWrapper.children[item.id - 37].querySelector('.options-grid');
                } else {
                    optionsContainer = document.getElementById(`q-card-${item.id}`).querySelector('.options-grid');
                }
                
                const options = optionsContainer.querySelectorAll('.option');
                options.forEach((opt, idx) => {
                    if (item.options[idx].correct) opt.classList.add('correct-answer');
                });
                
                // Add yellow border to card to indicate missed
                if(item.id <= 36) {
                    const card = document.getElementById(`q-card-${item.id}`) || document.getElementById(item.id === 29 ? 'q29-card' : 'q30-card');
                    if(card) card.style.borderLeft = "5px solid var(--warning)";
                }
            }
        });

        const resultText = `Bạn đã làm đúng ${score}/${quizData.length} câu.\n${unanswered > 0 ? `(Có ${unanswered} câu chưa làm)` : ''}`;
        alert(resultText);
        
        // Update footer
        document.querySelector('.btn-submit').innerText = `KẾT QUẢ: ${score}/${quizData.length}`;
        document.querySelector('.btn-submit').style.background = score > 20 ? 'var(--success)' : 'var(--danger)';
    }

    // Initialize
    renderQuiz();

</script>

</body>
</html>


