<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Tr·∫Øc nghi·ªám Giao ti·∫øp & Gi·ªõi t·ª´ - Ms Mai An ULIS</title>
    <!-- Font -->
    <link href="https://fonts.googleapis.com/css2?family=Nunito:wght@400;600;700;800&display=swap" rel="stylesheet">
    <!-- Confetti Library -->
    <script src="https://cdn.jsdelivr.net/npm/canvas-confetti@1.6.0/dist/confetti.browser.min.js"></script>
    <style>
        :root {
            --primary: #8854C0; /* T√≠m Pastel */
            --secondary: #00C9A7; /* Xanh ng·ªçc */
            --correct: #00D26A; /* Xanh l√° */
            --wrong: #FF4757; /* ƒê·ªè cam */
            --bg-pattern: #f0f3f8;
            --text-main: #2f3542;
            --white: #ffffff;
            --shadow-color: rgba(0,0,0,0.15);
        }

        * {
            box-sizing: border-box;
            margin: 0;
            padding: 0;
        }

        body {
            font-family: 'Nunito', sans-serif;
            background-color: #e5e5f7;
            background-image:  radial-gradient(#8854c0 0.5px, transparent 0.5px), radial-gradient(#8854c0 0.5px, #e5e5f7 0.5px);
            background-size: 20px 20px;
            color: var(--text-main);
            padding-bottom: 50px;
        }

        .header {
            background: linear-gradient(135deg, var(--primary), var(--secondary));
            color: white;
            padding: 20px;
            text-align: center;
            border-bottom-left-radius: 30px;
            border-bottom-right-radius: 30px;
            box-shadow: 0 10px 20px -10px rgba(136, 84, 192, 0.5);
            margin-bottom: 30px;
            position: relative;
            overflow: hidden;
        }

        .header h1 {
            font-weight: 800;
            font-size: 1.8rem;
            text-shadow: 2px 2px 0px rgba(0,0,0,0.1);
        }

        .header p {
            font-size: 1.1rem;
            opacity: 0.9;
            margin-top: 5px;
        }

        .container {
            max-width: 800px;
            margin: 0 auto;
            padding: 0 15px;
        }

        /* Question Card Style */
        .card {
            background: var(--white);
            border-radius: 20px;
            padding: 25px;
            margin-bottom: 25px;
            box-shadow: 0 8px 0 rgba(0,0,0,0.05), 0 15px 20px rgba(0,0,0,0.05);
            border: 2px solid #f1f1f1;
            transition: transform 0.3s ease;
            position: relative;
        }

        .question-badge {
            display: inline-block;
            background: var(--primary);
            color: white;
            padding: 5px 15px;
            border-radius: 50px;
            font-weight: 700;
            font-size: 0.9rem;
            margin-bottom: 15px;
            box-shadow: 0 4px 0 rgba(0,0,0,0.2);
        }

        .question-text {
            font-size: 1.3rem;
            font-weight: 700;
            margin-bottom: 20px;
            line-height: 1.5;
            color: #2c3e50;
        }

        /* Answer Grid */
        .options-grid {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 15px;
        }

        @media (max-width: 600px) {
            .options-grid {
                grid-template-columns: 1fr;
            }
        }

        /* 3D Button Style */
        .option-btn {
            background: white;
            border: 2px solid #e0e0e0;
            border-radius: 15px;
            padding: 15px 20px;
            font-family: 'Nunito', sans-serif;
            font-size: 1.1rem;
            font-weight: 600;
            color: #57606f;
            cursor: pointer;
            text-align: left;
            position: relative;
            transition: all 0.1s;
            box-shadow: 0 5px 0 #d1d1d1;
            outline: none;
            display: flex;
            align-items: center;
        }

        .option-btn:hover:not(:disabled) {
            transform: translateY(-2px);
            box-shadow: 0 7px 0 #d1d1d1;
            border-color: var(--primary);
            color: var(--primary);
        }

        .option-btn:active:not(:disabled) {
            transform: translateY(5px);
            box-shadow: 0 0px 0 #d1d1d1;
        }

        /* Correct State */
        .option-btn.correct {
            background-color: var(--correct);
            color: white;
            border-color: #00b85c;
            box-shadow: 0 5px 0 #00944a;
        }

        /* Wrong State */
        .option-btn.wrong {
            background-color: var(--wrong);
            color: white;
            border-color: #ff2e40;
            box-shadow: 0 5px 0 #d61c2e;
            animation: shake 0.5s;
        }

        /* Correct Answer Hint (when chose wrong) */
        .option-btn.show-correct {
            background-color: #fff;
            border: 2px solid var(--correct);
            color: var(--correct);
            box-shadow: 0 5px 0 #00b85c;
        }

        /* Explanation Box */
        .explanation {
            margin-top: 20px;
            background: #f8f9fa;
            border-left: 5px solid var(--secondary);
            border-radius: 10px;
            padding: 20px;
            display: none; /* Hidden by default */
            animation: slideDown 0.4s ease-out;
        }

        .explanation.visible {
            display: block;
        }

        .explanation h4 {
            color: var(--primary);
            margin-bottom: 10px;
            font-weight: 800;
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .explanation-content {
            font-size: 1rem;
            line-height: 1.6;
            white-space: pre-wrap; /* Keeps line breaks from data */
        }
        
        .explanation-content strong {
            color: #2f3542;
            font-weight: 800;
        }

        /* Submit Button */
        .submit-section {
            text-align: center;
            margin-top: 40px;
        }

        .submit-btn {
            background: var(--primary);
            color: white;
            font-size: 1.5rem;
            font-weight: 800;
            padding: 15px 50px;
            border: none;
            border-radius: 50px;
            box-shadow: 0 8px 0 #6c4299, 0 15px 20px rgba(0,0,0,0.2);
            cursor: pointer;
            transition: all 0.2s;
        }

        .submit-btn:active {
            transform: translateY(8px);
            box-shadow: 0 0px 0 #6c4299;
        }

        /* Modal */
        .modal-overlay {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0,0,0,0.7);
            display: none;
            justify-content: center;
            align-items: center;
            z-index: 1000;
            backdrop-filter: blur(5px);
        }

        .modal-content {
            background: white;
            padding: 40px;
            border-radius: 30px;
            text-align: center;
            max-width: 500px;
            width: 90%;
            animation: popIn 0.5s cubic-bezier(0.175, 0.885, 0.32, 1.275);
            border: 5px solid var(--secondary);
        }

        .score-display {
            font-size: 3rem;
            font-weight: 900;
            color: var(--primary);
            margin: 20px 0;
        }

        /* Animations */
        @keyframes shake {
            0% { transform: translateX(0); }
            25% { transform: translateX(-10px) rotate(-5deg); }
            50% { transform: translateX(10px) rotate(5deg); }
            75% { transform: translateX(-10px) rotate(-5deg); }
            100% { transform: translateX(0); }
        }

        @keyframes slideDown {
            from { opacity: 0; transform: translateY(-10px); }
            to { opacity: 1; transform: translateY(0); }
        }

        @keyframes popIn {
            from { opacity: 0; transform: scale(0.5); }
            to { opacity: 1; transform: scale(1); }
        }

    </style>
</head>
<body>

    <div class="header">
        <h1>ENGLISH QUIZ</h1>
        <p>Gi√°o vi√™n: Ms Mai An (ULIS)</p>
        <p>Unit: Communication & Prepositions (Grade 6)</p>
    </div>

    <div class="container" id="quiz-container">
        <!-- Questions will be rendered here via JS -->
    </div>

    <div class="submit-section">
        <button class="submit-btn" onclick="finishQuiz()">N·ªòP B√ÄI üìù</button>
    </div>

    <!-- Result Modal -->
    <div class="modal-overlay" id="resultModal">
        <div class="modal-content">
            <h2>K·∫æT QU·∫¢ B√ÄI L√ÄM</h2>
            <div class="score-display" id="finalScore">0/30</div>
            <p id="feedbackText" style="font-size: 1.2rem; color: #57606f; margin-bottom: 20px;">...</p>
            <button class="submit-btn" onclick="closeModal()" style="font-size: 1rem; padding: 10px 30px;">Xem l·∫°i b√†i</button>
        </div>
    </div>

    <!-- Audio Effects -->
    <audio id="sound-correct" src="https://assets.mixkit.co/active_storage/sfx/2000/2000-preview.mp3"></audio>
    <audio id="sound-wrong" src="https://assets.mixkit.co/active_storage/sfx/2003/2003-preview.mp3"></audio>

<script>
    // --- D·ªÆ LI·ªÜU ƒê·ªÄ B√ÄI (Gi·ªØ nguy√™n 100%) ---
    const quizData = {
        "questions": [
            {
            "questionNumber": 1,
            "question": "We don‚Äôt know how we can _________ with him. He‚Äôs too far away.",
            "answerOptions": [
                {
                "text": "A. keep in touch",
                "rationale": "D·ªãch nghƒ©a: Ch√∫ng t√¥i kh√¥ng bi·∫øt l√†m th·∫ø n√†o ƒë·ªÉ **gi·ªØ li√™n l·∫°c** v·ªõi anh ·∫•y. Anh ·∫•y ·ªü qu√° xa.\n\nPh√¢n t√≠ch:\n- keep in touch (idiom): gi·ªØ li√™n l·∫°c\n- cope (v): ƒë·ªëi ph√≥ (th∆∞·ªùng ƒëi v·ªõi 'with')\n- catch up (v): b·∫Øt k·ªãp\n- keep pace (v): theo k·ªãp (t·ªëc ƒë·ªô)\n\nGi·∫£i th√≠ch: Ng·ªØ c·∫£nh 'too far away' (qu√° xa) th√¨ vi·ªác kh√≥ khƒÉn nh·∫•t l√† 'gi·ªØ li√™n l·∫°c'.",
                "isCorrect": true
                },
                { "text": "B. cope", "isCorrect": false, "rationale": "Sai nghƒ©a." },
                { "text": "C. catch up", "isCorrect": false, "rationale": "Sai nghƒ©a." },
                { "text": "D. keep pace", "isCorrect": false, "rationale": "Sai nghƒ©a." }
            ]
            },
            {
            "questionNumber": 2,
            "question": "Harry doesn‚Äôt understand the instruction on this website, so he has to use _________ messages.",
            "answerOptions": [
                {
                "text": "A. instant",
                "rationale": "D·ªãch nghƒ©a: Harry kh√¥ng hi·ªÉu h∆∞·ªõng d·∫´n tr√™n trang web n√†y, v√¨ v·∫≠y c·∫≠u ·∫•y ph·∫£i s·ª≠ d·ª•ng tin nh·∫Øn **t·ª©c th·ªùi** (ƒë·ªÉ h·ªèi h·ªó tr·ª£ tr·ª±c tuy·∫øn).\n\nPh√¢n t√≠ch:\n- instant (adj): ngay l·∫≠p t·ª©c/t·ª©c th·ªùi\n- online (adj): tr·ª±c tuy·∫øn\n- non-verbal (adj): phi ng√¥n ng·ªØ\n- verbal (adj): b·∫±ng l·ªùi n√≥i\n\nGi·∫£i th√≠ch: C·ª•m t·ª´ 'instant messages' (tin nh·∫Øn t·ª©c th·ªùi/chat tr·ª±c tuy·∫øn) r·∫•t ph·ªï bi·∫øn trong b·ªëi c·∫£nh h·ªó tr·ª£ tr√™n website.",
                "isCorrect": true
                },
                { "text": "B. online", "isCorrect": false, "rationale": "Kh√¥ng t·∫°o th√†nh c·ª•m t·ª´ c·ªë ƒë·ªãnh mang nghƒ©a c·ª• th·ªÉ nh∆∞ 'instant messages'." },
                { "text": "C. non-verbal", "isCorrect": false, "rationale": "Sai nghƒ©a (nh·∫Øn tin l√† d√πng ng√¥n ng·ªØ)." },
                { "text": "D. verbal", "isCorrect": false, "rationale": "Sai nghƒ©a." }
            ]
            },
            {
            "questionNumber": 3,
            "question": "Sue doesn‚Äôt have the doctor‚Äôs telephone number to book a(n) _________ with him.",
            "answerOptions": [
                {
                "text": "B. appointment",
                "rationale": "D·ªãch nghƒ©a: Sue kh√¥ng c√≥ s·ªë ƒëi·ªán tho·∫°i c·ªßa b√°c sƒ© ƒë·ªÉ ƒë·∫∑t m·ªôt **cu·ªôc h·∫πn** v·ªõi √¥ng ·∫•y.\n\nPh√¢n t√≠ch:\n- ticket (n): v√©\n- appointment (n): cu·ªôc h·∫πn (c√¥ng vi·ªác, b√°c sƒ©...)\n- lunch set (n): su·∫•t ƒÉn tr∆∞a\n- seat (n): ch·ªó ng·ªìi\n\nGi·∫£i th√≠ch: ƒêi g·∫∑p b√°c sƒ© th√¨ d√πng 'book an appointment'.",
                "isCorrect": true
                },
                { "text": "A. ticket", "isCorrect": false, "rationale": "Sai ng·ªØ c·∫£nh." },
                { "text": "C. lunch set", "isCorrect": false, "rationale": "Sai ng·ªØ c·∫£nh." },
                { "text": "D. seat", "isCorrect": false, "rationale": "Sai ng·ªØ c·∫£nh." }
            ]
            },
            {
            "questionNumber": 4,
            "question": "Sending letters by post office has become _________ today, in comparison to email.",
            "answerOptions": [
                {
                "text": "D. less popular",
                "rationale": "D·ªãch nghƒ©a: G·ª≠i th∆∞ qua b∆∞u ƒëi·ªán ƒë√£ tr·ªü n√™n **√≠t ph·ªï bi·∫øn h∆°n** ng√†y nay, so v·ªõi email.\n\nPh√¢n t√≠ch:\n- more popular: ph·ªï bi·∫øn h∆°n\n- popular: ph·ªï bi·∫øn\n- much popularer: sai ng·ªØ ph√°p (t√≠nh t·ª´ d√†i kh√¥ng th√™m -er)\n- less popular: √≠t ph·ªï bi·∫øn h∆°n\n\nGi·∫£i th√≠ch: So v·ªõi email (nhanh, ti·ªán), th∆∞ tay r√µ r√†ng 'k√©m ph·ªï bi·∫øn h∆°n'.",
                "isCorrect": true
                },
                { "text": "A. more popular", "isCorrect": false, "rationale": "Sai th·ª±c t·∫ø." },
                { "text": "B. popular", "isCorrect": false, "rationale": "Thi·∫øu c·∫•u tr√∫c so s√°nh." },
                { "text": "C. much popularer", "isCorrect": false, "rationale": "Sai ng·ªØ ph√°p." }
            ]
            },
            {
            "questionNumber": 5,
            "question": "_________, dancing and painting are examples of non-verbal communication.",
            "answerOptions": [
                {
                "text": "B. Smiling",
                "rationale": "D·ªãch nghƒ©a: **M·ªâm c∆∞·ªùi**, nh·∫£y m√∫a v√† v·∫Ω tranh l√† nh·ªØng v√≠ d·ª• c·ªßa giao ti·∫øp phi ng√¥n ng·ªØ.\n\nPh√¢n t√≠ch:\n- Chatting (v): t√°n g·∫´u (d√πng l·ªùi/ch·ªØ -> verbal)\n- Smiling (v): m·ªâm c∆∞·ªùi (ng√¥n ng·ªØ c∆° th·ªÉ -> non-verbal)\n- Singing (v): h√°t (d√πng l·ªùi -> verbal)\n- Emailing (v): g·ª≠i email (d√πng ch·ªØ -> verbal)\n\nGi·∫£i th√≠ch: Ch·ªâ c√≥ 'Smiling' l√† kh√¥ng d√πng t·ª´ ng·ªØ.",
                "isCorrect": true
                },
                { "text": "A. Chatting", "isCorrect": false, "rationale": "L√† giao ti·∫øp ng√¥n ng·ªØ." },
                { "text": "C. Singing", "isCorrect": false, "rationale": "L√† giao ti·∫øp ng√¥n ng·ªØ." },
                { "text": "D. Emailing", "isCorrect": false, "rationale": "L√† giao ti·∫øp ng√¥n ng·ªØ." }
            ]
            },
            {
            "questionNumber": 6,
            "question": "We took part in a lot of interesting ___________ to make acquaintance with each other in the chat room.",
            "answerOptions": [
                {
                "text": "B. activities",
                "rationale": "D·ªãch nghƒ©a: Ch√∫ng t√¥i ƒë√£ tham gia r·∫•t nhi·ªÅu **ho·∫°t ƒë·ªông** th√∫ v·ªã ƒë·ªÉ l√†m quen v·ªõi nhau trong ph√≤ng chat.\n\nPh√¢n t√≠ch:\n- communities (n): c·ªông ƒë·ªìng\n- activities (n): ho·∫°t ƒë·ªông\n- conferences (n): h·ªôi ngh·ªã\n- contests (n): cu·ªôc thi\n\nGi·∫£i th√≠ch: C·ª•m t·ª´ 'take part in activities' (tham gia c√°c ho·∫°t ƒë·ªông) l√† h·ª£p l√Ω nh·∫•t trong b·ªëi c·∫£nh giao l∆∞u l√†m quen.",
                "isCorrect": true
                },
                { "text": "A. communities", "isCorrect": false, "rationale": "Sai nghƒ©a." },
                { "text": "C. conferences", "isCorrect": false, "rationale": "Qu√° trang tr·ªçng cho ph√≤ng chat." },
                { "text": "D. contests", "isCorrect": false, "rationale": "C≈©ng c√≥ th·ªÉ, nh∆∞ng 'activities' bao qu√°t h∆°n." }
            ]
            },
            {
            "questionNumber": 7,
            "question": "The sign language provides the deaf more ___________ to communicate with those who are deaf or hard of hearing.",
            "answerOptions": [
                {
                "text": "B. opportunities",
                "rationale": "D·ªãch nghƒ©a: Ng√¥n ng·ªØ k√Ω hi·ªáu cung c·∫•p cho ng∆∞·ªùi khi·∫øm th√≠nh nhi·ªÅu **c∆° h·ªôi** h∆°n ƒë·ªÉ giao ti·∫øp v·ªõi nh·ªØng ng∆∞·ªùi b·ªã ƒëi·∫øc ho·∫∑c l√£ng tai.\n\nPh√¢n t√≠ch:\n- options (n): l·ª±a ch·ªçn\n- opportunities (n): c∆° h·ªôi\n- situations (n): t√¨nh hu·ªëng\n- activities (n): ho·∫°t ƒë·ªông\n\nGi·∫£i th√≠ch: Ng√¥n ng·ªØ k√Ω hi·ªáu m·ªü ra 'c∆° h·ªôi' giao ti·∫øp.",
                "isCorrect": true
                },
                { "text": "A. options", "isCorrect": false, "rationale": "Sai nghƒ©a." },
                { "text": "C. situations", "isCorrect": false, "rationale": "Sai nghƒ©a." },
                { "text": "D. activities", "isCorrect": false, "rationale": "Sai nghƒ©a." }
            ]
            },
            {
            "questionNumber": 8,
            "question": "Nowadays, our country creates more ___________ products to persuade customers from other countries to buy.",
            "answerOptions": [
                {
                "text": "A. competitive",
                "rationale": "D·ªãch nghƒ©a: Ng√†y nay, ƒë·∫•t n∆∞·ªõc ch√∫ng ta t·∫°o ra nhi·ªÅu s·∫£n ph·∫©m **c√≥ t√≠nh c·∫°nh tranh** h∆°n ƒë·ªÉ thuy·∫øt ph·ª•c kh√°ch h√†ng t·ª´ c√°c n∆∞·ªõc kh√°c mua.\n\nPh√¢n t√≠ch:\n- competitive (adj): c√≥ t√≠nh c·∫°nh tranh (v·ªÅ gi√°, ch·∫•t l∆∞·ª£ng...)\n- expensive (adj): ƒë·∫Øt ƒë·ªè\n- luxurious (adj): sang tr·ªçng\n- beautiful (adj): ƒë·∫πp\n\nGi·∫£i th√≠ch: ƒê·ªÉ 'persuade' (thuy·∫øt ph·ª•c) kh√°ch qu·ªëc t·∫ø, s·∫£n ph·∫©m c·∫ßn c√≥ t√≠nh c·∫°nh tranh cao.",
                "isCorrect": true
                },
                { "text": "B. expensive", "isCorrect": false, "rationale": "Kh√≥ thuy·∫øt ph·ª•c mua n·∫øu ch·ªâ ƒë·∫Øt." },
                { "text": "C. luxurious", "isCorrect": false, "rationale": "H·∫πp nghƒ©a." },
                { "text": "D. beautiful", "isCorrect": false, "rationale": "H·∫πp nghƒ©a." }
            ]
            },
            {
            "questionNumber": 9,
            "question": "The portable wireless devices or eReaders will be paper thin, flexible and have wireless __________ in the future.",
            "answerOptions": [
                {
                "text": "B. connections",
                "rationale": "D·ªãch nghƒ©a: C√°c thi·∫øt b·ªã kh√¥ng d√¢y c·∫ßm tay ho·∫∑c m√°y ƒë·ªçc s√°ch ƒëi·ªán t·ª≠ s·∫Ω m·ªèng nh∆∞ gi·∫•y, linh ho·∫°t v√† c√≥ c√°c **k·∫øt n·ªëi** kh√¥ng d√¢y trong t∆∞∆°ng lai.\n\nPh√¢n t√≠ch:\n- usages (n): c√°ch s·ª≠ d·ª•ng\n- connections (n): k·∫øt n·ªëi\n- Wi-Fi (n): m·∫°ng wifi\n- techniques (n): k·ªπ thu·∫≠t\n\nGi·∫£i th√≠ch: 'Wireless connections' (k·∫øt n·ªëi kh√¥ng d√¢y) l√† thu·∫≠t ng·ªØ chung. 'Wireless Wi-Fi' b·ªã l·∫∑p t·ª´ (th·ª´a wireless).",
                "isCorrect": true
                },
                { "text": "A. usages", "isCorrect": false, "rationale": "Sai nghƒ©a." },
                { "text": "C. Wi-Fi", "isCorrect": false, "rationale": "L·∫∑p t·ª´ (Wireless Wi-Fi)." },
                { "text": "D. techniques", "isCorrect": false, "rationale": "Sai nghƒ©a." }
            ]
            },
            {
            "questionNumber": 10,
            "question": "Recent advancements in 3D imaging and scanning technologies are making your ‚Äúvirtual presence‚Äù a real __________.",
            "answerOptions": [
                {
                "text": "A. possibility",
                "rationale": "D·ªãch nghƒ©a: Nh·ªØng ti·∫øn b·ªô g·∫ßn ƒë√¢y trong c√¥ng ngh·ªá qu√©t v√† h√¨nh ·∫£nh 3D ƒëang bi·∫øn 's·ª± hi·ªán di·ªán ·∫£o' c·ªßa b·∫°n th√†nh m·ªôt **kh·∫£ nƒÉng** th·ª±c t·∫ø.\n\nPh√¢n t√≠ch:\n- possibility (n): kh·∫£ nƒÉng/ƒëi·ªÅu c√≥ th·ªÉ x·∫£y ra\n- creativity (n): s·ª± s√°ng t·∫°o\n- quality (n): ch·∫•t l∆∞·ª£ng\n- identity (n): danh t√≠nh\n\nGi·∫£i th√≠ch: C·ª•m 'make something a real possibility' nghƒ©a l√† bi·∫øn ƒëi·ªÅu g√¨ ƒë√≥ th√†nh hi·ªán th·ª±c.",
                "isCorrect": true
                },
                { "text": "B. creativity", "isCorrect": false, "rationale": "Sai nghƒ©a." },
                { "text": "C. quality", "isCorrect": false, "rationale": "Sai nghƒ©a." },
                { "text": "D. identity", "isCorrect": false, "rationale": "Sai nghƒ©a." }
            ]
            },
            {
            "questionNumber": 11,
            "question": "Which one is **not** correct to fill in the blank? Hand gestures are a type of ___________ which makes people listen to you.",
            "answerOptions": [
                {
                "text": "A. verbal communication",
                "rationale": "D·ªãch nghƒ©a: C√¢u n√†o **kh√¥ng ƒë√∫ng** ƒë·ªÉ ƒëi·ªÅn v√†o ch·ªó tr·ªëng? C·ª≠ ch·ªâ tay l√† m·ªôt lo·∫°i ___________ khi·∫øn m·ªçi ng∆∞·ªùi l·∫Øng nghe b·∫°n.\n\nPh√¢n t√≠ch:\n- verbal communication: giao ti·∫øp b·∫±ng l·ªùi n√≥i -> **SAI** v√¨ c·ª≠ ch·ªâ tay l√† phi ng√¥n ng·ªØ.\n- body language: ng√¥n ng·ªØ c∆° th·ªÉ -> ƒê√öNG.\n- sign language: ng√¥n ng·ªØ k√Ω hi·ªáu -> ƒê√öNG (m·ªôt d·∫°ng c·ª≠ ch·ªâ).\n- non-verbal communication: giao ti·∫øp phi ng√¥n ng·ªØ -> ƒê√öNG.\n\nGi·∫£i th√≠ch: ƒê·ªÅ b√†i y√™u c·∫ßu ch·ªçn c√¢u **KH√îNG ƒê√öNG**.",
                "isCorrect": true
                },
                { "text": "B. body language", "isCorrect": false, "rationale": "ƒê√∫ng v·ªÅ m·∫∑t nghƒ©a (nh∆∞ng ƒë·ªÅ h·ªèi c√¢u sai)." },
                { "text": "C. sign language", "isCorrect": false, "rationale": "ƒê√∫ng v·ªÅ m·∫∑t nghƒ©a." },
                { "text": "D. non-verbal communication", "isCorrect": false, "rationale": "ƒê√∫ng v·ªÅ m·∫∑t nghƒ©a." }
            ]
            },
            {
            "questionNumber": 12,
            "question": "With mobile ___________, devices with solar power can be put in relatively remote locations, or can be free to roam.",
            "answerOptions": [
                {
                "text": "B. connectivity",
                "rationale": "D·ªãch nghƒ©a: V·ªõi **kh·∫£ nƒÉng k·∫øt n·ªëi** di ƒë·ªông, c√°c thi·∫øt b·ªã d√πng nƒÉng l∆∞·ª£ng m·∫∑t tr·ªùi c√≥ th·ªÉ ƒë∆∞·ª£c ƒë·∫∑t ·ªü nh·ªØng v·ªã tr√≠ t∆∞∆°ng ƒë·ªëi xa x√¥i, ho·∫∑c c√≥ th·ªÉ t·ª± do di chuy·ªÉn.\n\nPh√¢n t√≠ch:\n- phones (n): ƒëi·ªán tho·∫°i\n- connectivity (n): kh·∫£ nƒÉng k·∫øt n·ªëi\n- vehicles (n): xe c·ªô\n- equipment (n): thi·∫øt b·ªã\n\nGi·∫£i th√≠ch: 'Mobile connectivity' (k·∫øt n·ªëi di ƒë·ªông) gi√∫p thi·∫øt b·ªã ho·∫°t ƒë·ªông ·ªü xa m√† v·∫´n truy·ªÅn ƒë∆∞·ª£c d·ªØ li·ªáu.",
                "isCorrect": true
                },
                { "text": "A. phones", "isCorrect": false, "rationale": "Sai nghƒ©a." },
                { "text": "C. vehicles", "isCorrect": false, "rationale": "Sai nghƒ©a." },
                { "text": "D. equipment", "isCorrect": false, "rationale": "Sai nghƒ©a." }
            ]
            },
            {
            "questionNumber": 13,
            "question": "This webcam is focusing _____________ my forehead.",
            "answerOptions": [
                {
                "text": "C. on",
                "rationale": "D·ªãch nghƒ©a: C√°i webcam n√†y ƒëang l·∫•y n√©t **v√†o** tr√°n t√¥i.\n\nPh√¢n t√≠ch:\n- C·∫•u tr√∫c: focus on something (t·∫≠p trung v√†o c√°i g√¨).\n\nGi·∫£i th√≠ch: 'Focus' lu√¥n ƒëi v·ªõi gi·ªõi t·ª´ 'on'.",
                "isCorrect": true
                },
                { "text": "A. at", "isCorrect": false, "rationale": "Sai gi·ªõi t·ª´." },
                { "text": "B. in", "isCorrect": false, "rationale": "Sai gi·ªõi t·ª´." },
                { "text": "D. by", "isCorrect": false, "rationale": "Sai gi·ªõi t·ª´." }
            ]
            },
            {
            "questionNumber": 14,
            "question": "He texted me that he would come to the office _____________ twenty minutes.",
            "answerOptions": [
                {
                "text": "C. in",
                "rationale": "D·ªãch nghƒ©a: Anh ·∫•y nh·∫Øn tin cho t√¥i r·∫±ng anh ·∫•y s·∫Ω ƒë·∫øn vƒÉn ph√≤ng **trong v√≤ng** 20 ph√∫t n·ªØa.\n\nPh√¢n t√≠ch:\n- in + kho·∫£ng th·ªùi gian: trong v√≤ng (d√πng cho t∆∞∆°ng lai, ch·ªâ th·ªùi gian t·ª´ hi·ªán t·∫°i ƒë·∫øn l√∫c x·∫£y ra s·ª± vi·ªác).\n- for + kho·∫£ng th·ªùi gian: trong su·ªët (ch·ªâ ƒë·ªô d√†i h√†nh ƒë·ªông).\n- by + m·ªëc th·ªùi gian: tr∆∞·ªõc l√∫c.\n- at + gi·ªù c·ª• th·ªÉ.\n\nGi·∫£i th√≠ch: 'Would come... in 20 mins' nghƒ©a l√† 20 ph√∫t n·ªØa s·∫Ω t·ªõi.",
                "isCorrect": true
                },
                { "text": "A. for", "isCorrect": false, "rationale": "Sai (for d√πng cho ƒë·ªô d√†i: h·ªçc trong 20 ph√∫t)." },
                { "text": "B. by", "isCorrect": false, "rationale": "Sai (by c·∫ßn m·ªëc th·ªùi gian, kh√¥ng ph·∫£i kho·∫£ng th·ªùi gian)." },
                { "text": "D. at", "isCorrect": false, "rationale": "Sai." }
            ]
            },
            {
            "questionNumber": 15,
            "question": "I have studied how to play the guitar _____________ two months.",
            "answerOptions": [
                {
                "text": "D. for",
                "rationale": "D·ªãch nghƒ©a: T√¥i ƒë√£ h·ªçc ch∆°i guitar **ƒë∆∞·ª£c** hai th√°ng r·ªìi.\n\nPh√¢n t√≠ch:\n- Th√¨ hi·ªán t·∫°i ho√†n th√†nh (have studied) + for + kho·∫£ng th·ªùi gian.\n\nGi·∫£i th√≠ch: 'Two months' l√† m·ªôt kho·∫£ng th·ªùi gian -> D√πng 'for'.",
                "isCorrect": true
                },
                { "text": "A. on", "isCorrect": false, "rationale": "Sai." },
                { "text": "B. at", "isCorrect": false, "rationale": "Sai." },
                { "text": "C. by", "isCorrect": false, "rationale": "Sai." }
            ]
            },
            {
            "questionNumber": 16,
            "question": "The workshop will start at 9:15. You should be ready _____________ 9:00.",
            "answerOptions": [
                {
                "text": "A. by",
                "rationale": "D·ªãch nghƒ©a: Bu·ªïi h·ªôi th·∫£o s·∫Ω b·∫Øt ƒë·∫ßu l√∫c 9:15. B·∫°n n√™n s·∫µn s√†ng **tr∆∞·ªõc** 9:00.\n\nPh√¢n t√≠ch:\n- by + m·ªëc th·ªùi gian: tr∆∞·ªõc ho·∫∑c mu·ªôn nh·∫•t l√† v√†o l√∫c ƒë√≥.\n- on: v√†o ng√†y.\n- for: trong kho·∫£ng.\n- in: trong v√≤ng.\n\nGi·∫£i th√≠ch: D√πng 'by' ƒë·ªÉ ch·ªâ h·∫°n ch√≥t (deadline).",
                "isCorrect": true
                },
                { "text": "B. on", "isCorrect": false, "rationale": "Sai." },
                { "text": "C. for", "isCorrect": false, "rationale": "Sai." },
                { "text": "D. in", "isCorrect": false, "rationale": "Sai." }
            ]
            },
            {
            "questionNumber": 17,
            "question": "There are a few strangers standing _____________ of my house.",
            "answerOptions": [
                {
                "text": "B. in front",
                "rationale": "D·ªãch nghƒ©a: C√≥ m·ªôt v√†i ng∆∞·ªùi l·∫° ƒëang ƒë·ª©ng **ph√≠a tr∆∞·ªõc** nh√† t√¥i.\n\nPh√¢n t√≠ch:\n- C·∫•u tr√∫c: in front of (·ªü ph√≠a tr∆∞·ªõc).\n\nGi·∫£i th√≠ch: ƒê·ªÅ b√†i ƒë√£ c√≥ ch·ªØ 'of', n√™n ch·ªâ c·∫ßn ƒëi·ªÅn 'in front'.",
                "isCorrect": true
                },
                { "text": "A. between", "isCorrect": false, "rationale": "Sai (between c·∫ßn 2 v·∫≠t)." },
                { "text": "C. under", "isCorrect": false, "rationale": "Sai (d∆∞·ªõi nh√†?)." },
                { "text": "D. behind", "isCorrect": false, "rationale": "Sai (behind kh√¥ng ƒëi v·ªõi of)." }
            ]
            },
            {
            "questionNumber": 18,
            "question": "The post office is _____________ to the open-air market.",
            "answerOptions": [
                {
                "text": "B. next",
                "rationale": "D·ªãch nghƒ©a: B∆∞u ƒëi·ªán n·∫±m **b√™n c·∫°nh** khu ch·ª£ tr·ªùi.\n\nPh√¢n t√≠ch:\n- C·∫•u tr√∫c: next to (b√™n c·∫°nh).\n\nGi·∫£i th√≠ch: C√≥ gi·ªõi t·ª´ 'to' ph√≠a sau -> ch·ªçn 'next'.",
                "isCorrect": true
                },
                { "text": "A. front", "isCorrect": false, "rationale": "Ph·∫£i l√† 'in front of'." },
                { "text": "C. opposite", "isCorrect": false, "rationale": "Opposite kh√¥ng ƒëi v·ªõi 'to' trong ng·ªØ c·∫£nh n√†y." },
                { "text": "D. between", "isCorrect": false, "rationale": "Between c·∫ßn 'and'." }
            ]
            },
            {
            "questionNumber": 19,
            "question": "He is working in the _____________ room.",
            "answerOptions": [
                {
                "text": "D. opposite",
                "rationale": "D·ªãch nghƒ©a: Anh ·∫•y ƒëang l√†m vi·ªác ·ªü ph√≤ng **ƒë·ªëi di·ªán**.\n\nPh√¢n t√≠ch:\n- opposite (adj): ƒë·ªëi di·ªán.\n- under, at, by: gi·ªõi t·ª´, kh√¥ng ƒë·ª©ng tr∆∞·ªõc danh t·ª´ 'room' nh∆∞ t√≠nh t·ª´ trong tr∆∞·ªùng h·ª£p n√†y.\n\nGi·∫£i th√≠ch: 'The opposite room' l√† c·ª•m danh t·ª´ h·ª£p l√Ω.",
                "isCorrect": true
                },
                { "text": "A. under", "isCorrect": false, "rationale": "Sai lo·∫°i t·ª´/nghƒ©a." },
                { "text": "B. at", "isCorrect": false, "rationale": "Sai lo·∫°i t·ª´." },
                { "text": "C. by", "isCorrect": false, "rationale": "Sai lo·∫°i t·ª´." }
            ]
            },
            {
            "questionNumber": 20,
            "question": "My school is _____________ the bookstore and the restaurant.",
            "answerOptions": [
                {
                "text": "C. between",
                "rationale": "D·ªãch nghƒ©a: Tr∆∞·ªùng t√¥i n·∫±m **gi·ªØa** hi·ªáu s√°ch v√† nh√† h√†ng.\n\nPh√¢n t√≠ch:\n- C·∫•u tr√∫c: between A and B (gi·ªØa A v√† B).\n\nGi·∫£i th√≠ch: C√≥ 'and' n·ªëi hai ƒë·ªãa ƒëi·ªÉm -> D√πng 'between'.",
                "isCorrect": true
                },
                { "text": "A. behind", "isCorrect": false, "rationale": "Sai c·∫•u tr√∫c." },
                { "text": "B. under", "isCorrect": false, "rationale": "Sai nghƒ©a." },
                { "text": "D. next to", "isCorrect": false, "rationale": "Sai c·∫•u tr√∫c." }
            ]
            },
            {
            "questionNumber": 21,
            "question": "Players always sit _____________ each other in a chess game.",
            "answerOptions": [
                {
                "text": "A. opposite",
                "rationale": "D·ªãch nghƒ©a: C√°c ng∆∞·ªùi ch∆°i lu√¥n ng·ªìi **ƒë·ªëi di·ªán** nhau trong m·ªôt v√°n c·ªù vua.\n\nPh√¢n t√≠ch:\n- opposite (prep): ƒë·ªëi di·ªán.\n- next to: b√™n c·∫°nh.\n- in front of: ph√≠a tr∆∞·ªõc (nh∆∞ng chess th∆∞·ªùng d√πng opposite).\n- behind: ph√≠a sau.\n\nGi·∫£i th√≠ch: Trong c·ªù vua, hai ng∆∞·ªùi ch∆°i ng·ªìi ƒë·ªëi m·∫∑t nhau qua b√†n c·ªù -> Opposite.",
                "isCorrect": true
                },
                { "text": "B. next to", "isCorrect": false, "rationale": "Sai th·ª±c t·∫ø." },
                { "text": "C. in front of", "isCorrect": false, "rationale": "Opposite ch√≠nh x√°c h∆°n cho v·ªã tr√≠ m·∫∑t ƒë·ªëi m·∫∑t qua b√†n." },
                { "text": "D. behind", "isCorrect": false, "rationale": "Sai th·ª±c t·∫ø." }
            ]
            },
            {
            "questionNumber": 22,
            "question": "The doll is not on the bed. It‚Äôs _____________ the bed.",
            "answerOptions": [
                {
                "text": "D. under",
                "rationale": "D·ªãch nghƒ©a: Con b√∫p b√™ kh√¥ng ·ªü tr√™n gi∆∞·ªùng. N√≥ ·ªü **d∆∞·ªõi** g·∫ßm gi∆∞·ªùng.\n\nPh√¢n t√≠ch:\n- in: trong (gi∆∞·ªùng? √≠t d√πng).\n- front: thi·∫øu 'in' v√† 'of'.\n- next: thi·∫øu 'to'.\n- under: d∆∞·ªõi.\n\nGi·∫£i th√≠ch: V·ªã tr√≠ ƒë·ªëi l·∫≠p v·ªõi 'on' (tr√™n) th∆∞·ªùng l√† 'under' (d∆∞·ªõi).",
                "isCorrect": true
                },
                { "text": "A. in", "isCorrect": false, "rationale": "Sai." },
                { "text": "B. front", "isCorrect": false, "rationale": "Sai c·∫•u tr√∫c." },
                { "text": "C. next", "isCorrect": false, "rationale": "Sai c·∫•u tr√∫c." }
            ]
            },
            {
            "questionNumber": 23,
            "question": "The children are playing __________.",
            "answerOptions": [
                {
                "text": "B. outside",
                "rationale": "D·ªãch nghƒ©a: B·ªçn tr·∫ª ƒëang ch∆°i **b√™n ngo√†i**.\n\nPh√¢n t√≠ch:\n- outside (adv): b√™n ngo√†i (tr·ªùi).\n- out: th∆∞·ªùng ƒëi v·ªõi c·ª•m (go out) ho·∫∑c c·∫ßn t√¢n ng·ªØ.\n- at/in: c·∫ßn danh t·ª´ ph√≠a sau.\n\nGi·∫£i th√≠ch: 'Play outside' l√† c·ª•m t·ª´ ph·ªï bi·∫øn.",
                "isCorrect": true
                },
                { "text": "A. out", "isCorrect": false, "rationale": "√çt t·ª± nhi√™n h∆°n outside." },
                { "text": "C. at", "isCorrect": false, "rationale": "Thi·∫øu danh t·ª´." },
                { "text": "D. in", "isCorrect": false, "rationale": "Thi·∫øu danh t·ª´." }
            ]
            },
            {
            "questionNumber": 24,
            "question": "May comes __________ April.",
            "answerOptions": [
                {
                "text": "B. after",
                "rationale": "D·ªãch nghƒ©a: Th√°ng NƒÉm ƒë·∫øn **sau** th√°ng T∆∞.\n\nPh√¢n t√≠ch:\n- before: tr∆∞·ªõc.\n- after: sau.\n\nGi·∫£i th√≠ch: Th·ª© t·ª± th√°ng: April -> May. V·∫≠y May ƒë·∫øn sau April.",
                "isCorrect": true
                },
                { "text": "A. before", "isCorrect": false, "rationale": "Sai th·ª±c t·∫ø." },
                { "text": "C. from", "isCorrect": false, "rationale": "Sai nghƒ©a." },
                { "text": "D. against", "isCorrect": false, "rationale": "Sai nghƒ©a." }
            ]
            },
            {
            "questionNumber": 25,
            "question": "There is a clock __________ the wall in my class.",
            "answerOptions": [
                {
                "text": "C. on",
                "rationale": "D·ªãch nghƒ©a: C√≥ m·ªôt chi·∫øc ƒë·ªìng h·ªì **tr√™n** t∆∞·ªùng trong l·ªõp t√¥i.\n\nPh√¢n t√≠ch:\n- on the wall: tr√™n t∆∞·ªùng (b·ªÅ m·∫∑t).\n\nGi·∫£i th√≠ch: ƒê·ªì v·∫≠t treo tr√™n b·ªÅ m·∫∑t th·∫≥ng ƒë·ª©ng d√πng 'on'.",
                "isCorrect": true
                },
                { "text": "A. near", "isCorrect": false, "rationale": "Kh√¥ng t·ª± nhi√™n b·∫±ng 'on'." },
                { "text": "B. across", "isCorrect": false, "rationale": "Sai nghƒ©a." },
                { "text": "D. at", "isCorrect": false, "rationale": "Sai gi·ªõi t·ª´." }
            ]
            },
            {
            "questionNumber": 26,
            "question": "Where is Susan? - She is sitting __________ Jim.",
            "answerOptions": [
                {
                "text": "D. next to",
                "rationale": "D·ªãch nghƒ©a: Susan ƒë√¢u r·ªìi? - C√¥ ·∫•y ƒëang ng·ªìi **b√™n c·∫°nh** Jim.\n\nPh√¢n t√≠ch:\n- on: tr√™n (Jim? -> kh√¥ng th·ªÉ).\n- under: d∆∞·ªõi (Jim? -> kh√¥ng th·ªÉ).\n- between: c·∫ßn 2 ng∆∞·ªùi.\n- next to: b√™n c·∫°nh.\n\nGi·∫£i th√≠ch: V·ªã tr√≠ ng·ªìi h·ª£p l√Ω nh·∫•t l√† b√™n c·∫°nh.",
                "isCorrect": true
                },
                { "text": "A. on", "isCorrect": false, "rationale": "Sai nghƒ©a." },
                { "text": "B. under", "isCorrect": false, "rationale": "Sai nghƒ©a." },
                { "text": "C. between", "isCorrect": false, "rationale": "Thi·∫øu ng∆∞·ªùi th·ª© 2." }
            ]
            },
            {
            "questionNumber": 27,
            "question": "We‚Äôre studying __________ Sai Gon University.",
            "answerOptions": [
                {
                "text": "A. at",
                "rationale": "D·ªãch nghƒ©a: Ch√∫ng t√¥i ƒëang h·ªçc **t·∫°i** ƒê·∫°i h·ªçc S√†i G√≤n.\n\nPh√¢n t√≠ch:\n- at + tr∆∞·ªùng h·ªçc/ƒë·∫°i h·ªçc (ƒë·ªãa ƒëi·ªÉm c·ª• th·ªÉ/t·ªï ch·ª©c).\n\nGi·∫£i th√≠ch: D√πng 'at' cho University.",
                "isCorrect": true
            },
                { "text": "B. in", "isCorrect": false, "rationale": "Th∆∞·ªùng d√πng cho th√†nh ph·ªë/qu·ªëc gia." },
                { "text": "C. of", "isCorrect": false, "rationale": "Sai." },
                { "text": "D. from", "isCorrect": false, "rationale": "Sai." }
            ]
            },
            {
            "questionNumber": 28,
            "question": "There are 40 students __________ the class.",
            "answerOptions": [
                {
                "text": "B. in",
                "rationale": "D·ªãch nghƒ©a: C√≥ 40 h·ªçc sinh **trong** l·ªõp h·ªçc.\n\nPh√¢n t√≠ch:\n- in the class: trong l·ªõp (kh√¥ng gian ch·ª©a ƒë·ª±ng).\n\nGi·∫£i th√≠ch: D√πng 'in' cho ph√≤ng h·ªçc/l·ªõp h·ªçc.",
                "isCorrect": true
                },
                { "text": "A. inside", "isCorrect": false, "rationale": "Nh·∫•n m·∫°nh qu√° m·ª©c v√†o ph√≠a b√™n trong." },
                { "text": "C. at", "isCorrect": false, "rationale": "At class (kh√¥ng c√≥ 'the'), nh∆∞ng 'in the class' ph·ªï bi·∫øn h∆°n khi ƒë·∫øm s·ªë l∆∞·ª£ng.",
                "isCorrect": false
                },
                { "text": "D. over", "isCorrect": false, "rationale": "Sai." }
            ]
            },
            {
            "questionNumber": 29,
            "question": "My pen is __________ the books and the computer.",
            "answerOptions": [
                {
                "text": "D. between",
                "rationale": "D·ªãch nghƒ©a: C√¢y b√∫t c·ªßa t√¥i n·∫±m **gi·ªØa** nh·ªØng cu·ªën s√°ch v√† c√°i m√°y t√≠nh.\n\nPh√¢n t√≠ch:\n- between A and B.\n\nGi·∫£i th√≠ch: C√≥ 2 v·∫≠t th·ªÉ l√†m m·ªëc (books v√† computer) -> D√πng 'between'.",
                "isCorrect": true
                },
                { "text": "A. among", "isCorrect": false, "rationale": "Among d√πng cho nhi·ªÅu v·∫≠t ( >2) kh√¥ng x√°c ƒë·ªãnh r√µ." },
                { "text": "B. down", "isCorrect": false, "rationale": "Sai." },
                { "text": "C. up", "isCorrect": false, "rationale": "Sai." }
            ]
            },
            {
            "questionNumber": 30,
            "question": "I saw a mouse __________ the chair.",
            "answerOptions": [
                {
                "text": "D. behind",
                "rationale": "D·ªãch nghƒ©a: T√¥i ƒë√£ nh√¨n th·∫•y m·ªôt con chu·ªôt **ph√≠a sau** c√°i gh·∫ø.\n\nPh√¢n t√≠ch:\n- among: sai (c·∫ßn nhi·ªÅu v·∫≠t).\n- between: sai (c·∫ßn 2 v·∫≠t).\n- in: sai (trong gh·∫ø? hi·∫øm g·∫∑p).\n- behind: ph√≠a sau (h·ª£p l√Ω v√¨ chu·ªôt hay tr·ªën).\n\nGi·∫£i th√≠ch: 'Behind' l√† v·ªã tr√≠ h·ª£p l√Ω nh·∫•t trong c√°c ƒë√°p √°n.",
                "isCorrect": true
                },
                { "text": "A. among", "isCorrect": false, "rationale": "Sai." },
                { "text": "B. between", "isCorrect": false, "rationale": "Sai." },
                { "text": "C. in", "isCorrect": false, "rationale": "Sai." }
            ]
            }
        ]
    };

    // --- LOGIC X·ª¨ L√ù ---
    let score = 0;
    const totalQuestions = quizData.questions.length;
    let questionsAnswered = 0;

    // √Çm thanh
    const dingSound = document.getElementById('sound-correct');
    const buzzSound = document.getElementById('sound-wrong');

    // H√†m render b√†i thi
    function renderQuiz() {
        const container = document.getElementById('quiz-container');
        
        quizData.questions.forEach((q, index) => {
            const card = document.createElement('div');
            card.className = 'card';
            card.id = `q-${index}`;

            // Badge
            const badge = document.createElement('span');
            badge.className = 'question-badge';
            badge.innerText = `C√¢u ${q.questionNumber}`;
            
            // Question Text
            const qText = document.createElement('div');
            qText.className = 'question-text';
            qText.innerText = q.question;

            // Options Grid
            const grid = document.createElement('div');
            grid.className = 'options-grid';

            // Find correct answer index for logic
            const correctOptionIndex = q.answerOptions.findIndex(opt => opt.isCorrect);

            q.answerOptions.forEach((opt, optIndex) => {
                const btn = document.createElement('button');
                btn.className = 'option-btn';
                btn.innerHTML = opt.text; // Use innerHTML in case of special chars
                // CHANGE: We now pass the entire options array to checkAnswer to find the "detailed" rationale
                btn.onclick = () => checkAnswer(btn, opt.isCorrect, q.answerOptions, index);
                grid.appendChild(btn);
            });

            // Explanation Box
            const explanation = document.createElement('div');
            explanation.className = 'explanation';
            explanation.id = `expl-${index}`;
            // We set content dynamically on click, but let's pre-fill the structure
            explanation.innerHTML = `
                <h4><span style="font-size:1.5rem">üí°</span> GI·∫¢I TH√çCH CHI TI·∫æT:</h4>
                <div class="explanation-content" id="expl-content-${index}"></div>
            `;

            card.appendChild(badge);
            card.appendChild(qText);
            card.appendChild(grid);
            card.appendChild(explanation);
            container.appendChild(card);
        });
    }

    // H√†m x·ª≠ l√Ω khi ch·ªçn ƒë√°p √°n
    function checkAnswer(selectedBtn, isCorrect, allOptions, questionIndex) {
        const card = document.getElementById(`q-${questionIndex}`);
        const buttons = card.querySelectorAll('.option-btn');
        const explanationBox = document.getElementById(`expl-${questionIndex}`);
        const explanationContent = document.getElementById(`expl-content-${questionIndex}`);

        // Disable all buttons in this card
        buttons.forEach(btn => btn.disabled = true);

        if (isCorrect) {
            selectedBtn.classList.add('correct');
            playSound(true);
            triggerConfetti();
            score++;
        } else {
            selectedBtn.classList.add('wrong');
            playSound(false);
            // Highlight correct answer
            const correctOpt = allOptions.find(o => o.isCorrect);
            buttons.forEach(btn => {
                if(btn.innerText === correctOpt.text) {
                    btn.classList.add('show-correct');
                }
            });
        }

        // --- NEW LOGIC FOR EXPLANATION ---
        // Always get the rationale from the CORRECT option because it contains the full detailed analysis
        const correctOptionData = allOptions.find(opt => opt.isCorrect);
        const detailedRationale = correctOptionData.rationale;

        // Format the explanation text: Convert \n to <br> and **text** to <strong>text</strong>
        let formattedRationale = detailedRationale
            .replace(/\n/g, '<br>')
            .replace(/\*\*(.*?)\*\*/g, '<strong>$1</strong>');
        
        explanationContent.innerHTML = formattedRationale;
        explanationBox.classList.add('visible');

        questionsAnswered++;
    }

    // H√†m ch∆°i √¢m thanh
    function playSound(isCorrect) {
        if(isCorrect) {
            dingSound.currentTime = 0;
            dingSound.play().catch(e => console.log("Audio autoplay blocked"));
        } else {
            buzzSound.currentTime = 0;
            buzzSound.play().catch(e => console.log("Audio autoplay blocked"));
        }
    }

    // Hi·ªáu ·ª©ng ph√°o gi·∫•y
    function triggerConfetti() {
        confetti({
            particleCount: 100,
            spread: 70,
            origin: { y: 0.6 },
            colors: ['#8854C0', '#00C9A7', '#00D26A', '#FF4757']
        });
    }

    // N·ªôp b√†i
    function finishQuiz() {
        const modal = document.getElementById('resultModal');
        const scoreDiv = document.getElementById('finalScore');
        const feedback = document.getElementById('feedbackText');

        scoreDiv.innerText = `${score}/${totalQuestions}`;

        const percentage = (score / totalQuestions) * 100;
        if (percentage === 100) {
            feedback.innerText = "Tuy·ªát v·ªùi! Em l√† thi√™n t√†i ti·∫øng Anh! üåü";
            triggerConfetti();
        } else if (percentage >= 80) {
            feedback.innerText = "L√†m t·ªët l·∫Øm! Em r·∫•t n·∫Øm v·ªØng ki·∫øn th·ª©c! üî•";
        } else if (percentage >= 50) {
            feedback.innerText = "C·ªë g·∫Øng l√™n nh√©! Em c·∫ßn √¥n l·∫°i b√†i m·ªôt ch√∫t! üìö";
        } else {
            feedback.innerText = "ƒê·ª´ng bu·ªìn nh√©! H√£y xem k·ªπ l·∫°i ph·∫ßn gi·∫£i th√≠ch chi ti·∫øt c·ªßa c√¥ n√†o! üí™";
        }

        modal.style.display = 'flex';
    }

    function closeModal() {
        document.getElementById('resultModal').style.display = 'none';
    }

    // Kh·ªüi ch·∫°y
    window.onload = renderQuiz;

</script>

</body>
</html>
