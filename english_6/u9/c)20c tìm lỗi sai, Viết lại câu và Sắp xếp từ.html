<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Ms Mai An ULIS - English Review Part 3</title>
    <link href="https://fonts.googleapis.com/css2?family=Nunito:wght@400;600;700;800&family=Quicksand:wght@500;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <script src="https://cdn.jsdelivr.net/npm/canvas-confetti@1.6.0/dist/confetti.browser.min.js"></script>
    <style>
        :root {
            --primary: #8854C0; /* T√≠m Pastel */
            --secondary: #00C9A7; /* Xanh ng·ªçc */
            --accent: #FF9F43; /* Cam */
            --success: #00D26A; /* Xanh l√° */
            --error: #FF4757; /* ƒê·ªè cam */
            --bg-pattern: #f0f2f5;
            --text-dark: #2f3542;
            --white: #ffffff;
        }

        * {
            box-sizing: border-box;
            user-select: none; /* NgƒÉn b√¥i ƒëen text ƒë·ªÉ tr·∫£i nghi·ªám gi·ªëng App */
        }

        body {
            font-family: 'Nunito', sans-serif;
            background-color: #E6E6FA;
            background-image: radial-gradient(#8854C0 1px, transparent 1px), radial-gradient(#8854C0 1px, transparent 1px);
            background-size: 20px 20px;
            background-position: 0 0, 10px 10px;
            color: var(--text-dark);
            margin: 0;
            padding-bottom: 80px; /* Space for footer */
        }

        /* Header Styling */
        header {
            background: linear-gradient(135deg, var(--primary), #a29bfe);
            color: white;
            padding: 20px;
            text-align: center;
            border-bottom-left-radius: 30px;
            border-bottom-right-radius: 30px;
            box-shadow: 0 10px 20px rgba(136, 84, 192, 0.3);
            margin-bottom: 30px;
            position: relative;
            overflow: hidden;
        }

        header h1 {
            font-family: 'Quicksand', sans-serif;
            margin: 0;
            font-size: 1.8rem;
            font-weight: 800;
            text-shadow: 2px 2px 0px rgba(0,0,0,0.1);
        }

        header p {
            margin: 5px 0 0;
            opacity: 0.9;
            font-size: 1rem;
        }

        .badge-teacher {
            background: #FF9F43;
            padding: 5px 15px;
            border-radius: 20px;
            font-size: 0.9rem;
            font-weight: bold;
            display: inline-block;
            margin-bottom: 10px;
            box-shadow: 0 4px 0 #E17055;
        }

        /* Container */
        .container {
            max-width: 800px;
            margin: 0 auto;
            padding: 0 15px;
        }

        /* Question Card */
        .card {
            background: white;
            border-radius: 20px;
            padding: 25px;
            margin-bottom: 30px;
            box-shadow: 0 8px 0 rgba(0,0,0,0.05), 0 20px 20px rgba(0,0,0,0.05);
            border: 2px solid rgba(136, 84, 192, 0.1);
            position: relative;
            transition: transform 0.3s;
        }

        .question-number {
            background: var(--secondary);
            color: white;
            display: inline-block;
            padding: 5px 12px;
            border-radius: 12px;
            font-weight: 800;
            font-size: 0.9rem;
            margin-bottom: 15px;
            box-shadow: 0 4px 0 #00997e;
        }

        .question-text {
            font-size: 1.3rem;
            font-weight: 700;
            color: var(--text-dark);
            margin-bottom: 25px;
            line-height: 1.5;
        }

        /* Options Grid */
        .options-grid {
            display: grid;
            grid-template-columns: 1fr;
            gap: 15px;
        }

        .option-btn {
            background: white;
            border: 2px solid #e1e1e1;
            border-radius: 15px;
            padding: 15px 20px;
            font-family: 'Nunito', sans-serif;
            font-size: 1.1rem;
            font-weight: 600;
            color: var(--text-dark);
            cursor: pointer;
            text-align: left;
            transition: all 0.2s;
            box-shadow: 0 5px 0 #d1d1d1;
            position: relative;
            display: flex;
            align-items: center;
        }

        .option-btn:hover:not(:disabled) {
            transform: translateY(-2px);
            border-color: var(--primary);
            color: var(--primary);
        }

        .option-btn:active:not(:disabled) {
            transform: translateY(3px);
            box-shadow: 0 0 0 #d1d1d1;
        }

        /* Correct/Incorrect States */
        .option-btn.correct {
            background: var(--success);
            color: white;
            border-color: var(--success);
            box-shadow: 0 5px 0 #00b85c;
        }

        .option-btn.wrong {
            background: var(--error);
            color: white;
            border-color: var(--error);
            box-shadow: 0 5px 0 #d63031;
            animation: shake 0.5s;
        }

        .option-btn:disabled {
            cursor: default;
            opacity: 0.7;
        }
        
        /* Force full opacity for correct answer when user is wrong */
        .option-btn.correct:disabled {
            opacity: 1 !important;
        }

        /* Icon indicators */
        .option-icon {
            margin-right: 15px;
            width: 24px;
            text-align: center;
        }

        /* Explanation Box */
        .explanation-box {
            background: #f8f9fa;
            border-left: 5px solid var(--primary);
            border-radius: 10px;
            padding: 20px;
            margin-top: 25px;
            display: none; /* Hidden by default */
            animation: slideDown 0.4s ease-out;
        }
        
        .explanation-header {
            font-weight: 800;
            color: var(--primary);
            margin-bottom: 10px;
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .exp-step {
            margin-bottom: 12px;
            line-height: 1.6;
            font-size: 1rem;
        }

        .exp-step b {
            color: #57606f;
            display: block;
            margin-bottom: 4px;
        }

        /* Hint Button */
        .hint-btn {
            background: transparent;
            border: none;
            color: var(--accent);
            font-weight: bold;
            cursor: pointer;
            margin-top: 10px;
            font-size: 0.9rem;
            display: flex;
            align-items: center;
            gap: 5px;
        }
        
        .hint-content {
            display: none;
            margin-top: 5px;
            font-style: italic;
            color: #747d8c;
            font-size: 0.9rem;
        }

        /* Footer / Submit */
        .quiz-footer {
            position: fixed;
            bottom: 0;
            left: 0;
            width: 100%;
            background: white;
            padding: 15px;
            box-shadow: 0 -5px 20px rgba(0,0,0,0.1);
            text-align: center;
            z-index: 100;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .score-display {
            font-weight: 800;
            font-size: 1.2rem;
            color: var(--primary);
        }

        .submit-btn {
            background: var(--secondary);
            color: white;
            border: none;
            padding: 12px 30px;
            border-radius: 30px;
            font-weight: 800;
            font-size: 1.1rem;
            cursor: pointer;
            box-shadow: 0 5px 0 #00997e;
            transition: transform 0.2s;
        }

        .submit-btn:active {
            transform: translateY(4px);
            box-shadow: 0 1px 0 #00997e;
        }

        /* Summary Modal */
        .modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0,0,0,0.6);
            z-index: 1000;
            justify-content: center;
            align-items: center;
            animation: fadeIn 0.3s;
        }

        .modal-content {
            background: white;
            padding: 40px;
            border-radius: 30px;
            text-align: center;
            max-width: 400px;
            width: 90%;
            position: relative;
            box-shadow: 0 20px 50px rgba(0,0,0,0.3);
            border: 4px solid var(--primary);
        }

        .result-emoji {
            font-size: 4rem;
            margin-bottom: 20px;
            display: block;
            animation: pop 0.6s cubic-bezier(0.175, 0.885, 0.32, 1.275);
        }

        .modal h2 {
            color: var(--primary);
            margin-bottom: 10px;
        }

        .final-score {
            font-size: 2.5rem;
            font-weight: 800;
            color: var(--secondary);
            margin: 20px 0;
        }

        /* Animations */
        @keyframes shake {
            0% { transform: translateX(0); }
            25% { transform: translateX(-10px) rotate(-5deg); }
            50% { transform: translateX(10px) rotate(5deg); }
            75% { transform: translateX(-5px); }
            100% { transform: translateX(0); }
        }

        @keyframes pop {
            0% { transform: scale(0); }
            80% { transform: scale(1.2); }
            100% { transform: scale(1); }
        }

        @keyframes slideDown {
            from { opacity: 0; transform: translateY(-10px); }
            to { opacity: 1; transform: translateY(0); }
        }

        @keyframes fadeIn {
            from { opacity: 0; }
            to { opacity: 1; }
        }
        
        /* Highlighting Phonetics/Errors */
        .highlight-text u {
            text-decoration: none;
            border-bottom: 3px solid var(--accent);
            padding-bottom: 2px;
        }
        
        .highlight-text strong {
            color: var(--primary);
        }

    </style>
</head>
<body>

    <header>
        <span class="badge-teacher"><i class="fas fa-chalkboard-teacher"></i> Ms Mai An ULIS</span>
        <h1>PART 3: ERROR IDENTIFICATION & SENTENCE BUILDING</h1>
        <p>L√†m b√†i c·∫©n th·∫≠n v√† xem gi·∫£i th√≠ch chi ti·∫øt em nh√©!</p>
    </header>

    <div class="container" id="quiz-container">
        <!-- Questions will be injected here by JavaScript -->
    </div>

    <div class="quiz-footer">
        <div class="score-display">
            ƒêi·ªÉm: <span id="current-score">0</span> / <span id="total-questions">0</span>
        </div>
        <button class="submit-btn" onclick="finishQuiz()">
            <i class="fas fa-flag-checkered"></i> N·ªôp b√†i
        </button>
    </div>

    <!-- Result Modal -->
    <div id="result-modal" class="modal">
        <div class="modal-content">
            <span class="result-emoji" id="result-emoji">üèÜ</span>
            <h2 id="result-title">Tuy·ªát v·ªùi!</h2>
            <p>Em ƒë√£ ho√†n th√†nh b√†i ki·ªÉm tra.</p>
            <div class="final-score" id="final-score">0/0</div>
            <p id="result-message">C·ªë g·∫Øng ph√°t huy nh√©!</p>
            <button class="submit-btn" onclick="location.reload()">L√†m l·∫°i b√†i</button>
        </div>
    </div>

    <!-- Audio Elements -->
    <!-- S·ª≠ d·ª•ng Audio ngu·ªìn m·ªü ho·∫∑c base64 ng·∫Øn ƒë·ªÉ ƒë·∫£m b·∫£o ch·∫°y tr√™n m·ªçi tr√¨nh duy·ªát -->
    <audio id="sound-correct" src="https://assets.mixkit.co/active_storage/sfx/2000/2000-preview.mp3"></audio>
    <audio id="sound-wrong" src="https://assets.mixkit.co/active_storage/sfx/2003/2003-preview.mp3"></audio>

<script>
    // D·ªØ li·ªáu b√†i thi (Data extracted and formatted)
    const quizData = [
        {
            id: 51,
            question: "Find the error: 'My sister‚Äôs pictures are exciting but she‚Äôs school marks are quite bad.'",
            options: [
                { text: "A. she‚Äôs -> her", correct: true },
                { text: "B. pictures -> picture", correct: false },
                { text: "C. exciting -> excited", correct: false },
                { text: "D. quite -> quiet", correct: false }
            ],
            hint: "Ch√∫ √Ω t·ª´ ƒë·ª©ng tr∆∞·ªõc 'school marks'. ƒêi·ªÉm s·ªë 'c·ªßa c√¥ ·∫•y' hay 'c√¥ ·∫•y l√†'?",
            explanation: `
                <div class="exp-step"><b>B∆∞·ªõc 1: Ph√¢n t√≠ch l·ªói sai</b>
                - <i>she‚Äôs</i> (vi·∫øt t·∫Øt c·ªßa 'she is' ho·∫∑c 'she has'): c√¥ ·∫•y l√†/c√≥.<br>
                - <i>her</i> (t√≠nh t·ª´ s·ªü h·ªØu): c·ªßa c√¥ ·∫•y.</div>
                <div class="exp-step"><b>B∆∞·ªõc 2: D·ªãch nghƒ©a</b>
                "Nh·ªØng b·ª©c tranh c·ªßa ch·ªã t√¥i r·∫•t th√∫ v·ªã nh∆∞ng ƒëi·ªÉm s·ªë ·ªü tr∆∞·ªùng c·ªßa ch·ªã ·∫•y l·∫°i kh√° t·ªá."</div>
                <div class="exp-step"><b>B∆∞·ªõc 3: T·∫°i sao ch·ªçn ƒë√°p √°n n√†y? (ƒê√öNG)</b>
                Tr∆∞·ªõc danh t·ª´ "school marks" (ƒëi·ªÉm s·ªë), ta c·∫ßn m·ªôt T√≠nh t·ª´ s·ªü h·ªØu ƒë·ªÉ ch·ªâ s·ª± s·ªü h·ªØu. "She's" l√† sai ng·ªØ ph√°p. Ph·∫£i s·ª≠a th√†nh "her".</div>
                <div class="exp-step"><b>B∆∞·ªõc 4: T·∫°i sao ƒë√°p √°n kh√°c sai?</b>
                - Pictures (s·ªë nhi·ªÅu) ƒë√∫ng v·ªõi 'are'.<br>
                - Exciting (g√¢y h·ª©ng th√∫) d√πng cho v·∫≠t l√† ƒë√∫ng.<br>
                - Quite (kh√° l√†) b·ªï nghƒ©a cho bad l√† ƒë√∫ng.</div>
            `
        },
        {
            id: 52,
            question: "Find the error: 'Tom forgot his homework, but his brother didn‚Äôt forget him.'",
            options: [
                { text: "A. him -> his", correct: true },
                { text: "B. forgot -> forget", correct: false },
                { text: "C. didn‚Äôt -> don't", correct: false },
                { text: "D. his -> he", correct: false }
            ],
            hint: "Anh trai kh√¥ng qu√™n 'b√†i t·∫≠p' ch·ª© kh√¥ng ph·∫£i kh√¥ng qu√™n 'Tom'.",
            explanation: `
                <div class="exp-step"><b>B∆∞·ªõc 1: Ph√¢n t√≠ch l·ªói sai</b>
                - <i>him</i> (t√¢n ng·ªØ): anh ·∫•y.<br>
                - <i>his</i> (ƒë·∫°i t·ª´ s·ªü h·ªØu): c√°i c·ªßa anh ·∫•y (thay cho 'his homework').</div>
                <div class="exp-step"><b>B∆∞·ªõc 2: D·ªãch nghƒ©a</b>
                "Tom qu√™n b√†i t·∫≠p v·ªÅ nh√†, nh∆∞ng anh trai c·∫≠u ·∫•y th√¨ kh√¥ng qu√™n (b√†i t·∫≠p c·ªßa m√¨nh)."</div>
                <div class="exp-step"><b>B∆∞·ªõc 3: T·∫°i sao ch·ªçn ƒë√°p √°n n√†y? (ƒê√öNG)</b>
                Trong ng·ªØ c·∫£nh so s√°nh v·ªÅ vi·ªác qu√™n b√†i t·∫≠p (homework), ta c·∫ßn m·ªôt ƒë·∫°i t·ª´ s·ªü h·ªØu ƒë·ªÉ thay th·∫ø cho c·ª•m "his homework". D√πng "him" ng∆∞·ªùi nghe s·∫Ω hi·ªÉu l√† "kh√¥ng qu√™n Tom" (sai √Ω nghƒ©a ng·ªØ c·∫£nh).</div>
                <div class="exp-step"><b>B∆∞·ªõc 4: T·∫°i sao ƒë√°p √°n kh√°c sai?</b>
                C√°c ƒë·ªông t·ª´ 'forgot' v√† 'didn't' ƒë·ªÅu chia ƒë√∫ng th√¨ qu√° kh·ª©. C·ª•m 'his brother' ƒë√∫ng ng·ªØ ph√°p.</div>
            `
        },
        {
            id: 53,
            question: "Find the error: 'In mine free time I play the piano with my mother.'",
            options: [
                { text: "A. mine -> my", correct: true },
                { text: "B. play -> playing", correct: false },
                { text: "C. with -> to", correct: false },
                { text: "D. mother -> mom", correct: false }
            ],
            hint: "T·ª´ n√†o ƒë·ª©ng tr∆∞·ªõc danh t·ª´ 'free time' ƒë·ªÉ ch·ªâ s·ªü h·ªØu?",
            explanation: `
                <div class="exp-step"><b>B∆∞·ªõc 1: Ph√¢n t√≠ch l·ªói sai</b>
                - <i>mine</i> (ƒë·∫°i t·ª´ s·ªü h·ªØu): c√°i c·ªßa t√¥i (ƒë·ª©ng m·ªôt m√¨nh).<br>
                - <i>my</i> (t√≠nh t·ª´ s·ªü h·ªØu): c·ªßa t√¥i (ƒë·ª©ng tr∆∞·ªõc danh t·ª´).</div>
                <div class="exp-step"><b>B∆∞·ªõc 2: D·ªãch nghƒ©a</b>
                "V√†o th·ªùi gian r·∫£nh c·ªßa t√¥i, t√¥i ch∆°i ƒë√†n piano v·ªõi m·∫π."</div>
                <div class="exp-step"><b>B∆∞·ªõc 3: T·∫°i sao ch·ªçn ƒë√°p √°n n√†y? (ƒê√öNG)</b>
                Tr∆∞·ªõc danh t·ª´ "free time", b·∫Øt bu·ªôc ph·∫£i d√πng T√≠nh t·ª´ s·ªü h·ªØu "my". "Mine" kh√¥ng bao gi·ªù ƒë·ª©ng tr∆∞·ªõc danh t·ª´.</div>
                <div class="exp-step"><b>B∆∞·ªõc 4: T·∫°i sao ƒë√°p √°n kh√°c sai?</b>
                'Play' chia hi·ªán t·∫°i ƒë∆°n ƒë√∫ng. 'Play with' (ch∆°i c√πng) ƒë√∫ng. 'Mother' l√† danh t·ª´ ƒë√∫ng.</div>
            `
        },
        {
            id: 54,
            question: "Find the error: 'They have got a little dog but I don‚Äôt know it‚Äôs name.'",
            options: [
                { text: "A. it‚Äôs -> its", correct: true },
                { text: "B. have got -> has got", correct: false },
                { text: "C. little -> small", correct: false },
                { text: "D. don‚Äôt -> didn't", correct: false }
            ],
            hint: "Ph√¢n bi·ªát gi·ªØa 'it's' (vi·∫øt t·∫Øt) v√† 'its' (s·ªü h·ªØu).",
            explanation: `
                <div class="exp-step"><b>B∆∞·ªõc 1: Ph√¢n t√≠ch l·ªói sai</b>
                - <i>it‚Äôs</i> (vi·∫øt t·∫Øt): n√≥ l√† (it is) ho·∫∑c n√≥ c√≥ (it has).<br>
                - <i>its</i> (t√≠nh t·ª´ s·ªü h·ªØu): c·ªßa n√≥.</div>
                <div class="exp-step"><b>B∆∞·ªõc 2: D·ªãch nghƒ©a</b>
                "H·ªç c√≥ m·ªôt ch√∫ ch√≥ nh·ªè nh∆∞ng t√¥i kh√¥ng bi·∫øt t√™n c·ªßa n√≥."</div>
                <div class="exp-step"><b>B∆∞·ªõc 3: T·∫°i sao ch·ªçn ƒë√°p √°n n√†y? (ƒê√öNG)</b>
                Ta c·∫ßn t√≠nh t·ª´ s·ªü h·ªØu ƒë·ªÉ b·ªï nghƒ©a cho danh t·ª´ "name" (t√™n c·ªßa n√≥). Vi·∫øt c√≥ d·∫•u ph·∫©y "it's" l√† sai ng·ªØ ph√°p.</div>
                <div class="exp-step"><b>B∆∞·ªõc 4: T·∫°i sao ƒë√°p √°n kh√°c sai?</b>
                'They have got' ƒë√∫ng ch·ªß ng·ªØ s·ªë nhi·ªÅu. 'Little dog' d√πng t·ª´ ƒë√∫ng. 'Don't know' ph√π h·ª£p th√¨ hi·ªán t·∫°i.</div>
            `
        },
        {
            id: 55,
            question: "Find the error: 'If you lend me your novel. I will lend you my.'",
            options: [
                { text: "A. my -> mine", correct: true },
                { text: "B. lend -> borrow", correct: false },
                { text: "C. will -> would", correct: false },
                { text: "D. your -> yours", correct: false }
            ],
            hint: "T·ª´ ƒë·ª©ng cu·ªëi c√¢u thay th·∫ø cho 'my novel'.",
            explanation: `
                <div class="exp-step"><b>B∆∞·ªõc 1: Ph√¢n t√≠ch l·ªói sai</b>
                - <i>my</i> (t√≠nh t·ª´ s·ªü h·ªØu): c·∫ßn danh t·ª´ theo sau.<br>
                - <i>mine</i> (ƒë·∫°i t·ª´ s·ªü h·ªØu): ƒë·ª©ng m·ªôt m√¨nh.</div>
                <div class="exp-step"><b>B∆∞·ªõc 2: D·ªãch nghƒ©a</b>
                "N·∫øu b·∫°n cho t√¥i m∆∞·ª£n ti·ªÉu thuy·∫øt c·ªßa b·∫°n, t√¥i s·∫Ω cho b·∫°n m∆∞·ª£n cu·ªën c·ªßa t√¥i."</div>
                <div class="exp-step"><b>B∆∞·ªõc 3: T·∫°i sao ch·ªçn ƒë√°p √°n n√†y? (ƒê√öNG)</b>
                T·ª´ "my" ƒë·ª©ng cu·ªëi c√¢u v√† kh√¥ng c√≥ danh t·ª´ n√†o theo sau l√† sai. C·∫ßn d√πng ƒê·∫°i t·ª´ s·ªü h·ªØu "mine" ƒë·ªÉ thay th·∫ø cho "my novel".</div>
                <div class="exp-step"><b>B∆∞·ªõc 4: T·∫°i sao ƒë√°p √°n kh√°c sai?</b>
                'Lend' (cho m∆∞·ª£n) d√πng ƒë√∫ng nghƒ©a. C√¢u ƒëi·ªÅu ki·ªán lo·∫°i 1 d√πng 'will' ƒë√∫ng. 'Your novel' c√≥ danh t·ª´ n√™n d√πng 'your' ƒë√∫ng.</div>
            `
        },
        {
            id: 56,
            question: "Rewrite: We have two brothers, Jack and Mike. <br>-> Jack and Mike ______",
            options: [
                { text: "A. are our brothers.", correct: true },
                { text: "B. is our brother.", correct: false },
                { text: "C. are their brothers.", correct: false },
                { text: "D. belong to us.", correct: false }
            ],
            hint: "ƒê·ªïi t·ª´ 'ch√∫ng t√¥i c√≥' sang 'h·ªç l√† anh em C·ª¶A CH√öNG T√îI'.",
            explanation: `
                <div class="exp-step"><b>B∆∞·ªõc 1: C·∫•u tr√∫c chuy·ªÉn ƒë·ªïi</b>
                C√¢u g·ªëc: Ch·ªß ng·ªØ (We) + have (c√≥) + T√¢n ng·ªØ (brothers).<br>
                C√¢u vi·∫øt l·∫°i: Ch·ªß ng·ªØ m·ªõi (Jack and Mike) + tobe + T√≠nh t·ª´ s·ªü h·ªØu + Danh t·ª´.</div>
                <div class="exp-step"><b>B∆∞·ªõc 2: D·ªãch nghƒ©a</b>
                "Jack v√† Mike l√† anh em c·ªßa ch√∫ng t√¥i."</div>
                <div class="exp-step"><b>B∆∞·ªõc 3: T·∫°i sao ƒë√∫ng?</b>
                Jack v√† Mike l√† s·ªë nhi·ªÅu n√™n d√πng 'are brothers'. C·ªßa ch√∫ng t√¥i l√† 'our'.</div>
                <div class="exp-step"><b>B∆∞·ªõc 4: T·∫°i sao sai?</b>
                - B sai v√¨ d√πng 'is'.<br>
                - C sai v√¨ d√πng 'their' (c·ªßa h·ªç - sai nghƒ©a).<br>
                - D sai v√¨ 'belong to' kh√¥ng d√πng cho quan h·ªá anh em ru·ªôt th·ªãt.</div>
            `
        },
        {
            id: 57,
            question: "Rewrite: Does that motorbike belong to him? <br>-> Is that ______?",
            options: [
                { text: "A. his motorbike", correct: true },
                { text: "B. he motorbike", correct: false },
                { text: "C. him motorbike", correct: false },
                { text: "D. motorbike his", correct: false }
            ],
            hint: "Chuy·ªÉn 'belong to him' th√†nh s·ªü h·ªØu c√°ch v·ªõi 'motorbike'.",
            explanation: `
                <div class="exp-step"><b>B∆∞·ªõc 1: C·∫•u tr√∫c chuy·ªÉn ƒë·ªïi</b>
                C√¢u g·ªëc: Belong to + T√¢n ng·ªØ (him).<br>
                C√¢u vi·∫øt l·∫°i: Tobe + ƒê·∫°i t·ª´ ch·ªâ ƒë·ªãnh + T√≠nh t·ª´ s·ªü h·ªØu + Danh t·ª´?</div>
                <div class="exp-step"><b>B∆∞·ªõc 2: D·ªãch nghƒ©a</b>
                "Kia c√≥ ph·∫£i l√† xe m√°y c·ªßa anh ·∫•y kh√¥ng?"</div>
                <div class="exp-step"><b>B∆∞·ªõc 3: T·∫°i sao ƒë√∫ng?</b>
                Ta c·∫ßn t√≠nh t·ª´ s·ªü h·ªØu 'his' ƒë·ª©ng tr∆∞·ªõc danh t·ª´ 'motorbike'.</div>
                <div class="exp-step"><b>B∆∞·ªõc 4: T·∫°i sao sai?</b>
                - B: 'he' l√† ch·ªß ng·ªØ.<br>
                - C: 'him' l√† t√¢n ng·ªØ.<br>
                - D: Sai tr·∫≠t t·ª± t·ª´.</div>
            `
        },
        {
            id: 58,
            question: "Rewrite: These postcards are ours. <br>-> These are ______",
            options: [
                { text: "A. our postcards.", correct: true },
                { text: "B. us postcards.", correct: false },
                { text: "C. we postcards.", correct: false },
                { text: "D. ours postcards.", correct: false }
            ],
            hint: "Chuy·ªÉn t·ª´ 'ours' (cu·ªëi c√¢u) th√†nh 'our + danh t·ª´'.",
            explanation: `
                <div class="exp-step"><b>B∆∞·ªõc 1: C·∫•u tr√∫c chuy·ªÉn ƒë·ªïi</b>
                C√¢u g·ªëc: Tobe + ƒê·∫°i t·ª´ s·ªü h·ªØu (ours).<br>
                C√¢u vi·∫øt l·∫°i: Tobe + T√≠nh t·ª´ s·ªü h·ªØu (our) + Danh t·ª´ (postcards).</div>
                <div class="exp-step"><b>B∆∞·ªõc 2: D·ªãch nghƒ©a</b>
                "ƒê√¢y l√† nh·ªØng t·∫•m b∆∞u thi·∫øp c·ªßa ch√∫ng t√¥i."</div>
                <div class="exp-step"><b>B∆∞·ªõc 3: T·∫°i sao ƒë√∫ng?</b>
                C·∫ßn t√≠nh t·ª´ s·ªü h·ªØu 'our' ƒë·ª©ng tr∆∞·ªõc danh t·ª´.</div>
                <div class="exp-step"><b>B∆∞·ªõc 4: T·∫°i sao sai?</b>
                - B, C sai lo·∫°i t·ª´ (t√¢n ng·ªØ/ch·ªß ng·ªØ).<br>
                - D sai v√¨ 'ours' l√† ƒë·∫°i t·ª´ s·ªü h·ªØu, kh√¥ng ƒë·ª©ng tr∆∞·ªõc danh t·ª´.</div>
            `
        },
        {
            id: 59,
            question: "Rewrite: This box of chocolate is hers. <br>-> This box of chocolate belongs ______",
            options: [
                { text: "A. to her.", correct: true },
                { text: "B. to hers.", correct: false },
                { text: "C. to she.", correct: false },
                { text: "D. for her.", correct: false }
            ],
            hint: "C·∫•u tr√∫c 'belong to + t√¢n ng·ªØ'.",
            explanation: `
                <div class="exp-step"><b>B∆∞·ªõc 1: C·∫•u tr√∫c chuy·ªÉn ƒë·ªïi</b>
                C√¢u g·ªëc: Tobe + ƒê·∫°i t·ª´ s·ªü h·ªØu (hers).<br>
                C√¢u vi·∫øt l·∫°i: Belongs + to + T√¢n ng·ªØ (her).</div>
                <div class="exp-step"><b>B∆∞·ªõc 2: D·ªãch nghƒ©a</b>
                "H·ªôp s√¥-c√¥-la n√†y thu·ªôc v·ªÅ c√¥ ·∫•y."</div>
                <div class="exp-step"><b>B∆∞·ªõc 3: T·∫°i sao ƒë√∫ng?</b>
                C·∫•u tr√∫c 'belong to' + t√¢n ng·ªØ ch·ªâ ng∆∞·ªùi (her).</div>
                <div class="exp-step"><b>B∆∞·ªõc 4: T·∫°i sao sai?</b>
                - B sai v√¨ d√πng ƒë·∫°i t·ª´ s·ªü h·ªØu 'hers'.<br>
                - C sai v√¨ d√πng ch·ªß ng·ªØ 'she'.<br>
                - D sai gi·ªõi t·ª´ 'for'.</div>
            `
        },
        {
            id: 60,
            question: "Rewrite: Those are their apple trees. <br>-> These apple trees ______",
            options: [
                { text: "A. are theirs.", correct: true },
                { text: "B. are their.", correct: false },
                { text: "C. belong theirs.", correct: false },
                { text: "D. is theirs.", correct: false }
            ],
            hint: "Chuy·ªÉn 'their apple trees' th√†nh 'are + ƒë·∫°i t·ª´ s·ªü h·ªØu'.",
            explanation: `
                <div class="exp-step"><b>B∆∞·ªõc 1: C·∫•u tr√∫c chuy·ªÉn ƒë·ªïi</b>
                C√¢u g·ªëc: T√≠nh t·ª´ s·ªü h·ªØu (their) + Danh t·ª´.<br>
                C√¢u vi·∫øt l·∫°i: Danh t·ª´ (l√†m ch·ªß ng·ªØ) + Tobe + ƒê·∫°i t·ª´ s·ªü h·ªØu (theirs).</div>
                <div class="exp-step"><b>B∆∞·ªõc 2: D·ªãch nghƒ©a</b>
                "Nh·ªØng c√¢y t√°o n√†y l√† c·ªßa h·ªç."</div>
                <div class="exp-step"><b>B∆∞·ªõc 3: T·∫°i sao ƒë√∫ng?</b>
                D√πng ƒë·∫°i t·ª´ s·ªü h·ªØu 'theirs' ƒë·ª©ng cu·ªëi c√¢u ƒë·ªÉ thay th·∫ø cho 'their apple trees'.</div>
                <div class="exp-step"><b>B∆∞·ªõc 4: T·∫°i sao sai?</b>
                - B sai v√¨ 'their' thi·∫øu danh t·ª´.<br>
                - C thi·∫øu gi·ªõi t·ª´ 'to'.<br>
                - D sai ƒë·ªông t·ª´ 'is' (trees l√† s·ªë nhi·ªÅu).</div>
            `
        },
        {
            id: 61,
            question: "Rearrange: What‚Äôs/ winter/ weather/ in/ the/ Stockholm/ like/ in/?",
            options: [
                { text: "A. What‚Äôs the weather like in Stockholm in winter?", correct: true },
                { text: "B. What‚Äôs the weather in Stockholm in winter like?", correct: false },
                { text: "C. What‚Äôs like the weather in Stockholm in winter?", correct: false },
                { text: "D. In winter what‚Äôs the weather like in Stockholm?", correct: false }
            ],
            hint: "C·∫•u tr√∫c h·ªèi th·ªùi ti·∫øt: What is the weather like...?",
            explanation: `
                <div class="exp-step"><b>B∆∞·ªõc 1: C·∫•u tr√∫c c√¢u h·ªèi th·ªùi ti·∫øt</b>
                What + is + the weather + like + in [Place] + in [Season]?</div>
                <div class="exp-step"><b>B∆∞·ªõc 2: D·ªãch nghƒ©a</b>
                "Th·ªùi ti·∫øt ·ªü Stockholm v√†o m√πa ƒë√¥ng nh∆∞ th·∫ø n√†o?"</div>
                <div class="exp-step"><b>B∆∞·ªõc 3: Ph√¢n t√≠ch</b>
                C·ª•m "What's the weather like..." l√† c·ªë ƒë·ªãnh. ƒê·ªãa ƒëi·ªÉm (Stockholm) th∆∞·ªùng ƒë·ª©ng tr∆∞·ªõc th·ªùi gian (winter).</div>
            `
        },
        {
            id: 62,
            question: "Rearrange: We/ a/ year/ to/ visit/ had/ wonderful/ Tokyo/ last/.",
            options: [
                { text: "A. We had a wonderful visit to Tokyo last year.", correct: true },
                { text: "B. We had a visit wonderful to Tokyo last year.", correct: false },
                { text: "C. Last year we had to visit a wonderful Tokyo.", correct: false },
                { text: "D. We had to visit a wonderful Tokyo last year.", correct: false }
            ],
            hint: "T√≠nh t·ª´ 'wonderful' ƒë·ª©ng tr∆∞·ªõc danh t·ª´ 'visit'.",
            explanation: `
                <div class="exp-step"><b>B∆∞·ªõc 1: C·∫•u tr√∫c</b>
                S (We) + V (had) + O (a wonderful visit) + to [Place] + [Time].</div>
                <div class="exp-step"><b>B∆∞·ªõc 2: D·ªãch nghƒ©a</b>
                "Ch√∫ng t√¥i ƒë√£ c√≥ m·ªôt chuy·∫øn thƒÉm tuy·ªát v·ªùi ƒë·∫øn Tokyo v√†o nƒÉm ngo√°i."</div>
                <div class="exp-step"><b>B∆∞·ªõc 3: Ph√¢n t√≠ch</b>
                T√≠nh t·ª´ "wonderful" b·ªï nghƒ©a cho danh t·ª´ "visit". 'Had a visit' (c√≥ chuy·∫øn thƒÉm) kh√°c v·ªõi 'had to visit' (ph·∫£i ƒëi thƒÉm - sai nghƒ©a).</div>
            `
        },
        {
            id: 63,
            question: "Rearrange: lucky / visit/famous / She / to /is/places/ the / many / in /world/.",
            options: [
                { text: "A. She is lucky to visit many famous places in the world.", correct: true },
                { text: "B. She is lucky to visit many places famous in the world.", correct: false },
                { text: "C. She is famous to visit many lucky places in the world.", correct: false },
                { text: "D. Many famous places in the world is lucky to visit she.", correct: false }
            ],
            hint: "C·∫•u tr√∫c: Lucky to visit (May m·∫Øn ƒë∆∞·ª£c ƒëi thƒÉm).",
            explanation: `
                <div class="exp-step"><b>B∆∞·ªõc 1: C·∫•u tr√∫c</b>
                S + tobe + adj + to V + O.</div>
                <div class="exp-step"><b>B∆∞·ªõc 2: D·ªãch nghƒ©a</b>
                "C√¥ ·∫•y th·∫≠t may m·∫Øn khi ƒë∆∞·ª£c ƒëi thƒÉm nhi·ªÅu ƒë·ªãa danh n·ªïi ti·∫øng tr√™n th·∫ø gi·ªõi."</div>
                <div class="exp-step"><b>B∆∞·ªõc 3: Ph√¢n t√≠ch</b>
                C·ª•m danh t·ª´ "many famous places" (nhi·ªÅu n∆°i n·ªïi ti·∫øng) ƒë√∫ng tr·∫≠t t·ª± t√≠nh t·ª´ tr∆∞·ªõc danh t·ª´.</div>
            `
        },
        {
            id: 64,
            question: "Rearrange: I/ visiting / old / love / in /houses / Hoi An /.",
            options: [
                { text: "A. I love visiting old houses in Hoi An.", correct: true },
                { text: "B. I love visiting houses old in Hoi An.", correct: false },
                { text: "C. In Hoi An I love old houses visiting.", correct: false },
                { text: "D. I love old houses visiting in Hoi An.", correct: false }
            ],
            hint: "Love + V-ing (visiting).",
            explanation: `
                <div class="exp-step"><b>B∆∞·ªõc 1: C·∫•u tr√∫c</b>
                S + love + V-ing + O + in [Place].</div>
                <div class="exp-step"><b>B∆∞·ªõc 2: D·ªãch nghƒ©a</b>
                "T√¥i th√≠ch ƒëi thƒÉm nh·ªØng ng√¥i nh√† c·ªï ·ªü H·ªôi An."</div>
                <div class="exp-step"><b>B∆∞·ªõc 3: Ph√¢n t√≠ch</b>
                "Old houses" (nh√† c·ªï) l√† tr·∫≠t t·ª± ƒë√∫ng. "Visiting" ƒë·ª©ng sau "love".</div>
            `
        },
        {
            id: 65,
            question: "Rearrange: Ha Noi/ for / famous / its / is / street food / delicious /.",
            options: [
                { text: "A. Ha Noi is famous for its delicious street food.", correct: true },
                { text: "B. Ha Noi is famous for its street food delicious.", correct: false },
                { text: "C. Ha Noi is delicious for its famous street food.", correct: false },
                { text: "D. Its delicious street food is famous for Ha Noi.", correct: false }
            ],
            hint: "C·ª•m t·ª´: famous for (n·ªïi ti·∫øng v·ªÅ c√°i g√¨).",
            explanation: `
                <div class="exp-step"><b>B∆∞·ªõc 1: C·∫•u tr√∫c</b>
                S + is + famous for + [Possessive adj] + [Adj] + [Noun].</div>
                <div class="exp-step"><b>B∆∞·ªõc 2: D·ªãch nghƒ©a</b>
                "H√† N·ªôi n·ªïi ti·∫øng v·ªõi m√≥n ƒÉn ƒë∆∞·ªùng ph·ªë ngon tuy·ªát."</div>
                <div class="exp-step"><b>B∆∞·ªõc 3: Ph√¢n t√≠ch</b>
                Tr·∫≠t t·ª± c·ª•m danh t·ª´: its (s·ªü h·ªØu) + delicious (t√≠nh t·ª´) + street food (danh t·ª´ gh√©p).</div>
            `
        },
        {
            id: 66,
            question: "Rearrange: this city/ lots/ You/ find/ shopping/ can/ of/ malls/ in/.",
            options: [
                { text: "A. You can find lots of shopping malls in this city.", correct: true },
                { text: "B. You can find shopping malls of lots in this city.", correct: false },
                { text: "C. In this city you can find of lots shopping malls.", correct: false },
                { text: "D. You can find lots of in this city shopping malls.", correct: false }
            ],
            hint: "C·ª•m t·ª´: lots of shopping malls.",
            explanation: `
                <div class="exp-step"><b>B∆∞·ªõc 1: C·∫•u tr√∫c</b>
                S + can + V + O + in [Place].</div>
                <div class="exp-step"><b>B∆∞·ªõc 2: D·ªãch nghƒ©a</b>
                "B·∫°n c√≥ th·ªÉ t√¨m th·∫•y r·∫•t nhi·ªÅu trung t√¢m mua s·∫Øm ·ªü th√†nh ph·ªë n√†y."</div>
                <div class="exp-step"><b>B∆∞·ªõc 3: Ph√¢n t√≠ch</b>
                "Lots of" ƒëi v·ªõi danh t·ª´ s·ªë nhi·ªÅu "shopping malls".</div>
            `
        },
        {
            id: 67,
            question: "Rearrange: Seoul/ Lotte World/ is/ famous/ for/.",
            options: [
                { text: "A. Seoul is famous for Lotte World.", correct: true },
                { text: "B. Lotte World is famous for Seoul.", correct: false },
                { text: "C. Seoul is Lotte World famous for.", correct: false },
                { text: "D. Famous for Seoul is Lotte World.", correct: false }
            ],
            hint: "Seoul n·ªïi ti·∫øng v√¨ c√°i g√¨?",
            explanation: `
                <div class="exp-step"><b>B∆∞·ªõc 1: C·∫•u tr√∫c</b>
                S + is + famous for + O.</div>
                <div class="exp-step"><b>B∆∞·ªõc 2: D·ªãch nghƒ©a</b>
                "Seoul n·ªïi ti·∫øng v·ªõi Lotte World."</div>
                <div class="exp-step"><b>B∆∞·ªõc 3: Ph√¢n t√≠ch</b>
                Ch·ªß ng·ªØ l√† ƒë·ªãa danh (Seoul), "famous for" l√† c·ª•m c·ªë ƒë·ªãnh. C√¢u B sai logic (ƒê·ªãa ƒëi·ªÉm l·ªõn n·ªïi ti·∫øng v√¨ ƒë·ªãa ƒëi·ªÉm nh·ªè ƒë·∫∑c tr∆∞ng).</div>
            `
        },
        {
            id: 68,
            question: "Rearrange: The City Museum/ about/ here/ fifteen minutes‚Äô/ is/ from/ walk/.",
            options: [
                { text: "A. The City Museum is about fifteen minutes‚Äô walk from here.", correct: true },
                { text: "B. The City Museum is from here about fifteen minutes‚Äô walk.", correct: false },
                { text: "C. From here is about fifteen minutes‚Äô walk The City Museum.", correct: false },
                { text: "D. The City Museum is walk about fifteen minutes‚Äô from here.", correct: false }
            ],
            hint: "C·ª•m t·ª´ ch·ªâ kho·∫£ng c√°ch: 'fifteen minutes‚Äô walk' (15 ph√∫t ƒëi b·ªô).",
            explanation: `
                <div class="exp-step"><b>B∆∞·ªõc 1: C·∫•u tr√∫c</b>
                S + is + about + [Time/Distance] + from + [Location].</div>
                <div class="exp-step"><b>B∆∞·ªõc 2: D·ªãch nghƒ©a</b>
                "B·∫£o t√†ng Th√†nh ph·ªë c√°ch ƒë√¢y kho·∫£ng 15 ph√∫t ƒëi b·ªô."</div>
                <div class="exp-step"><b>B∆∞·ªõc 3: Ph√¢n t√≠ch</b>
                "fifteen minutes‚Äô walk" (qu√£ng ƒë∆∞·ªùng 15 ph√∫t ƒëi b·ªô) l√† c·ª•m danh t·ª´ ch·ªâ kho·∫£ng c√°ch chu·∫©n x√°c.</div>
            `
        },
        {
            id: 69,
            question: "Rearrange: not/to/It/find/is/ strange / easy / in / city / your way/a/.",
            options: [
                { text: "A. It is not easy to find your way in a strange city.", correct: true },
                { text: "B. It is not strange to find your way in a easy city.", correct: false },
                { text: "C. It is not easy to find a strange city in your way.", correct: false },
                { text: "D. To find your way in a strange city is not easy it.", correct: false }
            ],
            hint: "C·∫•u tr√∫c: It is not easy to... (Kh√¥ng d·ªÖ ƒë·ªÉ...)",
            explanation: `
                <div class="exp-step"><b>B∆∞·ªõc 1: C·∫•u tr√∫c</b>
                It is + (not) + adj + to V + O + in [Place].</div>
                <div class="exp-step"><b>B∆∞·ªõc 2: D·ªãch nghƒ©a</b>
                "Th·∫≠t kh√¥ng d·ªÖ d√†ng ƒë·ªÉ t√¨m ƒë∆∞·ªùng trong m·ªôt th√†nh ph·ªë xa l·∫°."</div>
                <div class="exp-step"><b>B∆∞·ªõc 3: Ph√¢n t√≠ch</b>
                C·∫•u tr√∫c gi·∫£ ch·ªß ng·ªØ "It is... to..." r·∫•t ph·ªï bi·∫øn. C√¢u C sai nghƒ©a.</div>
            `
        },
        {
            id: 70,
            question: "Rearrange: millions / There / every / visitors / are / Paris / year / to / of/.",
            options: [
                { text: "A. There are millions of visitors to Paris every year.", correct: true },
                { text: "B. There are visitors to Paris of millions every year.", correct: false },
                { text: "C. Every year there are millions of Paris to visitors.", correct: false },
                { text: "D. There are millions of visitors to every year Paris.", correct: false }
            ],
            hint: "C·ª•m t·ª´: Millions of visitors (h√†ng tri·ªáu du kh√°ch).",
            explanation: `
                <div class="exp-step"><b>B∆∞·ªõc 1: C·∫•u tr√∫c</b>
                There are + [Number/Quantity] + N + to [Place] + [Time].</div>
                <div class="exp-step"><b>B∆∞·ªõc 2: D·ªãch nghƒ©a</b>
                "C√≥ h√†ng tri·ªáu du kh√°ch ƒë·∫øn Paris m·ªói nƒÉm."</div>
                <div class="exp-step"><b>B∆∞·ªõc 3: Ph√¢n t√≠ch</b>
                "Millions of visitors" (h√†ng tri·ªáu du kh√°ch). "To Paris" ch·ªâ h∆∞·ªõng ƒëi/ƒë√≠ch ƒë·∫øn.</div>
            `
        }
    ];

    let currentScore = 0;
    const totalQuestions = quizData.length;
    document.getElementById('total-questions').innerText = totalQuestions;

    // Render Quiz
    const container = document.getElementById('quiz-container');
    
    quizData.forEach((q, index) => {
        const card = document.createElement('div');
        card.className = 'card';
        card.id = `card-${q.id}`;

        let optionsHtml = '';
        const labels = ['A', 'B', 'C', 'D'];
        
        q.options.forEach((opt, i) => {
            optionsHtml += `
                <button class="option-btn" onclick="checkAnswer(${q.id}, ${i}, this)">
                    <div class="option-icon"><i class="far fa-circle"></i></div>
                    ${opt.text.replace(/^[A-D]\.\s/, '')}
                </button>
            `;
        });

        card.innerHTML = `
            <div class="question-number">Question ${q.id}</div>
            <div class="question-text highlight-text">${q.question}</div>
            <div class="options-grid">
                ${optionsHtml}
            </div>
            <button class="hint-btn" onclick="toggleHint(${q.id})">
                <i class="far fa-lightbulb"></i> G·ª£i √Ω
            </button>
            <div id="hint-${q.id}" class="hint-content">${q.hint}</div>
            
            <div id="explanation-${q.id}" class="explanation-box">
                <div class="explanation-header">
                    <i class="fas fa-glasses"></i> C√¥ Mai An gi·∫£i th√≠ch chi ti·∫øt:
                </div>
                ${q.explanation}
            </div>
        `;
        container.appendChild(card);
    });

    // Logic ki·ªÉm tra ƒë√°p √°n
    function checkAnswer(questionId, selectedIndex, btnElement) {
        const questionData = quizData.find(q => q.id === questionId);
        const card = document.getElementById(`card-${questionId}`);
        const allButtons = card.querySelectorAll('.option-btn');
        const explanationBox = document.getElementById(`explanation-${questionId}`);

        // Disable all buttons to prevent multiple clicks
        allButtons.forEach(btn => btn.disabled = true);

        const isCorrect = questionData.options[selectedIndex].correct;
        const iconContainer = btnElement.querySelector('.option-icon');

        if (isCorrect) {
            // Hi·ªáu ·ª©ng ƒê√öNG
            btnElement.classList.add('correct');
            iconContainer.innerHTML = '<i class="fas fa-check-circle"></i>';
            currentScore++;
            document.getElementById('current-score').innerText = currentScore;
            
            // √Çm thanh
            playSound('correct');
            
            // Ph√°o gi·∫•y
            confetti({
                particleCount: 100,
                spread: 70,
                origin: { y: 0.6 },
                colors: ['#00D26A', '#8854C0', '#FF9F43']
            });

        } else {
            // Hi·ªáu ·ª©ng SAI
            btnElement.classList.add('wrong');
            iconContainer.innerHTML = '<i class="fas fa-times-circle"></i>';
            playSound('wrong');

            // Hi·ªÉn th·ªã ƒë√°p √°n ƒë√∫ng
            questionData.options.forEach((opt, index) => {
                if (opt.correct) {
                    const correctBtn = allButtons[index];
                    correctBtn.classList.add('correct');
                    correctBtn.querySelector('.option-icon').innerHTML = '<i class="fas fa-check-circle"></i>';
                }
            });
        }

        // Hi·ªán gi·∫£i th√≠ch
        explanationBox.style.display = 'block';
    }

    function toggleHint(id) {
        const hint = document.getElementById(`hint-${id}`);
        hint.style.display = hint.style.display === 'block' ? 'none' : 'block';
    }

    function finishQuiz() {
        const modal = document.getElementById('result-modal');
        const emoji = document.getElementById('result-emoji');
        const title = document.getElementById('result-title');
        const message = document.getElementById('result-message');
        const scoreText = document.getElementById('final-score');

        scoreText.innerText = `${currentScore} / ${totalQuestions}`;
        
        const percentage = (currentScore / totalQuestions) * 100;

        if (percentage === 100) {
            emoji.innerText = "üèÜ";
            title.innerText = "Xu·∫•t s·∫Øc tuy·ªát ƒë·ªëi!";
            message.innerText = "Em l√† thi√™n t√†i ti·∫øng Anh! C√¥ Mai An r·∫•t t·ª± h√†o.";
            playSound('correct');
            confetti({ particleCount: 200, spread: 100 });
        } else if (percentage >= 80) {
            emoji.innerText = "üéâ";
            title.innerText = "L√†m t·ªët l·∫Øm!";
            message.innerText = "Ki·∫øn th·ª©c c·ªßa em r·∫•t v·ªØng. C·ªë m·ªôt ch√∫t n·ªØa l√† ƒë∆∞·ª£c ƒëi·ªÉm t·ªëi ƒëa!";
            playSound('correct');
        } else if (percentage >= 50) {
            emoji.innerText = "üëç";
            title.innerText = "C·ªë g·∫Øng l√™n!";
            message.innerText = "Em ƒë√£ hi·ªÉu b√†i c∆° b·∫£n, nh∆∞ng c·∫ßn √¥n l·∫°i c√°c c·∫•u tr√∫c c√¢u nh√©.";
        } else {
            emoji.innerText = "üí™";
            title.innerText = "ƒê·ª´ng n·∫£n ch√≠!";
            message.innerText = "H√£y xem k·ªπ l·∫°i ph·∫ßn gi·∫£i th√≠ch chi ti·∫øt b√™n d∆∞·ªõi t·ª´ng c√¢u em nh√©.";
        }

        modal.style.display = 'flex';
    }

    function playSound(type) {
        const correctAudio = document.getElementById('sound-correct');
        const wrongAudio = document.getElementById('sound-wrong');
        
        // Reset time to allow rapid replay
        if (type === 'correct') {
            correctAudio.currentTime = 0;
            correctAudio.play().catch(e => console.log("Audio autoplay policy prevents sound"));
        } else {
            wrongAudio.currentTime = 0;
            wrongAudio.play().catch(e => console.log("Audio autoplay policy prevents sound"));
        }
    }
</script>

</body>
</html>
