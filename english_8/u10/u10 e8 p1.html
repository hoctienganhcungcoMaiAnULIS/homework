<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>B√†i T·∫≠p Ti·∫øng Anh - Ms Mai An ULIS</title>
    <link href="https://fonts.googleapis.com/css2?family=Nunito:wght@400;600;700;800&family=Quicksand:wght@500;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
    
    <style>
        :root {
            --primary: #8854C0; /* T√≠m h·ªìng */
            --secondary: #00C9A7; /* Xanh ng·ªçc */
            --correct: #00D26A; /* Xanh l√° */
            --wrong: #FF4757; /* ƒê·ªè cam */
            --bg-pattern: #f0f2f5;
            --text-color: #2c3e50;
        }

        body {
            font-family: 'Nunito', sans-serif;
            background-color: #e9e9e9;
            background-image: radial-gradient(#d7d7d7 1px, transparent 1px), radial-gradient(#d7d7d7 1px, transparent 1px);
            background-size: 20px 20px;
            background-position: 0 0, 10px 10px;
            color: var(--text-color);
            margin: 0;
            padding: 20px;
        }

        .container {
            max-width: 900px;
            margin: 0 auto;
            background: #fff;
            border-radius: 25px;
            box-shadow: 0 10px 30px rgba(0,0,0,0.1);
            overflow: hidden;
            border: 4px solid var(--primary);
        }

        /* HEADER */
        header {
            background: var(--primary);
            color: white;
            padding: 20px;
            text-align: center;
            border-bottom: 5px solid #6c429c;
        }

        header h1 {
            margin: 0;
            font-family: 'Quicksand', sans-serif;
            font-size: 2em;
            text-transform: uppercase;
            letter-spacing: 1px;
        }

        header p {
            margin: 5px 0 0;
            font-size: 1.1em;
            opacity: 0.9;
        }

        /* SECTION STYLES */
        .section-title {
            background: var(--secondary);
            color: white;
            padding: 10px 20px;
            font-size: 1.2em;
            font-weight: 800;
            margin: 20px 0;
            display: inline-block;
            border-radius: 0 20px 20px 0;
            box-shadow: 3px 3px 0px #009e82;
        }

        .passage-box {
            background: #f8f9fa;
            border: 2px dashed #bdc3c7;
            border-radius: 15px;
            padding: 20px;
            margin: 20px;
            line-height: 1.8;
            font-size: 1.1em;
            position: relative;
        }

        .word-box {
            background: #fff3cd;
            border: 2px solid #ffeeba;
            border-radius: 15px;
            padding: 15px;
            margin: 20px;
            display: flex;
            flex-wrap: wrap;
            gap: 10px;
            justify-content: center;
        }

        .word-item {
            background: white;
            padding: 5px 15px;
            border-radius: 20px;
            border: 1px solid #ddd;
            font-weight: bold;
            color: #856404;
        }

        /* GAP FILL STYLES */
        .gap {
            display: inline-block;
            min-width: 80px;
            padding: 2px 10px;
            border-bottom: 3px solid var(--primary);
            color: var(--primary);
            font-weight: bold;
            cursor: pointer;
            transition: all 0.2s;
            text-align: center;
            background: rgba(136, 84, 192, 0.1);
            border-radius: 5px;
        }

        .gap:hover {
            background: var(--primary);
            color: white;
            transform: scale(1.1);
        }

        .gap.correct {
            border-color: var(--correct);
            background: var(--correct);
            color: white;
        }

        .gap.wrong {
            border-color: var(--wrong);
            background: var(--wrong);
            color: white;
            animation: shake 0.5s;
        }

        /* POPUP MODAL */
        .modal {
            display: none;
            position: fixed;
            z-index: 1000;
            left: 0;
            top: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0,0,0,0.5);
            justify-content: center;
            align-items: center;
        }

        .modal-content {
            background-color: white;
            padding: 30px;
            border-radius: 25px;
            width: 80%;
            max-width: 500px;
            text-align: center;
            border: 5px solid var(--secondary);
            box-shadow: 0 10px 40px rgba(0,0,0,0.3);
            animation: popIn 0.3s cubic-bezier(0.175, 0.885, 0.32, 1.275);
        }

        .option-grid {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 15px;
            margin-top: 20px;
        }

        .option-btn {
            background: white;
            border: 2px solid #eee;
            padding: 15px;
            border-radius: 15px;
            font-family: 'Nunito', sans-serif;
            font-size: 1.1em;
            font-weight: 700;
            color: var(--text-color);
            cursor: pointer;
            transition: all 0.1s;
            box-shadow: 0 5px 0 #ddd;
        }

        .option-btn:active {
            transform: translateY(5px);
            box-shadow: 0 0 0 #ddd;
        }

        .option-btn:hover {
            border-color: var(--secondary);
        }

        /* READING QUESTIONS */
        .question-card {
            margin: 20px;
            padding: 20px;
            border: 2px solid #f0f0f0;
            border-radius: 20px;
            background: white;
        }

        .question-text {
            font-weight: 700;
            font-size: 1.1em;
            margin-bottom: 15px;
            color: #2c3e50;
        }

        /* True/False Specific */
        .tf-options {
            display: flex;
            gap: 20px;
            justify-content: flex-start;
        }
        
        .tf-btn {
            padding: 10px 30px;
            border-radius: 50px;
            border: none;
            font-weight: bold;
            cursor: pointer;
            font-size: 1em;
            box-shadow: 0 4px 0 rgba(0,0,0,0.2);
            transition: transform 0.1s;
        }
        
        .tf-btn.true-btn { background: #3498db; color: white; }
        .tf-btn.false-btn { background: #e74c3c; color: white; }
        .tf-btn.true-btn:active, .tf-btn.false-btn:active { transform: translateY(4px); box-shadow: none; }

        .mcq-option {
            display: block;
            width: 100%;
            text-align: left;
            margin-bottom: 10px;
            background: white;
            border: 2px solid #e0e0e0;
            padding: 12px 20px;
            border-radius: 12px;
            cursor: pointer;
            font-size: 1em;
            position: relative;
            box-shadow: 0 4px 0 #dcdcdc;
            transition: all 0.2s;
        }

        .mcq-option:hover {
            transform: scale(1.02);
            border-color: var(--primary);
        }

        .mcq-option.correct {
            background-color: var(--correct);
            color: white;
            border-color: #00b85c;
            box-shadow: 0 4px 0 #008f47;
        }

        .mcq-option.wrong {
            background-color: var(--wrong);
            color: white;
            border-color: #ff2e40;
            box-shadow: 0 4px 0 #cc1e2d;
            animation: shake 0.4s;
        }

        /* GLOSSARY TABLE */
        .glossary-table {
            width: calc(100% - 40px);
            margin: 20px;
            border-collapse: collapse;
            background: white;
            border-radius: 15px;
            overflow: hidden;
            box-shadow: 0 5px 15px rgba(0,0,0,0.05);
        }

        .glossary-table th {
            background: var(--primary);
            color: white;
            padding: 12px;
            text-align: left;
        }

        .glossary-table td {
            padding: 12px;
            border-bottom: 1px solid #eee;
        }

        .glossary-table tr:nth-child(even) {
            background-color: #f8f9fa;
        }

        /* EXPLANATION BOX */
        .explanation {
            display: none;
            margin-top: 15px;
            padding: 15px;
            background: #e8f8f5;
            border-left: 5px solid var(--secondary);
            border-radius: 5px;
            font-size: 0.95em;
            animation: slideDown 0.3s;
        }

        .teacher-tag {
            font-weight: 800;
            color: var(--primary);
            display: block;
            margin-bottom: 5px;
        }

        .exp-section {
            margin-bottom: 8px;
        }
        
        .exp-label {
            font-weight: bold;
            color: #34495e;
            text-decoration: underline;
        }

        /* SUBMIT & FOOTER */
        .footer-controls {
            padding: 30px;
            text-align: center;
            background: #f8f9fa;
        }

        .submit-btn {
            background: var(--primary);
            color: white;
            border: none;
            padding: 15px 50px;
            font-size: 1.5em;
            font-family: 'Quicksand', sans-serif;
            font-weight: 700;
            border-radius: 50px;
            cursor: pointer;
            box-shadow: 0 8px 0 #5f3a87;
            transition: transform 0.1s;
        }

        .submit-btn:active {
            transform: translateY(8px);
            box-shadow: none;
        }

        /* ANIMATIONS */
        @keyframes shake {
            0% { transform: translateX(0); }
            25% { transform: translateX(-10px); }
            50% { transform: translateX(10px); }
            75% { transform: translateX(-10px); }
            100% { transform: translateX(0); }
        }

        @keyframes popIn {
            0% { transform: scale(0.5); opacity: 0; }
            100% { transform: scale(1); opacity: 1; }
        }

        @keyframes slideDown {
            from { opacity: 0; transform: translateY(-10px); }
            to { opacity: 1; transform: translateY(0); }
        }

        /* CONFETTI CANVAS */
        #confetti-canvas {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            pointer-events: none;
            z-index: 9999;
        }
    </style>
</head>
<body>

<canvas id="confetti-canvas"></canvas>

<div class="container">
    <header>
        <h1>B√†i Ki·ªÉm Tra Ti·∫øng Anh</h1>
        <p><i class="fas fa-chalkboard-teacher"></i> Gi√°o vi√™n: Ms. Mai An (Th·∫°c s·ªπ ULIS)</p>
    </header>

    <div class="section-title">D. READING - I. Gap Fill</div>
    
    <div class="word-box">
        <span class="word-item">conferencing</span>
        <span class="word-item">directly</span>
        <span class="word-item">telepathy</span>
        <span class="word-item">change</span>
        <span class="word-item">enough</span>
        <span class="word-item">digital</span>
        <span class="word-item">transmit</span>
        <span class="word-item">smartphone</span>
    </div>

    <div class="passage-box">
        <h3 style="text-align: center; color: var(--primary);">FUTURE COMMUNICATION</h3>
        <p>
            One way we might see communication <span class="gap" id="gap-1" onclick="openGapModal(1)">[1]</span> in the future is through augmented reality (AR). In an augmented-reality system, you view the world through a technological overlay. This could take the form of a hand-held device like a <span class="gap" id="gap-2" onclick="openGapModal(2)">[2]</span>. In either case, there are several augmented-reality applications already available for some phones. Another possible application is through a set of augmented-reality glasses. In either case, you can view the world around you and see real-time <span class="gap" id="gap-3" onclick="openGapModal(3)">[3]</span> information about what you're viewing.
        </p>
        <p>
            Then there's video <span class="gap" id="gap-4" onclick="openGapModal(4)">[4]</span>. While the technology has existed for years, video calls aren't popular. It might be because the hardware hasn't been compelling or cost-effective <span class="gap" id="gap-5" onclick="openGapModal(5)">[5]</span>. But now webcams are starting to appear on televisions and are standard on many laptops. Are we about to enter an era of video conferencing?
        </p>
        <p>
            In the distant future, we may be able to communicate by sending our thoughts through a network <span class="gap" id="gap-6" onclick="openGapModal(6)">[6]</span> into someone else's brain. We're decades away from such technology, but scientists are working on creating brain-computer interfaces that allow people to <span class="gap" id="gap-7" onclick="openGapModal(7)">[7]</span> thoughts directly to a computer. Perhaps 50 years from now we'll all use an electronic version of <span class="gap" id="gap-8" onclick="openGapModal(8)">[8]</span>.
        </p>
        
        <hr>
        <p><em>Glossary provided:</em> augmented reality (n): th·ª±c t·∫ø ·∫£o tƒÉng c∆∞·ªùng - overlay (n): l·ªõp ph·ªß</p>

        <div id="gap-explanations"></div>
    </div>

    <div class="section-title">II. Reading Comprehension</div>

    <div class="passage-box">
        <h3 style="text-align: center; color: var(--primary);">ARTIFICIAL INTELLIGENCE IN COMMUNICATION</h3>
        <p>
            Artificial Intelligence (AI) is poised to play a pivotal role in shaping the future of communication. AI, with its ability to learn, adapt, and mimic human intelligence, is already transforming how we communicate. Chatbots and virtual assistants like Siri, Alexa, and Google Assistant are prime examples of AI in communication. They understand human language, respond intelligently, and learn from interactions to improve future responses. These AI-powered tools are expected to become more sophisticated, offering more personalized and human-like interactions.
        </p>
        <p>
            AI is also enhancing communication through language translation. Tools like Google Translate are breaking down language barriers, enabling seamless communication across different languages. Future advancements may lead to real-time, accurate translation, making global communication more accessible.
        </p>
        <p>
            AI is revolutionizing business communication. AI-powered analytics tools can analyze communication patterns, customer feedback, and social media sentiment to provide actionable insights. This can help businesses improve their communication strategies and customer engagement.
        </p>
        <p>
            The integration of AI in communication also raises ethical and privacy concerns. As AI systems learn from our communication, they collect vast amounts of personal data, raising questions about data security and privacy.
        </p>
    </div>

    <h3 style="margin-left: 20px; color: var(--primary);">üìñ Academic Vocabulary (T·ª´ v·ª±ng n√¢ng cao)</h3>
    <table class="glossary-table">
        <thead>
            <tr>
                <th>Word</th>
                <th>Type</th>
                <th>Meaning (Vietnamese)</th>
            </tr>
        </thead>
        <tbody>
            <tr><td>Poised</td><td>(adj)</td><td>Trong t∆∞ th·∫ø s·∫µn s√†ng, ch·∫Øc ch·∫Øn s·∫Ω x·∫£y ra</td></tr>
            <tr><td>Pivotal</td><td>(adj)</td><td>Then ch·ªët, m·∫•u ch·ªët</td></tr>
            <tr><td>Mimic</td><td>(v)</td><td>B·∫Øt ch∆∞·ªõc, m√¥ ph·ªèng</td></tr>
            <tr><td>Sophisticated</td><td>(adj)</td><td>Tinh vi, ph·ª©c t·∫°p, c√¥ng phu</td></tr>
            <tr><td>Seamless</td><td>(adj)</td><td>Li·ªÅn m·∫°ch, kh√¥ng gi√°n ƒëo·∫°n</td></tr>
            <tr><td>Accessible</td><td>(adj)</td><td>D·ªÖ ti·∫øp c·∫≠n</td></tr>
            <tr><td>Sentiment</td><td>(n)</td><td>Th√°i ƒë·ªô, c·∫£m nghƒ©, t√¨nh c·∫£m</td></tr>
            <tr><td>Actionable</td><td>(adj)</td><td>C√≥ th·ªÉ th·ª±c hi·ªán ƒë∆∞·ª£c, c√≥ t√≠nh ·ª©ng d·ª•ng</td></tr>
            <tr><td>Integration</td><td>(n)</td><td>S·ª± t√≠ch h·ª£p, h·ªôi nh·∫≠p</td></tr>
        </tbody>
    </table>

    <div style="margin: 20px;">
        <h3 style="color: var(--secondary);">A. Decide whether the following statements are true (T) or false (F).</h3>
        <div id="tf-questions"></div>
    </div>

    <div style="margin: 20px;">
        <h3 style="color: var(--secondary);">B. Choose the correct answer.</h3>
        <div id="mcq-questions"></div>
    </div>

    <div class="footer-controls">
        <button class="submit-btn" onclick="submitTest()">N·ªòP B√ÄI <i class="fas fa-paper-plane"></i></button>
    </div>
</div>

<div id="gapModal" class="modal">
    <div class="modal-content">
        <h3 style="color: var(--primary)">Ch·ªçn t·ª´ cho v·ªã tr√≠ <span id="currentGapNum"></span></h3>
        <div class="option-grid" id="gapOptionsGrid">
            </div>
        <button onclick="closeModal()" style="margin-top: 20px; background: #95a5a6; color: white; border: none; padding: 10px 20px; border-radius: 10px; cursor: pointer;">ƒê√≥ng</button>
    </div>
</div>

<script>
    // --- D·ªÆ LI·ªÜU C√ÇU H·ªéI & GI·∫¢I TH√çCH ---
    
    // PART 1: GAP FILL DATA
    const gapData = [
        {
            id: 1,
            correct: "change",
            explain: "<b>D·ªãch c√¢u:</b> M·ªôt c√°ch ch√∫ng ta c√≥ th·ªÉ th·∫•y giao ti·∫øp <u>thay ƒë·ªïi</u> trong t∆∞∆°ng lai l√† qua th·ª±c t·∫ø ·∫£o...<br><b>T·∫°i sao 'change' ƒë√∫ng:</b> C·∫•u tr√∫c 'see + Object + verb(nguy√™n th·ªÉ)/V-ing'. ·ªû ƒë√¢y n√≥i v·ªÅ s·ª± thay ƒë·ªïi chung n√™n d√πng 'change'.<br><b>T·∫°i sao sai:</b> C√°c t·ª´ kh√°c kh√¥ng h·ª£p nghƒ©a trong ng·ªØ c·∫£nh 's·ª± thay ƒë·ªïi c·ªßa giao ti·∫øp'."
        },
        {
            id: 2,
            correct: "smartphone",
            explain: "<b>D·ªãch c√¢u:</b> ...m·ªôt thi·∫øt b·ªã c·∫ßm tay gi·ªëng nh∆∞ m·ªôt <u>chi·∫øc ƒëi·ªán tho·∫°i th√¥ng minh</u>.<br><b>T·∫°i sao ƒë√∫ng:</b> 'Hand-held device' (thi·∫øt b·ªã c·∫ßm tay) th√¨ v√≠ d·ª• ƒëi·ªÉn h√¨nh nh·∫•t trong h·ªôp t·ª´ l√† 'smartphone'.<br><b>T·∫°i sao sai:</b> 'Telepathy' hay 'Conferencing' kh√¥ng ph·∫£i l√† thi·∫øt b·ªã."
        },
        {
            id: 3,
            correct: "digital",
            explain: "<b>D·ªãch c√¢u:</b> ...nh√¨n th·∫ø gi·ªõi xung quanh v√† th·∫•y th√¥ng tin <u>k·ªπ thu·∫≠t s·ªë</u> theo th·ªùi gian th·ª±c...<br><b>T·∫°i sao ƒë√∫ng:</b> 'Digital information' l√† c·ª•m t·ª´ ch·ªâ th√¥ng tin s·ªë h√≥a (hi·ªÉn th·ªã tr√™n k√≠nh/m√†n h√¨nh) ch·ªìng l√™n th·∫ø gi·ªõi th·ª±c.<br><b>T·∫°i sao sai:</b> 'Transmit' l√† ƒë·ªông t·ª´, 'Enough' l√† tr·∫°ng t·ª´/t√≠nh t·ª´ ƒë·ªãnh l∆∞·ª£ng kh√¥ng h·ª£p nghƒ©a."
        },
        {
            id: 4,
            correct: "conferencing",
            explain: "<b>D·ªãch c√¢u:</b> Ti·∫øp theo l√† <u>h·ªôi ngh·ªã</u> truy·ªÅn h√¨nh (video conferencing).<br><b>T·∫°i sao ƒë√∫ng:</b> Collocation (c·ª•m t·ª´ c·ªë ƒë·ªãnh) 'Video conferencing' nghƒ©a l√† h·ªçp tr·ª±c tuy·∫øn/h·ªôi ngh·ªã truy·ªÅn h√¨nh.<br><b>T·∫°i sao sai:</b> Kh√¥ng ai n√≥i 'video change' hay 'video telepathy' trong ng·ªØ c·∫£nh c√¥ng ngh·ªá g·ªçi ƒëi·ªán."
        },
        {
            id: 5,
            correct: "enough",
            explain: "<b>D·ªãch c√¢u:</b> ...ph·∫ßn c·ª©ng ch∆∞a ƒë·ªß h·∫•p d·∫´n ho·∫∑c ch∆∞a <u>ƒë·ªß</u> hi·ªáu qu·∫£ v·ªÅ chi ph√≠.<br><b>T·∫°i sao ƒë√∫ng:</b> C·∫•u tr√∫c 'Adj + enough' (cost-effective enough).<br><b>T·∫°i sao sai:</b> C√°c t·ª´ c√≤n l·∫°i kh√¥ng ƒë·ª©ng sau t√≠nh t·ª´ ƒë·ªÉ b·ªï nghƒ©a theo c√°ch n√†y."
        },
        {
            id: 6,
            correct: "directly",
            explain: "<b>D·ªãch c√¢u:</b> ...g·ª≠i suy nghƒ© qua m·ªôt m·∫°ng l∆∞·ªõi <u>tr·ª±c ti·∫øp</u> v√†o n√£o ng∆∞·ªùi kh√°c.<br><b>T·∫°i sao ƒë√∫ng:</b> C·∫ßn m·ªôt tr·∫°ng t·ª´ b·ªï nghƒ©a cho c·ª•m gi·ªõi t·ª´ 'into...'. 'Directly into' (tr·ª±c ti·∫øp v√†o) l√† h·ª£p l√Ω nh·∫•t.<br><b>T·∫°i sao sai:</b> 'Transmit' l√† ƒë·ªông t·ª´ (c√¢u ƒë√£ c√≥ V-ing 'sending'), 'Change' kh√¥ng h·ª£p nghƒ©a."
        },
        {
            id: 7,
            correct: "transmit",
            explain: "<b>D·ªãch c√¢u:</b> ...cho ph√©p con ng∆∞·ªùi <u>truy·ªÅn t·∫£i</u> suy nghƒ© tr·ª±c ti·∫øp ƒë·∫øn m√°y t√≠nh.<br><b>T·∫°i sao ƒë√∫ng:</b> C·∫•u tr√∫c 'allow sb to V'. C·∫ßn m·ªôt ƒë·ªông t·ª´. 'Transmit thoughts' (truy·ªÅn suy nghƒ©) l√† collocations chu·∫©n trong b√†i khoa h·ªçc.<br><b>T·∫°i sao sai:</b> 'Telepathy' l√† danh t·ª´."
        },
        {
            id: 8,
            correct: "telepathy",
            explain: "<b>D·ªãch c√¢u:</b> ...ch√∫ng ta s·∫Ω s·ª≠ d·ª•ng m·ªôt phi√™n b·∫£n ƒëi·ªán t·ª≠ c·ªßa <u>th·∫ßn giao c√°ch c·∫£m</u>.<br><b>T·∫°i sao ƒë√∫ng:</b> Ng·ªØ c·∫£nh n√≥i v·ªÅ vi·ªác truy·ªÅn suy nghƒ© qua n√£o -> ƒë√≥ l√† ƒë·ªãnh nghƒ©a c·ªßa 'Telepathy'.<br><b>T·∫°i sao sai:</b> ƒê√£ d√πng h·∫øt c√°c t·ª´ kh√°c."
        }
    ];

    const gapWords = ["conferencing", "directly", "telepathy", "change", "enough", "digital", "transmit", "smartphone"];

    // PART 2A: TRUE/FALSE DATA
    const tfData = [
        {
            id: "tf1",
            text: "Artificial intelligence has the ability to mimic human intelligence.",
            correct: true,
            explain: "<b>D·ªãch:</b> Tr√≠ tu·ªá nh√¢n t·∫°o c√≥ kh·∫£ nƒÉng b·∫Øt ch∆∞·ªõc tr√≠ th√¥ng minh con ng∆∞·ªùi.<br><b>D·∫´n ch·ª©ng:</b> B√†i ƒë·ªçc ƒëo·∫°n 1: 'AI, with its ability to learn, adapt, and <u>mimic human intelligence</u>...' (AI, v·ªõi kh·∫£ nƒÉng h·ªçc, th√≠ch nghi v√† b·∫Øt ch∆∞·ªõc tr√≠ th√¥ng minh con ng∆∞·ªùi...)."
        },
        {
            id: "tf2",
            text: "Siri, Alexa and Google Assistant are the only examples of AI in communication.",
            correct: false,
            explain: "<b>D·ªãch:</b> Siri, Alexa v√† Google Assistant l√† nh·ªØng v√≠ d·ª• DUY NH·∫§T v·ªÅ AI trong giao ti·∫øp.<br><b>T·∫°i sao SAI:</b> B√†i ƒë·ªçc n√≥i ch√∫ng l√† 'prime examples' (v√≠ d·ª• ƒëi·ªÉn h√¨nh), kh√¥ng ph·∫£i 'only examples'. Ngo√†i ra ƒëo·∫°n d∆∞·ªõi c√≤n nh·∫Øc ƒë·∫øn Google Translate v√† Business tools."
        },
        {
            id: "tf3",
            text: "Google Translate is a form of artificial intelligence.",
            correct: true,
            explain: "<b>D·ªãch:</b> Google Translate l√† m·ªôt d·∫°ng tr√≠ tu·ªá nh√¢n t·∫°o.<br><b>D·∫´n ch·ª©ng:</b> ƒêo·∫°n 2: 'AI is also enhancing communication through language translation. Tools like Google Translate...'. C√¢u n√†y x·∫øp Google Translate v√†o nh√≥m c√¥ng c·ª• AI."
        },
        {
            id: "tf4",
            text: "Businesses can use AI in their communication with customers.",
            correct: true,
            explain: "<b>D·ªãch:</b> C√°c doanh nghi·ªáp c√≥ th·ªÉ s·ª≠ d·ª•ng AI trong giao ti·∫øp v·ªõi kh√°ch h√†ng.<br><b>D·∫´n ch·ª©ng:</b> ƒêo·∫°n 3: 'This can help businesses improve their communication strategies and customer engagement.' (ƒêi·ªÅu n√†y gi√∫p DN c·∫£i thi·ªán chi·∫øn l∆∞·ª£c giao ti·∫øp v√† t∆∞∆°ng t√°c kh√°ch h√†ng)."
        },
        {
            id: "tf5",
            text: "There is no one questioning the data security and privacy when using AI.",
            correct: false,
            explain: "<b>D·ªãch:</b> KH√îNG C√ì AI ƒë·∫∑t c√¢u h·ªèi v·ªÅ b·∫£o m·∫≠t d·ªØ li·ªáu v√† quy·ªÅn ri√™ng t∆∞ khi d√πng AI.<br><b>T·∫°i sao SAI:</b> ƒêo·∫°n cu·ªëi: '...raising questions about data security and privacy' (d·∫•y l√™n nh·ªØng c√¢u h·ªèi v·ªÅ b·∫£o m·∫≠t...)."
        }
    ];

    // PART 2B: MCQ DATA
    const mcqData = [
        {
            id: "mcq1",
            question: "What is NOT mentioned about artificial intelligence?",
            options: [
                "A. It helps in many different fields, such as language and business.",
                "B. It will soon replace other means of communication in the future.",
                "C. It can be more advanced in the future.",
                "D. There are some doubts about its data security and privacy."
            ],
            correctIndex: 1, // B
            explain: "<b>D·ªãch c√¢u h·ªèi:</b> ƒêi·ªÅu g√¨ KH√îNG ƒë∆∞·ª£c nh·∫Øc ƒë·∫øn v·ªÅ AI?<br><b>Ph√¢n t√≠ch:</b><br>- A: C√≥ nh·∫Øc (Language ·ªü ƒëo·∫°n 2, Business ·ªü ƒëo·∫°n 3).<br>- C: C√≥ nh·∫Øc (ƒêo·∫°n 1: 'expected to become more sophisticated').<br>- D: C√≥ nh·∫Øc (ƒêo·∫°n 4: 'raises ethical and privacy concerns').<br>-> <b>Ch·ªçn B:</b> B√†i ƒë·ªçc kh√¥ng n√≥i AI s·∫Ω 'thay th·∫ø ho√†n to√†n' (replace) c√°c ph∆∞∆°ng ti·ªán kh√°c, ch·ªâ n√≥i n√≥ ƒë√≥ng vai tr√≤ then ch·ªët (pivotal role)."
        },
        {
            id: "mcq2",
            question: "Siri, Alexa and Google Assistant can __________",
            options: [
                "A. learn from its interactions with human",
                "B. improve human language",
                "C. respond to each other intelligently",
                "D. understand human"
            ],
            correctIndex: 0, // A
            explain: "<b>D·ªãch c√¢u h·ªèi:</b> Siri, Alexa... c√≥ th·ªÉ l√†m g√¨?<br><b>T·∫°i sao ƒë√∫ng (A):</b> ƒêo·∫°n 1: '...learn from interactions to improve future responses' (h·ªçc t·ª´ c√°c t∆∞∆°ng t√°c).<br><b>T·∫°i sao sai:</b><br>- B: Kh√¥ng n√≥i c·∫£i thi·ªán ng√¥n ng·ªØ con ng∆∞·ªùi.<br>- C: Respond to 'each other' (nhau) l√† sai, n√≥ ph·∫£n h·ªìi con ng∆∞·ªùi.<br>- D: 'Understand human' thi·∫øu ng·ªØ c·∫£nh (Understand human language th√¨ ƒë√∫ng)."
        },
        {
            id: "mcq3",
            question: "How does Google Translate help in communication?",
            options: [
                "A. It creates global communication.",
                "B. It provides real-time conversations.",
                "C. It helps to get access to different languages.",
                "D. It helps to break down language barriers."
            ],
            correctIndex: 3, // D
            explain: "<b>D·ªãch c√¢u h·ªèi:</b> Google Translate gi√∫p g√¨?<br><b>T·∫°i sao ƒë√∫ng (D):</b> ƒêo·∫°n 2: 'Tools like Google Translate are breaking down language barriers' (ph√° b·ªè r√†o c·∫£n ng√¥n ng·ªØ).<br><b>T·∫°i sao sai:</b> A, B, C l√† suy lu·∫≠n c√≥ th·ªÉ ƒë√∫ng nh∆∞ng D l√† ƒë√°p √°n tr√≠ch d·∫´n tr·ª±c ti·∫øp v√† ch√≠nh x√°c nh·∫•t t·ª´ b√†i."
        },
        {
            id: "mcq4",
            question: "AI-powered analytics tools __________",
            options: [
                "A. respond to customer feedback",
                "B. improve a business",
                "C. help with communication strategies",
                "D. provide social media sentiment"
            ],
            correctIndex: 2, // C
            explain: "<b>D·ªãch c√¢u h·ªèi:</b> C√°c c√¥ng c·ª• ph√¢n t√≠ch t√≠ch h·ª£p AI l√†m g√¨?<br><b>T·∫°i sao ƒë√∫ng (C):</b> ƒêo·∫°n 3: 'This can help businesses improve their communication strategies' (gi√∫p doanh nghi·ªáp c·∫£i thi·ªán chi·∫øn l∆∞·ª£c giao ti·∫øp).<br><b>T·∫°i sao sai:</b><br>- A: N√≥ 'analyze' (ph√¢n t√≠ch) feedback ch·ª© kh√¥ng ph·∫£i 'respond' (tr·∫£ l·ªùi).<br>- D: N√≥ ph√¢n t√≠ch sentiment ch·ª© kh√¥ng 'provide' (cung c·∫•p) c·∫£m x√∫c."
        },
        {
            id: "mcq5",
            question: "What does the writer think may be a problem with AI in communication?",
            options: [
                "A. AI may collect private information from people.",
                "B. AI can offer human-like interactions.",
                "C. AI is revolutionizing business communication.",
                "D. AI may lead to inaccurate translation."
            ],
            correctIndex: 0, // A
            explain: "<b>D·ªãch c√¢u h·ªèi:</b> T√°c gi·∫£ nghƒ© v·∫•n ƒë·ªÅ g√¨ c√≥ th·ªÉ x·∫£y ra?<br><b>T·∫°i sao ƒë√∫ng (A):</b> ƒêo·∫°n 4: '...collect vast amounts of personal data, raising questions about data security' (thu th·∫≠p l∆∞·ª£ng l·ªõn d·ªØ li·ªáu c√° nh√¢n...).<br><b>T·∫°i sao sai:</b> B, C l√† m·∫∑t t√≠ch c·ª±c. D kh√¥ng ƒë∆∞·ª£c nh·∫Øc ƒë·∫øn l√† v·∫•n ƒë·ªÅ ch√≠nh (b√†i n√≥i translation s·∫Ω accurate h∆°n)."
        },
        {
            id: "mcq6",
            question: "What is the passage mainly about?",
            options: [
                "A. The advantages and disadvantages of AI",
                "B. The role of AI in future communication",
                "C. How AI helps in business communication",
                "D. AI and its ethical and privacy concerns"
            ],
            correctIndex: 1, // B
            explain: "<b>D·ªãch c√¢u h·ªèi:</b> √ù ch√≠nh c·ªßa b√†i l√† g√¨?<br><b>T·∫°i sao ƒë√∫ng (B):</b> C√¢u ƒë·∫ßu ti√™n: 'AI is poised to play a pivotal role in shaping the future of communication.' (AI ƒë·ªãnh h√¨nh t∆∞∆°ng lai giao ti·∫øp). C√°c ƒëo·∫°n sau tri·ªÉn khai √Ω n√†y (Giao ti·∫øp c√° nh√¢n, d·ªãch thu·∫≠t, kinh doanh, v√† r·ªßi ro).<br><b>T·∫°i sao sai:</b> A qu√° chung chung. C v√† D ch·ªâ l√† √Ω nh·ªè c·ªßa t·ª´ng ƒëo·∫°n."
        }
    ];

    // --- LOGIC GIAO DI·ªÜN & X·ª¨ L√ù ---

    let score = 0;
    let totalQuestions = gapData.length + tfData.length + mcqData.length;
    let currentGapId = null;

    // √Çm thanh (Base64 ng·∫Øn g·ªçn)
    const audioCorrect = new Audio('https://assets.mixkit.co/active_storage/sfx/2000/2000-preview.mp3'); // Ding
    const audioWrong = new Audio('https://assets.mixkit.co/active_storage/sfx/2955/2955-preview.mp3');   // Error

    function playSound(isCorrect) {
        if (isCorrect) {
            audioCorrect.currentTime = 0;
            audioCorrect.play().catch(e=>{});
        } else {
            audioWrong.currentTime = 0;
            audioWrong.play().catch(e=>{});
        }
    }

    // 1. RENDER QUESTIONS
    
    // Render T/F
    const tfContainer = document.getElementById('tf-questions');
    tfData.forEach(item => {
        const div = document.createElement('div');
        div.className = 'question-card';
        div.innerHTML = `
            <div class="question-text"><i class="fas fa-question-circle" style="color:var(--primary)"></i> ${item.text}</div>
            <div class="tf-options">
                <button class="tf-btn true-btn" onclick="checkTF(this, '${item.id}', true)">TRUE</button>
                <button class="tf-btn false-btn" onclick="checkTF(this, '${item.id}', false)">FALSE</button>
            </div>
            <div id="exp-${item.id}" class="explanation"></div>
        `;
        tfContainer.appendChild(div);
    });

    // Render MCQ
    const mcqContainer = document.getElementById('mcq-questions');
    mcqData.forEach((item, index) => {
        const div = document.createElement('div');
        div.className = 'question-card';
        let optionsHTML = '';
        item.options.forEach((opt, idx) => {
            optionsHTML += `<button class="mcq-option" onclick="checkMCQ(this, '${item.id}', ${idx})">${opt}</button>`;
        });
        
        div.innerHTML = `
            <div class="question-text">Q${index+1}: ${item.question}</div>
            <div>${optionsHTML}</div>
            <div id="exp-${item.id}" class="explanation"></div>
        `;
        mcqContainer.appendChild(div);
    });

    // 2. LOGIC GAP FILL
    function openGapModal(id) {
        currentGapId = id;
        document.getElementById('currentGapNum').innerText = id;
        const grid = document.getElementById('gapOptionsGrid');
        grid.innerHTML = '';
        
        gapWords.forEach(word => {
            const btn = document.createElement('button');
            btn.className = 'option-btn';
            btn.innerText = word;
            btn.onclick = () => selectGapWord(word);
            grid.appendChild(btn);
        });

        document.getElementById('gapModal').style.display = 'flex';
    }

    function closeModal() {
        document.getElementById('gapModal').style.display = 'none';
    }

    function selectGapWord(word) {
        closeModal();
        const gapEl = document.getElementById(`gap-${currentGapId}`);
        gapEl.innerText = word;
        
        // Ki·ªÉm tra ngay l·∫≠p t·ª©c
        const data = gapData.find(d => d.id === currentGapId);
        const expContainer = document.getElementById('gap-explanations');
        
        // T·∫°o ho·∫∑c update box gi·∫£i th√≠ch cho c√¢u n√†y
        let expBox = document.getElementById(`gap-exp-${currentGapId}`);
        if (!expBox) {
            expBox = document.createElement('div');
            expBox.id = `gap-exp-${currentGapId}`;
            expBox.className = 'explanation';
            expBox.style.display = 'block'; // Show immediately
            // Insert theo th·ª© t·ª± id ƒë·ªÉ ƒë·∫πp
            expContainer.appendChild(expBox);
        }

        if (word.toLowerCase() === data.correct) {
            gapEl.className = 'gap correct';
            playSound(true);
            triggerConfetti();
            expBox.innerHTML = `<span class="teacher-tag"><i class="fas fa-check-circle"></i> C√¢u ${currentGapId}: Ch√≠nh x√°c!</span>` + data.explain;
        } else {
            gapEl.className = 'gap wrong';
            playSound(false);
            expBox.innerHTML = `<span class="teacher-tag" style="color:var(--wrong)"><i class="fas fa-times-circle"></i> C√¢u ${currentGapId}: Sai r·ªìi!</span>` + 
                `ƒê√°p √°n ƒë√∫ng l√†: <b>${data.correct}</b><br>` + data.explain;
        }
    }

    // 3. LOGIC CHECK T/F
    function checkTF(btn, id, userChoice) {
        // Disable buttons in this group
        const parent = btn.parentElement;
        const buttons = parent.getElementsByTagName('button');
        for(let b of buttons) b.disabled = true;

        const data = tfData.find(d => d.id === id);
        const isCorrect = (userChoice === data.correct);
        const expBox = document.getElementById(`exp-${id}`);
        expBox.style.display = 'block';

        if (isCorrect) {
            btn.style.boxShadow = "0 0 15px var(--correct)";
            btn.innerHTML += ' <i class="fas fa-check"></i>';
            playSound(true);
            triggerConfetti();
            expBox.innerHTML = `<span class="teacher-tag"><i class="fas fa-glasses"></i> C√¥ Mai An gi·∫£i th√≠ch:</span>` + data.explain;
        } else {
            btn.style.opacity = "0.5";
            // Highlight n√∫t ƒë√∫ng
            const correctBtn = data.correct ? parent.querySelector('.true-btn') : parent.querySelector('.false-btn');
            correctBtn.style.boxShadow = "0 0 15px var(--correct)";
            
            playSound(false);
            expBox.innerHTML = `<span class="teacher-tag" style="color:var(--wrong)">Ti·∫øc qu√°!</span>` + data.explain;
        }
    }

    // 4. LOGIC CHECK MCQ
    function checkMCQ(btn, id, choiceIdx) {
        const parent = btn.parentElement;
        const buttons = parent.getElementsByClassName('mcq-option');
        for(let b of buttons) {
            b.disabled = true;
            b.style.cursor = 'default';
        }

        const data = mcqData.find(d => d.id === id);
        const expBox = document.getElementById(`exp-${id}`);
        expBox.style.display = 'block';

        if (choiceIdx === data.correctIndex) {
            btn.classList.add('correct');
            playSound(true);
            triggerConfetti();
            expBox.innerHTML = `<span class="teacher-tag"><i class="fas fa-star"></i> Xu·∫•t s·∫Øc!</span>` + data.explain;
        } else {
            btn.classList.add('wrong');
            // Show correct one
            buttons[data.correctIndex].classList.add('correct');
            playSound(false);
            expBox.innerHTML = `<span class="teacher-tag" style="color:var(--wrong)">Ch∆∞a ƒë√∫ng r·ªìi!</span>` + data.explain;
        }
    }

    // 5. SUBMIT & SCORE
    function submitTest() {
        // Simple count logic: check visual classes or state
        let correctCount = 0;
        
        // Count Gap Fill
        document.querySelectorAll('.gap.correct').forEach(() => correctCount++);
        
        // Count T/F (Check disabled buttons styling)
        tfData.forEach(d => {
            const container = document.getElementById(`exp-${d.id}`);
            if(container.innerHTML.includes("Ch√≠nh x√°c") || container.innerHTML.includes("C√¥ Mai An")) correctCount++;
        });

        // Count MCQ
        mcqData.forEach(d => {
            const container = document.getElementById(`exp-${d.id}`);
            if(container.innerHTML.includes("Xu·∫•t s·∫Øc")) correctCount++;
        });

        let msg = "";
        const percentage = (correctCount / totalQuestions) * 100;
        
        if(percentage === 100) msg = "TUY·ªÜT ƒê·ªêI! Em l√† thi√™n t√†i ti·∫øng Anh! üåü";
        else if(percentage >= 80) msg = "R·∫•t gi·ªèi! C√¥ r·∫•t t·ª± h√†o v·ªÅ em! üéâ";
        else if(percentage >= 50) msg = "Kh√° l·∫Øm! C·ªë g·∫Øng th√™m ch√∫t n·ªØa nh√©! üí™";
        else msg = "ƒê·ª´ng bu·ªìn! H√£y xem k·ªπ ph·∫ßn gi·∫£i th√≠ch c·ªßa c√¥ nh√©! ‚ù§Ô∏è";

        alert(`K·∫æT QU·∫¢ C·ª¶A EM:\n\nS·ªë c√¢u ƒë√∫ng: ${correctCount}/${totalQuestions}\n\n${msg}`);
        if(percentage >= 80) triggerConfetti();
    }

    // --- CONFETTI EFFECT SCRIPT (Minimal) ---
    const canvas = document.getElementById("confetti-canvas");
    const ctx = canvas.getContext("2d");
    canvas.width = window.innerWidth;
    canvas.height = window.innerHeight;
    let confetti = [];

    function triggerConfetti() {
        for (let i = 0; i < 100; i++) {
            confetti.push({
                x: Math.random() * canvas.width,
                y: Math.random() * canvas.height - canvas.height,
                color: `hsl(${Math.random() * 360}, 100%, 50%)`,
                size: Math.random() * 10 + 5,
                speed: Math.random() * 5 + 2,
                angle: Math.random() * 360
            });
        }
        animateConfetti();
    }

    function animateConfetti() {
        ctx.clearRect(0, 0, canvas.width, canvas.height);
        confetti.forEach((p, index) => {
            p.y += p.speed;
            p.x += Math.sin(p.angle) * 2;
            ctx.fillStyle = p.color;
            ctx.fillRect(p.x, p.y, p.size, p.size);
            if (p.y > canvas.height) confetti.splice(index, 1);
        });
        if (confetti.length > 0) requestAnimationFrame(animateConfetti);
    }

    // Resize canvas fix
    window.addEventListener('resize', () => {
        canvas.width = window.innerWidth;
        canvas.height = window.innerHeight;
    });

</script>
</body>
</html>