<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Ms Mai An ULIS - The Great Trail Reading</title>
    <link href="https://fonts.googleapis.com/css2?family=Quicksand:wght@500;700;900&display=swap" rel="stylesheet">
    <style>
        :root {
            /* Nature & Hiking Theme */
            --primary: #27ae60;      /* Forest Green */
            --secondary: #d35400;    /* Earthy Brown */
            --accent: #f39c12;       /* Autumn Yellow */
            --correct: #2ecc71;      /* Emerald */
            --wrong: #e74c3c;        /* Red */
            --text-dark: #2c3e50;
        }

        * {
            box-sizing: border-box;
            font-family: 'Quicksand', sans-serif;
            margin: 0;
            padding: 0;
        }

        /* 1. L·ªöP N·ªÄN ANIMATED GRADIENT (M∆Ø·ª¢T M√Ä) */
        body {
            overflow: hidden;
            color: var(--text-dark);
            background: linear-gradient(-45deg, #a8e063, #56ab2f, #f1c40f, #e67e22);
            background-size: 400% 400%;
            animation: smoothGradient 20s ease infinite;
            height: 100vh;
            position: relative;
        }

        @keyframes smoothGradient {
            0% { background-position: 0% 50%; }
            50% { background-position: 100% 50%; }
            100% { background-position: 0% 50%; }
        }

        /* 2. L·ªöP H·ªåA TI·∫æT SVG TR√îI N·ªîI ƒê·ªòC L·∫¨P */
        .pattern-overlay {
            position: fixed;
            top: 0; left: 0; width: 100%; height: 100%;
            /* Emojis: Pine Tree, Maple Leaf, Bear, Hiking Boot */
            background-image: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='250' height='250'%3E%3Ctext x='20' y='60' font-size='45'%3Eüå≤%3C/text%3E%3Ctext x='150' y='120' font-size='40'%3EüçÅ%3C/text%3E%3Ctext x='40' y='210' font-size='45'%3Eüêª%3C/text%3E%3Ctext x='180' y='230' font-size='35'%3Eü•æ%3C/text%3E%3C/svg%3E");
            opacity: 0.25;
            pointer-events: none;
            z-index: 1;
            animation: floatSVG 45s linear infinite;
        }

        @keyframes floatSVG {
            from { background-position: 0 0; }
            to { background-position: 600px 600px; }
        }

        /* TOP CONTROL BAR */
        header {
            position: relative;
            z-index: 10;
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 15px 30px;
            background: rgba(255, 255, 255, 0.95);
            box-shadow: 0 6px 20px rgba(39, 174, 96, 0.2);
            border-bottom: 5px solid var(--primary);
        }

        .header-title {
            font-size: 1.5rem;
            color: var(--primary);
            font-weight: 900;
            text-transform: uppercase;
            letter-spacing: 1px;
        }

        .timer-container {
            display: flex;
            align-items: center;
            gap: 15px;
        }

        .btn-action {
            padding: 12px 25px;
            border: none;
            border-radius: 20px;
            font-size: 1.1rem;
            font-weight: 900;
            cursor: pointer;
            transition: all 0.2s cubic-bezier(0.175, 0.885, 0.32, 1.275);
            box-shadow: 0 6px 0 rgba(0,0,0,0.15);
        }

        .btn-start { background-color: var(--accent); color: #fff; text-shadow: 1px 1px 0 #d35400; }
        .btn-start:active { transform: translateY(6px); box-shadow: none; }

        #timer-display {
            font-size: 2rem;
            font-weight: 900;
            color: var(--primary);
            background: #eafaf1;
            padding: 5px 20px;
            border-radius: 15px;
            border: 3px dashed var(--primary);
            min-width: 120px;
            text-align: center;
        }

        /* SPLIT SCREEN */
        .main-container {
            display: flex;
            height: calc(100vh - 85px);
            position: relative;
            z-index: 5;
        }

        .panel {
            flex: 1;
            overflow-y: auto;
            padding: 30px;
            scroll-behavior: smooth;
        }

        .left-panel {
            background: rgba(255, 255, 255, 0.8);
            backdrop-filter: blur(12px);
            border-right: 4px dashed var(--primary);
        }

        /* READING CONTENT */
        .passage-title {
            font-size: 2.8rem;
            color: var(--primary);
            margin-bottom: 5px;
            text-align: center;
            font-weight: 900;
            text-shadow: 2px 2px 0px white;
        }
        
        .sub-title {
            text-align: center;
            color: var(--secondary);
            font-style: italic;
            margin-bottom: 25px;
            font-size: 1.2rem;
            font-weight: 700;
        }

        .paragraph-card {
            background: white;
            padding: 25px;
            border-radius: 25px;
            margin-bottom: 25px;
            box-shadow: 0 8px 15px rgba(0,0,0,0.05);
            border-left: 6px solid var(--secondary);
            font-size: 1.2rem;
            line-height: 1.7;
        }

        .btn-translate {
            background: var(--secondary);
            color: white;
            border: none;
            padding: 10px 18px;
            border-radius: 12px;
            font-weight: 800;
            font-size: 1rem;
            margin-top: 15px;
            cursor: pointer;
            box-shadow: 0 5px 0 #a04000;
            transition: 0.2s;
        }
        .btn-translate:active { transform: translateY(5px); box-shadow: none; }

        .translation-text {
            display: none;
            margin-top: 20px;
            padding: 15px 20px;
            background: #fdf2e9;
            border-radius: 10px;
            font-size: 1.15rem;
            color: #d35400;
            font-weight: 700;
            border: 2px dashed var(--accent);
        }

        /* GLOSSARY */
        .glossary-wrapper {
            background: white;
            border-radius: 25px;
            padding: 25px;
            margin-top: 40px;
            border: 4px solid var(--primary);
            box-shadow: 0 10px 0 rgba(39, 174, 96, 0.2);
        }
        .glossary-title {
            color: var(--primary);
            text-align: center;
            font-size: 1.8rem;
            margin-bottom: 20px;
            font-weight: 900;
        }
        table { width: 100%; border-collapse: collapse; font-size: 1.1rem; }
        th, td { padding: 15px; text-align: left; border-bottom: 2px dashed #bdc3c7; }
        th { background: var(--primary); color: white; border-radius: 10px; font-size: 1.2rem;}
        tr:hover td { background: #eafaf1; font-weight: 700; color: var(--primary); cursor: pointer; }

        /* QUIZ CARDS */
        .question-card {
            background: white;
            border-radius: 25px;
            padding: 30px;
            margin-bottom: 30px;
            box-shadow: 0 12px 0 rgba(0,0,0,0.08);
            border: 4px solid #fff;
            transition: all 0.3s;
        }
        .question-card:hover { transform: translateY(-5px); border-color: var(--primary); }

        .question-text {
            font-size: 1.4rem;
            font-weight: 900;
            color: var(--text-dark);
            margin-bottom: 25px;
        }

        .options-grid { display: flex; flex-direction: column; gap: 15px; }

        .option-btn {
            width: 100%;
            background: #ecf0f1;
            border: 3px solid #bdc3c7;
            padding: 18px 25px;
            border-radius: 18px;
            font-size: 1.25rem;
            font-weight: 800;
            color: #2c3e50;
            cursor: pointer;
            text-align: left;
            transition: all 0.2s cubic-bezier(0.175, 0.885, 0.32, 1.275);
            box-shadow: 0 6px 0 #bdc3c7;
            display: flex;
            align-items: center;
        }
        
        .option-btn:hover:not(:disabled) {
            transform: scale(1.02);
            background: white;
            border-color: var(--primary);
            color: var(--primary);
            box-shadow: 0 6px 0 var(--primary);
        }

        .option-btn:active:not(:disabled) { transform: translateY(6px); box-shadow: none; }
        .option-btn.correct { background: var(--correct); border-color: #219653; color: white; box-shadow: 0 6px 0 #219653; }
        .option-btn.wrong { background: var(--wrong); border-color: #c0392b; color: white; box-shadow: 0 6px 0 #c0392b; animation: shake 0.4s; }

        @keyframes shake {
            0%, 100% { transform: translateX(0); }
            25% { transform: translateX(-10px) rotate(-2deg); }
            75% { transform: translateX(10px) rotate(2deg); }
        }

        /* DETAILED EXPLANATION BOX */
        .explanation-box {
            display: none;
            margin-top: 25px;
            padding: 20px;
            background: #fdf8e3;
            border: 4px dashed var(--accent);
            border-radius: 15px;
            animation: bounceIn 0.5s cubic-bezier(0.68, -0.55, 0.265, 1.55);
        }
        @keyframes bounceIn {
            0% { opacity: 0; transform: scale(0.8); }
            100% { opacity: 1; transform: scale(1); }
        }
        .explanation-box h4 { color: #d35400; margin-bottom: 15px; font-size: 1.3rem; font-weight: 900; }
        .explanation-box p { margin-bottom: 10px; font-size: 1.15rem; line-height: 1.6; color: #2d3436;}
        .explanation-box .highlight { background: var(--accent); color: #2d3436; padding: 2px 8px; border-radius: 5px; font-weight: bold; }

        /* SUBMIT BUTTON */
        .btn-submit {
            display: block; width: 100%;
            background: var(--primary); color: white;
            font-size: 1.8rem; font-weight: 900;
            padding: 25px; border: none; border-radius: 25px;
            cursor: pointer; box-shadow: 0 10px 0 #1e8449;
            margin-top: 30px; transition: all 0.2s;
            text-transform: uppercase; letter-spacing: 2px;
        }
        .btn-submit:hover { transform: scale(1.02); }
        .btn-submit:active { transform: translateY(10px); box-shadow: none; }

        /* MODAL POPUP */
        #result-modal {
            display: none; position: fixed; top: 0; left: 0; width: 100%; height: 100%;
            background: rgba(0,0,0,0.85); z-index: 100; justify-content: center; align-items: center; backdrop-filter: blur(8px);
        }
        .modal-content {
            background: white; padding: 50px; border-radius: 40px; text-align: center;
            max-width: 550px; width: 90%; border: 8px solid var(--accent);
            box-shadow: 0 20px 50px rgba(0,0,0,0.5);
            animation: popIn 0.6s cubic-bezier(0.68, -0.55, 0.265, 1.55);
        }
        @keyframes popIn { 0% { transform: scale(0.3) rotate(-10deg); opacity: 0; } 100% { transform: scale(1) rotate(0); opacity: 1; } }
        
        .score-circle {
            width: 180px; height: 180px; background: var(--primary); border-radius: 50%;
            display: flex; justify-content: center; align-items: center;
            font-size: 4.5rem; font-weight: 900; color: white; margin: 0 auto 25px;
            border: 10px solid var(--accent); box-shadow: inset 0 0 20px rgba(0,0,0,0.2);
        }

        /* CUSTOM SCROLLBAR */
        ::-webkit-scrollbar { width: 14px; }
        ::-webkit-scrollbar-track { background: transparent; }
        ::-webkit-scrollbar-thumb { background: var(--primary); border-radius: 20px; border: 3px solid white; }
        ::-webkit-scrollbar-thumb:hover { background: #1e8449; }

        #confetti-canvas { position: fixed; top: 0; left: 0; width: 100%; height: 100%; pointer-events: none; z-index: 999; }
    </style>
</head>
<body>

    <div class="pattern-overlay"></div>
    <canvas id="confetti-canvas"></canvas>

    <header>
        <div class="header-title">üå≤ Ms Mai An ULIS | The Great Trail</div>
        <div class="timer-container">
            <div id="timer-display">10:00</div>
            <button class="btn-action btn-start" id="btn-timer" onclick="toggleTimer()">‚ñ∂ B·∫ÆT ƒê·∫¶U ƒêI D·∫†O</button>
        </div>
    </header>

    <div class="main-container">
        <div class="panel left-panel">
            <h1 class="passage-title">A path across Canada</h1>
            <p class="sub-title">Thirteen-year-old Kara Finch writes about The Great Trail ‚Äì a footpath that goes across Canada.</p>

            <div class="paragraph-card">
                <p>The Great Trail goes from one side of Canada to the other. At 24,000 km, it is the longest trail in the world. The Great Trail project began in 1992 and took 25 years to complete. It opened in 2017, exactly 150 years after Canada became one country.</p>
                <button class="btn-translate" onclick="toggleTranslation(this)">üìñ B·∫¢N D·ªäCH ƒê·∫¶Y ƒê·ª¶</button>
                <div class="translation-text">ƒê∆∞·ªùng m√≤n Great Trail tr·∫£i d√†i t·ª´ ƒë·∫ßu n√†y ƒë·∫øn ƒë·∫ßu kia c·ªßa Canada. V·ªõi chi·ªÅu d√†i 24.000 km, ƒë√¢y l√† con ƒë∆∞·ªùng m√≤n d√†i nh·∫•t th·∫ø gi·ªõi. D·ª± √°n Great Trail b·∫Øt ƒë·∫ßu v√†o nƒÉm 1992 v√† m·∫•t 25 nƒÉm ƒë·ªÉ ho√†n th√†nh. N√≥ m·ªü c·ª≠a v√†o nƒÉm 2017, tr√≤n 150 nƒÉm sau khi Canada tr·ªü th√†nh m·ªôt qu·ªëc gia th·ªëng nh·∫•t.</div>
            </div>

            <div class="paragraph-card">
                <p>The Great Trail is actually lots of paths joined together. You can cycle, walk or horse-ride on most of it, but there are parts where the only way you can travel is by boat. And there are others where the trail is part of the highway, which doesn‚Äôt sound very safe to me.</p>
                <button class="btn-translate" onclick="toggleTranslation(this)">üìñ B·∫¢N D·ªäCH ƒê·∫¶Y ƒê·ª¶</button>
                <div class="translation-text">Great Trail th·ª±c ch·∫•t l√† s·ª± k·∫øt n·ªëi c·ªßa r·∫•t nhi·ªÅu con ƒë∆∞·ªùng m√≤n nh·ªè l·∫°i v·ªõi nhau. B·∫°n c√≥ th·ªÉ ƒë·∫°p xe, ƒëi b·ªô ho·∫∑c c∆∞·ª°i ng·ª±a tr√™n ph·∫ßn l·ªõn con ƒë∆∞·ªùng, nh∆∞ng c√≥ nh·ªØng ƒëo·∫°n m√† c√°ch duy nh·∫•t ƒë·ªÉ di chuy·ªÉn l√† b·∫±ng thuy·ªÅn. V√† l·∫°i c√≥ nh·ªØng ƒëo·∫°n ƒë∆∞·ªùng m√≤n n·∫±m tr√™n ƒë∆∞·ªùng cao t·ªëc, ƒëi·ªÅu m√† t√¥i nghe c√≥ v·∫ª kh√¥ng ƒë∆∞·ª£c an to√†n cho l·∫Øm.</div>
            </div>

            <div class="paragraph-card">
                <p>My father and I spent a day walking along part of the Great Trail that was surprisingly busy. We were told you don‚Äôt usually see bears when there are lots of people, but we did. It was moving through the trees, quite close to us, and I felt a little afraid. ‚ÄòI don‚Äôt think it‚Äôs hungry!‚Äô laughed my dad.</p>
                <button class="btn-translate" onclick="toggleTranslation(this)">üìñ B·∫¢N D·ªäCH ƒê·∫¶Y ƒê·ª¶</button>
                <div class="translation-text">Cha t√¥i v√† t√¥i ƒë√£ d√†nh m·ªôt ng√†y ƒëi d·∫°o d·ªçc theo m·ªôt ƒëo·∫°n c·ªßa con ƒë∆∞·ªùng Great Trail v√¥ c√πng ƒë√¥ng ƒë√∫c. Ch√∫ng t√¥i ƒë∆∞·ª£c b·∫£o r·∫±ng b·∫°n th∆∞·ªùng kh√¥ng nh√¨n th·∫•y g·∫•u khi c√≥ nhi·ªÅu ng∆∞·ªùi, nh∆∞ng ch√∫ng t√¥i l·∫°i th·∫•y. N√≥ ƒëang di chuy·ªÉn xuy√™n qua nh·ªØng t√°n c√¢y, kh√° g·∫ßn ch√∫ng t√¥i, v√† t√¥i c·∫£m th·∫•y h∆°i s·ª£ m·ªôt ch√∫t. "B·ªë kh√¥ng nghƒ© l√† n√≥ ƒëang ƒë√≥i ƒë√¢u!" b·ªë t√¥i c∆∞·ªùi vang.</div>
            </div>

            <div class="paragraph-card">
                <p>At lunchtime, we talked to an old man on the trail. Dad asked him if he thought the path was going to help Canadians learn more about their countryside. ‚ÄòNot really,‚Äô he said. ‚ÄòWe‚Äôve always loved to be outdoors. But it will bring us tourists from around the world, which is important.‚Äô</p>
                <button class="btn-translate" onclick="toggleTranslation(this)">üìñ B·∫¢N D·ªäCH ƒê·∫¶Y ƒê·ª¶</button>
                <div class="translation-text">V√†o gi·ªù ƒÉn tr∆∞a, ch√∫ng t√¥i n√≥i chuy·ªán v·ªõi m·ªôt √¥ng l√£o tr√™n ƒë∆∞·ªùng m√≤n. B·ªë h·ªèi √¥ng ·∫•y li·ªáu √¥ng c√≥ nghƒ© r·∫±ng con ƒë∆∞·ªùng n√†y s·∫Ω gi√∫p ng∆∞·ªùi d√¢n Canada hi·ªÉu th√™m v·ªÅ v√πng n√¥ng th√¥n c·ªßa h·ªç kh√¥ng. "Kh√¥ng h·∫≥n," √¥ng n√≥i. "Ch√∫ng t√¥i lu√¥n th√≠ch c√°c ho·∫°t ƒë·ªông ngo√†i tr·ªùi. Nh∆∞ng n√≥ s·∫Ω mang ƒë·∫øn cho ch√∫ng t√¥i kh√°ch du l·ªãch t·ª´ kh·∫Øp n∆°i tr√™n th·∫ø gi·ªõi, ƒëi·ªÅu ƒë√≥ r·∫•t quan tr·ªçng."</div>
            </div>

            <div class="paragraph-card">
                <p>In the future, the path will probably change, and new parts may open. We saw nothing to tell us we were on the Great Trail, which is a shame. I know there‚Äôs information on the website, but it‚Äôs good to know when you‚Äôre walking on a special path. They need to add some signs, I think.</p>
                <button class="btn-translate" onclick="toggleTranslation(this)">üìñ B·∫¢N D·ªäCH ƒê·∫¶Y ƒê·ª¶</button>
                <div class="translation-text">Trong t∆∞∆°ng lai, con ƒë∆∞·ªùng c√≥ l·∫Ω s·∫Ω thay ƒë·ªïi, v√† nh·ªØng ƒëo·∫°n ƒë∆∞·ªùng m·ªõi c√≥ th·ªÉ ƒë∆∞·ª£c m·ªü ra. Ch√∫ng t√¥i kh√¥ng th·∫•y b·∫•t c·ª© bi·ªÉn b√°o n√†o cho bi·∫øt ch√∫ng t√¥i ƒëang ·ªü tr√™n Great Trail, th·∫≠t l√† m·ªôt ƒëi·ªÅu ƒë√°ng ti·∫øc. T√¥i bi·∫øt c√≥ th√¥ng tin tr√™n trang web, nh∆∞ng s·∫Ω th·∫≠t tuy·ªát khi bi·∫øt m√¨nh ƒëang ƒëi tr√™n m·ªôt con ƒë∆∞·ªùng ƒë·∫∑c bi·ªát. T√¥i nghƒ© h·ªç c·∫ßn ph·∫£i b·ªï sung th√™m m·ªôt v√†i bi·ªÉn b√°o.</div>
            </div>

            <div class="glossary-wrapper">
                <h3 class="glossary-title">üß≠ Nature & Trail Vocabulary (A2-B2)</h3>
                <table>
                    <thead><tr><th>T·ª´ v·ª±ng</th><th>Lo·∫°i t·ª´</th><th>Nghƒ©a Ti·∫øng Vi·ªát</th></tr></thead>
                    <tbody>
                        <tr><td>1. Trail / Footpath</td><td>Noun</td><td>ƒê∆∞·ªùng m√≤n / ƒê∆∞·ªùng ƒëi b·ªô</td></tr>
                        <tr><td>2. Project</td><td>Noun</td><td>D·ª± √°n</td></tr>
                        <tr><td>3. Highway</td><td>Noun</td><td>ƒê∆∞·ªùng cao t·ªëc, qu·ªëc l·ªô</td></tr>
                        <tr><td>4. Safe / Dangerous</td><td>Adjective</td><td>An to√†n / Nguy hi·ªÉm</td></tr>
                        <tr><td>5. Surprisingly</td><td>Adverb</td><td>M·ªôt c√°ch ƒë√°ng ng·∫°c nhi√™n</td></tr>
                        <tr><td>6. Close to (sb/sth)</td><td>Preposition</td><td>G·∫ßn g≈©i, s√°t g·∫ßn (ai/c√°i g√¨)</td></tr>
                        <tr><td>7. Outdoors</td><td>Adverb</td><td>Ngo√†i tr·ªùi, kh√¥ng gian m·ªü</td></tr>
                        <tr><td>8. Tourist</td><td>Noun</td><td>Kh√°ch du l·ªãch</td></tr>
                        <tr><td>9. Probably</td><td>Adverb</td><td>C√≥ l·∫Ω, c√≥ th·ªÉ x·∫£y ra</td></tr>
                        <tr><td>10. Shame</td><td>Noun</td><td>ƒêi·ªÅu ƒë√°ng ti·∫øc / S·ª± x·∫•u h·ªï</td></tr>
                    </tbody>
                </table>
            </div>
        </div>

        <div class="panel right-panel">
            <div id="quiz-container"></div>
            <button class="btn-submit" onclick="submitQuiz()">üèïÔ∏è CH·ªêT ƒê√ÅP √ÅN! üèïÔ∏è</button>
        </div>
    </div>

    <div id="result-modal">
        <div class="modal-content">
            <h2 style="color: var(--primary); font-size: 2.5rem; margin-bottom: 20px;">K·∫æT QU·∫¢ CHUY·∫æN ƒêI</h2>
            <div class="score-circle" id="final-score">0/5</div>
            <h3 id="feedback-msg" style="color: #2c3e50; margin-bottom: 20px; font-size: 1.6rem; line-height: 1.5;"></h3>
            <button class="btn-action btn-start" onclick="location.reload()" style="width: 100%; font-size: 1.3rem; padding: 18px; border-radius: 15px;">üîÑ ƒêI D·∫†O L·∫†I T·ª™ ƒê·∫¶U</button>
        </div>
    </div>

    <script>
        // --- 1. D·ªÆ LI·ªÜU ƒê·ªÄ B√ÄI & GI·∫¢I TH√çCH CHI TI·∫æT ---
        const quizData = [
            {
                id: 1, 
                question: "1. What is Kara doing in the first paragraph?",
                options: [
                    {text: "telling tourists how long it takes to walk the Great Trail", isCorrect: false, label: "A"},
                    {text: "explaining the history of the Great Trail", isCorrect: true, label: "B"},
                    {text: "giving walkers advice about walking in Canada", isCorrect: false, label: "C"}
                ],
                explanation: `<p><strong>D·ªãch c√¢u h·ªèi:</strong> Kara ƒëang l√†m g√¨ ·ªü ƒëo·∫°n ƒë·∫ßu ti√™n?</p>
                <p><strong>T·∫°i sao ch·ªçn B?</strong> Trong ƒëo·∫°n 1, Kara li√™n t·ª•c nh·∫Øc ƒë·∫øn c√°c m·ªëc th·ªùi gian: <span class="highlight">"began in 1992", "took 25 years", "opened in 2017"</span>. Vi·ªác k·ªÉ l·∫°i c√°c m·ªëc th·ªùi gian h√¨nh th√†nh n√™n con ƒë∆∞·ªùng ch√≠nh l√† ƒëang "gi·∫£i th√≠ch l·ªãch s·ª≠" (explaining the history).</p>`
            },
            {
                id: 2, 
                question: "2. What does Kara think is dangerous?",
                options: [
                    {text: "Some parts of the path are on roads.", isCorrect: true, label: "A"},
                    {text: "You need a boat for parts of the path.", isCorrect: false, label: "B"},
                    {text: "Bikes and horses share the same path.", isCorrect: false, label: "C"}
                ],
                explanation: `<p><strong>D·ªãch c√¢u h·ªèi:</strong> Kara nghƒ© ƒëi·ªÅu g√¨ l√† nguy hi·ªÉm?</p>
                <p><strong>T·∫°i sao ch·ªçn A?</strong> ·ªû ƒëo·∫°n 2, Kara vi·∫øt: <span class="highlight">"...the trail is part of the highway, which doesn‚Äôt sound very safe to me."</span> (...ƒë∆∞·ªùng m√≤n n·∫±m tr√™n ƒë∆∞·ªùng cao t·ªëc, nghe kh√¥ng an to√†n cho l·∫Øm). "Not safe" (kh√¥ng an to√†n) ch√≠nh l√† t·ª´ ƒë·ªìng nghƒ©a c·ªßa "dangerous" (nguy hi·ªÉm), v√† "highway" t∆∞∆°ng ƒë∆∞∆°ng v·ªõi "roads".</p>`
            },
            {
                id: 3, 
                question: "3. What does Kara say about the bear she saw?",
                options: [
                    {text: "It looked hungry.", isCorrect: false, label: "A"},
                    {text: "It was on the path.", isCorrect: false, label: "B"},
                    {text: "It walked near her.", isCorrect: true, label: "C"}
                ],
                explanation: `<p><strong>D·ªãch c√¢u h·ªèi:</strong> Kara n√≥i g√¨ v·ªÅ con g·∫•u c√¥ ·∫•y nh√¨n th·∫•y?</p>
                <p><strong>T·∫°i sao ch·ªçn C?</strong> ƒêo·∫°n 3 k·ªÉ l·∫°i: <span class="highlight">"It was moving through the trees, quite close to us..."</span> (N√≥ ƒëang di chuy·ªÉn xuy√™n qua t√°n c√¢y, kh√° g·∫ßn ch√∫ng t√¥i). C·ª•m "quite close to us" (kh√° g·∫ßn ch√∫ng t√¥i) ƒë·ªìng nghƒ©a ho√†n to√†n v·ªõi "walked near her" (ƒëi l·∫°i g·∫ßn c√¥ ·∫•y).</p>
                <p><em>T·∫°i sao A sai?</em> B·ªë c√¥ ·∫•y ƒë√πa r·∫±ng "B·ªë kh√¥ng nghƒ© n√≥ ƒë√≥i ƒë√¢u!", ch·ª© b·∫£n th√¢n con g·∫•u kh√¥ng c√≥ v·∫ª g√¨ l√† ƒëang ƒë√≥i c·∫£.</p>`
            },
            {
                id: 4, 
                question: "4. What did the old man say about the trail?",
                options: [
                    {text: "People from other countries will come to see it.", isCorrect: true, label: "A"},
                    {text: "People will go into the countryside more because of it.", isCorrect: false, label: "B"},
                    {text: "People from Canada will use it to see other parts of their country.", isCorrect: false, label: "C"}
                ],
                explanation: `<p><strong>D·ªãch c√¢u h·ªèi:</strong> √îng l√£o ƒë√£ n√≥i g√¨ v·ªÅ con ƒë∆∞·ªùng m√≤n?</p>
                <p><strong>T·∫°i sao ch·ªçn A?</strong> √îng l√£o kh·∫≥ng ƒë·ªãnh ·ªü ƒëo·∫°n 4: <span class="highlight">"But it will bring us tourists from around the world..."</span> (Nh∆∞ng n√≥ s·∫Ω mang ƒë·∫øn cho ch√∫ng ta kh√°ch du l·ªãch t·ª´ kh·∫Øp n∆°i tr√™n th·∫ø gi·ªõi). "Tourists from around the world" ch√≠nh l√† "People from other countries".</p>`
            },
            {
                id: 5, 
                question: "5. What does Kara say should happen next?",
                options: [
                    {text: "There should be a website about the trail.", isCorrect: false, label: "A"},
                    {text: "Some parts of the trail should close.", isCorrect: false, label: "B"},
                    {text: "There should be more signs along the trail.", isCorrect: true, label: "C"}
                ],
                explanation: `<p><strong>D·ªãch c√¢u h·ªèi:</strong> Kara n√≥i ƒëi·ªÅu g√¨ n√™n x·∫£y ra ti·∫øp theo?</p>
                <p><strong>T·∫°i sao ch·ªçn C?</strong> ·ªû ƒëo·∫°n cu·ªëi c√πng, Kara ch·ªët l·∫°i v·∫•n ƒë·ªÅ: <span class="highlight">"They need to add some signs, I think."</span> (T√¥i nghƒ© h·ªç c·∫ßn ph·∫£i b·ªï sung th√™m m·ªôt v√†i bi·ªÉn b√°o). Vi·ªác "add signs" tr√πng kh·ªõp v·ªõi ƒë√°p √°n C "more signs".</p>`
            }
        ];

        let score = 0;
        let answeredQuestions = new Set();

        // Thu·∫≠t to√°n x√°o tr·ªôn m·∫£ng
        function shuffleArray(array) {
            for (let i = array.length - 1; i > 0; i--) {
                const j = Math.floor(Math.random() * (i + 1));
                [array[i], array[j]] = [array[j], array[i]];
            }
            return array;
        }

        // --- 2. RENDER GIAO DI·ªÜN C√ÇU H·ªéI ---
        function renderQuiz() {
            const container = document.getElementById('quiz-container');
            container.innerHTML = '';

            quizData.forEach((q, index) => {
                // X√°o tr·ªôn c√°c l·ª±a ch·ªçn A, B, C
                const shuffledOptions = shuffleArray([...q.options]);

                const card = document.createElement('div');
                card.className = 'question-card';
                card.innerHTML = `<div class="question-text">${q.question}</div>`;

                const optionsGrid = document.createElement('div');
                optionsGrid.className = 'options-grid';

                shuffledOptions.forEach(opt => {
                    const btn = document.createElement('button');
                    btn.className = 'option-btn';
                    btn.innerText = opt.text;
                    btn.onclick = () => handleAnswer(btn, opt.isCorrect, index, q.explanation, optionsGrid, q.options.find(o => o.isCorrect).text);
                    optionsGrid.appendChild(btn);
                });
                card.appendChild(optionsGrid);

                // H·ªôp gi·∫£i th√≠ch chi ti·∫øt (·∫©n ƒëi ban ƒë·∫ßu)
                const explBox = document.createElement('div');
                explBox.className = 'explanation-box';
                explBox.id = `expl-${index}`;
                explBox.innerHTML = `<h4>üí° Ph√°t hi·ªán d·∫•u v·∫øt:</h4>` + q.explanation;
                card.appendChild(explBox);

                container.appendChild(card);
            });
        }

        // --- 3. H·ªÜ TH·ªêNG √ÇM THANH WEB AUDIO API ---
        const AudioContext = window.AudioContext || window.webkitAudioContext;
        let audioCtx;

        function playSound(type) {
            if (!audioCtx) audioCtx = new AudioContext();
            if (audioCtx.state === 'suspended') audioCtx.resume();
            
            const osc = audioCtx.createOscillator();
            const gainNode = audioCtx.createGain();
            osc.connect(gainNode);
            gainNode.connect(audioCtx.destination);

            if (type === 'correct') {
                osc.type = 'sine';
                osc.frequency.setValueAtTime(523.25, audioCtx.currentTime); 
                osc.frequency.exponentialRampToValueAtTime(1046.50, audioCtx.currentTime + 0.15); 
                gainNode.gain.setValueAtTime(0.5, audioCtx.currentTime);
                gainNode.gain.exponentialRampToValueAtTime(0.01, audioCtx.currentTime + 0.4);
                osc.start(); osc.stop(audioCtx.currentTime + 0.4);
            } else {
                osc.type = 'sawtooth'; 
                osc.frequency.setValueAtTime(200, audioCtx.currentTime);
                osc.frequency.linearRampToValueAtTime(120, audioCtx.currentTime + 0.3);
                gainNode.gain.setValueAtTime(0.4, audioCtx.currentTime);
                gainNode.gain.linearRampToValueAtTime(0.01, audioCtx.currentTime + 0.3);
                osc.start(); osc.stop(audioCtx.currentTime + 0.3);
            }
        }

        // --- 4. X·ª¨ L√ù L∆Ø·ª¢T CH∆†I (T·ª∞ ƒê·ªòNG HI·ªÜN GI·∫¢I TH√çCH) ---
        function handleAnswer(btn, isCorrect, qIndex, explanationHTML, grid, correctText) {
            if (answeredQuestions.has(qIndex)) return; 
            answeredQuestions.add(qIndex);

            const allBtns = grid.querySelectorAll('.option-btn');
            allBtns.forEach(b => b.disabled = true); // Kh√≥a to√†n b·ªô n√∫t

            // B·∫¨T B·∫¢NG GI·∫¢I TH√çCH NGAY L·∫¨P T·ª®C CHO HS H·ªåC
            document.getElementById(`expl-${qIndex}`).style.display = 'block';

            if (isCorrect) {
                btn.classList.add('correct');
                playSound('correct');
                fireConfetti();
                score++;
            } else {
                btn.classList.add('wrong');
                playSound('wrong');
                // Auto highlight ƒë√°p √°n ƒë√∫ng
                allBtns.forEach(b => {
                    if (b.innerText === correctText) {
                        b.classList.add('correct');
                        b.style.opacity = '0.7';
                    }
                });
            }
        }

        // --- 5. B·ªò ƒê·∫æM TH·ªúI GIAN ---
        let timerInterval;
        let timeLeft = 600; // 10 ph√∫t
        let isRunning = false;

        function toggleTimer() {
            const btn = document.getElementById('btn-timer');
            if (isRunning) {
                clearInterval(timerInterval);
                btn.innerText = "‚ñ∂ TI·∫æP T·ª§C ƒêI D·∫†O";
                btn.style.backgroundColor = "#f39c12";
            } else {
                btn.innerText = "‚è∏ D·ª™NG CH√ÇN NGH·ªà NG∆†I";
                btn.style.backgroundColor = "#e74c3c";
                btn.style.color = "white";
                timerInterval = setInterval(() => {
                    timeLeft--;
                    let m = Math.floor(timeLeft / 60);
                    let s = timeLeft % 60;
                    document.getElementById('timer-display').innerText = `${m.toString().padStart(2, '0')}:${s.toString().padStart(2, '0')}`;
                    if (timeLeft <= 0) {
                        clearInterval(timerInterval);
                        alert("‚è∞ ƒê√£ h·∫øt th·ªùi gian d·∫°o ch∆°i! H√£y ƒë·∫©y nhanh t·ªëc ƒë·ªô ƒë·ªçc l∆∞·ªõt ƒë·ªÉ l·∫•y th√¥ng tin nh√©!");
                    }
                }, 1000);
            }
            isRunning = !isRunning;
        }

        // N√∫t d·ªãch thu·∫≠t
        function toggleTranslation(btn) {
            const div = btn.nextElementSibling;
            const isHidden = getComputedStyle(div).display === 'none';
            div.style.display = isHidden ? 'block' : 'none';
            btn.innerHTML = isHidden ? 'üôà ·∫®N B·∫¢N D·ªäCH' : 'üìñ B·∫¢N D·ªäCH ƒê·∫¶Y ƒê·ª¶';
        }

        // --- 6. T·ªîNG K·∫æT N·ªòP B√ÄI ---
        function submitQuiz() {
            if (answeredQuestions.size < quizData.length) {
                if(!confirm("Chuy·∫øn ƒëi ch∆∞a k·∫øt th√∫c, b·∫°n v·∫´n c√≤n c√¢u h·ªèi ch∆∞a tr·∫£ l·ªùi. B·∫°n ch·∫Øc ch·∫Øn mu·ªën d·ª´ng l·∫°i ch·ª©?")) return;
            }
            clearInterval(timerInterval);
            
            const modal = document.getElementById('result-modal');
            document.getElementById('final-score').innerText = `${score}/5`;
            
            const msgObj = document.getElementById('feedback-msg');
            if (score === 5) {
                msgObj.innerText = "üèÜ TUY·ªÜT V·ªúI! K·ª∏ NƒÇNG PARAPHRASE C·ª¶A B·∫†N ƒê√É ƒê·∫†T ƒê·ªàNH CAO!";
                for(let i=0; i<4; i++) setTimeout(fireConfetti, i*300);
            } else if (score >= 3) {
                msgObj.innerText = "‚ú® L√ÄM T·ªêT L·∫ÆM! H√£y ƒë·ªçc l·∫°i c√°c h·ªôp gi·∫£i th√≠ch m√†u v√†ng ƒë·ªÉ xem m√¨nh sai ·ªü ƒë√¢u nh√©.";
                fireConfetti();
            } else {
                msgObj.innerText = "üí™ C·ªê L√äN NHA! B√†i n√†y c√≥ nhi·ªÅu b·∫´y t·ª´ ƒë·ªìng nghƒ©a, h√£y c·∫©n th·∫≠n qu√©t th√¥ng tin ·ªü l·∫ßn t·ªõi nh√©!";
            }
            modal.style.display = 'flex';
        }

        // --- 7. HI·ªÜU ·ª®NG PH√ÅO GI·∫§Y CONFETTI ---
        const canvas = document.getElementById('confetti-canvas');
        const ctx = canvas.getContext('2d');
        canvas.width = window.innerWidth;
        canvas.height = window.innerHeight;
        let particles = [];
        const colors = ['#27ae60', '#f39c12', '#d35400', '#2ecc71'];

        function fireConfetti() {
            for(let i=0; i<80; i++) {
                particles.push({
                    x: canvas.width / 2, y: canvas.height / 2 + 100,
                    r: Math.random() * 8 + 4,
                    dx: (Math.random() - 0.5) * 20, dy: Math.random() * -20 - 5,
                    color: colors[Math.floor(Math.random() * colors.length)],
                    tilt: Math.random() * 10 - 10, tiltAngleInc: (Math.random() * 0.07) + 0.05, tiltAngle: 0
                });
            }
            requestAnimationFrame(animateConfetti);
        }

        function animateConfetti() {
            ctx.clearRect(0,0,canvas.width,canvas.height);
            particles.forEach((p, i) => {
                p.tiltAngle += p.tiltAngleInc;
                p.y += (Math.cos(p.tiltAngle) + 1 + p.r / 2) / 2;
                p.x += Math.sin(p.tiltAngle) * 2;
                p.dy += 0.3; p.y += p.dy;
                ctx.beginPath(); ctx.lineWidth = p.r; ctx.strokeStyle = p.color;
                ctx.moveTo(p.x + p.tilt + p.r, p.y); ctx.lineTo(p.x + p.tilt, p.y + p.tilt + p.r); ctx.stroke();
                if (p.y > canvas.height) particles.splice(i,1);
            });
            if(particles.length > 0) requestAnimationFrame(animateConfetti);
        }

        window.addEventListener('resize', () => { canvas.width = window.innerWidth; canvas.height = window.innerHeight; });
        window.onload = renderQuiz;
    </script>
</body>
</html>