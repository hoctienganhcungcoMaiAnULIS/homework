<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>B√†i Ki·ªÉm Tra Full - Ms Mai An ULIS</title>
    <link href="https://fonts.googleapis.com/css2?family=Nunito:wght@600;800;900&family=Quicksand:wght@500;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <script src="https://cdn.jsdelivr.net/npm/canvas-confetti@1.6.0/dist/confetti.browser.min.js"></script>

    <style>
        :root {
            --primary: #8854C0; 
            --secondary: #00C9A7; 
            --correct: #00D26A; 
            --incorrect: #FF4757; 
            --bg-color: #f8f4ff;
            --text-main: #333333;
            --card-bg: #ffffff;
        }

        * { box-sizing: border-box; font-family: 'Nunito', sans-serif; }

        body {
            margin: 0; padding: 20px;
            background-color: var(--bg-color);
            background-image: radial-gradient(var(--secondary) 10%, transparent 11%), radial-gradient(var(--secondary) 10%, transparent 11%);
            background-size: 60px 60px; background-position: 0 0, 30px 30px;
            background-attachment: fixed; color: var(--text-main);
        }

        .header-container {
            background: linear-gradient(135deg, var(--primary), #a675e8);
            color: white; text-align: center; padding: 20px; border-radius: 20px;
            box-shadow: 0 8px 0 #6a3a9e; margin: 0 auto 40px auto; max-width: 900px;
        }

        .header-container h1 { margin: 0; font-family: 'Quicksand', sans-serif; font-weight: 900; font-size: 28px; }

        .quiz-container { max-width: 900px; margin: 0 auto; }

        .part-title {
            background-color: #FFC312; color: #fff; display: inline-block; padding: 10px 25px;
            border-radius: 15px; font-weight: 800; font-size: 20px; box-shadow: 0 5px 0 #d9a50b;
            margin: 30px 0 20px 0; width: 100%; text-align: center; text-transform: uppercase;
        }

        .question-card {
            background: var(--card-bg); border-radius: 20px; padding: 25px; margin-bottom: 30px;
            box-shadow: 0 8px 0 rgba(0,0,0,0.1); border: 3px solid #eee; transition: transform 0.2s;
        }
        .question-card:hover { border-color: var(--secondary); }

        .question-text { font-size: 20px; font-weight: 800; margin-bottom: 20px; line-height: 1.5; color: #2d3436; }
        .question-text span.blank { display: inline-block; min-width: 80px; border-bottom: 3px dashed var(--primary); text-align: center; color: var(--primary); padding: 0 10px; }

        .options-grid { display: grid; grid-template-columns: 1fr 1fr; gap: 15px; }

        .option-btn {
            background: #fff; border: 2px solid #e0e0e0; border-radius: 15px; padding: 15px 20px;
            font-size: 18px; font-weight: 700; color: #555; cursor: pointer; box-shadow: 0 6px 0 #e0e0e0;
            transition: all 0.1s ease; text-align: left; display: flex; align-items: center;
        }
        .option-btn .opt-letter {
            background: #f1f2f6; width: 30px; height: 30px; display: flex; align-items: center;
            justify-content: center; border-radius: 50%; margin-right: 15px; font-weight: 900; color: #999;
        }
        .option-btn:hover:not(:disabled) { transform: translateY(2px); box-shadow: 0 4px 0 #e0e0e0; border-color: var(--secondary); }
        .option-btn:active:not(:disabled) { transform: translateY(6px); box-shadow: 0 0px 0 #e0e0e0; }
        
        .option-btn.correct { background: var(--correct); border-color: var(--correct); color: white; box-shadow: 0 6px 0 #00a653; }
        .option-btn.correct .opt-letter { background: rgba(255,255,255,0.3); color: white;}
        .option-btn.incorrect { background: var(--incorrect); border-color: var(--incorrect); color: white; box-shadow: 0 6px 0 #cc3945; }
        .option-btn.incorrect .opt-letter { background: rgba(255,255,255,0.3); color: white;}
        .option-btn:disabled { cursor: not-allowed; opacity: 0.9; }

        .explanation-box {
            display: none; margin-top: 20px; background: #fdf2f8; border: 2px dashed var(--primary);
            border-radius: 15px; padding: 20px; animation: fadeIn 0.5s ease-in-out;
        }
        .explanation-box h4 { margin-top: 0; color: var(--primary); font-family: 'Quicksand', sans-serif; font-size: 20px; }
        .explanation-box p { margin: 10px 0; font-size: 16px; line-height: 1.6; }
        .tag-correct { color: var(--correct); font-weight: 800; }
        .tag-incorrect { color: var(--incorrect); font-weight: 800; }

        @keyframes fadeIn { from { opacity: 0; transform: translateY(-10px); } to { opacity: 1; transform: translateY(0); } }
        @keyframes shake {
            0%, 100% { transform: translateX(0); }
            25%, 75% { transform: translateX(-8px) rotate(-1deg); }
            50% { transform: translateX(8px) rotate(1deg); }
        }
        .shake { animation: shake 0.4s cubic-bezier(.36,.07,.19,.97) both; }

        .submit-area { text-align: center; margin: 50px 0; }
        .btn-submit {
            background: linear-gradient(135deg, #FF6B6B, #FF4757); color: white; font-size: 24px; font-weight: 900;
            padding: 15px 50px; border: none; border-radius: 25px; cursor: pointer; box-shadow: 0 8px 0 #cc3945;
            text-transform: uppercase; transition: all 0.2s;
        }
        .btn-submit:hover { transform: translateY(3px); box-shadow: 0 5px 0 #cc3945; }
        .btn-submit:active { transform: translateY(8px); box-shadow: 0 0 0 #cc3945; }

        .modal-overlay {
            display: none; position: fixed; top: 0; left: 0; width: 100%; height: 100%;
            background: rgba(0,0,0,0.7); z-index: 1000; justify-content: center; align-items: center;
        }
        .score-modal {
            background: white; padding: 40px; border-radius: 30px; text-align: center;
            box-shadow: 0 10px 30px rgba(0,0,0,0.3); max-width: 400px; width: 90%; animation: fadeIn 0.3s;
        }
        .score-modal h2 { color: var(--primary); font-size: 32px; margin-bottom: 10px; }
        .score-number { font-size: 60px; font-weight: 900; color: var(--correct); margin: 20px 0; }

        @media (max-width: 600px) { .options-grid { grid-template-columns: 1fr; } }
    </style>
</head>
<body>

    <div class="header-container">
        <h1><i class="fas fa-graduation-cap"></i> Ms Mai An ULIS - Full Master Quiz</h1>
        <p>Phi√™n b·∫£n ƒê·∫ßy ƒë·ªß 45 C√¢u - Kh√¥ng thi·∫øu 1 ch·ªØ!</p>
    </div>

    <div class="quiz-container" id="quiz-container"></div>

    <div class="submit-area">
        <button class="btn-submit" onclick="showScore()"><i class="fas fa-paper-plane"></i> N·ªôp B√†i Ngay</button>
    </div>

    <div class="modal-overlay" id="scoreModal">
        <div class="score-modal">
            <h2>K·∫øt Qu·∫£ C·ªßa B·∫°n!</h2>
            <p id="score-message"></p>
            <div class="score-number" id="score-display">0/0</div>
            <button class="btn-submit" style="font-size: 18px; padding: 10px 30px;" onclick="location.reload()">L√†m L·∫°i</button>
        </div>
    </div>

<script>
// --- AUDIO ENGINE ---
const AudioContext = window.AudioContext || window.webkitAudioContext;
let audioCtx;
function initAudio() { if (!audioCtx) audioCtx = new AudioContext(); }
function playSound(type) {
    initAudio();
    if (audioCtx.state === 'suspended') audioCtx.resume();
    const osc = audioCtx.createOscillator();
    const gainNode = audioCtx.createGain();
    osc.connect(gainNode); gainNode.connect(audioCtx.destination);
    if (type === 'correct') {
        osc.type = 'sine'; osc.frequency.setValueAtTime(800, audioCtx.currentTime);
        osc.frequency.exponentialRampToValueAtTime(1200, audioCtx.currentTime + 0.1);
        gainNode.gain.setValueAtTime(0.5, audioCtx.currentTime); gainNode.gain.exponentialRampToValueAtTime(0.01, audioCtx.currentTime + 0.3);
        osc.start(); osc.stop(audioCtx.currentTime + 0.3);
    } else {
        osc.type = 'sawtooth'; osc.frequency.setValueAtTime(150, audioCtx.currentTime);
        osc.frequency.exponentialRampToValueAtTime(80, audioCtx.currentTime + 0.3);
        gainNode.gain.setValueAtTime(0.5, audioCtx.currentTime); gainNode.gain.exponentialRampToValueAtTime(0.01, audioCtx.currentTime + 0.4);
        osc.start(); osc.stop(audioCtx.currentTime + 0.4);
    }
}

// --- FULL DATABASE ---
const quizData = [
    { type: 'title', text: "Part 7: Complete the sentences with the correct form of the verbs" },
    {
        id: 1, q: "(You/ often/ skip) ________ when you were little kids?",
        opts: ["Did you often skip", "Do you often skip", "Were you often skip", "Have you often skipped"], ans: 0,
        trans: "B·∫°n c√≥ th∆∞·ªùng xuy√™n nh·∫£y d√¢y khi c√≤n l√† nh·ªØng ƒë·ª©a tr·∫ª kh√¥ng?",
        optTrans: "A. Did you often skip (Qu√° kh·ª© ƒë∆°n) | B. Do you often skip (Hi·ªán t·∫°i ƒë∆°n) | C. Were you often skip (Sai ng·ªØ ph√°p) | D. Have you often skipped (HTHT)",
        right: "C√≥ 'when you were little kids' (khi c√≤n nh·ªè) -> S·ª± vi·ªác ƒë√£ k·∫øt th√∫c ·ªü qu√° kh·ª© -> D√πng Qu√° kh·ª© ƒë∆°n (Did + S + V).",
        wrong: "B sai th√¨ hi·ªán t·∫°i. C sai v√¨ to be 'were' kh√¥ng ƒëi v·ªõi V-nguy√™n th·ªÉ. D sai v√¨ h√†nh ƒë·ªông kh√¥ng k√©o d√†i ƒë·∫øn hi·ªán t·∫°i."
    },
    {
        id: 2, q: "When there is traffic jam, it (take) ________ me a very long time to go home.",
        opts: ["takes", "took", "is taking", "take"], ans: 0,
        trans: "Khi c√≥ t·∫Øc ƒë∆∞·ªùng, n√≥ khi·∫øn t√¥i m·∫•t m·ªôt th·ªùi gian r·∫•t d√†i ƒë·ªÉ v·ªÅ nh√†.",
        optTrans: "A. takes (HTƒê - s·ªë √≠t) | B. took (QKƒê) | C. is taking (HTTD) | D. take (HTƒê - s·ªë nhi·ªÅu)",
        right: "Di·ªÖn t·∫£ s·ª± th·∫≠t hi·ªÉn nhi√™n (When there IS...). C·∫•u tr√∫c: It takes sb + time + to V. Ch·ªß ng·ªØ 'it' n√™n ƒë·ªông t·ª´ th√™m 's'.",
        wrong: "B sai th√¨ qu√° kh·ª©. C sai v√¨ kh√¥ng ph·∫£i h√†nh ƒë·ªông t·∫°m th·ªùi. D sai v√¨ thi·∫øu 's' cho ng√¥i th·ª© 3 s·ªë √≠t."
    },
    {
        id: 3, q: "Hurry up or we (miss) ________ the last bus.",
        opts: ["will miss", "miss", "missed", "are missing"], ans: 0,
        trans: "Nhanh l√™n n·∫øu kh√¥ng ch√∫ng ta s·∫Ω l·ª° chuy·∫øn xe bu√Ωt cu·ªëi c√πng ƒë·∫•y.",
        optTrans: "A. will miss (TLƒê) | B. miss (HTƒê) | C. missed (QKƒê) | D. are missing (HTTD)",
        right: "C√¢u m·ªánh l·ªánh + 'or' (n·∫øu kh√¥ng th√¨) + T∆∞∆°ng lai ƒë∆°n (will V) ƒë·ªÉ ch·ªâ h·∫≠u qu·∫£ s·∫Ω x·∫£y ra.",
        wrong: "C√°c ƒë√°p √°n c√≤n l·∫°i sai th√¨, kh√¥ng th·ªÉ hi·ªán ƒë∆∞·ª£c s·ª± vi·ªác ch∆∞a x·∫£y ra ·ªü t∆∞∆°ng lai."
    },
    {
        id: 4, q: "I'd like (tell) ________ you some funny stories.",
        opts: ["to tell", "telling", "tell", "told"], ans: 0,
        trans: "T√¥i mu·ªën k·ªÉ cho b·∫°n nghe m·ªôt v√†i c√¢u chuy·ªán vui.",
        optTrans: "A. to tell | B. telling | C. tell | D. told",
        right: "C·∫•u tr√∫c c·ªë ƒë·ªãnh: 'would like + to V' (mu·ªën l√†m g√¨). 'I'd like' = 'I would like'.",
        wrong: "Sau 'would like' b·∫Øt bu·ªôc d√πng 'to V', kh√¥ng d√πng V-ing hay V nguy√™n th·ªÉ."
    },
    {
        id: 5, q: "She got the highest score in her class despite (not study) ________ so hard.",
        opts: ["not studying", "not to study", "didn't study", "not studied"], ans: 0,
        trans: "C√¥ ·∫•y ƒë·∫°t ƒëi·ªÉm cao nh·∫•t l·ªõp m·∫∑c d√π kh√¥ng h·ªçc h√†nh qu√° chƒÉm ch·ªâ.",
        optTrans: "A. not studying | B. not to study | C. didn't study | D. not studied",
        right: "Sau 'despite' (m·∫∑c d√π) ph·∫£i l√† C·ª•m danh t·ª´ ho·∫∑c V-ing. Ph·ªß ƒë·ªãnh th√¨ th√™m 'not' tr∆∞·ªõc V-ing -> not studying.",
        wrong: "C sai v√¨ sau despite kh√¥ng ƒëi v·ªõi M·ªánh ƒë·ªÅ (S+V). B v√† D sai ng·ªØ ph√°p c∆° b·∫£n."
    },
    {
        id: 6, q: "Drivers have to (fasten) ________ seatbelt whenever they drive.",
        opts: ["fasten", "to fasten", "fastening", "fastened"], ans: 0,
        trans: "T√†i x·∫ø ph·∫£i th·∫Øt d√¢y an to√†n b·∫•t c·ª© khi n√†o h·ªç l√°i xe.",
        optTrans: "A. fasten (V-bare) | B. to fasten | C. fastening | D. fastened",
        right: "C·∫•u tr√∫c: 'have to + V nguy√™n th·ªÉ' (ph·∫£i l√†m g√¨ do quy ƒë·ªãnh, b·∫Øt bu·ªôc).",
        wrong: "T·ª´ 'to' ƒë√£ n·∫±m trong 'have to' r·ªìi n√™n ƒë·ªông t·ª´ theo sau ph·∫£i gi·ªØ nguy√™n, kh√¥ng th√™m g√¨ c·∫£."
    },
    {
        id: 7, q: "It sometimes may be difficult (get) ________ a taxi during rush-hours.",
        opts: ["to get", "getting", "get", "got"], ans: 0,
        trans: "ƒê√¥i khi c√≥ th·ªÉ r·∫•t kh√≥ ƒë·ªÉ b·∫Øt m·ªôt chi·∫øc taxi trong gi·ªù cao ƒëi·ªÉm.",
        optTrans: "A. to get | B. getting | C. get | D. got",
        right: "C·∫•u tr√∫c: It is + adj (difficult/easy...) + to V (R·∫•t kh√≥/d·ªÖ ƒë·ªÉ l√†m g√¨).",
        wrong: "Sau t√≠nh t·ª´ th∆∞·ªùng ƒëi k√®m 'to V', kh√¥ng d√πng V-ing hay V nguy√™n th·ªÉ trong c·∫•u tr√∫c ch·ªß ng·ªØ gi·∫£ 'It'."
    },
    {
        id: 8, q: "(Thousands of tourists/ visit) ________ Black Pool each year?",
        opts: ["Do thousands of tourists visit", "Did thousands of tourists visit", "Are thousands of tourists visiting", "Have thousands of tourists visited"], ans: 0,
        trans: "C√≥ h√†ng ng√†n du kh√°ch ƒë·∫øn thƒÉm Black Pool m·ªói nƒÉm kh√¥ng?",
        optTrans: "A. Do... visit (HTƒê) | B. Did... visit (QKƒê) | C. Are... visiting (HTTD) | D. Have... visited (HTHT)",
        right: "D·∫•u hi·ªáu 'each year' (m·ªói nƒÉm) ch·ªâ m·ªôt s·ª± vi·ªác l·∫∑p ƒëi l·∫∑p l·∫°i th∆∞·ªùng xuy√™n -> D√πng Hi·ªán t·∫°i ƒë∆°n. Tr·ª£ ƒë·ªông t·ª´ s·ªë nhi·ªÅu l√† 'Do'.",
        wrong: "Sai th√¨. B ch·ªâ qu√° kh·ª©, C ch·ªâ vi·ªác ƒëang x·∫£y ra l√∫c n√≥i, D ch·ªâ vi·ªác t√≠nh ƒë·∫øn hi·ªán t·∫°i."
    },
    {
        id: 9, q: "It's difficult (get) ________ used to (eat) ________ with chopsticks.",
        opts: ["to get / eating", "getting / to eat", "get / eat", "to get / eat"], ans: 0,
        trans: "R·∫•t kh√≥ ƒë·ªÉ l√†m quen v·ªõi vi·ªác ƒÉn b·∫±ng ƒë≈©a.",
        optTrans: "A. to get / eating | B. getting / to eat | C. get / eat | D. to get / eat",
        right: "V·∫ø 1: It's + adj + to V -> to get. V·∫ø 2: get used to + V-ing (l√†m quen v·ªõi vi·ªác g√¨) -> eating.",
        wrong: "C·∫ßn nh·ªõ k·ªπ 'used to V' (t·ª´ng l√†m g√¨) nh∆∞ng 'get/be used to + V-ing' (quen v·ªõi vi·ªác g√¨). ƒê√°p √°n A k·∫øt h·ª£p ƒë√∫ng nh·∫•t."
    },
    {
        id: 10, q: "Mr. Smith (pay) ________ all his bills at the end of the month.",
        opts: ["pays", "pay", "paid", "is paying"], ans: 0,
        trans: "√îng Smith thanh to√°n t·∫•t c·∫£ c√°c h√≥a ƒë∆°n c·ªßa m√¨nh v√†o cu·ªëi m·ªói th√°ng.",
        optTrans: "A. pays | B. pay | C. paid | D. is paying",
        right: "D·∫•u hi·ªáu 'at the end of the month' ch·ªâ th√≥i quen/l·ªãch tr√¨nh l·∫∑p l·∫°i -> Hi·ªán t·∫°i ƒë∆°n. Mr. Smith (ng√¥i 3 s·ªë √≠t) -> th√™m 's'.",
        wrong: "B thi·∫øu 's'. C sai v√¨ kh√¥ng c√≥ d·∫•u hi·ªáu qu√° kh·ª©. D sai v√¨ kh√¥ng di·ªÖn t·∫£ h√†nh ƒë·ªông t·∫°m th·ªùi l√∫c n√≥i."
    },
    {
        id: 11, q: "Don't talk to me. I (try) ________ to learn this page by heart.",
        opts: ["am trying", "try", "tried", "have tried"], ans: 0,
        trans: "ƒê·ª´ng n√≥i chuy·ªán v·ªõi t√¥i. T√¥i ƒëang c·ªë g·∫Øng h·ªçc thu·ªôc l√≤ng trang n√†y.",
        optTrans: "A. am trying (HTTD) | B. try (HTƒê) | C. tried (QKƒê) | D. have tried (HTHT)",
        right: "C√¢u m·ªánh l·ªánh 'Don't talk to me' cho th·∫•y h√†nh ƒë·ªông 'c·ªë g·∫Øng' ƒëang di·ªÖn ra NGAY L√öC N√ìI -> D√πng Hi·ªán t·∫°i ti·∫øp di·ªÖn.",
        wrong: "C√°c ƒë√°p √°n kh√°c kh√¥ng th·ªÉ hi·ªán ƒë∆∞·ª£c t√≠nh ti·∫øp di·ªÖn t·∫°m th·ªùi ngay t·∫°i th·ªùi ƒëi·ªÉm hi·ªán t·∫°i."
    },
    {
        id: 12, q: "(You/ clean) ________ up the dirty streets in your area last Sunday?",
        opts: ["Did you clean", "Do you clean", "Were you cleaning", "Have you cleaned"], ans: 0,
        trans: "B·∫°n ƒë√£ d·ªçn d·∫πp nh·ªØng con ƒë∆∞·ªùng b·∫©n th·ªâu trong khu v·ª±c c·ªßa b·∫°n v√†o Ch·ªß nh·∫≠t tu·∫ßn tr∆∞·ªõc ph·∫£i kh√¥ng?",
        optTrans: "A. Did you clean (QKƒê) | B. Do you clean (HTƒê) | C. Were you cleaning (QKTD) | D. Have you cleaned (HTHT)",
        right: "D·∫•u hi·ªáu 'last Sunday' (Ch·ªß nh·∫≠t tr∆∞·ªõc) ch·ªâ th·ªùi ƒëi·ªÉm x√°c ƒë·ªãnh trong qu√° kh·ª© -> D√πng Qu√° kh·ª© ƒë∆°n (Did + S + V).",
        wrong: "B sai th√¨ hi·ªán t·∫°i. C sai v√¨ kh√¥ng nh·∫•n m·∫°nh t√≠nh ƒëang ti·∫øp di·ªÖn t·∫°i m·ªôt gi·ªù c·ª• th·ªÉ trong qu√° kh·ª©. D sai v√¨ ƒë√£ c√≥ th·ªùi gian c·ª• th·ªÉ ·ªü qu√° kh·ª©."
    },
    {
        id: 13, q: "(They/ start) ________ the community garden project in 2012?",
        opts: ["Did they start", "Do they start", "Were they starting", "Have they started"], ans: 0,
        trans: "H·ªç ƒë√£ b·∫Øt ƒë·∫ßu d·ª± √°n v∆∞·ªùn c·ªông ƒë·ªìng v√†o nƒÉm 2012 ph·∫£i kh√¥ng?",
        optTrans: "A. Did they start (QKƒê) | B. Do they start (HTƒê) | C. Were they starting (QKTD) | D. Have they started (HTHT)",
        right: "D·∫•u hi·ªáu 'in 2012' l√† m·ªôt m·ªëc th·ªùi gian ƒë√£ qua trong qu√° kh·ª© -> D√πng Qu√° kh·ª© ƒë∆°n (Did + S + V).",
        wrong: "Ch·ªâ d√πng HTHT (D) n·∫øu c√≥ t·ª´ 'since 2012'. ·ªû ƒë√¢y ch·ªâ l√† 'in 2012' n√™n ch·ªët QKƒê."
    },
    {
        id: 14, q: "Sit down and watch TV. I (finish) ________ my work soon before I join you.",
        opts: ["will finish", "finish", "am finishing", "finished"], ans: 0,
        trans: "Ng·ªìi xu·ªëng v√† xem TV ƒëi. T√¥i s·∫Ω ho√†n th√†nh c√¥ng vi·ªác s·ªõm tr∆∞·ªõc khi t√¥i tham gia c√πng b·∫°n.",
        optTrans: "A. will finish (TLƒê) | B. finish (HTƒê) | C. am finishing (HTTD) | D. finished (QKƒê)",
        right: "H√†nh ƒë·ªông 'finish' s·∫Ω x·∫£y ra trong t∆∞∆°ng lai (sau khi ng∆∞·ªùi kia ng·ªìi xu·ªëng). D·∫•u hi·ªáu 'soon' -> T∆∞∆°ng lai ƒë∆°n.",
        wrong: "B, C, D sai th√¨, kh√¥ng di·ªÖn t·∫£ m·ªôt l·ªùi h·ª©a/d·ª± ƒë·ªãnh t·ª©c th·ªùi trong t∆∞∆°ng lai."
    },
    {
        id: 15, q: "(Eating fruit and vegetables every day/ be) ________ healthy?",
        opts: ["Is eating fruit and vegetables every day", "Are eating fruit and vegetables every day", "Does eating fruit and vegetables every day be", "Do eating fruit and vegetables every day be"], ans: 0,
        trans: "ƒÇn tr√°i c√¢y v√† rau c·ªß m·ªói ng√†y c√≥ t·ªët cho s·ª©c kh·ªèe kh√¥ng?",
        optTrans: "A. Is eating... | B. Are eating... | C. Does eating... be | D. Do eating... be",
        right: "Ch·ªß ng·ªØ c·ªßa c√¢u l√† m·ªôt Danh ƒë·ªông t·ª´ V-ing (Eating...), do ƒë√≥ ƒë·ªông t·ª´ tobe lu√¥n chia ·ªü s·ªë √≠t l√† 'Is'. ƒê·∫£o 'Is' l√™n ƒë·∫ßu ƒë·ªÉ l√†m c√¢u h·ªèi.",
        wrong: "B sai v√¨ chia s·ªë nhi·ªÅu (Are). C v√† D sai ng·ªØ ph√°p v√¨ 'be' l√† ƒë·ªông t·ª´ tobe, kh√¥ng ƒëi m∆∞·ª£n tr·ª£ ƒë·ªông t·ª´ Do/Does."
    },

    { type: 'title', text: "Part 8: Complete the sentences with the correct preposition" },
    {
        id: 16, q: "In spite ________ their tiredness, they wanted to watch the film.",
        opts: ["of", "off", "with", "about"], ans: 0, trans: "M·∫∑c d√π h·ªç r·∫•t m·ªát, h·ªç v·∫´n mu·ªën xem b·ªô phim.",
        optTrans: "A. of | B. off | C. with | D. about", right: "C·ª•m t·ª´ c·ªë ƒë·ªãnh: 'In spite of + Noun/V-ing' (M·∫∑c d√π).", wrong: "C√°c gi·ªõi t·ª´ kh√°c kh√¥ng t·∫°o th√†nh c·ª•m t·ª´ c√≥ nghƒ©a chu·∫©n x√°c."
    },
    {
        id: 17, q: "What time does the post office close? It closes ________ about half past four.",
        opts: ["at", "on", "in", "to"], ans: 0, trans: "B∆∞u ƒëi·ªán ƒë√≥ng c·ª≠a l√∫c m·∫•y gi·ªù? N√≥ ƒë√≥ng c·ª≠a v√†o kho·∫£ng 4 r∆∞·ª°i.",
        optTrans: "A. at | B. on | C. in | D. to", right: "Gi·ªù gi·∫•c ch√≠nh x√°c tr√™n ƒë·ªìng h·ªì d√πng gi·ªõi t·ª´ 'at' (at 4:30).", wrong: "in (th√°ng/nƒÉm), on (ng√†y/th·ª©)."
    },
    {
        id: 18, q: "What's your date ________ birth?",
        opts: ["of", "on", "in", "at"], ans: 0, trans: "Ng√†y th√°ng nƒÉm sinh c·ªßa b·∫°n l√† g√¨?",
        optTrans: "A. of | B. on | C. in | D. at", right: "C·ª•m danh t·ª´ c·ªë ƒë·ªãnh: 'date of birth' (Ng√†y sinh).", wrong: "Kh√¥ng d√πng on, in, at cho c·ª•m t·ª´ s·ªü h·ªØu n√†y."
    },
    {
        id: 19, q: "We give each other presents ________ Christmas.",
        opts: ["at", "on", "in", "for"], ans: 0, trans: "Ch√∫ng t√¥i t·∫∑ng qu√† cho nhau v√†o d·ªãp L·ªÖ Gi√°ng sinh.",
        optTrans: "A. at | B. on | C. in | D. for", right: "Ch·ªâ m·ªôt D·ªäP l·ªÖ h·ªôi k√©o d√†i nhi·ªÅu ng√†y ta d√πng 'at' (at Christmas, at Easter).", wrong: "Ch·ªâ d√πng 'on' n·∫øu c√≥ ch·ªØ 'Day' (VD: on Christmas Day)."
    },
    {
        id: 20, q: "Were you disappointed ________ your examination results?",
        opts: ["with", "of", "on", "for"], ans: 0, trans: "B·∫°n c√≥ th·∫•t v·ªçng v·ªõi k·∫øt qu·∫£ k·ª≥ thi c·ªßa m√¨nh kh√¥ng?",
        optTrans: "A. with | B. of | C. on | D. for", right: "T√≠nh t·ª´ 'disappointed' ƒëi k√®m gi·ªõi t·ª´ 'with', 'about', ho·∫∑c 'at' (Th·∫•t v·ªçng v·ªÅ ƒëi·ªÅu g√¨).", wrong: "R·∫•t nhi·ªÅu b·∫°n nh·∫ßm d√πng 'of', nh∆∞ng trong ti·∫øng Anh kh√¥ng c√≥ 'disappointed of'."
    },
    {
        id: 21, q: "Your writing is similar ________ mine.",
        opts: ["to", "with", "of", "as"], ans: 0, trans: "Ch·ªØ vi·∫øt c·ªßa b·∫°n t∆∞∆°ng t·ª± nh∆∞ ch·ªØ c·ªßa t√¥i.",
        optTrans: "A. to | B. with | C. of | D. as", right: "Collocation: 'be similar to sth' (T∆∞∆°ng t·ª± v·ªõi c√°i g√¨).", wrong: "Ti·∫øng Vi·ªát n√≥i 't∆∞∆°ng t·ª± V·ªöI' n√™n hay nh·∫ßm th√†nh 'with', nh∆∞ng ti·∫øng Anh b·∫Øt bu·ªôc d√πng 'to'."
    },
    {
        id: 22, q: "I was watching TV ________ 9 to 12 o'clock yesterday.",
        opts: ["from", "between", "at", "in"], ans: 0, trans: "T√¥i ƒë√£ xem TV t·ª´ 9 gi·ªù ƒë·∫øn 12 gi·ªù h√¥m qua.",
        optTrans: "A. from | B. between | C. at | D. in", right: "C·∫•u tr√∫c kho·∫£ng th·ªùi gian: 'from [time 1] to [time 2]' (T·ª´ gi·ªù n√†o ƒë·∫øn gi·ªù n√†o).", wrong: "N·∫øu d√πng 'between' th√¨ ph·∫£i ƒëi v·ªõi 'and' (between 9 and 12)."
    },
    {
        id: 23, q: "Are you interested ________ listening to pop music?",
        opts: ["in", "on", "at", "about"], ans: 0, trans: "B·∫°n c√≥ th√≠ch nghe nh·∫°c pop kh√¥ng?",
        optTrans: "A. in | B. on | C. at | D. about", right: "C·ª•m t√≠nh t·ª´ c·ªë ƒë·ªãnh: 'be interested in + N/V-ing' (Th√≠ch th√∫/quan t√¢m ƒë·∫øn vi·ªác g√¨).", wrong: "Kh√¥ng ƒëi v·ªõi c√°c gi·ªõi t·ª´ kh√°c. 'Keen on', 'Fond of', nh∆∞ng 'Interested in'."
    },
    {
        id: 24, q: "My mother has completely made this skirt ________ cotton.",
        opts: ["of", "from", "by", "with"], ans: 0, trans: "M·∫π t√¥i ƒë√£ may chi·∫øc v√°y n√†y ho√†n to√†n b·∫±ng cotton.",
        optTrans: "A. of | B. from | C. by | D. with", right: "Make of: l√†m t·ª´ ch·∫•t li·ªáu g√¨ (v·∫´n gi·ªØ nguy√™n b·∫£n ch·∫•t ch·∫•t li·ªáu, nh√¨n v√†o v√°y th·∫•y cotton).", wrong: "Make from d√πng khi ch·∫•t li·ªáu b·ªã bi·∫øn ƒë·ªïi (Nho -> r∆∞·ª£u vang). ·ªû ƒë√¢y d√πng 'of' l√† chu·∫©n nh·∫•t."
    },
    {
        id: 25, q: "My uncle left our house three years ago, and we haven't seen him ________",
        opts: ["since", "for", "from", "ago"], ans: 0, trans: "Ch√∫ t√¥i ƒë√£ r·ªùi nh√† c√°ch ƒë√¢y 3 nƒÉm, v√† ch√∫ng t√¥i ch∆∞a g·∫∑p l·∫°i ch√∫ ·∫•y k·ªÉ t·ª´ ƒë√≥.",
        optTrans: "A. since | B. for | C. from | D. ago", right: "Cu·ªëi c√¢u HTHT c√≥ th·ªÉ d√πng ch·ªØ 'since' ƒë·ª©ng m·ªôt m√¨nh v·ªõi nghƒ©a l√† 'k·ªÉ t·ª´ ƒë√≥ t·ªõi nay'.", wrong: "'for' ph·∫£i c·ªông v·ªõi m·ªôt kho·∫£ng th·ªùi gian."
    },
    {
        id: 26, q: "Their son has cleaned the floors ________ three hours.",
        opts: ["for", "since", "in", "during"], ans: 0, trans: "Con trai h·ªç ƒë√£ lau s√†n ƒë∆∞·ª£c 3 ti·∫øng ƒë·ªìng h·ªì r·ªìi.",
        optTrans: "A. for | B. since | C. in | D. during", right: "Trong th√¨ HTHT: 'for' + Kho·∫£ng th·ªùi gian (three hours).", wrong: "Since + M·ªëc th·ªùi gian (Since 3 o'clock). ·ªû ƒë√¢y l√† 3 ti·∫øng n√™n d√πng 'for'."
    },
    {
        id: 27, q: "We are looking forward ________ new possibilities.",
        opts: ["to", "for", "at", "in"], ans: 0, trans: "Ch√∫ng t√¥i ƒëang mong ch·ªù nh·ªØng c∆° h·ªôi m·ªõi.",
        optTrans: "A. to | B. for | C. at | D. in", right: "C·ª•m ƒë·ªông t·ª´: 'look forward to + N/V-ing' (Mong ng√≥ng, mong ch·ªù ƒëi·ªÅu g√¨).", wrong: "Ch·ªØ 'to' ·ªü ƒë√¢y l√† GI·ªöI T·ª™ ch·ª© kh√¥ng ph·∫£i to-infinitive."
    },
    {
        id: 28, q: "We get used ________ living in the dormitory.",
        opts: ["to", "with", "in", "on"], ans: 0, trans: "Ch√∫ng t√¥i d·∫ßn quen v·ªõi vi·ªác s·ªëng trong k√Ω t√∫c x√°.",
        optTrans: "A. to | B. with | C. in | D. on", right: "C·∫•u tr√∫c: 'get/be used to + V-ing/N' (L√†m quen v·ªõi vi·ªác g√¨).", wrong: "ƒê·ª´ng nh·∫ßm v·ªõi 'used to V' (t·ª´ng l√†m g√¨). Gi·ªõi t·ª´ b·∫Øt bu·ªôc l√† 'to'."
    },
    {
        id: 29, q: "Our students are aware ________ pollution effects on their health.",
        opts: ["of", "about", "to", "with"], ans: 0, trans: "H·ªçc sinh c·ªßa ch√∫ng t√¥i nh·∫≠n th·ª©c ƒë∆∞·ª£c t√°c ƒë·ªông c·ªßa √¥ nhi·ªÖm ƒë·ªëi v·ªõi s·ª©c kh·ªèe c·ªßa c√°c em.",
        optTrans: "A. of | B. about | C. to | D. with", right: "T√≠nh t·ª´: 'be aware of sth' (Nh·∫≠n th·ª©c ƒë∆∞·ª£c v·ªÅ ƒëi·ªÅu g√¨).", wrong: "R·∫•t d·ªÖ nh·∫ßm v·ªõi 'about' (v·ªÅ), nh∆∞ng ng·ªØ ph√°p Anh chu·∫©n quy ƒë·ªãnh d√πng 'of'."
    },
    {
        id: 30, q: "He went there ________ Quynh's car.",
        opts: ["in", "by", "on", "with"], ans: 0, trans: "Anh ·∫•y ƒë·∫øn ƒë√≥ b·∫±ng xe h∆°i c·ªßa Qu·ª≥nh.",
        optTrans: "A. in | B. by | C. on | D. with", right: "ƒêi b·∫±ng ph∆∞∆°ng ti·ªán c√≥ S·ªû H·ªÆU C·ª§ TH·ªÇ (Quynh's car, my car, a taxi) ta d√πng 'in' cho √¥ t√¥, 'on' cho xe m√°y/bu√Ωt.", wrong: "Ch·ªâ d√πng 'by' khi n√≥i chung chung: by car, by bus (kh√¥ng c√≥ m·∫°o t·ª´/s·ªü h·ªØu c√°ch xen gi·ªØa)."
    },

    { type: 'title', text: "Part 9: Choose the correct answer" },
    {
        id: 31, q: "You had better _________ at home until you feel better.",
        opts: ["stay", "to stay", "staying", "stayed"], ans: 0, trans: "T·ªët h∆°n h·∫øt b·∫°n n√™n ·ªü nh√† cho ƒë·∫øn khi c·∫£m th·∫•y kh·ªèe h∆°n.",
        optTrans: "A. stay | B. to stay | C. staying | D. stayed", right: "C·∫•u tr√∫c: 'had better + V nguy√™n th·ªÉ' (T·ªët h∆°n n√™n l√†m g√¨ - L·ªùi khuy√™n).", wrong: "Tuy·ªát ƒë·ªëi kh√¥ng th√™m 'to' hay 'ing' sau had better."
    },
    {
        id: 32, q: "He was offered the job _________ his qualifications were poor.",
        opts: ["even though", "despite", "in spite of", "whereas"], ans: 0, trans: "Anh ·∫•y ƒë∆∞·ª£c nh·∫≠n v√†o l√†m m·∫∑c d√π b·∫±ng c·∫•p r·∫•t k√©m.",
        optTrans: "A. even though (+ M·ªánh ƒë·ªÅ) | B. despite (+ N) | C. in spite of (+ N) | D. whereas", right: "V·∫ø sau 'his qualifications were poor' l√† m·ªôt M·ªÜNH ƒê·ªÄ (c√≥ S v√† V). Nghƒ©a t∆∞∆°ng ph·∫£n -> Even though.", wrong: "B, C c·∫ßn c·ª•m danh t·ª´. D (trong khi) kh√¥ng h·ª£p ng·ªØ c·∫£nh."
    },
    {
        id: 33, q: "She is hard working. _________, she isn't lucky in examinations.",
        opts: ["However", "Therefore", "But", "So"], ans: 0, trans: "C√¥ ·∫•y r·∫•t chƒÉm ch·ªâ. Tuy nhi√™n, c√¥ ·∫•y kh√¥ng may m·∫Øn trong thi c·ª≠.",
        optTrans: "A. However | B. Therefore | C. But | D. So", right: "ƒê·ª©ng sau d·∫•u ch·∫•m (.) v√† tr∆∞·ªõc ph·∫©y (,), mang nghƒ©a t∆∞∆°ng ph·∫£n -> However (Tuy nhi√™n).", wrong: "But v√† So kh√¥ng ƒë·ª©ng ƒë·ªôc l·∫≠p tr∆∞·ªõc d·∫•u ph·∫©y. Therefore mang nghƒ©a k·∫øt qu·∫£ (V√¨ v·∫≠y)."
    },
    {
        id: 34, q: "_________ she sure that they will find the film entertaining?",
        opts: ["Is", "Was", "Will", "Should"], ans: 0, trans: "C√¥ ·∫•y c√≥ ch·∫Øc r·∫±ng h·ªç s·∫Ω th·∫•y b·ªô phim gi·∫£i tr√≠ kh√¥ng?",
        optTrans: "A. Is | B. Was | C. Will | D. Should", right: "V·∫ø sau l√† 'will find' (T∆∞∆°ng lai/Hi·ªán t·∫°i) n√™n ƒë·ªông t·ª´ tobe ·ªü ƒë·∫ßu c√¢u h·ªèi ph·∫£i l√† Hi·ªán t·∫°i -> 'Is'. 'sure' l√† t√≠nh t·ª´ n√™n ƒëi v·ªõi tobe.", wrong: "Was l√† qu√° kh·ª©. Will/Should l√† tr·ª£ ƒë·ªông t·ª´, theo sau ph·∫£i l√† ƒë·ªông t·ª´ nguy√™n th·ªÉ ch·ª© kh√¥ng ƒëi th·∫≥ng v·ªõi t√≠nh t·ª´ 'sure'."
    },
    {
        id: 35, q: "_________, he walked to the station.",
        opts: ["Despite being tired", "Despite tired", "In spite being tired", "Although to be tired"], ans: 0, trans: "M·∫∑c d√π r·∫•t m·ªát, anh ·∫•y v·∫´n ƒëi b·ªô ra ga.",
        optTrans: "A. Despite being tired | B. Despite tired | C. In spite being... | D. Although...", right: "Despite + V-ing/Noun. ·ªû ƒë√¢y d√πng V-ing c·ªßa tobe l√† 'being' + t√≠nh t·ª´ 'tired'.", wrong: "B thi·∫øu 'being'. C thi·∫øu 'of' sau In spite. D sai ho√†n to√†n c·∫•u tr√∫c Although (+ M·ªánh ƒë·ªÅ)."
    },
    {
        id: 36, q: "He used to _________ his mother after a working day.",
        opts: ["call", "calling", "called", "have called"], ans: 0, trans: "Anh ·∫•y t·ª´ng c√≥ th√≥i quen g·ªçi ƒëi·ªán cho m·∫π sau m·ªôt ng√†y l√†m vi·ªác.",
        optTrans: "A. call | B. calling | C. called | D. have called", right: "C·∫•u tr√∫c: 'used to + V nguy√™n th·ªÉ' (T·ª´ng l√†m g√¨ trong qu√° kh·ª©, gi·ªù kh√¥ng l√†m n·ªØa).", wrong: "Ch·ªâ khi n√†o c√≥ 'be/get used to' m·ªõi c·ªông V-ing. ·ªû ƒë√¢y ch·ªâ l√† used to."
    },
    {
        id: 37, q: "Did your mother help you _________ the letter yesterday?",
        opts: ["to post", "posting", "posts", "posted"], ans: 0, trans: "M·∫π b·∫°n c√≥ gi√∫p b·∫°n g·ª≠i b·ª©c th∆∞ ng√†y h√¥m qua kh√¥ng?",
        optTrans: "A. to post | B. posting | C. posts | D. posted", right: "C·∫•u tr√∫c: 'help sb (to) do sth' (gi√∫p ai ƒë√≥ l√†m g√¨). C√≥ th·ªÉ d√πng 'to post' ho·∫∑c 'post' (nguy√™n th·ªÉ). ·ªû ƒë√¢y c√≥ 'to post'.", wrong: "Tuy·ªát ƒë·ªëi kh√¥ng d√πng V-ing hay V-ed sau Help sb."
    },
    {
        id: 38, q: "How old were you when you learnt _________ a bike?",
        opts: ["how to ride", "which to ride", "what to ride", "where to ride"], ans: 0, trans: "B·∫°n bao nhi√™u tu·ªïi khi h·ªçc c√°ch ƒëi xe ƒë·∫°p?",
        optTrans: "A. how to ride | B. which to ride | C. what to ride | D. where to ride", right: "Learn how to do sth: H·ªçc C√ÅCH l√†m m·ªôt k·ªπ nƒÉng g√¨ ƒë√≥.", wrong: "C√°c t·ª´ ƒë·ªÉ h·ªèi kh√°c kh√¥ng ph√π h·ª£p ng·ªØ nghƒ©a."
    },
    {
        id: 39, q: "Did Nick _________ work on a building site?",
        opts: ["use to", "used to", "get used", "got used"], ans: 0, trans: "Nick ƒë√£ t·ª´ng l√†m vi·ªác ·ªü c√¥ng tr∆∞·ªùng x√¢y d·ª±ng ph·∫£i kh√¥ng?",
        optTrans: "A. use to | B. used to | C. get used | D. got used", right: "Trong c√¢u nghi v·∫•n c√≥ m∆∞·ª£n tr·ª£ ƒë·ªông t·ª´ 'Did', ƒë·ªông t·ª´ ch√≠nh 'use' ph·∫£i tr·∫£ v·ªÅ nguy√™n th·ªÉ -> 'use to'.", wrong: "B sai v√¨ v·∫´n ƒë·ªÉ 'd'. C, D sai c·∫•u tr√∫c th√≥i quen qu√° kh·ª©."
    },
    {
        id: 40, q: "The children slept deeply _________ the noise.",
        opts: ["despite", "in spite", "nevertheless", "however"], ans: 0, trans: "L≈© tr·∫ª ng·ªß r·∫•t say m·∫∑c cho ti·∫øng ·ªìn.",
        optTrans: "A. despite | B. in spite | C. nevertheless | D. however", right: "Sau √¥ tr·ªëng l√† 'the noise' (C·ª•m danh t·ª´). Do ƒë√≥ ph·∫£i d√πng 'despite' (M·∫∑c d√π).", wrong: "B thi·∫øu 'of'. C v√† D ph·∫£i ƒë·ª©ng sau d·∫•u ch·∫•m v√† c√≥ d·∫•u ph·∫©y ƒëi k√®m (Tuy nhi√™n)."
    },
    {
        id: 41, q: "_________ hard I pulled, the door wouldn't open.",
        opts: ["However", "Although", "In spite of", "Though"], ans: 0, trans: "Cho d√π t√¥i c√≥ k√©o m·∫°nh ƒë·∫øn ƒë√¢u, c√°nh c·ª≠a c≈©ng kh√¥ng ch·ªãu m·ªü.",
        optTrans: "A. However | B. Although | C. In spite of | D. Though", right: "C·∫•u tr√∫c: 'However + Adj/Adv + S + V' (Cho d√π... ƒë·∫øn ƒë√¢u). Ph√π h·ª£p v·ªõi 'However hard I pulled'.", wrong: "Although/Though + S + V (kh√¥ng ƒë·∫£o Adj/Adv l√™n tr∆∞·ªõc). In spite of + N."
    },
    {
        id: 42, q: "He can't lose weight, no matter _________ hard he tries.",
        opts: ["how", "what", "when", "why"], ans: 0, trans: "Anh ·∫•y kh√¥ng th·ªÉ gi·∫£m c√¢n, cho d√π anh ·∫•y c√≥ c·ªë g·∫Øng ƒë·∫øn ƒë√¢u.",
        optTrans: "A. how | B. what | C. when | D. why", right: "C·∫•u tr√∫c t∆∞∆°ng ƒë∆∞∆°ng However: 'No matter how + Adj/Adv + S + V'. ·ªû ƒë√¢y c√≥ tr·∫°ng t·ª´ 'hard' -> d√πng 'how'.", wrong: "No matter what/when/why kh√¥ng c·ªông tr·ª±c ti·∫øp v·ªõi T√≠nh t·ª´/Tr·∫°ng t·ª´."
    },
    {
        id: 43, q: "All the aquatics plants and animals may not die _________ the factory keep dumping poison into the lake.",
        opts: ["unless", "if", "should", "however"], ans: 0, trans: "T·∫•t c·∫£ c√°c lo√†i ƒë·ªông th·ª±c v·∫≠t th·ªßy sinh c√≥ th·ªÉ KH√îNG ch·∫øt TR·ª™ KHI nh√† m√°y c·ª© ti·∫øp t·ª•c x·∫£ ch·∫•t ƒë·ªôc xu·ªëng h·ªì.",
        optTrans: "A. unless | B. if | C. should | D. however", right: "C√¢u c√≥ nghƒ©a logic: Ch√∫ng s·∫Ω S·ªêNG (kh√¥ng ch·∫øt) N·∫æU nh√† m√°y KH√îNG x·∫£. 'Unless' mang nghƒ©a 'N·∫øu kh√¥ng' (If not).", wrong: "N·∫øu ƒëi·ªÅn 'If', c√¢u s·∫Ω v√¥ l√Ω (Ch√∫ng kh√¥ng ch·∫øt N·∫æU nh√† m√°y ti·∫øp t·ª•c x·∫£ ƒë·ªôc)."
    },
    {
        id: 44, q: "_________ more help, I would call my neighbor.",
        opts: ["Should I need", "Needed", "I have needed", "I should need"], ans: 0, trans: "N·∫øu t√¥i c·∫ßn th√™m s·ª± gi√∫p ƒë·ª°, t√¥i s·∫Ω g·ªçi cho h√†ng x√≥m.",
        optTrans: "A. Should I need | B. Needed | C. I have needed | D. I should need", right: "ƒê√¢y l√† c√¢u ƒê·∫£o ng·ªØ c√¢u ƒëi·ªÅu ki·ªán lo·∫°i 1/2. C·∫•u tr√∫c ƒë·∫£o ng·ªØ If: 'Should + S + V (nguy√™n th·ªÉ)'. T∆∞∆°ng ƒë∆∞∆°ng: If I should need...", wrong: "C√°c c·∫•u tr√∫c c√≤n l·∫°i sai ng·ªØ ph√°p c∆° b·∫£n c·ªßa c√¢u ƒëi·ªÅu ki·ªán."
    },
    {
        id: 45, q: "You'd better _________ these exercises carefully.",
        opts: ["do", "did", "to do", "doing"], ans: 0, trans: "T·ªët h∆°n h·∫øt b·∫°n n√™n l√†m nh·ªØng b√†i t·∫≠p n√†y m·ªôt c√°ch c·∫©n th·∫≠n.",
        optTrans: "A. do | B. did | C. to do | D. doing", right: "'You'd better' = 'You had better' + V(nguy√™n th·ªÉ). Khuy√™n b·∫£o ai n√™n l√†m g√¨.", wrong: "Tuy·ªát ƒë·ªëi kh√¥ng chia V-ed, to-V hay V-ing sau had better."
    }
];

// --- RENDER LOGIC ---
let totalScore = 0; let answeredQuestions = 0;
const totalQuestions = quizData.filter(q => q.id).length;

function shuffleArray(array) {
    let arr = array.map((item, index) => ({ item, index }));
    for (let i = arr.length - 1; i > 0; i--) {
        const j = Math.floor(Math.random() * (i + 1));
        [arr[i], arr[j]] = [arr[j], arr[i]];
    }
    return arr;
}

function renderQuiz() {
    const container = document.getElementById('quiz-container');
    let html = ''; const letters = ['A', 'B', 'C', 'D'];

    quizData.forEach((data) => {
        if (data.type === 'title') {
            html += `<div class="part-title">${data.text}</div>`;
        } else {
            const shuffledOpts = shuffleArray(data.opts);
            let questionHTML = data.q.replace('________', `<span class="blank" id="blank-${data.id}">?</span>`).replace('________', `<span class="blank" id="blank2-${data.id}">?</span>`);
            
            html += `
            <div class="question-card" id="card-${data.id}">
                <div class="question-text">${data.id}. ${questionHTML}</div>
                <div class="options-grid">
            `;

            shuffledOpts.forEach((optObj, idx) => {
                const isCorrect = optObj.index === data.ans;
                const safeText = data.opts[data.ans].replace(/'/g, "\\'");
                html += `
                    <button class="option-btn" onclick="checkAnswer(${data.id}, this, ${isCorrect}, '${safeText}')">
                        <span class="opt-letter">${letters[idx]}</span> ${optObj.item}
                    </button>
                `;
            });

            // T√°ch c√°c option ƒë·ªÉ in ƒë·∫πp h∆°n
            const formattedOpts = data.optTrans.split('|').join('<br>');

            html += `
                </div>
                <div class="explanation-box" id="exp-${data.id}">
                    <h4><i class="fas fa-magic"></i> C√¥ Mai An gi·∫£i th√≠ch:</h4>
                    <p><strong><i class="fas fa-language"></i> D·ªãch:</strong> ${data.trans}</p>
                    <p><strong><i class="fas fa-search"></i> Ph√¢n t√≠ch:</strong><br>${formattedOpts}</p>
                    <p><span class="tag-correct"><i class="fas fa-check-circle"></i> V√¨ sao ƒê√öNG?</span> ${data.right}</p>
                    <p><span class="tag-incorrect"><i class="fas fa-times-circle"></i> V√¨ sao SAI?</span> ${data.wrong}</p>
                </div>
            </div>`;
        }
    });
    container.innerHTML = html;
}

function checkAnswer(qId, btnElement, isCorrect, correctText) {
    const card = document.getElementById(`card-${qId}`);
    const buttons = card.querySelectorAll('.option-btn');
    const blank = document.getElementById(`blank-${qId}`);
    const blank2 = document.getElementById(`blank2-${qId}`);
    const expBox = document.getElementById(`exp-${qId}`);

    buttons.forEach(btn => btn.disabled = true);
    answeredQuestions++;

    let answerText = btnElement.innerText.substring(2).trim();
    if (blank) {
        if(answerText.includes('/')) {
            let parts = answerText.split('/');
            blank.innerText = parts[0].trim();
            if(blank2) blank2.innerText = parts[1].trim();
        } else {
            blank.innerText = answerText;
        }
    }

    if (isCorrect) {
        playSound('correct'); btnElement.classList.add('correct');
        if(blank) { blank.style.color = 'var(--correct)'; blank.style.borderColor = 'var(--correct)'; }
        if(blank2) { blank2.style.color = 'var(--correct)'; blank2.style.borderColor = 'var(--correct)'; }
        totalScore++;
        const rect = btnElement.getBoundingClientRect();
        const x = (rect.left + rect.width / 2) / window.innerWidth; const y = (rect.top + rect.height / 2) / window.innerHeight;
        confetti({ particleCount: 60, spread: 60, origin: { x: x, y: y }, colors: ['#00D26A', '#FFC312', '#8854C0'] });
    } else {
        playSound('incorrect'); btnElement.classList.add('incorrect'); card.classList.add('shake');
        if(blank) { blank.style.color = 'var(--incorrect)'; blank.style.borderColor = 'var(--incorrect)'; }
        if(blank2) { blank2.style.color = 'var(--incorrect)'; blank2.style.borderColor = 'var(--incorrect)'; }
        
        buttons.forEach(btn => { if (btn.innerText.includes(correctText)) btn.classList.add('correct'); });
        setTimeout(() => card.classList.remove('shake'), 500);
    }
    expBox.style.display = 'block';
}

function showScore() {
    const modal = document.getElementById('scoreModal');
    const scoreDisplay = document.getElementById('score-display');
    const msg = document.getElementById('score-message');

    scoreDisplay.innerText = `${totalScore}/${totalQuestions}`;
    
    if (totalScore === totalQuestions) {
        msg.innerText = "Tuy·ªát ƒë·ªânh! Tr·ªçn v·∫πn 45/45 lu√¥n, em ƒë√∫ng l√† h·ªçc tr√≤ c∆∞ng c·ªßa c√¥ Mai An! üèÜ";
        confetti({ particleCount: 300, spread: 150, origin: {y: 0.3}});
    } else if (totalScore > totalQuestions / 2) {
        msg.innerText = "Gi·ªèi l·∫Øm! ƒê·ªçc k·ªπ ph·∫ßn gi·∫£i th√≠ch nh·ªØng c√¢u sai ƒë·ªÉ v∆∞∆°n l√™n 10 ƒëi·ªÉm nh√©! üåü";
        confetti({ particleCount: 100, spread: 70, origin: {y: 0.3}});
    } else {
        msg.innerText = "ƒê·ª´ng bu·ªìn nh√©! C·ª© ƒë·ªçc th·∫≠t k·ªπ ph·∫ßn 'C√¥ Mai An gi·∫£i th√≠ch' l√† em s·∫Ω ti·∫øn b·ªô ngay l·∫≠p t·ª©c! üí™";
    }
    modal.style.display = 'flex';
}

window.onload = renderQuiz;
</script>
</body>
</html>