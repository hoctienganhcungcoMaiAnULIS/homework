<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Exercise 8: Prepositions (Gi·ªõi t·ª´) - M√¥i tr∆∞·ªùng | Ms. Mai An ULIS</title>
    <!-- Google Fonts: Nunito & Quicksand -->
    <link href="https://fonts.googleapis.com/css2?family=Nunito:wght@400;600;700;800&family=Quicksand:wght@500;700&display=swap" rel="stylesheet">
    <!-- Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>
    <!-- Confetti Library -->
    <script src="https://cdn.jsdelivr.net/npm/canvas-confetti@1.6.0/dist/confetti.browser.min.js"></script>
    <!-- Font Awesome -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">

    <style>
        :root {
            --primary: #8854C0; /* T√≠m Pastel */
            --secondary: #00C9A7; /* Xanh ng·ªçc */
            --correct: #00D26A; /* Xanh l√° */
            --wrong: #FF4757; /* ƒê·ªè cam */
            --bg-pattern: #f3f4f6;
        }

        body {
            font-family: 'Nunito', sans-serif;
            background-color: #E0E7FF;
            background-image: radial-gradient(#8854C0 0.5px, transparent 0.5px), radial-gradient(#8854C0 0.5px, #E0E7FF 0.5px);
            background-size: 20px 20px;
            background-position: 0 0, 10px 10px;
            color: #2d3748;
            overflow-x: hidden;
        }

        .card {
            background: white;
            border-radius: 20px;
            box-shadow: 0 8px 0 rgba(0,0,0,0.1), 0 10px 20px rgba(0,0,0,0.15);
            transition: transform 0.3s ease;
            margin-bottom: 2rem;
            border: 2px solid #e2e8f0;
        }

        .question-text {
            font-family: 'Quicksand', sans-serif;
            color: #2d3748;
        }

        /* 3D Button Styles */
        .option-btn {
            background-color: #f8fafc;
            border: 2px solid #cbd5e1;
            border-bottom-width: 6px;
            border-radius: 15px;
            transition: all 0.1s;
            position: relative;
            font-weight: 700;
            color: #475569;
        }

        .option-btn:active {
            transform: translateY(4px);
            border-bottom-width: 2px;
        }

        .option-btn:hover:not(:disabled) {
            transform: translateY(-2px);
            background-color: #f1f5f9;
        }

        /* Correct State */
        .option-btn.correct {
            background-color: var(--correct);
            border-color: #00a653;
            color: white;
            border-bottom-width: 6px;
        }
        
        /* Wrong State */
        .option-btn.wrong {
            background-color: var(--wrong);
            border-color: #d6303e;
            color: white;
            border-bottom-width: 6px;
            animation: shake 0.5s;
        }

        /* Explanations */
        .explanation-box {
            background-color: #F0FDF4; /* Xanh l√° nh·∫°t */
            border-left: 5px solid var(--secondary);
            border-radius: 0 12px 12px 0;
            animation: slideDown 0.4s ease-out;
            display: none; /* Hidden by default */
        }

        .explanation-box.visible {
            display: block;
        }

        .vocab-tag {
            background: #EDE9FE;
            color: #8854C0;
            padding: 2px 8px;
            border-radius: 6px;
            font-size: 0.85em;
            font-weight: 700;
            margin-right: 5px;
        }

        /* Animations */
        @keyframes shake {
            0% { transform: translateX(0); }
            25% { transform: translateX(-10px) rotate(-5deg); }
            50% { transform: translateX(10px) rotate(5deg); }
            75% { transform: translateX(-10px) rotate(-5deg); }
            100% { transform: translateX(0); }
        }

        @keyframes slideDown {
            from { opacity: 0; transform: translateY(-10px); }
            to { opacity: 1; transform: translateY(0); }
        }

        @keyframes pop {
            0% { transform: scale(1); }
            50% { transform: scale(1.05); }
            100% { transform: scale(1); }
        }

        .sticky-header {
            position: sticky;
            top: 0;
            z-index: 50;
            background: rgba(255, 255, 255, 0.95);
            backdrop-filter: blur(10px);
            box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1);
        }

        /* Modal */
        .modal-overlay {
            background-color: rgba(0, 0, 0, 0.7);
        }
        
        .modal-content {
            background: white;
            border-radius: 25px;
            box-shadow: 0 20px 25px -5px rgba(0, 0, 0, 0.1);
            animation: pop 0.4s cubic-bezier(0.175, 0.885, 0.32, 1.275);
        }

        u {
            text-decoration: none;
            border-bottom: 3px solid #8854C0;
            padding-bottom: 1px;
        }
    </style>
</head>
<body class="pb-20">

    <!-- Header -->
    <header class="sticky-header py-4 px-4 mb-8">
        <div class="max-w-3xl mx-auto flex justify-between items-center">
            <div class="flex items-center gap-3">
                <div class="w-12 h-12 bg-purple-600 rounded-full flex items-center justify-center text-white text-xl font-bold shadow-lg">
                    MA
                </div>
                <div>
                    <h1 class="font-bold text-gray-800 text-lg sm:text-xl leading-tight">Ms. Mai An ULIS</h1>
                    <p class="text-sm text-purple-600 font-semibold">Ex 8: Prepositions - Environment</p>
                </div>
            </div>
            <div class="bg-white px-4 py-2 rounded-full border-2 border-purple-200 shadow-sm">
                <span class="text-gray-500 text-sm font-bold">Score: </span>
                <span id="current-score" class="text-purple-600 font-extrabold text-lg">0</span>
                <span class="text-gray-400 text-sm">/ 20</span>
            </div>
        </div>
    </header>

    <!-- Main Quiz Container -->
    <main id="quiz-container" class="max-w-3xl mx-auto px-4">
        <!-- Questions will be injected here via JS -->
    </main>

    <!-- Submit Button -->
    <div class="max-w-3xl mx-auto px-4 mt-8 text-center">
        <button onclick="submitQuiz()" class="bg-purple-600 hover:bg-purple-700 text-white font-bold py-4 px-12 rounded-full text-xl shadow-[0_6px_0_#5b21b6] active:shadow-[0_2px_0_#5b21b6] active:translate-y-1 transition-all">
            <i class="fa-solid fa-flag-checkered mr-2"></i> N·ªòP B√ÄI & XEM ƒêI·ªÇM
        </button>
    </div>

    <!-- Result Modal -->
    <div id="result-modal" class="fixed inset-0 z-50 flex items-center justify-center hidden">
        <div class="modal-overlay absolute inset-0" onclick="closeModal()"></div>
        <div class="modal-content relative z-10 w-full max-w-md mx-4 p-8 text-center border-4 border-purple-100">
            <div class="mb-6">
                <i class="fa-solid fa-trophy text-6xl text-yellow-400 drop-shadow-md"></i>
            </div>
            <h2 class="text-3xl font-extrabold text-gray-800 mb-2">K·∫øt Qu·∫£</h2>
            <p id="modal-message" class="text-gray-600 mb-6 font-medium">B·∫°n ƒë√£ l√†m r·∫•t t·ªët!</p>
            
            <div class="bg-purple-50 rounded-xl p-6 mb-8">
                <div class="text-sm text-gray-500 font-bold uppercase tracking-wider mb-1">T·ªïng ƒëi·ªÉm</div>
                <div class="text-5xl font-black text-purple-600" id="final-score">0/20</div>
            </div>

            <button onclick="closeModal()" class="w-full bg-gray-100 hover:bg-gray-200 text-gray-700 font-bold py-3 px-6 rounded-xl border-b-4 border-gray-300 active:border-b-0 active:translate-y-1 transition-all">
                Xem l·∫°i b√†i l√†m
            </button>
        </div>
    </div>

    <script>
        // --- DATA SOURCE ---
        const quizData = [
            {
                "questionNumber": 1,
                "question": "Coal power stations release sulfur dioxide ________________ the atmosphere.",
                "answerOptions": [
                    { "text": "into", "isCorrect": true },
                    { "text": "on", "isCorrect": false },
                    { "text": "at", "isCorrect": false },
                    { "text": "of", "isCorrect": false }
                ],
                "explanation": {
                    "translate": "C√°c nh√† m√°y ƒëi·ªán d√πng than th·∫£i kh√≠ l∆∞u hu·ª≥nh ƒëioxit v√†o b·∫ßu kh√≠ quy·ªÉn.",
                    "analysis": "<b>A. into:</b> v√†o trong (ch·ªâ s·ª± di chuy·ªÉn)<br><b>B. on:</b> tr√™n<br><b>C. at:</b> t·∫°i<br><b>D. of:</b> c·ªßa",
                    "reason": "C·∫•u tr√∫c <b>release sth into sth</b>: th·∫£i ch·∫•t g√¨ v√†o ƒë√¢u. ·ªû ƒë√¢y ch·ªâ s·ª± di chuy·ªÉn c·ªßa kh√≠ th·∫£i 'v√†o b√™n trong' b·∫ßu kh√≠ quy·ªÉn.",
                    "wrong": "C√°c gi·ªõi t·ª´ 'on', 'at', 'of' kh√¥ng k·∫øt h·ª£p v·ªõi 'release' ƒë·ªÉ ch·ªâ h√†nh ƒë·ªông x·∫£ th·∫£i v√†o kh√¥ng kh√≠."
                }
            },
            {
                "questionNumber": 2,
                "question": "National parks play a key role ________________ saving the environment.",
                "answerOptions": [
                    { "text": "in", "isCorrect": true },
                    { "text": "on", "isCorrect": false },
                    { "text": "for", "isCorrect": false },
                    { "text": "at", "isCorrect": false }
                ],
                "explanation": {
                    "translate": "C√°c v∆∞·ªùn qu·ªëc gia ƒë√≥ng vai tr√≤ then ch·ªët trong vi·ªác b·∫£o v·ªá m√¥i tr∆∞·ªùng.",
                    "analysis": "<b>A. in:</b> trong<br><b>B. on:</b> tr√™n<br><b>C. for:</b> cho<br><b>D. at:</b> t·∫°i",
                    "reason": "Collocation (C·ª•m t·ª´ c·ªë ƒë·ªãnh): <b>play a role in + V-ing/Noun</b> = ƒë√≥ng vai tr√≤ trong vi·ªác g√¨.",
                    "wrong": "C√°c gi·ªõi t·ª´ kh√°c kh√¥ng ƒëi v·ªõi c·ª•m 'play a role' theo nghƒ©a n√†y."
                }
            },
            {
                "questionNumber": 3,
                "question": "What type of effect does water pollution have ________________ our life?",
                "answerOptions": [
                    { "text": "in", "isCorrect": false },
                    { "text": "at", "isCorrect": false },
                    { "text": "on", "isCorrect": true },
                    { "text": "with", "isCorrect": false }
                ],
                "explanation": {
                    "translate": "√î nhi·ªÖm n∆∞·ªõc c√≥ ·∫£nh h∆∞·ªüng nh∆∞ th·∫ø n√†o l√™n cu·ªôc s·ªëng c·ªßa ch√∫ng ta?",
                    "analysis": "<b>A. in:</b> trong<br><b>B. at:</b> t·∫°i<br><b>C. on:</b> tr√™n/l√™n<br><b>D. with:</b> v·ªõi",
                    "reason": "C·∫•u tr√∫c: <b>have an effect/impact/influence ON sth/sb</b> (c√≥ ·∫£nh h∆∞·ªüng l√™n c√°i g√¨/ai).",
                    "wrong": "Kh√¥ng d√πng 'effect in', 'effect at' hay 'effect with' trong c·∫•u tr√∫c ch·ªâ s·ª± t√°c ƒë·ªông n√†y."
                }
            },
            {
                "questionNumber": 4,
                "question": "Forests provide a habitat ________________ hundreds of species ________________ plants and animals.",
                "answerOptions": [
                    { "text": "for / of", "isCorrect": true },
                    { "text": "to / in", "isCorrect": false },
                    { "text": "with / on", "isCorrect": false },
                    { "text": "of / for", "isCorrect": false }
                ],
                "explanation": {
                    "translate": "R·ª´ng cung c·∫•p m√¥i tr∆∞·ªùng s·ªëng cho h√†ng trƒÉm lo√†i th·ª±c v·∫≠t v√† ƒë·ªông v·∫≠t.",
                    "analysis": "<b>A. for / of:</b> cho / c·ªßa<br><b>B. to / in:</b> t·ªõi / trong<br><b>C. with / on:</b> v·ªõi / tr√™n<br><b>D. of / for:</b> c·ªßa / cho",
                    "reason": "1. <b>habitat FOR</b>: m√¥i tr∆∞·ªùng s·ªëng CHO ai/con g√¨.<br>2. <b>species OF</b>: lo√†i C·ª¶A (lo√†i g√¨).",
                    "wrong": "C√°c c·∫∑p gi·ªõi t·ª´ kh√°c gh√©p v√†o kh√¥ng ƒë√∫ng ng·ªØ ph√°p v√† √Ω nghƒ©a c·ªßa c√¢u."
                }
            },
            {
                "questionNumber": 5,
                "question": "Technology is already playing a key role ________________ environmental protection.",
                "answerOptions": [
                    { "text": "on", "isCorrect": false },
                    { "text": "in", "isCorrect": true },
                    { "text": "at", "isCorrect": false },
                    { "text": "for", "isCorrect": false }
                ],
                "explanation": {
                    "translate": "C√¥ng ngh·ªá ƒëang ƒë√≥ng m·ªôt vai tr√≤ then ch·ªët trong vi·ªác b·∫£o v·ªá m√¥i tr∆∞·ªùng.",
                    "analysis": "<b>A. on:</b> tr√™n<br><b>B. in:</b> trong<br><b>C. at:</b> t·∫°i<br><b>D. for:</b> cho",
                    "reason": "L·∫∑p l·∫°i c·∫•u tr√∫c c√¢u 2: <b>play a role IN sth</b> (ƒë√≥ng vai tr√≤ trong vi·ªác g√¨).",
                    "wrong": "Sai collocation."
                }
            },
            {
                "questionNumber": 6,
                "question": "There is a nice play area ________________ the children.",
                "answerOptions": [
                    { "text": "to", "isCorrect": false },
                    { "text": "with", "isCorrect": false },
                    { "text": "of", "isCorrect": false },
                    { "text": "for", "isCorrect": true }
                ],
                "explanation": {
                    "translate": "C√≥ m·ªôt khu vui ch∆°i ƒë·∫πp d√†nh cho tr·∫ª em.",
                    "analysis": "<b>A. to:</b> t·ªõi<br><b>B. with:</b> v·ªõi<br><b>C. of:</b> c·ªßa<br><b>D. for:</b> cho, d√†nh cho",
                    "reason": "D√πng gi·ªõi t·ª´ <b>FOR</b> ƒë·ªÉ ch·ªâ m·ª•c ƒë√≠ch ho·∫∑c ƒë·ªëi t∆∞·ª£ng th·ª• h∆∞·ªüng (area FOR children = khu v·ª±c D√ÄNH CHO tr·∫ª em).",
                    "wrong": "'Of' ch·ªâ s·ªü h·ªØu, 'to' ch·ªâ h∆∞·ªõng, 'with' ch·ªâ s·ª± ƒë·ªìng h√†nh, kh√¥ng h·ª£p l√Ω ·ªü ƒë√¢y."
                }
            },
            {
                "questionNumber": 7,
                "question": "The regions are home ________________ bears and mountain lions.",
                "answerOptions": [
                    { "text": "for", "isCorrect": false },
                    { "text": "to", "isCorrect": true },
                    { "text": "with", "isCorrect": false },
                    { "text": "of", "isCorrect": false }
                ],
                "explanation": {
                    "translate": "Nh·ªØng v√πng n√†y l√† n∆°i sinh s·ªëng (nh√†) c·ªßa g·∫•u v√† s∆∞ t·ª≠ n√∫i.",
                    "analysis": "<b>A. for:</b> cho<br><b>B. to:</b> t·ªõi<br><b>C. with:</b> v·ªõi<br><b>D. of:</b> c·ªßa",
                    "reason": "Th√†nh ng·ªØ (Idiom): <b>be home TO sth</b> = l√† n∆°i c∆∞ tr√∫/sinh s·ªëng c·ªßa lo√†i n√†o.",
                    "wrong": "Nhi·ªÅu b·∫°n hay nh·∫ßm l√† 'home of', nh∆∞ng c·ª•m c·ªë ƒë·ªãnh ch√≠nh x√°c ph·∫£i l√† 'home TO'."
                }
            },
            {
                "questionNumber": 8,
                "question": "I'd like to emphasize the importance ________________ protecting endangered species.",
                "answerOptions": [
                    { "text": "of", "isCorrect": true },
                    { "text": "in", "isCorrect": false },
                    { "text": "on", "isCorrect": false },
                    { "text": "with", "isCorrect": false }
                ],
                "explanation": {
                    "translate": "T√¥i mu·ªën nh·∫•n m·∫°nh t·∫ßm quan tr·ªçng c·ªßa vi·ªác b·∫£o v·ªá c√°c lo√†i c√≥ nguy c∆° tuy·ªát ch·ªßng.",
                    "analysis": "<b>A. of:</b> c·ªßa<br><b>B. in:</b> trong<br><b>C. on:</b> tr√™n<br><b>D. with:</b> v·ªõi",
                    "reason": "Danh t·ª´ <b>Importance</b> th∆∞·ªùng ƒëi v·ªõi gi·ªõi t·ª´ <b>OF</b> (The importance OF sth/V-ing).",
                    "wrong": "C√°c gi·ªõi t·ª´ kh√°c kh√¥ng ƒëi sau danh t·ª´ 'importance' ƒë·ªÉ ch·ªâ n·ªôi dung c·ªßa s·ª± quan tr·ªçng."
                }
            },
            {
                "questionNumber": 9,
                "question": "Avoid dumping waste ________________ lakes and rivers!",
                "answerOptions": [
                    { "text": "on", "isCorrect": false },
                    { "text": "into", "isCorrect": true },
                    { "text": "at", "isCorrect": false },
                    { "text": "of", "isCorrect": false }
                ],
                "explanation": {
                    "translate": "Tr√°nh ƒë·ªï r√°c th·∫£i v√†o h·ªì v√† s√¥ng!",
                    "analysis": "<b>A. on:</b> tr√™n b·ªÅ m·∫∑t<br><b>B. into:</b> v√†o b√™n trong<br><b>C. at:</b> t·∫°i<br><b>D. of:</b> c·ªßa",
                    "reason": "ƒê·ªông t·ª´ <b>dump (ƒë·ªï/x·∫£)</b> k·∫øt h·ª£p v·ªõi <b>INTO</b> ƒë·ªÉ ch·ªâ h√†nh ƒë·ªông ƒë∆∞a r√°c th·∫£i v√†o b√™n trong ngu·ªìn n∆∞·ªõc.",
                    "wrong": "'On' ch·ªâ l√† ƒë·ªÉ l√™n tr√™n b·ªÅ m·∫∑t, trong khi x·∫£ th·∫£i th∆∞·ªùng h√≤a tan ho·∫∑c ch√¨m v√†o trong n∆∞·ªõc (into)."
                }
            },
            {
                "questionNumber": 10,
                "question": "Remember to turn ________________ devices when you are not using them.",
                "answerOptions": [
                    { "text": "on", "isCorrect": false },
                    { "text": "off", "isCorrect": true },
                    { "text": "up", "isCorrect": false },
                    { "text": "down", "isCorrect": false }
                ],
                "explanation": {
                    "translate": "Nh·ªõ t·∫Øt c√°c thi·∫øt b·ªã khi b·∫°n kh√¥ng s·ª≠ d·ª•ng ch√∫ng.",
                    "analysis": "<b>A. turn on:</b> b·∫≠t<br><b>B. turn off:</b> t·∫Øt<br><b>C. turn up:</b> v·∫∑n to<br><b>D. turn down:</b> v·∫∑n nh·ªè",
                    "reason": "D·ª±a v√†o ng·ªØ c·∫£nh <b>'not using them'</b> (kh√¥ng d√πng) -> ph·∫£i <b>turn OFF</b> (t·∫Øt).",
                    "wrong": "Turn on (b·∫≠t) sai nghƒ©a. Turn up/down th∆∞·ªùng d√πng cho √¢m l∆∞·ª£ng/nhi·ªát ƒë·ªô."
                }
            },
            {
                "questionNumber": 11,
                "question": "Toxic chemicals continue to be dumped ________________ the river.",
                "answerOptions": [
                    { "text": "into", "isCorrect": true },
                    { "text": "on", "isCorrect": false },
                    { "text": "from", "isCorrect": false },
                    { "text": "over", "isCorrect": false }
                ],
                "explanation": {
                    "translate": "C√°c h√≥a ch·∫•t ƒë·ªôc h·∫°i ti·∫øp t·ª•c b·ªã ƒë·ªï v√†o s√¥ng.",
                    "analysis": "<b>A. into:</b> v√†o trong<br><b>B. on:</b> tr√™n<br><b>C. from:</b> t·ª´<br><b>D. over:</b> qua/tr√™n",
                    "reason": "T∆∞∆°ng t·ª± c√¢u 9, <b>dumped INTO</b> the river (ƒë·ªï v√†o s√¥ng).",
                    "wrong": "C√°c gi·ªõi t·ª´ kh√°c kh√¥ng di·ªÖn t·∫£ ƒë√∫ng h∆∞·ªõng di chuy·ªÉn c·ªßa ch·∫•t th·∫£i v√†o l√≤ng s√¥ng."
                }
            },
            {
                "questionNumber": 12,
                "question": "Orange juice is rich ________________ vitamin C.",
                "answerOptions": [
                    { "text": "of", "isCorrect": false },
                    { "text": "at", "isCorrect": false },
                    { "text": "in", "isCorrect": true },
                    { "text": "with", "isCorrect": false }
                ],
                "explanation": {
                    "translate": "N∆∞·ªõc cam r·∫•t gi√†u vitamin C.",
                    "analysis": "<b>A. of:</b> c·ªßa<br><b>B. at:</b> t·∫°i<br><b>C. in:</b> trong (v·ªÅ m·∫∑t n√†o ƒë√≥)<br><b>D. with:</b> v·ªõi",
                    "reason": "C·ª•m t√≠nh t·ª´: <b>be rich IN something</b> = gi√†u c√≥, d·ªìi d√†o v·ªÅ ch·∫•t g√¨ (th∆∞·ªùng d√πng cho dinh d∆∞·ª°ng, t√†i nguy√™n).",
                    "wrong": "Kh√¥ng d√πng 'rich of' (l·ªói ph·ªï bi·∫øn c·ªßa h·ªçc sinh)."
                }
            },
            {
                "questionNumber": 13,
                "question": "The pools provide a rich habitat ________________ water plants.",
                "answerOptions": [
                    { "text": "for", "isCorrect": true },
                    { "text": "of", "isCorrect": false },
                    { "text": "to", "isCorrect": false },
                    { "text": "in", "isCorrect": false }
                ],
                "explanation": {
                    "translate": "C√°c h·ªì n∆∞·ªõc cung c·∫•p m√¥i tr∆∞·ªùng s·ªëng phong ph√∫ cho c√°c lo√†i th·ª±c v·∫≠t th·ªßy sinh.",
                    "analysis": "<b>A. for:</b> cho<br><b>B. of:</b> c·ªßa<br><b>C. to:</b> t·ªõi<br><b>D. in:</b> trong",
                    "reason": "L·∫∑p l·∫°i c·∫•u tr√∫c c√¢u 4: <b>habitat FOR</b> (m√¥i tr∆∞·ªùng s·ªëng cho ƒë·ªëi t∆∞·ª£ng n√†o).",
                    "wrong": "C√°c ƒë√°p √°n kh√°c kh√¥ng ƒëi v·ªõi habitat trong ng·ªØ c·∫£nh n√†y."
                }
            },
            {
                "questionNumber": 14,
                "question": "The first Earth Day started ________________ 1970 ________________ America.",
                "answerOptions": [
                    { "text": "in / in", "isCorrect": true },
                    { "text": "on / in", "isCorrect": false },
                    { "text": "at / on", "isCorrect": false },
                    { "text": "since / in", "isCorrect": false }
                ],
                "explanation": {
                    "translate": "Ng√†y Tr√°i ƒê·∫•t ƒë·∫ßu ti√™n b·∫Øt ƒë·∫ßu v√†o nƒÉm 1970 t·∫°i M·ªπ.",
                    "analysis": "<b>A. in / in:</b> v√†o (nƒÉm) / ·ªü (n∆∞·ªõc)<br><b>B. on / in:</b> v√†o (ng√†y) / ·ªü (n∆∞·ªõc)<br><b>...</b>",
                    "reason": "Quy t·∫Øc gi·ªõi t·ª´ th·ªùi gian v√† ƒë·ªãa ƒëi·ªÉm:<br>- <b>IN + NƒÉm</b> (in 1970)<br>- <b>IN + Qu·ªëc gia/Th√†nh ph·ªë l·ªõn</b> (in America).",
                    "wrong": "On + ng√†y/th·ª©; At + gi·ªù/ƒë·ªãa ƒëi·ªÉm nh·ªè."
                }
            },
            {
                "questionNumber": 15,
                "question": "Picking ________________ litter makes our environment clean.",
                "answerOptions": [
                    { "text": "up", "isCorrect": true },
                    { "text": "on", "isCorrect": false },
                    { "text": "at", "isCorrect": false },
                    { "text": "out", "isCorrect": false }
                ],
                "explanation": {
                    "translate": "Vi·ªác nh·∫∑t r√°c gi√∫p m√¥i tr∆∞·ªùng c·ªßa ch√∫ng ta s·∫°ch s·∫Ω.",
                    "analysis": "<b>A. pick up:</b> nh·∫∑t l√™n, thu gom<br><b>B. pick on:</b> b·∫Øt n·∫°t/ch·ªçc gh·∫πo<br><b>C. pick at:</b> ƒÉn mi·ªÖn c∆∞·ª°ng<br><b>D. pick out:</b> ch·ªçn ra",
                    "reason": "C·ª•m ƒë·ªông t·ª´ <b>Pick UP</b> = nh·∫∑t l√™n/thu gom (r√°c).",
                    "wrong": "C√°c c·ª•m t·ª´ kh√°c (Phrasal verbs) mang nghƒ©a ho√†n to√†n kh√°c."
                }
            },
            {
                "questionNumber": 16,
                "question": "People are becoming more aware ________________ environmental issues.",
                "answerOptions": [
                    { "text": "of", "isCorrect": true },
                    { "text": "about", "isCorrect": false },
                    { "text": "with", "isCorrect": false },
                    { "text": "for", "isCorrect": false }
                ],
                "explanation": {
                    "translate": "M·ªçi ng∆∞·ªùi ƒëang ng√†y c√†ng nh·∫≠n th·ª©c r√µ h∆°n v·ªÅ c√°c v·∫•n ƒë·ªÅ m√¥i tr∆∞·ªùng.",
                    "analysis": "<b>A. of:</b> v·ªÅ<br><b>B. about:</b> v·ªÅ<br><b>C. with:</b> v·ªõi<br><b>D. for:</b> cho",
                    "reason": "T√≠nh t·ª´ <b>Aware</b> lu√¥n ƒëi v·ªõi gi·ªõi t·ª´ <b>OF</b> (be aware of sth = nh·∫≠n th·ª©c v·ªÅ c√°i g√¨).",
                    "wrong": "M·∫∑c d√π 'about' c≈©ng c√≥ nghƒ©a l√† 'v·ªÅ', nh∆∞ng c·∫•u tr√∫c chu·∫©n ph·∫£i l√† 'aware OF'."
                }
            },
            {
                "questionNumber": 17,
                "question": "The new road will cause a loss ________________ the beauty of the landscape.",
                "answerOptions": [
                    { "text": "of", "isCorrect": true },
                    { "text": "in", "isCorrect": false },
                    { "text": "for", "isCorrect": false },
                    { "text": "to", "isCorrect": false }
                ],
                "explanation": {
                    "translate": "Con ƒë∆∞·ªùng m·ªõi s·∫Ω g√¢y ra s·ª± m·∫•t m√°t v·∫ª ƒë·∫πp c·ªßa c·∫£nh quan.",
                    "analysis": "<b>A. of:</b> c·ªßa<br><b>B. in:</b> trong<br><b>C. for:</b> cho<br><b>D. to:</b> t·ªõi",
                    "reason": "Danh t·ª´ <b>Loss</b> ƒëi v·ªõi <b>OF</b> (A loss OF something = s·ª± m·∫•t m√°t c√°i g√¨).",
                    "wrong": "Sai gi·ªõi t·ª´ ƒëi k√®m danh t·ª´."
                }
            },
            {
                "questionNumber": 18,
                "question": "Endangered animals in the wild are facing a high risk ________________ extinction.",
                "answerOptions": [
                    { "text": "of", "isCorrect": true },
                    { "text": "with", "isCorrect": false },
                    { "text": "at", "isCorrect": false },
                    { "text": "in", "isCorrect": false }
                ],
                "explanation": {
                    "translate": "C√°c lo√†i ƒë·ªông v·∫≠t nguy c·∫•p trong t·ª± nhi√™n ƒëang ƒë·ªëi m·∫∑t v·ªõi nguy c∆° tuy·ªát ch·ªßng cao.",
                    "analysis": "<b>A. of:</b> c·ªßa<br><b>B. with:</b> v·ªõi<br><b>C. at:</b> t·∫°i<br><b>D. in:</b> trong",
                    "reason": "C·ª•m danh t·ª´: <b>Risk OF something/V-ing</b> = Nguy c∆° b·ªã l√†m sao.",
                    "wrong": "Risk with/at/in kh√¥ng d√πng trong ng·ªØ c·∫£nh ch·ªâ nguy c∆° c·ªßa m·ªôt k·∫øt qu·∫£ ti√™u c·ª±c."
                }
            },
            {
                "questionNumber": 19,
                "question": "After cleaning ________________ everything ________________ the campsite, we left.",
                "answerOptions": [
                    { "text": "up / at", "isCorrect": true },
                    { "text": "out / in", "isCorrect": false },
                    { "text": "on / on", "isCorrect": false },
                    { "text": "off / to", "isCorrect": false }
                ],
                "explanation": {
                    "translate": "Sau khi d·ªçn d·∫πp s·∫°ch s·∫Ω m·ªçi th·ª© t·∫°i khu c·∫Øm tr·∫°i, ch√∫ng t√¥i r·ªùi ƒëi.",
                    "analysis": "<b>A. up / at:</b> d·ªçn s·∫°ch / t·∫°i<br><b>B. out / in:</b> d·ªçn ra / trong<br><b>...</b>",
                    "reason": "1. <b>Clean UP</b>: d·ªçn d·∫πp s·∫°ch s·∫Ω ho√†n to√†n.<br>2. <b>AT the campsite</b>: t·∫°i ƒë·ªãa ƒëi·ªÉm c·∫Øm tr·∫°i (d√πng At cho ƒë·ªãa ƒëi·ªÉm c·ª• th·ªÉ/nh·ªè).",
                    "wrong": "Clean out th∆∞·ªùng l√† d·ªçn s·∫°ch b√™n trong c√°i g√¨ ƒë√≥ (ngƒÉn k√©o), Clean on/off kh√¥ng ph·ªï bi·∫øn. Campsite d√πng At chu·∫©n h∆°n In."
                }
            },
            {
                "questionNumber": 20,
                "question": "We shouldn't cut ________________ too many trees.",
                "answerOptions": [
                    { "text": "down", "isCorrect": true },
                    { "text": "off", "isCorrect": false },
                    { "text": "up", "isCorrect": false },
                    { "text": "away", "isCorrect": false }
                ],
                "explanation": {
                    "translate": "Ch√∫ng ta kh√¥ng n√™n ch·∫∑t h·∫° qu√° nhi·ªÅu c√¢y xanh.",
                    "analysis": "<b>A. cut down:</b> ch·∫∑t h·∫°, ƒë·ªën ng√£<br><b>B. cut off:</b> c·∫Øt l√¨a, ng·∫Øt (ƒëi·ªán/n∆∞·ªõc)<br><b>C. cut up:</b> c·∫Øt nh·ªè ra<br><b>D. cut away:</b> c·∫Øt b·ªè ph·∫ßn th·ª´a",
                    "reason": "C·ª•m ƒë·ªông t·ª´ <b>Cut DOWN</b> chuy√™n d√πng cho h√†nh ƒë·ªông ƒë·ªën h·∫° c√¢y c·ªëi.",
                    "wrong": "Cut off th∆∞·ªùng d√πng cho c·∫Øt ƒë·ª©t li√™n l·∫°c/ngu·ªìn cung c·∫•p; Cut up l√† th√°i nh·ªè."
                }
            }
        ];

        let score = 0;
        let answeredCount = 0;

        // --- AUDIO SYSTEM (No external files) ---
        const audioCtx = new (window.AudioContext || window.webkitAudioContext)();

        function playSound(type) {
            if (audioCtx.state === 'suspended') audioCtx.resume();
            const oscillator = audioCtx.createOscillator();
            const gainNode = audioCtx.createGain();
            
            oscillator.connect(gainNode);
            gainNode.connect(audioCtx.destination);

            if (type === 'correct') {
                // High pitch Ding
                oscillator.type = 'sine';
                oscillator.frequency.setValueAtTime(800, audioCtx.currentTime);
                oscillator.frequency.exponentialRampToValueAtTime(1200, audioCtx.currentTime + 0.1);
                gainNode.gain.setValueAtTime(0.3, audioCtx.currentTime);
                gainNode.gain.exponentialRampToValueAtTime(0.01, audioCtx.currentTime + 0.5);
                oscillator.start();
                oscillator.stop(audioCtx.currentTime + 0.5);
            } else if (type === 'wrong') {
                // Low pitch Buzz
                oscillator.type = 'sawtooth';
                oscillator.frequency.setValueAtTime(150, audioCtx.currentTime);
                oscillator.frequency.linearRampToValueAtTime(100, audioCtx.currentTime + 0.3);
                gainNode.gain.setValueAtTime(0.3, audioCtx.currentTime);
                gainNode.gain.exponentialRampToValueAtTime(0.01, audioCtx.currentTime + 0.3);
                oscillator.start();
                oscillator.stop(audioCtx.currentTime + 0.3);
            }
        }

        // --- RENDER LOGIC ---
        function renderQuiz() {
            const container = document.getElementById('quiz-container');
            
            quizData.forEach((item, index) => {
                const card = document.createElement('div');
                card.className = 'card p-6 md:p-8 relative';
                card.id = `question-${index}`;

                // Header of the card
                const headerHtml = `
                    <div class="flex justify-between items-center mb-6 border-b border-gray-100 pb-4">
                        <span class="bg-purple-100 text-purple-700 font-bold px-4 py-1 rounded-full text-sm">Question ${item.questionNumber}</span>
                        <i class="fa-solid fa-leaf text-green-400 text-xl"></i>
                    </div>
                `;

                // Question Text
                const questionHtml = `
                    <h3 class="question-text text-xl md:text-2xl font-bold mb-8 leading-relaxed">${item.question}</h3>
                `;

                // Options Grid
                let optionsHtml = `<div class="grid grid-cols-1 md:grid-cols-2 gap-4 mb-6">`;
                item.answerOptions.forEach((opt, optIndex) => {
                    optionsHtml += `
                        <button onclick="checkAnswer(${index}, ${optIndex}, ${opt.isCorrect})" 
                                class="option-btn w-full p-4 text-left text-lg flex items-center group" 
                                id="btn-${index}-${optIndex}">
                            <div class="w-8 h-8 rounded-full border-2 border-gray-300 flex items-center justify-center mr-3 group-hover:border-purple-400 bg-white font-bold text-gray-400 group-hover:text-purple-500 transition-colors">
                                ${String.fromCharCode(65 + optIndex)}
                            </div>
                            <span>${opt.text}</span>
                        </button>
                    `;
                });
                optionsHtml += `</div>`;

                // Explanation Box (Hidden initially)
                const explanationHtml = `
                    <div id="explain-${index}" class="explanation-box p-6 mt-4">
                        <div class="flex items-center gap-2 mb-3">
                            <i class="fa-solid fa-chalkboard-user text-purple-600 text-xl"></i>
                            <h4 class="font-bold text-purple-700">Gi·∫£i th√≠ch c·ªßa C√¥ Mai An:</h4>
                        </div>
                        
                        <div class="space-y-3 text-gray-700">
                            <!-- Translation -->
                            <div class="bg-white p-3 rounded-lg border border-gray-200 shadow-sm">
                                <span class="vocab-tag"><i class="fa-solid fa-language"></i> D·ªãch c√¢u</span>
                                <p class="italic mt-1 text-gray-800">"${item.explanation.translate}"</p>
                            </div>

                            <!-- Analysis -->
                            <div class="bg-white p-3 rounded-lg border border-gray-200 shadow-sm">
                                <span class="vocab-tag"><i class="fa-solid fa-magnifying-glass"></i> Ph√¢n t√≠ch ƒë√°p √°n</span>
                                <div class="mt-2 text-sm md:text-base pl-2 border-l-2 border-purple-200">
                                    ${item.explanation.analysis}
                                </div>
                            </div>

                            <!-- Reasoning -->
                            <div class="grid grid-cols-1 md:grid-cols-2 gap-3">
                                <div class="bg-green-50 p-3 rounded-lg border border-green-200">
                                    <span class="text-green-700 font-bold text-sm block mb-1"><i class="fa-solid fa-check-circle"></i> T·∫°i sao ƒê√öNG?</span>
                                    <p class="text-sm">${item.explanation.reason}</p>
                                </div>
                                <div class="bg-red-50 p-3 rounded-lg border border-red-200">
                                    <span class="text-red-700 font-bold text-sm block mb-1"><i class="fa-solid fa-times-circle"></i> T·∫°i sao SAI?</span>
                                    <p class="text-sm">${item.explanation.wrong}</p>
                                </div>
                            </div>
                        </div>
                    </div>
                `;

                card.innerHTML = headerHtml + questionHtml + optionsHtml + explanationHtml;
                container.appendChild(card);
            });
        }

        // --- CHECK ANSWER LOGIC ---
        function checkAnswer(questionIndex, optIndex, isCorrect) {
            const card = document.getElementById(`question-${questionIndex}`);
            // Prevent re-answering
            if (card.classList.contains('answered')) return;
            card.classList.add('answered');
            answeredCount++;

            const selectedBtn = document.getElementById(`btn-${questionIndex}-${optIndex}`);
            const explainBox = document.getElementById(`explain-${questionIndex}`);

            // Disable all buttons in this card
            const allBtns = card.querySelectorAll('.option-btn');
            allBtns.forEach(btn => {
                btn.disabled = true;
                btn.classList.add('opacity-70', 'cursor-not-allowed');
            });
            selectedBtn.classList.remove('opacity-70');

            if (isCorrect) {
                // Correct Logic
                selectedBtn.classList.add('correct');
                // Replace A/B/C/D with Checkmark
                selectedBtn.querySelector('div').innerHTML = '<i class="fa-solid fa-check text-green-600"></i>';
                selectedBtn.querySelector('div').classList.add('border-green-500');
                
                playSound('correct');
                score++;
                document.getElementById('current-score').innerText = score;
                document.getElementById('current-score').classList.add('scale-125');
                setTimeout(() => document.getElementById('current-score').classList.remove('scale-125'), 200);

                // Mini Confetti for correct answer
                confetti({
                    particleCount: 50,
                    spread: 60,
                    origin: { y: 0.7 },
                    colors: ['#00D26A', '#8854C0']
                });

            } else {
                // Wrong Logic
                selectedBtn.classList.add('wrong');
                selectedBtn.querySelector('div').innerHTML = '<i class="fa-solid fa-xmark text-red-600"></i>';
                selectedBtn.querySelector('div').classList.add('border-red-500');
                playSound('wrong');

                // Highlight the correct one
                const correctOptionIndex = quizData[questionIndex].answerOptions.findIndex(o => o.isCorrect);
                const correctBtn = document.getElementById(`btn-${questionIndex}-${correctOptionIndex}`);
                correctBtn.classList.add('correct', 'ring-2', 'ring-green-400', 'ring-offset-2');
                correctBtn.classList.remove('opacity-70');
            }

            // Show Explanation immediately
            explainBox.classList.add('visible');
            
            // Auto scroll slightly if needed
            explainBox.scrollIntoView({ behavior: 'smooth', block: 'nearest' });
        }

        // --- SUBMIT & RESULTS ---
        function submitQuiz() {
            if (answeredCount < quizData.length) {
                const confirmSubmit = confirm(`B·∫°n m·ªõi l√†m ${answeredCount}/${quizData.length} c√¢u. B·∫°n c√≥ ch·∫Øc mu·ªën n·ªôp b√†i kh√¥ng?`);
                if (!confirmSubmit) return;
            }

            const modal = document.getElementById('result-modal');
            const scoreDisplay = document.getElementById('final-score');
            const message = document.getElementById('modal-message');

            scoreDisplay.innerText = `${score} / ${quizData.length}`;
            
            // Percentage
            const percentage = (score / quizData.length) * 100;
            
            if (percentage === 100) {
                message.innerText = "Tuy·ªát v·ªùi! B·∫°n l√† thi√™n t√†i ng·ªØ ph√°p! üåü";
                confetti({ particleCount: 200, spread: 100, origin: { y: 0.6 } });
                playSound('correct');
            } else if (percentage >= 80) {
                message.innerText = "Gi·ªèi l·∫Øm! Ch·ªâ sai m·ªôt ch√∫t x√≠u th√¥i! üí™";
                confetti({ particleCount: 100, spread: 70, origin: { y: 0.6 } });
                playSound('correct');
            } else if (percentage >= 50) {
                message.innerText = "Kh√° t·ªët! H√£y xem l·∫°i ph·∫ßn gi·∫£i th√≠ch ƒë·ªÉ hi·ªÉu r√µ h∆°n nh√©! üìö";
                playSound('correct');
            } else {
                message.innerText = "ƒê·ª´ng bu·ªìn! H√£y √¥n l·∫°i b√†i v√† th·ª≠ l·∫°i nh√©! üî•";
                playSound('wrong');
            }

            modal.classList.remove('hidden');
        }

        function closeModal() {
            document.getElementById('result-modal').classList.add('hidden');
        }

        // Initialize
        renderQuiz();

    </script>
</body>
</html>
