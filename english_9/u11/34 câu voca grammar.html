<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>English Practice - Ms Mai An ULIS</title>
    <link href="https://fonts.googleapis.com/css2?family=Nunito:wght@400;600;700;800&family=Quicksand:wght@500;700&display=swap" rel="stylesheet">
    <style>
        :root {
            --primary: #8854C0; /* Purple */
            --secondary: #00C9A7; /* Teal */
            --success: #00D26A; /* Green */
            --error: #FF4757; /* Red */
            --background: #f0f3f8;
            --card-bg: #ffffff;
            --text-main: #2c3e50;
            --text-light: #7f8c8d;
        }

        * {
            box-sizing: border-box;
            user-select: none; /* Prevent text selection for game feel */
        }

        body {
            font-family: 'Nunito', sans-serif;
            background-color: var(--background);
            background-image: radial-gradient(#e1e8f0 15%, transparent 16%), radial-gradient(#e1e8f0 15%, transparent 16%);
            background-size: 60px 60px;
            background-position: 0 0, 30px 30px;
            margin: 0;
            padding: 20px;
            min-height: 100vh;
            display: flex;
            justify-content: center;
            align-items: flex-start;
        }

        .container {
            width: 100%;
            max-width: 800px;
            background: transparent;
            position: relative;
        }

        /* Header */
        .header {
            text-align: center;
            margin-bottom: 30px;
            background: #fff;
            padding: 15px;
            border-radius: 20px;
            box-shadow: 0 8px 0 rgba(0,0,0,0.05);
            border: 2px solid #eee;
        }

        .header h1 {
            color: var(--primary);
            font-family: 'Quicksand', sans-serif;
            font-weight: 800;
            margin: 0;
            font-size: 1.5rem;
            text-transform: uppercase;
            letter-spacing: 1px;
        }

        .header p {
            margin: 5px 0 0;
            color: var(--text-light);
            font-size: 0.9rem;
        }

        /* Progress Bar */
        .progress-container {
            background: #e0e0e0;
            border-radius: 50px;
            height: 20px;
            width: 100%;
            margin-bottom: 20px;
            overflow: hidden;
            position: relative;
            box-shadow: inset 0 2px 4px rgba(0,0,0,0.1);
        }

        .progress-bar {
            background: linear-gradient(90deg, var(--secondary), #48dbfb);
            height: 100%;
            width: 0%;
            border-radius: 50px;
            transition: width 0.5s ease;
        }

        .score-badge {
            position: absolute;
            right: 0;
            top: -35px;
            background: #ff9f43;
            color: white;
            padding: 5px 15px;
            border-radius: 20px;
            font-weight: bold;
            box-shadow: 0 4px 0 #e67e22;
        }

        /* Quiz Card */
        .quiz-card {
            background: var(--card-bg);
            border-radius: 25px;
            padding: 30px;
            box-shadow: 0 10px 0 rgba(0,0,0,0.05), 0 20px 25px rgba(0,0,0,0.1);
            margin-bottom: 30px;
            transition: transform 0.3s;
            position: relative;
            overflow: hidden;
            border: 3px solid #f1f2f6;
        }

        .question-text {
            font-size: 1.3rem;
            color: var(--text-main);
            font-weight: 700;
            line-height: 1.5;
            margin-bottom: 25px;
            text-align: left;
        }

        /* Options Grid */
        .options-grid {
            display: grid;
            grid-template-columns: 1fr;
            gap: 15px;
        }

        @media (min-width: 600px) {
            .options-grid {
                grid-template-columns: 1fr 1fr;
            }
        }

        .option-btn {
            background: #fff;
            border: 2px solid #e1e1e1;
            border-radius: 15px;
            padding: 15px 20px;
            font-family: 'Nunito', sans-serif;
            font-size: 1.1rem;
            font-weight: 600;
            color: var(--text-main);
            cursor: pointer;
            transition: all 0.2s cubic-bezier(0.25, 0.8, 0.25, 1);
            box-shadow: 0 4px 0 #e1e1e1;
            text-align: left;
            position: relative;
            display: flex;
            align-items: center;
        }

        .option-btn:hover:not(:disabled) {
            transform: translateY(-2px);
            border-color: var(--primary);
            color: var(--primary);
            box-shadow: 0 6px 0 #d1d1d1;
        }

        .option-btn:active:not(:disabled) {
            transform: translateY(2px);
            box-shadow: 0 0 0 #d1d1d1;
        }

        .option-btn:disabled {
            cursor: default;
            opacity: 0.9;
        }

        /* Option States */
        .option-btn.correct {
            background: var(--success);
            color: white;
            border-color: #00b85c;
            box-shadow: 0 4px 0 #00b85c;
        }

        .option-btn.wrong {
            background: var(--error);
            color: white;
            border-color: #e63e4d;
            box-shadow: 0 4px 0 #e63e4d;
        }

        /* Marker (A, B, C, D) */
        .option-marker {
            display: inline-flex;
            justify-content: center;
            align-items: center;
            width: 30px;
            height: 30px;
            background: rgba(0,0,0,0.05);
            border-radius: 8px;
            margin-right: 15px;
            font-size: 0.9rem;
            font-weight: 800;
            color: #7f8c8d;
        }

        .option-btn.correct .option-marker,
        .option-btn.wrong .option-marker {
            background: rgba(255,255,255,0.3);
            color: white;
        }

        /* Explanation Box */
        .explanation-box {
            margin-top: 25px;
            background: #f8f9fa;
            border: 2px solid #e9ecef;
            border-radius: 15px;
            padding: 20px;
            display: none; /* Hidden initially */
            animation: slideUp 0.4s ease-out;
        }

        .explanation-box.show {
            display: block;
        }

        .exp-header {
            display: flex;
            align-items: center;
            gap: 10px;
            margin-bottom: 15px;
            padding-bottom: 10px;
            border-bottom: 2px dashed #e9ecef;
        }

        .exp-badge {
            background: var(--primary);
            color: white;
            padding: 5px 12px;
            border-radius: 20px;
            font-size: 0.8rem;
            font-weight: 800;
            text-transform: uppercase;
        }

        .exp-content {
            font-size: 1rem;
            line-height: 1.6;
            color: var(--text-main);
            white-space: pre-line; /* Respect new lines */
        }
        
        .exp-content strong {
            color: var(--primary);
        }

        /* Navigation Buttons */
        .nav-controls {
            display: flex;
            justify-content: space-between;
            margin-top: 20px;
        }

        .next-btn {
            background: var(--primary);
            color: white;
            border: none;
            padding: 15px 30px;
            font-size: 1.1rem;
            font-weight: bold;
            border-radius: 15px;
            cursor: pointer;
            box-shadow: 0 5px 0 #6c4299;
            transition: all 0.2s;
            display: none; /* Hidden until answered */
            margin-left: auto;
        }

        .next-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 7px 0 #6c4299;
        }
        
        .next-btn:active {
            transform: translateY(2px);
            box-shadow: 0 0 0 #6c4299;
        }

        /* Result Modal */
        .modal {
            display: none;
            position: fixed;
            z-index: 1000;
            left: 0;
            top: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0,0,0,0.6);
            backdrop-filter: blur(5px);
            align-items: center;
            justify-content: center;
        }

        .modal-content {
            background-color: #fff;
            padding: 40px;
            border-radius: 30px;
            text-align: center;
            max-width: 500px;
            width: 90%;
            box-shadow: 0 20px 40px rgba(0,0,0,0.2);
            border: 4px solid var(--secondary);
            animation: popIn 0.5s cubic-bezier(0.68, -0.55, 0.265, 1.55);
        }

        .result-score {
            font-size: 4rem;
            font-weight: 800;
            color: var(--primary);
            margin: 20px 0;
        }
        
        .result-msg {
            font-size: 1.5rem;
            margin-bottom: 30px;
            color: var(--text-main);
        }

        .restart-btn {
            background: var(--secondary);
            color: white;
            border: none;
            padding: 15px 40px;
            font-size: 1.2rem;
            font-weight: bold;
            border-radius: 50px;
            cursor: pointer;
            box-shadow: 0 6px 0 #009e82;
            transition: transform 0.2s;
        }

        .restart-btn:hover {
            transform: scale(1.05);
        }

        /* Animations */
        @keyframes slideUp {
            from { opacity: 0; transform: translateY(20px); }
            to { opacity: 1; transform: translateY(0); }
        }

        @keyframes shake {
            0% { transform: translateX(0); }
            25% { transform: translateX(-8px) rotate(-2deg); }
            50% { transform: translateX(8px) rotate(2deg); }
            75% { transform: translateX(-8px) rotate(-2deg); }
            100% { transform: translateX(0); }
        }
        
        @keyframes popIn {
            0% { transform: scale(0.5); opacity: 0; }
            100% { transform: scale(1); opacity: 1; }
        }

        .shake {
            animation: shake 0.4s cubic-bezier(.36,.07,.19,.97) both;
        }

        /* Responsive */
        @media (max-width: 600px) {
            .question-text { font-size: 1.1rem; }
            .quiz-card { padding: 20px; }
            .option-btn { font-size: 1rem; padding: 12px; }
        }

        /* Canvas for confetti */
        #confetti-canvas {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            pointer-events: none;
            z-index: 999;
        }
    </style>
</head>
<body>

<canvas id="confetti-canvas"></canvas>

<div class="container">
    <div class="header">
        <h1>Ms Mai An ULIS</h1>
        <p>English Practice: Verb Forms, Vocab & Word Formation</p>
    </div>

    <div class="progress-container">
        <div class="progress-bar" id="progressBar"></div>
        <div class="score-badge">Score: <span id="currentScore">0</span></div>
    </div>

    <div class="quiz-card" id="quizCard">
        <div id="questionContainer">
            <!-- Question content goes here -->
        </div>

        <div class="explanation-box" id="explanationBox">
            <div class="exp-header">
                <span class="exp-badge">Giải Thích Chi Tiết</span>
                <span style="font-size: 0.9rem; color: #7f8c8d;">(Giáo viên: Ms Mai An)</span>
            </div>
            <div class="exp-content" id="explanationText">
                <!-- Explanation text goes here -->
            </div>
        </div>

        <div class="nav-controls">
            <button class="next-btn" id="nextBtn" onclick="nextQuestion()">Next Question ➜</button>
        </div>
    </div>
</div>

<div class="modal" id="resultModal">
    <div class="modal-content">
        <h2>Kết Quả Của Bạn</h2>
        <div class="result-score" id="finalScore">0/0</div>
        <p class="result-msg" id="finalMsg">Well done!</p>
        <button class="restart-btn" onclick="location.reload()">Làm Lại</button>
    </div>
</div>

<script>
    // --- Audio System (Web Audio API) ---
    // Tạo âm thanh trực tiếp để đảm bảo không bị lỗi link
    const audioCtx = new (window.AudioContext || window.webkitAudioContext)();

    function playSound(type) {
        if (audioCtx.state === 'suspended') {
            audioCtx.resume();
        }
        
        const oscillator = audioCtx.createOscillator();
        const gainNode = audioCtx.createGain();
        
        oscillator.connect(gainNode);
        gainNode.connect(audioCtx.destination);
        
        if (type === 'correct') {
            // Ding sound (High pitch sine wave fade out)
            oscillator.type = 'sine';
            oscillator.frequency.setValueAtTime(600, audioCtx.currentTime);
            oscillator.frequency.exponentialRampToValueAtTime(1000, audioCtx.currentTime + 0.1);
            gainNode.gain.setValueAtTime(0.3, audioCtx.currentTime);
            gainNode.gain.exponentialRampToValueAtTime(0.01, audioCtx.currentTime + 0.5);
            oscillator.start();
            oscillator.stop(audioCtx.currentTime + 0.5);
        } else if (type === 'wrong') {
            // Buzz sound (Low pitch sawtooth fade out)
            oscillator.type = 'sawtooth';
            oscillator.frequency.setValueAtTime(150, audioCtx.currentTime);
            oscillator.frequency.linearRampToValueAtTime(100, audioCtx.currentTime + 0.3);
            gainNode.gain.setValueAtTime(0.3, audioCtx.currentTime);
            gainNode.gain.exponentialRampToValueAtTime(0.01, audioCtx.currentTime + 0.3);
            oscillator.start();
            oscillator.stop(audioCtx.currentTime + 0.3);
        } else if (type === 'finish') {
            // Tada sound sequence
            const now = audioCtx.currentTime;
            [523.25, 659.25, 783.99, 1046.50].forEach((freq, i) => {
                const osc = audioCtx.createOscillator();
                const gain = audioCtx.createGain();
                osc.connect(gain);
                gain.connect(audioCtx.destination);
                osc.type = 'triangle';
                osc.frequency.value = freq;
                gain.gain.setValueAtTime(0.2, now + i*0.1);
                gain.gain.exponentialRampToValueAtTime(0.01, now + i*0.1 + 0.5);
                osc.start(now + i*0.1);
                osc.stop(now + i*0.1 + 0.5);
            });
        }
    }

    // --- Data ---
    const quizData = {
  "questions": [
    {
      "questionNumber": 1,
      "question": "Exercise 2: My dentist advised that I __________ my teeth twice a day for good oral hygiene.",
      "answerOptions": [
        { "text": "brush", "isCorrect": true },
        { "text": "brushed", "isCorrect": false },
        { "text": "to brush", "isCorrect": false },
        { "text": "brushing", "isCorrect": false }
      ],
      "rationale": "1. Phân tích: \n- brush (V_bare)\n- brushed (V-ed)\n- to brush (to V)\n- brushing (V-ing)\n\n2. Dịch nghĩa: \"Nha sĩ của tôi khuyên rằng tôi nên đánh răng hai lần một ngày để vệ sinh răng miệng tốt.\"\n\n3. Giải thích: Cấu trúc giả định cách: Advise + that + S + (should) + V_bare (nguyên thể)."
    },
    {
      "questionNumber": 2,
      "question": "Ms Hong suggested that Tam should __________ at home to recover from her illness.",
      "answerOptions": [
        { "text": "resting", "isCorrect": false },
        { "text": "rest", "isCorrect": true },
        { "text": "to rest", "isCorrect": false },
        { "text": "rests", "isCorrect": false }
      ],
      "rationale": "1. Phân tích:\n- resting (V-ing)\n- rest (V_bare)\n- to rest (to V)\n- rests (V-s)\n\n2. Dịch nghĩa: \"Cô Hồng gợi ý rằng Tâm nên nghỉ ngơi ở nhà để hồi phục sau cơn bệnh.\"\n\n3. Giải thích: Should + V_bare (rest)."
    },
    {
      "questionNumber": 3,
      "question": "The nutritionist recommended __________ more fruits and vegetables to have a balanced diet.",
      "answerOptions": [
        { "text": "eat", "isCorrect": false },
        { "text": "to eat", "isCorrect": false },
        { "text": "eating", "isCorrect": true },
        { "text": "ate", "isCorrect": false }
      ],
      "rationale": "1. Phân tích:\n- eat (V_bare)\n- to eat (to V)\n- eating (V-ing)\n- ate (V-ed)\n\n2. Dịch nghĩa: \"Chuyên gia dinh dưỡng khuyên nên ăn nhiều trái cây và rau quả hơn để có chế độ ăn uống cân bằng.\"\n\n3. Giải thích: Recommend + V-ing (khi không có tân ngữ chỉ người)."
    },
    {
      "questionNumber": 4,
      "question": "My brother avoids __________ up late because it makes him feel tired in the morning.",
      "answerOptions": [
        { "text": "stay", "isCorrect": false },
        { "text": "to stay", "isCorrect": false },
        { "text": "staying", "isCorrect": true },
        { "text": "stayed", "isCorrect": false }
      ],
      "rationale": "1. Phân tích:\n- stay (V_bare)\n- to stay (to V)\n- staying (V-ing)\n- stayed (V-ed)\n\n2. Dịch nghĩa: \"Anh trai tôi tránh thức khuya vì điều đó khiến anh ấy cảm thấy mệt mỏi vào buổi sáng.\"\n\n3. Giải thích: Cấu trúc Avoid + V-ing (tránh làm gì)."
    },
    {
      "questionNumber": 5,
      "question": "We agree __________ to the cinema on Friday night because there's a new movie out.",
      "answerOptions": [
        { "text": "going", "isCorrect": false },
        { "text": "to go", "isCorrect": true },
        { "text": "go", "isCorrect": false },
        { "text": "went", "isCorrect": false }
      ],
      "rationale": "1. Phân tích:\n- going (V-ing)\n- to go (to V)\n- go (V_bare)\n- went (V-ed)\n\n2. Dịch nghĩa: \"Chúng tôi đồng ý đi xem phim vào tối thứ Sáu vì có một bộ phim mới ra mắt.\"\n\n3. Giải thích: Cấu trúc Agree + to V (đồng ý làm gì)."
    },
    {
      "questionNumber": 6,
      "question": "The lifeguard advised __________ alone in deep water to avoid accidents.",
      "answerOptions": [
        { "text": "not swim", "isCorrect": false },
        { "text": "not swimming", "isCorrect": false },
        { "text": "not to swim", "isCorrect": true },
        { "text": "don't swim", "isCorrect": false }
      ],
      "rationale": "1. Phân tích:\n- not swim (not + V_bare)\n- not swimming (not + V-ing)\n- not to swim (not + to V)\n- don't swim (don't + V)\n\n2. Dịch nghĩa: \"Nhân viên cứu hộ khuyên không nên bơi một mình ở vùng nước sâu để tránh tai nạn.\"\n\n3. Giải thích: Dạng phủ định của 'Advise + to V' là 'Advise + not to V'. (Ở đây hiểu ngầm là advise [people] not to swim)."
    },
    {
      "questionNumber": 7,
      "question": "They promise __________ their phones during family dinners to have quality time together.",
      "answerOptions": [
        { "text": "not to use", "isCorrect": true },
        { "text": "not using", "isCorrect": false },
        { "text": "not use", "isCorrect": false },
        { "text": "don't use", "isCorrect": false }
      ],
      "rationale": "1. Phân tích:\n- not to use (not + to V)\n- not using (not + V-ing)\n- not use (not + V_bare)\n- don't use (don't + V)\n\n2. Dịch nghĩa: \"Họ hứa sẽ không sử dụng điện thoại trong bữa tối gia đình để có thời gian chất lượng bên nhau.\"\n\n3. Giải thích: Cấu trúc Promise + (not) to V."
    },
    {
      "questionNumber": 8,
      "question": "Phuong recommended that Kien __________ sunscreen to protect his skin.",
      "answerOptions": [
        { "text": "wearing", "isCorrect": false },
        { "text": "wear", "isCorrect": true },
        { "text": "wears", "isCorrect": false },
        { "text": "to wear", "isCorrect": false }
      ],
      "rationale": "1. Phân tích:\n- wearing (V-ing)\n- wear (V_bare)\n- wears (V-s)\n- to wear (to V)\n\n2. Dịch nghĩa: \"Phương khuyên Kiên nên bôi kem chống nắng để bảo vệ da.\"\n\n3. Giải thích: Cấu trúc giả định cách: Recommend + that + S + (should) + V_bare. \"Kien wear\" (nguyên thể) là đúng."
    },
    {
      "questionNumber": 9,
      "question": "I suggest __________ off your electronic devices before going to bed.",
      "answerOptions": [
        { "text": "turning", "isCorrect": true },
        { "text": "turn", "isCorrect": false },
        { "text": "to turn", "isCorrect": false },
        { "text": "turned", "isCorrect": false }
      ],
      "rationale": "1. Phân tích:\n- turning (V-ing)\n- turn (V_bare)\n- to turn (to V)\n- turned (V-ed)\n\n2. Dịch nghĩa: \"Tôi gợi ý tắt các thiết bị điện tử của bạn trước khi đi ngủ.\"\n\n3. Giải thích: Suggest + V-ing."
    },
    {
      "questionNumber": 10,
      "question": "The technician suggested that he regularly __________ the dust from his computer's keyboard.",
      "answerOptions": [
        { "text": "clean", "isCorrect": true },
        { "text": "cleans", "isCorrect": false },
        { "text": "cleaning", "isCorrect": false },
        { "text": "to clean", "isCorrect": false }
      ],
      "rationale": "1. Phân tích:\n- clean (V_bare)\n- cleans (V-s)\n- cleaning (V-ing)\n- to clean (to V)\n\n2. Dịch nghĩa: \"Kỹ thuật viên gợi ý rằng anh ấy nên thường xuyên làm sạch bụi bẩn trên bàn phím máy tính.\"\n\n3. Giải thích: Cấu trúc giả định: Suggest + that + S + (should) + V_bare. Chọn \"clean\" (nguyên thể) thay vì \"cleans\"."
    },
    {
      "questionNumber": 11,
      "question": "The technician advised __________ the router to troubleshoot the issue.",
      "answerOptions": [
        { "text": "restarting", "isCorrect": true },
        { "text": "to restart", "isCorrect": false },
        { "text": "restart", "isCorrect": false },
        { "text": "restarted", "isCorrect": false }
      ],
      "rationale": "1. Phân tích:\n- restarting (V-ing)\n- to restart (to V)\n- restart (V_bare)\n- restarted (V-ed)\n\n2. Dịch nghĩa: \"Kỹ thuật viên khuyên nên khởi động lại bộ định tuyến để khắc phục sự cố.\"\n\n3. Giải thích: Advise + V-ing (khi không có tân ngữ chỉ người đi kèm)."
    },
    {
      "questionNumber": 12,
      "question": "I recommend that she __________ a screen protector on her smartphone.",
      "answerOptions": [
        { "text": "use", "isCorrect": true },
        { "text": "uses", "isCorrect": false },
        { "text": "using", "isCorrect": false },
        { "text": "to use", "isCorrect": false }
      ],
      "rationale": "1. Phân tích:\n- use (V_bare)\n- uses (V-s)\n- using (V-ing)\n- to use (to V)\n\n2. Dịch nghĩa: \"Tôi khuyên cô ấy nên sử dụng miếng dán bảo vệ màn hình trên điện thoại thông minh của mình.\"\n\n3. Giải thích: Subjunctive Mood: Recommend + that + S + V_bare. Chọn \"use\" (nguyên thể)."
    },
    {
      "questionNumber": 13,
      "question": "I would advise them __________ in a good antivirus software to protect their computers.",
      "answerOptions": [
        { "text": "to invest", "isCorrect": true },
        { "text": "invest", "isCorrect": false },
        { "text": "investing", "isCorrect": false },
        { "text": "invested", "isCorrect": false }
      ],
      "rationale": "1. Phân tích:\n- to invest (to V)\n- invest (V_bare)\n- investing (V-ing)\n- invested (V-ed)\n\n2. Dịch nghĩa: \"Tôi khuyên họ nên đầu tư vào một phần mềm diệt virus tốt để bảo vệ máy tính của họ.\"\n\n3. Giải thích: Cấu trúc Advise + Object + to V (Khuyên ai làm gì). Đáp án đúng theo ngữ pháp chuẩn là \"to invest\"."
    },
    {
      "questionNumber": 14,
      "question": "If you live in an apartment, I suggest __________ smart lighting.",
      "answerOptions": [
        { "text": "installing", "isCorrect": true },
        { "text": "to install", "isCorrect": false },
        { "text": "install", "isCorrect": false },
        { "text": "installed", "isCorrect": false }
      ],
      "rationale": "1. Phân tích:\n- installing (V-ing)\n- to install (to V)\n- install (V_bare)\n- installed (V-ed)\n\n2. Dịch nghĩa: \"Nếu bạn sống trong một căn hộ, tôi gợi ý lắp đặt hệ thống chiếu sáng thông minh.\"\n\n3. Giải thích: Suggest + V-ing."
    },
    {
      "questionNumber": 15,
      "question": "Jack advised that we __________ early to avoid traffic jam.",
      "answerOptions": [
        { "text": "should leave", "isCorrect": true },
        { "text": "leaving", "isCorrect": false },
        { "text": "to leave", "isCorrect": false },
        { "text": "left", "isCorrect": false }
      ],
      "rationale": "1. Phân tích:\n- should leave (should + V)\n- leaving (V-ing)\n- to leave (to V)\n- left (V-ed)\n\n2. Dịch nghĩa: \"Jack khuyên rằng chúng tôi nên đi sớm để tránh tắc đường.\"\n\n3. Giải thích: Cấu trúc giả định: Advise + that + S + should + V."
    },
    {
      "questionNumber": 16,
      "question": "Exercise 3: This new version of ___________________ produces precise three-dimensional objects.",
      "answerOptions": [
        { "text": "3D printer", "isCorrect": true },
        { "text": "e-reader", "isCorrect": false },
        { "text": "touchscreen", "isCorrect": false },
        { "text": "cardboard", "isCorrect": false }
      ],
      "rationale": "1. Phân tích:\n- 3D printer (n): máy in 3D.\n- e-reader (n): máy đọc sách.\n- touchscreen (n): màn hình cảm ứng.\n- cardboard (n): bìa cứng.\n\n2. Dịch nghĩa: \"Phiên bản máy in 3D mới này tạo ra các vật thể ba chiều chính xác.\"\n\n3. Giải thích: Từ khóa \"three-dimensional objects\" (vật thể 3 chiều) chỉ có thể được tạo ra bởi máy in 3D."
    },
    {
      "questionNumber": 17,
      "question": "I like the tablet because it is ___________________. I can carry it wherever I go.",
      "answerOptions": [
        { "text": "portable", "isCorrect": true },
        { "text": "plastic", "isCorrect": false },
        { "text": "copper", "isCorrect": false },
        { "text": "cardboard", "isCorrect": false }
      ],
      "rationale": "1. Phân tích:\n- portable (adj): di động/dễ mang theo.\n- plastic (n/adj): nhựa.\n- copper (n): đồng.\n- cardboard (n): bìa cứng.\n\n2. Dịch nghĩa: \"Tôi thích máy tính bảng vì nó di động. Tôi có thể mang nó đi bất cứ đâu tôi đến.\"\n\n3. Giải thích: Từ khóa \"carry it wherever I go\" (mang đi bất cứ đâu) giải thích cho tính từ \"portable\"."
    },
    {
      "questionNumber": 18,
      "question": "The ___________________ on a smart fridge can display available food in the fridge and cooking recipes.",
      "answerOptions": [
        { "text": "touchscreen", "isCorrect": true },
        { "text": "copper", "isCorrect": false },
        { "text": "plastic", "isCorrect": false },
        { "text": "portable", "isCorrect": false }
      ],
      "rationale": "1. Phân tích:\n- touchscreen (n): màn hình cảm ứng.\n- copper (n): đồng.\n- plastic (n): nhựa.\n- portable (adj): di động.\n\n2. Dịch nghĩa: \"Màn hình cảm ứng trên tủ lạnh thông minh có thể hiển thị thực phẩm có sẵn và công thức nấu ăn.\"\n\n3. Giải thích: Bộ phận có khả năng \"display\" (hiển thị) thông tin là \"touchscreen\"."
    },
    {
      "questionNumber": 19,
      "question": "Mary created an eco-friendly sculpture using ___________________ from carton boxes.",
      "answerOptions": [
        { "text": "cardboard", "isCorrect": true },
        { "text": "plastic", "isCorrect": false },
        { "text": "copper", "isCorrect": false },
        { "text": "e-reader", "isCorrect": false }
      ],
      "rationale": "1. Phân tích:\n- cardboard (n): bìa cứng.\n- plastic (n): nhựa.\n- copper (n): đồng.\n- e-reader (n): máy đọc sách.\n\n2. Dịch nghĩa: \"Mary đã tạo ra một tác phẩm điêu khắc thân thiện với môi trường bằng bìa cứng từ các hộp carton.\"\n\n3. Giải thích: \"Carton boxes\" được làm từ \"cardboard\"."
    },
    {
      "questionNumber": 20,
      "question": "People use ___________________ to make jewellery because of its durability and unique reddish-brown colour.",
      "answerOptions": [
        { "text": "copper", "isCorrect": true },
        { "text": "plastic", "isCorrect": false },
        { "text": "cardboard", "isCorrect": false },
        { "text": "portable", "isCorrect": false }
      ],
      "rationale": "1. Phân tích:\n- copper (n): đồng (đỏ).\n- plastic (n): nhựa.\n- cardboard (n): bìa cứng.\n- portable (adj): di động.\n\n2. Dịch nghĩa: \"Mọi người sử dụng đồng để làm đồ trang sức vì độ bền và màu nâu đỏ độc đáo của nó.\"\n\n3. Giải thích: \"Reddish-brown colour\" (màu nâu đỏ) là đặc điểm nhận dạng của đồng (copper)."
    },
    {
      "questionNumber": 21,
      "question": "___________________ is an ideal material for creating lightweight products.",
      "answerOptions": [
        { "text": "Plastic", "isCorrect": true },
        { "text": "Copper", "isCorrect": false },
        { "text": "Touchscreen", "isCorrect": false },
        { "text": "E-reader", "isCorrect": false }
      ],
      "rationale": "1. Phân tích:\n- Plastic (n): nhựa.\n- Copper (n): đồng.\n- Touchscreen (n): màn hình cảm ứng.\n- E-reader (n): máy đọc sách.\n\n2. Dịch nghĩa: \"Nhựa là một vật liệu lý tưởng để tạo ra các sản phẩm nhẹ.\"\n\n3. Giải thích: \"Lightweight\" (nhẹ) là đặc tính nổi bật của nhựa so với kim loại hay gỗ."
    },
    {
      "questionNumber": 22,
      "question": "I enjoy reading novels on a(n) ___________________ on the bus ride to my office.",
      "answerOptions": [
        { "text": "e-reader", "isCorrect": true },
        { "text": "3D printer", "isCorrect": false },
        { "text": "copper", "isCorrect": false },
        { "text": "portable", "isCorrect": false }
      ],
      "rationale": "1. Phân tích:\n- e-reader (n): máy đọc sách.\n- 3D printer (n): máy in 3D.\n- copper (n): đồng.\n- portable (adj): di động.\n\n2. Dịch nghĩa: \"Tôi thích đọc tiểu thuyết trên máy đọc sách trên chuyến xe buýt đến văn phòng.\"\n\n3. Giải thích: Thiết bị dùng để \"reading novels\" (đọc tiểu thuyết) là e-reader."
    },
    {
      "questionNumber": 23,
      "question": "Exercise 6: Digital technology can never be the teacher of the future but it will be the teacher’s ___________________. (assist)",
      "answerOptions": [
        { "text": "assistant", "isCorrect": true },
        { "text": "assistance", "isCorrect": false },
        { "text": "assist", "isCorrect": false },
        { "text": "assisted", "isCorrect": false }
      ],
      "rationale": "1. Phân tích:\n- assistant (n): trợ lý/người hỗ trợ.\n- assistance (n): sự hỗ trợ.\n- assist (v): hỗ trợ.\n- assisted (v-ed): đã hỗ trợ.\n\n2. Dịch nghĩa: \"Công nghệ kỹ thuật số không bao giờ có thể là giáo viên của tương lai nhưng nó sẽ là trợ lý của giáo viên.\"\n\n3. Giải thích: Sau sở hữu cách \"teacher's\" cần một danh từ chỉ người hoặc vật đóng vai trò hỗ trợ, tương xứng với danh từ \"teacher\" ở vế trước. \"Assistant\" (trợ lý) hợp nghĩa hơn \"assistance\" (sự giúp đỡ)."
    },
    {
      "questionNumber": 24,
      "question": "Smart vacuum cleaners can be controlled ___________________ via smartphone apps. (remote)",
      "answerOptions": [
        { "text": "remotely", "isCorrect": true },
        { "text": "remote", "isCorrect": false },
        { "text": "remoteness", "isCorrect": false },
        { "text": "remoted", "isCorrect": false }
      ],
      "rationale": "1. Phân tích:\n- remotely (adv): từ xa.\n- remote (adj): xa xôi.\n- remoteness (n): sự xa xôi.\n- remoted (v): làm cho xa.\n\n2. Dịch nghĩa: \"Máy hút bụi thông minh có thể được điều khiển từ xa thông qua ứng dụng điện thoại thông minh.\"\n\n3. Giải thích: Cần một trạng từ (adv) để bổ nghĩa cho động từ \"controlled\"."
    },
    {
      "questionNumber": 25,
      "question": "My smartphone has a ___________________ mode feature that ensures my personal data remains secure. (privacy)",
      "answerOptions": [
        { "text": "privacy", "isCorrect": true },
        { "text": "private", "isCorrect": false },
        { "text": "privately", "isCorrect": false },
        { "text": "privatize", "isCorrect": false }
      ],
      "rationale": "1. Phân tích:\n- privacy (n): sự riêng tư.\n- private (adj): riêng tư.\n- privately (adv): một cách riêng tư.\n- privatize (v): tư nhân hóa.\n\n2. Dịch nghĩa: \"Điện thoại thông minh của tôi có tính năng chế độ riêng tư đảm bảo dữ liệu cá nhân của tôi vẫn an toàn.\"\n\n3. Giải thích: Cụm danh từ ghép \"privacy mode\" (chế độ riêng tư) rất phổ biến trong công nghệ. Cũng có thể dùng \"private mode\" nhưng \"privacy\" là từ gốc được cho và thường dùng làm danh từ bổ nghĩa (noun adjunct)."
    },
    {
      "questionNumber": 26,
      "question": "When my old phone broke, I looked for a ___________________ with better camera features. (replace)",
      "answerOptions": [
        { "text": "replacement", "isCorrect": true },
        { "text": "replaceable", "isCorrect": false },
        { "text": "replace", "isCorrect": false },
        { "text": "placed", "isCorrect": false }
      ],
      "rationale": "1. Phân tích:\n- replacement (n): sự thay thế/vật thay thế.\n- replaceable (adj): có thể thay thế.\n- replace (v): thay thế.\n- placed (v): đã đặt.\n\n2. Dịch nghĩa: \"Khi điện thoại cũ của tôi bị hỏng, tôi đã tìm kiếm một cái thay thế với tính năng camera tốt hơn.\"\n\n3. Giải thích: Sau mạo từ \"a\" cần một danh từ."
    },
    {
      "questionNumber": 27,
      "question": "Voice commands allow users to ___________________ with their smart home devices. (interactive)",
      "answerOptions": [
        { "text": "interact", "isCorrect": true },
        { "text": "interaction", "isCorrect": false },
        { "text": "interactive", "isCorrect": false },
        { "text": "interactively", "isCorrect": false }
      ],
      "rationale": "1. Phân tích:\n- interact (v): tương tác.\n- interaction (n): sự tương tác.\n- interactive (adj): có tính tương tác.\n- interactively (adv): một cách tương tác.\n\n2. Dịch nghĩa: \"Ra lệnh bằng giọng nói cho phép người dùng tương tác với các thiết bị nhà thông minh của họ.\"\n\n3. Giải thích: Sau \"allow users to\" cần một động từ nguyên thể."
    },
    {
      "questionNumber": 28,
      "question": "Her job requires a lot of ___________________ as she often needs to adapt to sudden changes. (flexible)",
      "answerOptions": [
        { "text": "flexibility", "isCorrect": true },
        { "text": "flexible", "isCorrect": false },
        { "text": "flexibly", "isCorrect": false },
        { "text": "flex", "isCorrect": false }
      ],
      "rationale": "1. Phân tích:\n- flexibility (n): sự linh hoạt.\n- flexible (adj): linh hoạt.\n- flexibly (adv): một cách linh hoạt.\n- flex (v): uốn cong.\n\n2. Dịch nghĩa: \"Công việc của cô ấy đòi hỏi rất nhiều sự linh hoạt vì cô ấy thường cần thích nghi với những thay đổi đột ngột.\"\n\n3. Giải thích: Sau \"a lot of\" cần một danh từ."
    },
    {
      "questionNumber": 29,
      "question": "The camcorder has a ___________________ connectivity which makes it easy to transfer videos. (wire)",
      "answerOptions": [
        { "text": "wireless", "isCorrect": true },
        { "text": "wired", "isCorrect": false },
        { "text": "wiring", "isCorrect": false },
        { "text": "wire", "isCorrect": false }
      ],
      "rationale": "1. Phân tích:\n- wireless (adj): không dây.\n- wired (adj): có dây.\n- wiring (n): hệ thống dây điện.\n- wire (n): dây.\n\n2. Dịch nghĩa: \"Máy quay phim có kết nối không dây giúp dễ dàng chuyển video sang các thiết bị khác.\"\n\n3. Giải thích: Ngữ cảnh \"easy to transfer\" (dễ chuyển) thường ám chỉ công nghệ \"wireless\" (không dây). Cần tính từ bổ nghĩa cho \"connectivity\"."
    },
    {
      "questionNumber": 30,
      "question": "The phone case has a ___________________ design with a steel frame and rubber edges. (style)",
      "answerOptions": [
        { "text": "stylish", "isCorrect": true },
        { "text": "style", "isCorrect": false },
        { "text": "stylished", "isCorrect": false },
        { "text": "styling", "isCorrect": false }
      ],
      "rationale": "1. Phân tích:\n- stylish (adj): sành điệu, phong cách.\n- style (n): phong cách.\n- stylished (không tồn tại).\n- styling (n): sự tạo kiểu.\n\n2. Dịch nghĩa: \"Ốp lưng điện thoại có thiết kế sành điệu với khung thép và viền cao su.\"\n\n3. Giải thích: Cần tính từ đứng trước danh từ \"design\"."
    },
    {
      "questionNumber": 31,
      "question": "After a long day at school, I use my tablet for _________________ by streaming my favourite shows. (relax)",
      "answerOptions": [
        { "text": "relaxation", "isCorrect": true },
        { "text": "relax", "isCorrect": false },
        { "text": "relaxing", "isCorrect": false },
        { "text": "relaxed", "isCorrect": false }
      ],
      "rationale": "1. Phân tích:\n- relaxation (n): sự thư giãn.\n- relax (v): thư giãn.\n- relaxing (adj): mang tính thư giãn.\n- relaxed (adj): cảm thấy thư giãn.\n\n2. Dịch nghĩa: \"Sau một ngày dài ở trường, tôi sử dụng máy tính bảng để thư giãn bằng cách xem các chương trình yêu thích.\"\n\n3. Giải thích: Sau giới từ \"for\" cần một danh từ (hoặc V-ing). Relaxation là danh từ chỉ mục đích."
    },
    {
      "questionNumber": 32,
      "question": "These earbuds can ___________________ remove many of the outside noises. (effect)",
      "answerOptions": [
        { "text": "effectively", "isCorrect": true },
        { "text": "effective", "isCorrect": false },
        { "text": "effect", "isCorrect": false },
        { "text": "effectiveness", "isCorrect": false }
      ],
      "rationale": "1. Phân tích:\n- effectively (adv): một cách hiệu quả.\n- effective (adj): hiệu quả.\n- effect (n): hiệu ứng/tác dụng.\n- effectiveness (n): tính hiệu quả.\n\n2. Dịch nghĩa: \"Những chiếc tai nghe này có thể loại bỏ nhiều tiếng ồn bên ngoài một cách hiệu quả.\"\n\n3. Giải thích: Cần trạng từ bổ nghĩa cho động từ \"remove\"."
    },
    {
      "questionNumber": 33,
      "question": "With a rubberized exterior, the portable Bluetooth speaker can ensure ___________________ against accidental drops. (durable)",
      "answerOptions": [
        { "text": "durability", "isCorrect": true },
        { "text": "durable", "isCorrect": false },
        { "text": "durably", "isCorrect": false },
        { "text": "duration", "isCorrect": false }
      ],
      "rationale": "1. Phân tích:\n- durability (n): độ bền.\n- durable (adj): bền.\n- durably (adv): một cách bền bỉ.\n- duration (n): khoảng thời gian.\n\n2. Dịch nghĩa: \"Với vỏ ngoài bọc cao su, loa Bluetooth di động có thể đảm bảo độ bền chống lại các cú rơi vô tình.\"\n\n3. Giải thích: Sau động từ \"ensure\" cần một danh từ."
    },
    {
      "questionNumber": 34,
      "question": "Once the smartwatch ___________________ to your phone, you can receive calls. (connection)",
      "answerOptions": [
        { "text": "connects", "isCorrect": true },
        { "text": "connection", "isCorrect": false },
        { "text": "connected", "isCorrect": false },
        { "text": "connecting", "isCorrect": false }
      ],
      "rationale": "1. Phân tích:\n- connects (v): kết nối.\n- connection (n): sự kết nối.\n- connected (adj/v-ed): đã kết nối.\n- connecting (v-ing): đang kết nối.\n\n2. Dịch nghĩa: \"Một khi đồng hồ thông minh kết nối với điện thoại của bạn, bạn có thể nhận cuộc gọi.\"\n\n3. Giải thích: Câu thiếu động từ chính cho chủ ngữ \"the smartwatch\". Dùng hiện tại đơn (connects) để chỉ sự thật hiển nhiên/hướng dẫn."
    }
  ]
};

    // --- State & Logic ---
    let currentQuestionIndex = 0;
    let score = 0;
    let answered = false;

    const questionContainer = document.getElementById('questionContainer');
    const explanationBox = document.getElementById('explanationBox');
    const explanationText = document.getElementById('explanationText');
    const nextBtn = document.getElementById('nextBtn');
    const currentScoreEl = document.getElementById('currentScore');
    const progressBar = document.getElementById('progressBar');
    const quizCard = document.getElementById('quizCard');

    function renderQuestion() {
        answered = false;
        explanationBox.classList.remove('show');
        explanationBox.style.display = 'none';
        nextBtn.style.display = 'none';
        
        const qData = quizData.questions[currentQuestionIndex];
        
        // Update Progress
        const progress = ((currentQuestionIndex) / quizData.questions.length) * 100;
        progressBar.style.width = `${progress}%`;

        // Generate HTML
        let optionsHtml = '';
        const options = qData.answerOptions;
        const labels = ['A', 'B', 'C', 'D'];
        
        options.forEach((opt, index) => {
            optionsHtml += `
                <button class="option-btn" onclick="checkAnswer(${index}, this)">
                    <span class="option-marker">${labels[index]}</span>
                    ${opt.text}
                </button>
            `;
        });

        questionContainer.innerHTML = `
            <div class="question-text">${qData.question}</div>
            <div class="options-grid">
                ${optionsHtml}
            </div>
        `;
    }

    function checkAnswer(selectedIndex, btnElement) {
        if (answered) return;
        answered = true;
        
        const qData = quizData.questions[currentQuestionIndex];
        const isCorrect = qData.answerOptions[selectedIndex].isCorrect;
        const allButtons = document.querySelectorAll('.option-btn');

        if (isCorrect) {
            score++;
            currentScoreEl.textContent = score;
            btnElement.classList.add('correct');
            playSound('correct');
            fireConfetti();
        } else {
            btnElement.classList.add('wrong');
            playSound('wrong');
            quizCard.classList.add('shake');
            setTimeout(() => quizCard.classList.remove('shake'), 500);
            
            // Highlight the correct answer
            qData.answerOptions.forEach((opt, idx) => {
                if (opt.isCorrect) {
                    allButtons[idx].classList.add('correct');
                }
            });
        }

        // Show Explanation
        // Convert plain text newlines to HTML breaks for better reading
        let expText = qData.rationale;
        
        // Simple formatting to bold keywords (Phân tích, Dịch nghĩa, Giải thích)
        expText = expText.replace(/(1\. Phân tích:)/g, '<strong>$1</strong>');
        expText = expText.replace(/(2\. Dịch nghĩa:)/g, '<strong>$1</strong>');
        expText = expText.replace(/(3\. Giải thích:)/g, '<strong>$1</strong>');
        
        explanationText.innerHTML = expText;
        explanationBox.style.display = 'block';
        setTimeout(() => explanationBox.classList.add('show'), 10);
        
        nextBtn.style.display = 'block';
        
        // Disable all buttons
        allButtons.forEach(btn => btn.disabled = true);
    }

    function nextQuestion() {
        currentQuestionIndex++;
        if (currentQuestionIndex < quizData.questions.length) {
            renderQuestion();
        } else {
            showResult();
        }
    }

    function showResult() {
        const modal = document.getElementById('resultModal');
        const finalScore = document.getElementById('finalScore');
        const finalMsg = document.getElementById('finalMsg');
        
        finalScore.textContent = `${score}/${quizData.questions.length}`;
        
        const percentage = (score / quizData.questions.length) * 100;
        if (percentage === 100) {
            finalMsg.textContent = "Xuất sắc! Bạn là thiên tài!";
        } else if (percentage >= 80) {
            finalMsg.textContent = "Làm tốt lắm! Cố gắng phát huy nhé!";
        } else if (percentage >= 50) {
            finalMsg.textContent = "Khá tốt, nhưng cần ôn luyện thêm!";
        } else {
            finalMsg.textContent = "Đừng buồn, hãy thử lại lần nữa nhé!";
        }
        
        modal.style.display = 'flex';
        playSound('finish');
        fireConfetti(true); // lots of confetti
    }

    // --- Simple Confetti Logic ---
    function fireConfetti(isMassive = false) {
        const canvas = document.getElementById('confetti-canvas');
        const ctx = canvas.getContext('2d');
        canvas.width = window.innerWidth;
        canvas.height = window.innerHeight;
        
        const particles = [];
        const colors = ['#8854C0', '#00C9A7', '#FF4757', '#e1b12c', '#48dbfb'];
        
        const count = isMassive ? 150 : 30;
        
        for (let i = 0; i < count; i++) {
            particles.push({
                x: isMassive ? Math.random() * canvas.width : canvas.width / 2,
                y: isMassive ? Math.random() * canvas.height - canvas.height : canvas.height / 2,
                color: colors[Math.floor(Math.random() * colors.length)],
                size: Math.random() * 8 + 4,
                speedX: Math.random() * 6 - 3,
                speedY: Math.random() * 6 - 3,
                gravity: 0.5
            });
        }
        
        let animationId;
        function update() {
            ctx.clearRect(0, 0, canvas.width, canvas.height);
            let active = false;
            
            particles.forEach(p => {
                p.x += p.speedX;
                p.y += p.speedY;
                p.speedY += p.gravity;
                p.size *= 0.96; // shrink
                
                if (p.size > 0.5) {
                    ctx.fillStyle = p.color;
                    ctx.fillRect(p.x, p.y, p.size, p.size);
                    active = true;
                }
            });
            
            if (active) {
                animationId = requestAnimationFrame(update);
            }
        }
        
        update();
    }
    
    // Resize listener for confetti
    window.addEventListener('resize', () => {
        const canvas = document.getElementById('confetti-canvas');
        canvas.width = window.innerWidth;
        canvas.height = window.innerHeight;
    });

    // Start
    renderQuestion();
</script>

</body>
</html>
