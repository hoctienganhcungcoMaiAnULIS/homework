<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>English Quiz - Ms Mai An ULIS</title>
    <link href="https://fonts.googleapis.com/css2?family=Nunito:wght@400;700;800;900&display=swap" rel="stylesheet">
    <style>
        :root {
            --primary-pink: #8854C0;
            --primary-mint: #00C9A7;
            --primary-yellow: #FDCB6E;
            --correct-green: #00D26A;
            --wrong-red: #FF4757;
            --card-bg: rgba(255, 255, 255, 0.95);
            --text-dark: #2d3436;
        }

        body {
            font-family: 'Nunito', sans-serif;
            margin: 0;
            padding: 0;
            /* H·ªça ti·∫øt n·ªÅn vui nh·ªôn: B√¥ng hoa, ng√¥i sao, h√¨nh tr√≤n mix tr√™n n·ªÅn loang pastel */
            background: linear-gradient(135deg, #a18cd1 0%, #fbc2eb 100%), 
                        url('data:image/svg+xml;utf8,<svg width="150" height="150" viewBox="0 0 150 150" xmlns="http://www.w3.org/2000/svg"><path d="M30 30 l10 -15 l10 15 l15 10 l-15 10 l-10 15 l-10 -15 l-15 -10 z" fill="rgba(255,255,255,0.2)"/><circle cx="100" cy="40" r="15" fill="rgba(255,255,255,0.2)"/><path d="M80 100 a15 15 0 0 1 30 0 a15 15 0 0 1 -30 0" fill="rgba(255,255,255,0.3)"/><path d="M120 120 l-10 -20 l20 -10 z" fill="rgba(255,255,255,0.2)"/></svg>');
            background-blend-mode: overlay;
            color: var(--text-dark);
            padding-bottom: 100px;
        }

        .header {
            text-align: center;
            padding: 20px;
            background: rgba(255, 255, 255, 0.95);
            box-shadow: 0 4px 15px rgba(0,0,0,0.1);
            border-radius: 0 0 30px 30px;
            margin-bottom: 30px;
            border-bottom: 4px solid var(--primary-mint);
        }

        .header h5 { margin: 0; color: var(--primary-pink); font-size: 1.2rem; text-transform: uppercase; letter-spacing: 1px; }
        .header h1 { margin: 10px 0 0; color: var(--primary-mint); font-size: 2.2rem; text-shadow: 2px 2px 0px rgba(0,0,0,0.1); }

        .container { max-width: 850px; margin: 0 auto; padding: 0 15px; }

        /* L√Ω thuy·∫øt Box */
        .theory-box {
            background: #fff; border: 4px dashed var(--primary-pink);
            border-radius: 20px; padding: 25px; margin-bottom: 30px;
            box-shadow: 0 10px 20px rgba(0,0,0,0.1); position: relative;
        }
        .theory-title {
            background: var(--primary-pink); color: white; padding: 8px 20px;
            border-radius: 15px; display: inline-block; font-size: 1.4rem;
            font-weight: 800; margin-top: -45px; box-shadow: 0 4px 0 #5f27cd;
        }
        .theory-content h3 { color: var(--primary-mint); margin-top: 15px; margin-bottom: 5px; font-size: 1.2rem;}
        .theory-content p { font-size: 1.1rem; line-height: 1.6; margin-top: 5px;}
        .theory-content .ex { background: #fdfbfb; padding: 15px; border-left: 5px solid var(--primary-yellow); border-radius: 8px; margin: 10px 0; font-weight: bold;}
        
        .theory-table {
            width: 100%; border-collapse: collapse; margin-top: 15px;
            border-radius: 10px; overflow: hidden; box-shadow: 0 4px 10px rgba(0,0,0,0.05);
        }
        .theory-table th { background: var(--primary-mint); color: white; padding: 12px; font-size: 1.1rem; }
        .theory-table td { background: white; padding: 12px; border: 1px solid #eee; text-align: center; font-weight: bold;}
        .theory-table tr:nth-child(even) td { background: #f8f9fa; }

        .section-title {
            background: var(--primary-mint); color: white; padding: 12px 25px;
            border-radius: 20px; display: inline-block; margin-top: 20px;
            box-shadow: 0 5px 0 #00A388; border: 3px solid white; font-size: 1.3rem;
        }

        .question-card {
            background: var(--card-bg); border-radius: 20px; padding: 25px; margin: 20px 0;
            box-shadow: 0 8px 0 rgba(0,0,0,0.1); border: 2px solid #eee; transition: transform 0.2s;
        }

        .question-text { font-size: 1.25rem; font-weight: 800; margin-bottom: 20px; color: var(--primary-pink); }

        /* Options for MCQ */
        .options-grid { display: grid; grid-template-columns: 1fr 1fr; gap: 15px; }
        .option-btn {
            background: white; border: 2px solid #e0e0e0; padding: 15px;
            border-radius: 15px; font-size: 1.2rem; font-weight: 800; color: var(--text-dark);
            cursor: pointer; box-shadow: 0 6px 0 #e0e0e0; transition: all 0.1s;
            font-family: 'Nunito', sans-serif; text-align: center;
        }
        .option-btn:hover { transform: scale(1.02) translateY(-2px); box-shadow: 0 8px 0 #e0e0e0; }
        .option-btn:active { transform: scale(0.98) translateY(4px); box-shadow: 0 2px 0 #e0e0e0; }
        .option-btn.correct { background: var(--correct-green); border-color: #00A355; color: white; box-shadow: 0 6px 0 #00A355; }
        .option-btn.wrong { background: var(--wrong-red); border-color: #D63031; color: white; box-shadow: 0 6px 0 #D63031; }

        /* Explanations */
        .explanation {
            display: none; margin-top: 25px; padding: 20px; background: #f8f9fa;
            border-left: 6px solid var(--primary-mint); border-radius: 12px;
            animation: slideDown 0.3s ease-out; line-height: 1.6; font-size: 1.05rem;
        }
        .explanation h4 { margin: 0 0 12px 0; color: var(--primary-pink); font-size: 1.2rem;}
        .explanation p { margin: 8px 0; }
        .explanation .highlight { font-weight: 800; color: var(--primary-mint); }

        /* Text Inputs (Ex 2, 3, 4) */
        .text-input-group { display: flex; gap: 15px; align-items: center; }
        .write-input {
            flex: 1; padding: 15px; border: 3px solid #dfe6e9; border-radius: 15px;
            font-family: 'Nunito'; font-size: 1.2rem; font-weight: bold;
            color: var(--primary-pink); outline: none; transition: 0.3s;
        }
        .write-input:focus { border-color: var(--primary-mint); }
        .write-input.correct { background: rgba(0,210,106,0.1); border-color: var(--correct-green); color: var(--correct-green); }
        .write-input.wrong { background: rgba(255,71,87,0.1); border-color: var(--wrong-red); color: var(--wrong-red); }
        .check-btn {
            background: var(--primary-yellow); border: none; padding: 15px 30px;
            border-radius: 15px; font-weight: 900; font-size: 1.1rem; cursor: pointer;
            box-shadow: 0 6px 0 #e1b12c; color: #2d3436; transition: 0.1s; font-family: 'Nunito';
        }
        .check-btn:active { transform: translateY(4px); box-shadow: 0 0 0 #e1b12c; }

        /* Animations */
        @keyframes slideDown { from { opacity: 0; transform: translateY(-10px); } to { opacity: 1; transform: translateY(0); } }
        @keyframes shake {
            0%, 100% { transform: translateX(0); }
            25% { transform: translateX(-6px) rotate(-2deg); }
            75% { transform: translateX(6px) rotate(2deg); }
        }
        .shake { animation: shake 0.4s; }

        /* Submit Bar & Modal */
        .submit-bar {
            position: fixed; bottom: 0; left: 0; width: 100%;
            background: white; padding: 15px; box-shadow: 0 -5px 15px rgba(0,0,0,0.1);
            text-align: center; z-index: 100; box-sizing: border-box;
        }
        .submit-btn {
            background: var(--primary-pink); color: white; border: none; padding: 15px 50px;
            font-size: 1.5rem; font-weight: 900; border-radius: 30px; cursor: pointer;
            box-shadow: 0 6px 0 #5f27cd; font-family: 'Nunito'; transition: 0.2s;
        }
        .submit-btn:hover { transform: translateY(-2px); box-shadow: 0 8px 0 #5f27cd; }
        .submit-btn:active { transform: translateY(6px); box-shadow: 0 0 0 #5f27cd; }
        #confetti-canvas { position: fixed; top: 0; left: 0; width: 100%; height: 100%; pointer-events: none; z-index: 999; }
        .modal { display: none; position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0,0,0,0.6); z-index: 1000; justify-content: center; align-items: center; }
        .modal-content { background: white; padding: 40px; border-radius: 20px; text-align: center; max-width: 450px; box-shadow: 0 10px 30px rgba(0,0,0,0.2); }
        .modal-content h2 { color: var(--primary-pink); margin-top: 0; font-size: 2.2rem; }
    </style>
</head>
<body>

<canvas id="confetti-canvas"></canvas>

<div class="header">
    <h5>Gi√°o vi√™n t·∫°o: Ms Mai An ULIS</h5>
    <h1>B√≠ K√≠p D√πng "Me too" & "Me neither" ‚úåÔ∏è</h1>
</div>

<div class="container" id="quiz-container">

    <div class="theory-box">
        <div class="theory-title">IV. C√°ch d√πng "Me too" v√† "Me neither" üìö</div>
        <div class="theory-content">
            <p>Hai t·ª´ n√†y ƒë·ªÅu d√πng khi em mu·ªën ƒë·ªìng √Ω v·ªõi √Ω ki·∫øn c·ªßa ng∆∞·ªùi kh√°c (nghƒ©a l√†: "T·ªõ c≈©ng v·∫≠y"). Tuy nhi√™n, c√°ch d√πng l·∫°i kh√°c nhau m·ªôt ch√∫t x√≠u, c√°c con ch√∫ √Ω nh√©!</p>
            
            <h3>1. D√πng "Me too" (T·ªõ c≈©ng th·∫ø)</h3>
            <p>Ch√∫ng m√¨nh d√πng <strong>Me too</strong> khi mu·ªën ƒë·ªìng √Ω v·ªõi m·ªôt <strong>c√¢u kh·∫≥ng ƒë·ªãnh</strong> (c√¢u n√≥i b√¨nh th∆∞·ªùng, kh√¥ng c√≥ t·ª´ "kh√¥ng").</p>
            <div class="ex">
                V√≠ d·ª•:<br>
                B·∫°n A: I liked our old class. (T·ªõ th√≠ch l·ªõp h·ªçc c≈© c·ªßa ch√∫ng m√¨nh.)<br>
                B·∫°n B: Me too. (T·ªõ c≈©ng th·∫ø.)
            </div>

            <h3>2. D√πng "Me neither" (T·ªõ c≈©ng kh√¥ng)</h3>
            <p>Ch√∫ng m√¨nh d√πng <strong>Me neither</strong> khi mu·ªën ƒë·ªìng √Ω v·ªõi m·ªôt <strong>c√¢u ph·ªß ƒë·ªãnh</strong> (c√¢u c√≥ √Ω t·ª´ ch·ªëi ho·∫∑c n√≥i "kh√¥ng").<br>
            Khi n√†o d√πng? Khi c√¢u n√≥i c·ªßa b·∫°n c√≥ ch·ª©a c√°c t·ª´ nh∆∞: <span style="color:var(--wrong-red); font-weight:bold;">don't, doesn't, didn't, can't, isn't, aren't...</span></p>
            <div class="ex">
                V√≠ d·ª•:<br>
                B·∫°n A: I don‚Äôt want to go back to school. (T·ªõ ch·∫≥ng mu·ªën quay l·∫°i tr∆∞·ªùng h·ªçc ƒë√¢u.)<br>
                B·∫°n B: Me neither. (T·ªõ c≈©ng kh√¥ng mu·ªën.)
            </div>

            <h3>‚ö° B·∫£ng t·ªïng h·ª£p</h3>
            <table class="theory-table">
                <tr>
                    <th>Lo·∫°i c√¢u</th>
                    <th>D·∫•u hi·ªáu nh·∫≠n bi·∫øt</th>
                    <th>Em d√πng t·ª´ g√¨?</th>
                    <th>Nghƒ©a ti·∫øng Vi·ªát</th>
                </tr>
                <tr>
                    <td>C√¢u kh·∫≥ng ƒë·ªãnh</td>
                    <td>C√¢u b√¨nh th∆∞·ªùng</td>
                    <td style="color:var(--correct-green); font-size:1.2rem;">Me too</td>
                    <td>T·ªõ c≈©ng v·∫≠y!</td>
                </tr>
                <tr>
                    <td>C√¢u ph·ªß ƒë·ªãnh</td>
                    <td>C√≥ don't, can't, isn't...</td>
                    <td style="color:var(--primary-pink); font-size:1.2rem;">Me neither</td>
                    <td>T·ªõ c≈©ng kh√¥ng!</td>
                </tr>
            </table>
        </div>
    </div>

    <h2 class="section-title">B√†i t·∫≠p 1: Ch·ªçn ƒë√°p √°n ƒë√∫ng nh·∫•t (10 c√¢u)</h2>
    <p><em>M·ª•c ti√™u: Nh·∫≠n di·ªán nhanh c√¢u kh·∫≥ng ƒë·ªãnh (b√¨nh th∆∞·ªùng) v√† c√¢u ph·ªß ƒë·ªãnh ƒë·ªÉ ch·ªçn ph·∫£n h·ªìi ph√π h·ª£p.</em></p>
    <div id="ex1-container"></div>

    <h2 class="section-title">B√†i t·∫≠p 2: ƒêi·ªÅn "Me too" ho·∫∑c "Me neither" (10 c√¢u)</h2>
    <p><em>M·ª•c ti√™u: R√®n luy·ªán k·ªπ nƒÉng ƒë·ªçc hi·ªÉu v√† t·ª± vi·∫øt t·ª´ ƒë√∫ng (Nh·∫≠p Me too ho·∫∑c Me neither v√†o √¥ tr·ªëng).</em></p>
    <div id="ex2-container"></div>

    <h2 class="section-title">B√†i t·∫≠p 3: T√¨m v√† s·ª≠a l·ªói sai (5 c√¢u)</h2>
    <p><em>M·ª•c ti√™u: T√¨m l·ªói sai ·ªü ph·∫ßn tr·∫£ l·ªùi B v√† g√µ ƒë√°p √°n ƒë√∫ng v√†o √¥.</em></p>
    <div id="ex3-container"></div>

    <h2 class="section-title">B√†i t·∫≠p 4: ƒê·ªçc t√¨nh hu·ªëng v√† vi·∫øt c√¢u ƒë·ªìng t√¨nh (5 c√¢u)</h2>
    <p><em>M·ª•c ti√™u: V·∫≠n d·ª•ng ki·∫øn th·ª©c v√†o th·ª±c t·∫ø (Ch·ªâ c·∫ßn g√µ Me too ho·∫∑c Me neither).</em></p>
    <div id="ex4-container"></div>

</div>

<div class="submit-bar">
    <button class="submit-btn" id="submitBtn">N·ªòP B√ÄI & XEM ƒêI·ªÇM üèÜ</button>
</div>

<div class="modal" id="scoreModal">
    <div class="modal-content">
        <h2>üéâ CH√öC M·ª™NG üéâ</h2>
        <p id="scoreText" style="font-size: 1.5rem;"></p>
        <p id="complimentText" style="color: var(--primary-mint); font-size: 1.2rem;"></p>
        <button class="check-btn" onclick="location.reload()" style="margin-top:20px; width:100%;">L√†m l·∫°i b√†i nh√©</button>
    </div>
</div>

<script>
    /* --- AUDIO --- */
    const AudioContext = window.AudioContext || window.webkitAudioContext;
    let audioCtx = new AudioContext();

    function playDing() {
        if(audioCtx.state === 'suspended') audioCtx.resume();
        const osc = audioCtx.createOscillator();
        const gain = audioCtx.createGain();
        osc.connect(gain); gain.connect(audioCtx.destination);
        osc.type = 'sine';
        osc.frequency.setValueAtTime(800, audioCtx.currentTime);
        osc.frequency.exponentialRampToValueAtTime(1500, audioCtx.currentTime + 0.1);
        gain.gain.setValueAtTime(0, audioCtx.currentTime);
        gain.gain.linearRampToValueAtTime(0.3, audioCtx.currentTime + 0.05);
        gain.gain.exponentialRampToValueAtTime(0.01, audioCtx.currentTime + 0.5);
        osc.start(); osc.stop(audioCtx.currentTime + 0.5);
    }

    function playBuzz() {
        if(audioCtx.state === 'suspended') audioCtx.resume();
        const osc = audioCtx.createOscillator();
        const gain = audioCtx.createGain();
        osc.connect(gain); gain.connect(audioCtx.destination);
        osc.type = 'square';
        osc.frequency.setValueAtTime(150, audioCtx.currentTime);
        osc.frequency.exponentialRampToValueAtTime(100, audioCtx.currentTime + 0.3);
        gain.gain.setValueAtTime(0, audioCtx.currentTime);
        gain.gain.linearRampToValueAtTime(0.2, audioCtx.currentTime + 0.05);
        gain.gain.exponentialRampToValueAtTime(0.01, audioCtx.currentTime + 0.3);
        osc.start(); osc.stop(audioCtx.currentTime + 0.3);
    }

    /* --- CONFETTI --- */
    const canvas = document.getElementById('confetti-canvas');
    const ctx = canvas.getContext('2d');
    canvas.width = window.innerWidth; canvas.height = window.innerHeight;
    let particles = [];
    function fireConfetti() {
        const colors = ['#00D26A', '#FF4757', '#FDCB6E', '#0984E3', '#8854C0'];
        for(let i=0; i<60; i++) {
            particles.push({
                x: window.innerWidth / 2, y: window.innerHeight / 2,
                r: Math.random() * 6 + 4, dx: Math.random() * 14 - 7, dy: Math.random() * -14 - 7,
                color: colors[Math.floor(Math.random() * colors.length)], tilt: Math.random() * 10
            });
        }
    }
    function animateConfetti() {
        requestAnimationFrame(animateConfetti);
        ctx.clearRect(0,0,canvas.width, canvas.height);
        particles.forEach((p, index) => {
            p.dy += 0.3; p.x += p.dx; p.y += p.dy; p.tilt += 0.15;
            ctx.beginPath(); ctx.lineWidth = p.r; ctx.strokeStyle = p.color;
            ctx.moveTo(p.x + p.tilt + p.r, p.y); ctx.lineTo(p.x + p.tilt, p.y + p.tilt + p.r); ctx.stroke();
            if(p.y > canvas.height) particles.splice(index, 1);
        });
    }
    animateConfetti();

    /* --- DATA & LOGIC --- */
    let score = 0;
    const TOTAL_QUESTIONS = 30;

    function cleanStr(str) { return str.toLowerCase().replace(/[.,!?]/g, '').trim(); }

    // D·ªØ li·ªáu B√†i 1
    const ex1Data = [
        { q: "A: I like eating pizza. - B: ________.", ans: "Me too", vn: "A: T·ªõ th√≠ch ƒÉn pizza. - B: T·ªõ c≈©ng v·∫≠y.", note: "C√¢u kh·∫≥ng ƒë·ªãnh b√¨nh th∆∞·ªùng." },
        { q: "A: I don't like vegetables. - B: ________.", ans: "Me neither", vn: "A: T·ªõ kh√¥ng th√≠ch rau c·ªß. - B: T·ªõ c≈©ng kh√¥ng.", note: "C√¢u ph·ªß ƒë·ªãnh c√≥ 'don't'." },
        { q: "A: I can swim very fast. - B: ________.", ans: "Me too", vn: "A: T·ªõ c√≥ th·ªÉ b∆°i r·∫•t nhanh. - B: T·ªõ c≈©ng v·∫≠y.", note: "C√¢u kh·∫≥ng ƒë·ªãnh b√¨nh th∆∞·ªùng." },
        { q: "A: I can't ride a bike. - B: ________.", ans: "Me neither", vn: "A: T·ªõ kh√¥ng th·ªÉ ƒë·∫°p xe. - B: T·ªõ c≈©ng kh√¥ng.", note: "C√¢u ph·ªß ƒë·ªãnh c√≥ 'can't'." },
        { q: "A: I am very happy today. - B: ________.", ans: "Me too", vn: "A: H√¥m nay t·ªõ r·∫•t vui. - B: T·ªõ c≈©ng v·∫≠y.", note: "C√¢u kh·∫≥ng ƒë·ªãnh b√¨nh th∆∞·ªùng." },
        { q: "A: I am not tired. - B: ________.", ans: "Me neither", vn: "A: T·ªõ kh√¥ng m·ªát. - B: T·ªõ c≈©ng kh√¥ng.", note: "C√¢u ph·ªß ƒë·ªãnh c√≥ 'am not'." },
        { q: "A: I played football yesterday. - B: ________.", ans: "Me too", vn: "A: T·ªõ ƒë√£ ch∆°i b√≥ng ƒë√° h√¥m qua. - B: T·ªõ c≈©ng v·∫≠y.", note: "C√¢u kh·∫≥ng ƒë·ªãnh th√¨ qu√° kh·ª©." },
        { q: "A: I didn't go to the zoo last week. - B: ________.", ans: "Me neither", vn: "A: Tu·∫ßn tr∆∞·ªõc t·ªõ ƒë√£ kh√¥ng ƒëi s·ªü th√∫. - B: T·ªõ c≈©ng kh√¥ng.", note: "C√¢u ph·ªß ƒë·ªãnh c√≥ 'didn't'." },
        { q: "A: I want to watch a cartoon. - B: ________.", ans: "Me too", vn: "A: T·ªõ mu·ªën xem phim ho·∫°t h√¨nh. - B: T·ªõ c≈©ng th·∫ø.", note: "C√¢u kh·∫≥ng ƒë·ªãnh b√¨nh th∆∞·ªùng." },
        { q: "A: I won't do my homework now. - B: ________.", ans: "Me neither", vn: "A: T·ªõ s·∫Ω kh√¥ng l√†m b√†i t·∫≠p b√¢y gi·ªù. - B: T·ªõ c≈©ng kh√¥ng.", note: "C√¢u ph·ªß ƒë·ªãnh c√≥ 'won't' (will not)." }
    ];

    const ex1Container = document.getElementById('ex1-container');
    ex1Data.forEach((item, index) => {
        const correct = item.ans;
        const wrong = item.ans === "Me too" ? "Me neither" : "Me too";
        let html = `
        <div class="question-card">
            <div class="question-text">${index + 1}. ${item.q}</div>
            <div class="options-grid">
                <button class="option-btn" onclick="checkMCQ(this, '${correct}', '${correct}')">A. ${correct}</button>
                <button class="option-btn" onclick="checkMCQ(this, '${wrong}', '${correct}')">B. ${wrong}</button>
            </div>
            <div class="explanation">
                <h4>üí° Gi·∫£i th√≠ch chi ti·∫øt:</h4>
                <p><strong>1. D·ªãch c√¢u h·ªèi:</strong> ${item.vn}</p>
                <p><strong>2. Ph√¢n t√≠ch:</strong> ƒê√°p √°n A. Me too (T·ªõ c≈©ng v·∫≠y) / ƒê√°p √°n B. Me neither (T·ªõ c≈©ng kh√¥ng).</p>
                <p><strong>3. T·∫°i sao ch·ªçn <span class="highlight">"${item.ans}"</span>?</strong> V√¨ ƒë√¢y l√† <span class="highlight">${item.note}</span></p>
                <p><strong>4. T·∫°i sao ƒë√°p √°n kia sai?</strong> V√¨ n√≥ kh√¥ng ph√π h·ª£p v·ªõi lo·∫°i c√¢u (Kh·∫≥ng ƒë·ªãnh/Ph·ªß ƒë·ªãnh) c·ªßa ng∆∞·ªùi A n√≥i.</p>
            </div>
        </div>`;
        ex1Container.innerHTML += html;
    });

    window.checkMCQ = function(btn, chosenVal, correctVal) {
        const card = btn.closest('.question-card');
        const btns = card.querySelectorAll('.option-btn');
        const exp = card.querySelector('.explanation');
        
        if(card.classList.contains('answered')) return;
        card.classList.add('answered');

        if(chosenVal === correctVal) {
            btn.classList.add('correct'); playDing(); fireConfetti(); score++;
        } else {
            btn.classList.add('wrong'); card.classList.add('shake'); playBuzz();
            btns.forEach(b => { if(b.innerText.includes(correctVal)) b.classList.add('correct'); });
        }
        exp.style.display = 'block';
    };

    // H√†m t·∫°o Text Input B√†i t·∫≠p (√°p d·ª•ng cho B√†i 2, 3, 4)
    function generateTextInputExercise(containerId, dataArray, startIndex) {
        const container = document.getElementById(containerId);
        dataArray.forEach((item, i) => {
            const index = startIndex + i;
            let html = `
            <div class="question-card text-card">
                <div class="question-text">${index}. ${item.q}</div>
                <div class="text-input-group">
                    <input type="text" class="write-input" placeholder="G√µ Me too ho·∫∑c Me neither...">
                    <button class="check-btn" onclick="checkText(this, '${item.ans}')">Ki·ªÉm tra</button>
                </div>
                <div class="explanation">
                    <h4>üí° Gi·∫£i th√≠ch chi ti·∫øt:</h4>
                    <p><strong>1. D·ªãch nghƒ©a:</strong> ${item.vn}</p>
                    <p><strong>2. ƒê√°p √°n chu·∫©n:</strong> <span class="highlight">${item.ans}</span></p>
                    <p><strong>3. Ph√¢n t√≠ch ng·ªØ ph√°p:</strong> B·∫°n A n√≥i m·ªôt <span class="highlight">${item.note}</span>. ƒê·ªÉ ƒë·ªìng t√¨nh, ta b·∫Øt bu·ªôc ph·∫£i d√πng "${item.ans}".</p>
                    <p><strong>4. L∆∞u √Ω b·∫´y:</strong> Kh√¥ng ƒë∆∞·ª£c d√πng t·ª´ ng∆∞·ª£c l·∫°i (V√≠ d·ª• c√¢u ph·ªß ƒë·ªãnh m√† d√πng Me too l√† sai ho√†n to√†n nh√©!).</p>
                </div>
            </div>`;
            container.innerHTML += html;
        });
    }

    window.checkText = function(btn, correctAns) {
        const card = btn.closest('.text-card');
        const input = card.querySelector('.write-input');
        const exp = card.querySelector('.explanation');
        if(!input.value.trim()) return;

        btn.style.display = 'none'; input.disabled = true;
        const userVal = cleanStr(input.value);
        const correctVal = cleanStr(correctAns);

        if(userVal === correctVal || (userVal.includes('neither') && correctVal.includes('neither')) || (userVal.includes('too') && correctVal.includes('too'))) {
            input.classList.add('correct'); playDing(); fireConfetti(); score++;
        } else {
            input.classList.add('wrong'); card.classList.add('shake'); playBuzz();
            input.value = `Sai r·ªìi! Ph·∫£i l√†: ${correctAns}`;
        }
        exp.style.display = 'block';
    };

    // D·ªØ li·ªáu B√†i 2
    const ex2Data = [
        { q: "A: I have a cute cat.<br>‚ûî B: _________.", ans: "Me too", vn: "A: T·ªõ c√≥ m·ªôt ch√∫ m√®o d·ªÖ th∆∞∆°ng. - B: T·ªõ c≈©ng v·∫≠y.", note: "c√¢u kh·∫≥ng ƒë·ªãnh b√¨nh th∆∞·ªùng" },
        { q: "A: I don't have a dog.<br>‚ûî B: _________.", ans: "Me neither", vn: "A: T·ªõ kh√¥ng c√≥ ch√≥. - B: T·ªõ c≈©ng kh√¥ng.", note: "c√¢u ph·ªß ƒë·ªãnh c√≥ 'don't'" },
        { q: "A: I hate rainy days!<br>‚ûî B: _________.", ans: "Me too", vn: "A: T·ªõ gh√©t nh·ªØng ng√†y m∆∞a! - B: T·ªõ c≈©ng v·∫≠y.", note: "c√¢u kh·∫≥ng ƒë·ªãnh (t·ª´ hate mang nghƒ©a ti√™u c·ª±c nh∆∞ng ng·ªØ ph√°p c√¢u v·∫´n l√† kh·∫≥ng ƒë·ªãnh, kh√¥ng c√≥ not)" },
        { q: "A: I didn't finish my math homework.<br>‚ûî B: _________.", ans: "Me neither", vn: "A: T·ªõ ch∆∞a l√†m xong b√†i t·∫≠p to√°n. - B: T·ªõ c≈©ng ch∆∞a.", note: "c√¢u ph·ªß ƒë·ªãnh c√≥ 'didn't'" },
        { q: "A: I am very hungry right now.<br>‚ûî B: _________.", ans: "Me too", vn: "A: B√¢y gi·ªù t·ªõ r·∫•t ƒë√≥i. - B: T·ªõ c≈©ng th·∫ø.", note: "c√¢u kh·∫≥ng ƒë·ªãnh c√≥ to be 'am'" },
        { q: "A: I can't speak Japanese.<br>‚ûî B: _________.", ans: "Me neither", vn: "A: T·ªõ kh√¥ng th·ªÉ n√≥i ti·∫øng Nh·∫≠t. - B: T·ªõ c≈©ng kh√¥ng.", note: "c√¢u ph·ªß ƒë·ªãnh c√≥ 'can't'" },
        { q: "A: I love playing video games.<br>‚ûî B: _________.", ans: "Me too", vn: "A: T·ªõ th√≠ch ch∆°i ƒëi·ªán t·ª≠. - B: T·ªõ c≈©ng v·∫≠y.", note: "c√¢u kh·∫≥ng ƒë·ªãnh b√¨nh th∆∞·ªùng" },
        { q: "A: I wasn't at home yesterday morning.<br>‚ûî B: _________.", ans: "Me neither", vn: "A: S√°ng qua t·ªõ kh√¥ng c√≥ ·ªü nh√†. - B: T·ªõ c≈©ng kh√¥ng.", note: "c√¢u ph·ªß ƒë·ªãnh c√≥ 'wasn't'" },
        { q: "A: I always go to bed early.<br>‚ûî B: _________.", ans: "Me too", vn: "A: T·ªõ lu√¥n ƒëi ng·ªß s·ªõm. - B: T·ªõ c≈©ng th·∫ø.", note: "c√¢u kh·∫≥ng ƒë·ªãnh b√¨nh th∆∞·ªùng" },
        { q: "A: I don't want to wake up early!<br>‚ûî B: _________.", ans: "Me neither", vn: "A: T·ªõ kh√¥ng mu·ªën d·∫≠y s·ªõm! - B: T·ªõ c≈©ng kh√¥ng.", note: "c√¢u ph·ªß ƒë·ªãnh c√≥ 'don't'" }
    ];
    generateTextInputExercise('ex2-container', ex2Data, 11);

    // D·ªØ li·ªáu B√†i 3
    const ex3Data = [
        { q: "A: I don't like spiders. - B: Me too.<br>‚ûî S·ª≠a l·∫°i: B:", ans: "Me neither", vn: "A: T·ªõ kh√¥ng th√≠ch nh·ªán. - B: T·ªõ c≈©ng v·∫≠y.", note: "c√¢u c·ªßa A l√† c√¢u ph·ªß ƒë·ªãnh (don't), B d√πng Me too l√† sai." },
        { q: "A: I love studying English. - B: Me neither.<br>‚ûî S·ª≠a l·∫°i: B:", ans: "Me too", vn: "A: T·ªõ y√™u vi·ªác h·ªçc ti·∫øng Anh. - B: T·ªõ c≈©ng kh√¥ng.", note: "c√¢u c·ªßa A l√† kh·∫≥ng ƒë·ªãnh (love), B d√πng Me neither l√† sai." },
        { q: "A: I can't fly like a bird. - B: Me too.<br>‚ûî S·ª≠a l·∫°i: B:", ans: "Me neither", vn: "A: T·ªõ kh√¥ng th·ªÉ bay nh∆∞ chim. - B: T·ªõ c≈©ng v·∫≠y.", note: "c√¢u c·ªßa A c√≥ 'can't' (ph·ªß ƒë·ªãnh), B ph·∫£i ƒë·ªìng t√¨nh b·∫±ng Me neither." },
        { q: "A: I am a student. - B: I too.<br>‚ûî S·ª≠a l·∫°i: B:", ans: "Me too", vn: "A: T·ªõ l√† h·ªçc sinh. - B: T√¥i c≈©ng.", note: "A n√≥i c√¢u kh·∫≥ng ƒë·ªãnh, c·ª•m t·ª´ chu·∫©n ƒë·ªÉ ƒë·ªìng √Ω l√† 'Me too', kh√¥ng c√≥ t·ª´ 'I too'." },
        { q: "A: I didn't see that movie. - B: Me too.<br>‚ûî S·ª≠a l·∫°i: B:", ans: "Me neither", vn: "A: T·ªõ ƒë√£ kh√¥ng xem phim ƒë√≥. - B: T·ªõ c≈©ng v·∫≠y.", note: "A d√πng 'didn't' (ph·ªß ƒë·ªãnh), B ph·∫£i s·ª≠a Me too th√†nh Me neither." }
    ];
    generateTextInputExercise('ex3-container', ex3Data, 21);

    // D·ªØ li·ªáu B√†i 4
    const ex4Data = [
        { q: "B·∫°n c·ªßa con nhƒÉn m·∫∑t n√≥i: 'I don't like washing the dishes.' Con c≈©ng nghƒ© v·∫≠y, con n√≥i:", ans: "Me neither", vn: "T·ªõ kh√¥ng th√≠ch r·ª≠a b√°t ƒë√¢u. - T·ªõ c≈©ng kh√¥ng.", note: "c√¢u b·∫°n n√≥i c√≥ 'don't' (ph·ªß ƒë·ªãnh)" },
        { q: "ƒêang gi·ªù ra ch∆°i, b·∫°n con r·ªß: 'I want to play football.' Con r·∫•t h√†o h·ª©ng ƒë·ªìng √Ω:", ans: "Me too", vn: "T·ªõ mu·ªën ƒë√° b√≥ng. - T·ªõ c≈©ng mu·ªën.", note: "c√¢u b·∫°n n√≥i l√† kh·∫≥ng ƒë·ªãnh b√¨nh th∆∞·ªùng" },
        { q: "Trong gi·ªù ki·ªÉm tra, b·∫°n th√¨ th·∫ßm: 'I can't find my pen.' Con c≈©ng m·∫•t b√∫t, con ƒë√°p l·∫°i:", ans: "Me neither", vn: "T·ªõ kh√¥ng t√¨m th·∫•y b√∫t. - T·ªõ c≈©ng kh√¥ng.", note: "c√¢u b·∫°n n√≥i c√≥ 'can't' (ph·ªß ƒë·ªãnh)" },
        { q: "L·ªõp s·∫Øp ƒëi d√£ ngo·∫°i, b·∫°n reo l√™n: 'I am so excited for the school trip!' Con c≈©ng th·∫•y v·∫≠y:", ans: "Me too", vn: "T·ªõ h√†o h·ª©ng v·ªõi chuy·∫øn ƒëi qu√°! - T·ªõ c≈©ng v·∫≠y.", note: "c√¢u b·∫°n n√≥i l√† kh·∫≥ng ƒë·ªãnh" },
        { q: "Tr·ªùi ƒëang m∆∞a to, b·∫°n than th·ªü: 'I didn't bring my umbrella.' Con c≈©ng qu√™n √¥, con n√≥i:", ans: "Me neither", vn: "T·ªõ kh√¥ng mang √¥ r·ªìi. - T·ªõ c≈©ng kh√¥ng.", note: "c√¢u b·∫°n n√≥i c√≥ 'didn't' (ph·ªß ƒë·ªãnh)" }
    ];
    generateTextInputExercise('ex4-container', ex4Data, 26);

    /* --- SUBMIT --- */
    document.getElementById('submitBtn').addEventListener('click', () => {
        const modal = document.getElementById('scoreModal');
        const scoreText = document.getElementById('scoreText');
        const compText = document.getElementById('complimentText');
        
        scoreText.innerText = `ƒê·∫°t: ${score} / ${TOTAL_QUESTIONS} ƒêi·ªÉm`;
        
        let msg = "";
        if(score === TOTAL_QUESTIONS) msg = "Qu√° ƒë·ªânh! Kh√¥ng m·ªôt c√°i b·∫´y n√†o l·ª´a ƒë∆∞·ª£c con! üåüüåüüåü";
        else if(score >= 25) msg = "Tuy·ªát v·ªùi! Con n·∫Øm c·∫•u tr√∫c r·∫•t ch·∫Øc ch·∫Øn! üî•";
        else if(score >= 15) msg = "Kh√° l·∫Øm, h√£y ch√∫ √Ω ƒë·ªçc k·ªπ ch·ªØ 'don't/can't' ·ªü c√¢u tr∆∞·ªõc nh√©! üí™";
        else msg = "ƒê·ª´ng bu·ªìn, ƒë·ªçc l·∫°i ph·∫ßn gi·∫£i th√≠ch chi ti·∫øt b√™n d∆∞·ªõi c√°c c√¢u sai l√† gi·ªèi ngay! ‚ù§Ô∏è";
        
        compText.innerText = msg;
        modal.style.display = 'flex';
        if(score >= 15) fireConfetti();
    });
</script>

</body>
</html>