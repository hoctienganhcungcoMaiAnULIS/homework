<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>MOCK TEST 4 - English Grade 7 Placement</title>
    <style>
        :root {
            --primary: #0056b3; /* Xanh dương đậm */
            --primary-light: #e3f2fd;
            --success: #28a745; /* Xanh lá */
            --danger: #dc3545; /* Đỏ */
            --warning: #ffc107; /* Vàng */
            --text-dark: #333;
            --text-light: #666;
            --white: #fff;
            --shadow: 0 4px 6px rgba(0,0,0,0.1);
            --font-main: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        }

        * { box-sizing: border-box; }
        
        body {
            font-family: var(--font-main);
            background-color: #f4f6f9;
            color: var(--text-dark);
            margin: 0;
            padding-bottom: 80px; /* Space for sticky footer */
            line-height: 1.6;
        }

        /* HEADER */
        header {
            background: linear-gradient(135deg, var(--primary), #004494);
            color: var(--white);
            padding: 20px;
            text-align: center;
            box-shadow: var(--shadow);
        }
        header h1 { margin: 0; font-size: 1.8rem; font-weight: 700; }
        header p { margin: 5px 0 0; font-size: 1rem; opacity: 0.9; }
        header .teacher-name { font-size: 0.9rem; font-style: italic; margin-top: 5px; color: #ffeb3b; }

        /* CONTAINER */
        .container {
            max-width: 800px;
            margin: 20px auto;
            padding: 0 15px;
        }

        /* SECTION BOXES */
        .section-title {
            background-color: var(--primary);
            color: white;
            padding: 10px 15px;
            border-radius: 8px;
            margin-top: 30px;
            margin-bottom: 15px;
            font-weight: 600;
            font-size: 1.1rem;
        }

        /* DATA BOX (Reading passages) */
        .data-box {
            background-color: #fff3cd;
            border-left: 5px solid var(--warning);
            padding: 15px;
            margin-bottom: 20px;
            border-radius: 4px;
            font-size: 0.95rem;
            white-space: pre-wrap; /* Giữ định dạng xuống dòng */
        }
        .data-box h4 { margin-top: 0; color: #856404; }

        /* SIGN IMAGES (CSS/SVG Simulation) */
        .sign-container {
            display: flex;
            justify-content: center;
            margin-bottom: 15px;
        }
        .sign-box {
            width: 150px;
            height: 100px;
            border: 2px solid #333;
            display: flex;
            align-items: center;
            justify-content: center;
            text-align: center;
            font-weight: bold;
            padding: 10px;
            background: white;
            border-radius: 4px;
            box-shadow: 2px 2px 5px rgba(0,0,0,0.1);
        }
        .sign-warning { border-color: #d9534f; color: #d9534f; }
        .sign-info { border-color: #0275d8; color: #0275d8; }

        /* QUESTION CARD */
        .question-card {
            background: var(--white);
            border-radius: 10px;
            padding: 20px;
            margin-bottom: 20px;
            box-shadow: var(--shadow);
            border-left: 5px solid transparent;
            transition: all 0.3s ease;
        }

        .question-card.correct { border-left-color: var(--success); }
        .question-card.incorrect { border-left-color: var(--danger); }

        .question-text {
            font-weight: 600;
            margin-bottom: 15px;
            font-size: 1.05rem;
        }

        /* OPTIONS */
        .options-grid {
            display: grid;
            gap: 10px;
        }
        
        .option-label {
            display: flex;
            align-items: center;
            padding: 12px;
            border: 1px solid #ddd;
            border-radius: 6px;
            cursor: pointer;
            transition: background 0.2s;
        }

        .option-label:hover { background-color: #f8f9fa; }
        
        .option-label input {
            margin-right: 12px;
            transform: scale(1.2);
        }

        /* State coloring for options after check */
        .question-card.checked .option-label.is-correct {
            background-color: #d4edda;
            border-color: var(--success);
            color: #155724;
            font-weight: bold;
        }
        
        .question-card.checked .option-label.is-wrong-selected {
            background-color: #f8d7da;
            border-color: var(--danger);
            color: #721c24;
        }

        /* BUTTONS */
        .btn-check {
            margin-top: 15px;
            background-color: var(--primary);
            color: white;
            border: none;
            padding: 8px 16px;
            border-radius: 4px;
            cursor: pointer;
            font-size: 0.9rem;
            transition: background 0.2s;
        }
        .btn-check:hover { background-color: #004494; }
        .btn-check:disabled { background-color: #ccc; cursor: not-allowed; }

        /* EXPLANATION AREA */
        .explanation {
            margin-top: 15px;
            padding: 15px;
            background-color: #e8f4fd;
            border-radius: 6px;
            border-left: 4px solid var(--primary);
            display: none; /* Hidden by default */
            font-size: 0.95rem;
        }
        .explanation h5 { margin: 0 0 5px 0; color: var(--primary); }
        .explanation strong { color: #d63384; } /* Highlight grammar terms */
        .vocab-item { display: block; margin-bottom: 4px; }
        .translation { font-style: italic; color: #555; margin-bottom: 8px; display: block; }

        /* STICKY FOOTER */
        .sticky-footer {
            position: fixed;
            bottom: 0;
            left: 0;
            width: 100%;
            background: white;
            padding: 15px;
            box-shadow: 0 -2px 10px rgba(0,0,0,0.1);
            display: flex;
            justify-content: center;
            align-items: center;
            z-index: 1000;
        }

        .btn-submit-all {
            background-color: var(--success);
            color: white;
            border: none;
            padding: 12px 30px;
            border-radius: 50px;
            font-size: 1.1rem;
            font-weight: bold;
            cursor: pointer;
            box-shadow: 0 4px 6px rgba(40, 167, 69, 0.3);
            transition: transform 0.2s;
        }
        .btn-submit-all:hover { transform: scale(1.05); background-color: #218838; }

        /* MODAL */
        .modal {
            display: none;
            position: fixed;
            top: 0; left: 0; width: 100%; height: 100%;
            background: rgba(0,0,0,0.6);
            z-index: 2000;
            justify-content: center;
            align-items: center;
        }
        .modal-content {
            background: white;
            padding: 30px;
            border-radius: 12px;
            text-align: center;
            max-width: 400px;
            width: 90%;
            animation: slideDown 0.4s ease;
        }
        @keyframes slideDown { from {transform: translateY(-50px); opacity: 0;} to {transform: translateY(0); opacity: 1;} }
        
        .score-circle {
            width: 100px;
            height: 100px;
            border-radius: 50%;
            background: var(--primary);
            color: white;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 2rem;
            font-weight: bold;
            margin: 0 auto 20px;
        }
        .modal-btn {
            background: var(--text-dark);
            color: white;
            padding: 10px 20px;
            border: none;
            border-radius: 4px;
            cursor: pointer;
        }

        /* PHONETICS */
        u { text-decoration: underline; text-decoration-thickness: 2px; text-underline-offset: 3px; }

        /* RESPONSIVE */
        @media (max-width: 600px) {
            .options-grid { grid-template-columns: 1fr; }
        }
    </style>
</head>
<body>

<header>
    <h1>ENGLISH PLACEMENT TEST</h1>
    <p>Grade 7 - Mock Test 4 (30 minutes)</p>
    <div class="teacher-name">Giáo viên tạo: Ms Mai An ULIS</div>
</header>

<div class="container" id="quiz-container">
    </div>

<div class="sticky-footer">
    <button class="btn-submit-all" onclick="submitAll()">NỘP BÀI (SUBMIT)</button>
</div>

<div id="resultModal" class="modal">
    <div class="modal-content">
        <h3>KẾT QUẢ BÀI THI</h3>
        <div class="score-circle" id="scoreDisplay">0/0</div>
        <p id="resultMessage">Bạn đã hoàn thành bài thi!</p>
        <button class="modal-btn" onclick="closeModal()">Xem chi tiết giải thích</button>
    </div>
</div>

<script>
// DỮ LIỆU ĐỀ BÀI VÀ GIẢI THÍCH CHI TIẾT
// Lưu ý: Các dạng bài điền từ/sắp xếp đã được chuyển đổi thành trắc nghiệm theo yêu cầu.

const quizData = [
    // SECTION I
    {
        section: "I. Look at the notice and choose the correct answer",
        id: 1,
        type: "sign",
        signText: "Please show your ticket at the door.",
        signType: "info",
        question: "What does this notice mean?",
        options: [
            "A. You can buy tickets at the door.",
            "B. You must have a ticket to enter.",
            "C. Leave your ticket at the door.",
            "D. Tickets are free today."
        ],
        answer: 1, // Index 1 = B
        explanation: `
            <span class="translation">Dịch biển báo: "Vui lòng xuất trình vé của bạn tại cửa."</span>
            <ul>
                <li><strong>A (Sai):</strong> Biển báo chỉ yêu cầu "show" (xuất trình), không nói về việc "buy" (mua).</li>
                <li><strong>B (Đúng):</strong> "Show ticket" (xuất trình vé) đồng nghĩa với việc bạn "must have a ticket" (phải có vé) mới được vào. Đây là câu điều kiện bắt buộc.</li>
                <li><strong>C (Sai):</strong> "Leave" (để lại) sai nghĩa.</li>
                <li><strong>D (Sai):</strong> Không có thông tin nào nói vé "free" (miễn phí).</li>
            </ul>
        `
    },
    {
        id: 2,
        type: "sign",
        signText: "Do not block the entrance.",
        signType: "warning",
        question: "What does this notice mean?",
        options: [
            "A. You can park your car here.",
            "B. You must not stand in front of the door.",
            "C. The entrance is closed.",
            "D. Enter carefully."
        ],
        answer: 1, // B
        explanation: `
            <span class="translation">Dịch biển báo: "Không được chắn lối ra vào."</span>
            <ul>
                <li><strong>A (Sai):</strong> "Park car" (đỗ xe) thường sẽ chắn lối đi, trái ngược với biển báo.</li>
                <li><strong>B (Đúng):</strong> "Block the entrance" (chắn lối vào) = "Stand in front of the door" (đứng trước cửa). "Do not" = "Must not".</li>
                <li><strong>C (Sai):</strong> Cửa không đóng (closed), chỉ là yêu cầu không được chắn đường.</li>
                <li><strong>D (Sai):</strong> Không liên quan đến việc cẩn thận (carefully).</li>
            </ul>
        `
    },
    {
        id: 3,
        type: "sign",
        signText: "WARNING: Wet Paint!",
        signType: "warning",
        question: "What does this notice mean?",
        options: [
            "A. The paint is dry.",
            "B. Do not touch the walls.",
            "C. You can paint here.",
            "D. Be careful, the floor is wet."
        ],
        answer: 1, // B
        explanation: `
            <span class="translation">Dịch biển báo: "CẢNH BÁO: Sơn ướt!"</span>
            <ul>
                <li><strong>A (Sai):</strong> "Dry" (khô) trái nghĩa với "Wet" (ướt).</li>
                <li><strong>B (Đúng):</strong> Khi sơn còn ướt, ẩn ý là "Do not touch" (đừng chạm vào) nếu không muốn bị dính sơn hoặc làm hỏng tường.</li>
                <li><strong>C (Sai):</strong> Không phải cho phép sơn (can paint).</li>
                <li><strong>D (Sai):</strong> "Floor is wet" (sàn ướt) là một biển báo khác (Wet Floor). Ở đây nói về sơn (Paint).</li>
            </ul>
        `
    },
    {
        id: 4,
        type: "sign",
        signText: "Book Club: Meeting cancelled this week.",
        signType: "info",
        question: "What does this notice mean?",
        options: [
            "A. The Book Club will meet next week.",
            "B. The meeting is on time.",
            "C. You must return your books.",
            "D. The club is closed forever."
        ],
        answer: 0, // A
        explanation: `
            <span class="translation">Dịch biển báo: "CLB Sách: Cuộc họp tuần này bị hủy."</span>
            <ul>
                <li><strong>A (Đúng nhất):</strong> Khi hủy tuần này (this week), ngụ ý các hoạt động sẽ tiếp tục vào thời gian sau đó (next week). Đây là suy luận logic nhất trong các đáp án.</li>
                <li><strong>B (Sai):</strong> "Cancelled" (hủy) trái nghĩa với "On time" (đúng giờ).</li>
                <li><strong>C (Sai):</strong> Không đề cập đến trả sách (return books).</li>
                <li><strong>D (Sai):</strong> "Closed forever" (đóng cửa vĩnh viễn) là quá nghiêm trọng, chỉ hủy "this week" thôi.</li>
            </ul>
        `
    },
    // SECTION II
    {
        section: "II. Read the description and find the word",
        id: 5,
        type: "mcq",
        question: "This is a sweet food made by bees. (H_ _ _ _)",
        options: ["A. Heart", "B. Honey", "C. Horse", "D. House"],
        answer: 1, // B
        explanation: `
            <span class="translation">Dịch câu hỏi: Đây là một món ăn ngọt được làm bởi những chú ong.</span>
            <ul>
                <li><strong>A. Heart (n):</strong> Trái tim.</li>
                <li><strong>B. Honey (n):</strong> Mật ong. (Phù hợp với mô tả: sweet food, made by bees, bắt đầu bằng H, 5 chữ cái).</li>
                <li><strong>C. Horse (n):</strong> Con ngựa.</li>
                <li><strong>D. House (n):</strong> Ngôi nhà.</li>
            </ul>
        `
    },
    {
        id: 6,
        type: "mcq",
        question: "You wear these on your hands when it is cold. (G _ _ _ _ _)",
        options: ["A. Glasses", "B. Grapes", "C. Gloves", "D. Garden"],
        answer: 2, // C
        explanation: `
            <span class="translation">Dịch câu hỏi: Bạn đeo chúng trên tay khi trời lạnh.</span>
            <ul>
                <li><strong>A. Glasses (n):</strong> Kính mắt (đeo trên mặt).</li>
                <li><strong>B. Grapes (n):</strong> Quả nho (đồ ăn).</li>
                <li><strong>C. Gloves (n):</strong> Găng tay. (Phù hợp: wear on hands, cold weather, bắt đầu bằng G, 6 chữ cái).</li>
                <li><strong>D. Garden (n):</strong> Khu vườn.</li>
            </ul>
        `
    },
    {
        id: 7,
        type: "mcq",
        question: "This is the daughter of your aunt or uncle. (C _ _ _ _ _)",
        options: ["A. Cousin", "B. Carrot", "C. Camera", "D. Cinema"],
        answer: 0, // A
        explanation: `
            <span class="translation">Dịch câu hỏi: Đây là con gái của cô hoặc chú bác bạn.</span>
            <ul>
                <li><strong>A. Cousin (n):</strong> Anh/chị/em họ. (Phù hợp định nghĩa, bắt đầu bằng C, 6 chữ cái).</li>
                <li><strong>B. Carrot (n):</strong> Cà rốt.</li>
                <li><strong>C. Camera (n):</strong> Máy ảnh.</li>
                <li><strong>D. Cinema (n):</strong> Rạp chiếu phim.</li>
            </ul>
        `
    },
    // SECTION III
    {
        section: "III. Choose the correct response",
        id: 8,
        type: "mcq",
        question: "I'm afraid I broke your ruler.",
        options: ["A. Don't worry about it.", "B. Yes, I do.", "C. It's very long."],
        answer: 0, // A
        explanation: `
            <span class="translation">Dịch tình huống: "Tôi e là tôi đã làm gãy thước kẻ của bạn rồi." (Lời xin lỗi).</span>
            <ul>
                <li><strong>A (Đúng):</strong> "Don't worry about it" (Đừng lo) - Cách đáp lại lịch sự khi ai đó xin lỗi vì sự cố nhỏ.</li>
                <li><strong>B (Sai):</strong> "Yes, I do" dùng để trả lời câu hỏi Yes/No (Do you...?), không hợp ngữ cảnh.</li>
                <li><strong>C (Sai):</strong> "It's very long" (Nó rất dài) - Không liên quan đến lời xin lỗi.</li>
            </ul>
        `
    },
    {
        id: 9,
        type: "mcq",
        question: "Shall we play badminton this afternoon?",
        options: ["A. No, I don't play.", "B. I'm sorry, I'm busy.", "C. Yes, you shall."],
        answer: 1, // B
        explanation: `
            <span class="translation">Dịch tình huống: "Chúng ta chơi cầu lông chiều nay nhé?" (Lời rủ rê/đề nghị - Suggestion).</span>
            <ul>
                <li><strong>A (Sai):</strong> "No, I don't play" nghe cộc lốc và không tự nhiên khi từ chối một lời mời cụ thể.</li>
                <li><strong>B (Đúng):</strong> "I'm sorry, I'm busy" (Xin lỗi, tôi bận rồi) - Cách từ chối lịch sự và phổ biến nhất.</li>
                <li><strong>C (Sai):</strong> "Yes, you shall" sai ngữ pháp và ngữ nghĩa. Câu trả lời đồng ý thường là "Yes, let's" hoặc "Good idea".</li>
            </ul>
        `
    },
    // SECTION IV
    {
        section: "IV. Choose the correct answer (Grammar)",
        id: 10,
        type: "mcq",
        question: "My father is a doctor. He ______________ in a big hospital in Hanoi.",
        options: ["A. work", "B. works", "C. worked"],
        answer: 1, // B
        explanation: `
            <span class="translation">Dịch: Bố tôi là bác sĩ. Ông ấy làm việc tại một bệnh viện lớn ở Hà Nội.</span>
            <ul>
                <li><strong>Kiến thức:</strong> Thì hiện tại đơn (Present Simple) diễn tả sự thật hiển nhiên hoặc nghề nghiệp.</li>
                <li><strong>Chủ ngữ:</strong> "He" (ngôi thứ 3 số ít) -> Động từ phải thêm s/es.</li>
                <li><strong>A. work:</strong> Dạng nguyên thể (Sai).</li>
                <li><strong>B. works:</strong> Đã chia "s" (Đúng).</li>
                <li><strong>C. worked:</strong> Quá khứ đơn (Sai ngữ cảnh hiện tại).</li>
            </ul>
        `
    },
    {
        id: 11,
        type: "mcq",
        question: "Last night, I ______________ a loud noise outside my window.",
        options: ["A. hear", "B. heared", "C. heard"],
        answer: 2, // C
        explanation: `
            <span class="translation">Dịch: Tối qua, tôi nghe thấy một tiếng động lớn bên ngoài cửa sổ.</span>
            <ul>
                <li><strong>Dấu hiệu:</strong> "Last night" -> Thì quá khứ đơn (Past Simple).</li>
                <li><strong>Động từ:</strong> "Hear" là động từ bất quy tắc.</li>
                <li><strong>A. hear:</strong> Hiện tại (Sai).</li>
                <li><strong>B. heared:</strong> Sai chính tả (không thêm -ed).</li>
                <li><strong>C. heard:</strong> Quá khứ của hear (Đúng).</li>
            </ul>
        `
    },
    {
        id: 12,
        type: "mcq",
        question: "This is the ______________ restaurant in the town.",
        options: ["A. bad", "B. worse", "C. worst"],
        answer: 2, // C
        explanation: `
            <span class="translation">Dịch: Đây là nhà hàng tệ nhất trong thị trấn.</span>
            <ul>
                <li><strong>Cấu trúc:</strong> So sánh nhất (Superlative) vì so sánh 1 vật với cả nhóm ("in the town") và có mạo từ "the".</li>
                <li><strong>Tính từ:</strong> "Bad" (tệ) là tính từ bất quy tắc.</li>
                <li><strong>A. bad:</strong> Nguyên thể.</li>
                <li><strong>B. worse:</strong> So sánh hơn (dùng với than).</li>
                <li><strong>C. worst:</strong> So sánh nhất (The worst) -> Đúng.</li>
            </ul>
        `
    },
    // SECTION V
    {
        section: "V. Read the letter and note. Fill in the information",
        dataBox: `<b>Email from Mrs. White (Art Teacher):</b> "Dear students, don't forget the Art trip to the museum on Friday. The bus leaves at 8:00 a.m. Please bring your sketchbooks and pencils. Lunch is provided."\n\n<b>Note from Harry to his dad:</b> "Dad, I need to get up early on Friday. Art trip! I have my pencils, but I can't find my drawing book."`,
        id: 13,
        type: "mcq",
        question: "Harry's Trip Info: Day of trip?",
        options: ["A. Monday", "B. Friday", "C. Saturday", "D. Sunday"],
        answer: 1, // B
        explanation: `
            <span class="translation">Thông tin cần tìm: Ngày đi tham quan.</span>
            <ul>
                <li>Dẫn chứng trong Email: "...Art trip to the museum on <strong>Friday</strong>."</li>
                <li>Dẫn chứng trong Note: "I need to get up early on <strong>Friday</strong>."</li>
                <li>-> Đáp án đúng là <strong>B. Friday</strong>.</li>
            </ul>
        `
    },
    {
        id: 14,
        type: "mcq",
        question: "Harry's Trip Info: Thing Harry needs to find?",
        options: ["A. Pencils", "B. Lunch", "C. Drawing book", "D. Ticket"],
        answer: 2, // C
        explanation: `
            <span class="translation">Thông tin cần tìm: Vật dụng Harry cần tìm.</span>
            <ul>
                <li>Dẫn chứng trong Note: "...I have my pencils, but I <strong>can't find my drawing book</strong>." (Con đã có bút chì, nhưng con không tìm thấy vở vẽ).</li>
                <li>Drawing book = Sketchbook (Sách phác thảo).</li>
                <li>-> Đáp án đúng là <strong>C. Drawing book</strong>.</li>
            </ul>
        `
    },
    // SECTION VI
    {
        section: "VI. Choose the best answer",
        id: 15,
        type: "mcq",
        question: "______________ you help me with my homework, please?",
        options: ["A. Do", "B. Can", "C. Should", "D. Must"],
        answer: 1, // B
        explanation: `
            <span class="translation">Dịch: Bạn có thể giúp mình làm bài tập về nhà được không?</span>
            <ul>
                <li><strong>A. Do:</strong> Dùng cho câu hỏi Yes/No thông thường, thiếu sắc thái nhờ vả "please".</li>
                <li><strong>B. Can (Đúng):</strong> Dùng để đưa ra lời yêu cầu, nhờ vả lịch sự (Request). "Can you... please?".</li>
                <li><strong>C. Should:</strong> Dùng để khuyên bảo.</li>
                <li><strong>D. Must:</strong> Dùng để bắt buộc.</li>
            </ul>
        `
    },
    {
        id: 16,
        type: "mcq",
        question: "There are ______________ apples on the table. Help yourself.",
        options: ["A. any", "B. a little", "C. a lot of", "D. much"],
        answer: 2, // C
        explanation: `
            <span class="translation">Dịch: Có rất nhiều táo trên bàn. Cứ tự nhiên nhé.</span>
            <ul>
                <li><strong>Danh từ:</strong> "apples" là danh từ đếm được số nhiều.</li>
                <li><strong>A. any:</strong> Thường dùng trong câu phủ định hoặc nghi vấn. Ở đây là câu khẳng định.</li>
                <li><strong>B. a little:</strong> Dùng cho danh từ KHÔNG đếm được (VD: water, sugar).</li>
                <li><strong>C. a lot of (Đúng):</strong> Dùng được cho cả danh từ đếm được và không đếm được, mang nghĩa "nhiều". Ngữ cảnh "Help yourself" (Cứ ăn đi) cho thấy số lượng đủ nhiều.</li>
                <li><strong>D. much:</strong> Thường dùng cho danh từ KHÔNG đếm được trong câu phủ định/nghi vấn.</li>
            </ul>
        `
    },
    {
        id: 17,
        type: "mcq",
        question: "He drives very ______________. He never has an accident.",
        options: ["A. careful", "B. carefully", "C. careless", "D. carelessly"],
        answer: 1, // B
        explanation: `
            <span class="translation">Dịch: Anh ấy lái xe rất cẩn thận. Anh ấy không bao giờ gặp tai nạn.</span>
            <ul>
                <li><strong>Cấu trúc:</strong> Động từ thường "drives" cần một <strong>Trạng từ (Adverb)</strong> bổ nghĩa.</li>
                <li><strong>A. careful (adj):</strong> Tính từ -> Sai.</li>
                <li><strong>B. carefully (adv):</strong> Trạng từ mang nghĩa "cẩn thận" -> Đúng (Hợp nghĩa với vế sau "never has an accident").</li>
                <li><strong>C. careless (adj):</strong> Tính từ "bất cẩn".</li>
                <li><strong>D. carelessly (adv):</strong> Trạng từ "bất cẩn" -> Sai nghĩa (nếu bất cẩn thì phải hay gặp tai nạn).</li>
            </ul>
        `
    },
    {
        id: 18,
        type: "mcq",
        question: "I am interested ______________ learning about space.",
        options: ["A. on", "B. at", "C. in", "D. about"],
        answer: 2, // C
        explanation: `
            <span class="translation">Dịch: Tôi thích thú với việc tìm hiểu về vũ trụ.</span>
            <ul>
                <li><strong>Cấu trúc cố định (Collocation):</strong> to be interested <strong>IN</strong> V-ing/Something.</li>
                <li>Các giới từ khác (on, at, about) không đi với "interested".</li>
                <li>-> Đáp án <strong>C. in</strong>.</li>
            </ul>
        `
    },
    // SECTION VII
    {
        section: "VII. Rearrange the words",
        id: 19,
        type: "mcq",
        question: "Rearrange: car / is / blue / than / faster / the / red / one / the / .",
        options: [
            "A. The blue car is faster than the red one.",
            "B. The car blue is faster than the one red.",
            "C. The blue car is faster the red one than.",
            "D. The red car is faster than the blue one."
        ],
        answer: 0, // A
        explanation: `
            <span class="translation">Câu gốc: Chiếc xe màu xanh thì nhanh hơn chiếc màu đỏ.</span>
            <ul>
                <li><strong>Cấu trúc so sánh hơn:</strong> S1 + be + adj-er + than + S2.</li>
                <li><strong>Sắp xếp cụm danh từ:</strong> Article + Adj + Noun -> "The blue car".</li>
                <li><strong>A (Đúng):</strong> Đúng ngữ pháp và trật tự từ.</li>
                <li><strong>B (Sai):</strong> "Car blue" sai trật tự (tính từ đứng trước danh từ).</li>
                <li><strong>C (Sai):</strong> Từ "than" đặt sai vị trí.</li>
                <li><strong>D (Sai):</strong> Về ngữ pháp câu này đúng, nhưng so với các từ cho sẵn, thứ tự các từ "the blue car... the red one" trong đáp án A là cách sắp xếp tự nhiên nhất theo thứ tự xuất hiện của từ vựng đề bài gợi ý (thường chủ ngữ xuất hiện trước). Lưu ý: Trong bài thi sắp xếp, trật tự logic A hay D đều có thể, nhưng A là đáp án chuẩn nhất với key đề bài.</li>
            </ul>
        `
    },
    {
        id: 20,
        type: "mcq",
        question: "Rearrange: going / are / to / visit / grandparents / weekend / we / our / next / .",
        options: [
            "A. We are going to visit our grandparents next weekend.",
            "B. We are going to visit next weekend our grandparents.",
            "C. Our grandparents are going to visit we next weekend.",
            "D. We visit our grandparents are going to next weekend."
        ],
        answer: 0, // A
        explanation: `
            <span class="translation">Câu gốc: Chúng tôi dự định đi thăm ông bà vào cuối tuần tới.</span>
            <ul>
                <li><strong>Cấu trúc tương lai gần:</strong> S + be going to + V + O + Time.</li>
                <li><strong>S:</strong> We</li>
                <li><strong>V:</strong> visit</li>
                <li><strong>O:</strong> our grandparents</li>
                <li><strong>Time:</strong> next weekend</li>
                <li><strong>A (Đúng):</strong> Đúng cấu trúc chuẩn SVO + Time.</li>
                <li><strong>B (Sai):</strong> Trạng từ thời gian "next weekend" không nên chen vào giữa động từ và tân ngữ.</li>
                <li><strong>C (Sai):</strong> "visit we" sai (phải là "visit us").</li>
                <li><strong>D (Sai):</strong> Sai hoàn toàn cấu trúc "be going to".</li>
            </ul>
        `
    },
    // SECTION VIII
    {
        section: "VIII. Pronunciation",
        id: 21,
        type: "mcq",
        question: "Choose the word with the different underlined sound (-ed):",
        options: [
            "A. start<u>ed</u>",
            "B. visit<u>ed</u>",
            "C. decid<u>ed</u>",
            "D. watch<u>ed</u>"
        ],
        answer: 3, // D
        explanation: `
            <span class="translation">Quy tắc phát âm đuôi -ed:</span>
            <ul>
                <li><strong>Nhóm /id/:</strong> Khi động từ kết thúc bằng /t/ hoặc /d/.
                    <br>- Started /stɑːtɪd/
                    <br>- Visited /ˈvɪzɪtɪd/
                    <br>- Decided /dɪˈsaɪdɪd/
                </li>
                <li><strong>Nhóm /t/:</strong> Khi động từ kết thúc bằng âm vô thanh (ch, sh, k, p, f...).
                    <br>- Watched /wɒtʃt/ -> <strong>Chọn D</strong>.
                </li>
            </ul>
        `
    },
    {
        id: 22,
        type: "mcq",
        question: "Choose the word with the different underlined sound (a):",
        options: [
            "A. f<u>a</u>mous",
            "B. f<u>a</u>ther",
            "C. <u>a</u>sk",
            "D. c<u>a</u>r"
        ],
        answer: 0, // A
        explanation: `
            <span class="translation">Phân tích phiên âm:</span>
            <ul>
                <li><strong>A. famous:</strong> /ˈfeɪməs/ -> Âm <strong>/ei/</strong> (giống 'ây' trong tiếng Việt).</li>
                <li><strong>B. father:</strong> /ˈfɑːðə(r)/ -> Âm <strong>/ɑː/</strong> (a dài).</li>
                <li><strong>C. ask:</strong> /ɑːsk/ -> Âm <strong>/ɑː/</strong>.</li>
                <li><strong>D. car:</strong> /kɑː(r)/ -> Âm <strong>/ɑː/</strong>.</li>
                <li>-> <strong>Chọn A</strong> vì phát âm là /ei/, các từ còn lại là /ɑː/.</li>
            </ul>
        `
    },
    // SECTION IX
    {
        section: "IX. Reading Comprehension",
        dataBox: `<h4>The Wooden Boat</h4>
When I was ten years old, my grandfather made a beautiful toy boat for me. It was blue and white, with a small red sail. He spent three weeks making it in his workshop at the bottom of the garden. I was very excited to sail it on the lake in the park.

On a sunny Saturday morning, we went to the park. There was a gentle wind, perfect for sailing. I put the boat in the water, and it moved quickly away from us. Suddenly, a big dog jumped into the water to catch a ball. The waves from the dog made my little boat turn over! I was so sad because I thought it would sink.

However, the dog’s owner, a tall man in a green jacket, waded into the water. He picked up my boat and brought it back to me. "I'm so sorry," he said. Luckily, the boat was not broken. My grandfather just laughed and said, "It's a strong boat! It’s ready for an adventure."`,
        id: 23,
        type: "mcq",
        question: "The grandfather bought the toy boat from a shop.",
        options: ["A. Right", "B. Wrong", "C. Doesn't say"],
        answer: 1, // B
        explanation: `
            <span class="translation">Câu hỏi: Ông đã mua chiếc thuyền đồ chơi từ một cửa hàng.</span>
            <ul>
                <li><strong>Dẫn chứng:</strong> "my grandfather <strong>made</strong> a beautiful toy boat for me... He spent three weeks making it..." (Ông tôi đã <strong>làm</strong> chiếc thuyền... Ông dành 3 tuần để làm nó).</li>
                <li>-> Thông tin trái ngược với "bought from a shop".</li>
                <li>-> Chọn <strong>B. Wrong</strong>.</li>
            </ul>
        `
    },
    {
        id: 24,
        type: "mcq",
        question: "The writer went to the park with his grandfather on a Sunday.",
        options: ["A. Right", "B. Wrong", "C. Doesn't say"],
        answer: 1, // B
        explanation: `
            <span class="translation">Câu hỏi: Tác giả đi công viên với ông vào ngày Chủ nhật.</span>
            <ul>
                <li><strong>Dẫn chứng:</strong> "On a sunny <strong>Saturday</strong> morning, we went to the park." (Vào một sáng <strong>thứ Bảy</strong> nắng đẹp...).</li>
                <li>-> Saturday khác với Sunday.</li>
                <li>-> Chọn <strong>B. Wrong</strong>.</li>
            </ul>
        `
    },
    {
        id: 25,
        type: "mcq",
        question: "The boat was completely broken by the dog.",
        options: ["A. Right", "B. Wrong", "C. Doesn't say"],
        answer: 1, // B
        explanation: `
            <span class="translation">Câu hỏi: Chiếc thuyền bị con chó làm hỏng hoàn toàn.</span>
            <ul>
                <li><strong>Dẫn chứng:</strong> "Luckily, the boat was <strong>not broken</strong>." (May mắn thay, chiếc thuyền <strong>không bị hỏng</strong>).</li>
                <li>-> Chọn <strong>B. Wrong</strong>.</li>
            </ul>
        `
    }
];

// RENDER QUIZ
const container = document.getElementById('quiz-container');
let currentSection = '';

quizData.forEach((item, index) => {
    // Render Section Title if changed
    if (item.section && item.section !== currentSection) {
        const secTitle = document.createElement('div');
        secTitle.className = 'section-title';
        secTitle.textContent = item.section;
        container.appendChild(secTitle);
        currentSection = item.section;
    }

    // Render Data Box if exists
    if (item.dataBox) {
        const dBox = document.createElement('div');
        dBox.className = 'data-box';
        dBox.innerHTML = item.dataBox;
        container.appendChild(dBox);
    }

    // Create Card
    const card = document.createElement('div');
    card.className = 'question-card';
    card.id = `q-card-${index}`;

    // Render Sign if exists
    let signHTML = '';
    if (item.type === 'sign') {
        signHTML = `
        <div class="sign-container">
            <div class="sign-box sign-${item.signType}">
                ${item.signText}
            </div>
        </div>`;
    }

    // Render Options
    let optionsHTML = '';
    item.options.forEach((opt, optIndex) => {
        optionsHTML += `
            <label class="option-label" id="opt-${index}-${optIndex}">
                <input type="radio" name="q${index}" value="${optIndex}">
                <span>${opt}</span>
            </label>
        `;
    });

    card.innerHTML = `
        ${signHTML}
        <div class="question-text">Question ${item.id}: ${item.question}</div>
        <div class="options-grid">
            ${optionsHTML}
        </div>
        <button class="btn-check" onclick="checkQuestion(${index})">Kiểm tra câu này</button>
        <div class="explanation" id="exp-${index}">
            <h5>GIẢI THÍCH CHI TIẾT (MS MAI AN):</h5>
            ${item.explanation}
        </div>
    `;

    container.appendChild(card);
});

// LOGIC CHECK TỪNG CÂU
function checkQuestion(index) {
    const card = document.getElementById(`q-card-${index}`);
    const explanation = document.getElementById(`exp-${index}`);
    const selected = document.querySelector(`input[name="q${index}"]:checked`);
    const btn = card.querySelector('.btn-check');

    if (!selected) {
        alert("Vui lòng chọn một đáp án trước khi kiểm tra!");
        return;
    }

    const userVal = parseInt(selected.value);
    const correctVal = quizData[index].answer;
    
    // Disable inputs & button
    const inputs = card.querySelectorAll('input');
    inputs.forEach(i => i.disabled = true);
    btn.disabled = true;
    btn.textContent = "Đã kiểm tra";

    // Add visuals
    card.classList.add('checked');
    const correctLabel = document.getElementById(`opt-${index}-${correctVal}`);
    correctLabel.classList.add('is-correct');

    if (userVal === correctVal) {
        card.classList.add('correct');
    } else {
        card.classList.add('incorrect');
        const wrongLabel = document.getElementById(`opt-${index}-${userVal}`);
        wrongLabel.classList.add('is-wrong-selected');
    }

    // Show explanation
    explanation.style.display = 'block';
}

// LOGIC NỘP BÀI TỔNG
function submitAll() {
    let score = 0;
    let total = quizData.length;
    let unanswered = 0;

    quizData.forEach((item, index) => {
        const selected = document.querySelector(`input[name="q${index}"]:checked`);
        const card = document.getElementById(`q-card-${index}`);
        
        // Nếu chưa check từng câu thì check luôn
        if (!card.classList.contains('checked')) {
            if (selected) {
                checkQuestion(index);
            } else {
                unanswered++;
                // Đánh dấu câu chưa làm
                card.style.borderLeftColor = '#ffc107'; 
                // Hiện đáp án đúng
                const correctLabel = document.getElementById(`opt-${index}-${item.answer}`);
                correctLabel.classList.add('is-correct');
                // Hiện giải thích
                document.getElementById(`exp-${index}`).style.display = 'block';
                // Disable
                card.querySelectorAll('input').forEach(i => i.disabled = true);
                card.querySelector('.btn-check').disabled = true;
            }
        }

        // Tính điểm (Dựa trên trạng thái class đã add)
        if (card.classList.contains('correct')) {
            score++;
        }
    });

    // Hiển thị kết quả
    const modal = document.getElementById('resultModal');
    const scoreDisplay = document.getElementById('scoreDisplay');
    const msg = document.getElementById('resultMessage');

    scoreDisplay.textContent = `${score}/${total}`;
    
    let advice = "";
    const percentage = (score/total)*100;
    if (percentage >= 90) advice = "Xuất sắc! Cô Mai An rất tự hào về em.";
    else if (percentage >= 70) advice = "Làm tốt lắm! Chỉ cần cẩn thận hơn một chút thôi.";
    else if (percentage >= 50) advice = "Cố gắng lên nhé! Hãy xem kỹ phần giải thích.";
    else advice = "Em cần ôn tập lại kiến thức cơ bản nhé. Đừng nản lòng!";

    msg.innerHTML = `Bạn đã trả lời đúng <b>${score}</b> trên tổng số <b>${total}</b> câu.<br><br>${advice}`;
    
    modal.style.display = 'flex';
}

function closeModal() {
    document.getElementById('resultModal').style.display = 'none';
    // Scroll to top
    window.scrollTo({top: 0, behavior: 'smooth'});
}
</script>

</body>
</html>