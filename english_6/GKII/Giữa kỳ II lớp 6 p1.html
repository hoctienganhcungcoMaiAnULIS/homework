<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>English Gamified Quiz - Ms Mai An ULIS</title>
    <link href="https://fonts.googleapis.com/css2?family=Nunito:wght@400;700;800;900&display=swap" rel="stylesheet">
    <style>
        :root {
            --primary: #8854C0;
            --secondary: #FDCB6E;
            --accent: #00C9A7;
            --correct: #00D26A;
            --correct-shadow: #00a051;
            --wrong: #FF4757;
            --wrong-shadow: #c8303d;
            --btn-bg: #ffffff;
            --btn-shadow: #e0e0e0;
            --text-main: #333333;
        }

        * {
            box-sizing: border-box;
            font-family: 'Nunito', sans-serif;
        }

        body {
            margin: 0;
            padding: 0;
            background: linear-gradient(-45deg, #8854C0, #FF9A9E, #FDCB6E, #00C9A7);
            background-size: 400% 400%;
            animation: gradientBG 15s ease infinite;
            min-height: 100vh;
            color: var(--text-main);
            overflow-x: hidden;
        }

        /* SVG Pattern L∆° L·ª≠ng */
        .pattern-overlay {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            pointer-events: none;
            z-index: 0;
            background-image: url("data:image/svg+xml,%3Csvg width='100' height='100' viewBox='0 0 100 100' xmlns='http://www.w3.org/2000/svg'%3E%3Cpath d='M10 10l5 15 15 5-15 5-5 15-5-15-15-5 15-5z' fill='rgba(255,255,255,0.4)'/%3E%3Ccircle cx='70' cy='70' r='8' fill='rgba(255,255,255,0.3)'/%3E%3Cpath d='M80 20a10 10 0 0 1-20 0 10 10 0 0 1 20 0z' fill='rgba(255,255,255,0.2)'/%3E%3C/svg%3E");
            animation: floatUp 30s linear infinite;
        }

        @keyframes gradientBG {
            0% { background-position: 0% 50%; }
            50% { background-position: 100% 50%; }
            100% { background-position: 0% 50%; }
        }

        @keyframes floatUp {
            0% { background-position: 0px 0px; }
            100% { background-position: 100px 1000px; }
        }

        .container {
            position: relative;
            z-index: 1;
            max-width: 800px;
            margin: 20px auto;
            padding: 0 15px;
        }

        header {
            text-align: center;
            background: rgba(255, 255, 255, 0.9);
            padding: 10px 20px;
            border-radius: 20px;
            box-shadow: 0 8px 0 rgba(0,0,0,0.1);
            margin-bottom: 30px;
            display: inline-block;
            left: 50%;
            transform: translateX(-50%);
            position: relative;
        }

        h2.teacher-name {
            font-size: 1.2rem;
            color: var(--primary);
            margin: 0;
            font-weight: 800;
        }

        .section-title {
            background: #fff;
            padding: 15px 25px;
            border-radius: 15px;
            box-shadow: 0 6px 0 rgba(0,0,0,0.1);
            margin-bottom: 20px;
            font-weight: 800;
            color: var(--primary);
            font-size: 1.3rem;
        }

        .card {
            background: rgba(255, 255, 255, 0.97);
            border-radius: 20px;
            box-shadow: 0 10px 0 rgba(0,0,0,0.1);
            padding: 25px;
            margin-bottom: 30px;
            transition: transform 0.2s;
        }

        .question-text {
            font-size: 1.2rem;
            font-weight: 700;
            margin-bottom: 20px;
            line-height: 1.5;
        }

        .options-grid {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 15px;
        }

        @media (max-width: 600px) {
            .options-grid { grid-template-columns: 1fr; }
        }

        .option-btn {
            background: var(--btn-bg);
            border: 2px solid #eee;
            border-radius: 15px;
            padding: 15px 20px;
            font-size: 1.1rem;
            font-weight: 700;
            color: var(--text-main);
            cursor: pointer;
            box-shadow: 0 6px 0 var(--btn-shadow);
            transition: all 0.1s ease;
            text-align: left;
            position: relative;
        }

        .option-btn:hover:not(:disabled) {
            transform: scale(1.02) translateY(-2px);
            box-shadow: 0 8px 0 var(--btn-shadow);
        }

        .option-btn:active:not(:disabled) {
            transform: translateY(4px);
            box-shadow: 0 2px 0 var(--btn-shadow);
        }

        .option-btn.correct {
            background: var(--correct);
            color: white;
            border-color: var(--correct);
            box-shadow: 0 6px 0 var(--correct-shadow);
        }

        .option-btn.wrong {
            background: var(--wrong);
            color: white;
            border-color: var(--wrong);
            box-shadow: 0 6px 0 var(--wrong-shadow);
        }

        .option-btn:disabled {
            cursor: not-allowed;
            opacity: 0.8;
        }

        /* Shake Animation */
        @keyframes shake {
            0%, 100% { transform: translateX(0); }
            20%, 60% { transform: translateX(-5px); }
            40%, 80% { transform: translateX(5px); }
        }
        .shake { animation: shake 0.4s ease-in-out; }

        /* Gi·∫£i th√≠ch */
        .explanation {
            display: none;
            margin-top: 20px;
            padding: 20px;
            background: #F3F4F6;
            border-left: 5px solid var(--accent);
            border-radius: 10px;
            font-size: 1rem;
            line-height: 1.6;
            animation: slideDown 0.3s ease-out;
        }

        .explanation h4 { margin-top: 0; color: var(--primary); }
        .explanation p { margin: 8px 0; }
        .expl-step { margin-bottom: 12px; }
        .expl-bold { font-weight: 800; color: #d35400; }

        @keyframes slideDown {
            from { opacity: 0; transform: translateY(-10px); }
            to { opacity: 1; transform: translateY(0); }
        }

        /* Gap Fill / Popup styling */
        .gap-fill-container {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(250px, 1fr));
            gap: 15px;
        }

        .gap-item {
            background: #fff;
            padding: 15px;
            border-radius: 15px;
            box-shadow: 0 6px 0 #eee;
            display: flex;
            align-items: center;
            justify-content: space-between;
            font-weight: 700;
        }

        .gap-btn {
            background: #f0f0f0;
            border: 2px dashed #ccc;
            padding: 8px 15px;
            border-radius: 10px;
            cursor: pointer;
            color: #666;
            transition: all 0.2s;
        }
        .gap-btn:hover { background: #e0e0e0; }
        .gap-btn.filled-correct { background: var(--correct); color: white; border: none; box-shadow: 0 4px 0 var(--correct-shadow);}
        .gap-btn.filled-wrong { background: var(--wrong); color: white; border: none; box-shadow: 0 4px 0 var(--wrong-shadow);}

        /* Popup Ch·ªçn T·ª´ */
        .modal-overlay {
            display: none;
            position: fixed;
            top: 0; left: 0; width: 100%; height: 100%;
            background: rgba(0,0,0,0.5);
            z-index: 1000;
            justify-content: center;
            align-items: center;
        }
        .modal-content {
            background: white;
            padding: 25px;
            border-radius: 20px;
            width: 90%;
            max-width: 400px;
            text-align: center;
            box-shadow: 0 10px 25px rgba(0,0,0,0.2);
        }
        .modal-options {
            display: flex;
            flex-direction: column;
            gap: 10px;
            margin-top: 15px;
        }
        .modal-options .option-btn { width: 100%; text-align: center; }

        .submit-btn {
            display: block;
            width: 100%;
            max-width: 300px;
            margin: 40px auto;
            padding: 20px;
            font-size: 1.5rem;
            font-weight: 900;
            background: #00C9A7;
            color: white;
            border: none;
            border-radius: 20px;
            box-shadow: 0 8px 0 #00967d;
            cursor: pointer;
            transition: all 0.2s;
        }
        .submit-btn:hover { transform: translateY(-3px); box-shadow: 0 11px 0 #00967d; }
        .submit-btn:active { transform: translateY(5px); box-shadow: 0 3px 0 #00967d; }

        canvas#confetti {
            position: fixed;
            top: 0; left: 0; width: 100%; height: 100%;
            pointer-events: none; z-index: 9999;
        }
    </style>
</head>
<body>

<div class="pattern-overlay"></div>
<canvas id="confetti"></canvas>

<div class="container">
    <header>
        <h2 class="teacher-name">üåü B√†i thi ti·∫øng Anh - Gi√°o vi√™n: Ms Mai An ULIS üåü</h2>
    </header>

    <div id="quiz-container">
        </div>

    <button class="submit-btn" onclick="submitQuiz()">N·ªôp b√†i ngay!</button>
</div>

<div class="modal-overlay" id="gapModal">
    <div class="modal-content">
        <h3 id="modal-title">Ch·ªçn t·ª´ ƒë√∫ng</h3>
        <div class="modal-options" id="modal-options"></div>
    </div>
</div>

<div class="modal-overlay" id="resultModal">
    <div class="modal-content">
        <h1 style="font-size: 3rem; margin: 10px 0;">üèÜ</h1>
        <h2 style="color: var(--primary);">Tuy·ªát v·ªùi! Ho√†n th√†nh xu·∫•t s·∫Øc!</h2>
        <h3 id="score-text" style="font-size: 1.5rem;">B·∫°n ƒë√∫ng 0/0 c√¢u</h3>
        <p id="praise-text" style="font-weight: bold; color: #e67e22;"></p>
        <button class="submit-btn" style="margin-top: 20px;" onclick="location.reload()">L√†m l·∫°i b√†i thi</button>
    </div>
</div>

<script>
    // --- 1. H·ªÜ TH·ªêNG √ÇM THANH (WEB AUDIO API) ---
    const AudioContext = window.AudioContext || window.webkitAudioContext;
    const audioCtx = new AudioContext();

    function playDing() {
        if(audioCtx.state === 'suspended') audioCtx.resume();
        const osc = audioCtx.createOscillator();
        const gain = audioCtx.createGain();
        osc.connect(gain); gain.connect(audioCtx.destination);
        osc.type = 'sine';
        osc.frequency.setValueAtTime(800, audioCtx.currentTime);
        osc.frequency.exponentialRampToValueAtTime(1500, audioCtx.currentTime + 0.1);
        gain.gain.setValueAtTime(0.5, audioCtx.currentTime);
        gain.gain.exponentialRampToValueAtTime(0.01, audioCtx.currentTime + 0.5);
        osc.start(); osc.stop(audioCtx.currentTime + 0.5);
    }

    function playBuzz() {
        if(audioCtx.state === 'suspended') audioCtx.resume();
        const osc = audioCtx.createOscillator();
        const gain = audioCtx.createGain();
        osc.connect(gain); gain.connect(audioCtx.destination);
        osc.type = 'sawtooth';
        osc.frequency.setValueAtTime(150, audioCtx.currentTime);
        osc.frequency.exponentialRampToValueAtTime(100, audioCtx.currentTime + 0.3);
        gain.gain.setValueAtTime(0.5, audioCtx.currentTime);
        gain.gain.exponentialRampToValueAtTime(0.01, audioCtx.currentTime + 0.3);
        osc.start(); osc.stop(audioCtx.currentTime + 0.3);
    }

    // --- 2. H·ªÜ TH·ªêNG PH√ÅO GI·∫§Y (CONFETTI) ---
    const canvas = document.getElementById('confetti');
    const ctx = canvas.getContext('2d');
    canvas.width = window.innerWidth; canvas.height = window.innerHeight;
    let particles = [];
    const colors = ['#8854C0', '#FDCB6E', '#00C9A7', '#FF4757', '#00D26A'];

    function triggerConfetti() {
        for(let i=0; i<50; i++) {
            particles.push({
                x: Math.random() * canvas.width, y: canvas.height + 10,
                r: Math.random() * 6 + 4, dx: Math.random() * 4 - 2, dy: Math.random() * -10 - 10,
                color: colors[Math.floor(Math.random() * colors.length)],
                tilt: Math.random() * 10
            });
        }
        animateConfetti();
    }
    function animateConfetti() {
        ctx.clearRect(0,0,canvas.width,canvas.height);
        let active = false;
        for(let i=0; i<particles.length; i++) {
            let p = particles[i];
            p.dy += 0.3; p.x += p.dx; p.y += p.dy; p.tilt += 0.1;
            ctx.beginPath(); ctx.lineWidth = p.r; ctx.strokeStyle = p.color;
            ctx.moveTo(p.x + p.tilt + p.r, p.y); ctx.lineTo(p.x + p.tilt, p.y + p.tilt + p.r); ctx.stroke();
            if(p.y < canvas.height + 20) active = true;
        }
        if(active) requestAnimationFrame(animateConfetti);
        else particles = [];
    }
    window.addEventListener('resize', () => { canvas.width = window.innerWidth; canvas.height = window.innerHeight; });

    // --- 3. TI·ªÜN √çCH ---
    function shuffleArray(array) {
        let curId = array.length, temp, randId;
        while (0 !== curId) {
            randId = Math.floor(Math.random() * curId); curId -= 1;
            temp = array[curId]; array[curId] = array[randId]; array[randId] = temp;
        }
        return array;
    }

    let score = 0;
    let totalQuestions = 0;

    // --- 4. D·ªÆ LI·ªÜU ƒê·ªÄ B√ÄI ---
    const data = [
        {
            section: "Exercise 1: Choose the word whose underlined part is pronounced differently from the others.",
            questions: [
                {
                    q: "1. A. mara<u>th</u>on B. thea<u>th</u>re C. bo<u>th</u> D. wea<u>th</u>er",
                    ans: "D",
                    options: [
                        {val: "A", text: "marathon"}, {val: "B", text: "theatre"}, {val: "C", text: "both"}, {val: "D", text: "weather"}
                    ],
                    expl: `
                        <div class="expl-step"><b>1. D·ªãch c√¢u h·ªèi:</b> Ch·ªçn t·ª´ c√≥ ph·∫ßn g·∫°ch ch√¢n ph√°t √¢m kh√°c v·ªõi c√°c t·ª´ c√≤n l·∫°i.</div>
                        <div class="expl-step"><b>2. Ph√¢n t√≠ch 4 ƒë√°p √°n:</b>
                            <br>- A. marathon /Ààm√¶r.…ô.<b>Œ∏</b>…ôn/ (n): cu·ªôc ƒëua marathon.
                            <br>- B. theatre /ÀàŒ∏…™…ô.t…ôr/ (n): nh√† h√°t (√¢m <b>Œ∏</b>).
                            <br>- C. both /b…ô ä<b>Œ∏</b>/ (pronoun): c·∫£ hai (√¢m <b>Œ∏</b>).
                            <br>- D. weather /Ààwe<b>√∞</b>.…ôr/ (n): th·ªùi ti·∫øt (√¢m <b>√∞</b>).
                        </div>
                        <div class="expl-step"><b>3. T·∫°i sao ch·ªçn D?</b> V√¨ ch·ªØ "th" trong weather ph√°t √¢m l√† √¢m h·ªØu thanh /√∞/, trong khi c√°c t·ª´ c√≤n l·∫°i l√† √¢m v√¥ thanh /Œ∏/.</div>
                        <div class="expl-step"><b>4. T·∫°i sao A, B, C sai?</b> V√¨ ch√∫ng ƒë·ªÅu chung m·ªôt c√°ch ph√°t √¢m l√† /Œ∏/.</div>`
                },
                {
                    q: "2. A. <u>th</u>is B. <u>th</u>ere C. <u>th</u>anks D. bro<u>th</u>er",
                    ans: "C",
                    options: [ {val: "A", text: "this"}, {val: "B", text: "there"}, {val: "C", text: "thanks"}, {val: "D", text: "brother"} ],
                    expl: `
                        <div class="expl-step"><b>1. D·ªãch c√¢u h·ªèi:</b> Ch·ªçn t·ª´ c√≥ ph·∫ßn g·∫°ch ch√¢n ph√°t √¢m kh√°c.</div>
                        <div class="expl-step"><b>2. Ph√¢n t√≠ch 4 ƒë√°p √°n:</b>
                            <br>- A. this /<b>√∞</b>…™s/ (pronoun): c√°i n√†y.
                            <br>- B. there /<b>√∞</b>e…ôr/ (adv): ·ªü ƒë√≥.
                            <br>- C. thanks /<b>Œ∏</b>√¶≈ãks/ (n): l·ªùi c·∫£m ∆°n.
                            <br>- D. brother /Ààbr å<b>√∞</b>.…ôr/ (n): anh/em trai.
                        </div>
                        <div class="expl-step"><b>3. T·∫°i sao ch·ªçn C?</b> "th" trong thanks ph√°t √¢m l√† √¢m v√¥ thanh /Œ∏/.</div>
                        <div class="expl-step"><b>4. T·∫°i sao A, B, D sai?</b> V√¨ ch√∫ng ƒë·ªÅu ph√°t √¢m l√† √¢m rung h·ªØu thanh /√∞/.</div>`
                },
                {
                    q: "3. A. cl<u>e</u>ver B. comp<u>e</u>te C. <u>e</u>ducate D. h<u>e</u>lpful",
                    ans: "B",
                    options: [ {val: "A", text: "clever"}, {val: "B", text: "compete"}, {val: "C", text: "educate"}, {val: "D", text: "helpful"} ],
                    expl: `
                        <div class="expl-step"><b>1. D·ªãch c√¢u h·ªèi:</b> Ch·ªçn t·ª´ c√≥ ch·ªØ "e" ph√°t √¢m kh√°c.</div>
                        <div class="expl-step"><b>2. Ph√¢n t√≠ch 4 ƒë√°p √°n:</b>
                            <br>- A. clever /Ààkl<b>e</b>v.…ôr/ (adj): th√¥ng minh.
                            <br>- B. compete /k…ômÀàp<b>iÀê</b>t/ (v): c·∫°nh tranh.
                            <br>- C. educate /Àà<b>e</b>d í.u.ke…™t/ (v): gi√°o d·ª•c.
                            <br>- D. helpful /Ààh<b>e</b>lp.f…ôl/ (adj): h·ªØu √≠ch.
                        </div>
                        <div class="expl-step"><b>3. T·∫°i sao ch·ªçn B?</b> Ch·ªØ "e" trong compete ph√°t √¢m l√† /iÀê/ (√¢m i d√†i).</div>
                        <div class="expl-step"><b>4. T·∫°i sao A, C, D sai?</b> V√¨ ch√∫ng ƒë·ªÅu ph√°t √¢m l√† /e/ (√¢m e ng·∫Øn).</div>`
                },
                {
                    q: "4. A. r<u>a</u>cket B. k<u>a</u>rate C. l<u>a</u>ndmark D. m<u>a</u>rket",
                    ans: "B",
                    options: [ {val: "A", text: "racket"}, {val: "B", text: "karate"}, {val: "C", text: "landmark"}, {val: "D", text: "market"} ],
                    expl: `
                        <div class="expl-step"><b>1. D·ªãch c√¢u h·ªèi:</b> Ch·ªçn t·ª´ c√≥ ch·ªØ "a" ph√°t √¢m kh√°c.</div>
                        <div class="expl-step"><b>2. Ph√¢n t√≠ch 4 ƒë√°p √°n:</b>
                            <br>- A. racket /Ààr<b>√¶</b>k.…™t/ (n): c√°i v·ª£t.
                            <br>- B. karate /k<b>…ô</b>Ààr…ëÀê.ti/ (n): m√¥n v√µ karate (√¢m ∆° ng·∫Øn).
                            <br>- C. landmark /Ààl<b>√¶</b>nd.m…ëÀêk/ (n): ƒë·ªãa danh n·ªïi b·∫≠t.
                            <br>- D. market /Ààm<b>…ëÀê</b>.k…™t/ (n): ch·ª£.
                        </div>
                        <div class="expl-step"><b>3. T·∫°i sao ch·ªçn B?</b> Ch·ªØ "a" ƒë·∫ßu ti√™n ƒë·ªçc l√† /…ô/ (√¢m schwa y·∫øu).</div>
                        <div class="expl-step"><b>4. T·∫°i sao A, C, D sai?</b> A v√† C l√† √¢m /√¶/, D l√† √¢m /…ë:/. B kh√°c bi·ªát ho√†n to√†n v√¨ n√≥ l√† √¢m kh√¥ng nh·∫•n tr·ªçng √¢m.</div>`
                },
                {
                    q: "5. A. pr<u>o</u>gramme B. d<u>o</u>lphin C. p<u>o</u>stcard D. pag<u>o</u>da",
                    ans: "B",
                    options: [ {val: "A", text: "programme"}, {val: "B", text: "dolphin"}, {val: "C", text: "postcard"}, {val: "D", text: "pagoda"} ],
                    expl: `
                        <div class="expl-step"><b>1. D·ªãch c√¢u h·ªèi:</b> Ch·ªçn t·ª´ c√≥ ch·ªØ "o" ph√°t √¢m kh√°c.</div>
                        <div class="expl-step"><b>2. Ph√¢n t√≠ch 4 ƒë√°p √°n:</b>
                            <br>- A. programme /Ààpr<b>…ô ä</b>.…°r√¶m/ (n): ch∆∞∆°ng tr√¨nh.
                            <br>- B. dolphin /Ààd<b>…í</b>l.f…™n/ (n): c√° heo.
                            <br>- C. postcard /Ààp<b>…ô ä</b>st.k…ëÀêd/ (n): b∆∞u thi·∫øp.
                            <br>- D. pagoda /p…ôÀà…°<b>…ô ä</b>.d…ô/ (n): ng√¥i ch√πa.
                        </div>
                        <div class="expl-step"><b>3. T·∫°i sao ch·ªçn B?</b> Ph√°t √¢m l√† /…í/ (o ng·∫Øn).</div>
                        <div class="expl-step"><b>4. T·∫°i sao A, C, D sai?</b> V√¨ ƒë·ªÅu ph√°t √¢m l√† √¢m ƒë√¥i /…ô ä/ (√¢u).</div>`
                },
                {
                    q: "6. A. badmint<u>o</u>n B. t<u>ow</u>n C. cr<u>ow</u>ded D. t<u>ow</u>er",
                    ans: "A",
                    options: [ {val: "A", text: "badminton"}, {val: "B", text: "town"}, {val: "C", text: "crowded"}, {val: "D", text: "tower"} ],
                    expl: `
                        <div class="expl-step"><b>1. D·ªãch c√¢u h·ªèi:</b> Ph·∫ßn n√†y ki·ªÉm tra √¢m /…ô/ so v·ªõi √¢m /a ä/.</div>
                        <div class="expl-step"><b>2. Ph√¢n t√≠ch 4 ƒë√°p √°n:</b>
                            <br>- A. badminton /Ààb√¶d.m…™n.t<b>…ô</b>n/ (n): m√¥n c·∫ßu l√¥ng.
                            <br>- B. town /t<b>a ä</b>n/ (n): th·ªã tr·∫•n.
                            <br>- C. crowded /Ààkr<b>a ä</b>.d…™d/ (adj): ƒë√¥ng ƒë√∫c.
                            <br>- D. tower /Ààt<b>a ä</b>.…ôr/ (n): ng·ªçn th√°p.
                        </div>
                        <div class="expl-step"><b>3. T·∫°i sao ch·ªçn A?</b> C√≥ √¢m /…ô/ kh√¥ng ph·∫£i √¢m /a ä/ nh∆∞ nh√≥m kia.</div>
                        <div class="expl-step"><b>4. T·∫°i sao B, C, D sai?</b> V√¨ ƒë·ªÅu ch·ª©a √¢m /a ä/ (ao).</div>`
                }
            ]
        },
        {
            section: "Exercise 2: Choose the words whose main stress is placed differently from the others.",
            questions: [
                {
                    q: "1. A. goggle B. cycling C. rainy D. cartoon",
                    ans: "D",
                    options: [ {val: "A", text: "goggle"}, {val: "B", text: "cycling"}, {val: "C", text: "rainy"}, {val: "D", text: "cartoon"} ],
                    expl: `
                        <div class="expl-step"><b>1. D·ªãch c√¢u h·ªèi:</b> Ch·ªçn t·ª´ c√≥ tr·ªçng √¢m ch√≠nh r∆°i v√†o v·ªã tr√≠ kh√°c.</div>
                        <div class="expl-step"><b>2. Ph√¢n t√≠ch:</b>
                            <br>- A. goggle /Àà…°…í…°.…ôl/ (nh·∫•n √¢m 1)
                            <br>- B. cycling /Ààsa…™.kl…™≈ã/ (nh·∫•n √¢m 1)
                            <br>- C. rainy /Ààre…™.ni/ (nh·∫•n √¢m 1)
                            <br>- D. cartoon /k…ëÀêÀàtuÀên/ (nh·∫•n √¢m 2 - t·∫≠n c√πng 'oon' th∆∞·ªùng nh·∫≠n tr·ªçng √¢m)
                        </div>
                        <div class="expl-step"><b>3. T·∫°i sao ch·ªçn D?</b> Tr·ªçng √¢m r∆°i v√†o √¢m ti·∫øt th·ª© 2.</div>
                        <div class="expl-step"><b>4. T·∫°i sao A, B, C sai?</b> Tr·ªçng √¢m r∆°i v√†o √¢m ti·∫øt th·ª© 1.</div>`
                },
                {
                    q: "2. A. delicious B. tournament C. equipment D. possessive",
                    ans: "B",
                    options: [ {val: "A", text: "delicious"}, {val: "B", text: "tournament"}, {val: "C", text: "equipment"}, {val: "D", text: "possessive"} ],
                    expl: `
                        <div class="expl-step"><b>1. Ph√¢n t√≠ch:</b>
                            <br>- A. delicious /d…™Ààl…™ É.…ôs/ (√¢m 2, t·∫≠n c√πng -ious nh·∫•n ngay tr∆∞·ªõc n√≥)
                            <br>- B. tournament /Ààt ä…ô.n…ô.m…ônt/ (√¢m 1)
                            <br>- C. equipment /…™Ààkw…™p.m…ônt/ (√¢m 2)
                            <br>- D. possessive /p…ôÀàzes.…™v/ (√¢m 2)
                        </div>
                        <div class="expl-step"><b>2. T·∫°i sao ch·ªçn B?</b> Tr·ªçng √¢m r∆°i v√†o √¢m 1. Ba ƒë√°p √°n kia r∆°i v√†o √¢m 2.</div>`
                },
                {
                    q: "3. A. education B. animated C. favorite D. marathon",
                    ans: "A",
                    options: [ {val: "A", text: "education"}, {val: "B", text: "animated"}, {val: "C", text: "favorite"}, {val: "D", text: "marathon"} ],
                    expl: `
                        <div class="expl-step"><b>1. Ph√¢n t√≠ch:</b>
                            <br>- A. education /Àåed í.uÀàke…™. É…ôn/ (√¢m 3, t·∫≠n c√πng -tion nh·∫•n ngay tr∆∞·ªõc n√≥)
                            <br>- B. animated /Àà√¶n.…™.me…™.t…™d/ (√¢m 1)
                            <br>- C. favorite /Ààfe…™.v…ôr.…™t/ (√¢m 1)
                            <br>- D. marathon /Ààm√¶r.…ô.Œ∏…ôn/ (√¢m 1)
                        </div>
                        <div class="expl-step"><b>2. T·∫°i sao ch·ªçn A?</b> Tr·ªçng √¢m r∆°i v√†o √¢m 3. C√°c t·ª´ c√≤n l·∫°i r∆°i v√†o √¢m 1.</div>`
                },
                {
                    q: "4. A. popular B. comedy C. champion D. exciting",
                    ans: "D",
                    options: [ {val: "A", text: "popular"}, {val: "B", text: "comedy"}, {val: "C", text: "champion"}, {val: "D", text: "exciting"} ],
                    expl: `
                        <div class="expl-step"><b>1. Ph√¢n t√≠ch:</b>
                            <br>- A. popular /Ààp…íp.j…ô.l…ôr/ (√¢m 1)
                            <br>- B. comedy /Ààk…ím.…ô.di/ (√¢m 1)
                            <br>- C. champion /Ààt É√¶m.pi.…ôn/ (√¢m 1)
                            <br>- D. exciting /…™kÀàsa…™.t…™≈ã/ (√¢m 2)
                        </div>
                        <div class="expl-step"><b>2. T·∫°i sao ch·ªçn D?</b> Tr·ªçng √¢m r∆°i v√†o √¢m 2.</div>`
                },
                {
                    q: "5. A. career B. famous C. palace D. tasty",
                    ans: "A",
                    options: [ {val: "A", text: "career"}, {val: "B", text: "famous"}, {val: "C", text: "palace"}, {val: "D", text: "tasty"} ],
                    expl: `
                        <div class="expl-step"><b>1. Ph√¢n t√≠ch:</b>
                            <br>- A. career /k…ôÀàr…™…ôr/ (√¢m 2, t·∫≠n c√πng -eer nh·∫≠n tr·ªçng √¢m)
                            <br>- B. famous /Ààfe…™.m…ôs/ (√¢m 1)
                            <br>- C. palace /Ààp√¶l.…™s/ (√¢m 1)
                            <br>- D. tasty /Ààte…™.sti/ (√¢m 1)
                        </div>
                        <div class="expl-step"><b>2. T·∫°i sao ch·ªçn A?</b> Tr·ªçng √¢m r∆°i v√†o √¢m 2.</div>`
                }
            ]
        },
        {
            section: "Exercise 3: Choose the correct answers.",
            questions: [
                {
                    q: "1. My favorite programme is ____ VTV3 every weekend.",
                    ans: "A",
                    options: [ {val: "A", text: "on"}, {val: "B", text: "in"}, {val: "C", text: "at"}, {val: "D", text: "about"} ],
                    expl: `
                        <div class="expl-step"><b>1. D·ªãch:</b> Ch∆∞∆°ng tr√¨nh y√™u th√≠ch c·ªßa t√¥i ƒë∆∞·ª£c chi·∫øu tr√™n k√™nh VTV3 m·ªói cu·ªëi tu·∫ßn.</div>
                        <div class="expl-step"><b>2. Ph√¢n t√≠ch:</b>
                            A. on (gi·ªõi t·ª´): tr√™n (k√™nh truy·ªÅn h√¨nh). B. in: trong. C. at: t·∫°i. D. about: v·ªÅ.
                        </div>
                        <div class="expl-step"><b>3. T·∫°i sao ch·ªçn A?</b> Quy t·∫Øc Collocation: Ta d√πng "on" ƒëi tr∆∞·ªõc t√™n k√™nh truy·ªÅn h√¨nh ho·∫∑c "TV" (on TV, on VTV3).</div>
                        <div class="expl-step"><b>4. T·∫°i sao sai?</b> C√°c gi·ªõi t·ª´ c√≤n l·∫°i kh√¥ng d√πng v·ªõi k√™nh truy·ªÅn h√¨nh.</div>`
                },
                {
                    q: "2. ____ anything here! It's a must.",
                    ans: "B",
                    options: [ {val: "A", text: "Not touch"}, {val: "B", text: "Don‚Äôt touch"}, {val: "C", text: "No touching"}, {val: "D", text: "Touch"} ],
                    expl: `
                        <div class="expl-step"><b>1. D·ªãch:</b> ƒê·ª´ng ch·∫°m v√†o b·∫•t c·ª© th·ª© g√¨ ·ªü ƒë√¢y! ƒê√≥ l√† quy ƒë·ªãnh b·∫Øt bu·ªôc.</div>
                        <div class="expl-step"><b>2. T·∫°i sao ch·ªçn B?</b> ƒê√¢y l√† c√¢u m·ªánh l·ªánh ph·ªß ƒë·ªãnh (Negative Imperative), c·∫•u tr√∫c l√† "Don't + V_nguy√™n th·ªÉ".</div>
                        <div class="expl-step"><b>3. T·∫°i sao sai?</b> A sai ng·ªØ ph√°p. C ("No touching") th∆∞·ªùng d√πng tr√™n bi·ªÉn b√°o ch·ªØ ng·∫Øn, nh∆∞ng x√©t trong c√¢u c√≥ ch·ªß-v·ªã ho√†n ch·ªânh ƒë·∫±ng sau "It's a must", B h·ª£p vƒÉn c·∫£nh h∆°n. D mang nghƒ©a kh·∫≥ng ƒë·ªãnh (h√£y ch·∫°m v√†o), sai nghƒ©a.</div>`
                },
                {
                    q: "3. The programme for children should be both funny and ____.",
                    ans: "C",
                    options: [ {val: "A", text: "horror"}, {val: "B", text: "frightening"}, {val: "C", text: "educational"}, {val: "D", text: "boring"} ],
                    expl: `
                        <div class="expl-step"><b>1. D·ªãch:</b> Ch∆∞∆°ng tr√¨nh cho tr·∫ª em n√™n v·ª´a vui nh·ªôn v·ª´a mang t√≠nh gi√°o d·ª•c.</div>
                        <div class="expl-step"><b>2. Ph√¢n t√≠ch:</b> A. horror (n): kinh d·ªã. B. frightening (adj): ƒë√°ng s·ª£. C. educational (adj): mang t√≠nh gi√°o d·ª•c. D. boring (adj): nh√†m ch√°n.</div>
                        <div class="expl-step"><b>3. T·∫°i sao ch·ªçn C?</b> Li√™n t·ª´ "and" n·ªëi 2 t√≠nh t·ª´ mang √Ω nghƒ©a t∆∞∆°ng ƒë∆∞∆°ng/b·ªï tr·ª£. "Funny" (t√≠ch c·ª±c) n√™n t·ª´ sau c≈©ng ph·∫£i t√≠ch c·ª±c -> C.</div>
                        <div class="expl-step"><b>4. T·∫°i sao sai?</b> A, B, D ƒë·ªÅu mang nghƒ©a ti√™u c·ª±c, kh√¥ng ph√π h·ª£p cho tr·∫ª em.</div>`
                },
                {
                    q: "4. ____ do you watch T.V? ‚Äî Every evening.",
                    ans: "D",
                    options: [ {val: "A", text: "What"}, {val: "B", text: "How long"}, {val: "C", text: "What time"}, {val: "D", text: "How often"} ],
                    expl: `
                        <div class="expl-step"><b>1. D·ªãch:</b> B·∫°n c√≥ th∆∞·ªùng xuy√™n xem TV kh√¥ng? - M·ªói bu·ªïi t·ªëi.</div>
                        <div class="expl-step"><b>2. T·∫°i sao ch·ªçn D?</b> C√¢u tr·∫£ l·ªùi "Every evening" (M·ªói t·ªëi) ch·ªâ t·∫ßn su·∫•t. T·ª´ ƒë·ªÉ h·ªèi t·∫ßn su·∫•t l√† "How often".</div>
                        <div class="expl-step"><b>3. T·∫°i sao sai?</b> What (c√°i g√¨), How long (bao l√¢u - h·ªèi kho·∫£ng th·ªùi gian), What time (m·∫•y gi·ªù - h·ªèi gi·ªù c·ª• th·ªÉ) kh√¥ng kh·ªõp v·ªõi c√¢u tr·∫£ l·ªùi.</div>`
                },
                {
                    q: "5. ____ character do you like most in this cartoon?",
                    ans: "B",
                    options: [ {val: "A", text: "Who"}, {val: "B", text: "Which"}, {val: "C", text: "How many"}, {val: "D", text: "How"} ],
                    expl: `
                        <div class="expl-step"><b>1. D·ªãch:</b> B·∫°n th√≠ch nh√¢n v·∫≠t N√ÄO nh·∫•t trong b·ªô phim ho·∫°t h√¨nh n√†y?</div>
                        <div class="expl-step"><b>2. T·∫°i sao ch·ªçn B?</b> "Which + Noun" d√πng ƒë·ªÉ h·ªèi s·ª± l·ª±a ch·ªçn gi·ªØa nh·ªØng th·ª©/ng∆∞·ªùi c·ª• th·ªÉ (nh√¢n v·∫≠t n√†o).</div>
                        <div class="expl-step"><b>3. T·∫°i sao sai?</b> Who kh√¥ng ƒëi li·ªÅn v·ªõi danh t·ª´ (Who character -> sai c·∫•u tr√∫c). How many h·ªèi s·ªë l∆∞·ª£ng. How h·ªèi nh∆∞ th·∫ø n√†o.</div>`
                },
                {
                    q: "6. I enjoy doing sports, ____ my brother just likes staying at home.",
                    ans: "A",
                    options: [ {val: "A", text: "but"}, {val: "B", text: "and"}, {val: "C", text: "so"}, {val: "D", text: "however"} ],
                    expl: `
                        <div class="expl-step"><b>1. D·ªãch:</b> T√¥i th√≠ch ch∆°i th·ªÉ thao, NH∆ØNG anh trai t√¥i ch·ªâ th√≠ch ·ªü nh√†.</div>
                        <div class="expl-step"><b>2. T·∫°i sao ch·ªçn A?</b> 2 v·∫ø c√¢u mang √Ω nghƒ©a t∆∞∆°ng ph·∫£n (ch∆°i th·ªÉ thao >< ·ªü nh√†). D√πng li√™n t·ª´ "but" (nh∆∞ng).</div>
                        <div class="expl-step"><b>3. T·∫°i sao sai?</b> "however" c≈©ng nghƒ©a l√† "tuy nhi√™n" nh∆∞ng c√°ch d√πng d·∫•u c√¢u sai (ph·∫£i l√† ; however, ). and (v√†), so (v√¨ v·∫≠y) sai nghƒ©a.</div>`
                },
                {
                    q: "7. She quickly returns home after work, ____ she can watch her favorite film.",
                    ans: "D",
                    options: [ {val: "A", text: "although"}, {val: "B", text: "but"}, {val: "C", text: "because"}, {val: "D", text: "so"} ],
                    expl: `
                        <div class="expl-step"><b>1. D·ªãch:</b> C√¥ ·∫•y v·ªÅ nh√† nhanh ch√≥ng sau gi·ªù l√†m, V√å V·∫¨Y c√¥ ·∫•y c√≥ th·ªÉ xem b·ªô phim y√™u th√≠ch.</div>
                        <div class="expl-step"><b>2. T·∫°i sao ch·ªçn D?</b> V·∫ø sau ch·ªâ k·∫øt qu·∫£ c·ªßa h√†nh ƒë·ªông v·∫ø tr∆∞·ªõc -> D√πng "so" (v√¨ v·∫≠y / ƒë·ªÉ m√† - ƒë√¥i khi d√πng thay cho so that trong vƒÉn n√≥i).</div>
                        <div class="expl-step"><b>3. T·∫°i sao sai?</b> although (m·∫∑c d√π), but (nh∆∞ng), because (b·ªüi v√¨) r√°p v√†o nghƒ©a s·∫Ω b·ªã ng∆∞·ª£c logic.</div>`
                },
                {
                    q: "8. That film is shown on a special ____ for children.",
                    ans: "A",
                    options: [ {val: "A", text: "channel"}, {val: "B", text: "character"}, {val: "C", text: "favorite"}, {val: "D", text: "TV guide"} ],
                    expl: `
                        <div class="expl-step"><b>1. D·ªãch:</b> B·ªô phim ƒë√≥ ƒë∆∞·ª£c chi·∫øu tr√™n m·ªôt K√äNH ƒë·∫∑c bi·ªát d√†nh cho tr·∫ª em.</div>
                        <div class="expl-step"><b>2. T·∫°i sao ch·ªçn A?</b> Phim ƒë∆∞·ª£c chi·∫øu (shown) tr√™n k√™nh truy·ªÅn h√¨nh -> channel (n): k√™nh.</div>
                        <div class="expl-step"><b>3. T·∫°i sao sai?</b> character (nh√¢n v·∫≠t), favorite (y√™u th√≠ch), TV guide (l·ªãch ph√°t s√≥ng) kh√¥ng h·ª£p logic vƒÉn c·∫£nh.</div>`
                },
                {
                    q: "9. Mary loves watching ____ because she loves discovering about animals.",
                    ans: "B",
                    options: [ {val: "A", text: "animated films"}, {val: "B", text: "wildlife"}, {val: "C", text: "comedies"}, {val: "D", text: "game shows"} ],
                    expl: `
                        <div class="expl-step"><b>1. D·ªãch:</b> Mary th√≠ch xem ch∆∞∆°ng tr√¨nh th·∫ø gi·ªõi ƒë·ªông v·∫≠t v√¨ c√¥ ·∫•y y√™u th√≠ch vi·ªác kh√°m ph√° v·ªÅ c√°c lo√†i ƒë·ªông v·∫≠t.</div>
                        <div class="expl-step"><b>2. T·∫°i sao ch·ªçn B?</b> Keyword: "animals" (ƒë·ªông v·∫≠t). Kh·ªõp v·ªõi "wildlife" (th·∫ø gi·ªõi hoang d√£/ƒë·ªông v·∫≠t).</div>
                        <div class="expl-step"><b>3. T·∫°i sao sai?</b> animated films (phim ho·∫°t h√¨nh), comedies (phim h√†i), game shows (tr√≤ ch∆°i truy·ªÅn h√¨nh) kh√¥ng li√™n quan ƒë·∫øn kh√°m ph√° ƒë·ªông v·∫≠t.</div>`
                },
                {
                    q: "10. You should prepare ____ before joining a badminton club.",
                    ans: "A",
                    options: [ {val: "A", text: "a racket"}, {val: "B", text: "a ball"}, {val: "C", text: "goggles"}, {val: "D", text: "boat"} ],
                    expl: `
                        <div class="expl-step"><b>1. D·ªãch:</b> B·∫°n n√™n chu·∫©n b·ªã m·ªôt C√ÇY V·ª¢T tr∆∞·ªõc khi tham gia c√¢u l·∫°c b·ªô c·∫ßu l√¥ng.</div>
                        <div class="expl-step"><b>2. T·∫°i sao ch·ªçn A?</b> Keyword "badminton" (c·∫ßu l√¥ng). Ch∆°i c·∫ßu l√¥ng c·∫ßn "racket" (c√¢y v·ª£t).</div>
                        <div class="expl-step"><b>3. T·∫°i sao sai?</b> ball (qu·∫£ b√≥ng - d√πng cho b√≥ng ƒë√°/tennis), goggles (k√≠nh b∆°i), boat (thuy·ªÅn) kh√¥ng d√πng cho c·∫ßu l√¥ng.</div>`
                },
                {
                    q: "11. Pel√© scored more than a thousand ____ in his career.",
                    ans: "A",
                    options: [ {val: "A", text: "goals"}, {val: "B", text: "balls"}, {val: "C", text: "winners"}, {val: "D", text: "champions"} ],
                    expl: `
                        <div class="expl-step"><b>1. D·ªãch:</b> Pel√© ƒë√£ ghi h∆°n m·ªôt ng√†n B√ÄN TH·∫ÆNG trong s·ª± nghi·ªáp c·ªßa √¥ng ·∫•y.</div>
                        <div class="expl-step"><b>2. T·∫°i sao ch·ªçn A?</b> C·ª•m t·ª´ c·ªë ƒë·ªãnh (Collocation): "score a goal" (ghi b√†n). S·ªë nhi·ªÅu l√† "goals".</div>
                        <div class="expl-step"><b>3. T·∫°i sao sai?</b> Kh√¥ng ai n√≥i "score balls/winners/champions".</div>`
                },
                {
                    q: "12. ____ so lazy! ____ more exercise!",
                    ans: "C",
                    options: [ {val: "A", text: "Be/ Do"}, {val: "B", text: "Be/ Don‚Äôt do"}, {val: "C", text: "Don‚Äôt be/ Do"}, {val: "D", text: "Don‚Äôt be/ Don‚Äôt do"} ],
                    expl: `
                        <div class="expl-step"><b>1. D·ªãch:</b> ƒê·ª™NG L∆Ø·ªúI BI·∫æNG nh∆∞ v·∫≠y! H√ÉY T·∫¨P th·ªÉ d·ª•c nhi·ªÅu h∆°n!</div>
                        <div class="expl-step"><b>2. T·∫°i sao ch·ªçn C?</b> C√¢u m·ªánh l·ªánh. V·∫ø 1 khuy√™n kh√¥ng n√™n l∆∞·ªùi (Don't be). V·∫ø 2 khuy√™n n√™n l√†m (Do). Kh·ªõp v·ªõi ƒë√°p √°n C.</div>`
                },
                {
                    q: "13. My father didn't come home ____. He had to go on duty.",
                    ans: "D",
                    options: [ {val: "A", text: "tomorrow"}, {val: "B", text: "every day"}, {val: "C", text: "now"}, {val: "D", text: "yesterday"} ],
                    expl: `
                        <div class="expl-step"><b>1. D·ªãch:</b> B·ªë t√¥i ƒë√£ kh√¥ng v·ªÅ nh√† H√îM QUA. √îng ·∫•y ph·∫£i ƒëi tr·ª±c.</div>
                        <div class="expl-step"><b>2. T·∫°i sao ch·ªçn D?</b> D·∫•u hi·ªáu nh·∫≠n bi·∫øt: "didn't come" (Qu√° kh·ª© ƒë∆°n). Tr·∫°ng t·ª´ th·ªùi gian duy nh·∫•t ·ªü qu√° kh·ª© l√† "yesterday".</div>`
                },
                {
                    q: "14. They are from Sydney. Sydney Opera House is a landmark in ____ city.",
                    ans: "B",
                    options: [ {val: "A", text: "they"}, {val: "B", text: "their"}, {val: "C", text: "theirs"}, {val: "D", text: "them"} ],
                    expl: `
                        <div class="expl-step"><b>1. D·ªãch:</b> H·ªç ƒë·∫øn t·ª´ Sydney. Nh√† h√°t Opera Sydney l√† m·ªôt bi·ªÉu t∆∞·ª£ng ·ªü th√†nh ph·ªë C·ª¶A H·ªå.</div>
                        <div class="expl-step"><b>2. T·∫°i sao ch·ªçn B?</b> C·∫ßn m·ªôt t√≠nh t·ª´ s·ªü h·ªØu ƒë·ª©ng tr∆∞·ªõc danh t·ª´ "city". "Their" + Noun = C·ªßa h·ªç.</div>
                        <div class="expl-step"><b>3. T·∫°i sao sai?</b> they (ch·ªß ng·ªØ), theirs (ƒë·∫°i t·ª´ s·ªü h·ªØu - ƒë·ª©ng m·ªôt m√¨nh), them (t√¢n ng·ªØ).</div>`
                },
                {
                    q: "15. ____ house is not as big as ____.",
                    ans: "C",
                    options: [ {val: "A", text: "My/ your"}, {val: "B", text: "Mine/ your"}, {val: "C", text: "My/ yours"}, {val: "D", text: "Mine/ yours"} ],
                    expl: `
                        <div class="expl-step"><b>1. D·ªãch:</b> Ng√¥i nh√† C·ª¶A T√îI kh√¥ng to b·∫±ng NG√îI NH√Ä C·ª¶A B·∫†N.</div>
                        <div class="expl-step"><b>2. T·∫°i sao ch·ªçn C?</b> V·ªã tr√≠ 1: tr∆∞·ªõc danh t·ª´ "house" c·∫ßn t√≠nh t·ª´ s·ªü h·ªØu (My). V·ªã tr√≠ 2: ƒê·ª©ng m·ªôt m√¨nh cu·ªëi c√¢u thay th·∫ø cho "your house", c·∫ßn ƒê·∫°i t·ª´ s·ªü h·ªØu (yours). -> My / yours.</div>`
                },
                {
                    q: "16. A ____ is a place where goods are sold from boats.",
                    ans: "D",
                    options: [ {val: "A", text: "stall"}, {val: "B", text: "palace"}, {val: "C", text: "supermarket"}, {val: "D", text: "floating market"} ],
                    expl: `
                        <div class="expl-step"><b>1. D·ªãch:</b> Ch·ª£ n·ªïi l√† n∆°i h√†ng h√≥a ƒë∆∞·ª£c b√°n t·ª´ c√°c con thuy·ªÅn.</div>
                        <div class="expl-step"><b>2. T·∫°i sao ch·ªçn D?</b> Keyword "sold from boats" (b√°n t·ª´ thuy·ªÅn) ƒë·ªãnh nghƒ©a ch√≠nh x√°c t·ª´ "floating market" (ch·ª£ n·ªïi).</div>`
                },
                {
                    q: "17. Hanoi is famous ____ many types of delicious street food.",
                    ans: "D",
                    options: [ {val: "A", text: "at"}, {val: "B", text: "in"}, {val: "C", text: "about"}, {val: "D", text: "for"} ],
                    expl: `
                        <div class="expl-step"><b>1. D·ªãch:</b> H√† N·ªôi n·ªïi ti·∫øng v·ªÅ nhi·ªÅu lo·∫°i th·ª©c ƒÉn ƒë∆∞·ªùng ph·ªë ngon.</div>
                        <div class="expl-step"><b>2. T·∫°i sao ch·ªçn D?</b> Collocation (C·ª•m t·ª´ c·ªë ƒë·ªãnh): "famous for" = n·ªïi ti·∫øng v·ªÅ c√°i g√¨ ƒë√≥.</div>`
                },
                {
                    q: "18. People said that it is ____ during summer here.",
                    ans: "C",
                    options: [ {val: "A", text: "tasty"}, {val: "B", text: "friendly"}, {val: "C", text: "rainy"}, {val: "D", text: "beautifully"} ],
                    expl: `
                        <div class="expl-step"><b>1. D·ªãch:</b> M·ªçi ng∆∞·ªùi n√≥i r·∫±ng tr·ªùi th∆∞·ªùng M∆ØA v√†o m√πa h√® ·ªü ƒë√¢y.</div>
                        <div class="expl-step"><b>2. T·∫°i sao ch·ªçn C?</b> Ch·ªß ng·ªØ "it" n√≥i v·ªÅ th·ªùi ti·∫øt (it is rainy). C√°c t√≠nh t·ª´ tasty (ngon), friendly (th√¢n thi·ªán) kh√¥ng d√πng ch·ªâ th·ªùi ti·∫øt. beautifully l√† tr·∫°ng t·ª´ sai ng·ªØ ph√°p sau "is".</div>`
                },
                {
                    q: "19. One of the most famous landmarks of London is ____.",
                    ans: "B",
                    options: [ {val: "A", text: "Opera House"}, {val: "B", text: "Big Ben Tower"}, {val: "C", text: "One Pillar Pagoda"}, {val: "D", text: "the Statue of Liberty"} ],
                    expl: `
                        <div class="expl-step"><b>1. D·ªãch:</b> M·ªôt trong nh·ªØng ƒë·ªãa danh n·ªïi ti·∫øng nh·∫•t c·ªßa London l√† Th√°p ƒë·ªìng h·ªì Big Ben.</div>
                        <div class="expl-step"><b>2. T·∫°i sao ch·ªçn B?</b> Ki·∫øn th·ª©c th·ª±c t·∫ø: Big Ben n·∫±m ·ªü London (Anh). Opera House (√öc), One Pillar Pagoda (Ch√πa M·ªôt C·ªôt - Vi·ªát Nam), Statue of Liberty (T∆∞·ª£ng N·ªØ th·∫ßn t·ª± do - M·ªπ).</div>`
                },
                {
                    q: "20. Although he tried his best, he ____ the competition yesterday.",
                    ans: "C",
                    options: [ {val: "A", text: "doesn‚Äôt win"}, {val: "B", text: "didn‚Äôt won"}, {val: "C", text: "didn‚Äôt win"}, {val: "D", text: "won"} ],
                    expl: `
                        <div class="expl-step"><b>1. D·ªãch:</b> D√π anh ·∫•y ƒë√£ c·ªë g·∫Øng h·∫øt s·ª©c, anh ·∫•y ƒê√É KH√îNG TH·∫ÆNG cu·ªôc thi ng√†y h√¥m qua.</div>
                        <div class="expl-step"><b>2. T·∫°i sao ch·ªçn C?</b> "yesterday" -> Qu√° kh·ª© ƒë∆°n. D·∫°ng ph·ªß ƒë·ªãnh l√† "didn't + V_nguy√™n th·ªÉ" -> didn't win.</div>
                        <div class="expl-step"><b>3. T·∫°i sao sai?</b> A sai th√¨. B sai ng·ªØ ph√°p (ƒë√£ m∆∞·ª£n tr·ª£ ƒë·ªông t·ª´ didn't th√¨ ƒë·ªông t·ª´ win kh√¥ng chia qu√° kh·ª© n·ªØa). D sai nghƒ©a (v√¨ c√≥ Although mang nghƒ©a t∆∞∆°ng ph·∫£n).</div>`
                }
            ]
        }
    ];

    // D·ªØ li·ªáu cho b√†i ƒëi·ªÅn t·ª´ (Exercise 4)
    const gapFillData = [
        { inf: "go", ans: "went", wrong: ["goed", "gone", "going"] },
        { inf: "see", ans: "saw", wrong: ["seed", "seen", "seeing"] },
        { inf: "tell", ans: "told", wrong: ["telled", "tolled", "telling"] },
        { inf: "study", ans: "studied", wrong: ["studyed", "studien", "studying"] },
        { inf: "draw", ans: "drew", wrong: ["drawed", "drawn", "drawing"] },
        { inf: "work", ans: "worked", wrong: ["wrought", "worken", "working"] },
        { inf: "enjoy", ans: "enjoyed", wrong: ["enjoyd", "enjoi", "enjoying"] },
        { inf: "buy", ans: "bought", wrong: ["buyed", "boughted", "buy"] },
        { inf: "begin", ans: "began", wrong: ["begun", "begined", "beginned"] },
        { inf: "drive", ans: "drove", wrong: ["drived", "driven", "droved"] },
        { inf: "ask", ans: "asked", wrong: ["askt", "ask", "asking"] },
        { inf: "run", ans: "ran", wrong: ["runned", "run", "running"] },
        { inf: "get", ans: "got", wrong: ["gotten", "getted", "gat"] },
        { inf: "eat", ans: "ate", wrong: ["eated", "eaten", "eat"] },
        { inf: "use", ans: "used", wrong: ["use", "usen", "using"] },
        { inf: "come", ans: "came", wrong: ["comed", "come", "coming"] },
        { inf: "meet", ans: "met", wrong: ["meeted", "meet", "meeting"] },
        { inf: "travel", ans: "travelled", wrong: ["travel", "travelen", "traveling"] },
        { inf: "write", ans: "wrote", wrong: ["writed", "written", "write"] },
        { inf: "feel", ans: "felt", wrong: ["feeled", "feelt", "feeling"] }
    ];

    let currentGapBtn = null;
    let currentGapWord = null;

    // --- 5. RENDER GIAO DI·ªÜN ---
    const quizContainer = document.getElementById('quiz-container');
    let qCounter = 0;

    data.forEach(sec => {
        const secDiv = document.createElement('div');
        secDiv.innerHTML = `<div class="section-title">${sec.section}</div>`;
        
        sec.questions.forEach((qObj) => {
            totalQuestions++;
            const qId = `q_${qCounter++}`;
            const card = document.createElement('div');
            card.className = 'card';
            
            const qText = document.createElement('div');
            qText.className = 'question-text';
            qText.innerHTML = qObj.q;
            card.appendChild(qText);

            const optionsGrid = document.createElement('div');
            optionsGrid.className = 'options-grid';

            // ƒê·∫£o ƒë√°p √°n ng·∫´u nhi√™n tr∆∞·ªõc khi render
            let shuffledOptions = shuffleArray([...qObj.options]);

            shuffledOptions.forEach(opt => {
                const btn = document.createElement('button');
                btn.className = 'option-btn';
                let cleanText = opt.text.replace(/^[A-D]\.\s*/, '');
                btn.innerHTML = cleanText; 
                
                // ƒê√°nh d·∫•u ng·∫ßm ƒë√°p √°n ƒë√∫ng
                if (opt.val === qObj.ans) {
                    btn.dataset.correct = "true";
                }

                btn.onclick = () => handleAnswer(btn, optionsGrid, opt.val === qObj.ans, qObj.expl, card);
                optionsGrid.appendChild(btn);
            });

            card.appendChild(optionsGrid);

            // Khung gi·∫£i th√≠ch
            const explDiv = document.createElement('div');
            explDiv.className = 'explanation';
            card.appendChild(explDiv);

            secDiv.appendChild(card);
        });
        quizContainer.appendChild(secDiv);
    });

    // RENDER Exercise 4 (Gap Fill - Popup Style)
    const ex4Div = document.createElement('div');
    ex4Div.innerHTML = `<div class="section-title">Exercise 4: Change the verbs into Past Simple form. (B·∫•m v√†o n√∫t ƒë·ªÉ ch·ªçn ƒë√°p √°n)</div>`;
    const gapContainer = document.createElement('div');
    gapContainer.className = 'gap-fill-container';

    gapFillData.forEach((item, index) => {
        totalQuestions++;
        const gapItem = document.createElement('div');
        gapItem.className = 'gap-item';
        
        const label = document.createElement('span');
        label.innerText = `${index + 1}. ${item.inf} ‚ûî `;
        
        const btn = document.createElement('button');
        btn.className = 'gap-btn';
        btn.innerText = "[ Ch·ªçn t·ª´ ]";
        
        btn.onclick = () => openGapModal(btn, item);
        
        gapItem.appendChild(label);
        gapItem.appendChild(btn);
        
        // Khung gi·∫£i th√≠ch nh·ªè n·∫±m trong gapItem
        const explDiv = document.createElement('div');
        explDiv.className = 'explanation';
        explDiv.style.gridColumn = "1 / -1";
        explDiv.style.marginTop = "10px";
        explDiv.id = `expl_gap_${index}`;

        // B·ªçc v√†o m·ªôt wrapper ƒë·ªÉ gi·ªØ b·ªë c·ª•c
        const wrapper = document.createElement('div');
        wrapper.style.display = 'flex';
        wrapper.style.flexDirection = 'column';
        wrapper.appendChild(gapItem);
        wrapper.appendChild(explDiv);

        gapContainer.appendChild(wrapper);
    });
    ex4Div.appendChild(gapContainer);
    quizContainer.appendChild(ex4Div);

    // --- 6. LOGIC X·ª¨ L√ù TR·∫ÆC NGHI·ªÜM ƒê√É C·∫¨P NH·∫¨T ---
    function handleAnswer(btn, grid, isCorrect, explHTML, cardDiv) {
        // Kh√≥a t·∫•t c·∫£ n√∫t
        const buttons = grid.querySelectorAll('.option-btn');
        buttons.forEach(b => b.disabled = true);

        const explDiv = cardDiv.querySelector('.explanation');
        explDiv.innerHTML = `<h4>üí° Gi·∫£i th√≠ch chi ti·∫øt:</h4>${explHTML}`;

        if (isCorrect) {
            btn.classList.add('correct');
            playDing();
            triggerConfetti();
            score++;
        } else {
            // N√∫t v·ª´a ch·ªçn sai -> Chuy·ªÉn m√†u ƒë·ªè v√† rung l·∫Øc
            btn.classList.add('wrong');
            cardDiv.classList.add('shake');
            playBuzz();
            setTimeout(() => cardDiv.classList.remove('shake'), 400);
            
            // T√¨m ƒë√°p √°n ƒë√∫ng ng·∫ßm ƒë·ªãnh v√† b√¥i m√†u xanh
            const correctBtn = grid.querySelector('[data-correct="true"]');
            if (correctBtn) {
                correctBtn.classList.add('correct');
            }
        }
        
        explDiv.style.display = 'block';
    }

    // --- 7. LOGIC X·ª¨ L√ù GAP FILL (POPUP) ---
    const modal = document.getElementById('gapModal');
    const modalOptions = document.getElementById('modal-options');
    const modalTitle = document.getElementById('modal-title');

    function openGapModal(btnElement, wordData) {
        if(btnElement.disabled) return;
        currentGapBtn = btnElement;
        currentGapWord = wordData;
        
        modalTitle.innerText = `Qu√° kh·ª© c·ªßa "${wordData.inf}" l√† g√¨?`;
        modalOptions.innerHTML = '';
        
        let opts = shuffleArray([wordData.ans, ...wordData.wrong]);
        
        opts.forEach(opt => {
            const optBtn = document.createElement('button');
            optBtn.className = 'option-btn';
            optBtn.innerText = opt;
            optBtn.onclick = () => selectGapAnswer(opt, wordData.ans);
            modalOptions.appendChild(optBtn);
        });
        
        modal.style.display = 'flex';
    }

    function selectGapAnswer(selected, correctAns) {
        modal.style.display = 'none';
        currentGapBtn.innerText = selected;
        currentGapBtn.disabled = true;

        // T√¨m explDiv g·∫ßn nh·∫•t
        const wrapper = currentGapBtn.closest('div').parentElement;
        const explDiv = wrapper.querySelector('.explanation');

        explDiv.innerHTML = `
            <div class="expl-step"><b>üí° Gi·∫£i th√≠ch:</b> ƒê·ªông t·ª´ nguy√™n th·ªÉ l√† <b>${currentGapWord.inf}</b>. D·∫°ng qu√° kh·ª© ƒë∆°n (Past Simple) c·ªßa n√≥ l√† <b>${correctAns}</b>.</div>
        `;

        if(selected === correctAns) {
            currentGapBtn.classList.add('filled-correct');
            playDing();
            triggerConfetti();
            score++;
        } else {
            currentGapBtn.classList.add('filled-wrong');
            currentGapBtn.closest('.gap-item').classList.add('shake');
            playBuzz();
            setTimeout(() => currentGapBtn.closest('.gap-item').classList.remove('shake'), 400);
            explDiv.innerHTML += `<div class="expl-step" style="color:red;">L∆∞u √Ω: "${selected}" l√† d·∫°ng sai. Nh·ªõ h·ªçc thu·ªôc b·∫£ng ƒë·ªông t·ª´ b·∫•t quy t·∫Øc nh√©!</div>`;
        }
        explDiv.style.display = 'block';
    }

    // ƒê√≥ng modal khi b·∫•m ra ngo√†i
    window.onclick = function(event) {
        if (event.target == modal) {
            modal.style.display = "none";
        }
    }

    // --- 8. T·ªîNG K·∫æT N·ªòP B√ÄI ---
    function submitQuiz() {
        const resultModal = document.getElementById('resultModal');
        const scoreText = document.getElementById('score-text');
        const praiseText = document.getElementById('praise-text');

        scoreText.innerText = `B·∫°n ƒë√£ ƒë√∫ng ${score} / ${totalQuestions} c√¢u!`;
        
        let ratio = score / totalQuestions;
        let praises = [
            "Xu·∫•t s·∫Øc! C√¥ Mai An r·∫•t t·ª± h√†o v·ªÅ b·∫°n! üåü",
            "Gi·ªèi l·∫Øm! B·∫°n ƒë√£ r·∫•t c·ªë g·∫Øng! üéâ",
            "C·∫ßn √¥n t·∫≠p th√™m m·ªôt ch√∫t nh√©, c√¥ tin b·∫°n s·∫Ω l√†m t·ªët h∆°n! üí™"
        ];

        if (ratio > 0.8) praiseText.innerText = praises[0];
        else if (ratio >= 0.5) praiseText.innerText = praises[1];
        else praiseText.innerText = praises[2];

        resultModal.style.display = 'flex';
        triggerConfetti();
        playDing();
    }
</script>
</body>
</html>