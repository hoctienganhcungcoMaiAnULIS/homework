<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Unit 7: Environmental Protection - Ms Mai An ULIS</title>
    <link href="https://fonts.googleapis.com/css2?family=Nunito:wght@400;600;700;800&family=Quicksand:wght@500;700&display=swap" rel="stylesheet">
    <style>
        :root {
            --primary: #8854C0; /* T√≠m h·ªìng */
            --secondary: #00C9A7; /* Xanh ng·ªçc */
            --correct: #00D26A; /* Xanh l√° */
            --wrong: #FF4757; /* ƒê·ªè cam */
            --bg: #F0F4F8;
            --card-bg: #FFFFFF;
            --text: #2D3436;
            --shadow: 0 6px 0 rgba(0,0,0,0.15);
            --shadow-active: 0 2px 0 rgba(0,0,0,0.15);
        }

        body {
            font-family: 'Nunito', sans-serif;
            background-color: var(--bg);
            background-image: radial-gradient(#e0e7ff 2px, transparent 2px);
            background-size: 30px 30px;
            color: var(--text);
            margin: 0;
            padding-bottom: 100px; /* Space for sticky footer */
        }

        .container {
            max-width: 900px;
            margin: 0 auto;
            padding: 20px;
        }

        /* HEADER */
        header {
            text-align: center;
            background: linear-gradient(135deg, var(--primary), #a29bfe);
            color: white;
            padding: 20px;
            border-radius: 20px;
            margin-bottom: 40px;
            box-shadow: 0 10px 20px rgba(136, 84, 192, 0.3);
            position: relative;
            overflow: hidden;
        }

        header h1 {
            margin: 0;
            font-family: 'Quicksand', sans-serif;
            font-size: 2.5rem;
            text-shadow: 2px 2px 0px rgba(0,0,0,0.1);
        }

        header p {
            font-size: 1.2rem;
            margin-top: 5px;
            opacity: 0.9;
        }

        .teacher-badge {
            background: white;
            color: var(--primary);
            padding: 5px 15px;
            border-radius: 50px;
            font-weight: 800;
            font-size: 0.9rem;
            display: inline-block;
            margin-bottom: 10px;
            box-shadow: 0 4px 0 rgba(0,0,0,0.1);
        }

        /* CARD STYLE */
        .card {
            background: var(--card-bg);
            border-radius: 20px;
            padding: 30px;
            margin-bottom: 30px;
            box-shadow: 0 8px 0 #dfe6e9;
            border: 2px solid #dfe6e9;
            transition: transform 0.2s;
        }

        .section-title {
            color: var(--primary);
            font-family: 'Quicksand', sans-serif;
            font-size: 1.5rem;
            font-weight: 800;
            margin-bottom: 20px;
            border-bottom: 3px dashed #dfe6e9;
            padding-bottom: 10px;
        }

        /* QUESTIONS */
        .question-block {
            margin-bottom: 25px;
            padding: 15px;
            background: #f8f9fa;
            border-radius: 15px;
            border: 2px solid transparent;
        }

        .question-text {
            font-size: 1.1rem;
            font-weight: 600;
            margin-bottom: 15px;
            line-height: 1.6;
        }

        /* INPUTS */
        input[type="text"] {
            border: 2px solid #b2bec3;
            border-radius: 10px;
            padding: 10px 15px;
            font-family: 'Nunito', sans-serif;
            font-size: 1rem;
            width: 100%;
            max-width: 300px;
            transition: all 0.3s;
            outline: none;
        }

        input[type="text"]:focus {
            border-color: var(--primary);
            box-shadow: 0 0 0 4px rgba(136, 84, 192, 0.2);
        }

        /* MULTIPLE CHOICE GRID */
        .mc-options {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 15px;
        }

        .option-btn {
            background: white;
            border: 2px solid #b2bec3;
            border-radius: 12px;
            padding: 15px;
            text-align: left;
            cursor: pointer;
            font-weight: 600;
            box-shadow: 0 4px 0 #b2bec3;
            transition: all 0.1s;
            position: relative;
        }

        .option-btn:active {
            transform: translateY(4px);
            box-shadow: 0 0 0 #b2bec3;
        }

        .option-btn.selected {
            border-color: var(--primary);
            background-color: #f3e5f5;
            box-shadow: 0 4px 0 var(--primary);
        }

        .option-btn.correct {
            border-color: var(--correct);
            background-color: #d1fae5;
            box-shadow: 0 4px 0 var(--correct);
            color: #065f46;
        }

        .option-btn.wrong {
            border-color: var(--wrong);
            background-color: #fee2e2;
            box-shadow: 0 4px 0 var(--wrong);
            color: #991b1b;
        }

        /* MATCHING GAME */
        .matching-grid {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 20px;
        }
        .match-col {
            display: flex;
            flex-direction: column;
            gap: 10px;
        }
        .match-item {
            background: white;
            border: 2px solid #b2bec3;
            padding: 15px;
            border-radius: 10px;
            cursor: pointer;
            box-shadow: 0 4px 0 #b2bec3;
            font-size: 0.95rem;
            transition: 0.2s;
        }
        .match-item.selected {
            border-color: var(--primary);
            background: #e0e7ff;
            transform: scale(1.02);
        }
        .match-item.matched {
            border-color: var(--correct);
            background: #d1fae5;
            opacity: 0.6;
            cursor: default;
            box-shadow: none;
            transform: translateY(4px);
        }

        /* BUTTONS */
        .btn-check {
            background: var(--secondary);
            color: white;
            border: none;
            padding: 10px 25px;
            border-radius: 12px;
            font-weight: 800;
            font-size: 1rem;
            cursor: pointer;
            box-shadow: 0 5px 0 #00917c;
            margin-top: 15px;
            transition: all 0.1s;
        }

        .btn-check:active {
            transform: translateY(5px);
            box-shadow: none;
        }

        /* EXPLANATION */
        .explanation {
            margin-top: 20px;
            background: #eef2ff;
            border-radius: 12px;
            padding: 20px;
            border-left: 5px solid var(--primary);
            display: none; /* Hidden by default */
            animation: slideDown 0.3s ease-out;
        }

        .explanation.show {
            display: block;
        }

        .explanation h4 {
            margin-top: 0;
            color: var(--primary);
            display: flex;
            align-items: center;
            gap: 10px;
        }
        
        .exp-detail p {
            margin: 5px 0;
        }
        
        .vocab-badge {
            background: #fff;
            border: 1px solid var(--primary);
            color: var(--primary);
            padding: 2px 8px;
            border-radius: 4px;
            font-size: 0.8rem;
            font-weight: bold;
            margin-right: 5px;
        }

        /* GLOSSARY TABLE */
        .glossary-table {
            width: 100%;
            border-collapse: collapse;
            margin-top: 20px;
            background: white;
            border-radius: 10px;
            overflow: hidden;
            box-shadow: 0 4px 0 #dfe6e9;
        }
        .glossary-table th {
            background: var(--primary);
            color: white;
            padding: 12px;
            text-align: left;
        }
        .glossary-table td {
            padding: 10px;
            border-bottom: 1px solid #eee;
        }
        .glossary-table tr:last-child td {
            border-bottom: none;
        }

        /* FOOTER SUBMIT */
        .sticky-footer {
            position: fixed;
            bottom: 0;
            left: 0;
            width: 100%;
            background: white;
            padding: 15px;
            box-shadow: 0 -5px 20px rgba(0,0,0,0.1);
            display: flex;
            justify-content: center;
            align-items: center;
            z-index: 1000;
        }

        .btn-submit-all {
            background: var(--wrong);
            color: white;
            border: none;
            padding: 15px 50px;
            border-radius: 50px;
            font-weight: 800;
            font-size: 1.2rem;
            cursor: pointer;
            box-shadow: 0 6px 0 #c0392b;
            transition: 0.2s;
        }

        .btn-submit-all:active {
            transform: translateY(6px);
            box-shadow: none;
        }

        /* ANIMATIONS */
        @keyframes shake {
            0%, 100% { transform: translateX(0); }
            25% { transform: translateX(-5px); }
            75% { transform: translateX(5px); }
        }
        .shake { animation: shake 0.3s; }

        @keyframes slideDown {
            from { opacity: 0; transform: translateY(-10px); }
            to { opacity: 1; transform: translateY(0); }
        }

        /* POPUP */
        .overlay {
            position: fixed;
            top: 0; left: 0; width: 100%; height: 100%;
            background: rgba(0,0,0,0.5);
            display: none;
            justify-content: center;
            align-items: center;
            z-index: 2000;
        }
        .popup {
            background: white;
            padding: 40px;
            border-radius: 30px;
            text-align: center;
            max-width: 500px;
            animation: slideDown 0.5s;
            box-shadow: 0 20px 0 rgba(0,0,0,0.2);
        }
        .score-circle {
            width: 120px;
            height: 120px;
            background: var(--primary);
            color: white;
            border-radius: 50%;
            display: flex;
            justify-content: center;
            align-items: center;
            font-size: 2.5rem;
            font-weight: 800;
            margin: 0 auto 20px;
            border: 5px solid white;
            box-shadow: 0 0 0 5px var(--primary);
        }

        /* PHONETICS */
        u {
            text-decoration: underline;
            text-decoration-thickness: 3px;
            text-decoration-color: var(--primary);
            text-underline-offset: 3px;
        }
        
        .passage {
            background: #fff3e0;
            padding: 20px;
            border-radius: 10px;
            border-left: 5px solid #ff9800;
            line-height: 1.8;
            margin-bottom: 20px;
            font-family: 'Georgia', serif;
        }
        
        .passage strong { color: #e65100; }
    </style>
</head>
<body>

<div class="container">
    <header>
        <div class="teacher-badge">Gi√°o vi√™n t·∫°o: Ms Mai An ULIS</div>
        <h1>TEST FOR UNIT 7: ENVIRONMENTAL PROTECTION</h1>
        <p>Ki·∫øn th·ª©c: Tenses, Word Form, Matching, Reading, Rewrite</p>
    </header>

    <div class="card" id="section-vi">
        <div class="section-title">VI. Verb Tenses (Chia ƒë·ªông t·ª´)</div>
        <p style="font-style: italic; color: #666;">üìù Give the correct form of the verbs in brackets.</p>
        
        <div id="vi-container"></div>
    </div>

    <div class="card" id="section-vii">
        <div class="section-title">VII. Word Forms (C·∫•u t·∫°o t·ª´)</div>
        <p style="font-style: italic; color: #666;">üî§ Supply the correct form of the words in brackets.</p>
        <div id="vii-container"></div>
    </div>

    <div class="card" id="section-viii">
        <div class="section-title">VIII. Matching (N·ªëi c√¢u)</div>
        <p style="font-style: italic; color: #666;">üîó Match the questions (1-8) to the answers (a-h). Click m·ªôt √¥ b√™n tr√°i r·ªìi click √¥ t∆∞∆°ng ·ª©ng b√™n ph·∫£i.</p>
        
        <div class="matching-grid">
            <div class="match-col" id="col-questions">
                </div>
            <div class="match-col" id="col-answers">
                </div>
        </div>
        <div id="matching-feedback" class="explanation"></div>
    </div>

    <div class="card" id="section-ix">
        <div class="section-title">IX. Gap Fill (ƒêi·ªÅn t·ª´ v√†o ƒëo·∫°n vƒÉn)</div>
        <p style="font-style: italic; color: #666;">üëü Choose the word which best fits each gap regarding the Adidas project.</p>
        
        <div class="passage">
            Adidas has created a sports shoe from garbage (1) ______ in the ocean. The new trainer is part of a project to raise awareness (2) ______ the serious problem of ocean pollution. Garbage in the ocean is a huge problem. UNESCO estimates that in 2006, there were nearly 30,000 (3) ______ of floating plastic for every square kilometre of ocean. Plastic debris kills over a million seabirds and 100,000 (4) ______ mammals every year. Adidas used some of this plastic to make (5) ______ new trainer. The sole of the sneaker is made from sustainable materials, (6) ______ the upper uses recycled ocean waste. This consisted of plastic and illegal fishing nets. Adidas says it (7) ______ a new trainer made from ocean waste later this year. In another green initiative, the sportswear maker said it would be (8) ______ the use of plastic bags in all Adidas retail stores in the near future.
        </div>
        
        <div id="ix-container"></div>
    </div>

    <div class="card" id="section-x">
        <div class="section-title">X. Reading Comprehension (ƒê·ªçc hi·ªÉu)</div>
        
        <div class="passage">
            There are many kinds of pollution. Air, water, and land can be polluted. Some pollution is caused by nature, such as floods, forest fires, and volcanoes. <strong>People are the major cause of pollution.</strong> We pollute the air with our cars, homes, and factories. Smoke from factories and car exhaust makes the air looks gray and smoggy. Some people cannot go outside when the air is very bad! We pollute the water by dumping garbage and chemicals in the water. Plants and animals die because of the pollution in the water. We pollute the soil with chemicals and garbage. We harm the land by cutting down trees in the forest, especially to build roads and new houses without careful planning and thinking.<br><br>
            The only way to save our environment is to think about pollution. How can you stop or limit pollution? How do we protect our environment? <strong>Conservation is one way to protect our environment. Conservation is the wise use and protection of our environment.</strong> We can control water pollution by not producing as much waste and by proper disposal of sewage and garbage. We can take care of recreation land by cleaning up after ourselves and not causing more pollution. Carpooling and public transportation will help reduce air pollution. Recycling is a type of conservation. Recycling is reusing items over again or in a new way. <strong>Recycling can help us conserve our natural resources so they will last many more years.</strong>
        </div>

        <div style="margin-bottom: 20px;">
            <h4>üìò Academic Glossary (T·ª´ v·ª±ng n√¢ng cao)</h4>
            <table class="glossary-table">
                <tr><th>Word</th><th>Type</th><th>Meaning (Vietnamese)</th></tr>
                <tr><td>Conservation</td><td>Noun (C1)</td><td>S·ª± b·∫£o t·ªìn</td></tr>
                <tr><td>Sewage</td><td>Noun (C1)</td><td>N∆∞·ªõc th·∫£i c·ªëng r√£nh</td></tr>
                <tr><td>Disposal</td><td>Noun (B2)</td><td>S·ª± v·ª©t b·ªè/x·ª≠ l√Ω r√°c</td></tr>
                <tr><td>Recreation</td><td>Noun (B2)</td><td>S·ª± gi·∫£i tr√≠/khu vui ch∆°i</td></tr>
                <tr><td>Exhaust</td><td>Noun (B2)</td><td>Kh√≥i th·∫£i (t·ª´ xe c·ªô)</td></tr>
            </table>
        </div>

        <h3>Part A: Find the word</h3>
        <div id="x-a-container"></div>

        <h3>Part B: Choose the correct answers</h3>
        <div id="x-b-container"></div>
    </div>

    <div class="card" id="section-xi">
        <div class="section-title">XI. Sentence Transformation (Vi·∫øt l·∫°i c√¢u)</div>
        <p style="font-style: italic; color: #666;">‚úçÔ∏è Join two sentences using the words in brackets.</p>
        <div id="xi-container"></div>
    </div>
</div>

<div class="sticky-footer">
    <button class="btn-submit-all" onclick="submitAll()">N·ªòP B√ÄI & XEM ƒêI·ªÇM üèÜ</button>
</div>

<div class="overlay" id="result-overlay">
    <div class="popup">
        <h2>K·∫øt Qu·∫£ B√†i L√†m</h2>
        <div class="score-circle" id="final-score">0</div>
        <p id="feedback-msg" style="font-size: 1.2rem; color: #666;"></p>
        <button class="btn-check" onclick="closePopup()">Xem chi ti·∫øt l·ªùi gi·∫£i</button>
    </div>
</div>

<audio id="sound-correct" src="data:audio/mp3;base64,//NExAAAAania..."></audio> <script src="https://cdn.jsdelivr.net/npm/canvas-confetti@1.5.1/dist/confetti.browser.min.js"></script>

<script>
    // --- DATA ---
    const db = {
        vi: [
            { q: "1. People in my city often (use) motorbikes to go to work.", a: "use", exp: "<strong>D·∫•u hi·ªáu:</strong> 'Often' (th∆∞·ªùng xuy√™n) -> Hi·ªán t·∫°i ƒë∆°n.<br><strong>Ch·ªß ng·ªØ:</strong> 'People' (s·ªë nhi·ªÅu) -> ƒê·ªông t·ª´ gi·ªØ nguy√™n." },
            { q: "2. If we use less energy, we (help) reduce greenhouse gas emissions.", a: "will help", exp: "<strong>C√¢u ƒëi·ªÅu ki·ªán lo·∫°i 1:</strong> If + S + V(hi·ªán t·∫°i), S + will + V.<br>D·ªãch: N·∫øu ch√∫ng ta d√πng √≠t nƒÉng l∆∞·ª£ng h∆°n, ch√∫ng ta s·∫Ω gi√∫p gi·∫£m kh√≠ th·∫£i." },
            { q: "3. Every year, that factory (dump) hundred tons of plastic into the oceans.", a: "dumps", exp: "<strong>D·∫•u hi·ªáu:</strong> 'Every year' (m·ªói nƒÉm) -> Hi·ªán t·∫°i ƒë∆°n.<br><strong>Ch·ªß ng·ªØ:</strong> 'That factory' (s·ªë √≠t) -> ƒê·ªông t·ª´ th√™m 's'." },
            { q: "4. The moon was covered yesterday as a thick smog (settle) over New Delhi.", a: "settled", exp: "<strong>B·ªëi c·∫£nh:</strong> Qu√° kh·ª© ('yesterday'). C·∫£ hai h√†nh ƒë·ªông ƒë·ªÅu ƒë√£ x·∫£y ra. Smog settled (ƒë√£ bao ph·ªß) t·∫°o n√™n hi·ªán t∆∞·ª£ng moon was covered.<br>D·ªãch: M·∫∑t trƒÉng b·ªã che khu·∫•t h√¥m qua khi l·ªõp kh√≥i b·ª•i d√†y ƒë·∫∑c bao ph·ªß New Delhi." },
            { q: "5. Vehicle, aircraft, and industrial noise can (cause) noise pollution.", a: "cause", exp: "<strong>Ng·ªØ ph√°p:</strong> Sau modal verb 'can' + V nguy√™n th·ªÉ." },
            { q: "6. Human activities (destroy) nature at an unacceptable rate right now.", a: "are destroying", exp: "<strong>D·∫•u hi·ªáu:</strong> 'Right now' (ngay b√¢y gi·ªù) -> Hi·ªán t·∫°i ti·∫øp di·ªÖn (am/is/are + V-ing).<br>Ch·ªß ng·ªØ 'activities' s·ªë nhi·ªÅu -> are destroying." },
            { q: "7. A decade ago, WHO (classify) air pollution as a link to lung cancer.", a: "classified", exp: "<strong>D·∫•u hi·ªáu:</strong> 'A decade ago' (m·ªôt th·∫≠p k·ª∑ tr∆∞·ªõc) -> Qu√° kh·ª© ƒë∆°n -> V-ed." },
            { q: "8. If the temperature (increase) by a few degrees..., we will run into serious problems.", a: "increases", exp: "<strong>C√¢u ƒëi·ªÅu ki·ªán lo·∫°i 1:</strong> M·ªánh ƒë·ªÅ IF chia hi·ªán t·∫°i ƒë∆°n. Ch·ªß ng·ªØ 'temperature' s·ªë √≠t -> increases." },
            { q: "9. We (visit) a national park as soon as exam period is over.", a: "will visit", exp: "<strong>C·∫•u tr√∫c:</strong> T∆∞∆°ng lai ƒë∆°n + as soon as + Hi·ªán t·∫°i ƒë∆°n. Di·ªÖn t·∫£ h√†nh ƒë·ªông s·∫Ω x·∫£y ra ngay sau h√†nh ƒë·ªông kh√°c trong t∆∞∆°ng lai." },
            { q: "10. Last night, I (watch) A Plastic Wave...", a: "watched", exp: "<strong>D·∫•u hi·ªáu:</strong> 'Last night' -> Qu√° kh·ª© ƒë∆°n -> V-ed." },
            { q: "11. We should avoid (buy) frozen foods...", a: "buying", exp: "<strong>C·∫•u tr√∫c:</strong> avoid + V-ing (tr√°nh l√†m g√¨)." },
            { q: "12. Air pollution can make people (die).", a: "die", exp: "<strong>C·∫•u tr√∫c:</strong> make + somebody + V(nguy√™n th·ªÉ) (khi·∫øn ai l√†m g√¨)." }
        ],
        vii: [
            { q: "1. As an ______, why do you oppose banning plastic bags? (environment)", a: "environmentalist", exp: "C·∫ßn danh t·ª´ ch·ªâ ng∆∞·ªùi (d·ª±a v√†o 'As an...' v√† ng·ªØ c·∫£nh h·ªèi √Ω ki·∫øn).<br>Environmentalist (n): Nh√† m√¥i tr∆∞·ªùng h·ªçc." },
            { q: "2. Should we protect some of our ______ resources...? (value)", a: "valuable", exp: "Tr∆∞·ªõc danh t·ª´ 'resources' c·∫ßn t√≠nh t·ª´.<br>Valuable (adj): Qu√Ω gi√°." },
            { q: "3. National parks also help to raise ______ of local residents... (aware)", a: "awareness", exp: "C·ª•m c·ªë ƒë·ªãnh: raise awareness (n√¢ng cao nh·∫≠n th·ª©c)." },
            { q: "4. Heavy metals in ______ water cut short millions of lives... (drink)", a: "drinking", exp: "Drinking water (n): N∆∞·ªõc u·ªëng (Danh t·ª´ gh√©p)." },
            { q: "5. ...plastic pollution in oceans will be one of the ______ threats. (big)", a: "biggest", exp: "So s√°nh nh·∫•t: one of the + Adj-est.<br>Biggest." },
            { q: "6. Pollution is the process of making parts of the living environment ______. (dirt)", a: "dirty", exp: "C·∫•u tr√∫c: make + something + Adj (t√≠nh t·ª´).<br>Dirty (adj): B·∫©n." },
            { q: "7. Those plants can grow ______ in extreme climates. (nature)", a: "naturally", exp: "Sau ƒë·ªông t·ª´ th∆∞·ªùng 'grow' c·∫ßn tr·∫°ng t·ª´ b·ªï nghƒ©a.<br>Naturally (adv): M·ªôt c√°ch t·ª± nhi√™n." },
            { q: "8. Burning fossil fuels... is a source of greenhouse gas ______. (emit)", a: "emissions", exp: "Danh t·ª´ s·ªë nhi·ªÅu sau 'gas'.<br>Emissions (n): Kh√≠ th·∫£i." },
            { q: "9. What can we do... to help to stop ______ warming? (globe)", a: "global", exp: "C·ª•m c·ªë ƒë·ªãnh: Global warming (S·ª± n√≥ng l√™n to√†n c·∫ßu)." },
            { q: "10. The environmental activists are trying to ______ wildlife... (conservation)", a: "conserve", exp: "Sau 'try to' c·∫ßn ƒë·ªông t·ª´ nguy√™n th·ªÉ.<br>Conserve (v): B·∫£o t·ªìn." }
        ],
        ix: [
            { q: "1. Adidas has created a sports shoe from garbage ______ in the ocean.", options: ["floating", "flying", "laying", "streaming"], correct: 0, exp: "<strong>A. floating: tr√¥i n·ªïi</strong><br>B. flying: bay<br>C. laying: ƒë·∫∑t/ƒë·∫ª tr·ª©ng<br>D. streaming: ch·∫£y d√≤ng<br>-> R√°c th·∫£i tr√¥i n·ªïi tr√™n ƒë·∫°i d∆∞∆°ng." },
            { q: "2. ...raise awareness ______ the serious problem...", options: ["on", "to", "of", "for"], correct: 2, exp: "<strong>C·ª•m t·ª´:</strong> awareness OF something (nh·∫≠n th·ª©c v·ªÅ c√°i g√¨)." },
            { q: "3. ...nearly 30,000 ______ of floating plastic...", options: ["bunches", "pieces", "slices", "bits"], correct: 1, exp: "<strong>B. pieces: m·∫£nh/mi·∫øng</strong><br>D√πng 'pieces of plastic' l√† collocator ph·ªï bi·∫øn nh·∫•t cho r√°c nh·ª±a." },
            { q: "4. ...kills over a million seabirds and 100,000 ______ mammals...", options: ["native", "land", "wildlife", "marine"], correct: 3, exp: "<strong>D. marine: thu·ªôc v·ªÅ bi·ªÉn</strong><br>ƒêang n√≥i v·ªÅ ƒë·∫°i d∆∞∆°ng -> Marine mammals (ƒë·ªông v·∫≠t c√≥ v√∫ ·ªü bi·ªÉn)." },
            { q: "5. Adidas used some of this plastic to make ______ new trainer.", options: ["theirs", "it's", "their", "its"], correct: 3, exp: "<strong>D. its</strong><br>Ch·ªß ng·ªØ l√† Adidas (t√™n c√¥ng ty, s·ªë √≠t) -> T√≠nh t·ª´ s·ªü h·ªØu l√† 'its'." },
            { q: "6. The sole... is made from sustainable materials, ______ the upper uses...", options: ["when", "while", "since", "for"], correct: 1, exp: "<strong>B. while: trong khi ƒë√≥</strong><br>D√πng ƒë·ªÉ di·ªÖn t·∫£ s·ª± ƒë·ªëi l·∫≠p: ƒê·∫ø gi√†y l√†m b·∫±ng v·∫≠t li·ªáu b·ªÅn v·ªØng, TRONG KHI ph·∫ßn th√¢n tr√™n d√πng r√°c t√°i ch·∫ø." },
            { q: "7. Adidas says it ______ a new trainer... later this year.", options: ["will release", "released", "releases", "is releasing"], correct: 0, exp: "<strong>A. will release</strong><br>'Later this year' ch·ªâ t∆∞∆°ng lai. D√πng th√¨ t∆∞∆°ng lai ƒë∆°n (ho·∫∑c hi·ªán t·∫°i ti·∫øp di·ªÖn ch·ªâ k·∫ø ho·∫°ch) ƒë·ªÅu ƒë∆∞·ª£c, nh∆∞ng 'will release' ph·ªï bi·∫øn cho th√¥ng b√°o s·∫£n ph·∫©m." },
            { q: "8. ...it would be ______ the use of plastic bags...", options: ["keeping on", "taking off", "phasing out", "putting up"], correct: 2, exp: "<strong>C. phasing out: lo·∫°i b·ªè d·∫ßn d·∫ßn</strong><br>ƒê√¢y l√† c·ª•m t·ª´ hay d√πng trong m√¥i tr∆∞·ªùng (phase out plastic)." }
        ],
        x_a: [
            { q: "1. the protection of the natural environment", a: "conservation", exp: "Conservation (n): S·ª± b·∫£o t·ªìn." },
            { q: "2. have a bad effect on something", a: "harm", exp: "Harm (v): G√¢y h·∫°i." },
            { q: "3. a large amount of water covering an area that is usually dry", a: "flood", exp: "Flood (n): L≈© l·ª•t (Text: 'floods')." },
            { q: "4. sharing a car ride with other people", a: "carpooling", exp: "Carpooling (n): ƒêi chung xe." },
            { q: "5. waste gases that come out of an engine", a: "exhaust", exp: "Exhaust (n): Kh√≠ th·∫£i xe c·ªô." },
            { q: "6. the process of making air, water, soil, etc. dirty", a: "pollution", exp: "Pollution (n): S·ª± √¥ nhi·ªÖm." },
            { q: "7. getting rid of", a: "disposal", exp: "Disposal (n): S·ª± v·ª©t b·ªè/x·ª≠ l√Ω r√°c." }
        ],
        x_b: [
            { q: "1. According to the passage, pollution ______", options: ["is always caused by humans", "can only be caused by nature", "is mainly caused by humans", "may sometimes cause natural disasters"], correct: 2, exp: "<strong>D·∫´n ch·ª©ng:</strong> 'People are the major cause of pollution.' (Con ng∆∞·ªùi l√† nguy√™n nh√¢n ch√≠nh).<br>-> Ch·ªçn C." },
            { q: "2. What kind of pollution may a car cause?", options: ["Air pollution", "Water pollution", "Soil pollution", "Light pollution"], correct: 0, exp: "<strong>D·∫´n ch·ª©ng:</strong> 'We pollute the air with our cars...' (Ch√∫ng ta l√†m √¥ nhi·ªÖm kh√¥ng kh√≠ b·∫±ng xe h∆°i).<br>-> Ch·ªçn A." },
            { q: "3. Which of the followings is NOT an example of soil pollution?", options: ["Land development", "Waste disposal", "Pesticide or fertilizer use", "Exhaust from traffic"], correct: 3, exp: "<strong>Gi·∫£i th√≠ch:</strong> 'Exhaust from traffic' g√¢y √¥ nhi·ªÖm kh√¥ng kh√≠ (Air), kh√¥ng ph·∫£i ƒë·∫•t (Soil). C√°c √Ω c√≤n l·∫°i ƒë·ªÅu l√†m h·∫°i ƒë·∫•t." },
            { q: "4. How can we help save our environment?", options: ["Stop pollution", "Dump garbage into the river", "Drive cars everywhere", "Cut down trees"], correct: 0, exp: "<strong>Logic:</strong> Ch·ªâ c√≥ 'Stop pollution' l√† c·ª©u m√¥i tr∆∞·ªùng. C√°c √Ω c√≤n l·∫°i l√† ph√° ho·∫°i." },
            { q: "5. How does recycling help the environment?", options: ["It expands landfills", "It saves natural resources", "It increases water pollution", "It causes air pollution"], correct: 1, exp: "<strong>D·∫´n ch·ª©ng:</strong> 'Recycling can help us conserve our natural resources...' (T√°i ch·∫ø gi√∫p b·∫£o t·ªìn t√†i nguy√™n thi√™n nhi√™n).<br>-> Ch·ªçn B." },
            { q: "6. What can we do to help reduce air pollution?", options: ["Walk or bike", "Carpool to work or school", "Use public transport", "All of the above"], correct: 3, exp: "<strong>Gi·∫£i th√≠ch:</strong> T·∫•t c·∫£ c√°c h√†nh ƒë·ªông tr√™n ƒë·ªÅu gi·∫£m vi·ªác s·ª≠ d·ª•ng xe c√° nh√¢n -> gi·∫£m kh√≥i th·∫£i -> gi·∫£m √¥ nhi·ªÖm kh√¥ng kh√≠." },
            { q: "7. What is the main idea of this article?", options: ["Air is dirty", "Soil gets polluted", "People cause pollution, but they can also stop or limit it", "Conservation is the only way"], correct: 2, exp: "<strong>T·ªïng h·ª£p:</strong> B√†i vi·∫øt n√™u c√°c lo·∫°i √¥ nhi·ªÖm do con ng∆∞·ªùi, sau ƒë√≥ ƒë∆∞a ra gi·∫£i ph√°p (conservation, recycling, carpooling...).<br>-> Ch·ªçn C." }
        ],
        xi: [
            { q: "1. We must conserve water. Otherwise we will face serious water shortages. (If)", a: "If we do not conserve water, we will face serious water shortages.", exp: "C·∫•u tr√∫c: Unless = If...not. Ho·∫∑c vi·∫øt l·∫°i ƒëi·ªÅu ki·ªán ng∆∞·ª£c l·∫°i c·ªßa 'Otherwise'." },
            { q: "2. The weather was awful. We didn't enjoy our camping holiday. (because of)", a: "We didn't enjoy our camping holiday because of the awful weather.", exp: "Because of + Noun phrase (c·ª•m danh t·ª´). 'The awful weather' l√† c·ª•m danh t·ª´." },
            { q: "3. Plastic bags are non-biodegradable. They will remain in the environment for many years. (Because)", a: "Because plastic bags are non-biodegradable, they will remain in the environment for many years.", exp: "Because + Clause (M·ªánh ƒë·ªÅ nguy√™n nh√¢n)." },
            { q: "4. People will keep protesting. The government takes action to protect the endangered rhinos. (until)", a: "People will keep protesting until the government takes action to protect the endangered rhinos.", exp: "Until: Cho ƒë·∫øn khi." },
            { q: "5. The ranger saw a baby panda in the river. He jumped into the river to save it. (As soon as)", a: "As soon as the ranger saw a baby panda in the river, he jumped into the river to save it.", exp: "As soon as: Ngay khi." },
            { q: "6. The climate is changing. The earth is getting warmer. (because)", a: "The earth is getting warmer because the climate is changing.", exp: "Di·ªÖn gi·∫£i nguy√™n nh√¢n k·∫øt qu·∫£: Tr√°i ƒë·∫•t n√≥ng l√™n V√å kh√≠ h·∫≠u thay ƒë·ªïi." },
            { q: "7. We should stop cutting down so many trees. We endanger our oxygen supply. (Unless)", a: "Unless we stop cutting down so many trees, we endanger our oxygen supply.", exp: "Unless = Tr·ª´ khi/N·∫øu kh√¥ng." },
            { q: "8. People begin to recycle. They generate much less trash. (When)", a: "When people begin to recycle, they generate much less trash.", exp: "When: Khi." },
            { q: "9. We are damaging the ozone layer. The ozone layer is necessary for human existence. (even though)", a: "We are damaging the ozone layer even though it is necessary for human existence.", exp: "Even though: M·∫∑c d√π (ch·ªâ s·ª± nh∆∞·ª£ng b·ªô)." },
            { q: "10. Sue is suffering from skin cancer. She was exposed to radiation when she was young. (so)", a: "Sue was exposed to radiation when she was young, so she is suffering from skin cancer.", exp: "So: V√¨ v·∫≠y (ch·ªâ k·∫øt qu·∫£). L∆∞u √Ω ƒë·∫£o v·∫ø: Ph∆°i nhi·ªÖm ph√≥ng x·∫° (nguy√™n nh√¢n) -> Ung th∆∞ (k·∫øt qu·∫£)." }
        ],
        matching: {
            questions: [
                { id: "m1", text: "1. Main reason for thermal pollution?" },
                { id: "m2", text: "2. Effect of thermal pollution on aquatic animals?" },
                { id: "m3", text: "3. How to minimize chemical water pollution?" },
                { id: "m4", text: "4. Diseases caused by air pollution?" },
                { id: "m5", text: "5. Gas responsible for global warming?" },
                { id: "m6", text: "6. Effects of noise pollution?" },
                { id: "m7", text: "7. Why are plastic bags a nuisance?" },
                { id: "m8", text: "8. Sources of radioactive pollution?" }
            ],
            answers: [
                { id: "ma", text: "a. Non-biodegradable, environmental hazard." },
                { id: "mb", text: "b. Nuclear wastes from power plants, mining." },
                { id: "mc", text: "c. Carbon dioxide (55% contribution)." },
                { id: "md", text: "d. Affects growth and may kill them." },
                { id: "me", text: "e. Hot water released by power plants." },
                { id: "mf", text: "f. Sleep disturbance, high blood pressure." },
                { id: "mg", text: "g. Rickets, throat cancer, lung cancer." },
                { id: "mh", text: "h. Treat wastewater before discharging." }
            ],
            pairs: { "m1": "me", "m2": "md", "m3": "mh", "m4": "mg", "m5": "mc", "m6": "mf", "m7": "ma", "m8": "mb" }
        }
    };

    // --- SOUND & EFFECTS ---
    function playSound(type) {
        // Simple AudioContext beep for portability
        const ctx = new (window.AudioContext || window.webkitAudioContext)();
        const osc = ctx.createOscillator();
        const gain = ctx.createGain();
        osc.connect(gain);
        gain.connect(ctx.destination);
        
        if (type === 'correct') {
            osc.type = 'sine';
            osc.frequency.value = 600;
            osc.frequency.setValueAtTime(800, ctx.currentTime + 0.1);
            gain.gain.setValueAtTime(0.1, ctx.currentTime);
            osc.start();
            osc.stop(ctx.currentTime + 0.2);
            confetti({ particleCount: 100, spread: 70, origin: { y: 0.6 } });
        } else {
            osc.type = 'sawtooth';
            osc.frequency.value = 150;
            gain.gain.setValueAtTime(0.1, ctx.currentTime);
            osc.start();
            osc.stop(ctx.currentTime + 0.2);
        }
    }

    // --- RENDER FUNCTIONS ---
    
    // Generic Input Render
    function renderInputSection(containerId, data, prefix) {
        const container = document.getElementById(containerId);
        data.forEach((item, index) => {
            const div = document.createElement('div');
            div.className = 'question-block';
            div.innerHTML = `
                <div class="question-text">${item.q}</div>
                <input type="text" id="${prefix}-ans-${index}" placeholder="Type your answer...">
                <div id="${prefix}-exp-${index}" class="explanation">
                    <h4><span id="${prefix}-icon-${index}"></span> ƒê√°p √°n: <span style="color:var(--secondary); margin-left:10px;">${item.a}</span></h4>
                    <div class="exp-detail">${item.exp}</div>
                </div>
                <button class="btn-check" onclick="checkInput('${prefix}', ${index})">Ki·ªÉm tra</button>
            `;
            container.appendChild(div);
        });
    }

    // Multiple Choice Render
    function renderMC(containerId, data, prefix) {
        const container = document.getElementById(containerId);
        data.forEach((item, index) => {
            const div = document.createElement('div');
            div.className = 'question-block';
            let optionsHtml = '<div class="mc-options">';
            item.options.forEach((opt, oid) => {
                optionsHtml += `<div class="option-btn" id="${prefix}-opt-${index}-${oid}" onclick="selectMC('${prefix}', ${index}, ${oid})">${String.fromCharCode(65+oid)}. ${opt}</div>`;
            });
            optionsHtml += '</div>';
            
            div.innerHTML = `
                <div class="question-text">${item.q}</div>
                ${optionsHtml}
                <div id="${prefix}-exp-${index}" class="explanation">
                    <h4>ƒê√°p √°n ƒë√∫ng: ${String.fromCharCode(65+item.correct)}</h4>
                    <div class="exp-detail">${item.exp}</div>
                </div>
                <button class="btn-check" onclick="checkMC('${prefix}', ${index})">Ki·ªÉm tra</button>
            `;
            container.appendChild(div);
        });
    }

    // Matching Render
    let selectedLeft = null;
    function renderMatching() {
        const qCol = document.getElementById('col-questions');
        const aCol = document.getElementById('col-answers');
        
        db.matching.questions.forEach(q => {
            const div = document.createElement('div');
            div.className = 'match-item';
            div.id = q.id;
            div.textContent = q.text;
            div.onclick = () => selectMatching(q.id, 'left');
            qCol.appendChild(div);
        });

        db.matching.answers.forEach(a => {
            const div = document.createElement('div');
            div.className = 'match-item';
            div.id = a.id;
            div.textContent = a.text;
            div.onclick = () => selectMatching(a.id, 'right');
            aCol.appendChild(div);
        });
    }

    // --- LOGIC FUNCTIONS ---

    function checkInput(prefix, index) {
        const input = document.getElementById(`${prefix}-ans-${index}`);
        const exp = document.getElementById(`${prefix}-exp-${index}`);
        const icon = document.getElementById(`${prefix}-icon-${index}`);
        const userVal = input.value.trim().toLowerCase();
        
        // Simple normalization for comparisons (remove extra spaces, punctuation)
        const cleanUser = userVal.replace(/[.,!]/g, '').replace(/\s+/g, ' ');
        // For rewrite section, we just show the answer for comparison, or do loose check
        let correctVal = db[prefix][index].a.toLowerCase();
        
        // Handling special cases (flexible answers) could be added here
        
        let isCorrect = false;
        if(prefix === 'xi') {
             // Rewrite sentences: loose check (contains key phrase or >80% similarity)
             // Simulating a smart check: remove punctuation and compare
             const cleanKey = correctVal.replace(/[.,!]/g, '').replace(/\s+/g, ' ');
             if(cleanUser === cleanKey || cleanUser.length > 5 && cleanKey.includes(cleanUser)) isCorrect = true;
        } else {
             if (userVal === correctVal || cleanUser === correctVal.replace(/[.,!]/g, '')) isCorrect = true;
        }

        exp.classList.add('show');
        if (isCorrect) {
            input.style.borderColor = 'var(--correct)';
            input.style.backgroundColor = '#d1fae5';
            icon.textContent = '‚úÖ';
            playSound('correct');
        } else {
            input.style.borderColor = 'var(--wrong)';
            input.style.backgroundColor = '#fee2e2';
            input.classList.add('shake');
            setTimeout(() => input.classList.remove('shake'), 500);
            icon.textContent = '‚ùå';
            playSound('wrong');
        }
    }

    // Check Multiple Choice
    function selectMC(prefix, qIdx, oIdx) {
        // Clear previous selection
        for(let i=0; i<4; i++) {
            const btn = document.getElementById(`${prefix}-opt-${qIdx}-${i}`);
            if(btn) btn.classList.remove('selected');
        }
        document.getElementById(`${prefix}-opt-${qIdx}-${oIdx}`).classList.add('selected');
    }

    function checkMC(prefix, qIdx) {
        const correctOpt = db[prefix][qIdx].correct;
        let userOpt = -1;
        
        for(let i=0; i<4; i++) {
            const btn = document.getElementById(`${prefix}-opt-${qIdx}-${i}`);
            if(btn && btn.classList.contains('selected')) userOpt = i;
        }

        if(userOpt === -1) {
            alert("Vui l√≤ng ch·ªçn ƒë√°p √°n!");
            return;
        }

        const exp = document.getElementById(`${prefix}-exp-${qIdx}`);
        exp.classList.add('show');

        const correctBtn = document.getElementById(`${prefix}-opt-${qIdx}-${correctOpt}`);
        const userBtn = document.getElementById(`${prefix}-opt-${qIdx}-${userOpt}`);

        if (userOpt === correctOpt) {
            userBtn.classList.add('correct');
            playSound('correct');
        } else {
            userBtn.classList.add('wrong');
            correctBtn.classList.add('correct');
            userBtn.classList.add('shake');
            setTimeout(() => userBtn.classList.remove('shake'), 500);
            playSound('wrong');
        }
    }

    // Check Matching
    function selectMatching(id, side) {
        if (side === 'left') {
            if (selectedLeft) document.getElementById(selectedLeft).classList.remove('selected');
            selectedLeft = id;
            document.getElementById(id).classList.add('selected');
        } else {
            if (!selectedLeft) return;
            
            const leftEl = document.getElementById(selectedLeft);
            const rightEl = document.getElementById(id);
            const correctMatch = db.matching.pairs[selectedLeft];

            if (correctMatch === id) {
                leftEl.classList.remove('selected');
                leftEl.classList.add('matched');
                rightEl.classList.add('matched');
                playSound('correct');
                selectedLeft = null;
            } else {
                rightEl.classList.add('shake');
                setTimeout(() => rightEl.classList.remove('shake'), 500);
                playSound('wrong');
            }
        }
    }

    // --- SUBMIT ALL & SCORE ---
    function submitAll() {
        let score = 0;
        let total = 0;

        // Count Input Sections (VI, VII, X-A, XI)
        ['vi', 'vii', 'x_a', 'xi'].forEach(key => {
            db[key].forEach((item, idx) => {
                total++;
                const input = document.getElementById(`${key}-ans-${idx}`);
                const exp = document.getElementById(`${key}-exp-${idx}`);
                // Auto check if not checked
                if(!exp.classList.contains('show')) checkInput(key, idx);
                // Count correct (green border)
                if(input.style.borderColor === 'var(--correct)') score++;
            });
        });

        // Count MC (IX, X-B)
        ['ix', 'x_b'].forEach(key => {
            db[key].forEach((item, idx) => {
                total++;
                const exp = document.getElementById(`${key}-exp-${idx}`);
                if(!exp.classList.contains('show')) checkMC(key, idx);
                // Check if user selected correct
                const correctBtn = document.getElementById(`${key}-opt-${idx}-${item.correct}`);
                if(correctBtn.classList.contains('selected')) score++;
            });
        });

        // Count Matching
        total += 8;
        const matched = document.querySelectorAll('.match-item.matched').length / 2;
        score += matched;

        // Show Popup
        document.getElementById('result-overlay').style.display = 'flex';
        document.getElementById('final-score').textContent = `${score}/${total}`;
        
        const msg = document.getElementById('feedback-msg');
        const pct = score/total;
        if(pct > 0.9) msg.textContent = "Xu·∫•t s·∫Øc! B·∫°n l√† thi√™n t√†i m√¥i tr∆∞·ªùng! üåü";
        else if(pct > 0.7) msg.textContent = "L√†m t·ªët l·∫Øm! C·ªë g·∫Øng th√™m ch√∫t n·ªØa nh√©! üí™";
        else msg.textContent = "ƒê·ª´ng bu·ªìn, h√£y xem l·∫°i l·ªùi gi·∫£i chi ti·∫øt nh√©! üìö";
        
        confetti({ particleCount: 200, spread: 100 });
    }

    function closePopup() {
        document.getElementById('result-overlay').style.display = 'none';
    }

    // --- INITIALIZE ---
    window.onload = function() {
        renderInputSection('vi-container', db.vi, 'vi');
        renderInputSection('vii-container', db.vii, 'vii');
        renderInputSection('x-a-container', db.x_a, 'x_a');
        renderInputSection('xi-container', db.xi, 'xi');
        renderMC('ix-container', db.ix, 'ix');
        renderMC('x-b-container', db.x_b, 'x_b');
        renderMatching();
    };

</script>
</body>
</html>