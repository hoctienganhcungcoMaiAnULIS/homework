<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>B√†i T·∫≠p Ti·∫øng Anh - Ms Mai An ULIS</title>
    <link href="https://fonts.googleapis.com/css2?family=Nunito:wght@400;600;700;800&display=swap" rel="stylesheet">
    <style>
        :root {
            --primary: #8854C0; /* H·ªìng t√≠m pastel */
            --secondary: #00C9A7; /* Xanh ng·ªçc */
            --accent: #FFD700; /* V√†ng */
            --correct: #00D26A; /* Xanh l√° */
            --wrong: #FF4757; /* ƒê·ªè cam */
            --bg-color: #f0f3f5;
            --card-bg: #ffffff;
            --text: #2c3e50;
        }

        body {
            font-family: 'Nunito', sans-serif;
            background-color: var(--bg-color);
            background-image: radial-gradient(var(--primary) 1px, transparent 1px), radial-gradient(var(--secondary) 1px, transparent 1px);
            background-size: 40px 40px;
            background-position: 0 0, 20px 20px;
            margin: 0;
            padding: 0;
            color: var(--text);
            padding-bottom: 100px; /* Space for sticky footer */
        }

        /* HEADER */
        header {
            background: white;
            padding: 15px 20px;
            box-shadow: 0 4px 15px rgba(0,0,0,0.1);
            text-align: center;
            position: sticky;
            top: 0;
            z-index: 1000;
            border-bottom: 5px solid var(--secondary);
        }

        header h1 {
            margin: 0;
            font-size: 1.5rem;
            color: var(--primary);
            font-weight: 800;
            text-transform: uppercase;
            letter-spacing: 1px;
        }

        header .sub-title {
            font-size: 0.9rem;
            color: #666;
            margin-top: 5px;
        }

        /* CONTAINER */
        .container {
            max-width: 800px;
            margin: 30px auto;
            padding: 0 15px;
        }

        /* SECTIONS */
        .section-title {
            background: var(--primary);
            color: white;
            padding: 15px;
            border-radius: 15px;
            margin-bottom: 20px;
            font-weight: 800;
            font-size: 1.2rem;
            box-shadow: 0 6px 0 #6c429c;
            text-align: center;
        }

        /* CARD QUESTION */
        .question-card {
            background: var(--card-bg);
            border-radius: 20px;
            padding: 25px;
            margin-bottom: 25px;
            box-shadow: 0 8px 0 rgba(0,0,0,0.05);
            border: 2px solid #eee;
            position: relative;
            transition: transform 0.2s;
        }

        .question-text {
            font-size: 1.2rem;
            font-weight: 700;
            margin-bottom: 20px;
            color: #2c3e50;
        }

        .question-number {
            display: inline-block;
            background: var(--accent);
            color: #fff;
            padding: 5px 10px;
            border-radius: 10px;
            font-size: 0.9rem;
            font-weight: 800;
            margin-right: 10px;
            text-shadow: 1px 1px 0 rgba(0,0,0,0.2);
        }

        /* OPTIONS GRID */
        .options-grid {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 15px;
        }

        @media (max-width: 600px) {
            .options-grid {
                grid-template-columns: 1fr;
            }
        }

        .option-btn {
            background: white;
            border: 2px solid #e0e0e0;
            padding: 15px;
            border-radius: 15px;
            font-family: 'Nunito', sans-serif;
            font-size: 1rem;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.2s;
            box-shadow: 0 4px 0 #e0e0e0;
            text-align: left;
            position: relative;
        }

        .option-btn:hover:not(:disabled) {
            transform: scale(1.02);
            border-color: var(--secondary);
        }

        .option-btn:active:not(:disabled) {
            transform: translateY(4px);
            box-shadow: none;
        }

        /* STATE CLASSES */
        .option-btn.selected {
            border-color: var(--primary);
            background-color: #f3e5f5;
        }

        .option-btn.correct {
            background-color: var(--correct);
            color: white;
            border-color: #00b85c;
            box-shadow: 0 4px 0 #00b85c;
        }

        .option-btn.wrong {
            background-color: var(--wrong);
            color: white;
            border-color: #d63031;
            box-shadow: 0 4px 0 #d63031;
            animation: shake 0.5s;
        }

        /* CHECK BUTTON PER QUESTION */
        .check-btn {
            display: block;
            width: 100%;
            margin-top: 20px;
            padding: 12px;
            border: none;
            background: var(--secondary);
            color: white;
            font-weight: 800;
            border-radius: 12px;
            cursor: pointer;
            font-family: 'Nunito', sans-serif;
            font-size: 1.1rem;
            box-shadow: 0 5px 0 #009e82;
            transition: all 0.2s;
        }

        .check-btn:active {
            transform: translateY(5px);
            box-shadow: none;
        }

        .check-btn:disabled {
            background: #ccc;
            box-shadow: none;
            cursor: not-allowed;
            transform: none;
        }

        /* EXPLANATION BOX */
        .explanation {
            margin-top: 20px;
            padding: 20px;
            background: #f8f9fa;
            border-left: 5px solid var(--primary);
            border-radius: 10px;
            display: none; /* Hidden by default */
            font-size: 0.95rem;
            line-height: 1.6;
        }

        .explanation h4 {
            margin-top: 0;
            color: var(--primary);
            display: flex;
            align-items: center;
        }
        
        .explanation h4::before {
            content: 'üí°';
            margin-right: 10px;
        }

        .vocab-list {
            background: white;
            padding: 10px;
            border-radius: 8px;
            margin-bottom: 10px;
            border: 1px dashed #ccc;
        }
        
        .vocab-item {
            display: block;
            margin-bottom: 5px;
        }

        .vocab-word {
            font-weight: bold;
            color: var(--primary);
        }

        .analysis {
            margin-top: 10px;
        }

        /* STICKY FOOTER */
        .sticky-footer {
            position: fixed;
            bottom: 0;
            left: 0;
            width: 100%;
            background: white;
            padding: 15px;
            box-shadow: 0 -5px 20px rgba(0,0,0,0.1);
            display: flex;
            justify-content: center;
            align-items: center;
            z-index: 999;
        }

        .submit-all-btn {
            background: var(--primary);
            color: white;
            padding: 15px 40px;
            border-radius: 30px;
            font-size: 1.2rem;
            font-weight: 800;
            border: none;
            box-shadow: 0 6px 0 #5e3a85;
            cursor: pointer;
            transition: all 0.2s;
            font-family: 'Nunito', sans-serif;
        }

        .submit-all-btn:hover {
            transform: scale(1.05);
        }

        .submit-all-btn:active {
            transform: translateY(6px);
            box-shadow: none;
        }

        /* ANIMATIONS */
        @keyframes shake {
            0% { transform: translateX(0); }
            25% { transform: translateX(-10px) rotate(-5deg); }
            50% { transform: translateX(10px) rotate(5deg); }
            75% { transform: translateX(-10px) rotate(-5deg); }
            100% { transform: translateX(0); }
        }

        /* GLOSSARY TABLE */
        .glossary-table {
            width: 100%;
            border-collapse: collapse;
            margin-top: 20px;
            background: white;
            border-radius: 10px;
            overflow: hidden;
            box-shadow: 0 4px 0 rgba(0,0,0,0.05);
        }
        
        .glossary-table th {
            background: var(--secondary);
            color: white;
            padding: 12px;
            text-align: left;
        }
        
        .glossary-table td {
            padding: 10px;
            border-bottom: 1px solid #eee;
        }

        /* Underline style for Phonetics */
        u {
            text-decoration: none;
            border-bottom: 2px solid var(--primary);
            font-weight: 800;
            padding-bottom: 1px;
        }

        /* Result Popup */
        .modal-overlay {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0,0,0,0.7);
            display: none;
            justify-content: center;
            align-items: center;
            z-index: 2000;
        }

        .modal-content {
            background: white;
            padding: 40px;
            border-radius: 20px;
            text-align: center;
            max-width: 400px;
            animation: popIn 0.3s cubic-bezier(0.68, -0.55, 0.265, 1.55);
        }

        @keyframes popIn {
            0% { transform: scale(0); }
            100% { transform: scale(1); }
        }

        .score-display {
            font-size: 3rem;
            font-weight: 800;
            color: var(--primary);
            margin: 20px 0;
        }

    </style>
</head>
<body>

<header>
    <h1>Gi√°o vi√™n t·∫°o: Ms Mai An ULIS</h1>
    <div class="sub-title">Interactive English Test - Grade 6-9 Level</div>
</header>

<div class="container" id="quiz-container">
    </div>

<div class="sticky-footer">
    <button class="submit-all-btn" onclick="submitAll()">N·ªòP B√ÄI (SUBMIT)</button>
</div>

<div class="modal-overlay" id="resultModal">
    <div class="modal-content">
        <h2>K·∫øt Qu·∫£ C·ªßa B·∫°n</h2>
        <div class="score-display" id="scoreText">0/0</div>
        <p id="feedbackText">H√£y c·ªë g·∫Øng h∆°n nh√©!</p>
        <button class="check-btn" onclick="closeModal()">Xem L·ªùi Gi·∫£i Chi Ti·∫øt</button>
    </div>
</div>

<script>
    // --- D·ªÆ LI·ªÜU ƒê·ªÄ B√ÄI (ƒê√É ƒê∆Ø·ª¢C CHU·∫®N H√ìA) ---
    // V√¨ ƒë·ªÅ b√†i kh√¥ng g·∫°ch ch√¢n c·ª• th·ªÉ, Teacher Mai An s·∫Ω th√™m logic g·∫°ch ch√¢n chu·∫©n SGK.
    
    const quizData = [
        {
            section: "A. PHONETICS - I. Pronunciation",
            instruction: "Choose the words whose underlined part is pronounced differently.",
            questions: [
                {
                    q: "ended, loved, cleaned, bored",
                    options: ["end<u>ed</u>", "lov<u>ed</u>", "clean<u>ed</u>", "bor<u>ed</u>"],
                    correct: 0,
                    vocab: [
                        "ended (v): K·∫øt th√∫c", "loved (v): Y√™u", "cleaned (v): D·ªçn d·∫πp", "bored (adj): Bu·ªìn ch√°n"
                    ],
                    rule: "Quy t·∫Øc ƒëu√¥i -ed: /id/ sau t,d; /t/ sau p,k,f,s,sh,ch; /d/ c√≤n l·∫°i."
                },
                {
                    q: "way, station, pavement, traffic",
                    options: ["w<u>a</u>y", "st<u>a</u>tion", "p<u>a</u>vement", "tr<u>a</u>ffic"],
                    correct: 3,
                    vocab: ["way: ƒê∆∞·ªùng", "station: Tr·∫°m", "pavement: V·ªâa h√®", "traffic: Giao th√¥ng"],
                    ipa: ["/ei/", "/ei/", "/ei/", "/√¶/"],
                    rule: "ƒê√°p √°n D ƒë·ªçc l√† /√¶/, c√°c t·ª´ c√≤n l·∫°i l√† /ei/."
                },
                {
                    q: "seatbelt, enter, obey, present",
                    options: ["s<u>ea</u>tbelt", "<u>e</u>nter", "ob<u>e</u>y", "pr<u>e</u>sent"], // Gi·∫£ ƒë·ªãnh g·∫°ch ch√¢n ph·∫ßn nguy√™n √¢m ch√≠nh
                    // NOTE: C√¢u n√†y ƒë·ªÅ g·ªëc kh√° m∆° h·ªì v·ªÅ ph·∫ßn g·∫°ch ch√¢n. 
                    // Gi·∫£ s·ª≠ g·∫°ch ch√¢n 'e/ea'. Seatbelt /i:/, Enter /e/, Obey /ei/, Present /e/. 
                    // N·∫øu g·∫°ch ch√¢n 'e' ·ªü obey/enter/present/seatbelt...
                    // Teacher Logic: Check 'e' v√† 'ea'. 
                    // Seatbelt /i:/, Enter /e/, Obey /ei/, Present (n) /e/. 
                    // ƒê√°p √°n kh·∫£ dƒ© nh·∫•t theo s√°ch GK l·ªõp 7 l√† Seatbelt /i:/ kh√°c Enter/Present /e/. Nh∆∞ng Obey l√† /ei/.
                    // S·ª≠a ƒë·ªÅ b√†i hi·ªÉn th·ªã cho h·ª£p l√Ω: G·∫°ch ch√¢n ch·ªØ 'e' ƒë·∫ßu (tr·ª´ seatbelt l√† ea).
                    // ƒê·ªÉ an to√†n ch·ªçn Seatbelt (/i:/) kh√°c nh√≥m e (/e/). (Obey th∆∞·ªùng √≠t thi g·∫°ch ch√¢n e th·ª© 2).
                    // UPDATE: Theo ƒë·ªÅ ph·ªï bi·∫øn, ƒë√¢y l√† b√†i t√¨m √¢m /e/ v√† /ei/.
                    // Seatbelt /i:/, Enter /e/, Obey /ei/, Present /e/. V·∫´n lo·∫°n. 
                    // H√£y x√©t: Seatbelt, Enter, Obey, Present.
                    // ƒê√°p √°n chu·∫©n th∆∞·ªùng l√† Obey (/ei/) ho·∫∑c Seatbelt (/i:/). 
                    // Ch·ªçn A (Seatbelt) l√† /i:/, c√≤n l·∫°i n·∫øu Present/Enter l√† /e/. Obey l√† ngo·∫°i lai.
                    // S·∫Ω set ƒë√°p √°n A v√† gi·∫£i th√≠ch s·ª± kh√°c bi·ªát.
                    options: ["s<u>ea</u>tbelt", "<u>e</u>nter", "ob<u>e</u>y", "pr<u>e</u>sent"],
                    correct: 0, 
                    vocab: ["seatbelt: d√¢y an to√†n", "enter: ƒëi v√†o", "obey: v√¢ng l·ªùi", "present: m√≥n qu√†/hi·ªán t·∫°i"],
                    ipa: ["/ÀàsiÀêt.belt/ (/i:/)", "/Ààen.t…ôr/ (/e/)", "/…ôÀàbe…™/ (/ei/)", "/Ààprez.…ônt/ (/e/)"],
                    rule: "Seatbelt c√≥ √¢m /i:/, Enter v√† Present l√† /e/, Obey l√† /ei/. (C√¢u n√†y ƒë·ªÅ g·ªëc h∆°i lai t·∫°p, nh∆∞ng A kh√°c bi·ªát nh·∫•t v·ªÅ ƒë·ªô d√†i √¢m)."
                },
                {
                    q: "cooked, clicked, talked, naked",
                    options: ["cook<u>ed</u>", "click<u>ed</u>", "talk<u>ed</u>", "nak<u>ed</u>"],
                    correct: 3,
                    vocab: ["cooked: n·∫•u", "clicked: nh·∫•p chu·ªôt", "talked: n√≥i", "naked: tr·∫ßn tr·ª•i (ngo·∫°i l·ªá)"],
                    rule: "Naked l√† t√≠nh t·ª´ ngo·∫°i l·ªá ƒë·ªçc l√† /id/. C√°c t·ª´ c√≤n l·∫°i t·∫≠n c√πng k -> ƒë·ªçc /t/."
                },
                {
                    q: "needed, developed, wanted, included",
                    options: ["need<u>ed</u>", "develop<u>ed</u>", "want<u>ed</u>", "includ<u>ed</u>"],
                    correct: 1,
                    vocab: ["needed: c·∫ßn", "developed: ph√°t tri·ªÉn", "wanted: mu·ªën", "included: bao g·ªìm"],
                    rule: "Developed k·∫øt th√∫c /p/ -> ƒë·ªçc /t/. C√≤n l·∫°i t,d -> ƒë·ªçc /id/."
                },
                {
                    q: "loved, liked, wished, gripped",
                    options: ["lov<u>ed</u>", "lik<u>ed</u>", "wish<u>ed</u>", "gripp<u>ed</u>"],
                    correct: 0,
                    vocab: ["loved: y√™u", "liked: th√≠ch", "wished: ∆∞·ªõc", "gripped: n·∫Øm ch·∫∑t"],
                    rule: "Loved ƒë·ªçc /d/ (√¢m h·ªØu thanh). C√≤n l·∫°i (k, sh, p) ƒë·ªçc /t/."
                },
                {
                    q: "safely, pavement, animation, female",
                    options: ["s<u>a</u>fely", "p<u>a</u>vement", "<u>a</u>nimation", "fem<u>a</u>le"],
                    correct: 2,
                    vocab: ["safely: an to√†n", "pavement: v·ªâa h√®", "animation: ho·∫°t h√¨nh", "female: n·ªØ gi·ªõi"],
                    ipa: ["/ei/", "/ei/", "/√¶/", "/ei/"],
                    rule: "Animation √¢m a l√† /√¶/. C√°c t·ª´ c√≤n l·∫°i l√† /ei/."
                },
                {
                    q: "bored, amazed, excited, enjoyed",
                    options: ["bor<u>ed</u>", "amaz<u>ed</u>", "excit<u>ed</u>", "enjoy<u>ed</u>"],
                    correct: 2,
                    vocab: ["bored: ch√°n", "amazed: ng·∫°c nhi√™n", "excited: h√†o h·ª©ng", "enjoyed: th√≠ch th√∫"],
                    rule: "Excited t·∫≠n c√πng t -> ƒë·ªçc /id/. C√≤n l·∫°i ƒë·ªçc /d/."
                },
                {
                    q: "filled, opened, played, wanted",
                    options: ["fill<u>ed</u>", "open<u>ed</u>", "play<u>ed</u>", "want<u>ed</u>"],
                    correct: 3,
                    vocab: ["filled: l·∫•p ƒë·∫ßy", "opened: m·ªü", "played: ch∆°i", "wanted: mu·ªën"],
                    rule: "Wanted t·∫≠n c√πng t -> ƒë·ªçc /id/. C√≤n l·∫°i ƒë·ªçc /d/."
                },
                {
                    q: "ended, shocked, laughed, missed",
                    options: ["end<u>ed</u>", "shock<u>ed</u>", "laugh<u>ed</u>", "miss<u>ed</u>"],
                    correct: 0,
                    vocab: ["ended: k·∫øt th√∫c", "shocked: b·ªã s·ªëc", "laughed: c∆∞·ªùi", "missed: nh·ªõ/l·ª°"],
                    rule: "Ended ƒë·ªçc /id/. C√≤n l·∫°i (k, gh/f/, s) ƒë·ªçc /t/."
                },
                {
                    q: "recommend, seatbelt, vehicle, investigate",
                    options: ["r<u>e</u>commend", "s<u>ea</u>tbelt", "v<u>e</u>hicle", "inv<u>e</u>stigate"],
                    correct: 2, // Check sound 'e'
                    // Recommend /e/, Seatbelt /i:/, Vehicle /i…ô/ or /hi/ -> Silent h? Vehicle is /ÀàviÀê.…ô.k…ôl/ (/i:/) or /Ààv…™…ô.k…ôl/.
                    // Investigate /e/.
                    // Wait, Seatbelt /i:/, Vehicle /i:/, Recommend /e/, Investigate /e/. 
                    // Let's assume underlining 'e'.
                    // Recommend (e), Vehicle (e - silent?), Investigate (e).
                    // This assumes underlining the 'e' in recommend, 'ea' in seatbelt...
                    // Let's try stress? No, section I.
                    // Let's pick the "silent" one or different vowel.
                    // Vehicle: 'e' is /i:/ or /…™/. Recommend: /e/. Investigate: /e/. Seatbelt: /i:/.
                    // Correct logical grouping: Recommend & Investigate (/e/). Seatbelt & Vehicle (/i:/).
                    // Let's look at option A vs D (e vs e). B vs C (i: vs i:).
                    // Let's assume the question tests 'e'. 
                    // Correct answer likely A or D based on 'e'.
                    // Let's go with Vehicle (h c√¢m, e ƒë·ªçc n·ªëi). 
                    // Let's re-read standard drills. Usually: Recommend (/e/), Seatbelt (/i:/), Vehicle (Standard /vi…ô/ or /i:/), Investigate (/e/).
                    // Answer B (Seatbelt /i:/) vs Recommend (/e/). 
                    // Let's mark Seatbelt /i:/ vs others /e/. (Assuming vehicle is read loosely as /veh-icle/ in VN schools or standard /i:/). 
                    // Actually, Vehicle is /Ààv…™…ô.k…ôl/. The 'e' is /…™…ô/ or /i:/.
                    // Let's choose A. Recommend /e/.
                    // I will set Logic: Seatbelt /i:/, Vehicle /i:/, Investigate /e/, Recommend /e/. 2 vs 2.
                    // Alternative: "Seatbelt" EA vs others E. 
                    // Let's pick B (Seatbelt - /i:/) vs Recommend/Investigate (/e/). Vehicle is the confusion. 
                    // I will mark B as correct answer for being clearly /i:/ while Rec/Inv are /e/.
                    vocab: ["recommend: g·ª£i √Ω", "seatbelt: d√¢y an to√†n", "vehicle: xe c·ªô", "investigate: ƒëi·ªÅu tra"],
                    ipa: ["/e/", "/i:/", "/…™…ô/ or /i:/", "/e/"],
                    rule: "Recommend v√† Investigate l√† /e/. Vehicle l√† /…™…ô/. Seatbelt l√† /i:/. (C√¢u n√†y ph√¢n lo·∫°i kh√≥, ch·ªçn B v√¨ √¢m d√†i r√µ nh·∫•t)."
                },
                {
                    q: "performed, approached, advertised, murdered",
                    options: ["perform<u>ed</u>", "approach<u>ed</u>", "advertis<u>ed</u>", "murder<u>ed</u>"],
                    correct: 1,
                    vocab: ["performed: tr√¨nh di·ªÖn", "approached: ti·∫øp c·∫≠n", "advertised: qu·∫£ng c√°o", "murdered: √°m s√°t"],
                    rule: "Approached (ch) -> ƒë·ªçc /t/. C√≤n l·∫°i h·ªØu thanh -> ƒë·ªçc /d/."
                },
                {
                    q: "illegal, sign, critic, direct",
                    options: ["<u>i</u>llegal", "s<u>i</u>gn", "crit<u>i</u>c", "d<u>i</u>rect"],
                    correct: 1,
                    vocab: ["illegal: b·∫•t h·ª£p ph√°p", "sign: bi·ªÉn b√°o", "critic: nh√† ph√™ b√¨nh", "direct: tr·ª±c ti·∫øp"],
                    ipa: ["/…™/", "/ai/", "/…™/", "/…™/ (ho·∫∑c /ai/ nh∆∞ng th∆∞·ªùng /…™/ trong Anh-M·ªπ)"],
                    rule: "Sign ƒë·ªçc l√† /ai/. Illegal, Critic ƒë·ªçc l√† /…™/. Direct c√≥ th·ªÉ /d…™/ ho·∫∑c /dai/, nh∆∞ng trong nh√≥m n√†y Sign r√µ nh·∫•t."
                },
                {
                    q: "terrified, entertained, produced, engaged",
                    options: ["terrif<u>ied</u>", "entertain<u>ed</u>", "produc<u>ed</u>", "engag<u>ed</u>"],
                    correct: 2,
                    vocab: ["terrified: khi·∫øp s·ª£", "entertained: gi·∫£i tr√≠", "produced: s·∫£n xu·∫•t", "engaged: ƒë√≠nh h√¥n"],
                    rule: "Produced (c=/s/) -> ƒë·ªçc /t/. C√≤n l·∫°i ƒë·ªçc /d/."
                },
                {
                    q: "talked, needed, cooked, booked",
                    options: ["talk<u>ed</u>", "need<u>ed</u>", "cook<u>ed</u>", "book<u>ed</u>"],
                    correct: 1,
                    vocab: ["talked: n√≥i", "needed: c·∫ßn", "cooked: n·∫•u", "booked: ƒë·∫∑t v√©"],
                    rule: "Needed -> /id/. C√≤n l·∫°i (k) -> /t/."
                },
                {
                    q: "played, closed, filled, needed",
                    options: ["play<u>ed</u>", "clos<u>ed</u>", "fill<u>ed</u>", "need<u>ed</u>"],
                    correct: 3,
                    vocab: ["played: ch∆°i", "closed: ƒë√≥ng", "filled: ƒë·ªï ƒë·∫ßy", "needed: c·∫ßn"],
                    rule: "Needed -> /id/. C√≤n l·∫°i -> /d/."
                },
                {
                    q: "frightened, amazed, disappointed, terrified",
                    options: ["frighten<u>ed</u>", "amaz<u>ed</u>", "disappoint<u>ed</u>", "terrif<u>ied</u>"],
                    correct: 2,
                    vocab: ["frightened: s·ª£ h√£i", "amazed: ng·∫°c nhi√™n", "disappointed: th·∫•t v·ªçng", "terrified: kinh h√£i"],
                    rule: "Disappointed (t) -> /id/. C√≤n l·∫°i -> /d/."
                },
                {
                    q: "thread, beam, breath, stead",
                    options: ["thr<u>ea</u>d", "b<u>ea</u>m", "br<u>ea</u>th", "st<u>ea</u>d"],
                    correct: 1,
                    vocab: ["thread: s·ª£i ch·ªâ", "beam: ch√πm tia/x√†", "breath: h∆°i th·ªü", "stead: thay v√¨ (instead)"],
                    ipa: ["/e/", "/i:/", "/e/", "/e/"],
                    rule: "Beam ƒë·ªçc /i:/. C√°c t·ª´ c√≤n l·∫°i ea ƒë·ªçc l√† /e/."
                },
                {
                    q: "parade, waste, later, gravy",
                    options: ["par<u>a</u>de", "w<u>a</u>ste", "l<u>a</u>ter", "gr<u>a</u>vy"],
                    correct: 0, 
                    // Parade /…ôÀàre…™d/ (ei), Waste /e…™/, Later /e…™/, Gravy /e…™/.
                    // Wait. Parade is /p…ôÀàre…™d/. Where is the diff?
                    // Maybe 'a' first syllable? P(a)rade /…ô/. W(a)ste /ei/. L(a)ter /ei/. Gr(a)vy /ei/.
                    // Yes. Testing 'a'.
                    options: ["p<u>a</u>rade", "w<u>a</u>ste", "l<u>a</u>ter", "gr<u>a</u>vy"],
                    correct: 0,
                    vocab: ["parade: di·ªÖu h√†nh", "waste: l√£ng ph√≠", "later: sau n√†y", "gravy: n∆∞·ªõc s·ªët"],
                    ipa: ["/…ô/", "/ei/", "/ei/", "/ei/"],
                    rule: "Ch·ªØ 'a' trong Parade l√† √¢m l∆∞·ªõt /…ô/ (tr·ªçng √¢m 2). C√°c t·ª´ c√≤n l·∫°i tr·ªçng √¢m 1 ho·∫∑c 1 √¢m ti·∫øt, a ƒë·ªçc l√† /ei/."
                },
                {
                    q: "naked, cooked, booked, walked",
                    options: ["nak<u>ed</u>", "cook<u>ed</u>", "book<u>ed</u>", "walk<u>ed</u>"],
                    correct: 0,
                    vocab: ["naked: tr·∫ßn tru·ªìng", "cooked: n·∫•u", "booked: ƒë·∫∑t ch·ªó", "walked: ƒëi b·ªô"],
                    rule: "Naked l√† t√≠nh t·ª´ ngo·∫°i l·ªá -> /id/. C√≤n l·∫°i k -> /t/."
                },
                {
                    q: "ahead, bread, pleasant, seat-belt",
                    options: ["ah<u>ea</u>d", "br<u>ea</u>d", "pl<u>ea</u>sant", "s<u>ea</u>t-belt"],
                    correct: 3,
                    vocab: ["ahead: ph√≠a tr∆∞·ªõc", "bread: b√°nh m√¨", "pleasant: d·ªÖ ch·ªãu", "seat-belt: d√¢y an to√†n"],
                    ipa: ["/e/", "/e/", "/e/", "/i:/"],
                    rule: "Seat-belt ƒë·ªçc /i:/. C√≤n l·∫°i ea ƒë·ªçc l√† /e/."
                },
                {
                    q: "ways, days, says, stays",
                    options: ["way<u>s</u>", "day<u>s</u>", "say<u>s</u>", "stay<u>s</u>"],
                    correct: 2,
                    vocab: ["ways: c√°ch/ƒë∆∞·ªùng", "days: ng√†y", "says: n√≥i (ng√¥i 3)", "stays: ·ªü"],
                    ipa: ["/z/", "/z/", "/sez/ (/e/)", "/z/"],
                    rule: "Says ƒë·∫∑c bi·ªát ƒë·ªçc l√† /sez/ (√¢m e ng·∫Øn). C√°c t·ª´ c√≤n l·∫°i g·ªëc ay /ei/ + s ƒë·ªçc l√† /z/."
                },
                {
                    q: "obey, key, grey, survey",
                    options: ["ob<u>ey</u>", "k<u>ey</u>", "gr<u>ey</u>", "surv<u>ey</u>"],
                    correct: 1,
                    vocab: ["obey: tu√¢n l·ªánh", "key: ch√¨a kh√≥a", "grey: m√†u x√°m", "survey: kh·∫£o s√°t"],
                    ipa: ["/ei/", "/i:/", "/ei/", "/ei/"],
                    rule: "Key ƒë·ªçc /i:/. C√≤n l·∫°i ey ƒë·ªçc l√† /ei/."
                },
                {
                    q: "stayed, washed, filled, annoyed",
                    options: ["stay<u>ed</u>", "wash<u>ed</u>", "fill<u>ed</u>", "annoy<u>ed</u>"],
                    correct: 1,
                    vocab: ["stayed: ·ªü", "washed: r·ª≠a", "filled: ƒë·ªï ƒë·∫ßy", "annoyed: l√†m phi·ªÅn"],
                    rule: "Washed (sh) -> ƒë·ªçc /t/. C√≤n l·∫°i ƒë·ªçc /d/."
                },
                {
                    q: "embarrassed, crowded, excited, divided",
                    options: ["embarrass<u>ed</u>", "crowd<u>ed</u>", "excit<u>ed</u>", "divid<u>ed</u>"],
                    correct: 0,
                    vocab: ["embarrassed: x·∫•u h·ªï", "crowded: ƒë√¥ng ƒë√∫c", "excited: h√†o h·ª©ng", "divided: b·ªã chia c·∫Øt"],
                    rule: "Crowded, Excited, Divided ƒë·ªÅu t·∫≠n c√πng t/d -> ƒë·ªçc /id/. Embarrassed (s) -> ƒë·ªçc /t/."
                },
                {
                    q: "ahead, instead, seat-belt, bread",
                    options: ["ah<u>ea</u>d", "inst<u>ea</u>d", "s<u>ea</u>t-belt", "br<u>ea</u>d"],
                    correct: 2,
                    vocab: ["ahead: tr∆∞·ªõc", "instead: thay v√¨", "seat-belt: d√¢y an to√†n", "bread: b√°nh m√¨"],
                    rule: "Seat-belt /i:/. C√≤n l·∫°i ea ƒë·ªçc /e/."
                },
                {
                    q: "left, centre, enter, frighten",
                    options: ["l<u>e</u>ft", "c<u>e</u>ntre", "<u>e</u>nter", "fright<u>e</u>n"],
                    correct: 3,
                    vocab: ["left: tr√°i", "centre: trung t√¢m", "enter: v√†o", "frighten: l√†m s·ª£"],
                    ipa: ["/e/", "/e/", "/e/", "/…ô/"],
                    rule: "Frighten √¢m e ·ªü √¢m ti·∫øt 2 kh√¥ng nh·∫•n -> /…ô/. C√°c t·ª´ c√≤n l·∫°i nh·∫•n √¢m e -> /e/."
                },
                {
                    q: "traffic, plane, station, pavement",
                    options: ["tr<u>a</u>ffic", "pl<u>a</u>ne", "st<u>a</u>tion", "p<u>a</u>vement"],
                    correct: 0,
                    vocab: ["traffic: giao th√¥ng", "plane: m√°y bay", "station: tr·∫°m", "pavement: v·ªâa h√®"],
                    ipa: ["/√¶/", "/ei/", "/ei/", "/ei/"],
                    rule: "Traffic ƒë·ªçc /√¶/. C√≤n l·∫°i /ei/."
                },
                {
                    q: "washed, needed, danced, matched",
                    options: ["wash<u>ed</u>", "need<u>ed</u>", "danc<u>ed</u>", "match<u>ed</u>"],
                    correct: 1,
                    vocab: ["washed: r·ª≠a", "needed: c·∫ßn", "danced: nh·∫£y", "matched: n·ªëi"],
                    rule: "Needed -> /id/. C√≤n l·∫°i (sh, ce/s/, ch) -> /t/."
                },
                {
                    q: "wanted, filled, stayed, played",
                    options: ["want<u>ed</u>", "fill<u>ed</u>", "stay<u>ed</u>", "play<u>ed</u>"],
                    correct: 0,
                    vocab: ["wanted: mu·ªën", "filled: ƒë·ªï ƒë·∫ßy", "stayed: ·ªü", "played: ch∆°i"],
                    rule: "Wanted -> /id/. C√≤n l·∫°i -> /d/."
                }
            ]
        },
        {
            section: "II. STRESS (Tr·ªçng √¢m)",
            instruction: "Choose the word whose main stressed syllable is placed differently.",
            questions: [
                {
                    q: "silent, noisy, pretty, polite",
                    options: ["silent", "noisy", "pretty", "polite"],
                    correct: 3,
                    vocab: ["silent: im l·∫∑ng", "noisy: ·ªìn √†o", "pretty: xinh", "polite: l·ªãch s·ª±"],
                    ipa: ["1", "1", "1", "2"],
                    rule: "Polite nh·∫•n √¢m 2 (/p…ôÀàla…™t/). C√°c t√≠nh t·ª´ 2 √¢m ti·∫øt c√≤n l·∫°i nh·∫•n √¢m 1."
                },
                {
                    q: "station, season, police, sandal",
                    options: ["station", "season", "police", "sandal"],
                    correct: 2,
                    vocab: ["station: nh√† ga", "season: m√πa", "police: c·∫£nh s√°t", "sandal: xƒÉng ƒëan"],
                    ipa: ["1", "1", "2", "1"],
                    rule: "Police nh·∫•n √¢m 2 (/p…ôÀàliÀês/). C√°c danh t·ª´ 2 √¢m ti·∫øt c√≤n l·∫°i nh·∫•n √¢m 1."
                },
                {
                    q: "agree, hurry, enter, visit",
                    options: ["agree", "hurry", "enter", "visit"],
                    correct: 0,
                    vocab: ["agree: ƒë·ªìng √Ω", "hurry: v·ªôi v√£", "enter: v√†o", "visit: thƒÉm"],
                    ipa: ["2", "1", "1", "1"],
                    rule: "Agree nh·∫•n √¢m 2 (/…ôÀà…°riÀê/). C√°c ƒë·ªông t·ª´ c√≤n l·∫°i nh·∫•n √¢m 1 (ngo·∫°i l·ªá)."
                },
                {
                    q: "fasten, describe, listen, hover",
                    options: ["fasten", "describe", "listen", "hover"],
                    correct: 1,
                    vocab: ["fasten: th·∫Øt", "describe: m√¥ t·∫£", "listen: nghe", "hover: bay l∆∞·ª£n"],
                    ipa: ["1", "2", "1", "1"],
                    rule: "Describe nh·∫•n √¢m 2. C√°c ƒë·ªông t·ª´ c√≤n l·∫°i t·∫≠n c√πng -en, -er th∆∞·ªùng nh·∫•n √¢m 1."
                },
                {
                    q: "degree, student, funny, widen",
                    options: ["degree", "student", "funny", "widen"],
                    correct: 0,
                    vocab: ["degree: b·∫±ng c·∫•p/ƒë·ªô", "student: h·ªçc sinh", "funny: vui v·∫ª", "widen: m·ªü r·ªông"],
                    ipa: ["2", "1", "1", "1"],
                    rule: "Degree nh·∫•n √¢m 2. C√≤n l·∫°i nh·∫•n √¢m 1."
                },
                {
                    q: "traffic, dancer, cycling, balloon",
                    options: ["traffic", "dancer", "cycling", "balloon"],
                    correct: 3,
                    vocab: ["traffic: giao th√¥ng", "dancer: v≈© c√¥ng", "cycling: ƒë·∫°p xe", "balloon: b√≥ng bay"],
                    ipa: ["1", "1", "1", "2"],
                    rule: "Balloon nh·∫•n √¢m 2 (/b…ôÀàluÀên/). C√≤n l·∫°i nh·∫•n √¢m 1."
                },
                {
                    q: "central, gripping, complete, boring",
                    options: ["central", "gripping", "complete", "boring"],
                    correct: 2,
                    vocab: ["central: trung t√¢m", "gripping: l√¥i cu·ªën", "complete: ho√†n th√†nh", "boring: nh√†m ch√°n"],
                    ipa: ["1", "1", "2", "1"],
                    rule: "Complete nh·∫•n √¢m 2. C√°c t√≠nh t·ª´ c√≤n l·∫°i nh·∫•n √¢m 1."
                },
                {
                    q: "obey, enter, answer, listen",
                    options: ["obey", "enter", "answer", "listen"],
                    correct: 0,
                    vocab: ["obey: tu√¢n l·ªánh", "enter: v√†o", "answer: tr·∫£ l·ªùi", "listen: nghe"],
                    ipa: ["2", "1", "1", "1"],
                    rule: "Obey nh·∫•n √¢m 2 (/…ôÀàbe…™/). C√°c ƒë·ªông t·ª´ c√≤n l·∫°i nh·∫•n √¢m 1."
                },
                {
                    q: "station, healthy, safety, alone",
                    options: ["station", "healthy", "safety", "alone"],
                    correct: 3,
                    vocab: ["station: tr·∫°m", "healthy: kh·ªèe m·∫°nh", "safety: s·ª± an to√†n", "alone: m·ªôt m√¨nh"],
                    ipa: ["1", "1", "1", "2"],
                    rule: "Alone nh·∫•n √¢m 2 (/…ôÀàl…ô än/). C√≤n l·∫°i nh·∫•n √¢m 1."
                },
                {
                    q: "tidy, compete, extend, mistake",
                    options: ["tidy", "compete", "extend", "mistake"],
                    correct: 0,
                    vocab: ["tidy: g·ªçn g√†ng", "compete: thi ƒë·∫•u", "extend: m·ªü r·ªông", "mistake: l·ªói"],
                    ipa: ["1", "2", "2", "2"],
                    rule: "Tidy nh·∫•n √¢m 1. C√°c ƒë·ªông t·ª´ 2 √¢m ti·∫øt c√≤n l·∫°i nh·∫•n √¢m 2."
                },
                {
                    q: "campaign, expand, survey, respect",
                    options: ["campaign", "expand", "survey", "respect"],
                    correct: 2, // Survey danh t·ª´ 1, ƒë·ªông t·ª´ 2. Nh∆∞ng th∆∞·ªùng trong nh√≥m n√†y Survey noun (1). 
                    // Campaign (2), Expand (2), Respect (2). Survey (1).
                    vocab: ["campaign: chi·∫øn d·ªãch", "expand: m·ªü r·ªông", "survey: kh·∫£o s√°t", "respect: t√¥n tr·ªçng"],
                    ipa: ["2", "2", "1 (N) / 2 (V)", "2"],
                    rule: "Survey (Danh t·ª´) nh·∫•n √¢m 1. Campaign, Expand, Respect nh·∫•n √¢m 2."
                },
                {
                    q: "gradual, technique, ethnic, province",
                    options: ["gradual", "technique", "ethnic", "province"],
                    correct: 1,
                    vocab: ["gradual: d·∫ßn d·∫ßn", "technique: k·ªπ thu·∫≠t", "ethnic: d√¢n t·ªôc", "province: t·ªânh"],
                    ipa: ["1", "2", "1", "1"],
                    rule: "Technique nh·∫•n √¢m 2 (g·ªëc Ph√°p -ique). C√≤n l·∫°i nh·∫•n √¢m 1."
                },
                {
                    q: "disappointed, competition, representative, participate",
                    options: ["disappointed", "competition", "representative", "participate"],
                    correct: 3,
                    vocab: ["disappointed: th·∫•t v·ªçng", "competition: cu·ªôc thi", "representative: ƒë·∫°i di·ªán", "participate: tham gia"],
                    ipa: ["3", "3", "3", "2"],
                    rule: "Participate nh·∫•n √¢m 2 (/p…ëÀêÀàt…™s.…™.pe…™t/). Disappointed (3), Competition (3 -tion), Representative (3)."
                },
                {
                    q: "complete, worksheet, explain, observe",
                    options: ["complete", "worksheet", "explain", "observe"],
                    correct: 1,
                    vocab: ["complete: ho√†n th√†nh", "worksheet: phi·∫øu b√†i t·∫≠p", "explain: gi·∫£i th√≠ch", "observe: quan s√°t"],
                    ipa: ["2", "1", "2", "2"],
                    rule: "Worksheet (Danh t·ª´ gh√©p) nh·∫•n √¢m 1. C√≤n l·∫°i ƒë·ªông t·ª´ nh·∫•n √¢m 2."
                },
                {
                    q: "traditional, entertainment, activity, variety",
                    options: ["traditional", "entertainment", "activity", "variety"],
                    correct: 1,
                    vocab: ["traditional: truy·ªÅn th·ªëng", "entertainment: gi·∫£i tr√≠", "activity: ho·∫°t ƒë·ªông", "variety: s·ª± ƒëa d·∫°ng"],
                    ipa: ["2", "3", "2", "2"],
                    rule: "Entertainment nh·∫•n √¢m 3 (ƒëu√¥i -ment kh√¥ng ƒë·ªïi, maintain nh·∫•n 2 -> entertain nh·∫•n 3). Traditional (2 -tion), Activity (2 -ity), Variety (2 -ety)."
                }
            ]
        }
    ];

    // --- RENDER LOGIC ---
    const container = document.getElementById('quiz-container');
    let totalQuestions = 0;
    let globalQuestionIndex = 0; // ƒê·ªÉ t·∫°o ID duy nh·∫•t

    function renderQuiz() {
        let html = '';
        quizData.forEach((section, sIndex) => {
            html += `<div class="section-title">${section.section}</div>`;
            html += `<p style="font-style:italic; color:#666; margin-bottom:20px;">Instructions: ${section.instruction}</p>`;
            
            section.questions.forEach((q, qIndex) => {
                totalQuestions++;
                const qID = `q_${sIndex}_${qIndex}`;
                
                html += `
                <div class="question-card" id="card_${qID}">
                    <div class="question-text">
                        <span class="question-number">Question ${totalQuestions}</span>
                        ${q.q}
                    </div>
                    
                    <div class="options-grid">
                        ${q.options.map((opt, oIndex) => `
                            <button class="option-btn" id="btn_${qID}_${oIndex}" onclick="selectOption('${qID}', ${oIndex})">
                                ${['A', 'B', 'C', 'D'][oIndex]}. ${opt}
                            </button>
                        `).join('')}
                    </div>

                    <button class="check-btn" id="check_${qID}" onclick="checkAnswer('${qID}', ${q.correct}, '${encodeURIComponent(JSON.stringify(q))}')">
                        KI·ªÇM TRA (CHECK)
                    </button>

                    <div class="explanation" id="exp_${qID}">
                        <div class="vocab-list">
                            <h4 style="margin-top:0">üìö Vocabulary & Translation:</h4>
                            ${q.vocab.map(v => `<span class="vocab-item">‚Ä¢ ${v}</span>`).join('')}
                        </div>
                        <div class="analysis">
                            <h4>üë®‚Äçüè´ Ms Mai An Explains:</h4>
                            <p>${q.rule}</p>
                            ${q.ipa ? `<p style="color:#666; font-size:0.9em">IPA: ${q.ipa.join(' vs ')}</p>` : ''}
                        </div>
                    </div>
                </div>
                `;
            });
        });
        container.innerHTML = html;
        document.getElementById('scoreText').innerText = `0/${totalQuestions}`;
    }

    // --- INTERACTION LOGIC ---
    const userAnswers = {};

    window.selectOption = function(qID, oIndex) {
        // N·∫øu ƒë√£ check r·ªìi th√¨ kh√¥ng cho ch·ªçn l·∫°i
        if(document.getElementById(`check_${qID}`).disabled) return;

        // Reset visual selection
        [0, 1, 2, 3].forEach(i => {
            const btn = document.getElementById(`btn_${qID}_${i}`);
            if(btn) btn.classList.remove('selected');
        });

        // Select new
        document.getElementById(`btn_${qID}_${oIndex}`).classList.add('selected');
        userAnswers[qID] = oIndex;
    }

    window.checkAnswer = function(qID, correctIndex, qDataStr) {
        const selected = userAnswers[qID];
        if (selected === undefined) {
            alert("Vui l√≤ng ch·ªçn m·ªôt ƒë√°p √°n tr∆∞·ªõc khi ki·ªÉm tra!");
            return;
        }

        // Disable interaction
        document.getElementById(`check_${qID}`).disabled = true;
        document.getElementById(`check_${qID}`).innerText = "ƒê√É KI·ªÇM TRA";

        // Show Correct/Wrong Visuals
        const correctBtn = document.getElementById(`btn_${qID}_${correctIndex}`);
        correctBtn.classList.add('correct');

        if (selected !== correctIndex) {
            const wrongBtn = document.getElementById(`btn_${qID}_${selected}`);
            wrongBtn.classList.add('wrong');
            // Sound effect placeholders
        } else {
            confettiEffect(document.getElementById(`card_${qID}`));
        }

        // Show Explanation
        const expBox = document.getElementById(`exp_${qID}`);
        expBox.style.display = "block";
    }

    window.submitAll = function() {
        let score = 0;
        let attempted = 0;

        // Loop through all questions to calculate score
        quizData.forEach((section, sIndex) => {
            section.questions.forEach((q, qIndex) => {
                const qID = `q_${sIndex}_${qIndex}`;
                // Auto check if not checked yet
                const btn = document.getElementById(`check_${qID}`);
                if (!btn.disabled) {
                   // N·∫øu ch∆∞a l√†m, highlight v√†ng ho·∫∑c check lu√¥n n·∫øu ƒë√£ ch·ªçn
                   if(userAnswers[qID] !== undefined) {
                       checkAnswer(qID, q.correct, JSON.stringify(q));
                   } else {
                       // Ch∆∞a ch·ªçn g√¨ c·∫£ -> Mark as wrong visual only
                       document.getElementById(`exp_${qID}`).style.display = "block";
                       document.getElementById(`btn_${qID}_${q.correct}`).classList.add('correct'); // Show answer
                       document.getElementById(`card_${qID}`).style.border = "2px solid #FFD700"; // Warn
                       btn.disabled = true;
                   }
                }
                
                if (userAnswers[qID] === q.correct) {
                    score++;
                }
            });
        });

        // Show Result Modal
        const modal = document.getElementById('resultModal');
        const scoreText = document.getElementById('scoreText');
        const feedback = document.getElementById('feedbackText');
        
        scoreText.innerText = `${score}/${totalQuestions}`;
        
        const percentage = (score/totalQuestions)*100;
        if(percentage >= 90) feedback.innerText = "Xu·∫•t s·∫Øc! Ms Mai An r·∫•t t·ª± h√†o v·ªÅ em! üåü";
        else if(percentage >= 70) feedback.innerText = "L√†m t·ªët l·∫Øm! C·ªë g·∫Øng th√™m ch√∫t n·ªØa nh√©! üí™";
        else feedback.innerText = "ƒê·ª´ng bu·ªìn, h√£y xem k·ªπ l·∫°i ph·∫ßn gi·∫£i th√≠ch nh√©! üìñ";

        modal.style.display = 'flex';
    }

    window.closeModal = function() {
        document.getElementById('resultModal').style.display = 'none';
        // Scroll to top
        window.scrollTo({top: 0, behavior: 'smooth'});
    }

    // --- CONFETTI EFFECT (Simple CSS/JS Implementation) ---
    function confettiEffect(element) {
        // Create simple particles
        for(let i=0; i<30; i++) {
            const p = document.createElement('div');
            p.style.position = 'absolute';
            p.style.width = '8px';
            p.style.height = '8px';
            p.style.background = ['#ff0', '#f00', '#0f0', '#00f'][Math.floor(Math.random()*4)];
            p.style.left = '50%';
            p.style.top = '50%';
            p.style.borderRadius = '50%';
            p.style.zIndex = '10';
            p.style.transition = 'all 1s ease-out';
            element.appendChild(p);

            setTimeout(() => {
                p.style.transform = `translate(${Math.random()*200 - 100}px, ${Math.random()*200 - 100}px) scale(0)`;
                p.style.opacity = 0;
            }, 10);

            setTimeout(() => p.remove(), 1000);
        }
    }

    // Initialize
    renderQuiz();

</script>
</body>
</html>