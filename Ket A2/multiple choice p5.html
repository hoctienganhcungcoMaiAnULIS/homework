<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Ms Mai An ULIS - A Wonderful Year</title>
    <link href="https://fonts.googleapis.com/css2?family=Quicksand:wght@500;700;900&display=swap" rel="stylesheet">
    <style>
        :root {
            /* Travel & Adventure Theme */
            --primary: #0984e3;      /* Ocean Blue */
            --secondary: #00b894;    /* Mint Green */
            --accent: #fdcb6e;       /* Sunrise Yellow */
            --correct: #00cec9;      /* Robin Egg Blue */
            --wrong: #d63031;        /* Chi-Gong Red */
            --text-dark: #2d3436;
        }

        * {
            box-sizing: border-box;
            font-family: 'Quicksand', sans-serif;
            margin: 0;
            padding: 0;
        }

        /* 1. ANIMATED GRADIENT BACKGROUND */
        body {
            overflow: hidden;
            color: var(--text-dark);
            background: linear-gradient(-45deg, #74b9ff, #55efc4, #ffeaa7, #81ecec);
            background-size: 400% 400%;
            animation: smoothGradient 18s ease infinite;
            height: 100vh;
            position: relative;
        }

        @keyframes smoothGradient {
            0% { background-position: 0% 50%; }
            50% { background-position: 100% 50%; }
            100% { background-position: 0% 50%; }
        }

        /* 2. FLOATING SVG PATTERN LAYER */
        .pattern-overlay {
            position: fixed;
            top: 0; left: 0; width: 100%; height: 100%;
            /* Travel Emojis: Plane, Croissant, Kangaroo, Snowy Mountain */
            background-image: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='250' height='250'%3E%3Ctext x='20' y='60' font-size='45'%3E‚úàÔ∏è%3C/text%3E%3Ctext x='160' y='120' font-size='40'%3Eü¶ò%3C/text%3E%3Ctext x='40' y='210' font-size='45'%3EüèîÔ∏è%3C/text%3E%3Ctext x='180' y='230' font-size='35'%3Eü•ê%3C/text%3E%3C/svg%3E");
            opacity: 0.3;
            pointer-events: none;
            z-index: 1;
            animation: floatSVG 40s linear infinite;
        }

        @keyframes floatSVG {
            from { background-position: 0 0; }
            to { background-position: 600px 600px; }
        }

        /* TOP CONTROL BAR */
        header {
            position: relative;
            z-index: 10;
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 15px 30px;
            background: rgba(255, 255, 255, 0.95);
            box-shadow: 0 6px 20px rgba(9, 132, 227, 0.15);
            border-bottom: 5px solid var(--primary);
        }

        .header-title {
            font-size: 1.5rem;
            color: var(--primary);
            font-weight: 900;
            text-transform: uppercase;
            letter-spacing: 1px;
        }

        .timer-container {
            display: flex;
            align-items: center;
            gap: 15px;
        }

        .btn-action {
            padding: 12px 25px;
            border: none;
            border-radius: 20px;
            font-size: 1.1rem;
            font-weight: 900;
            cursor: pointer;
            transition: all 0.2s cubic-bezier(0.175, 0.885, 0.32, 1.275);
            box-shadow: 0 6px 0 rgba(0,0,0,0.15);
        }

        .btn-start { background-color: var(--accent); color: #d35400; }
        .btn-start:active { transform: translateY(6px); box-shadow: none; }

        #timer-display {
            font-size: 2rem;
            font-weight: 900;
            color: var(--primary);
            background: #e8f4f8;
            padding: 5px 20px;
            border-radius: 15px;
            border: 3px dashed var(--primary);
            min-width: 120px;
            text-align: center;
        }

        /* SPLIT SCREEN */
        .main-container {
            display: flex;
            height: calc(100vh - 85px);
            position: relative;
            z-index: 5;
        }

        .panel {
            flex: 1;
            overflow-y: auto;
            padding: 30px;
            scroll-behavior: smooth;
        }

        .left-panel {
            background: rgba(255, 255, 255, 0.75);
            backdrop-filter: blur(12px);
            border-right: 4px dashed var(--primary);
        }

        /* READING CONTENT */
        .passage-title {
            font-size: 2.8rem;
            color: var(--primary);
            margin-bottom: 5px;
            text-align: center;
            font-weight: 900;
            text-shadow: 2px 2px 0px white;
        }
        
        .sub-title {
            text-align: center;
            color: #636e72;
            font-style: italic;
            margin-bottom: 25px;
            font-size: 1.2rem;
            font-weight: 700;
        }

        .paragraph-card {
            background: white;
            padding: 25px;
            border-radius: 25px;
            margin-bottom: 25px;
            box-shadow: 0 8px 15px rgba(0,0,0,0.05);
            border-left: 6px solid var(--secondary);
            font-size: 1.2rem;
            line-height: 1.7;
        }

        .btn-translate {
            background: var(--secondary);
            color: white;
            border: none;
            padding: 10px 18px;
            border-radius: 12px;
            font-weight: 800;
            font-size: 1rem;
            margin-top: 15px;
            cursor: pointer;
            box-shadow: 0 5px 0 #009432;
            transition: 0.2s;
        }
        .btn-translate:active { transform: translateY(5px); box-shadow: none; }

        .translation-text {
            display: none;
            margin-top: 20px;
            padding: 15px 20px;
            background: #e8f8f5;
            border-radius: 10px;
            font-size: 1.15rem;
            color: #009432;
            font-weight: 700;
            border: 2px dashed var(--secondary);
        }

        /* GLOSSARY */
        .glossary-wrapper {
            background: white;
            border-radius: 25px;
            padding: 25px;
            margin-top: 40px;
            border: 4px solid var(--primary);
            box-shadow: 0 10px 0 rgba(9, 132, 227, 0.2);
        }
        .glossary-title {
            color: var(--primary);
            text-align: center;
            font-size: 1.8rem;
            margin-bottom: 20px;
            font-weight: 900;
        }
        table { width: 100%; border-collapse: collapse; font-size: 1.1rem; }
        th, td { padding: 15px; text-align: left; border-bottom: 2px dashed #dfe6e9; }
        th { background: var(--primary); color: white; border-radius: 10px; font-size: 1.2rem;}
        tr:hover td { background: #f1f2f6; font-weight: 700; color: var(--primary); cursor: pointer; }

        /* QUIZ CARDS */
        .question-card {
            background: white;
            border-radius: 25px;
            padding: 30px;
            margin-bottom: 30px;
            box-shadow: 0 12px 0 rgba(0,0,0,0.08);
            border: 4px solid #fff;
            transition: all 0.3s;
        }
        .question-card:hover { transform: translateY(-5px); border-color: var(--primary); }

        .question-text {
            font-size: 1.4rem;
            font-weight: 900;
            color: var(--text-dark);
            margin-bottom: 25px;
        }

        .options-grid { display: flex; flex-direction: column; gap: 15px; }

        .option-btn {
            width: 100%;
            background: #f1f2f6;
            border: 3px solid #dfe6e9;
            padding: 18px 25px;
            border-radius: 18px;
            font-size: 1.25rem;
            font-weight: 800;
            color: #2d3436;
            cursor: pointer;
            text-align: left;
            transition: all 0.2s cubic-bezier(0.175, 0.885, 0.32, 1.275);
            box-shadow: 0 6px 0 #dfe6e9;
            display: flex;
            align-items: center;
        }
        
        .option-btn:hover:not(:disabled) {
            transform: scale(1.02);
            background: white;
            border-color: var(--primary);
            color: var(--primary);
            box-shadow: 0 6px 0 var(--primary);
        }

        .option-btn:active:not(:disabled) { transform: translateY(6px); box-shadow: none; }
        .option-btn.correct { background: var(--correct); border-color: #00b894; color: white; box-shadow: 0 6px 0 #00b894; }
        .option-btn.wrong { background: var(--wrong); border-color: #b33939; color: white; box-shadow: 0 6px 0 #b33939; animation: shake 0.4s; }

        @keyframes shake {
            0%, 100% { transform: translateX(0); }
            25% { transform: translateX(-10px) rotate(-2deg); }
            75% { transform: translateX(10px) rotate(2deg); }
        }

        /* DETAILED EXPLANATION BOX */
        .explanation-box {
            display: none;
            margin-top: 25px;
            padding: 20px;
            background: #fff9c4;
            border: 4px dashed var(--accent);
            border-radius: 15px;
            animation: bounceIn 0.5s cubic-bezier(0.68, -0.55, 0.265, 1.55);
        }
        @keyframes bounceIn {
            0% { opacity: 0; transform: scale(0.8); }
            100% { opacity: 1; transform: scale(1); }
        }
        .explanation-box h4 { color: #d35400; margin-bottom: 15px; font-size: 1.3rem; font-weight: 900; }
        .explanation-box p { margin-bottom: 10px; font-size: 1.15rem; line-height: 1.6; color: #2d3436;}
        .explanation-box .highlight { background: var(--accent); color: #2d3436; padding: 2px 8px; border-radius: 5px; font-weight: bold; }

        /* SUBMIT BUTTON */
        .btn-submit {
            display: block; width: 100%;
            background: var(--primary); color: white;
            font-size: 1.8rem; font-weight: 900;
            padding: 25px; border: none; border-radius: 25px;
            cursor: pointer; box-shadow: 0 10px 0 #0652dd;
            margin-top: 30px; transition: all 0.2s;
            text-transform: uppercase; letter-spacing: 2px;
        }
        .btn-submit:hover { transform: scale(1.02); }
        .btn-submit:active { transform: translateY(10px); box-shadow: none; }

        /* MODAL POPUP */
        #result-modal {
            display: none; position: fixed; top: 0; left: 0; width: 100%; height: 100%;
            background: rgba(0,0,0,0.85); z-index: 100; justify-content: center; align-items: center; backdrop-filter: blur(8px);
        }
        .modal-content {
            background: white; padding: 50px; border-radius: 40px; text-align: center;
            max-width: 550px; width: 90%; border: 8px solid var(--accent);
            box-shadow: 0 20px 50px rgba(0,0,0,0.5);
            animation: popIn 0.6s cubic-bezier(0.68, -0.55, 0.265, 1.55);
        }
        @keyframes popIn { 0% { transform: scale(0.3) rotate(-10deg); opacity: 0; } 100% { transform: scale(1) rotate(0); opacity: 1; } }
        
        .score-circle {
            width: 180px; height: 180px; background: var(--primary); border-radius: 50%;
            display: flex; justify-content: center; align-items: center;
            font-size: 4.5rem; font-weight: 900; color: white; margin: 0 auto 25px;
            border: 10px solid var(--accent); box-shadow: inset 0 0 20px rgba(0,0,0,0.2);
        }

        /* CUSTOM SCROLLBAR */
        ::-webkit-scrollbar { width: 14px; }
        ::-webkit-scrollbar-track { background: transparent; }
        ::-webkit-scrollbar-thumb { background: var(--primary); border-radius: 20px; border: 3px solid white; }
        ::-webkit-scrollbar-thumb:hover { background: #0652dd; }

        #confetti-canvas { position: fixed; top: 0; left: 0; width: 100%; height: 100%; pointer-events: none; z-index: 999; }
    </style>
</head>
<body>

    <div class="pattern-overlay"></div>
    <canvas id="confetti-canvas"></canvas>

    <header>
        <div class="header-title">üåç Ms Mai An ULIS | A Wonderful Year</div>
        <div class="timer-container">
            <div id="timer-display">10:00</div>
            <button class="btn-action btn-start" id="btn-timer" onclick="toggleTimer()">‚ñ∂ B·∫ÆT ƒê·∫¶U T√çNH GI·ªú</button>
        </div>
    </header>

    <div class="main-container">
        <div class="panel left-panel">
            <h1 class="passage-title">A wonderful year</h1>
            <p class="sub-title">Ben Jones talks about his year of travel before studying at university.</p>

            <div class="paragraph-card">
                <p>I always knew I wanted to spend a year travelling before university. I wanted to see the world, improve my skiing, make new friends from other countries and, more than anything, try lots of things I‚Äôve never done before.</p>
                <button class="btn-translate" onclick="toggleTranslation(this)">üìñ B·∫¢N D·ªäCH ƒê·∫¶Y ƒê·ª¶</button>
                <div class="translation-text">T√¥i lu√¥n bi·∫øt m√¨nh mu·ªën d√†nh m·ªôt nƒÉm ƒëi du l·ªãch tr∆∞·ªõc khi v√†o ƒë·∫°i h·ªçc. T√¥i mu·ªën kh√°m ph√° th·∫ø gi·ªõi, c·∫£i thi·ªán k·ªπ nƒÉng tr∆∞·ª£t tuy·∫øt, k·∫øt b·∫°n m·ªõi t·ª´ c√°c qu·ªëc gia kh√°c v√†, h∆°n b·∫•t c·ª© ƒëi·ªÅu g√¨, th·ª≠ nghi·ªám nhi·ªÅu ƒëi·ªÅu t√¥i ch∆∞a t·ª´ng l√†m tr∆∞·ªõc ƒë√¢y.</div>
            </div>

            <div class="paragraph-card">
                <p>The first place I visited was France. I‚Äôve always loved the French language and I wanted to study it. Then, while I was there, I became interested in French food. I took some cooking lessons at a farmhouse in the French countryside, and learned to make lots of lovely dishes.</p>
                <button class="btn-translate" onclick="toggleTranslation(this)">üìñ B·∫¢N D·ªäCH ƒê·∫¶Y ƒê·ª¶</button>
                <div class="translation-text">N∆°i ƒë·∫ßu ti√™n t√¥i ƒë·∫øn l√† Ph√°p. T√¥i lu√¥n y√™u th√≠ch ti·∫øng Ph√°p v√† t√¥i mu·ªën h·ªçc ng√¥n ng·ªØ n√†y. Sau ƒë√≥, trong l√∫c ·ªü ƒë√≥, t√¥i b·∫Øt ƒë·∫ßu h·ª©ng th√∫ v·ªõi ·∫©m th·ª±c Ph√°p. T√¥i ƒë√£ tham gia v√†i l·ªõp h·ªçc n·∫•u ƒÉn t·∫°i m·ªôt trang tr·∫°i ·ªü v√πng n√¥ng th√¥n n∆∞·ªõc Ph√°p, v√† h·ªçc c√°ch l√†m nhi·ªÅu m√≥n ƒÉn ngon tuy·ªát.</div>
            </div>

            <div class="paragraph-card">
                <p>Next, I visited Australia. My cousins live near the river in Sydney, so I had somewhere to stay. To begin with, we spent a lot of time sailing in their boat. But then I got a job in a hotel. It was great ‚Äì the customers and staff were so friendly.</p>
                <button class="btn-translate" onclick="toggleTranslation(this)">üìñ B·∫¢N D·ªäCH ƒê·∫¶Y ƒê·ª¶</button>
                <div class="translation-text">Ti·∫øp theo, t√¥i ƒë·∫øn thƒÉm √öc. C√°c anh em h·ªç c·ªßa t√¥i s·ªëng g·∫ßn m·ªôt con s√¥ng ·ªü Sydney, n√™n t√¥i c√≥ ch·ªó ƒë·ªÉ ·ªü. Ban ƒë·∫ßu, ch√∫ng t√¥i d√†nh nhi·ªÅu th·ªùi gian ch√®o thuy·ªÅn c·ªßa h·ªç. Nh∆∞ng sau ƒë√≥ t√¥i nh·∫≠n m·ªôt c√¥ng vi·ªác trong kh√°ch s·∫°n. Th·∫≠t tuy·ªát v·ªùi - kh√°ch h√†ng v√† nh√¢n vi√™n ƒë·ªÅu r·∫•t th√¢n thi·ªán.</div>
            </div>

            <div class="paragraph-card">
                <p>My last country was Japan, where I learned to become a skiing teacher. I planned to do a three-week course. But when I got there, I saw that I wasn‚Äôt actually that good, so I changed to a seven-week one. The course was amazing and afterwards I got a job with a skiing company.</p>
                <button class="btn-translate" onclick="toggleTranslation(this)">üìñ B·∫¢N D·ªäCH ƒê·∫¶Y ƒê·ª¶</button>
                <div class="translation-text">Qu·ªëc gia cu·ªëi c√πng c·ªßa t√¥i l√† Nh·∫≠t B·∫£n, n∆°i t√¥i h·ªçc ƒë·ªÉ tr·ªü th√†nh gi√°o vi√™n d·∫°y tr∆∞·ª£t tuy·∫øt. T√¥i d·ª± ƒë·ªãnh h·ªçc m·ªôt kh√≥a ba tu·∫ßn. Nh∆∞ng khi ƒë·∫øn n∆°i, t√¥i th·∫•y m√¨nh th·ª±c s·ª± ch∆∞a gi·ªèi l·∫Øm, n√™n t√¥i chuy·ªÉn sang kh√≥a b·∫£y tu·∫ßn. Kh√≥a h·ªçc r·∫•t tuy·ªát v·ªùi v√† sau ƒë√≥ t√¥i nh·∫≠n ƒë∆∞·ª£c c√¥ng vi·ªác t·∫°i m·ªôt c√¥ng ty tr∆∞·ª£t tuy·∫øt.</div>
            </div>

            <div class="paragraph-card">
                <p>The other teachers were very friendly and on our days off, we did activities like snowboarding. One weekend we even did winter camping. That was quite interesting, but it was cold, so I can‚Äôt say I slept well! Anyway, we‚Äôre all planning to meet up soon and I can‚Äôt wait.</p>
                <button class="btn-translate" onclick="toggleTranslation(this)">üìñ B·∫¢N D·ªäCH ƒê·∫¶Y ƒê·ª¶</button>
                <div class="translation-text">Nh·ªØng gi√°o vi√™n kh√°c r·∫•t th√¢n thi·ªán v√† v√†o nh·ªØng ng√†y ngh·ªâ, ch√∫ng t√¥i tham gia c√°c ho·∫°t ƒë·ªông nh∆∞ tr∆∞·ª£t tuy·∫øt b·∫±ng v√°n. M·ªôt d·ªãp cu·ªëi tu·∫ßn, ch√∫ng t√¥i th·∫≠m ch√≠ c√≤n ƒëi c·∫Øm tr·∫°i m√πa ƒë√¥ng. Tr·∫£i nghi·ªám ƒë√≥ kh√° th√∫ v·ªã, nh∆∞ng tr·ªùi l·∫°nh n√™n t√¥i kh√¥ng th·ªÉ n√≥i l√† m√¨nh ƒë√£ ng·ªß ngon! D√π sao ƒëi n·ªØa, t·∫•t c·∫£ ch√∫ng t√¥i ƒëang l√™n k·∫ø ho·∫°ch s·ªõm g·∫∑p l·∫°i nhau v√† t√¥i kh√¥ng th·ªÉ ch·ªù ƒë·ª£i th√™m n·ªØa.</div>
            </div>

            <div class="glossary-wrapper">
                <h3 class="glossary-title">üß≥ Travel & Life Vocabulary (A2-B2)</h3>
                <table>
                    <thead><tr><th>T·ª´ v·ª±ng</th><th>Lo·∫°i t·ª´</th><th>Nghƒ©a Ti·∫øng Vi·ªát</th></tr></thead>
                    <tbody>
                        <tr><td>1. Improve</td><td>Verb</td><td>C·∫£i thi·ªán, trau d·ªìi</td></tr>
                        <tr><td>2. Experience</td><td>Noun</td><td>Tr·∫£i nghi·ªám, kinh nghi·ªám</td></tr>
                        <tr><td>3. Countryside</td><td>Noun</td><td>V√πng n√¥ng th√¥n</td></tr>
                        <tr><td>4. Farmhouse</td><td>Noun</td><td>N√¥ng tr·∫°i, trang tr·∫°i</td></tr>
                        <tr><td>5. Customer</td><td>Noun</td><td>Kh√°ch h√†ng</td></tr>
                        <tr><td>6. Staff</td><td>Noun</td><td>Nh√¢n vi√™n (n√≥i chung)</td></tr>
                        <tr><td>7. Actually</td><td>Adverb</td><td>Th·ª±c ra, th·ª±c s·ª±</td></tr>
                        <tr><td>8. Snowboarding</td><td>Noun</td><td>M√¥n tr∆∞·ª£t tuy·∫øt b·∫±ng v√°n</td></tr>
                        <tr><td>9. Pleasant</td><td>Adjective</td><td>D·ªÖ ch·ªãu, tho·∫£i m√°i</td></tr>
                        <tr><td>10. Meet up</td><td>Phrasal Verb</td><td>G·∫∑p g·ª°, t·ª• h·ªçp</td></tr>
                    </tbody>
                </table>
            </div>
        </div>

        <div class="panel right-panel">
            <div id="quiz-container"></div>
            <button class="btn-submit" onclick="submitQuiz()">üöÄ CH·ªêT ƒê√ÅP √ÅN! üöÄ</button>
        </div>
    </div>

    <div id="result-modal">
        <div class="modal-content">
            <h2 style="color: var(--primary); font-size: 2.5rem; margin-bottom: 20px;">K·∫æT QU·∫¢ H√ÄNH TR√åNH</h2>
            <div class="score-circle" id="final-score">0/5</div>
            <h3 id="feedback-msg" style="color: #2d3436; margin-bottom: 20px; font-size: 1.6rem; line-height: 1.5;"></h3>
            <button class="btn-action btn-start" onclick="location.reload()" style="width: 100%; font-size: 1.3rem; padding: 18px; border-radius: 15px;">üîÑ B·∫ÆT ƒê·∫¶U H√ÄNH TR√åNH M·ªöI</button>
        </div>
    </div>

    <script>
        // --- 1. D·ªÆ LI·ªÜU ƒê·ªÄ B√ÄI & GI·∫¢I TH√çCH CHI TI·∫æT ---
        const quizData = [
            {
                id: 1, 
                question: "1. What did Ben want to do during the year after he left school?",
                options: [
                    {text: "try some different sports", isCorrect: false, label: "A"},
                    {text: "have some new experiences", isCorrect: true, label: "B"},
                    {text: "meet up with old friends", isCorrect: false, label: "C"}
                ],
                explanation: `<p><strong>D·ªãch c√¢u h·ªèi:</strong> Ben mu·ªën l√†m g√¨ trong m·ªôt nƒÉm sau khi r·ªùi tr∆∞·ªùng h·ªçc?</p>
                <p><strong>T·∫°i sao ch·ªçn B?</strong> ·ªû ƒëo·∫°n 1, Ben n√≥i: <span class="highlight">"...try lots of things I‚Äôve never done before."</span> (th·ª≠ nghi·ªám nhi·ªÅu ƒëi·ªÅu t√¥i ch∆∞a t·ª´ng l√†m tr∆∞·ªõc ƒë√¢y). Vi·ªác th·ª≠ nh·ªØng ƒëi·ªÅu ch∆∞a t·ª´ng l√†m ch√≠nh l√† "c√≥ nh·ªØng tr·∫£i nghi·ªám m·ªõi" (have some new experiences).</p>
                <p><em>T·∫°i sao C sai?</em> C·∫≠u ·∫•y mu·ªën "make new friends" (k·∫øt b·∫°n m·ªõi), ch·ª© kh√¥ng ph·∫£i g·∫∑p l·∫°i b·∫°n c≈©.</p>`
            },
            {
                id: 2, 
                question: "2. Why did Ben go to France?",
                options: [
                    {text: "to do a French cooking course", isCorrect: false, label: "A"},
                    {text: "to see the French countryside", isCorrect: false, label: "B"},
                    {text: "to learn to speak French", isCorrect: true, label: "C"}
                ],
                explanation: `<p><strong>D·ªãch c√¢u h·ªèi:</strong> T·∫°i sao Ben l·∫°i ƒë·∫øn Ph√°p?</p>
                <p><strong>T·∫°i sao ch·ªçn C?</strong> ƒêo·∫°n 2 ghi r√µ: <span class="highlight">"I‚Äôve always loved the French language and I wanted to study it."</span> (T√¥i lu√¥n y√™u th√≠ch ti·∫øng Ph√°p v√† t√¥i mu·ªën h·ªçc n√≥). H·ªçc ti·∫øng Ph√°p ch√≠nh l√† "learn to speak French".</p>
                <p><em>T·∫°i sao A sai?</em> N·∫•u ƒÉn l√† vi·ªác c·∫≠u ·∫•y h·ª©ng th√∫ "sau khi ƒë√£ ƒë·∫øn ƒë√≥" (while I was there), kh√¥ng ph·∫£i m·ª•c ƒë√≠ch ban ƒë·∫ßu khi ƒëi.</p>`
            },
            {
                id: 3, 
                question: "3. Where did Ben live when he was in Australia?",
                options: [
                    {text: "in the hotel where he worked", isCorrect: false, label: "A"},
                    {text: "with members of his family", isCorrect: true, label: "B"},
                    {text: "on a boat on the river", isCorrect: false, label: "C"}
                ],
                explanation: `<p><strong>D·ªãch c√¢u h·ªèi:</strong> Ben ƒë√£ s·ªëng ·ªü ƒë√¢u khi c·∫≠u ·∫•y ·ªü √öc?</p>
                <p><strong>T·∫°i sao ch·ªçn B?</strong> ·ªû ƒëo·∫°n 3, Ben k·ªÉ: <span class="highlight">"My cousins live near the river in Sydney, so I had somewhere to stay."</span> (Anh h·ªç t√¥i s·ªëng g·∫ßn s√¥ng... n√™n t√¥i c√≥ ch·ªó ƒë·ªÉ ·ªü). "Cousins" (Anh/ch·ªã em h·ªç) ch√≠nh l√† th√†nh vi√™n trong gia ƒë√¨nh (members of his family).</p>`
            },
            {
                id: 4, 
                question: "4. Why did Ben change his course in Japan?",
                options: [
                    {text: "He heard about a better one.", isCorrect: false, label: "A"},
                    {text: "He knew he needed more practice.", isCorrect: true, label: "B"},
                    {text: "He wasn‚Äôt enjoying the first one.", isCorrect: false, label: "C"}
                ],
                explanation: `<p><strong>D·ªãch c√¢u h·ªèi:</strong> T·∫°i sao Ben thay ƒë·ªïi kh√≥a h·ªçc c·ªßa m√¨nh ·ªü Nh·∫≠t B·∫£n?</p>
                <p><strong>T·∫°i sao ch·ªçn B?</strong> ƒêo·∫°n 4 ti·∫øt l·ªô: <span class="highlight">"...when I got there, I saw that I wasn‚Äôt actually that good, so I changed to a seven-week one."</span> (...khi ƒë·∫øn n∆°i, t√¥i th·∫•y m√¨nh th·ª±c s·ª± ch∆∞a gi·ªèi l·∫Øm, n√™n t√¥i chuy·ªÉn sang kh√≥a 7 tu·∫ßn). Vi·ªác th·∫•y m√¨nh ch∆∞a ƒë·ªß gi·ªèi ƒë·ªìng nghƒ©a v·ªõi vi·ªác c·∫≠u ·∫•y "c·∫ßn luy·ªán t·∫≠p nhi·ªÅu h∆°n" (needed more practice).</p>`
            },
            {
                id: 5, 
                question: "5. What does Ben say about winter camping?",
                options: [
                    {text: "It wasn‚Äôt pleasant at night.", isCorrect: true, label: "A"},
                    {text: "He would love to do it again soon.", isCorrect: false, label: "B"},
                    {text: "It was the most interesting thing he‚Äôs ever done.", isCorrect: false, label: "C"}
                ],
                explanation: `<p><strong>D·ªãch c√¢u h·ªèi:</strong> Ben n√≥i g√¨ v·ªÅ vi·ªác c·∫Øm tr·∫°i m√πa ƒë√¥ng?</p>
                <p><strong>T·∫°i sao ch·ªçn A?</strong> ·ªû ƒëo·∫°n cu·ªëi, Ben b·ªôc b·∫°ch: <span class="highlight">"...it was cold, so I can‚Äôt say I slept well!"</span> (...tr·ªùi l·∫°nh n√™n t√¥i kh√¥ng th·ªÉ n√≥i l√† m√¨nh ƒë√£ ng·ªß ngon!). Kh√¥ng ng·ªß ngon v√¨ tr·ªùi l·∫°nh t·ª©c l√† "kh√¥ng tho·∫£i m√°i v√†o ban ƒë√™m" (wasn‚Äôt pleasant at night).</p>`
            }
        ];

        let score = 0;
        let answeredQuestions = new Set();

        // Thu·∫≠t to√°n x√°o tr·ªôn m·∫£ng
        function shuffleArray(array) {
            for (let i = array.length - 1; i > 0; i--) {
                const j = Math.floor(Math.random() * (i + 1));
                [array[i], array[j]] = [array[j], array[i]];
            }
            return array;
        }

        // --- 2. RENDER GIAO DI·ªÜN C√ÇU H·ªéI ---
        function renderQuiz() {
            const container = document.getElementById('quiz-container');
            container.innerHTML = '';

            quizData.forEach((q, index) => {
                // X√°o tr·ªôn c√°c l·ª±a ch·ªçn A, B, C
                const shuffledOptions = shuffleArray([...q.options]);

                const card = document.createElement('div');
                card.className = 'question-card';
                card.innerHTML = `<div class="question-text">${q.question}</div>`;

                const optionsGrid = document.createElement('div');
                optionsGrid.className = 'options-grid';

                shuffledOptions.forEach(opt => {
                    const btn = document.createElement('button');
                    btn.className = 'option-btn';
                    btn.innerText = opt.text;
                    btn.onclick = () => handleAnswer(btn, opt.isCorrect, index, q.explanation, optionsGrid, q.options.find(o => o.isCorrect).text);
                    optionsGrid.appendChild(btn);
                });
                card.appendChild(optionsGrid);

                // H·ªôp gi·∫£i th√≠ch chi ti·∫øt (·∫©n ƒëi ban ƒë·∫ßu)
                const explBox = document.createElement('div');
                explBox.className = 'explanation-box';
                explBox.id = `expl-${index}`;
                explBox.innerHTML = `<h4>üí° Kh√°m ph√° ƒë√°p √°n:</h4>` + q.explanation;
                card.appendChild(explBox);

                container.appendChild(card);
            });
        }

        // --- 3. H·ªÜ TH·ªêNG √ÇM THANH WEB AUDIO API ---
        const AudioContext = window.AudioContext || window.webkitAudioContext;
        let audioCtx;

        function playSound(type) {
            if (!audioCtx) audioCtx = new AudioContext();
            if (audioCtx.state === 'suspended') audioCtx.resume();
            
            const osc = audioCtx.createOscillator();
            const gainNode = audioCtx.createGain();
            osc.connect(gainNode);
            gainNode.connect(audioCtx.destination);

            if (type === 'correct') {
                osc.type = 'sine';
                osc.frequency.setValueAtTime(523.25, audioCtx.currentTime); // C5
                osc.frequency.exponentialRampToValueAtTime(1046.50, audioCtx.currentTime + 0.15); // C6
                gainNode.gain.setValueAtTime(0.5, audioCtx.currentTime);
                gainNode.gain.exponentialRampToValueAtTime(0.01, audioCtx.currentTime + 0.4);
                osc.start(); osc.stop(audioCtx.currentTime + 0.4);
            } else {
                osc.type = 'sawtooth'; // √Çm b√°o l·ªói (Buzz)
                osc.frequency.setValueAtTime(200, audioCtx.currentTime);
                osc.frequency.linearRampToValueAtTime(120, audioCtx.currentTime + 0.3);
                gainNode.gain.setValueAtTime(0.4, audioCtx.currentTime);
                gainNode.gain.linearRampToValueAtTime(0.01, audioCtx.currentTime + 0.3);
                osc.start(); osc.stop(audioCtx.currentTime + 0.3);
            }
        }

        // --- 4. X·ª¨ L√ù L∆Ø·ª¢T CH∆†I (T·ª∞ ƒê·ªòNG HI·ªÜN GI·∫¢I TH√çCH) ---
        function handleAnswer(btn, isCorrect, qIndex, explanationHTML, grid, correctText) {
            if (answeredQuestions.has(qIndex)) return; // Ch·ªâ cho click 1 l·∫ßn
            answeredQuestions.add(qIndex);

            const allBtns = grid.querySelectorAll('.option-btn');
            allBtns.forEach(b => b.disabled = true); // Kh√≥a to√†n b·ªô n√∫t

            // B·∫¨T B·∫¢NG GI·∫¢I TH√çCH NGAY L·∫¨P T·ª®C CHO HS H·ªåC
            document.getElementById(`expl-${qIndex}`).style.display = 'block';

            if (isCorrect) {
                btn.classList.add('correct');
                playSound('correct');
                fireConfetti();
                score++;
            } else {
                btn.classList.add('wrong');
                playSound('wrong');
                // Auto highlight ƒë√°p √°n ƒë√∫ng m√†u xanh nh·∫°t
                allBtns.forEach(b => {
                    if (b.innerText === correctText) {
                        b.classList.add('correct');
                        b.style.opacity = '0.7';
                    }
                });
            }
        }

        // --- 5. B·ªò ƒê·∫æM TH·ªúI GIAN ---
        let timerInterval;
        let timeLeft = 600; // 10 ph√∫t
        let isRunning = false;

        function toggleTimer() {
            const btn = document.getElementById('btn-timer');
            if (isRunning) {
                clearInterval(timerInterval);
                btn.innerText = "‚ñ∂ TI·∫æP T·ª§C H√ÄNH TR√åNH";
                btn.style.backgroundColor = "#fdcb6e";
            } else {
                btn.innerText = "‚è∏ T·∫†M D·ª™NG";
                btn.style.backgroundColor = "#d63031"; // N√∫t ƒë·ªè khi ƒëang ƒë·∫øm
                btn.style.color = "white";
                timerInterval = setInterval(() => {
                    timeLeft--;
                    let m = Math.floor(timeLeft / 60);
                    let s = timeLeft % 60;
                    document.getElementById('timer-display').innerText = `${m.toString().padStart(2, '0')}:${s.toString().padStart(2, '0')}`;
                    if (timeLeft <= 0) {
                        clearInterval(timerInterval);
                        alert("‚è∞ ƒê√£ h·∫øt gi·ªù l√†m b√†i! Trong ph√≤ng thi th·∫≠t b·∫°n h√£y c·ªë g·∫Øng ƒë·ªçc l∆∞·ªõt (skimming) nhanh h∆°n nh√©!");
                    }
                }, 1000);
            }
            isRunning = !isRunning;
        }

        // N√∫t d·ªãch thu·∫≠t
        function toggleTranslation(btn) {
            const div = btn.nextElementSibling;
            const isHidden = getComputedStyle(div).display === 'none';
            div.style.display = isHidden ? 'block' : 'none';
            btn.innerHTML = isHidden ? 'üôà ·∫®N B·∫¢N D·ªäCH' : 'üìñ B·∫¢N D·ªäCH ƒê·∫¶Y ƒê·ª¶';
        }

        // --- 6. T·ªîNG K·∫æT N·ªòP B√ÄI ---
        function submitQuiz() {
            if (answeredQuestions.size < quizData.length) {
                if(!confirm("H√†nh tr√¨nh ch∆∞a k·∫øt th√∫c, b·∫°n ch∆∞a l√†m xong c√¢u h·ªèi. B·∫°n v·∫´n mu·ªën n·ªôp b√†i ch·ª©?")) return;
            }
            clearInterval(timerInterval);
            
            const modal = document.getElementById('result-modal');
            document.getElementById('final-score').innerText = `${score}/5`;
            
            const msgObj = document.getElementById('feedback-msg');
            if (score === 5) {
                msgObj.innerText = "üèÜ TUY·ªÜT V·ªúI! K·ª∏ NƒÇNG ƒê·ªåC HI·ªÇU C·ª¶A B·∫†N ƒê√É ƒê·∫†T ƒê·ªàNH CAO!";
                for(let i=0; i<4; i++) setTimeout(fireConfetti, i*300);
            } else if (score >= 3) {
                msgObj.innerText = "‚ú® L√ÄM T·ªêT L·∫ÆM! H√£y ƒë·ªçc l·∫°i c√°c h·ªôp gi·∫£i th√≠ch m√†u v√†ng ƒë·ªÉ xem m√¨nh sai ·ªü ƒë√¢u nh√©.";
                fireConfetti();
            } else {
                msgObj.innerText = "üí™ C·ªê L√äN NHA! B√†i n√†y c√≥ nhi·ªÅu t·ª´ ƒë·ªìng nghƒ©a ƒë√°nh l·ª´a, h√£y h·ªçc k·ªπ b·∫£ng Vocabulary b√™n tr√°i nha!";
            }
            modal.style.display = 'flex';
        }

        // --- 7. HI·ªÜU ·ª®NG PH√ÅO GI·∫§Y CONFETTI ---
        const canvas = document.getElementById('confetti-canvas');
        const ctx = canvas.getContext('2d');
        canvas.width = window.innerWidth;
        canvas.height = window.innerHeight;
        let particles = [];
        const colors = ['#0984e3', '#00b894', '#fdcb6e', '#00cec9'];

        function fireConfetti() {
            for(let i=0; i<80; i++) {
                particles.push({
                    x: canvas.width / 2, y: canvas.height / 2 + 100,
                    r: Math.random() * 8 + 4,
                    dx: (Math.random() - 0.5) * 20, dy: Math.random() * -20 - 5,
                    color: colors[Math.floor(Math.random() * colors.length)],
                    tilt: Math.random() * 10 - 10, tiltAngleInc: (Math.random() * 0.07) + 0.05, tiltAngle: 0
                });
            }
            requestAnimationFrame(animateConfetti);
        }

        function animateConfetti() {
            ctx.clearRect(0,0,canvas.width,canvas.height);
            particles.forEach((p, i) => {
                p.tiltAngle += p.tiltAngleInc;
                p.y += (Math.cos(p.tiltAngle) + 1 + p.r / 2) / 2;
                p.x += Math.sin(p.tiltAngle) * 2;
                p.dy += 0.3; p.y += p.dy;
                ctx.beginPath(); ctx.lineWidth = p.r; ctx.strokeStyle = p.color;
                ctx.moveTo(p.x + p.tilt + p.r, p.y); ctx.lineTo(p.x + p.tilt, p.y + p.tilt + p.r); ctx.stroke();
                if (p.y > canvas.height) particles.splice(i,1);
            });
            if(particles.length > 0) requestAnimationFrame(animateConfetti);
        }

        window.addEventListener('resize', () => { canvas.width = window.innerWidth; canvas.height = window.innerHeight; });
        window.onload = renderQuiz;
    </script>
</body>
</html>