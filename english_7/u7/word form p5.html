<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Word Form Mastery - Ms Mai An ULIS</title>
    <link href="https://fonts.googleapis.com/css2?family=Nunito:wght@400;700;900&display=swap" rel="stylesheet">
    <script src="https://cdn.jsdelivr.net/npm/canvas-confetti@1.6.0/dist/confetti.browser.min.js"></script>
    <style>
        :root {
            --primary: #8854C0;
            --secondary: #00C9A7;
            --correct: #00D26A;
            --wrong: #FF4757;
            --bg-light: #F0F4F8;
            --text-dark: #2D3436;
        }

        * {
            box-sizing: border-box;
            font-family: 'Nunito', sans-serif;
        }

        body {
            margin: 0;
            background-color: var(--bg-light);
            background-image: radial-gradient(#d1d8e0 1px, transparent 1px);
            background-size: 20px 20px;
            color: var(--text-dark);
            display: flex;
            flex-direction: column;
            align-items: center;
            min-height: 100vh;
            padding: 20px;
        }

        .header {
            text-align: center;
            margin-bottom: 20px;
        }

        .header h1 {
            color: var(--primary);
            font-weight: 900;
            margin: 0;
            font-size: 2.5rem;
            text-shadow: 2px 2px 0px white;
        }

        .instructor {
            font-size: 1rem;
            color: #636e72;
            font-weight: 700;
            margin-top: 5px;
        }

        .game-container {
            width: 100%;
            max-width: 700px;
            perspective: 1000px;
        }

        .card {
            background: white;
            border-radius: 25px;
            padding: 30px;
            box-shadow: 0 10px 0 rgba(0,0,0,0.1);
            border: 4px solid var(--primary);
            position: relative;
            transition: transform 0.3s ease;
        }

        .progress-container {
            width: 100%;
            height: 15px;
            background: #dfe6e9;
            border-radius: 10px;
            margin-bottom: 25px;
            overflow: hidden;
            border: 2px solid #b2bec3;
        }

        .progress-bar {
            height: 100%;
            background: linear-gradient(90deg, var(--secondary), var(--correct));
            width: 0%;
            transition: width 0.4s ease;
        }

        .stats {
            display: flex;
            justify-content: space-between;
            margin-bottom: 15px;
            font-weight: 900;
            color: var(--primary);
        }

        .question-text {
            font-size: 1.4rem;
            font-weight: 800;
            margin-bottom: 25px;
            line-height: 1.4;
            text-align: center;
        }

        .options-grid {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 15px;
        }

        @media (max-width: 500px) {
            .options-grid { grid-template-columns: 1fr; }
        }

        .btn-option {
            background: white;
            border: 3px solid #dfe6e9;
            border-radius: 18px;
            padding: 15px;
            font-size: 1.1rem;
            font-weight: 700;
            cursor: pointer;
            transition: all 0.2s;
            box-shadow: 0 6px 0 #dfe6e9;
            position: relative;
            top: 0;
        }

        .btn-option:hover:not(:disabled) {
            transform: scale(1.03);
            border-color: var(--primary);
            color: var(--primary);
        }

        .btn-option:active:not(:disabled) {
            top: 4px;
            box-shadow: 0 2px 0 #dfe6e9;
        }

        .btn-option.correct {
            background-color: var(--correct) !important;
            border-color: #009432 !important;
            color: white !important;
            box-shadow: 0 6px 0 #006322 !important;
        }

        .btn-option.wrong {
            background-color: var(--wrong) !important;
            border-color: #b33939 !important;
            color: white !important;
            box-shadow: 0 6px 0 #822727 !important;
        }

        /* Shake Animation */
        @keyframes shake {
            0%, 100% { transform: translateX(0); }
            25% { transform: translateX(-10px); }
            75% { transform: translateX(10px); }
        }
        .shake { animation: shake 0.3s ease-in-out 2; }

        .explanation-box {
            margin-top: 25px;
            padding: 20px;
            background: #F9F7FF;
            border-radius: 15px;
            border-left: 8px solid var(--primary);
            display: none;
            animation: slideUp 0.4s ease-out;
        }

        @keyframes slideUp {
            from { opacity: 0; transform: translateY(20px); }
            to { opacity: 1; transform: translateY(0); }
        }

        .explanation-box h3 {
            margin-top: 0;
            color: var(--primary);
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .next-container {
            margin-top: 20px;
            display: flex;
            justify-content: flex-end;
            display: none;
        }

        .btn-next {
            background: var(--secondary);
            color: white;
            border: none;
            padding: 12px 30px;
            border-radius: 50px;
            font-weight: 900;
            font-size: 1.2rem;
            cursor: pointer;
            box-shadow: 0 6px 0 #00967d;
            transition: all 0.2s;
        }

        .btn-next:hover { transform: scale(1.05); background: #00e0ba; }
        .btn-next:active { transform: translateY(4px); box-shadow: 0 2px 0 #00967d; }

        /* Result Popup */
        .modal {
            display: none;
            position: fixed;
            top: 0; left: 0; width: 100%; height: 100%;
            background: rgba(0,0,0,0.8);
            z-index: 1000;
            justify-content: center;
            align-items: center;
        }

        .modal-content {
            background: white;
            padding: 40px;
            border-radius: 30px;
            text-align: center;
            max-width: 500px;
            width: 90%;
            border: 6px solid var(--secondary);
        }

        .modal-content h2 { font-size: 2.5rem; color: var(--primary); margin-bottom: 10px; }
        .score-large { font-size: 4rem; font-weight: 900; color: var(--secondary); margin: 20px 0; }
        .feedback-text { font-size: 1.2rem; margin-bottom: 30px; font-weight: 700; }

        .btn-restart {
            background: var(--primary);
            color: white;
            border: none;
            padding: 15px 40px;
            border-radius: 50px;
            font-size: 1.3rem;
            font-weight: 900;
            cursor: pointer;
            box-shadow: 0 6px 0 #573280;
        }

        .vocabulary-table {
            width: 100%;
            border-collapse: collapse;
            margin-top: 15px;
            font-size: 0.95rem;
        }

        .vocabulary-table th, .vocabulary-table td {
            border: 1px solid #ddd;
            padding: 10px;
            text-align: left;
        }

        .vocabulary-table th {
            background-color: var(--primary);
            color: white;
        }

        .highlight { font-weight: 700; color: var(--primary); }
    </style>
</head>
<body>

    <div class="header">
        <h1>WORD FORM MASTERY</h1>
        <div class="instructor">Gi√°o vi√™n t·∫°o: Ms Mai An ULIS üéì</div>
    </div>

    <div class="game-container">
        <div class="stats">
            <span id="question-counter">C√¢u h·ªèi: 1/31</span>
            <span id="score-counter">ƒêi·ªÉm: 0</span>
        </div>
        
        <div class="progress-container">
            <div class="progress-bar" id="progress-bar"></div>
        </div>

        <div class="card" id="question-card">
            <div id="game-ui">
                <div class="question-text" id="question-text">ƒêang t·∫£i c√¢u h·ªèi...</div>
                
                <div class="options-grid" id="options-grid">
                    <!-- Options will be here -->
                </div>

                <div class="explanation-box" id="explanation-box">
                    <h3><span id="exp-icon">üí°</span> Gi·∫£i th√≠ch t·ª´ C√¥ Mai An:</h3>
                    <div id="explanation-content"></div>
                </div>

                <div class="next-container" id="next-container">
                    <button class="btn-next" onclick="nextQuestion()">TI·∫æP THEO ‚ûî</button>
                </div>
            </div>
        </div>
    </div>

    <!-- Modal K·∫øt Qu·∫£ -->
    <div class="modal" id="result-modal">
        <div class="modal-content">
            <h2>HO√ÄN TH√ÄNH!</h2>
            <div class="score-large" id="final-score">0/31</div>
            <div class="feedback-text" id="feedback-text">Tuy·ªát v·ªùi √¥ng m·∫∑t tr·ªùi!</div>
            <button class="btn-restart" onclick="restartGame()">L√ÄM L·∫†I B√ÄI TEST</button>
        </div>
    </div>

    <!-- Audio Elements (Using royalty free sounds) -->
    <audio id="snd-correct" src="https://assets.mixkit.co/active_storage/sfx/2000/2000-preview.mp3"></audio>
    <audio id="snd-wrong" src="https://assets.mixkit.co/active_storage/sfx/2019/2019-preview.mp3"></audio>

    <script>
        const rawData = [
    {
      "question": "My teacher ________ announces that we will do the final examination next Monday. (RELIABLE)",
      "options": ["reliably", "reliable", "rely", "reliability"],
      "correctIndex": 0,
      "analysis": [
        "reliably (adv): m·ªôt c√°ch ƒë√°ng tin c·∫≠y/ch·∫Øc ch·∫Øn.",
        "reliable (adj): ƒë√°ng tin c·∫≠y.",
        "rely (v): tin c·∫≠y (th∆∞·ªùng ƒëi v·ªõi 'on').",
        "reliability (n): s·ª± ƒë√°ng tin c·∫≠y."
      ],
      "translation": "Gi√°o vi√™n c·ªßa t√¥i th√¥ng b√°o m·ªôt c√°ch ch·∫Øc ch·∫Øn r·∫±ng ch√∫ng t√¥i s·∫Ω l√†m b√†i thi cu·ªëi k·ª≥ v√†o th·ª© Hai t·ªõi.",
      "whyCorrect": "C·∫ßn m·ªôt tr·∫°ng t·ª´ (adv) ƒë·ª©ng tr∆∞·ªõc ƒë·ªông t·ª´ 'announces' ƒë·ªÉ b·ªï nghƒ©a cho h√†nh ƒë·ªông th√¥ng b√°o.",
      "whyIncorrect": "C√°c t·ª´ kh√°c kh√¥ng ƒë√∫ng ch·ª©c nƒÉng ng·ªØ ph√°p (t√≠nh t·ª´, ƒë·ªông t·ª´, danh t·ª´) ƒë·ªÉ b·ªï nghƒ©a cho ƒë·ªông t·ª´ th∆∞·ªùng."
    },
    {
      "question": "During a traffic jam, all cars move very ________. (SLOW)",
      "options": ["slowly", "slow", "slowness", "slower"],
      "correctIndex": 0,
      "analysis": [
        "slowly (adv): m·ªôt c√°ch ch·∫≠m ch·∫°p.",
        "slow (adj): ch·∫≠m.",
        "slowness (n): s·ª± ch·∫≠m ch·∫°p.",
        "slower (adj-so s√°nh): ch·∫≠m h∆°n."
      ],
      "translation": "Trong l√∫c k·∫πt xe, t·∫•t c·∫£ √¥ t√¥ di chuy·ªÉn r·∫•t ch·∫≠m.",
      "whyCorrect": "Sau ƒë·ªông t·ª´ th∆∞·ªùng 'move' v√† tr·∫°ng t·ª´ ch·ªâ m·ª©c ƒë·ªô 'very', ta c·∫ßn m·ªôt tr·∫°ng t·ª´ ch·ªâ c√°ch th·ª©c.",
      "whyIncorrect": "T√≠nh t·ª´ (slow) kh√¥ng ƒë·ª©ng sau ƒë·ªông t·ª´ th∆∞·ªùng ƒë·ªÉ ch·ªâ c√°ch th·ª©c h√†nh ƒë·ªông."
    },
    {
      "question": "Lucas doesn't like snorkeling. He thinks it's ________. (DANGER)",
      "options": ["dangerous", "danger", "dangerously", "endanger"],
      "correctIndex": 0,
      "analysis": [
        "dangerous (adj): nguy hi·ªÉm.",
        "danger (n): s·ª± nguy hi·ªÉm.",
        "dangerously (adv): m·ªôt c√°ch nguy hi·ªÉm.",
        "endanger (v): g√¢y nguy hi·ªÉm."
      ],
      "translation": "Lucas kh√¥ng th√≠ch l·∫∑n ·ªëng th·ªü. Anh ·∫•y nghƒ© n√≥ nguy hi·ªÉm.",
      "whyCorrect": "Sau c·∫•u tr√∫c 'thinks it is' (to be), ta c·∫ßn m·ªôt t√≠nh t·ª´ ƒë·ªÉ mi√™u t·∫£ ƒë·∫∑c ƒëi·ªÉm c·ªßa s·ª± v·∫≠t.",
      "whyIncorrect": "Danh t·ª´ hay tr·∫°ng t·ª´ kh√¥ng ƒë·ª©ng sau 'is' ƒë·ªÉ mi√™u t·∫£ tr·ª±c ti·∫øp t√≠nh ch·∫•t c·ªßa ch·ªß ng·ªØ 'it'."
    },
    {
      "question": "There are plenty of ________ at the tourist attraction. (SIGHTSEE)",
      "options": ["sightseers", "sightseeing", "sights", "sightseen"],
      "correctIndex": 0,
      "analysis": [
        "sightseers (n-s·ªë nhi·ªÅu): kh√°ch tham quan (ng∆∞·ªùi).",
        "sightseeing (n/v-ing): vi·ªác tham quan ng·∫Øm c·∫£nh.",
        "sights (n): c·∫£nh ƒë·∫πp/t·∫ßm nh√¨n.",
        "sightseen (kh√¥ng t·ªìn t·∫°i d·∫°ng n√†y)."
      ],
      "translation": "C√≥ r·∫•t nhi·ªÅu kh√°ch tham quan t·∫°i ƒë·ªãa ƒëi·ªÉm du l·ªãch.",
      "whyCorrect": "C·ª•m 'plenty of' (nhi·ªÅu) y√™u c·∫ßu m·ªôt danh t·ª´ s·ªë nhi·ªÅu. T·∫°i ƒëi·ªÉm du l·ªãch th√¨ ng∆∞·ªùi tham quan l√† ph√π h·ª£p nh·∫•t.",
      "whyIncorrect": "Sightseeing l√† vi·ªác ng·∫Øm c·∫£nh, kh√¥ng ph√π h·ª£p khi n√≥i v·ªÅ s·ªë l∆∞·ª£ng ƒë·∫øm ƒë∆∞·ª£c ·ªü m·ªôt ƒë·ªãa ƒëi·ªÉm."
    },
    {
      "question": "When cycling on the roads, remember: ________ first. (safe)",
      "options": ["safety", "safe", "safely", "save"],
      "correctIndex": 0,
      "analysis": [
        "safety (n): s·ª± an to√†n.",
        "safe (adj): an to√†n.",
        "safely (adv): m·ªôt c√°ch an to√†n.",
        "save (v): c·ª©u/ti·∫øt ki·ªám."
      ],
      "translation": "Khi ƒë·∫°p xe tr√™n ƒë∆∞·ªùng, h√£y nh·ªõ: an to√†n l√† tr√™n h·∫øt.",
      "whyCorrect": "'Safety first' l√† m·ªôt th√†nh ng·ªØ/kh·∫©u hi·ªáu c·ªë ƒë·ªãnh, trong ƒë√≥ Safety ƒë√≥ng vai tr√≤ danh t·ª´ ch·ªß ng·ªØ.",
      "whyIncorrect": "T√≠nh t·ª´ 'safe' kh√¥ng ƒë·ª©ng m·ªôt m√¨nh l√†m ti√™u ƒë·ªÅ kh·∫©u hi·ªáu nh∆∞ v·∫≠y ƒë∆∞·ª£c."
    },
    {
        "question": "One of my son's favorite dishes is ________ rice. (FRY)",
        "options": ["fried", "fry", "frying", "fries"],
        "correctIndex": 0,
        "analysis": [
            "fried (adj/V-ed): ƒë√£ ƒë∆∞·ª£c chi√™n/rang.",
            "fry (v): chi√™n/r√°n.",
            "frying (v-ing): ƒëang chi√™n.",
            "fries (n): khoai t√¢y chi√™n."
        ],
        "translation": "M·ªôt trong nh·ªØng m√≥n ƒÉn y√™u th√≠ch c·ªßa con trai t√¥i l√† c∆°m rang.",
        "whyCorrect": "Ta d√πng qu√° kh·ª© ph√¢n t·ª´ 'fried' ƒë√≥ng vai tr√≤ nh∆∞ t√≠nh t·ª´ ƒë·ªÉ ch·ªâ tr·∫°ng th√°i c·ªßa s·ª± v·∫≠t (c∆°m ƒë√£ ƒë∆∞·ª£c rang).",
        "whyIncorrect": "Fry l√† ƒë·ªông t·ª´ nguy√™n m·∫´u, kh√¥ng th·ªÉ b·ªï nghƒ©a cho danh t·ª´ 'rice' ph√≠a sau."
    },
    {
        "question": "I took part in a park ________ yesterday. (CLEAN)",
        "options": ["clean-up", "cleaning", "cleaner", "clean"],
        "correctIndex": 0,
        "analysis": [
            "clean-up (n): bu·ªïi d·ªçn d·∫πp v·ªá sinh.",
            "cleaning (n): vi·ªác d·ªçn d·∫πp.",
            "cleaner (n): ng∆∞·ªùi d·ªçn d·∫πp/m√°y h√∫t b·ª•i.",
            "clean (adj/v): s·∫°ch s·∫Ω/l√†m s·∫°ch."
        ],
        "translation": "T√¥i ƒë√£ tham gia m·ªôt bu·ªïi d·ªçn d·∫πp c√¥ng vi√™n ng√†y h√¥m qua.",
        "whyCorrect": "'Park clean-up' l√† m·ªôt danh t·ª´ gh√©p ch·ªâ m·ªôt s·ª± ki·ªán/chi·∫øn d·ªãch d·ªçn d·∫πp c·ª• th·ªÉ.",
        "whyIncorrect": "'Cleaning' mang nghƒ©a vi·ªác d·ªçn d·∫πp n√≥i chung, kh√¥ng ph·ªï bi·∫øn b·∫±ng 'clean-up' khi n√≥i v·ªÅ m·ªôt s·ª± ki·ªán c·ªông ƒë·ªìng."
    },
    {
        "question": "All the ________ were taken so I had to stand. (SIT)",
        "options": ["seats", "seat", "sit", "seating"],
        "correctIndex": 0,
        "analysis": [
            "seats (n-s·ªë nhi·ªÅu): nh·ªØng ch·ªó ng·ªìi.",
            "seat (n-s·ªë √≠t): ch·ªó ng·ªìi.",
            "sit (v): ng·ªìi.",
            "seating (n): s·ª± s·∫Øp x·∫øp ch·ªó ng·ªìi."
        ],
        "translation": "T·∫•t c·∫£ c√°c ch·ªó ng·ªìi ƒë·ªÅu ƒë√£ k√≠n n√™n t√¥i ph·∫£i ƒë·ª©ng.",
        "whyCorrect": "C·ª•m 'All the' ƒëi k√®m v·ªõi ƒë·ªông t·ª´ 'were' (s·ªë nhi·ªÅu) n√™n c·∫ßn danh t·ª´ ƒë·∫øm ƒë∆∞·ª£c s·ªë nhi·ªÅu 'seats'.",
        "whyIncorrect": "Sit l√† ƒë·ªông t·ª´, kh√¥ng th·ªÉ l√†m ch·ªß ng·ªØ sau m·∫°o t·ª´ 'the'."
    },
    {
        "question": "The school was ________ very small. (originate)",
        "options": ["originally", "original", "origin", "originate"],
        "correctIndex": 0,
        "analysis": [
            "originally (adv): ban ƒë·∫ßu/nguy√™n b·∫£n.",
            "original (adj): thu·ªôc v·ªÅ b·∫£n g·ªëc.",
            "origin (n): ngu·ªìn g·ªëc.",
            "originate (v): b·∫Øt ngu·ªìn t·ª´."
        ],
        "translation": "Ng√¥i tr∆∞·ªùng ban ƒë·∫ßu r·∫•t nh·ªè.",
        "whyCorrect": "Tr·∫°ng t·ª´ 'originally' d√πng ƒë·ªÉ b·ªï nghƒ©a cho to√†n b·ªô tr·∫°ng th√°i c·ªßa c√¢u ho·∫∑c t√≠nh t·ª´ 'small' ph√≠a sau.",
        "whyIncorrect": "T√≠nh t·ª´ 'original' kh√¥ng mang nghƒ©a 'v√†o th·ªùi ƒëi·ªÉm ban ƒë·∫ßu' trong ng·ªØ c·∫£nh n√†y."
    },
    {
        "question": "If we ________ grocery bags, there will be less plastic rubbish. (USE)",
        "options": ["reuse", "use", "useless", "useful"],
        "correctIndex": 0,
        "analysis": [
            "reuse (v): t√°i s·ª≠ d·ª•ng.",
            "use (v): s·ª≠ d·ª•ng.",
            "useless (adj): v√¥ d·ª•ng.",
            "useful (adj): h·ªØu √≠ch."
        ],
        "translation": "N·∫øu ch√∫ng ta t√°i s·ª≠ d·ª•ng t√∫i ƒëi ch·ª£, s·∫Ω c√≥ √≠t r√°c th·∫£i nh·ª±a h∆°n.",
        "whyCorrect": "D·ª±a v√†o ng·ªØ c·∫£nh 'less plastic rubbish', vi·ªác 'd√πng l·∫°i' (reuse) l√† h√†nh ƒë·ªông ch√≠nh x√°c ƒë·ªÉ gi·∫£m r√°c.",
        "whyIncorrect": "D√πng t·ª´ 'use' (s·ª≠ d·ª•ng) kh√¥ng l√†m b·∫≠t r√µ √Ω nghƒ©a c·ªßa vi·ªác b·∫£o v·ªá m√¥i tr∆∞·ªùng nh∆∞ 'reuse'."
    },
    {
        "question": "I will come and ask the lady if those ________ are free. (SIT)",
        "options": ["seats", "seat", "sit", "seating"],
        "correctIndex": 0,
        "analysis": [
            "seats (n-s·ªë nhi·ªÅu): nh·ªØng ch·ªó ng·ªìi.",
            "seat (n-s·ªë √≠t): ch·ªó ng·ªìi.",
            "sit (v): ng·ªìi.",
            "seating (n): s·ª± s·∫Øp x·∫øp ch·ªó ng·ªìi."
        ],
        "translation": "T√¥i s·∫Ω ƒë·∫øn v√† h·ªèi ng∆∞·ªùi ph·ª• n·ªØ xem nh·ªØng ch·ªó ng·ªìi kia c√≥ tr·ªëng kh√¥ng.",
        "whyCorrect": "'Those' l√† ƒë·∫°i t·ª´ ch·ªâ ƒë·ªãnh cho danh t·ª´ s·ªë nhi·ªÅu, ƒëi k√®m v·ªõi ƒë·ªông t·ª´ 'are'.",
        "whyIncorrect": "Seat (s·ªë √≠t) kh√¥ng ƒëi v·ªõi 'those' v√† 'are'."
    },
    {
        "question": "Paul Walker has won Oscar for the best ________. (act)",
        "options": ["actor", "actress", "acting", "act"],
        "correctIndex": 0,
        "analysis": [
            "actor (n): nam di·ªÖn vi√™n.",
            "actress (n): n·ªØ di·ªÖn vi√™n.",
            "acting (n): s·ª± di·ªÖn xu·∫•t.",
            "act (v/n): di·ªÖn/h√†nh ƒë·ªông."
        ],
        "translation": "Paul Walker ƒë√£ gi√†nh gi·∫£i Oscar cho nam di·ªÖn vi√™n xu·∫•t s·∫Øc nh·∫•t.",
        "whyCorrect": "Paul Walker l√† nam gi·ªõi, n√™n ta d√πng danh t·ª´ ch·ªâ ng∆∞·ªùi 'actor'.",
        "whyIncorrect": "Actress ch·ªâ d√†nh cho n·ªØ gi·ªõi. Acting l√† s·ª± di·ªÖn xu·∫•t (th∆∞·ªùng l√† t√™n gi·∫£i th∆∞·ªüng 'Best Acting' nh∆∞ng ·ªü ƒë√¢y l√† 'best actor' ph·ªï bi·∫øn h∆°n cho c√° nh√¢n)."
    },
    {
        "question": "Traveling by train is clean, ________ and punctual. (COMFORT)",
        "options": ["comfortable", "comfort", "comfortably", "uncomfortable"],
        "correctIndex": 0,
        "analysis": [
            "comfortable (adj): tho·∫£i m√°i.",
            "comfort (n/v): s·ª± tho·∫£i m√°i/an ·ªßi.",
            "comfortably (adv): m·ªôt c√°ch tho·∫£i m√°i.",
            "uncomfortable (adj): kh√¥ng tho·∫£i m√°i."
        ],
        "translation": "ƒêi t√†u h·ªèa th√¨ s·∫°ch s·∫Ω, tho·∫£i m√°i v√† ƒë√∫ng gi·ªù.",
        "whyCorrect": "C·∫•u tr√∫c song song (Parallel structure): 'clean' v√† 'punctual' l√† t√≠nh t·ª´, n√™n t·ª´ ·ªü gi·ªØa c≈©ng ph·∫£i l√† t√≠nh t·ª´.",
        "whyIncorrect": "Comfort l√† danh t·ª´, kh√¥ng c√πng lo·∫°i v·ªõi c√°c t√≠nh t·ª´ c√≤n l·∫°i trong chu·ªói li·ªát k√™."
    },
    {
        "question": "The first time I went zorbing, I felt really ________. (SCARE)",
        "options": ["scared", "scary", "scare", "scarily"],
        "correctIndex": 0,
        "analysis": [
            "scared (adj): b·ªã s·ª£ h√£i (c·∫£m x√∫c ng∆∞·ªùi).",
            "scary (adj): g√¢y s·ª£ h√£i (t√≠nh ch·∫•t v·∫≠t).",
            "scare (v/n): l√†m s·ª£/s·ª± s·ª£ h√£i.",
            "scarily (adv): m·ªôt c√°ch ƒë√°ng s·ª£."
        ],
        "translation": "L·∫ßn ƒë·∫ßu ti√™n t√¥i ch∆°i zorbing, t√¥i c·∫£m th·∫•y th·ª±c s·ª± s·ª£ h√£i.",
        "whyCorrect": "Sau ƒë·ªông t·ª´ ch·ªâ c·∫£m gi√°c 'felt', ta d√πng t√≠nh t·ª´ ƒëu√¥i -ed ƒë·ªÉ di·ªÖn t·∫£ c·∫£m x√∫c c·ªßa con ng∆∞·ªùi.",
        "whyIncorrect": "Scary d√πng ƒë·ªÉ mi√™u t·∫£ b·∫£n ch·∫•t c·ªßa tr√≤ ch∆°i (The game is scary), kh√¥ng d√πng cho c·∫£m x√∫c c·ªßa ng∆∞·ªùi."
    },
    {
        "question": "This is a ________ story, you shouldn't read it alone. (frighten)",
        "options": ["frightening", "frightened", "fright", "frighten"],
        "correctIndex": 0,
        "analysis": [
            "frightening (adj): ƒë√°ng s·ª£ (t√≠nh ch·∫•t).",
            "frightened (adj): b·ªã ho·∫£ng s·ª£ (c·∫£m x√∫c).",
            "fright (n): s·ª± ho·∫£ng s·ª£.",
            "frighten (v): l√†m ho·∫£ng s·ª£."
        ],
        "translation": "ƒê√¢y l√† m·ªôt c√¢u chuy·ªán ƒë√°ng s·ª£, b·∫°n kh√¥ng n√™n ƒë·ªçc n√≥ m·ªôt m√¨nh.",
        "whyCorrect": "B·ªï nghƒ©a cho danh t·ª´ 'story' (v·∫≠t) ch·ªâ t√≠nh ch·∫•t g√¢y ra cho ng∆∞·ªùi kh√°c, ta d√πng t√≠nh t·ª´ ƒëu√¥i -ing.",
        "whyIncorrect": "Frightened ch·ªâ d√πng cho ng∆∞·ªùi khi b·ªã t√°c ƒë·ªông b·ªüi th·ª© g√¨ ƒë√≥."
    },
    {
        "question": "The three-hour ________ exam was a real challenge. (ENTER)",
        "options": ["entrance", "enter", "entry", "entering"],
        "correctIndex": 0,
        "analysis": [
            "entrance (n): s·ª± ƒëi v√†o/l·ªëi v√†o.",
            "enter (v): ƒëi v√†o.",
            "entry (n): s·ª± ghi v√†o/l·ªëi v√†o.",
            "entering (v-ing): ƒëang v√†o."
        ],
        "translation": "K·ª≥ thi ƒë·∫ßu v√†o k√©o d√†i ba gi·ªù l√† m·ªôt th·ª≠ th√°ch th·ª±c s·ª±.",
        "whyCorrect": "'Entrance exam' l√† m·ªôt c·ª•m danh t·ª´ c·ªë ƒë·ªãnh (compound noun) nghƒ©a l√† k·ª≥ thi tuy·ªÉn sinh/ƒë·∫ßu v√†o.",
        "whyIncorrect": "Entry exam kh√¥ng ph·∫£i l√† thu·∫≠t ng·ªØ ph·ªï bi·∫øn ƒë·ªÉ ch·ªâ k·ª≥ thi tuy·ªÉn sinh tr∆∞·ªùng h·ªçc."
    },
    {
        "question": "The ________ from Ho Chi Minh City to Ha Noi takes two hours. (FLY)",
        "options": ["flight", "fly", "flying", "flyer"],
        "correctIndex": 0,
        "analysis": [
            "flight (n): chuy·∫øn bay.",
            "fly (v): bay.",
            "flying (n): vi·ªác bay.",
            "flyer (n): t·ªù r∆°i/ng∆∞·ªùi l√°i m√°y bay."
        ],
        "translation": "Chuy·∫øn bay t·ª´ TP.HCM ra H√† N·ªôi m·∫•t kho·∫£ng hai gi·ªù.",
        "whyCorrect": "Sau m·∫°o t·ª´ 'The' v√† l√†m ch·ªß ng·ªØ c·ªßa ƒë·ªông t·ª´ 'takes', ta c·∫ßn danh t·ª´ ch·ªâ chuy·∫øn ƒëi b·∫±ng ƒë∆∞·ªùng h√†ng kh√¥ng.",
        "whyIncorrect": "Fly l√† ƒë·ªông t·ª´. Flyer mang nghƒ©a kh√°c kh√¥ng ph√π h·ª£p ng·ªØ c·∫£nh."
    },
    {
        "question": "When ________ air conditioners, keep them at 28 degrees. (USE)",
        "options": ["using", "use", "used", "usage"],
        "correctIndex": 0,
        "analysis": [
            "using (v-ing): ƒëang s·ª≠ d·ª•ng.",
            "use (v): s·ª≠ d·ª•ng.",
            "used (v-ed): ƒë√£ s·ª≠ d·ª•ng.",
            "usage (n): c√°ch d√πng/l∆∞·ª£ng d√πng."
        ],
        "translation": "Khi s·ª≠ d·ª•ng m√°y ƒëi·ªÅu h√≤a, h√£y gi·ªØ nhi·ªát ƒë·ªô ·ªü m·ª©c kho·∫£ng 28 ƒë·ªô C.",
        "whyCorrect": "C·∫•u tr√∫c r√∫t g·ªçn m·ªánh ƒë·ªÅ tr·∫°ng ng·ªØ (When you use -> When using) khi hai m·ªánh ƒë·ªÅ c√πng ch·ªß ng·ªØ ng·∫ßm ƒë·ªãnh.",
        "whyIncorrect": "Usage l√† danh t·ª´, kh√¥ng ƒë·ª©ng sau 'When' ƒë·ªÉ t·∫°o m·ªánh ƒë·ªÅ r√∫t g·ªçn h√†nh ƒë·ªông."
    },
    {
        "question": "She played the piano and sang this song ________. (art)",
        "options": ["artistically", "artistic", "art", "artist"],
        "correctIndex": 0,
        "analysis": [
            "artistically (adv): m·ªôt c√°ch ƒë·∫ßy ngh·ªá thu·∫≠t.",
            "artistic (adj): c√≥ t√≠nh ngh·ªá thu·∫≠t.",
            "art (n): ngh·ªá thu·∫≠t.",
            "artist (n): ngh·ªá sƒ©."
        ],
        "translation": "C√¥ ·∫•y ch∆°i piano v√† h√°t b√†i h√°t n√†y m·ªôt c√°ch ƒë·∫ßy ngh·ªá thu·∫≠t.",
        "whyCorrect": "C·∫ßn m·ªôt tr·∫°ng t·ª´ (adv) ƒë·ª©ng cu·ªëi c√¢u ƒë·ªÉ b·ªï nghƒ©a cho c√°c ƒë·ªông t·ª´ 'played' v√† 'sang'.",
        "whyIncorrect": "Artistic l√† t√≠nh t·ª´, ch·ªâ d√πng tr∆∞·ªõc danh t·ª´ ho·∫∑c sau to-be."
    },
    {
        "question": "Nuclear energy can be ________ and causes harm. (DANGER)",
        "options": ["dangerous", "danger", "dangerously", "endanger"],
        "correctIndex": 0,
        "analysis": [
            "dangerous (adj): nguy hi·ªÉm.",
            "danger (n): s·ª± nguy hi·ªÉm.",
            "dangerously (adv): m·ªôt c√°ch nguy hi·ªÉm.",
            "endanger (v): g√¢y nguy hi·ªÉm."
        ],
        "translation": "NƒÉng l∆∞·ª£ng h·∫°t nh√¢n c√≥ th·ªÉ nguy hi·ªÉm v√† g√¢y h·∫°i cho s·ª©c kh·ªèe.",
        "whyCorrect": "Sau 'can be' (ƒë·ªông t·ª´ khuy·∫øt thi·∫øu + be) ta c·∫ßn m·ªôt t√≠nh t·ª´ ƒë·ªÉ n√™u ƒë·∫∑c ƒëi·ªÉm c·ªßa ch·ªß ng·ªØ.",
        "whyIncorrect": "Danger l√† danh t·ª´, kh√¥ng mi√™u t·∫£ tr·ª±c ti·∫øp t√≠nh ch·∫•t c·ªßa energy trong c·∫•u tr√∫c n√†y."
    },
    {
        "question": "The price of ________ has gone up again. (electric)",
        "options": ["electricity", "electric", "electrical", "electrician"],
        "correctIndex": 0,
        "analysis": [
            "electricity (n): ƒëi·ªán nƒÉng.",
            "electric (adj): ch·∫°y b·∫±ng ƒëi·ªán.",
            "electrical (adj): thu·ªôc v·ªÅ ng√†nh ƒëi·ªán.",
            "electrician (n): th·ª£ ƒëi·ªán."
        ],
        "translation": "Gi√° ƒëi·ªán l·∫°i tƒÉng r·ªìi.",
        "whyCorrect": "'Price of + N' (Gi√° c·ªßa c√°i g√¨ ƒë√≥). Electricity l√† danh t·ª´ ch·ªâ nƒÉng l∆∞·ª£ng ƒëi·ªán.",
        "whyIncorrect": "Electric v√† electrical l√† t√≠nh t·ª´, kh√¥ng th·ªÉ ƒë·ª©ng sau gi·ªõi t·ª´ 'of' l√†m t√¢n ng·ªØ danh t·ª´."
    },
    {
        "question": "She has a ________ smile. (beauty)",
        "options": ["beautiful", "beauty", "beautifully", "beautify"],
        "correctIndex": 0,
        "analysis": [
            "beautiful (adj): xinh ƒë·∫πp.",
            "beauty (n): v·∫ª ƒë·∫πp.",
            "beautifully (adv): m·ªôt c√°ch xinh ƒë·∫πp.",
            "beautify (v): l√†m ƒë·∫πp."
        ],
        "translation": "C√¥ ·∫•y c√≥ m·ªôt n·ª• c∆∞·ªùi ƒë·∫πp.",
        "whyCorrect": "C·∫ßn t√≠nh t·ª´ ƒë·ª©ng tr∆∞·ªõc danh t·ª´ 'smile' ƒë·ªÉ mi√™u t·∫£ n·ª• c∆∞·ªùi.",
        "whyIncorrect": "Beauty l√† danh t·ª´, kh√¥ng ƒë·ª©ng tr∆∞·ªõc danh t·ª´ kh√°c ƒë·ªÉ l√†m t√≠nh t·ª´ mi√™u t·∫£ trong tr∆∞·ªùng h·ª£p n√†y."
    },
    {
        "question": "We help the ________ with housework and gardening. (old)",
        "options": ["elderly", "old", "older", "oldest"],
        "correctIndex": 0,
        "analysis": [
            "elderly (n-s·ªë nhi·ªÅu): ng∆∞·ªùi cao tu·ªïi (trang tr·ªçng).",
            "old (adj): gi√†.",
            "older (adj-so s√°nh): gi√† h∆°n.",
            "oldest (adj-so s√°nh nh·∫•t): gi√† nh·∫•t."
        ],
        "translation": "Ch√∫ng t√¥i gi√∫p ƒë·ª° ng∆∞·ªùi cao tu·ªïi l√†m vi·ªác nh√† v√† l√†m v∆∞·ªùn.",
        "whyCorrect": "'The elderly' l√† c·ª•m danh t·ª´ ch·ªâ nh√≥m ng∆∞·ªùi cao tu·ªïi m·ªôt c√°ch l·ªãch s·ª±.",
        "whyIncorrect": "Old l√† t√≠nh t·ª´, m·∫∑c d√π 'the old' c≈©ng c√≥ th·ªÉ d√πng nh∆∞ng 'the elderly' l√† ƒë√°p √°n chu·∫©n nh·∫•t trong c√°c k·ª≥ thi ti·∫øng Anh."
    },
    {
        "question": "The nightlife in Berlin is so ________. (AMAZE)",
        "options": ["amazing", "amazed", "amaze", "amazement"],
        "correctIndex": 0,
        "analysis": [
            "amazing (adj): tuy·ªát v·ªùi (t√≠nh ch·∫•t v·∫≠t).",
            "amazed (adj): b·ªã ng·∫°c nhi√™n (c·∫£m x√∫c ng∆∞·ªùi).",
            "amaze (v): l√†m ng·∫°c nhi√™n.",
            "amazement (n): s·ª± ng·∫°c nhi√™n."
        ],
        "translation": "Cu·ªôc s·ªëng v·ªÅ ƒë√™m ·ªü Berlin th·∫≠t tuy·ªát v·ªùi.",
        "whyCorrect": "Ch·ªß ng·ªØ 'nightlife' l√† v·∫≠t, n√™n ta d√πng t√≠nh t·ª´ ƒëu√¥i -ing ƒë·ªÉ mi√™u t·∫£ t√≠nh ch·∫•t c·ªßa n√≥.",
        "whyIncorrect": "Amazed ch·ªâ d√πng khi con ng∆∞·ªùi c·∫£m th·∫•y ng·∫°c nhi√™n v·ªÅ ƒëi·ªÅu g√¨ ƒë√≥."
    },
    {
        "question": "Take part in community ________. You can pick up rubbish. (CLEAN)",
        "options": ["clean-ups", "cleaning", "cleaner", "clean"],
        "correctIndex": 0,
        "analysis": [
            "clean-ups (n-s·ªë nhi·ªÅu): c√°c bu·ªïi d·ªçn d·∫πp.",
            "cleaning (n): vi·ªác d·ªçn d·∫πp.",
            "cleaner (n): ng∆∞·ªùi d·ªçn d·∫πp.",
            "clean (adj): s·∫°ch."
        ],
        "translation": "H√£y tham gia c√°c bu·ªïi d·ªçn d·∫πp c·ªông ƒë·ªìng. B·∫°n c√≥ th·ªÉ nh·∫∑t r√°c tr√™n ƒë∆∞·ªùng ph·ªë...",
        "whyCorrect": "'Community clean-ups' l√† thu·∫≠t ng·ªØ ch·ªâ c√°c chi·∫øn d·ªãch d·ªçn d·∫πp v√¨ c·ªông ƒë·ªìng (s·ªë nhi·ªÅu v√¨ l√† l·ªùi khuy√™n chung).",
        "whyIncorrect": "Cleaning l√† h√†nh ƒë·ªông l√†m s·∫°ch n√≥i chung, kh√¥ng mang t√≠nh s·ª± ki·ªán nh∆∞ clean-ups."
    },
    {
        "question": "Air ________ affects almost all regions in the world. (POLLUTE)",
        "options": ["pollution", "polluted", "pollute", "pollutant"],
        "correctIndex": 0,
        "analysis": [
            "pollution (n): s·ª± √¥ nhi·ªÖm.",
            "polluted (adj): b·ªã √¥ nhi·ªÖm.",
            "pollute (v): g√¢y √¥ nhi·ªÖm.",
            "pollutant (n): ch·∫•t g√¢y √¥ nhi·ªÖm."
        ],
        "translation": "√î nhi·ªÖm kh√¥ng kh√≠ ·∫£nh h∆∞·ªüng ƒë·∫øn h·∫ßu h·∫øt c√°c khu v·ª±c tr√™n th·∫ø gi·ªõi.",
        "whyCorrect": "'Air pollution' (√¥ nhi·ªÖm kh√¥ng kh√≠) l√† m·ªôt danh t·ª´ gh√©p ƒë√≥ng vai tr√≤ ch·ªß ng·ªØ.",
        "whyIncorrect": "Polluted l√† t√≠nh t·ª´, kh√¥ng th·ªÉ ƒë·ª©ng sau Air ƒë·ªÉ l√†m danh t·ª´ ch√≠nh trong c√¢u n√†y."
    },
    {
        "question": "The lyrics are catchy and the ________ are talented. (SING)",
        "options": ["singers", "singer", "singing", "song"],
        "correctIndex": 0,
        "analysis": [
            "singers (n-s·ªë nhi·ªÅu): c√°c ca sƒ©.",
            "singer (n-s·ªë √≠t): ca sƒ©.",
            "singing (n): vi·ªác ca h√°t.",
            "song (n): b√†i h√°t."
        ],
        "translation": "L·ªùi b√†i h√°t b·∫Øt tai v√† c√°c ca sƒ© th√¨ t√†i nƒÉng.",
        "whyCorrect": "ƒê·ªông t·ª´ 'are' cho th·∫•y ch·ªß ng·ªØ ph·∫£i l√† danh t·ª´ s·ªë nhi·ªÅu. 'Talented' th∆∞·ªùng d√πng cho ng∆∞·ªùi (ca sƒ©).",
        "whyIncorrect": "Singer (s·ªë √≠t) kh√¥ng ƒëi v·ªõi 'are'. Singing v√† Song kh√¥ng ph√π h·ª£p v·ªõi t√≠nh t·ª´ 'talented' (t√†i nƒÉng)."
    },
    {
        "question": "Everyone should ________ obey traffic rules. (strict)",
        "options": ["strictly", "strict", "strictness", "stricter"],
        "correctIndex": 0,
        "analysis": [
            "strictly (adv): m·ªôt c√°ch nghi√™m ch·ªânh.",
            "strict (adj): nghi√™m kh·∫Øc.",
            "strictness (n): s·ª± nghi√™m kh·∫Øc.",
            "stricter (adj-so s√°nh): nghi√™m kh·∫Øc h∆°n."
        ],
        "translation": "M·ªçi ng∆∞·ªùi n√™n tu√¢n th·ªß nghi√™m ch·ªânh lu·∫≠t giao th√¥ng v√¨ s·ª± an to√†n c·ªßa ch√≠nh h·ªç.",
        "whyCorrect": "Tr·∫°ng t·ª´ 'strictly' b·ªï nghƒ©a cho ƒë·ªông t·ª´ 'obey' (tu√¢n th·ªß th·∫ø n√†o? -> tu√¢n th·ªß nghi√™m ch·ªânh).",
        "whyIncorrect": "Strict l√† t√≠nh t·ª´, kh√¥ng b·ªï nghƒ©a cho ƒë·ªông t·ª´ th∆∞·ªùng."
    },
    {
        "question": "She's going to hospital for a ________ check-up. (MEDICINE)",
        "options": ["medical", "medicine", "medically", "medic"],
        "correctIndex": 0,
        "analysis": [
            "medical (adj): thu·ªôc v·ªÅ y t·∫ø/y khoa.",
            "medicine (n): thu·ªëc/ng√†nh y.",
            "medically (adv): v·ªÅ m·∫∑t y t·∫ø.",
            "medic (n): b√°c sƒ©/nh√¢n vi√™n c·ª©u th∆∞∆°ng."
        ],
        "translation": "C√¥ ·∫•y ƒëang ƒë·∫øn b·ªánh vi·ªán ƒë·ªÉ ki·ªÉm tra s·ª©c kh·ªèe.",
        "whyCorrect": "'Medical check-up' l√† c·ª•m danh t·ª´ c·ªë ƒë·ªãnh nghƒ©a l√† kh√°m s·ª©c kh·ªèe.",
        "whyIncorrect": "Medicine l√† thu·ªëc, kh√¥ng gh√©p ƒë∆∞·ª£c v·ªõi check-up ƒë·ªÉ t·∫°o th√†nh nghƒ©a kh√°m s·ª©c kh·ªèe."
    },
    {
        "question": "Some pieces of music are really ________. (EXCITE)",
        "options": ["exciting", "excited", "excitement", "excite"],
        "correctIndex": 0,
        "analysis": [
            "exciting (adj): th√∫ v·ªã/h√†o h·ª©ng (t√≠nh ch·∫•t).",
            "excited (adj): h√†o h·ª©ng (c·∫£m x√∫c).",
            "excitement (n): s·ª± ph·∫•n kh√≠ch.",
            "excite (v): l√†m ph·∫•n kh√≠ch."
        ],
        "translation": "M·ªôt s·ªë b·∫£n nh·∫°c th·ª±c s·ª± r·∫•t th√∫ v·ªã.",
        "whyCorrect": "Ch·ªß ng·ªØ l√† 'music' (v·∫≠t), n√™n d√πng t√≠nh t·ª´ ƒëu√¥i -ing ƒë·ªÉ mi√™u t·∫£ ƒë·∫∑c ƒëi·ªÉm cu·ªën d·∫´n c·ªßa √¢m nh·∫°c.",
        "whyIncorrect": "Excited l√† c·∫£m x√∫c c·ªßa ng∆∞·ªùi khi nghe nh·∫°c, kh√¥ng d√πng cho b·∫£n th√¢n b·∫£n nh·∫°c ƒë√≥."
    },
    {
        "question": "One of the ________ of solar energy is that it's expensive. (ADVANTAGE)",
        "options": ["disadvantages", "advantages", "disadvantage", "advantageous"],
        "correctIndex": 0,
        "analysis": [
            "disadvantages (n-s·ªë nhi·ªÅu): nh·ªØng b·∫•t l·ª£i.",
            "advantages (n-s·ªë nhi·ªÅu): nh·ªØng l·ª£i √≠ch.",
            "disadvantage (n-s·ªë √≠t): s·ª± b·∫•t l·ª£i.",
            "advantageous (adj): c√≥ l·ª£i."
        ],
        "translation": "M·ªôt trong nh·ªØng b·∫•t l·ª£i c·ªßa nƒÉng l∆∞·ª£ng m·∫∑t tr·ªùi l√† c√°c t·∫•m pin r·∫•t ƒë·∫Øt.",
        "whyCorrect": "C·∫•u tr√∫c 'One of the + N(s·ªë nhi·ªÅu)'. Ng·ªØ c·∫£nh n√≥i v·ªÅ vi·ªác 'ƒë·∫Øt' (expensive) n√™n ph·∫£i d√πng nghƒ©a ti√™u c·ª±c 'disadvantages'.",
        "whyIncorrect": "Advantages l√† l·ª£i √≠ch, tr√°i ng∆∞·ª£c v·ªõi n·ªôi dung 'expensive' ph√≠a sau."
    }
];

        let questions = [];
        let currentQuestionIndex = 0;
        let score = 0;
        let canAnswer = true;

        // Shuffle Function
        function shuffle(array) {
            for (let i = array.length - 1; i > 0; i--) {
                const j = Math.floor(Math.random() * (i + 1));
                [array[i], array[j]] = [array[j], array[i]];
            }
            return array;
        }

        function initGame() {
            // Clone and Shuffle questions
            questions = shuffle([...rawData]).map(q => {
                // Shuffle options for each question
                const optionsWithMeta = q.options.map((opt, idx) => ({
                    text: opt,
                    isCorrect: idx === q.correctIndex,
                    analysis: q.analysis[idx]
                }));
                const shuffledOpts = shuffle([...optionsWithMeta]);
                return {
                    ...q,
                    shuffledOptions: shuffledOpts
                };
            });
            
            currentQuestionIndex = 0;
            score = 0;
            updateStats();
            showQuestion();
        }

        function showQuestion() {
            canAnswer = true;
            const q = questions[currentQuestionIndex];
            const card = document.getElementById('question-card');
            card.classList.remove('shake');
            
            document.getElementById('question-text').innerText = `${currentQuestionIndex + 1}. ${q.question}`;
            document.getElementById('next-container').style.display = 'none';
            document.getElementById('explanation-box').style.display = 'none';
            
            const optionsGrid = document.getElementById('options-grid');
            optionsGrid.innerHTML = '';
            
            q.shuffledOptions.forEach((opt, index) => {
                const btn = document.createElement('button');
                btn.className = 'btn-option';
                btn.innerText = opt.text;
                btn.onclick = () => handleAnswer(index, btn);
                optionsGrid.appendChild(btn);
            });

            updateStats();
        }

        function handleAnswer(selectedIndex, btn) {
            if (!canAnswer) return;
            canAnswer = false;

            const q = questions[currentQuestionIndex];
            const isCorrect = q.shuffledOptions[selectedIndex].isCorrect;
            
            // Highlight buttons
            const buttons = document.querySelectorAll('.btn-option');
            buttons.forEach((b, idx) => {
                if (q.shuffledOptions[idx].isCorrect) {
                    b.classList.add('correct');
                } else if (idx === selectedIndex) {
                    b.classList.add('wrong');
                }
                b.disabled = true;
            });

            if (isCorrect) {
                score++;
                playSound('snd-correct');
                triggerConfetti();
            } else {
                playSound('snd-wrong');
                document.getElementById('question-card').classList.add('shake');
            }

            showExplanation(isCorrect);
            document.getElementById('next-container').style.display = 'flex';
            updateStats();
        }

        function showExplanation(isCorrect) {
            const q = questions[currentQuestionIndex];
            const expBox = document.getElementById('explanation-box');
            const expContent = document.getElementById('explanation-content');
            const icon = document.getElementById('exp-icon');
            
            icon.innerText = isCorrect ? 'üéâ Tuy·ªát v·ªùi!' : 'üí™ ƒê·ª´ng b·ªè cu·ªôc!';
            
            let html = `
                <div style="margin-bottom: 15px;">
                    <p><strong>1. Ph√¢n t√≠ch 4 ƒë√°p √°n:</strong></p>
                    <ul style="padding-left: 20px;">
                        ${q.analysis.map(item => `<li>${item}</li>`).join('')}
                    </ul>
                </div>
                <div style="margin-bottom: 15px;">
                    <p><strong>2. D·ªãch nghƒ©a to√†n c√¢u:</strong></p>
                    <p style="font-style: italic; color: #444;">"${q.translation}"</p>
                </div>
                <div>
                    <p><strong>3. T·∫°i sao ch·ªçn ƒë√°p √°n n√†y?</strong></p>
                    <p>${q.whyCorrect}</p>
                    <p><strong>4. T·∫°i sao c√°c ƒë√°p √°n kh√°c sai?</strong></p>
                    <p>${q.whyIncorrect}</p>
                </div>
            `;
            
            expContent.innerHTML = html;
            expBox.style.display = 'block';
        }

        function nextQuestion() {
            currentQuestionIndex++;
            if (currentQuestionIndex < questions.length) {
                showQuestion();
            } else {
                showFinalResult();
            }
        }

        function updateStats() {
            document.getElementById('question-counter').innerText = `C√¢u h·ªèi: ${currentQuestionIndex + 1}/${questions.length}`;
            document.getElementById('score-counter').innerText = `ƒêi·ªÉm: ${score}`;
            const progress = ((currentQuestionIndex) / questions.length) * 100;
            document.getElementById('progress-bar').style.width = `${progress}%`;
        }

        function triggerConfetti() {
            confetti({
                particleCount: 100,
                spread: 70,
                origin: { y: 0.6 },
                colors: ['#8854C0', '#00C9A7', '#FFD93D']
            });
        }

        function playSound(id) {
            const audio = document.getElementById(id);
            audio.currentTime = 0;
            audio.play().catch(e => console.log("Sound blocked by browser"));
        }

        function showFinalResult() {
            document.getElementById('result-modal').style.display = 'flex';
            document.getElementById('final-score').innerText = `${score}/${questions.length}`;
            
            let feedback = "";
            if (score === questions.length) feedback = "H·∫øt n∆∞·ªõc ch·∫•m! Con l√† thi√™n t√†i Word Form! üèÜ";
            else if (score >= 25) feedback = "Xu·∫•t s·∫Øc! Ms Mai An r·∫•t t·ª± h√†o v·ªÅ con! üåü";
            else if (score >= 15) feedback = "Kh√° l·∫Øm! C·ªë g·∫Øng luy·ªán t·∫≠p th√™m ch√∫t n·ªØa nh√©! üëç";
            else feedback = "ƒê·ª´ng n·∫£n ch√≠! H√£y xem k·ªπ ph·∫ßn gi·∫£i th√≠ch v√† l√†m l·∫°i nh√©! üí™";
            
            document.getElementById('feedback-text').innerText = feedback;
            document.getElementById('progress-bar').style.width = `100%`;
        }

        function restartGame() {
            document.getElementById('result-modal').style.display = 'none';
            initGame();
        }

        // Start the game on load
        window.onload = initGame;
    </script>
</body>
</html>
