<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Th·ª≠ Th√°ch Gi·ªõi T·ª´ C√πng Ms Mai An</title>
    <link href="https://fonts.googleapis.com/css2?family=Nunito:wght@400;600;700;800&family=Quicksand:wght@500;700&display=swap" rel="stylesheet">
    <style>
        :root {
            --primary: #8854C0; /* H·ªìng t√≠m pastel */
            --secondary: #00C9A7; /* Xanh ng·ªçc */
            --correct: #00D26A; /* Xanh l√° */
            --wrong: #FF4757; /* ƒê·ªè cam */
            --bg-pattern: #f0f3f8;
            --card-bg: #ffffff;
            --text-main: #2d3436;
        }

        * {
            box-sizing: border-box;
            margin: 0;
            padding: 0;
        }

        body {
            font-family: 'Nunito', sans-serif;
            background-color: #e3f2fd;
            background-image: radial-gradient(#8854C0 15%, transparent 16%), radial-gradient(#00C9A7 15%, transparent 16%);
            background-size: 20px 20px;
            background-position: 0 0, 10px 10px;
            color: var(--text-main);
            padding-bottom: 50px;
        }

        /* Header nh·ªè g·ªçn */
        .teacher-header {
            background: #fff;
            color: var(--primary);
            padding: 5px 20px;
            font-size: 0.9rem;
            font-weight: 700;
            border-bottom: 3px solid #ddd;
            position: fixed;
            top: 0;
            width: 100%;
            z-index: 1000;
            display: flex;
            justify-content: space-between;
            align-items: center;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
        }

        .container {
            max-width: 800px;
            margin: 60px auto 0;
            padding: 20px;
        }

        h1 {
            text-align: center;
            color: var(--primary);
            font-family: 'Quicksand', sans-serif;
            font-size: 2.5rem;
            margin-bottom: 20px;
            text-shadow: 2px 2px 0px #fff;
            animation: popIn 0.8s cubic-bezier(0.68, -0.55, 0.27, 1.55);
        }

        /* L√Ω thuy·∫øt - Theory Card */
        .theory-card {
            background: white;
            border-radius: 20px;
            padding: 20px;
            margin-bottom: 30px;
            box-shadow: 0 8px 0 rgba(0,0,0,0.1);
            border: 2px solid var(--secondary);
        }
        
        .theory-title {
            font-size: 1.5rem;
            color: var(--secondary);
            font-weight: 800;
            margin-bottom: 15px;
            text-align: center;
            text-transform: uppercase;
        }

        table {
            width: 100%;
            border-collapse: collapse;
            margin-bottom: 15px;
            font-size: 0.95rem;
        }

        th, td {
            border: 1px solid #ddd;
            padding: 10px;
            text-align: left;
        }

        th {
            background-color: var(--primary);
            color: white;
            text-align: center;
        }

        tr:nth-child(even) {background-color: #f9f9f9;}

        /* Quiz Cards */
        .quiz-card {
            background: white;
            border-radius: 20px;
            padding: 25px;
            margin-bottom: 25px;
            box-shadow: 0 6px 0 #d1d8e0;
            transition: transform 0.3s;
            position: relative;
            border: 2px solid transparent;
        }

        .quiz-card:hover {
            transform: translateY(-5px);
        }

        .question-number {
            background: var(--primary);
            color: white;
            padding: 5px 15px;
            border-radius: 20px;
            font-weight: bold;
            display: inline-block;
            margin-bottom: 10px;
            font-size: 0.9rem;
        }

        .question-text {
            font-size: 1.3rem;
            font-weight: 700;
            margin-bottom: 20px;
            color: #2c3e50;
        }

        .options-grid {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 15px;
        }

        @media (max-width: 600px) {
            .options-grid {
                grid-template-columns: 1fr;
            }
        }

        .option-btn {
            background: white;
            border: 2px solid #dfe6e9;
            border-bottom: 6px solid #dfe6e9;
            padding: 15px;
            border-radius: 15px;
            font-family: 'Nunito', sans-serif;
            font-size: 1.1rem;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.1s;
            text-align: left;
            position: relative;
        }

        .option-btn:active {
            transform: translateY(4px);
            border-bottom: 2px solid #dfe6e9;
        }

        .option-btn:hover:not(.disabled) {
            background-color: #f0f3f8;
            transform: scale(1.02);
        }

        /* Tr·∫°ng th√°i ƒê√∫ng/Sai */
        .option-btn.correct {
            background-color: var(--correct);
            color: white;
            border-color: #00b85c;
            border-bottom-color: #008f47;
        }

        .option-btn.wrong {
            background-color: var(--wrong);
            color: white;
            border-color: #ff2e43;
            border-bottom-color: #d61c30;
            animation: shake 0.5s;
        }

        /* Gi·∫£i th√≠ch */
        .explanation {
            display: none;
            margin-top: 20px;
            padding: 20px;
            background: #eefbf4;
            border: 2px dashed var(--correct);
            border-radius: 15px;
            font-size: 1rem;
            line-height: 1.6;
        }
        
        .explanation.visible {
            display: block;
            animation: slideDown 0.4s ease-out;
        }

        .explanation strong {
            color: var(--primary);
        }

        .exp-header {
            font-weight: 800;
            color: var(--secondary);
            margin-bottom: 10px;
            display: block;
            font-size: 1.1rem;
        }

        /* N√∫t n·ªôp b√†i */
        .submit-section {
            text-align: center;
            margin-top: 40px;
        }

        .submit-btn {
            background: var(--secondary);
            color: white;
            border: none;
            border-bottom: 8px solid #009e82;
            padding: 15px 50px;
            font-size: 1.5rem;
            border-radius: 50px;
            cursor: pointer;
            font-weight: 800;
            font-family: 'Quicksand', sans-serif;
            transition: all 0.2s;
        }

        .submit-btn:active {
            transform: translateY(6px);
            border-bottom-width: 2px;
        }

        /* Animations */
        @keyframes shake {
            0% { transform: translateX(0); }
            25% { transform: translateX(-10px); }
            50% { transform: translateX(10px); }
            75% { transform: translateX(-10px); }
            100% { transform: translateX(0); }
        }

        @keyframes popIn {
            0% { opacity: 0; transform: scale(0.5); }
            100% { opacity: 1; transform: scale(1); }
        }

        @keyframes slideDown {
            from { opacity: 0; transform: translateY(-10px); }
            to { opacity: 1; transform: translateY(0); }
        }

        /* Modal K·∫øt qu·∫£ */
        .modal-overlay {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0,0,0,0.5);
            display: none;
            justify-content: center;
            align-items: center;
            z-index: 2000;
        }

        .modal-content {
            background: white;
            padding: 40px;
            border-radius: 30px;
            text-align: center;
            max-width: 500px;
            width: 90%;
            box-shadow: 0 10px 25px rgba(0,0,0,0.2);
            animation: popIn 0.5s;
        }

        .score-display {
            font-size: 4rem;
            font-weight: 900;
            color: var(--primary);
            margin: 20px 0;
        }

        .feedback-text {
            font-size: 1.2rem;
            color: #555;
            margin-bottom: 20px;
        }

        /* Confetti Canvas */
        #confetti-canvas {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            pointer-events: none;
            z-index: 9999;
        }

    </style>
</head>
<body>

    <div class="teacher-header">
        <span><i class="fas fa-chalkboard-teacher"></i> Gi√°o vi√™n t·∫°o: Ms Mai An ULIS</span>
        <span>L·ªõp h·ªçc vui v·∫ª</span>
    </div>

    <canvas id="confetti-canvas"></canvas>

    <div class="container">
        <h1>PREPOSITIONS MASTER <br> <span>(IN - ON - AT)</span></h1>

        <div class="theory-card">
            <div class="theory-title">üìö √în t·∫≠p ki·∫øn th·ª©c c√πng Ms Mai An</div>
            <table>
                <thead>
                    <tr>
                        <th>Gi·ªõi t·ª´</th>
                        <th>C√°ch d√πng ch√≠nh</th>
                        <th>V√≠ d·ª• ghi nh·ªõ</th>
                    </tr>
                </thead>
                <tbody>
                    <tr>
                        <td><strong>IN</strong></td>
                        <td>
                            - Qu·ªëc gia, th√†nh ph·ªë, ch√¢u l·ª•c<br>
                            - Kh√¥ng gian k√≠n (ph√≤ng, h·ªôp, t√≤a nh√†)<br>
                            - Ph∆∞∆°ng ti·ªán: Car, Taxi
                        </td>
                        <td>
                            in Vietnam, in Hanoi, in the room, in a taxi, in the North
                        </td>
                    </tr>
                    <tr>
                        <td><strong>ON</strong></td>
                        <td>
                            - Tr√™n b·ªÅ m·∫∑t (b√†n, t∆∞·ªùng)<br>
                            - T√™n ƒë∆∞·ªùng (kh√¥ng s·ªë), ƒê·∫£o<br>
                            - Ph∆∞∆°ng ti·ªán: Bus, Train, Plane, Ship
                        </td>
                        <td>
                            on the table, on Le Loi Street, on Phu Quoc Island, on the bus
                        </td>
                    </tr>
                    <tr>
                        <td><strong>AT</strong></td>
                        <td>
                            - ƒê·ªãa ƒëi·ªÉm c·ª• th·ªÉ, ƒë·ªãa ch·ªâ nh√† (c√≥ s·ªë)<br>
                            - N∆°i ch·ªën: School, Work, Home<br>
                            - S·ª± ki·ªán: Party, Meeting
                        </td>
                        <td>
                            at 25 Tran Phu, at school, at the airport, at a party
                        </td>
                    </tr>
                </tbody>
            </table>
            <div style="background: #fff3cd; padding: 10px; border-radius: 10px; border: 1px solid #ffeeba; text-align: center;">
                ‚ö° <strong>L∆∞u √Ω:</strong> Arrive <strong>IN</strong> (th√†nh ph·ªë/n∆∞·ªõc) - Arrive <strong>AT</strong> (s√¢n bay/nh√† ga/ƒë·ªãa ƒëi·ªÉm nh·ªè).
            </div>
        </div>

        <div id="quiz-container">
            </div>

        <div class="submit-section">
            <button class="submit-btn" onclick="submitQuiz()">N·ªôp B√†i & Xem ƒêi·ªÉm</button>
        </div>
    </div>

    <div class="modal-overlay" id="result-modal">
        <div class="modal-content">
            <h2>K·∫øt Qu·∫£ C·ªßa B·∫°n</h2>
            <div class="score-display" id="final-score">0/30</div>
            <p class="feedback-text" id="feedback-msg">B·∫°n l√†m t·ªët l·∫Øm!</p>
            <button class="submit-btn" style="font-size: 1rem; padding: 10px 30px;" onclick="closeModal()">Xem l·∫°i b√†i</button>
        </div>
    </div>

    <script>
        // --- DATA ---
        const questions = [
            {
                id: 1,
                text: "My uncle lives _______ Hanoi, the capital of Vietnam.",
                options: ["on", "at", "in", "of"],
                answer: 2, // in
                explain: "<b>1. Ph√¢n t√≠ch:</b><br>Hanoi (n): H√† N·ªôi (Th√†nh ph·ªë/ƒê·ªãa danh l·ªõn).<br><b>2. D·ªãch nghƒ©a:</b> Ch√∫ t√¥i s·ªëng ·ªü H√† N·ªôi, th·ªß ƒë√¥ c·ªßa Vi·ªát Nam.<br><b>3. T·∫°i sao ch·ªçn IN?</b> C√¥ Mai An nh·∫Øc: D√πng 'in' tr∆∞·ªõc t√™n th√†nh ph·ªë, th·ªã tr·∫•n, qu·ªëc gia (in Hanoi, in Vietnam).<br><b>4. T·∫°i sao sai?</b> 'On' d√πng cho b·ªÅ m·∫∑t/ƒë∆∞·ªùng; 'At' d√πng cho ƒë·ªãa ch·ªâ c·ª• th·ªÉ/ƒë·ªãa ƒëi·ªÉm nh·ªè."
            },
            {
                id: 2,
                text: "There is a beautiful picture _______ the wall.",
                options: ["in", "on", "at", "into"],
                answer: 1, // on
                explain: "<b>1. Ph√¢n t√≠ch:</b><br>Wall (n): B·ª©c t∆∞·ªùng (B·ªÅ m·∫∑t).<br><b>2. D·ªãch nghƒ©a:</b> C√≥ m·ªôt b·ª©c tranh ƒë·∫πp ·ªü tr√™n t∆∞·ªùng.<br><b>3. T·∫°i sao ch·ªçn ON?</b> Quy t·∫Øc: V·∫≠t n·∫±m tr√™n b·ªÅ m·∫∑t ph·∫≥ng (d√π ngang hay d·ªçc) d√πng 'on' (on the table, on the wall).<br><b>4. T·∫°i sao sai?</b> 'In' l√† b√™n trong kh·ªëi; 'At' l√† t·∫°i m·ªôt ƒëi·ªÉm."
            },
            {
                id: 3,
                text: "We will meet _______ the cinema at 7 p.m.",
                options: ["on", "in", "at", "to"],
                answer: 2, // at
                explain: "<b>1. Ph√¢n t√≠ch:</b><br>The cinema (n): R·∫°p chi·∫øu phim (ƒê·ªãa ƒëi·ªÉm c√¥ng c·ªông c·ª• th·ªÉ ƒë·ªÉ g·∫∑p g·ª°).<br><b>2. D·ªãch nghƒ©a:</b> Ch√∫ng ta s·∫Ω g·∫∑p nhau t·∫°i r·∫°p chi·∫øu phim l√∫c 7 gi·ªù t·ªëi.<br><b>3. T·∫°i sao ch·ªçn AT?</b> D√πng 'at' ƒë·ªÉ ch·ªâ m·ªôt ƒëi·ªÉm d·ª´ng ch√¢n, n∆°i g·∫∑p g·ª° ho·∫∑c ƒë·ªãa ƒëi·ªÉm c√¥ng c·ªông c·ª• th·ªÉ.<br><b>4. T·∫°i sao sai?</b> 'In the cinema' c√≥ nghƒ©a l√† ƒëang ng·ªìi b√™n trong r·∫°p (nh·∫•n m·∫°nh kh√¥ng gian k√≠n), nh∆∞ng ·ªü ƒë√¢y 'meet' (g·∫∑p) th∆∞·ªùng d√πng 'at'."
            },
            {
                id: 4,
                text: "Put your toys _______ the box, please!",
                options: ["at", "on", "in", "above"],
                answer: 2, // in
                explain: "<b>1. Ph√¢n t√≠ch:</b><br>Box (n): C√°i h·ªôp (Kh√¥ng gian k√≠n/v·∫≠t ch·ª©a).<br><b>2. D·ªãch nghƒ©a:</b> L√†m ∆°n c·∫•t ƒë·ªì ch∆°i c·ªßa con v√†o trong h·ªôp ƒëi!<br><b>3. T·∫°i sao ch·ªçn IN?</b> D√πng 'in' cho v·∫≠t n·∫±m b√™n trong kh√¥ng gian k√≠n (in the box, in the room).<br><b>4. T·∫°i sao sai?</b> 'On' l√† tr√™n n·∫Øp h·ªôp; 'At' l√† t·∫°i v·ªã tr√≠ c√°i h·ªôp."
            },
            {
                id: 5,
                text: "Her house is _______ 25 Tran Phu Street.",
                options: ["in", "on", "at", "from"],
                answer: 2, // at
                explain: "<b>1. Ph√¢n t√≠ch:</b><br>25 Tran Phu Street: ƒê·ªãa ch·ªâ nh√† c·ª• th·ªÉ (c√≥ s·ªë nh√†).<br><b>2. D·ªãch nghƒ©a:</b> Nh√† c√¥ ·∫•y ·ªü s·ªë 25 ƒë∆∞·ªùng Tr·∫ßn Ph√∫.<br><b>3. T·∫°i sao ch·ªçn AT?</b> C√¥ Mai An nh·∫Øc kƒ©: C√≥ s·ªë nh√† c·ª• th·ªÉ ph·∫£i d√πng 'AT'.<br><b>4. T·∫°i sao sai?</b> N·∫øu ch·ªâ c√≥ t√™n ƒë∆∞·ªùng (Tran Phu Street) th√¨ d√πng 'ON'. ·ªû ƒë√¢y c√≥ s·ªë 25 n√™n 'On' sai."
            },
            {
                id: 6,
                text: "They are swimming _______ the sea.",
                options: ["on", "at", "in", "over"],
                answer: 2, // in
                explain: "<b>1. Ph√¢n t√≠ch:</b><br>The sea (n): Bi·ªÉn (M√¥i tr∆∞·ªùng n∆∞·ªõc/kh√¥ng gian ch·ª©a).<br><b>2. D·ªãch nghƒ©a:</b> H·ªç ƒëang b∆°i d∆∞·ªõi bi·ªÉn.<br><b>3. T·∫°i sao ch·ªçn IN?</b> Khi n√≥i v·ªÅ b∆°i l·ªôi trong m√¥i tr∆∞·ªùng n∆∞·ªõc (sea, river, pool), ta d√πng 'in' (·ªü b√™n trong l√†n n∆∞·ªõc).<br><b>4. T·∫°i sao sai?</b> 'On the sea' nghƒ©a l√† tr√¥i l·ªÅnh b·ªÅnh tr√™n m·∫∑t n∆∞·ªõc (nh∆∞ con thuy·ªÅn)."
            },
            {
                id: 7,
                text: "Don't sit _______ the floor; it's very dirty.",
                options: ["in", "at", "on", "by"],
                answer: 2, // on
                explain: "<b>1. Ph√¢n t√≠ch:</b><br>The floor (n): S√†n nh√† (B·ªÅ m·∫∑t).<br><b>2. D·ªãch nghƒ©a:</b> ƒê·ª´ng ng·ªìi tr√™n s√†n nh√†; n√≥ b·∫©n l·∫Øm.<br><b>3. T·∫°i sao ch·ªçn ON?</b> S√†n nh√† l√† b·ªÅ m·∫∑t ph·∫≥ng, ta ti·∫øp x√∫c l√™n tr√™n n√≥ -> D√πng 'on'.<br><b>4. T·∫°i sao sai?</b> Kh√¥ng ai ng·ªìi 'in' (b√™n trong) s√†n nh√† c·∫£."
            },
            {
                id: 8,
                text: "My father is working _______ the garden.",
                options: ["on", "at", "in", "of"],
                answer: 2, // in
                explain: "<b>1. Ph√¢n t√≠ch:</b><br>Garden (n): Khu v∆∞·ªùn (Kh√¥ng gian c√≥ ranh gi·ªõi bao quanh).<br><b>2. D·ªãch nghƒ©a:</b> B·ªë t√¥i ƒëang l√†m vi·ªác trong v∆∞·ªùn.<br><b>3. T·∫°i sao ch·ªçn IN?</b> V∆∞·ªùn, s√¢n, c√°nh ƒë·ªìng (field) ƒë∆∞·ª£c xem l√† kh√¥ng gian, d√πng 'in'.<br><b>4. T·∫°i sao sai?</b> 'On' sai v√¨ kh√¥ng ch·ªâ ƒë·ª©ng tr√™n b·ªÅ m·∫∑t c·ªè m√† l√† trong kh√¥ng gian ƒë√≥."
            },
            {
                id: 9,
                text: "We usually go to school _______ the bus.",
                options: ["in", "on", "at", "by"],
                answer: 1, // on
                explain: "<b>1. Ph√¢n t√≠ch:</b><br>The bus (n): Xe bu√Ωt (Ph∆∞∆°ng ti·ªán c√¥ng c·ªông l·ªõn, c√≥ th·ªÉ ƒëi l·∫°i b√™n trong).<br><b>2. D·ªãch nghƒ©a:</b> Ch√∫ng t√¥i th∆∞·ªùng ƒëi h·ªçc tr√™n xe bu√Ωt.<br><b>3. T·∫°i sao ch·ªçn ON?</b> Quy t·∫Øc ph∆∞∆°ng ti·ªán: Bus, Train, Plane, Ship (ƒë·ª©ng v√† ƒëi l·∫°i ƒë∆∞·ª£c) -> D√πng ON. (L∆∞u √Ω: N·∫øu d√πng 'by' th√¨ ph·∫£i l√† 'by bus' kh√¥ng c√≥ 'the').<br><b>4. T·∫°i sao sai?</b> 'In' d√πng cho Car/Taxi."
            },
            {
                id: 10,
                text: "I read about it _______ the newspaper.",
                options: ["at", "in", "on", "to"],
                answer: 1, // in
                explain: "<b>1. Ph√¢n t√≠ch:</b><br>Newspaper (n): T·ªù b√°o (V·∫≠t ch·ª©a th√¥ng tin/ch·ªØ vi·∫øt).<br><b>2. D·ªãch nghƒ©a:</b> T√¥i ƒë√£ ƒë·ªçc v·ªÅ ƒëi·ªÅu ƒë√≥ trong t·ªù b√°o.<br><b>3. T·∫°i sao ch·ªçn IN?</b> V·ªõi s√°ch, b√°o, t·∫°p ch√≠ (ch·ª©a n·ªôi dung b√™n trong), ta d√πng 'in'.<br><b>4. T·∫°i sao sai?</b> D√πng 'On' khi n√≥i v·∫≠t g√¨ ƒë·∫∑t tr√™n b·ªÅ m·∫∑t t·ªù b√°o (v√≠ d·ª•: c√°i k√≠nh tr√™n t·ªù b√°o)."
            },
            {
                id: 11,
                text: "She arrived _______ Paris late last night.",
                options: ["at", "on", "in", "to"],
                answer: 2, // in
                explain: "<b>1. Ph√¢n t√≠ch:</b><br>Paris (n): Th·ªß ƒë√¥ c·ªßa Ph√°p (Th√†nh ph·ªë l·ªõn). Arrive (v): ƒê·∫øn.<br><b>2. D·ªãch nghƒ©a:</b> C√¥ ·∫•y ƒë√£ ƒë·∫øn Paris mu·ªôn v√†o t·ªëi qua.<br><b>3. T·∫°i sao ch·ªçn IN?</b> C·∫•u tr√∫c: Arrive IN + Th√†nh ph·ªë/Qu·ªëc gia (ƒê·ªãa ƒëi·ªÉm l·ªõn).<br><b>4. T·∫°i sao sai?</b> Arrive AT + ƒê·ªãa ƒëi·ªÉm nh·ªè (S√¢n bay, nh√† ga)."
            },
            {
                id: 12,
                text: "The train stopped _______ the station for 10 minutes.",
                options: ["in", "on", "at", "behind"],
                answer: 2, // at
                explain: "<b>1. Ph√¢n t√≠ch:</b><br>The station (n): Nh√† ga (ƒêi·ªÉm d·ª´ng c·ª• th·ªÉ).<br><b>2. D·ªãch nghƒ©a:</b> T√†u ƒë√£ d·ª´ng t·∫°i nh√† ga trong 10 ph√∫t.<br><b>3. T·∫°i sao ch·ªçn AT?</b> Nh√† ga, s√¢n bay, b·∫øn xe bu√Ωt l√† c√°c 'ƒëi·ªÉm' giao th√¥ng -> D√πng 'at'.<br><b>4. T·∫°i sao sai?</b> 'In' nghƒ©a l√† b√™n trong t√≤a nh√† ga (√≠t d√πng khi n√≥i v·ªÅ t√†u d·ª´ng)."
            },
            {
                id: 13,
                text: "Look at the stars _______ the sky!",
                options: ["on", "at", "in", "above"],
                answer: 2, // in
                explain: "<b>1. Ph√¢n t√≠ch:</b><br>The sky (n): B·∫ßu tr·ªùi (Kh√¥ng gian r·ªông l·ªõn).<br><b>2. D·ªãch nghƒ©a:</b> H√£y nh√¨n nh·ªØng ng√¥i sao tr√™n b·∫ßu tr·ªùi k√¨a!<br><b>3. T·∫°i sao ch·ªçn IN?</b> Trong ti·∫øng Anh, b·∫ßu tr·ªùi l√† m·ªôt kh√¥ng gian bao la, c√°c v·∫≠t n·∫±m 'trong' kh√¥ng gian ƒë√≥ -> D√πng 'in the sky'.<br><b>4. T·∫°i sao sai?</b> Ti·∫øng Vi·ªát n√≥i 'tr√™n tr·ªùi' nh∆∞ng ti·∫øng Anh KH√îNG d√πng 'on the sky'."
            },
            {
                id: 14,
                text: "My office is _______ the second floor.",
                options: ["at", "in", "on", "under"],
                answer: 2, // on
                explain: "<b>1. Ph√¢n t√≠ch:</b><br>The second floor (n): T·∫ßng 2.<br><b>2. D·ªãch nghƒ©a:</b> VƒÉn ph√≤ng c·ªßa t√¥i ·ªü t·∫ßng 2.<br><b>3. T·∫°i sao ch·ªçn ON?</b> Quy t·∫Øc: D√πng 'on' v·ªõi s·ªë t·∫ßng (On the 1st floor, on the top floor).<br><b>4. T·∫°i sao sai?</b> 'In' v√† 'At' kh√¥ng d√πng cho t·∫ßng nh√†."
            },
            {
                id: 15,
                text: "We stayed _______ a lovely hotel by the beach.",
                options: ["on", "to", "at", "of"],
                answer: 2, // at
                explain: "<b>1. Ph√¢n t√≠ch:</b><br>Hotel (n): Kh√°ch s·∫°n (ƒê·ªãa ƒëi·ªÉm l∆∞u tr√∫).<br><b>2. D·ªãch nghƒ©a:</b> Ch√∫ng t√¥i ƒë√£ ·ªü t·∫°i m·ªôt kh√°ch s·∫°n d·ªÖ th∆∞∆°ng g·∫ßn b√£i bi·ªÉn.<br><b>3. T·∫°i sao ch·ªçn AT?</b> Khi n√≥i v·ªÅ vi·ªác l∆∞u tr√∫ ho·∫∑c s·ª± ki·ªán t·∫°i m·ªôt t√≤a nh√†, ta d√πng 'at'. (C≈©ng c√≥ th·ªÉ d√πng 'in' n·∫øu mu·ªën nh·∫•n m·∫°nh ·ªü trong ph√≤ng, nh∆∞ng 'at' ph·ªï bi·∫øn h∆°n cho ƒë·ªãa ƒëi·ªÉm chung).<br><b>4. T·∫°i sao sai?</b> 'On a hotel' l√† sai (tr√™n n√≥c kh√°ch s·∫°n?)."
            },
            {
                id: 16,
                text: "Hurry up! Get _______ the car, we are late.",
                options: ["on", "in", "at", "to"],
                answer: 1, // in
                explain: "<b>1. Ph√¢n t√≠ch:</b><br>Car (n): Xe h∆°i (Ph∆∞∆°ng ti·ªán c√° nh√¢n nh·ªè, ph·∫£i c√∫i ng∆∞·ªùi v√†o).<br><b>2. D·ªãch nghƒ©a:</b> Nhanh l√™n! V√†o xe ƒëi, ch√∫ng ta mu·ªôn r·ªìi.<br><b>3. T·∫°i sao ch·ªçn IN?</b> Quy t·∫Øc ph∆∞∆°ng ti·ªán: Car, Taxi, Helicopter (kh√¥ng gian nh·ªè, kh√¥ng ƒëi l·∫°i ƒë∆∞·ª£c b√™n trong) -> D√πng IN.<br><b>4. T·∫°i sao sai?</b> 'On' d√πng cho Bus/Train."
            },
            {
                id: 17,
                text: " Phu Quoc is the largest island _______ Vietnam.",
                options: ["on", "at", "in", "from"],
                answer: 2, // in
                explain: "<b>1. Ph√¢n t√≠ch:</b><br>Vietnam (n): Qu·ªëc gia.<br><b>2. D·ªãch nghƒ©a:</b> Ph√∫ Qu·ªëc l√† h√≤n ƒë·∫£o l·ªõn nh·∫•t ·ªü Vi·ªát Nam.<br><b>3. T·∫°i sao ch·ªçn IN?</b> Tr∆∞·ªõc t√™n ƒë·∫•t n∆∞·ªõc d√πng 'in'.<br><b>4. T·∫°i sao sai?</b> L∆∞u √Ω: D√πng 'On' cho ƒë·∫£o (On Phu Quoc Island) nh∆∞ng d√πng 'In' cho qu·ªëc gia ch·ª©a h√≤n ƒë·∫£o ƒë√≥."
            },
            {
                id: 18,
                text: "She is currently _______ work.",
                options: ["in", "on", "at", "to"],
                answer: 2, // at
                explain: "<b>1. Ph√¢n t√≠ch:</b><br>Work (n): N∆°i l√†m vi·ªác (Tr·∫°ng th√°i ƒëang l√†m vi·ªác).<br><b>2. D·ªãch nghƒ©a:</b> C√¥ ·∫•y hi·ªán ƒëang ·ªü ch·ªó l√†m.<br><b>3. T·∫°i sao ch·ªçn AT?</b> C·ª•m c·ªë ƒë·ªãnh: at work (ƒëang l√†m vi·ªác), at school (ƒëang ƒëi h·ªçc), at home (·ªü nh√†).<br><b>4. T·∫°i sao sai?</b> Kh√¥ng d√πng 'in work' hay 'on work' trong ng·ªØ c·∫£nh ƒë·ªãa ƒëi·ªÉm n√†y."
            },
            {
                id: 19,
                text: "The shop is _______ Le Loi Street.",
                options: ["in", "at", "on", "into"],
                answer: 2, // on
                explain: "<b>1. Ph√¢n t√≠ch:</b><br>Le Loi Street: T√™n ƒë∆∞·ªùng (Kh√¥ng c√≥ s·ªë nh√†).<br><b>2. D·ªãch nghƒ©a:</b> C·ª≠a h√†ng n·∫±m tr√™n ƒë∆∞·ªùng L√™ L·ª£i.<br><b>3. T·∫°i sao ch·ªçn ON?</b> Ch·ªâ c√≥ t√™n ƒë∆∞·ªùng -> D√πng 'ON'.<br><b>4. T·∫°i sao sai?</b> N·∫øu th√™m s·ªë nh√† (v√≠ d·ª• 10 Le Loi) m·ªõi d√πng 'At'."
            },
            {
                id: 20,
                text: "I saw a spider _______ the ceiling.",
                options: ["in", "at", "on", "above"],
                answer: 2, // on
                explain: "<b>1. Ph√¢n t√≠ch:</b><br>Ceiling (n): Tr·∫ßn nh√†.<br><b>2. D·ªãch nghƒ©a:</b> T√¥i th·∫•y m·ªôt con nh·ªán ·ªü tr√™n tr·∫ßn nh√†.<br><b>3. T·∫°i sao ch·ªçn ON?</b> Tr·∫ßn nh√† c≈©ng l√† m·ªôt b·ªÅ m·∫∑t (d√π n√≥ ·ªü tr√™n ƒë·∫ßu ta), con nh·ªán b√°m v√†o b·ªÅ m·∫∑t ƒë√≥ -> D√πng 'on'.<br><b>4. T·∫°i sao sai?</b> 'In' l√† b√™n trong l·ªõp b√™ t√¥ng tr·∫ßn nh√†."
            },
            {
                id: 21,
                text: "They arrived _______ the airport just in time.",
                options: ["on", "in", "at", "to"],
                answer: 2, // at
                explain: "<b>1. Ph√¢n t√≠ch:</b><br>The airport (n): S√¢n bay (ƒê·ªãa ƒëi·ªÉm c·ª• th·ªÉ).<br><b>2. D·ªãch nghƒ©a:</b> H·ªç ƒë√£ ƒë·∫øn s√¢n bay v·ª´a k·ªãp l√∫c.<br><b>3. T·∫°i sao ch·ªçn AT?</b> Arrive AT + ƒê·ªãa ƒëi·ªÉm nh·ªè/c·ª• th·ªÉ.<br><b>4. T·∫°i sao sai?</b> Arrive IN + Th√†nh ph·ªë/Qu·ªëc gia."
            },
            {
                id: 22,
                text: "Who is that man standing _______ the bus stop?",
                options: ["in", "on", "at", "under"],
                answer: 2, // at
                explain: "<b>1. Ph√¢n t√≠ch:</b><br>Bus stop (n): ƒêi·ªÉm ch·ªù xe bu√Ωt.<br><b>2. D·ªãch nghƒ©a:</b> Ng∆∞·ªùi ƒë√†n √¥ng ƒëang ƒë·ª©ng ·ªü ƒëi·ªÉm ch·ªù xe bu√Ωt l√† ai v·∫≠y?<br><b>3. T·∫°i sao ch·ªçn AT?</b> ƒêi·ªÉm ch·ªù xe bu√Ωt l√† m·ªôt v·ªã tr√≠ ch√≠nh x√°c tr√™n ƒë∆∞·ªùng -> D√πng 'at'.<br><b>4. T·∫°i sao sai?</b> Kh√¥ng ai ƒë·ª©ng 'in' (trong) c√°i c·ªôt xe bu√Ωt c·∫£."
            },
            {
                id: 23,
                text: "Open your book _______ page 33.",
                options: ["at", "in", "on", "to"],
                answer: 2, // on
                explain: "<b>1. Ph√¢n t√≠ch:</b><br>Page 33 (n): Trang 33.<br><b>2. D·ªãch nghƒ©a:</b> M·ªü s√°ch c·ªßa em ra trang 33.<br><b>3. T·∫°i sao ch·ªçn ON?</b> S·ªë trang ƒë∆∞·ª£c xem l√† b·ªÅ m·∫∑t ch·ª©a th√¥ng tin -> D√πng 'on page...'.<br><b>4. T·∫°i sao sai?</b> M·ªôt s·ªë s√°ch c≈© d√πng 'at page' nh∆∞ng hi·ªán nay 'on page' chu·∫©n x√°c h∆°n."
            },
            {
                id: 24,
                text: "Jane isn't here. She is _______ a party.",
                options: ["in", "on", "at", "to"],
                answer: 2, // at
                explain: "<b>1. Ph√¢n t√≠ch:</b><br>Party (n): B·ªØa ti·ªác (S·ª± ki·ªán/Ho·∫°t ƒë·ªông).<br><b>2. D·ªãch nghƒ©a:</b> Jane kh√¥ng ·ªü ƒë√¢y. C√¥ ·∫•y ƒëang ·ªü m·ªôt b·ªØa ti·ªác.<br><b>3. T·∫°i sao ch·ªçn AT?</b> D√πng 'at' tr∆∞·ªõc c√°c s·ª± ki·ªán/ho·∫°t ƒë·ªông x√£ h·ªôi (at a party, at a concert, at a meeting).<br><b>4. T·∫°i sao sai?</b> 'In a party' c√≥ th·ªÉ d√πng nh∆∞ng √≠t ph·ªï bi·∫øn h∆°n, 'at' nh·∫•n m·∫°nh s·ª± hi·ªán di·ªán t·∫°i s·ª± ki·ªán."
            },
            {
                id: 25,
                text: "Penguins live _______ the North Pole.",
                options: ["in", "on", "at", "to"],
                answer: 2, // at (L∆∞u √Ω: Th·ª±c t·∫ø Chim c√°nh c·ª•t ·ªü Nam C·ª±c - South Pole, nh∆∞ng v·ªÅ ng·ªØ ph√°p North Pole d√πng 'at')
                explain: "<b>1. Ph√¢n t√≠ch:</b><br>The North Pole (n): B·∫Øc C·ª±c (ƒêi·ªÉm c·ª±c c·ªßa tr√°i ƒë·∫•t).<br><b>2. D·ªãch nghƒ©a:</b> (V√≠ d·ª• ng·ªØ ph√°p) Chim c√°nh c·ª•t s·ªëng ·ªü B·∫Øc C·ª±c.<br><b>3. T·∫°i sao ch·ªçn AT?</b> C√°c ƒëi·ªÉm c·ª±c (North Pole, South Pole) ƒë∆∞·ª£c xem l√† 1 ƒëi·ªÉm tr√™n b·∫£n ƒë·ªì -> D√πng 'at'.<br><b>4. T·∫°i sao sai?</b> D√πng 'in' cho v√πng r·ªông l·ªõn (in the Arctic), nh∆∞ng Pole l√† ƒëi·ªÉm c·ª±c."
            },
            {
                id: 26,
                text: "I kept my money _______ a wallet.",
                options: ["on", "at", "in", "over"],
                answer: 2, // in
                explain: "<b>1. Ph√¢n t√≠ch:</b><br>Wallet (n): C√°i v√≠ (V·∫≠t ch·ª©a).<br><b>2. D·ªãch nghƒ©a:</b> T√¥i gi·ªØ ti·ªÅn trong v√≠.<br><b>3. T·∫°i sao ch·ªçn IN?</b> V√≠ l√† v·∫≠t ch·ª©a, ti·ªÅn n·∫±m b√™n trong -> D√πng 'in'.<br><b>4. T·∫°i sao sai?</b> 'On' l√† ƒë·ªÉ tr√™n m·∫∑t v√≠."
            },
            {
                id: 27,
                text: "There is a label _______ the bottle.",
                options: ["in", "at", "on", "into"],
                answer: 2, // on
                explain: "<b>1. Ph√¢n t√≠ch:</b><br>Bottle (n): C√°i chai. Label (n): Nh√£n d√°n.<br><b>2. D·ªãch nghƒ©a:</b> C√≥ m·ªôt c√°i nh√£n d√°n tr√™n c√°i chai.<br><b>3. T·∫°i sao ch·ªçn ON?</b> Nh√£n d√°n n·∫±m tr√™n b·ªÅ m·∫∑t b√™n ngo√†i c·ªßa c√°i chai -> D√πng 'on'.<br><b>4. T·∫°i sao sai?</b> 'In the bottle' l√† b√™n trong chai (nh∆∞ n∆∞·ªõc)."
            },
            {
                id: 28,
                text: "He is sitting _______ the armchair.",
                options: ["at", "on", "in", "to"],
                answer: 2, // in
                explain: "<b>1. Ph√¢n t√≠ch:</b><br>Armchair (n): Gh·∫ø b√†nh (Gh·∫ø c√≥ tay v·ªãn, √™m √°i, tr≈©ng xu·ªëng).<br><b>2. D·ªãch nghƒ©a:</b> Anh ·∫•y ƒëang ng·ªìi tr√™n gh·∫ø b√†nh.<br><b>3. T·∫°i sao ch·ªçn IN?</b> V·ªõi gh·∫ø b√†nh (armchair) ta ng·ªìi l·ªçt th·ªèm v√†o trong -> D√πng 'in'.<br><b>4. T·∫°i sao sai?</b> V·ªõi gh·∫ø g·ªó c·ª©ng, ph·∫≥ng (chair/bench) ta d√πng 'on'. ƒê√¢y l√† tr∆∞·ªùng h·ª£p ƒë·∫∑c bi·ªát!"
            },
            {
                id: 29,
                text: "We spent our holiday _______ Asia.",
                options: ["at", "on", "in", "of"],
                answer: 2, // in
                explain: "<b>1. Ph√¢n t√≠ch:</b><br>Asia (n): Ch√¢u √Å (Ch√¢u l·ª•c).<br><b>2. D·ªãch nghƒ©a:</b> Ch√∫ng t√¥i ƒë√£ d√†nh k·ª≥ ngh·ªâ ·ªü Ch√¢u √Å.<br><b>3. T·∫°i sao ch·ªçn IN?</b> Tr∆∞·ªõc t√™n ch√¢u l·ª•c (Asia, Europe, Africa) d√πng 'in'.<br><b>4. T·∫°i sao sai?</b> Ch√¢u l·ª•c l√† v√πng l√£nh th·ªï c·ª±c l·ªõn, kh√¥ng d√πng 'at' hay 'on'."
            },
            {
                id: 30,
                text: "My apartment is _______ the top of the building.",
                options: ["in", "on", "at", "above"],
                answer: 2, // at
                explain: "<b>1. Ph√¢n t√≠ch:</b><br>The top (n): ƒê·ªânh, ph·∫ßn cao nh·∫•t.<br><b>2. D·ªãch nghƒ©a:</b> CƒÉn h·ªô c·ªßa t√¥i ·ªü tr√™n ƒë·ªânh t√≤a nh√†.<br><b>3. T·∫°i sao ch·ªçn AT?</b> C·ª•m t·ª´ c·ªë ƒë·ªãnh: 'at the top of', 'at the bottom of'.<br><b>4. T·∫°i sao sai?</b> M·∫∑c d√π ƒë·ªânh t√≤a nh√† cao, nh∆∞ng c·ª•m t·ª´ ch·ªâ v·ªã tr√≠ t∆∞∆°ng ƒë·ªëi n√†y d√πng 'at'."
            }
        ];

        // --- SOUNDS (Web Audio API) ---
        const audioCtx = new (window.AudioContext || window.webkitAudioContext)();

        function playSound(type) {
            if (audioCtx.state === 'suspended') audioCtx.resume();
            const osc = audioCtx.createOscillator();
            const gainNode = audioCtx.createGain();
            osc.connect(gainNode);
            gainNode.connect(audioCtx.destination);

            if (type === 'correct') {
                // Ding sound (High pitch, decays)
                osc.type = 'sine';
                osc.frequency.setValueAtTime(800, audioCtx.currentTime);
                osc.frequency.exponentialRampToValueAtTime(1200, audioCtx.currentTime + 0.1);
                gainNode.gain.setValueAtTime(0.5, audioCtx.currentTime);
                gainNode.gain.exponentialRampToValueAtTime(0.01, audioCtx.currentTime + 0.5);
                osc.start();
                osc.stop(audioCtx.currentTime + 0.5);
            } else {
                // Buzz sound (Sawtooth, low pitch)
                osc.type = 'sawtooth';
                osc.frequency.setValueAtTime(150, audioCtx.currentTime);
                osc.frequency.linearRampToValueAtTime(100, audioCtx.currentTime + 0.3);
                gainNode.gain.setValueAtTime(0.5, audioCtx.currentTime);
                gainNode.gain.exponentialRampToValueAtTime(0.01, audioCtx.currentTime + 0.3);
                osc.start();
                osc.stop(audioCtx.currentTime + 0.3);
            }
        }

        // --- CONFETTI LOGIC ---
        function fireConfetti() {
            const canvas = document.getElementById('confetti-canvas');
            const ctx = canvas.getContext('2d');
            canvas.width = window.innerWidth;
            canvas.height = window.innerHeight;
            
            const particles = [];
            const colors = ['#8854C0', '#00C9A7', '#FF4757', '#FFD700', '#00D26A'];

            for (let i = 0; i < 100; i++) {
                particles.push({
                    x: Math.random() * canvas.width,
                    y: Math.random() * canvas.height - canvas.height,
                    vx: Math.random() * 4 - 2,
                    vy: Math.random() * 4 + 2,
                    color: colors[Math.floor(Math.random() * colors.length)],
                    size: Math.random() * 5 + 5
                });
            }

            function animate() {
                ctx.clearRect(0, 0, canvas.width, canvas.height);
                let active = false;
                particles.forEach(p => {
                    p.x += p.vx;
                    p.y += p.vy;
                    if (p.y < canvas.height) active = true;
                    ctx.fillStyle = p.color;
                    ctx.fillRect(p.x, p.y, p.size, p.size);
                });
                if (active) requestAnimationFrame(animate);
                else ctx.clearRect(0, 0, canvas.width, canvas.height);
            }
            animate();
        }

        // --- QUIZ LOGIC ---
        let currentScore = 0;
        let answeredCount = 0;

        // Shuffle Array
        function shuffle(array) {
            let currentIndex = array.length, randomIndex;
            while (currentIndex != 0) {
                randomIndex = Math.floor(Math.random() * currentIndex);
                currentIndex--;
                [array[currentIndex], array[randomIndex]] = [array[randomIndex], array[currentIndex]];
            }
            return array;
        }

        function renderQuiz() {
            const container = document.getElementById('quiz-container');
            const shuffledQuestions = shuffle([...questions]); // Shuffle questions for freshness

            shuffledQuestions.forEach((q, index) => {
                const card = document.createElement('div');
                card.className = 'quiz-card';
                card.innerHTML = `
                    <span class="question-number">C√¢u ${index + 1}</span>
                    <div class="question-text">${q.text}</div>
                    <div class="options-grid">
                        ${q.options.map((opt, i) => `
                            <button class="option-btn" onclick="checkAnswer(this, ${q.id}, ${i})">${String.fromCharCode(65+i)}. ${opt}</button>
                        `).join('')}
                    </div>
                    <div id="exp-${q.id}" class="explanation">
                        <span class="exp-header">üìù GI·∫¢I TH√çCH CHI TI·∫æT:</span>
                        ${q.explain}
                    </div>
                `;
                container.appendChild(card);
            });
        }

        function checkAnswer(btn, qId, selectedIndex) {
            // Prevent multiple clicks
            const card = btn.closest('.quiz-card');
            if (card.classList.contains('answered')) return;
            card.classList.add('answered');

            const question = questions.find(q => q.id === qId);
            const allBtns = card.querySelectorAll('.option-btn');
            const explanation = document.getElementById(`exp-${qId}`);

            // Logic Correct/Wrong
            if (selectedIndex === question.answer) {
                btn.classList.add('correct');
                playSound('correct');
                fireConfetti();
                currentScore++;
            } else {
                btn.classList.add('wrong');
                playSound('wrong');
                // Highlight correct answer
                allBtns[question.answer].classList.add('correct');
            }

            // Disable all buttons in this card
            allBtns.forEach(b => b.classList.add('disabled'));

            // Show explanation immediately
            explanation.classList.add('visible');
            
            answeredCount++;
        }

        function submitQuiz() {
            const modal = document.getElementById('result-modal');
            const scoreDisplay = document.getElementById('final-score');
            const feedback = document.getElementById('feedback-msg');

            scoreDisplay.textContent = `${currentScore}/30`;

            if (currentScore === 30) {
                feedback.textContent = "Xu·∫•t s·∫Øc! B·∫°n l√† b·∫≠c th·∫ßy gi·ªõi t·ª´! üèÜ";
            } else if (currentScore >= 20) {
                feedback.textContent = "R·∫•t t·ªët! B·∫°n n·∫Øm kh√° ch·∫Øc ki·∫øn th·ª©c r·ªìi! üåü";
            } else {
                feedback.textContent = "C·ªë g·∫Øng th√™m nh√©! H√£y xem l·∫°i ph·∫ßn gi·∫£i th√≠ch chi ti·∫øt. üí™";
            }

            modal.style.display = 'flex';
            fireConfetti();
        }

        function closeModal() {
            document.getElementById('result-modal').style.display = 'none';
        }

        // Init
        window.onload = renderQuiz;

    </script>
</body>
</html>