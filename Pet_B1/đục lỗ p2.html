<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>B√†i Ki·ªÉm Tra: Colouring Books - Ms Mai An ULIS</title>
    <link href="https://fonts.googleapis.com/css2?family=Quicksand:wght@400;600;700&display=swap" rel="stylesheet">
    <style>
        :root {
            /* DYNAMIC THEME: Colouring Books -> Art & Creativity Palette */
            /* M√†u s·∫Øc t∆∞∆°i s√°ng, k√≠ch th√≠ch th·ªã gi√°c cho h·ªçc sinh ti·ªÉu h·ªçc */
            --primary-color: #FF6B6B; /* Pastel Red/Pink */
            --secondary-color: #4ECDC4; /* Teal/Mint */
            --accent-color: #FFE66D; /* Pastel Yellow */
            --text-color: #2F3542;
            --white: #ffffff;
            --success: #00D26A; /* M√†u xanh l√° chu·∫©n y√™u c·∫ßu */
            --error: #FF4757; /* M√†u ƒë·ªè cam chu·∫©n y√™u c·∫ßu */
            --bg-glass: rgba(255, 255, 255, 0.95);
        }

        * {
            box-sizing: border-box;
            margin: 0;
            padding: 0;
            user-select: none; /* NgƒÉn b√¥i ƒëen ƒë·ªÉ t·∫°o c·∫£m gi√°c App */
        }

        body {
            font-family: 'Quicksand', sans-serif;
            color: var(--text-color);
            height: 100vh;
            overflow: hidden; /* ·∫®n thanh cu·ªôn ch√≠nh c·ªßa body */
            /* AUTO-GENERATED BACKGROUND SVG: Emoji üé®, üñçÔ∏è, üåà */
            background-color: #f7f1e3;
            background-image: 
                radial-gradient(circle at 50% 50%, rgba(255, 255, 255, 0.8), transparent),
                url("data:image/svg+xml,%3Csvg width='100%25' height='100%25' xmlns='http://www.w3.org/2000/svg'%3E%3Cdefs%3E%3Cpattern id='p' width='100' height='100' patternUnits='userSpaceOnUse' patternTransform='scale(2)'%3E%3Ctext x='10' y='50' font-size='30'%3Eüé®%3C/text%3E%3Ctext x='60' y='30' font-size='30'%3EüñçÔ∏è%3C/text%3E%3Ctext x='30' y='80' font-size='20'%3Eüåà%3C/text%3E%3C/pattern%3E%3C/defs%3E%3Crect width='100%25' height='100%25' fill='url(%23p)' opacity='0.1'/%3E%3C/svg%3E");
            background-attachment: fixed;
        }

        /* --- HEADER & TIMER --- */
        header {
            height: 60px;
            background: var(--white);
            display: flex;
            align-items: center;
            justify-content: space-between;
            padding: 0 20px;
            box-shadow: 0 4px 15px rgba(0,0,0,0.1);
            z-index: 100;
            position: relative;
        }

        .teacher-brand {
            font-weight: 700;
            font-size: 1.1rem;
            color: var(--primary-color);
            display: flex;
            align-items: center;
            gap: 10px;
        }
        
        .teacher-avatar {
            width: 35px;
            height: 35px;
            background: var(--secondary-color);
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-size: 18px;
        }

        .timer-container {
            position: absolute;
            left: 50%;
            transform: translateX(-50%);
            display: flex;
            flex-direction: column;
            align-items: center;
        }

        .timer-btn {
            background: var(--secondary-color);
            color: white;
            border: none;
            padding: 8px 20px;
            border-radius: 20px;
            font-weight: 700;
            cursor: pointer;
            box-shadow: 0 4px 0 #2a9d8f;
            transition: all 0.2s;
            font-family: 'Quicksand', sans-serif;
        }

        .timer-btn:active {
            transform: translateY(4px);
            box-shadow: none;
        }

        .timer-display {
            font-size: 1.5rem;
            font-weight: 800;
            color: var(--primary-color);
            display: none; /* ·∫®n l√∫c ƒë·∫ßu */
        }

        /* --- SPLIT SCREEN LAYOUT --- */
        .main-container {
            display: flex;
            height: calc(100vh - 60px); /* Tr·ª´ ƒëi header */
        }

        .panel {
            width: 50%;
            padding: 20px;
            overflow-y: auto;
            scroll-behavior: smooth;
        }

        /* --- LEFT PANEL: READING --- */
        .left-panel {
            background: rgba(255, 255, 255, 0.6);
            border-right: 2px dashed rgba(0,0,0,0.1);
        }

        .reading-content {
            background: var(--white);
            padding: 25px;
            border-radius: 15px;
            box-shadow: 0 5px 15px rgba(0,0,0,0.05);
            font-size: 1.1rem;
            line-height: 1.8;
            color: #444;
        }

        .reading-title {
            font-size: 1.8rem;
            color: var(--secondary-color);
            text-align: center;
            margin-bottom: 20px;
            text-transform: uppercase;
            font-weight: 800;
            text-shadow: 2px 2px 0px rgba(78, 205, 196, 0.2);
        }

        .glossary-table {
            width: 100%;
            margin-top: 30px;
            border-collapse: collapse;
            background: white;
            border-radius: 10px;
            overflow: hidden;
            box-shadow: 0 4px 10px rgba(0,0,0,0.05);
        }

        .glossary-table th {
            background: var(--primary-color);
            color: white;
            padding: 12px;
            text-align: left;
        }

        .glossary-table td {
            padding: 10px;
            border-bottom: 1px solid #eee;
            font-size: 0.95rem;
        }

        .translate-btn {
            background: var(--accent-color);
            color: #555;
            border: none;
            width: 100%;
            padding: 10px;
            margin-top: 15px;
            border-radius: 10px;
            font-weight: 700;
            cursor: pointer;
            box-shadow: 0 4px 0 #e6c229;
            transition: 0.2s;
        }
        
        .translate-btn:active {
            transform: translateY(4px);
            box-shadow: none;
        }

        .translation-text {
            display: none;
            margin-top: 15px;
            padding: 15px;
            background: #fff8e1;
            border-radius: 10px;
            border-left: 4px solid var(--accent-color);
            font-style: italic;
        }

        /* --- RIGHT PANEL: EXERCISES --- */
        .right-panel {
            background: transparent;
            padding-bottom: 80px; /* Ch·ª´a ch·ªó cho n√∫t n·ªôp b√†i */
        }

        .question-card {
            background: var(--white);
            border-radius: 20px;
            padding: 20px;
            margin-bottom: 25px;
            box-shadow: 0 8px 0 rgba(0,0,0,0.1);
            border: 2px solid #eee;
            transition: transform 0.3s;
            position: relative;
        }

        .question-number {
            display: inline-block;
            background: var(--secondary-color);
            color: white;
            padding: 5px 15px;
            border-radius: 20px;
            font-weight: 700;
            margin-bottom: 15px;
            font-size: 0.9rem;
        }

        .question-text {
            font-weight: 600;
            margin-bottom: 15px;
            font-size: 1.1rem;
        }

        .options-grid {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 15px;
        }

        .option-btn {
            background: white;
            border: 2px solid #e0e0e0;
            padding: 15px;
            border-radius: 15px;
            cursor: pointer;
            font-family: 'Quicksand', sans-serif;
            font-size: 1rem;
            font-weight: 600;
            color: #555;
            transition: all 0.2s;
            box-shadow: 0 4px 0 #ddd;
            text-align: left;
            position: relative;
        }

        .option-btn:hover {
            transform: scale(1.02);
            border-color: var(--secondary-color);
        }

        .option-btn:active {
            transform: translateY(4px);
            box-shadow: none;
        }

        /* States */
        .option-btn.correct {
            background-color: var(--success);
            color: white;
            border-color: var(--success);
            box-shadow: 0 4px 0 #009e50;
        }

        .option-btn.wrong {
            background-color: var(--error);
            color: white;
            border-color: var(--error);
            box-shadow: 0 4px 0 #d63031;
            animation: shake 0.5s;
        }

        @keyframes shake {
            0% { transform: translateX(0); }
            25% { transform: translateX(-5px) rotate(-5deg); }
            50% { transform: translateX(5px) rotate(5deg); }
            75% { transform: translateX(-5px) rotate(-5deg); }
            100% { transform: translateX(0); }
        }

        /* --- EXPLANATION BOX --- */
        .explanation-box {
            display: none; /* Hi·ªán ra khi ch·ªçn ƒë√°p √°n */
            margin-top: 15px;
            background: #f0fdf4;
            border: 1px solid var(--success);
            border-radius: 15px;
            padding: 15px;
            animation: slideDown 0.3s ease-out;
        }
        
        .explanation-box.show {
            display: block;
        }

        .explanation-header {
            font-weight: 700;
            color: var(--success);
            margin-bottom: 10px;
            display: flex;
            align-items: center;
            gap: 5px;
        }

        .explanation-content h4 {
            color: #333;
            margin: 10px 0 5px 0;
            font-size: 0.95rem;
        }

        .explanation-content ul {
            list-style-type: none;
            padding-left: 10px;
        }
        
        .explanation-content li {
            margin-bottom: 5px;
            font-size: 0.9rem;
        }

        .highlight-text {
            color: var(--primary-color);
            font-weight: bold;
        }

        @keyframes slideDown {
            from { opacity: 0; transform: translateY(-10px); }
            to { opacity: 1; transform: translateY(0); }
        }

        /* --- SUBMIT BUTTON --- */
        .submit-btn-container {
            position: fixed;
            bottom: 20px;
            right: 20px;
            z-index: 100;
        }

        .submit-btn {
            background: var(--primary-color);
            color: white;
            padding: 15px 40px;
            border-radius: 50px;
            border: none;
            font-size: 1.2rem;
            font-weight: 800;
            box-shadow: 0 6px 0 #c0392b;
            cursor: pointer;
            transition: 0.2s;
            font-family: 'Quicksand', sans-serif;
        }

        .submit-btn:hover {
            transform: scale(1.1);
        }

        /* --- MODAL SCOREBOARD --- */
        .modal-overlay {
            display: none;
            position: fixed;
            top: 0; left: 0;
            width: 100%; height: 100%;
            background: rgba(0,0,0,0.7);
            z-index: 1000;
            justify-content: center;
            align-items: center;
            backdrop-filter: blur(5px);
        }

        .modal-content {
            background: white;
            padding: 40px;
            border-radius: 30px;
            text-align: center;
            width: 90%;
            max-width: 500px;
            box-shadow: 0 20px 50px rgba(0,0,0,0.3);
            animation: popIn 0.5s cubic-bezier(0.175, 0.885, 0.32, 1.275);
            border: 5px solid var(--secondary-color);
        }

        @keyframes popIn {
            0% { transform: scale(0); opacity: 0; }
            100% { transform: scale(1); opacity: 1; }
        }

        .score-big {
            font-size: 4rem;
            font-weight: 900;
            color: var(--primary-color);
            margin: 20px 0;
        }

        .score-message {
            font-size: 1.2rem;
            color: #555;
            margin-bottom: 30px;
        }

        .modal-close {
            background: var(--secondary-color);
            color: white;
            padding: 12px 30px;
            border-radius: 30px;
            text-decoration: none;
            font-weight: bold;
            display: inline-block;
            cursor: pointer;
            box-shadow: 0 4px 0 #2a9d8f;
        }

        /* Confetti Canvas */
        #confetti-canvas {
            position: fixed;
            top: 0; left: 0;
            width: 100%; height: 100%;
            pointer-events: none;
            z-index: 999;
        }

    </style>
</head>
<body>

    <canvas id="confetti-canvas"></canvas>

    <header>
        <div class="teacher-brand">
            <div class="teacher-avatar">M</div>
            <span>Ms Mai An ULIS - English Test</span>
        </div>
        <div class="timer-container">
            <button class="timer-btn" id="startBtn" onclick="toggleTimer()">B·∫ÆT ƒê·∫¶U T√çNH GI·ªú L√ÄM B√ÄI</button>
            <div class="timer-display" id="timerDisplay">10:00</div>
        </div>
    </header>

    <div class="main-container">
        
        <div class="panel left-panel">
            <div class="reading-content">
                <div class="reading-title">Colouring Books üé®</div>
                <p>
                    Many people probably used to spend time adding colour to pictures in colouring books when they were children. However, once people get older, very few of them continue with the hobby. Instead, they <b>(1)............</b> their crayons away in the cupboard forever.<br><br>
                    However, psychology researchers now think that even for adults, <b>(2)............</b> as little as ten minutes a day colouring pictures in this way can bring huge <b>(3)............</b>. For example, some people say that it improves their <b>(4)............</b> for a while by making them feel more cheerful and generally calmer.<br><br>
                    One reason for this may be that other activities <b>(5)............</b> with art, such as drawing or painting, can actually be quite stressful, especially if you don‚Äôt feel very successful at it. But adding colour to a picture that‚Äôs already drawn for you <b>(6)............</b> only a low level of skill, so you can relax rather than becoming anxious about it!
                </p>

                <button class="translate-btn" onclick="toggleTranslation(this)">B·∫¢N D·ªäCH ƒê·∫¶Y ƒê·ª¶ (Nh·∫•n ƒë·ªÉ xem)</button>
                <div class="translation-text" id="translationFull">
                    <p><strong>ƒêo·∫°n 1:</strong> C√≥ l·∫Ω nhi·ªÅu ng∆∞·ªùi t·ª´ng d√†nh th·ªùi gian t√¥ m√†u v√†o c√°c b·ª©c tranh trong s√°ch t√¥ m√†u khi c√≤n b√©. Tuy nhi√™n, khi l·ªõn l√™n, r·∫•t √≠t ng∆∞·ªùi ti·∫øp t·ª•c s·ªü th√≠ch n√†y. Thay v√†o ƒë√≥, h·ªç c·∫•t b√∫t m√†u v√†o t·ªß m√£i m√£i.</p>
                    <p><strong>ƒêo·∫°n 2:</strong> Tuy nhi√™n, c√°c nh√† nghi√™n c·ª©u t√¢m l√Ω h·ªçc hi·ªán nay cho r·∫±ng ngay c·∫£ ƒë·ªëi v·ªõi ng∆∞·ªùi l·ªõn, vi·ªác d√†nh √≠t nh·∫•t m∆∞·ªùi ph√∫t m·ªói ng√†y ƒë·ªÉ t√¥ m√†u theo c√°ch n√†y c√≥ th·ªÉ mang l·∫°i nh·ªØng l·ª£i √≠ch to l·ªõn. V√≠ d·ª•, m·ªôt s·ªë ng∆∞·ªùi n√≥i r·∫±ng n√≥ c·∫£i thi·ªán t√¢m tr·∫°ng c·ªßa h·ªç trong m·ªôt th·ªùi gian b·∫±ng c√°ch l√†m cho h·ªç c·∫£m th·∫•y vui v·∫ª h∆°n v√† nh√¨n chung l√† b√¨nh tƒ©nh h∆°n.</p>
                    <p><strong>ƒêo·∫°n 3:</strong> M·ªôt l√Ω do cho ƒëi·ªÅu n√†y c√≥ th·ªÉ l√† c√°c ho·∫°t ƒë·ªông kh√°c li√™n quan ƒë·∫øn ngh·ªá thu·∫≠t, ch·∫≥ng h·∫°n nh∆∞ v·∫Ω ho·∫∑c h·ªôi h·ªça, th·ª±c s·ª± c√≥ th·ªÉ kh√° cƒÉng th·∫≥ng, ƒë·∫∑c bi·ªát n·∫øu b·∫°n c·∫£m th·∫•y kh√¥ng th√†nh c√¥ng l·∫Øm v·ªõi n√≥. Nh∆∞ng vi·ªác t√¥ m√†u v√†o m·ªôt b·ª©c tranh ƒë√£ ƒë∆∞·ª£c v·∫Ω s·∫µn cho b·∫°n ch·ªâ ƒë√≤i h·ªèi m·ªôt tr√¨nh ƒë·ªô k·ªπ nƒÉng th·∫•p, v√¨ v·∫≠y b·∫°n c√≥ th·ªÉ th∆∞ gi√£n thay v√¨ lo l·∫Øng v·ªÅ n√≥!</p>
                </div>

                <h3 style="margin-top: 30px; color: var(--primary-color);">üìö Glossary (T·ª´ v·ª±ng h·ªçc thu·∫≠t)</h3>
                <table class="glossary-table">
                    <thead>
                        <tr>
                            <th>Word (T·ª´)</th>
                            <th>Type (Lo·∫°i)</th>
                            <th>Meaning (Nghƒ©a)</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr><td>Psychology</td><td>(n)</td><td>T√¢m l√Ω h·ªçc</td></tr>
                        <tr><td>Researcher</td><td>(n)</td><td>Nh√† nghi√™n c·ª©u</td></tr>
                        <tr><td>Benefit</td><td>(n)</td><td>L·ª£i √≠ch</td></tr>
                        <tr><td>Cheerful</td><td>(adj)</td><td>Vui v·∫ª, ph·∫•n kh·ªüi</td></tr>
                        <tr><td>Calm</td><td>(adj)</td><td>B√¨nh tƒ©nh, ƒëi·ªÅm ƒë·∫°m</td></tr>
                        <tr><td>Stressful</td><td>(adj)</td><td>G√¢y cƒÉng th·∫≥ng</td></tr>
                        <tr><td>Anxious</td><td>(adj)</td><td>Lo √¢u, b·ªìn ch·ªìn</td></tr>
                        <tr><td>Require</td><td>(v)</td><td>Y√™u c·∫ßu, ƒë√≤i h·ªèi</td></tr>
                        <tr><td>Cupboard</td><td>(n)</td><td>T·ªß (ƒë·ª±ng ƒë·ªì)</td></tr>
                        <tr><td>Connect with</td><td>(v)</td><td>Li√™n quan, k·∫øt n·ªëi v·ªõi</td></tr>
                    </tbody>
                </table>
            </div>
        </div>

        <div class="panel right-panel" id="quizPanel">
            </div>

    </div>

    <div class="submit-btn-container">
        <button class="submit-btn" onclick="submitTest()">N·ªòP B√ÄI üìù</button>
    </div>

    <div class="modal-overlay" id="scoreModal">
        <div class="modal-content">
            <h2>K·∫æT QU·∫¢ C·ª¶A B·∫†N</h2>
            <div class="score-big" id="finalScore">0/6</div>
            <p class="score-message" id="scoreMessage">C·ªë l√™n nh√©!</p>
            <div onclick="closeModal()" class="modal-close">Xem l·∫°i b√†i l√†m</div>
        </div>
    </div>

    <audio id="soundCorrect" src="https://assets.mixkit.co/active_storage/sfx/2000/2000-preview.mp3"></audio>
    <audio id="soundWrong" src="https://assets.mixkit.co/active_storage/sfx/2003/2003-preview.mp3"></audio>
    <audio id="soundFinish" src="https://assets.mixkit.co/active_storage/sfx/1997/1997-preview.mp3"></audio>

    <script>
        // DATA
        const questions = [
            {
                id: 1,
                text: "Question 1: Instead, they (1)............ their crayons away in the cupboard forever.",
                options: [
                    { key: "A", val: "leave" },
                    { key: "B", val: "set" },
                    { key: "C", val: "give" },
                    { key: "D", val: "put" }
                ],
                correct: "D",
                vocab: [
                    "leave (v): ƒë·ªÉ l·∫°i",
                    "set (v): ƒë·∫∑t, thi·∫øt l·∫≠p",
                    "give (v): cho",
                    "put (v): ƒë·∫∑t"
                ],
                explanation: "D·ªãch: 'Thay v√†o ƒë√≥, h·ªç <b>c·∫•t</b> b√∫t m√†u v√†o t·ªß m√£i m√£i.'<br>Ta c·∫ßn c·ª•m ƒë·ªông t·ª´ (Phrasal verb): <b>Put something away</b> = C·∫•t c√°i g√¨ ƒëi (v√†o ƒë√∫ng ch·ªó quy ƒë·ªãnh sau khi d√πng).<br>C√°c t·ª´ c√≤n l·∫°i kh√¥ng ƒëi v·ªõi 'away' ƒë·ªÉ t·∫°o th√†nh nghƒ©a 'c·∫•t ƒëi'."
            },
            {
                id: 2,
                text: "Question 2: ...even for adults, (2)............ as little as ten minutes a day colouring pictures...",
                options: [
                    { key: "A", val: "taking" },
                    { key: "B", val: "completing" },
                    { key: "C", val: "spending" },
                    { key: "D", val: "filling" }
                ],
                correct: "C",
                vocab: [
                    "take (v): c·∫ßm, n·∫Øm (ho·∫∑c m·∫•t th·ªùi gian - it takes...)",
                    "complete (v): ho√†n th√†nh",
                    "spend (v): d√†nh (th·ªùi gian/ti·ªÅn b·∫°c)",
                    "fill (v): l·∫•p ƒë·∫ßy"
                ],
                explanation: "C·∫•u tr√∫c: <b>Spend + time + V-ing</b> (D√†nh th·ªùi gian l√†m g√¨).<br>Trong c√¢u n√†y: 'spending... ten minutes... colouring'.<br>N·∫øu d√πng 'taking' th√¨ c·∫•u tr√∫c th∆∞·ªùng l√† 'It takes sb + time + to V'."
            },
            {
                id: 3,
                text: "Question 3: ...can bring huge (3)............ For example, some people say that it improves their mood...",
                options: [
                    { key: "A", val: "benefits" },
                    { key: "B", val: "interests" },
                    { key: "C", val: "favours" },
                    { key: "D", val: "uses" }
                ],
                correct: "A",
                vocab: [
                    "benefit (n): l·ª£i √≠ch",
                    "interest (n): s·ª± quan t√¢m/l√£i su·∫•t",
                    "favour (n): √¢n hu·ªá/s·ª± ·ªßng h·ªô",
                    "use (n): c√¥ng d·ª•ng"
                ],
                explanation: "D·ªãch: '...mang l·∫°i nh·ªØng <b>l·ª£i √≠ch</b> to l·ªõn.'<br>C√¢u sau gi·∫£i th√≠ch: c·∫£i thi·ªán t√¢m tr·∫°ng, vui v·∫ª h∆°n -> ƒê√¢y l√† nh·ªØng l·ª£i √≠ch t√≠ch c·ª±c.<br>C·ª•m t·ª´ 'bring benefits' r·∫•t ph·ªï bi·∫øn."
            },
            {
                id: 4,
                text: "Question 4: For example, some people say that it improves their (4)............ for a while by making them feel more cheerful...",
                options: [
                    { key: "A", val: "character" },
                    { key: "B", val: "mood" },
                    { key: "C", val: "condition" },
                    { key: "D", val: "mind" }
                ],
                correct: "B",
                vocab: [
                    "character (n): t√≠nh c√°ch",
                    "mood (n): t√¢m tr·∫°ng",
                    "condition (n): ƒëi·ªÅu ki·ªán/t√¨nh tr·∫°ng",
                    "mind (n): t√¢m tr√≠"
                ],
                explanation: "D·ª±a v√†o v·∫ø sau: 'making them feel more cheerful' (l√†m h·ªç th·∫•y vui v·∫ª h∆°n).<br>Vui v·∫ª l√† tr·∫°ng th√°i c·∫£m x√∫c -> li√™n quan ƒë·∫øn <b>mood</b> (t√¢m tr·∫°ng).<br>Character l√† t√≠nh c√°ch (kh√≥ thay ƒë·ªïi nhanh ch√≥ng), condition th∆∞·ªùng n√≥i v·ªÅ s·ª©c kh·ªèe th·ªÉ ch·∫•t ho·∫∑c ƒëi·ªÅu ki·ªán kh√°ch quan."
            },
            {
                id: 5,
                text: "Question 5: One reason for this may be that other activities (5)............ with art, such as drawing or painting...",
                options: [
                    { key: "A", val: "connected" },
                    { key: "B", val: "joined" },
                    { key: "C", val: "compared" },
                    { key: "D", val: "attached" }
                ],
                correct: "A",
                vocab: [
                    "connected (adj): k·∫øt n·ªëi, li√™n quan",
                    "joined (v): tham gia/n·ªëi",
                    "compared (v): so s√°nh",
                    "attached (adj): ƒë√≠nh k√®m/g·∫Øn b√≥"
                ],
                explanation: "C·∫•u tr√∫c/Collocation: <b>Connected with</b> = Li√™n quan ƒë·∫øn.<br>D·ªãch: 'c√°c ho·∫°t ƒë·ªông kh√°c <b>li√™n quan ƒë·∫øn</b> ngh·ªá thu·∫≠t...'<br>'Attached' th∆∞·ªùng ƒëi v·ªõi 'to' (attached to). 'Compared' ƒëi v·ªõi 'to/with' nh∆∞ng nghƒ©a l√† so s√°nh, kh√¥ng h·ª£p ng·ªØ c·∫£nh."
            },
            {
                id: 6,
                text: "Question 6: But adding colour to a picture that‚Äôs already drawn for you (6)............ only a low level of skill...",
                options: [
                    { key: "A", val: "depends" },
                    { key: "B", val: "calls" },
                    { key: "C", val: "lacks" },
                    { key: "D", val: "requires" }
                ],
                correct: "D",
                vocab: [
                    "depend (v): ph·ª• thu·ªôc (ƒëi v·ªõi on)",
                    "call (v): g·ªçi",
                    "lack (v): thi·∫øu",
                    "require (v): y√™u c·∫ßu, ƒë√≤i h·ªèi"
                ],
                explanation: "D·ªãch: 'Vi·ªác t√¥ m√†u... ch·ªâ <b>ƒë√≤i h·ªèi</b> tr√¨nh ƒë·ªô k·ªπ nƒÉng th·∫•p.'<br>Ch·ªß ng·ªØ l√† h√†nh ƒë·ªông 'adding colour' (s·ªë √≠t) -> ƒë·ªông t·ª´ chia s·ªë √≠t.<br>'Requires a level of skill' l√† c·ª•m t·ª´ h·ª£p nghƒ©a nh·∫•t. 'Depends' thi·∫øu 'on'. 'Lacks' nghƒ©a l√† thi·∫øu k·ªπ nƒÉng (ng∆∞·ª£c nghƒ©a, v√¨ √Ω n√≥i ho·∫°t ƒë·ªông n√†y C·∫¶N √≠t k·ªπ nƒÉng)."
            }
        ];

        let score = 0;
        let timerInterval;
        let timeLeft = 600; // 10 minutes
        let isTimerRunning = false;
        let answeredQuestions = new Set();

        // INIT
        window.onload = function() {
            renderQuestions();
        }

        // TIMER LOGIC
        function toggleTimer() {
            const btn = document.getElementById('startBtn');
            const display = document.getElementById('timerDisplay');
            
            if (!isTimerRunning) {
                // Start
                btn.textContent = "T·∫†M D·ª™NG";
                btn.style.background = "#FF4757"; // Red to stop
                display.style.display = "block";
                isTimerRunning = true;
                timerInterval = setInterval(updateTimer, 1000);
            } else {
                // Pause
                clearInterval(timerInterval);
                btn.textContent = "TI·∫æP T·ª§C";
                btn.style.background = "#4ECDC4"; // Back to teal
                isTimerRunning = false;
            }
        }

        function updateTimer() {
            if (timeLeft <= 0) {
                clearInterval(timerInterval);
                alert("ƒê√£ h·∫øt gi·ªù l√†m b√†i. B·∫°n v·∫´n c√≥ th·ªÉ ti·∫øp t·ª•c l√†m, nh∆∞ng nh·ªõ l√† trong ph√≤ng thi th·∫≠t, b·∫°n ch·ªâ n√™n l√†m m·ªôt b√†i nh∆∞ th·∫ø n√†y trong 10 ph√∫t th√¥i nha.");
                return;
            }
            timeLeft--;
            const m = Math.floor(timeLeft / 60).toString().padStart(2, '0');
            const s = (timeLeft % 60).toString().padStart(2, '0');
            document.getElementById('timerDisplay').textContent = `${m}:${s}`;
        }

        function toggleTranslation(btn) {
            const div = document.getElementById('translationFull');
            if (div.style.display === "block") {
                div.style.display = "none";
                btn.textContent = "B·∫¢N D·ªäCH ƒê·∫¶Y ƒê·ª¶ (Nh·∫•n ƒë·ªÉ xem)";
            } else {
                div.style.display = "block";
                btn.textContent = "·∫®N B·∫¢N D·ªäCH";
            }
        }

        // RENDER QUESTIONS
        function renderQuestions() {
            const container = document.getElementById('quizPanel');
            questions.forEach(q => {
                const card = document.createElement('div');
                card.className = 'question-card';
                card.id = `q-card-${q.id}`;
                
                let html = `
                    <div class="question-number">Question ${q.id}</div>
                    <div class="question-text">${q.text}</div>
                    <div class="options-grid">
                `;
                
                q.options.forEach(opt => {
                    html += `<button class="option-btn" onclick="checkAnswer(${q.id}, '${opt.key}', this)">${opt.key}. ${opt.val}</button>`;
                });

                html += `</div>
                    <div class="explanation-box" id="explain-${q.id}">
                        <div class="explanation-header">
                            <span>‚úÖ CH√çNH X√ÅC!</span>
                        </div>
                        <div class="explanation-content">
                            <h4>üîç Ph√¢n t√≠ch t·ª´ v·ª±ng:</h4>
                            <ul>
                                ${q.vocab.map(v => `<li>‚Ä¢ ${v}</li>`).join('')}
                            </ul>
                            <h4>üí° Gi·∫£i th√≠ch chi ti·∫øt Ms Mai An:</h4>
                            <p>${q.explanation}</p>
                        </div>
                    </div>
                `;
                
                card.innerHTML = html;
                container.appendChild(card);
            });
        }

        // CHECK ANSWER
        function checkAnswer(qId, selectedKey, btnElement) {
            // Prevent multiple clicks if already correct
            if (answeredQuestions.has(qId)) return;

            const qData = questions.find(q => q.id === qId);
            const parentCard = document.getElementById(`q-card-${qId}`);
            const allBtns = parentCard.querySelectorAll('.option-btn');
            const explainBox = document.getElementById(`explain-${qId}`);

            if (selectedKey === qData.correct) {
                // CORRECT
                btnElement.classList.add('correct');
                explainBox.classList.add('show');
                document.getElementById('soundCorrect').play();
                fireConfetti(btnElement); // Effect
                answeredQuestions.add(qId);
                score++;
                
                // Disable other buttons
                allBtns.forEach(btn => btn.disabled = true);
            } else {
                // WRONG
                btnElement.classList.add('wrong');
                document.getElementById('soundWrong').play();
                // Remove wrong class after animation to allow re-click
                setTimeout(() => {
                    btnElement.classList.remove('wrong');
                }, 500);
            }
        }

        // SUBMIT
        function submitTest() {
            document.getElementById('soundFinish').play();
            const modal = document.getElementById('scoreModal');
            const scoreText = document.getElementById('finalScore');
            const msg = document.getElementById('scoreMessage');

            scoreText.textContent = `${score}/${questions.length}`;
            
            if (score === questions.length) {
                msg.textContent = "üåü THI√äN T√ÄI! B·∫°n ƒë√£ l√†m ƒë√∫ng tuy·ªát ƒë·ªëi!";
                fireGlobalConfetti();
            } else if (score >= 4) {
                msg.textContent = "üëç L√ÄM T·ªêT L·∫ÆM! Ch·ªâ c√≤n sai m·ªôt ch√∫t x√≠u th√¥i.";
            } else {
                msg.textContent = "üí™ C·ªê L√äN NH√â! H√£y xem l·∫°i ph·∫ßn gi·∫£i th√≠ch ƒë·ªÉ hi·ªÉu b√†i h∆°n.";
            }

            modal.style.display = "flex";
        }

        function closeModal() {
            document.getElementById('scoreModal').style.display = "none";
        }

        // --- CONFETTI EFFECT (Simple JS Implementation) ---
        function fireConfetti(element) {
            const rect = element.getBoundingClientRect();
            const x = rect.left + rect.width / 2;
            const y = rect.top;
            
            for (let i = 0; i < 30; i++) {
                createParticle(x, y);
            }
        }

        function fireGlobalConfetti() {
            const x = window.innerWidth / 2;
            const y = window.innerHeight / 2;
            for (let i = 0; i < 100; i++) {
                createParticle(x, y);
            }
        }

        function createParticle(x, y) {
            const canvas = document.getElementById('confetti-canvas');
            // Since we are using a canvas overlay, we can't easily draw individual divs without complex logic.
            // Let's use a simpler approach: create small divs appended to body
            const colors = ['#FF6B6B', '#4ECDC4', '#FFE66D', '#FF9FF3'];
            const part = document.createElement('div');
            part.style.position = 'fixed';
            part.style.width = '10px';
            part.style.height = '10px';
            part.style.backgroundColor = colors[Math.floor(Math.random() * colors.length)];
            part.style.left = x + 'px';
            part.style.top = y + 'px';
            part.style.zIndex = 9999;
            part.style.borderRadius = '50%';
            part.style.pointerEvents = 'none';
            document.body.appendChild(part);

            const destinationX = (Math.random() - 0.5) * 300;
            const destinationY = (Math.random() - 1) * 300;
            const rotation = Math.random() * 520;

            const animation = part.animate([
                { transform: `translate(0, 0) rotate(0deg)`, opacity: 1 },
                { transform: `translate(${destinationX}px, ${destinationY}px) rotate(${rotation}deg)`, opacity: 0 }
            ], {
                duration: 1000 + Math.random() * 1000,
                easing: 'cubic-bezier(0, .9, .57, 1)',
                fill: 'forwards'
            });

            animation.onfinish = () => part.remove();
        }
    </script>
</body>
</html>