<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Test Unit 8-9 (Stress & Pronunciation) - Ms Mai An ULIS</title>
    <link href="https://fonts.googleapis.com/css2?family=Nunito:wght@400;600;700;800&family=Quicksand:wght@500;700&display=swap" rel="stylesheet">
    <style>
        :root {
            --primary: #8854C0; /* T√≠m h·ªìng */
            --secondary: #00C9A7; /* Xanh ng·ªçc */
            --correct: #00D26A; /* Xanh l√° */
            --wrong: #FF4757; /* ƒê·ªè cam */
            --bg-pattern: #f8f9fd;
            --card-bg: #ffffff;
            --text-main: #2f3542;
        }

        body {
            font-family: 'Nunito', sans-serif;
            background-color: var(--bg-pattern);
            background-image: 
                radial-gradient(#a29bfe 0.5px, transparent 0.5px),
                radial-gradient(#a29bfe 0.5px, transparent 0.5px);
            background-size: 20px 20px;
            background-position: 0 0, 10px 10px;
            color: var(--text-main);
            margin: 0;
            padding: 20px;
            display: flex;
            justify-content: center;
            min-height: 100vh;
        }

        .container {
            width: 100%;
            max-width: 800px;
        }

        /* HEADER */
        .header {
            text-align: center;
            margin-bottom: 30px;
            background: white;
            padding: 25px;
            border-radius: 25px;
            box-shadow: 0 10px 0 rgba(136, 84, 192, 0.1);
            border: 3px solid #e1e1e1;
            position: relative;
            overflow: hidden;
        }
        
        .header::before {
            content: '';
            position: absolute;
            top: 0; left: 0; width: 100%; height: 8px;
            background: linear-gradient(90deg, var(--primary), var(--secondary));
        }

        .header h1 {
            color: var(--primary);
            font-family: 'Quicksand', sans-serif;
            font-weight: 800;
            margin: 0;
            font-size: 1.8rem;
            text-transform: uppercase;
            letter-spacing: 1px;
        }

        .header p {
            color: #747d8c;
            font-weight: 700;
            margin: 8px 0 0;
        }

        /* QUESTION CARD */
        .question-card {
            background: var(--card-bg);
            border-radius: 25px;
            padding: 30px;
            margin-bottom: 30px;
            box-shadow: 0 15px 30px rgba(136, 84, 192, 0.08);
            border: 2px solid #fff;
            position: relative;
            transition: transform 0.3s ease;
        }

        .question-title {
            font-weight: 800;
            color: var(--primary);
            font-size: 1.1rem;
            margin-bottom: 15px;
            display: flex;
            align-items: center;
            gap: 12px;
        }

        .question-badge {
            background: var(--primary);
            color: white;
            padding: 6px 15px;
            border-radius: 50px;
            font-size: 0.85rem;
            box-shadow: 0 4px 0 rgba(0,0,0,0.1);
        }

        .question-text {
            font-size: 1.3rem;
            font-weight: 700;
            margin-bottom: 25px;
            color: #2f3542;
            line-height: 1.4;
        }

        .question-text u {
            text-decoration: none;
            border-bottom: 4px solid var(--primary);
            padding-bottom: 1px;
            transition: border-color 0.3s;
        }

        /* OPTIONS GRID */
        .options-grid {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 15px;
        }

        @media (max-width: 600px) {
            .options-grid {
                grid-template-columns: 1fr;
            }
        }

        .option-btn {
            background: white;
            border: 2px solid #eee;
            border-radius: 18px;
            padding: 18px 25px;
            font-family: 'Nunito', sans-serif;
            font-size: 1.05rem;
            font-weight: 700;
            color: #57606f;
            cursor: pointer;
            transition: all 0.15s cubic-bezier(0.175, 0.885, 0.32, 1.275);
            box-shadow: 0 5px 0 #eee;
            text-align: left;
            position: relative;
        }

        .option-btn:hover:not(:disabled) {
            transform: translateY(-3px);
            border-color: var(--primary);
            color: var(--primary);
            box-shadow: 0 8px 0 #dcdde1;
        }

        .option-btn:active:not(:disabled) {
            transform: translateY(2px);
            box-shadow: 0 0 0 #eee;
        }

        .option-btn.correct {
            background: var(--correct);
            border-color: var(--correct);
            box-shadow: 0 5px 0 #00b85c;
            color: white;
            animation: pop 0.4s;
        }

        .option-btn.wrong {
            background: var(--wrong);
            border-color: var(--wrong);
            box-shadow: 0 5px 0 #d63031;
            color: white;
            animation: shake 0.5s;
        }

        .option-btn:disabled {
            cursor: default;
            opacity: 1;
        }

        /* EXPLANATION BOX */
        .explanation-box {
            display: none;
            margin-top: 25px;
            background: #f0fff4;
            border: 2px solid var(--correct);
            border-radius: 20px;
            padding: 25px;
            animation: slideDown 0.4s ease-out;
            position: relative;
        }
        
        .explanation-box::before {
            content: '';
            position: absolute;
            top: -10px;
            left: 40px;
            width: 20px;
            height: 20px;
            background: inherit;
            border-left: 2px solid var(--correct);
            border-top: 2px solid var(--correct);
            transform: rotate(45deg);
        }
        
        .explanation-box.wrong-state {
            background: #fff0f1;
            border-color: var(--wrong);
        }
        
        .explanation-box.wrong-state::before {
            border-color: var(--wrong);
        }

        .exp-header {
            font-weight: 800;
            margin-bottom: 15px;
            display: flex;
            align-items: center;
            gap: 12px;
            border-bottom: 2px dashed rgba(0,0,0,0.1);
            padding-bottom: 10px;
        }

        .exp-teacher-avatar {
            width: 45px;
            height: 45px;
            background: var(--primary);
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-weight: bold;
            font-size: 0.9rem;
            box-shadow: 0 3px 0 rgba(0,0,0,0.2);
        }

        .exp-content p {
            margin: 8px 0;
            line-height: 1.6;
            font-size: 1rem;
        }

        .exp-label {
            font-weight: 800;
            font-family: 'Quicksand', sans-serif;
            text-transform: uppercase;
            font-size: 0.85rem;
            letter-spacing: 0.5px;
            margin-top: 15px;
            display: block;
        }

        .vocab-table {
            width: 100%;
            border-collapse: separate;
            border-spacing: 0;
            margin-top: 10px;
            font-size: 0.95rem;
            background: white;
            border-radius: 12px;
            overflow: hidden;
            border: 1px solid #eee;
        }
        
        .vocab-table th {
            background-color: var(--primary);
            color: white;
            padding: 10px 15px;
            text-align: left;
            font-weight: 700;
        }
        
        .vocab-table td {
            padding: 10px 15px;
            border-bottom: 1px solid #f1f2f6;
            color: #2f3542;
        }
        
        .vocab-table tr:last-child td {
            border-bottom: none;
        }

        /* SUBMIT BUTTON */
        .submit-section {
            text-align: center;
            margin-top: 50px;
            margin-bottom: 80px;
        }

        .submit-btn {
            background: var(--secondary);
            color: white;
            border: none;
            padding: 18px 60px;
            font-size: 1.3rem;
            font-weight: 800;
            border-radius: 60px;
            box-shadow: 0 8px 0 #009e82;
            cursor: pointer;
            transition: all 0.2s;
            font-family: 'Quicksand', sans-serif;
            text-transform: uppercase;
            letter-spacing: 1px;
        }

        .submit-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 10px 0 #009e82;
        }

        .submit-btn:active {
            transform: translateY(4px);
            box-shadow: 0 2px 0 #009e82;
        }

        /* ANIMATIONS */
        @keyframes shake {
            0%, 100% { transform: translateX(0); }
            10%, 30%, 50%, 70%, 90% { transform: translateX(-8px); }
            20%, 40%, 60%, 80% { transform: translateX(8px); }
        }

        @keyframes pop {
            0% { transform: scale(0.9); }
            50% { transform: scale(1.1); }
            100% { transform: scale(1); }
        }

        @keyframes slideDown {
            from { opacity: 0; transform: translateY(-15px); }
            to { opacity: 1; transform: translateY(0); }
        }

        /* Confetti */
        #confetti-canvas {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            pointer-events: none;
            z-index: 999;
        }

        /* Popup Score */
        .modal {
            display: none;
            position: fixed;
            z-index: 1000;
            left: 0;
            top: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(47, 53, 66, 0.8);
            backdrop-filter: blur(5px);
            align-items: center;
            justify-content: center;
        }
        .modal-content {
            background-color: white;
            padding: 40px;
            border-radius: 30px;
            text-align: center;
            width: 90%;
            max-width: 450px;
            box-shadow: 0 20px 50px rgba(0,0,0,0.3);
            animation: pop 0.5s cubic-bezier(0.175, 0.885, 0.32, 1.275);
            position: relative;
        }
        .score-display {
            font-size: 3.5rem;
            font-weight: 800;
            color: var(--secondary);
            margin: 15px 0;
            text-shadow: 2px 2px 0 #d1f2eb;
        }
    </style>
</head>
<body>

    <canvas id="confetti-canvas"></canvas>

    <div class="container">
        <div class="header">
            <h1>Advanced English 9 Test</h1>
            <p>üåü Pronunciation & Stress Challenge üåü</p>
            <p style="font-size: 0.95rem; margin-top: 10px; color: var(--primary);">Gi√°o vi√™n: Ms Mai An ULIS</p>
        </div>

        <div id="quiz-container">
            </div>

        <div class="submit-section">
            <button class="submit-btn" onclick="submitQuiz()">N·ªôp B√†i & Xem ƒêi·ªÉm</button>
        </div>
    </div>

    <div id="scoreModal" class="modal">
        <div class="modal-content">
            <h2 style="color: var(--primary); font-family: 'Quicksand', sans-serif;">K·∫æT QU·∫¢ C·ª¶A EM</h2>
            <div class="score-display" id="finalScore">0/20</div>
            <p id="feedbackText" style="font-size: 1.2rem; font-weight: 700; color: #57606f;">...</p>
            <button class="submit-btn" style="margin-top: 25px; font-size: 1rem; padding: 15px 40px;" onclick="closeModal()">L√†m l·∫°i b√†i n√†y</button>
        </div>
    </div>

    <script>
        // === D·ªÆ LI·ªÜU ƒê·ªÄ B√ÄI (MS MAI AN ƒê√É SO·∫†N TH·∫¢O CHI TI·∫æT) ===
        const quizData = [
            // Exercise 1: Pronunciation
            {
                id: 1, type: "Pronunciation",
                question: "Choose the word whose underlined part is pronounced differently.",
                word: "1. A. b<u>i</u>lingual B. cons<u>i</u>st C. off<u>i</u>cial D. <u>i</u>mmigrant",
                options: ["A", "B", "C", "D"], correct: 0, // A
                explanation: {
                    meaning: { A: "Song ng·ªØ", B: "Bao g·ªìm", C: "Ch√≠nh th·ª©c", D: "Ng∆∞·ªùi nh·∫≠p c∆∞" },
                    whyCorrect: "A. bilingual /ba…™Ààl…™≈ã…°w…ôl/ -> √Çm /a…™/.",
                    whyWrong: "B, C, D ƒë·ªÅu ph√°t √¢m l√† /…™/ (√¢m i ng·∫Øn): consist /k…ônÀàs…™st/, official /…ôÀàf…™ Él/, immigrant /Àà…™m…™…°r…ônt/."
                }
            },
            {
                id: 2, type: "Pronunciation",
                question: "Choose the word whose underlined part is pronounced differently.",
                word: "2. A. c<u>o</u>ncentric B. v<u>o</u>cabulary C. prop<u>o</u>se D. c<u>o</u>py",
                options: ["A", "B", "C", "D"], correct: 2, // C
                explanation: {
                    meaning: { A: "ƒê·ªìng t√¢m", B: "T·ª´ v·ª±ng", C: "ƒê·ªÅ xu·∫•t", D: "Sao ch√©p" },
                    whyCorrect: "C. propose /pr…ôÀàp…ô äz/ -> √Çm /…ô ä/ (nguy√™n √¢m ƒë√¥i).",
                    whyWrong: "A, B, D ƒë·ªÅu ph√°t √¢m l√† /…í/ (√¢m o ng·∫Øn) ho·∫∑c /…ô/ t√πy v·ªã tr√≠, nh∆∞ng 'propose' kh√°c bi·ªát r√µ nh·∫•t v·ªõi √¢m /…ô ä/."
                }
            },
            {
                id: 3, type: "Pronunciation",
                question: "Choose the word whose underlined part is pronounced differently.",
                word: "3. A. st<u>a</u>ndard B. tr<u>a</u>nslate C. exch<u>a</u>nge D. exp<u>a</u>nd",
                options: ["A", "B", "C", "D"], correct: 2, // C
                explanation: {
                    meaning: { A: "Ti√™u chu·∫©n", B: "D·ªãch", C: "Trao ƒë·ªïi", D: "M·ªü r·ªông" },
                    whyCorrect: "C. exchange /…™ksÀàt Ée…™nd í/ -> √Çm /e…™/.",
                    whyWrong: "A, B, D ƒë·ªÅu l√† √¢m /√¶/ ho·∫∑c /…ëÀê/ (Standard /Ààst√¶nd…ôd/, Translate /tr√¶nzÀàle…™t/, Expand /…™kÀàsp√¶nd/)."
                }
            },
            {
                id: 4, type: "Pronunciation",
                question: "Choose the word whose underlined part is pronounced differently.",
                word: "4. A. v<u>a</u>riety B. l<u>a</u>nguage C. immigr<u>a</u>nt D. st<u>a</u>ndard",
                options: ["A", "B", "C", "D"], correct: 1, // B
                explanation: {
                    meaning: { A: "S·ª± ƒëa d·∫°ng", B: "Ng√¥n ng·ªØ", C: "Ng∆∞·ªùi nh·∫≠p c∆∞", D: "Ti√™u chu·∫©n" },
                    whyCorrect: "B. language /Ààl√¶≈ã…°w…™d í/ -> √Çm /√¶/ (√¢m a b·∫πt).",
                    whyWrong: "A. variety /v…ôÀàra…™…ôti/ (√¢m /…ô/). C. immigrant /Àà…™m…™…°r…ônt/ (√¢m /…ô/). D. standard /Ààst√¶nd…ôd/ (√¢m cu·ªëi l√† /…ô/). (B√†i n√†y ki·ªÉm tra s·ª± kh√°c bi·ªát gi·ªØa √¢m m·∫°nh /√¶/ v√† √¢m y·∫øu /…ô/)."
                }
            },
            {
                id: 5, type: "Pronunciation",
                question: "Choose the word whose underlined part is pronounced differently.",
                word: "5. A. m<u>o</u>del B. b<u>o</u>rrow C. w<u>o</u>rd D. c<u>o</u>nfident",
                options: ["A", "B", "C", "D"], correct: 2, // C
                explanation: {
                    meaning: { A: "M√¥ h√¨nh", B: "M∆∞·ª£n", C: "T·ª´ ng·ªØ", D: "T·ª± tin" },
                    whyCorrect: "C. word /w…úÀêd/ -> √Çm /…úÀê/ (√¢m ∆° d√†i).",
                    whyWrong: "A, B, D ƒë·ªÅu ph√°t √¢m l√† /…í/ (√¢m o ng·∫Øn): model /Ààm…ídl/, borrow /Ààb…ír…ô ä/, confident /Ààk…ínf…™d…ônt/."
                }
            },
            {
                id: 6, type: "Pronunciation",
                question: "Choose the word whose underlined part is pronounced differently.",
                word: "6. A. <u>u</u>nited B. <u>u</u>nion C. <u>u</u>nimportant D. <u>u</u>sually",
                options: ["A", "B", "C", "D"], correct: 2, // C
                explanation: {
                    meaning: { A: "ƒêo√†n k·∫øt", B: "Hi·ªáp h·ªôi/Li√™n minh", C: "Kh√¥ng quan tr·ªçng", D: "Th∆∞·ªùng xuy√™n" },
                    whyCorrect: "C. unimportant /Àå ån…™mÀàp…îÀêtnt/ -> √Çm / å/ (√¢m √°).",
                    whyWrong: "A, B, D ƒë·ªÅu b·∫Øt ƒë·∫ßu b·∫±ng √¢m /juÀê/: united /juÀàna…™t…™d/, union /ÀàjuÀêni…ôn/, usually /ÀàjuÀê íu…ôli/."
                }
            },
            {
                id: 7, type: "Pronunciation",
                question: "Choose the word whose underlined part is pronounced differently.",
                word: "7. A. <u>y</u>outh B. be<u>y</u>ond C. <u>y</u>oyo D. fl<u>y</u>er",
                options: ["A", "B", "C", "D"], correct: 3, // D
                explanation: {
                    meaning: { A: "Tu·ªïi tr·∫ª", B: "V∆∞·ª£t ra ngo√†i", C: "ƒê·ªì ch∆°i Yoyo", D: "T·ªù r∆°i" },
                    whyCorrect: "D. flyer /Ààfla…™…ô(r)/ -> Ch·ªØ 'y' l√† m·ªôt ph·∫ßn c·ªßa nguy√™n √¢m ƒë√¥i /a…™/.",
                    whyWrong: "A, B, C ch·ªØ 'y' ƒë√≥ng vai tr√≤ l√† ph·ª• √¢m /j/: youth /juÀêŒ∏/, beyond /b…™Ààj…índ/, yoyo /Ààj…ô äj…ô ä/."
                }
            },
            {
                id: 8, type: "Pronunciation",
                question: "Choose the word whose underlined part is pronounced differently.",
                word: "8. A. l<u>a</u>nguage B. exch<u>a</u>nge C. voc<u>a</u>bulary D. M<u>a</u>ndarin",
                options: ["A", "B", "C", "D"], correct: 1, // B
                explanation: {
                    meaning: { A: "Ng√¥n ng·ªØ", B: "Trao ƒë·ªïi", C: "T·ª´ v·ª±ng", D: "Ti·∫øng Quan Tho·∫°i" },
                    whyCorrect: "B. exchange /…™ksÀàt Ée…™nd í/ -> √Çm /e…™/.",
                    whyWrong: "A, C, D ƒë·ªÅu l√† √¢m /√¶/: language /Ààl√¶≈ã.../, vocabulary /v…ôÀàk√¶bj…ôl…ôri/ (√¢m a th·ª© 2), Mandarin /Ààm√¶nd…ôr…™n/."
                }
            },
            {
                id: 9, type: "Pronunciation",
                question: "Choose the word whose underlined part is pronounced differently.",
                word: "9. A. s<u>w</u>imming B. <u>w</u>onder C. cro<u>w</u>n D. <u>w</u>aterfall",
                options: ["A", "B", "C", "D"], correct: 2, // C
                explanation: {
                    meaning: { A: "B∆°i l·ªôi", B: "K·ª≥ quan/T·ª± h·ªèi", C: "V∆∞∆°ng mi·ªán", D: "Th√°c n∆∞·ªõc" },
                    whyCorrect: "C. crown /kra än/ -> Ch·ªØ 'w' l√† √¢m c√¢m ho·∫∑c l√† m·ªôt ph·∫ßn c·ªßa nguy√™n √¢m /a ä/, kh√¥ng ph√°t √¢m l√† /w/.",
                    whyWrong: "A, B, D ch·ªØ 'w' ph√°t √¢m r√µ l√† ph·ª• √¢m /w/."
                }
            },
            {
                id: 10, type: "Pronunciation",
                question: "Choose the word whose underlined part is pronounced differently.",
                word: "10. A. int<u>e</u>ntion B. r<u>e</u>vision C. d<u>e</u>cision D. <u>e</u>xpress",
                options: ["A", "B", "C", "D"], correct: 0, // A
                explanation: {
                    meaning: { A: "√ù ƒë·ªãnh", B: "√în t·∫≠p", C: "Quy·∫øt ƒë·ªãnh", D: "B√†y t·ªè" },
                    whyCorrect: "A. intention /…™nÀàten Én/ -> √Çm /e/.",
                    whyWrong: "B, C, D ch·ªØ 'e' ƒë∆∞·ª£c ph√°t √¢m l√† /…™/: revision /r…™Ààv…™ ín/, decision /d…™Ààs…™ ín/, express /…™kÀàspres/."
                }
            },

            // Exercise 2: Stress
            {
                id: 11, type: "Stress",
                question: "Mark the letter A, B, C, or D to indicate the word that differs from the other three in the position of primary stress.",
                word: "1. A. relation B. bilingual C. concentric D. annual",
                options: ["A", "B", "C", "D"], correct: 3, // D
                explanation: {
                    meaning: { A: "M·ªëi quan h·ªá", B: "Song ng·ªØ", C: "ƒê·ªìng t√¢m", D: "H√†ng nƒÉm" },
                    whyCorrect: "D. annual nh·∫•n √¢m 1 ('annual).",
                    whyWrong: "A, B, C nh·∫•n √¢m 2: re'lation, bi'lingual, con'centric (quy t·∫Øc: ƒëu√¥i -tion, -ic nh·∫•n √¢m tr∆∞·ªõc n√≥)."
                }
            },
            {
                id: 12, type: "Stress",
                question: "Primary Stress",
                word: "2. A. official B. immigrant C. clarity D. ornament",
                options: ["A", "B", "C", "D"], correct: 0, // A
                explanation: {
                    meaning: { A: "Ch√≠nh th·ª©c", B: "Ng∆∞·ªùi nh·∫≠p c∆∞", C: "S·ª± r√µ r√†ng", D: "ƒê·ªì trang tr√≠" },
                    whyCorrect: "A. official nh·∫•n √¢m 2 (of'ficial) - ƒëu√¥i -ial nh·∫•n √¢m tr∆∞·ªõc n√≥.",
                    whyWrong: "B, C, D nh·∫•n √¢m 1: 'immigrant, 'clarity, 'ornament."
                }
            },
            {
                id: 13, type: "Stress",
                question: "Primary Stress",
                word: "3. A. purposeful B. proposal C. charity D. borrowed",
                options: ["A", "B", "C", "D"], correct: 1, // B
                explanation: {
                    meaning: { A: "C√≥ m·ª•c ƒë√≠ch", B: "ƒê·ªÅ xu·∫•t", C: "T·ª´ thi·ªán", D: "ƒê√£ m∆∞·ª£n" },
                    whyCorrect: "B. proposal nh·∫•n √¢m 2 (pro'posal).",
                    whyWrong: "A, C, D nh·∫•n √¢m 1: 'purposeful, 'charity, 'borrowed."
                }
            },
            {
                id: 14, type: "Stress",
                question: "Primary Stress",
                word: "4. A. celebration B. destination C. ecosystem D. confidential",
                options: ["A", "B", "C", "D"], correct: 2, // C
                explanation: {
                    meaning: { A: "L·ªÖ k·ª∑ ni·ªám", B: "ƒêi·ªÉm ƒë·∫øn", C: "H·ªá sinh th√°i", D: "B·∫£o m·∫≠t" },
                    whyCorrect: "C. ecosystem nh·∫•n √¢m 1 ('ecosystem).",
                    whyWrong: "A, B, D nh·∫•n √¢m 3: cele'bration, desti'nation, confi'dential."
                }
            },
            {
                id: 15, type: "Stress",
                question: "Primary Stress",
                word: "5. A. decision B. self-guided C. permission D. annual",
                options: ["A", "B", "C", "D"], correct: 3, // D
                explanation: {
                    meaning: { A: "Quy·∫øt ƒë·ªãnh", B: "T·ª± h∆∞·ªõng d·∫´n", C: "S·ª± cho ph√©p", D: "H√†ng nƒÉm" },
                    whyCorrect: "D. annual nh·∫•n √¢m 1 ('annual).",
                    whyWrong: "A, B, C nh·∫•n √¢m 2: de'cision, self-'guided, per'mission."
                }
            },
            {
                id: 16, type: "Stress",
                question: "Primary Stress",
                word: "6. A. concentration B. participation C. documentation D. insensitivity",
                options: ["A", "B", "C", "D"], correct: 0, // A
                explanation: {
                    meaning: { A: "S·ª± t·∫≠p trung", B: "S·ª± tham gia", C: "T√†i li·ªáu", D: "S·ª± v√¥ c·∫£m" },
                    whyCorrect: "A. concentration nh·∫•n √¢m 3 (con-cen-'tra-tion).",
                    whyWrong: "B, C, D nh·∫•n √¢m 4: par-ti-ci-'pa-tion, doc-u-men-'ta-tion, in-sen-si-'tiv-ity."
                }
            },
            {
                id: 17, type: "Stress",
                question: "Primary Stress",
                word: "7. A. accommodation B. demonstration C. justification D. impossibility",
                options: ["A", "B", "C", "D"], correct: 1, // B
                explanation: {
                    meaning: { A: "Ch·ªó ·ªü", B: "S·ª± ch·ª©ng minh", C: "S·ª± bi·ªán h·ªô", D: "S·ª± b·∫•t kh·∫£ thi" },
                    whyCorrect: "B. demonstration nh·∫•n √¢m 3 (dem-on-'stra-tion).",
                    whyWrong: "A, C, D nh·∫•n √¢m 4: ac-com-mo-'da-tion, jus-ti-fi-'ca-tion, im-pos-si-'bil-ity."
                }
            },
            {
                id: 18, type: "Stress",
                question: "Primary Stress",
                word: "8. A. certification B. occupation C. incredibility D. inhospitality",
                options: ["A", "B", "C", "D"], correct: 1, // B
                explanation: {
                    meaning: { A: "Ch·ª©ng nh·∫≠n", B: "Ngh·ªÅ nghi·ªáp", C: "S·ª± kh√≥ tin", D: "S·ª± kh√¥ng hi·∫øu kh√°ch" },
                    whyCorrect: "B. occupation nh·∫•n √¢m 3 (oc-cu-'pa-tion).",
                    whyWrong: "A, C, D nh·∫•n √¢m 4: cer-ti-fi-'ca-tion, in-cred-i-'bil-ity, in-hos-pi-'tal-ity."
                }
            },
            {
                id: 19, type: "Stress",
                question: "Primary Stress",
                word: "9. A. similarity B. functionality C. signification D. composition",
                options: ["A", "B", "C", "D"], correct: 2, // C
                explanation: {
                    meaning: { A: "S·ª± t∆∞∆°ng ƒë·ªìng", B: "Ch·ª©c nƒÉng", C: "√ù nghƒ©a", D: "Th√†nh ph·∫ßn" },
                    whyCorrect: "C. signification nh·∫•n √¢m 4 (sig-ni-fi-'ca-tion).",
                    whyWrong: "A, B, D nh·∫•n √¢m 3: sim-i-'lar-ity, func-tion-'al-ity, com-po-'si-tion."
                }
            },
            {
                id: 20, type: "Stress",
                question: "Primary Stress",
                word: "10. A. destructivity B. contractility C. pronunciation D. creativity",
                options: ["A", "B", "C", "D"], correct: 2, // C
                explanation: {
                    meaning: { A: "T√≠nh ph√° ho·∫°i", B: "T√≠nh co r√∫t", C: "Ph√°t √¢m", D: "S·ª± s√°ng t·∫°o" },
                    whyCorrect: "C. pronunciation nh·∫•n √¢m 4 (pro-nun-ci-'a-tion).",
                    whyWrong: "A, B, D nh·∫•n √¢m 3: de-struc-'tiv-ity, con-trac-'til-ity, cre-a-'tiv-ity."
                }
            }
        ];

        let userAnswers = {};
        let score = 0;

        // === RENDER B√ÄI THI ===
        function renderQuiz() {
            const container = document.getElementById('quiz-container');
            
            quizData.forEach((item, index) => {
                const card = document.createElement('div');
                card.className = 'question-card';
                card.id = `q-card-${index}`;

                let html = `
                    <div class="question-title">
                        <span class="question-badge">${item.type}</span>
                        <span>C√¢u ${index + 1}/20</span>
                    </div>
                    <div class="question-text">${item.question}</div>
                    <div class="question-text" style="font-size: 1.5rem; color: var(--primary); background: #f1f2f6; padding: 15px; border-radius: 15px; text-align: center;">${item.word}</div>
                    
                    <div class="options-grid">
                        ${item.options.map((opt, i) => `
                            <button class="option-btn" id="btn-${index}-${i}" onclick="checkAnswer(${index}, ${i})">
                                ${opt}
                            </button>
                        `).join('')}
                    </div>

                    <div class="explanation-box" id="exp-${index}">
                        <div class="exp-header">
                            <div class="exp-teacher-avatar">Ms</div>
                            <span id="exp-status-${index}" style="font-weight: 700;">Gi·∫£i th√≠ch chi ti·∫øt:</span>
                        </div>
                        <div class="exp-content">
                            <span class="exp-label" style="color: #2f3542;">üìñ D·ªãch nghƒ©a & T·ª´ v·ª±ng:</span>
                            <table class="vocab-table">
                                <tr><th>Option</th><th>Nghƒ©a Ti·∫øng Vi·ªát</th></tr>
                                ${Object.entries(item.explanation.meaning).map(([key, val]) => `<tr><td><b>${key}</b></td><td>${val}</td></tr>`).join('')}
                            </table>
                            
                            <span class="exp-label" style="color: var(--correct);">‚úÖ T·∫°i sao ƒë√∫ng:</span>
                            <p>${item.explanation.whyCorrect}</p>
                            
                            <span class="exp-label" style="color: var(--wrong);">‚ùå T·∫°i sao sai:</span>
                            <p>${item.explanation.whyWrong}</p>
                        </div>
                    </div>
                `;
                card.innerHTML = html;
                container.appendChild(card);
            });
        }

        // === X·ª¨ L√ù CHECK ƒê√ÅP √ÅN ===
        function checkAnswer(questionIndex, selectedOptionIndex) {
            if (userAnswers[questionIndex] !== undefined) return;
            
            userAnswers[questionIndex] = selectedOptionIndex;
            const question = quizData[questionIndex];
            const isCorrect = selectedOptionIndex === question.correct;
            
            const btn = document.getElementById(`btn-${questionIndex}-${selectedOptionIndex}`);
            const correctBtn = document.getElementById(`btn-${questionIndex}-${question.correct}`);
            const expBox = document.getElementById(`exp-${questionIndex}`);
            const statusText = document.getElementById(`exp-status-${questionIndex}`);

            for (let i = 0; i < 4; i++) {
                document.getElementById(`btn-${questionIndex}-${i}`).disabled = true;
            }

            if (isCorrect) {
                btn.classList.add('correct');
                score++;
                playSound('correct');
                triggerConfetti(btn);
                statusText.innerText = "Ch√≠nh x√°c! C√¥ r·∫•t t·ª± h√†o v·ªÅ em!";
                statusText.style.color = "var(--correct)";
            } else {
                btn.classList.add('wrong');
                correctBtn.classList.add('correct');
                playSound('wrong');
                expBox.classList.add('wrong-state');
                statusText.innerText = "√îi ti·∫øc qu√°! Xem c√¥ gi·∫£i th√≠ch nh√©:";
                statusText.style.color = "var(--wrong)";
            }

            expBox.style.display = 'block';
        }

        // === SUBMIT & SCORE ===
        function submitQuiz() {
            const total = quizData.length;
            const praises = [
                "Xu·∫•t s·∫Øc! Em l√† 'Master' Ti·∫øng Anh r·ªìi! üëë",
                "R·∫•t t·ªët! C·ªë g·∫Øng ph√°t huy nh√©! üí™",
                "C√¥ Mai An tin em s·∫Ω l√†m t·ªët h∆°n n·ªØa! ‚ù§Ô∏è",
                "ƒê·ª´ng n·∫£n ch√≠, luy·ªán t·∫≠p th√™m l√† gi·ªèi ngay! üåü"
            ];
            
            // Determine praise based on score
            let praiseIndex = 0;
            if (score < total * 0.5) praiseIndex = 3;
            else if (score < total * 0.8) praiseIndex = 2;
            else if (score < total) praiseIndex = 1;
            
            document.getElementById('finalScore').innerText = `${score}/${total}`;
            document.getElementById('feedbackText').innerText = praises[praiseIndex];
            document.getElementById('scoreModal').style.display = "flex";
            
            if (score === total) {
                playSound('correct');
                triggerConfetti(document.body);
            }
        }

        function closeModal() {
            document.getElementById('scoreModal').style.display = "none";
            location.reload();
        }

        // === AUDIO & EFFECTS ===
        const audioCtx = new (window.AudioContext || window.webkitAudioContext)();
        
        function playSound(type) {
            const oscillator = audioCtx.createOscillator();
            const gainNode = audioCtx.createGain();
            oscillator.connect(gainNode);
            gainNode.connect(audioCtx.destination);
            
            if (type === 'correct') {
                oscillator.type = 'sine';
                oscillator.frequency.setValueAtTime(600, audioCtx.currentTime);
                oscillator.frequency.exponentialRampToValueAtTime(1200, audioCtx.currentTime + 0.1);
                gainNode.gain.setValueAtTime(0.2, audioCtx.currentTime);
                gainNode.gain.linearRampToValueAtTime(0, audioCtx.currentTime + 0.3);
                oscillator.start();
                oscillator.stop(audioCtx.currentTime + 0.3);
            } else {
                oscillator.type = 'sawtooth';
                oscillator.frequency.setValueAtTime(150, audioCtx.currentTime);
                oscillator.frequency.linearRampToValueAtTime(100, audioCtx.currentTime + 0.2);
                gainNode.gain.setValueAtTime(0.2, audioCtx.currentTime);
                gainNode.gain.linearRampToValueAtTime(0, audioCtx.currentTime + 0.2);
                oscillator.start();
                oscillator.stop(audioCtx.currentTime + 0.2);
            }
        }

        function triggerConfetti(element) {
            const canvas = document.getElementById('confetti-canvas');
            const ctx = canvas.getContext('2d');
            canvas.width = window.innerWidth;
            canvas.height = window.innerHeight;

            const particles = [];
            const colors = ['#8854C0', '#00C9A7', '#FF4757', '#FFD700', '#70a1ff'];

            const originX = element === document.body ? window.innerWidth / 2 : element.getBoundingClientRect().left + element.offsetWidth / 2;
            const originY = element === document.body ? window.innerHeight / 2 : element.getBoundingClientRect().top;

            for (let i = 0; i < 40; i++) {
                particles.push({
                    x: originX,
                    y: originY,
                    r: Math.random() * 5 + 2,
                    dx: (Math.random() - 0.5) * 10,
                    dy: (Math.random() - 1) * 10,
                    color: colors[Math.floor(Math.random() * colors.length)],
                    life: 100
                });
            }

            function draw() {
                ctx.clearRect(0, 0, canvas.width, canvas.height);
                let activeParticles = false;
                
                particles.forEach((p, index) => {
                    if (p.life > 0) {
                        activeParticles = true;
                        p.x += p.dx;
                        p.y += p.dy;
                        p.dy += 0.5; // Gravity
                        p.life--;
                        
                        ctx.beginPath();
                        ctx.arc(p.x, p.y, p.r, 0, Math.PI * 2);
                        ctx.fillStyle = p.color;
                        ctx.fill();
                    }
                });

                if (activeParticles) {
                    requestAnimationFrame(draw);
                }
            }
            draw();
        }

        // Initialize
        renderQuiz();
    </script>
</body>
</html>