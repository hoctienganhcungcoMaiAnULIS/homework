<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Ms Mai An ULIS - English Test</title>
    <link href="https://fonts.googleapis.com/css2?family=Quicksand:wght@400;600;700&display=swap" rel="stylesheet">
    <script src="https://cdn.jsdelivr.net/npm/canvas-confetti@1.5.1/dist/confetti.browser.min.js"></script>
    <style>
        :root {
            --primary: #8854C0;
            --secondary: #FDCB6E;
            --accent: #00C9A7;
            --correct: #00D26A;
            --wrong: #FF4757;
            --text-color: #2D3436;
        }

        * { box-sizing: border-box; font-family: 'Quicksand', sans-serif; }

        body {
            margin: 0;
            min-height: 100vh;
            display: flex;
            flex-direction: column;
            align-items: center;
            background: linear-gradient(-45deg, #8854C0, #FDCB6E, #00C9A7, #e84393);
            background-size: 400% 400%;
            animation: gradientBG 15s ease infinite;
            position: relative;
            overflow-x: hidden;
            padding: 20px;
        }

        /* H·ªça ti·∫øt l∆° l·ª≠ng */
        body::before {
            content: "";
            position: fixed;
            top: 0; left: 0; width: 100%; height: 100%;
            z-index: -1;
            opacity: 0.15;
            background-image: url("data:image/svg+xml,%3Csvg width='60' height='60' viewBox='0 0 60 60' xmlns='http://www.w3.org/2000/svg'%3E%3Cg fill='none' fill-rule='evenodd'%3E%3Cg fill='%23ffffff' fill-opacity='1'%3E%3Cpath d='M36 34v-4h-2v4h-4v2h4v4h2v-4h4v-2h-4zm0-30V0h-2v4h-4v2h4v4h2v-4h4v-2h-4zM6 34v-4H4v4H0v2h4v4h2v-4h4v-2H6zM6 4V0H4v4H0v2h4v4h2v-4h4v-2H6z'/%3E%3C/g%3E%3C/g%3E%3C/svg%3E");
        }

        @keyframes gradientBG {
            0% { background-position: 0% 50%; }
            50% { background-position: 100% 50%; }
            100% { background-position: 0% 50%; }
        }

        h1 { color: white; text-shadow: 2px 2px 4px rgba(0,0,0,0.2); margin-bottom: 5px; }
        h4 { color: white; margin-top: 0; font-weight: 400; }

        .container {
            max-width: 800px;
            width: 100%;
            background: rgba(255, 255, 255, 0.9);
            border-radius: 30px;
            padding: 30px;
            box-shadow: 0 20px 40px rgba(0,0,0,0.1);
            backdrop-filter: blur(10px);
        }

        .exercise-title {
            background: var(--primary);
            color: white;
            padding: 10px 20px;
            border-radius: 15px;
            display: inline-block;
            margin-bottom: 20px;
            font-weight: bold;
        }

        .question-card {
            background: white;
            border: 3px solid #f0f0f0;
            border-radius: 20px;
            padding: 20px;
            margin-bottom: 25px;
            transition: transform 0.3s;
            position: relative;
        }

        .question-text {
            font-size: 1.1rem;
            font-weight: 600;
            margin-bottom: 15px;
            color: #2d3436;
        }

        /* ABCD Buttons style */
        .options-grid {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 15px;
        }

        .option-btn {
            background: white;
            border: 3px solid #e0e0e0;
            border-bottom-width: 6px;
            padding: 12px;
            border-radius: 15px;
            cursor: pointer;
            font-weight: 600;
            transition: all 0.2s;
            text-align: left;
        }

        .option-btn:hover {
            transform: translateY(-2px);
            border-color: var(--secondary);
        }

        .option-btn.correct {
            background-color: var(--correct) !important;
            border-color: #00a352 !important;
            color: white;
        }

        .option-btn.wrong {
            background-color: var(--wrong) !important;
            border-color: #d63031 !important;
            color: white;
            animation: shake 0.4s;
        }

        /* Gap Fill Style */
        .gap-fill {
            display: inline-block;
            min-width: 120px;
            border-bottom: 3px dashed var(--primary);
            padding: 0 10px;
            cursor: pointer;
            color: var(--primary);
            font-weight: bold;
            text-align: center;
        }

        /* Explanation Box */
        .explanation {
            margin-top: 15px;
            padding: 15px;
            background: #f9f9f9;
            border-left: 5px solid var(--accent);
            border-radius: 10px;
            display: none;
            font-size: 0.95rem;
            line-height: 1.5;
            animation: fadeIn 0.5s;
        }

        .explanation b { color: var(--primary); }

        @keyframes shake {
            0%, 100% { transform: translateX(0); }
            25% { transform: translateX(-10px); }
            75% { transform: translateX(10px); }
        }

        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(10px); }
            to { opacity: 1; transform: translateY(0); }
        }

        .submit-area {
            text-align: center;
            margin-top: 30px;
        }

        .btn-submit {
            background: var(--accent);
            color: white;
            border: none;
            padding: 15px 40px;
            border-radius: 50px;
            font-size: 1.2rem;
            font-weight: bold;
            cursor: pointer;
            box-shadow: 0 6px 0 #00a88b;
            transition: all 0.2s;
        }

        .btn-submit:active {
            transform: translateY(4px);
            box-shadow: 0 2px 0 #00a88b;
        }

        /* Popup */
        #popup {
            position: fixed;
            top: 50%; left: 50%;
            transform: translate(-50%, -50%) scale(0);
            background: white;
            padding: 40px;
            border-radius: 30px;
            box-shadow: 0 0 100px rgba(0,0,0,0.3);
            z-index: 1000;
            text-align: center;
            transition: transform 0.3s cubic-bezier(0.175, 0.885, 0.32, 1.275);
        }

        #popup.show { transform: translate(-50%, -50%) scale(1); }

        .overlay {
            position: fixed;
            top: 0; left: 0; width: 100%; height: 100%;
            background: rgba(0,0,0,0.5);
            display: none;
            z-index: 999;
        }

        u { text-decoration: underline; font-weight: bold; color: #d63031; }
    </style>
</head>
<body>

    <h4>Gi√°o vi√™n t·∫°o: Ms Mai An ULIS</h4>
    <h1>CHINH PH·ª§C TI·∫æNG ANH 6</h1>

    <div class="container" id="quiz-container">
        </div>

    <div class="submit-area">
        <button class="btn-submit" onclick="showFinalResult()">N·ªòP B√ÄI T·∫¨P</button>
    </div>

    <div class="overlay" id="overlay"></div>
    <div id="popup">
        <h2 id="score-text"></h2>
        <p id="feedback-text"></p>
        <button class="btn-submit" onclick="location.reload()">L√ÄM L·∫†I</button>
    </div>

    <script>
        const quizData = [
            // Exercise 12
            {
                type: "abcd",
                exercise: "Exercise 12: Make up sentences",
                question: "1. Who / you / play rugby / with / yesterday / ?",
                options: [
                    "Who did you play rugby with yesterday?",
                    "Who you played rugby with yesterday?",
                    "Who do you play rugby with yesterday?",
                    "Who did you played rugby with yesterday?"
                ],
                correct: 0,
                explanation: "<b>1. D·ªãch c√¢u:</b> B·∫°n ƒë√£ ch∆°i b√≥ng b·∫ßu d·ª•c v·ªõi ai v√†o ng√†y h√¥m qua?<br><b>2. Ph√¢n t√≠ch:</b><br>A. ƒê√∫ng c·∫•u tr√∫c c√¢u h·ªèi th√¨ qu√° kh·ª© ƒë∆°n (Wh- + did + S + V-inf).<br>B. Sai v√¨ thi·∫øu tr·ª£ ƒë·ªông t·ª´ 'did'.<br>C. Sai v√¨ d√πng 'do' cho qu√° kh·ª© (yesterday).<br>D. Sai v√¨ sau 'did' ƒë·ªông t·ª´ ph·∫£i gi·ªØ nguy√™n m·∫´u (play), kh√¥ng chia 'played'."
            },
            {
                type: "abcd",
                exercise: "Exercise 12",
                question: "2. Hoi An / famous / old houses and buildings / traditional crafts / .",
                options: [
                    "Hoi An is famous for its old houses and buildings and traditional crafts.",
                    "Hoi An famous for its old houses and buildings and traditional crafts.",
                    "Hoi An is famous with its old houses and buildings and traditional crafts.",
                    "Hoi An are famous for its old houses and buildings and traditional crafts."
                ],
                correct: 0,
                explanation: "<b>1. D·ªãch c√¢u:</b> H·ªôi An n·ªïi ti·∫øng v·ªõi nh·ªØng ng√¥i nh√†, t√≤a nh√† c·ªï v√† c√°c ngh·ªÅ th·ªß c√¥ng truy·ªÅn th·ªëng.<br><b>2. C·∫•u tr√∫c:</b> To be famous FOR something (N·ªïi ti·∫øng v·ªÅ c√°i g√¨).<br><b>3. Ph√¢n t√≠ch:</b><br>A. ƒê√∫ng (Hoi An l√† s·ªë √≠t d√πng 'is' + famous for).<br>B. Thi·∫øu ƒë·ªông t·ª´ 'is'.<br>C. Sai gi·ªõi t·ª´ 'with'.<br>D. Sai v√¨ 'Hoi An' kh√¥ng ƒëi v·ªõi 'are'."
            },
            {
                type: "abcd",
                exercise: "Exercise 12",
                question: "3. My mom / tired / she / not / watch / her / favorite / film / last night / .",
                options: [
                    "My mom was tired, so she didn't watch her favorite film last night.",
                    "My mom is tired, so she doesn't watch her favorite film last night.",
                    "My mom was tired, but she didn't watch her favorite film last night.",
                    "My mom was tired, so she not watched her favorite film last night."
                ],
                correct: 0,
                explanation: "<b>1. D·ªãch c√¢u:</b> M·∫π t√¥i ƒë√£ m·ªát, v√¨ v·∫≠y b√† ·∫•y kh√¥ng xem b·ªô phim y√™u th√≠ch v√†o t·ªëi qua.<br><b>2. Ph√¢n t√≠ch:</b> D·∫•u hi·ªáu 'last night' -> d√πng th√¨ qu√° kh·ª© ƒë∆°n.<br>A. ƒê√∫ng (v·∫ø ƒë·∫ßu d√πng was, v·∫ø sau d√πng li√™n t·ª´ 'so' ch·ªâ k·∫øt qu·∫£ v√† ph·ªß ƒë·ªãnh 'didn't watch').<br>B. Sai th√¨ (is/doesn't).<br>C. Sai li√™n t·ª´ ('but' l√† nh∆∞ng).<br>D. Sai c·∫•u tr√∫c ph·ªß ƒë·ªãnh (ph·∫£i l√† didn't watch)."
            },
            {
                type: "abcd",
                exercise: "Exercise 12",
                question: "4. I / like / watch / programme / about / history / .",
                options: [
                    "I like watching programmes about history.",
                    "I like watch programme about history.",
                    "I like watching programme with history.",
                    "I likes watching programmes about history."
                ],
                correct: 0,
                explanation: "<b>1. D·ªãch:</b> T√¥i th√≠ch xem nh·ªØng ch∆∞∆°ng tr√¨nh v·ªÅ l·ªãch s·ª≠.<br><b>2. C·∫•u tr√∫c:</b> Like + V-ing (s·ªü th√≠ch).<br><b>3. Ph√¢n t√≠ch:</b><br>A. ƒê√∫ng.<br>B. Sai v√¨ sau like ph·∫£i l√† V-ing ho·∫∑c To-V.<br>C. Sai gi·ªõi t·ª´ 'with'.<br>D. Sai chia ƒë·ªông t·ª´ (ch·ªß ng·ªØ 'I' kh√¥ng th√™m 's' v√†o like)."
            },
            {
                type: "abcd",
                exercise: "Exercise 12",
                question: "5. not / watch / TV / until / midnight / !",
                options: [
                    "Don't watch TV until midnight!",
                    "Not watch TV until midnight!",
                    "You not watch TV until midnight!",
                    "Do watch TV until midnight!"
                ],
                correct: 0,
                explanation: "<b>1. D·ªãch:</b> ƒê·ª´ng xem TV cho ƒë·∫øn t·∫≠n n·ª≠a ƒë√™m!<br><b>2. C·∫•u tr√∫c:</b> C√¢u m·ªánh l·ªánh ph·ªß ƒë·ªãnh: Don't + V-inf!<br><b>3. Ph√¢n t√≠ch:</b> Ch·ªâ c√≥ A ƒë√∫ng c·∫•u tr√∫c m·ªánh l·ªánh."
            },
            {
                type: "abcd",
                exercise: "Exercise 12",
                question: "6. What / channel / Wildlife / on / ?",
                options: [
                    "What channel is Wildlife on?",
                    "What channel Wildlife on?",
                    "What channel does Wildlife on?",
                    "What channel is Wildlife in?"
                ],
                correct: 0,
                explanation: "<b>1. D·ªãch:</b> Ch∆∞∆°ng tr√¨nh Th·∫ø gi·ªõi ƒë·ªông v·∫≠t chi·∫øu tr√™n k√™nh n√†o?<br><b>2. Ph·∫•u t√≠ch:</b> Khi n√≥i ch∆∞∆°ng tr√¨nh chi·∫øu tr√™n k√™nh n√†o ta d√πng 'be on channel'.<br>A. ƒê√∫ng.<br>B. Thi·∫øu ƒë·ªông t·ª´ to be 'is'.<br>C. Sai v√¨ 'on' kh√¥ng ph·∫£i ƒë·ªông t·ª´ th∆∞·ªùng ƒë·ªÉ d√πng 'does'.<br>D. Sai gi·ªõi t·ª´ 'in'."
            },
            {
                type: "abcd",
                exercise: "Exercise 12",
                question: "7. How many / player / there / football match / ?",
                options: [
                    "How many players are there in a football match?",
                    "How many player are there in a football match?",
                    "How many players there are in a football match?",
                    "How many players is there in a football match?"
                ],
                correct: 0,
                explanation: "<b>1. D·ªãch:</b> C√≥ bao nhi√™u c·∫ßu th·ªß trong m·ªôt tr·∫≠n b√≥ng ƒë√°?<br><b>2. C·∫•u tr√∫c:</b> How many + N(s·ªë nhi·ªÅu) + are there...?.<br><b>3. Ph√¢n t√≠ch:</b><br>A. ƒê√∫ng.<br>B. Sai v√¨ 'player' thi·∫øu 's'.<br>C. Sai th·ª© t·ª± t·ª´ trong c√¢u h·ªèi (ph·∫£i l√† are there).<br>D. Sai v√¨ 'players' l√† s·ªë nhi·ªÅu ph·∫£i d√πng 'are'."
            },
            {
                type: "abcd",
                exercise: "Exercise 12",
                question: "8. We / very tired / so / we / stop / walk / .",
                options: [
                    "We were very tired, so we stopped walking.",
                    "We were very tired, so we stopped to walk.",
                    "We very tired, so we stopped walking.",
                    "We are very tired, so we stop walk."
                ],
                correct: 0,
                explanation: "<b>1. D·ªãch:</b> Ch√∫ng t√¥i ƒë√£ r·∫•t m·ªát, v√¨ v·∫≠y ch√∫ng t√¥i ƒë√£ d·ª´ng vi·ªác ƒëi b·ªô l·∫°i.<br><b>2. C·∫•u tr√∫c:</b> Stop + V-ing (d·ª´ng h·∫≥n vi·ªác g√¨).<br><b>3. Ph√¢n t√≠ch:</b><br>A. ƒê√∫ng (chia qu√° kh·ª© ƒë·ªìng nh·∫•t).<br>B. Sai nghƒ©a (stop to walk = d·ª´ng l·∫°i ƒë·ªÉ ƒëi b·ªô).<br>C. Thi·∫øu 'were'.<br>D. Sai c·∫•u tr√∫c 'stop walk'."
            },
            // Exercise 13
            {
                type: "abcd",
                exercise: "Exercise 13: Rewrite sentences",
                question: "1. The coat belongs to me. ‚Üí It is ______.",
                options: [
                    "mine",
                    "my",
                    "me",
                    "I"
                ],
                correct: 0,
                explanation: "<b>1. D·ªãch:</b> C√°i √°o kho√°c thu·ªôc v·ªÅ t√¥i. -> N√≥ l√† c·ªßa t√¥i.<br><b>2. Ph√¢n t√≠ch:</b><br>A. mine (ƒë·∫°i t·ª´ s·ªü h·ªØu): thay th·∫ø cho 'my coat' - ƒê√∫ng.<br>B. my (t√≠nh t·ª´ s·ªü h·ªØu): ph·∫£i c√≥ danh t·ª´ theo sau.<br>C. me: t√¢n ng·ªØ.<br>D. I: ch·ªß ng·ªØ."
            },
            {
                type: "abcd",
                exercise: "Exercise 13",
                question: "2. The teacher wants her students to open their Maths books. ‚Üí Teacher says: '______'",
                options: [
                    "Open your Maths books, please.",
                    "To open your Maths books.",
                    "You open your Maths books.",
                    "Opening your Maths books."
                ],
                correct: 0,
                explanation: "<b>1. D·ªãch:</b> Gi√°o vi√™n mu·ªën h·ªçc sinh m·ªü s√°ch To√°n. -> Gi√°o vi√™n n√≥i: 'C√°c em h√£y m·ªü s√°ch To√°n ra'.<br><b>2. C·∫•u tr√∫c:</b> C√¢u m·ªánh l·ªánh b·∫Øt ƒë·∫ßu b·∫±ng V-inf.<br><b>3. Ph√¢n t√≠ch:</b> A l√† c√¢u m·ªánh l·ªánh l·ªãch s·ª± nh·∫•t v√† ƒë√∫ng ng·ªØ ph√°p."
            },
            {
                type: "abcd",
                exercise: "Exercise 13",
                question: "3. This motorbike belongs to you. ‚Üí This motorbike is ______.",
                options: [
                    "yours",
                    "your",
                    "you",
                    "yours motor"
                ],
                correct: 0,
                explanation: "<b>1. D·ªãch:</b> Chi·∫øc xe m√°y n√†y c·ªßa b·∫°n. -> Chi·∫øc xe m√°y n√†y l√† c·ªßa b·∫°n.<br><b>2. Ph√¢n t√≠ch:</b> T∆∞∆°ng t·ª± c√¢u 1, ta c·∫ßn d√πng ƒë·∫°i t·ª´ s·ªü h·ªØu 'yours' ƒë·ªÉ thay th·∫ø cho 'your motorbike'."
            },
            {
                type: "abcd",
                exercise: "Exercise 13",
                question: "4. When do you usually wake up in the morning? ‚Üí What ______?",
                options: [
                    "time do you usually wake up in the morning",
                    "is the time you wake up",
                    "does the time you wake up",
                    "time are you usually wake up"
                ],
                correct: 0,
                explanation: "<b>1. D·ªãch:</b> B·∫°n th∆∞·ªùng th·ª©c d·∫≠y l√∫c m·∫•y gi·ªù?<br><b>2. Ph√¢n t√≠ch:</b> 'When' c√≥ th·ªÉ thay th·∫ø b·∫±ng 'What time' (m·∫•y gi·ªù). C·∫•u tr√∫c: What time + do/does + S + V-inf?"
            },
            {
                type: "abcd",
                exercise: "Exercise 13",
                question: "5. It‚Äôs not good for children to spend too much time watching TV. ‚Üí Children ______.",
                options: [
                    "shouldn't spend too much time watching television",
                    "must spend too much time watching television",
                    "don't should spend too much time watching television",
                    "shouldn't spending too much time watching television"
                ],
                correct: 0,
                explanation: "<b>1. D·ªãch:</b> Tr·∫ª em kh√¥ng n√™n d√†nh qu√° nhi·ªÅu th·ªùi gian xem TV.<br><b>2. C·∫•u tr√∫c:</b> 'It's not good' t∆∞∆°ng ƒë∆∞∆°ng v·ªõi l·ªùi khuy√™n ph·ªß ƒë·ªãnh 'shouldn't + V-inf'.<br><b>3. Ph√¢n t√≠ch:</b> A ƒë√∫ng. D sai v√¨ d√πng V-ing sau shouldn't."
            },
            {
                type: "abcd",
                exercise: "Exercise 13",
                question: "6. You mustn‚Äôt use a mobile phone in class. ‚Üí Do ______.",
                options: [
                    "not use a mobile phone in class",
                    "no use a mobile phone in class",
                    "not using a mobile phone in class",
                    "don't use a mobile phone in class"
                ],
                correct: 0,
                explanation: "<b>1. D·ªãch:</b> B·∫°n kh√¥ng ƒë∆∞·ª£c d√πng ƒëi·ªán tho·∫°i trong l·ªõp. -> ƒê·ª´ng d√πng ƒëi·ªán tho·∫°i trong l·ªõp.<br><b>2. Ph√¢n t√≠ch:</b> Do not + V-inf l√† d·∫°ng ƒë·∫ßy ƒë·ªß c·ªßa Don't + V-inf."
            },
            {
                type: "abcd",
                exercise: "Exercise 13",
                question: "7. Although he seemed a friendly person, I didn‚Äôt like him. ‚Üí He seemed ______.",
                options: [
                    "a friendly person, but I didn't like him",
                    "a friendly person, so I didn't like him",
                    "a friendly person, and I didn't like him",
                    "friendly but I like him"
                ],
                correct: 0,
                explanation: "<b>1. D·ªãch:</b> M·∫∑c d√π anh ·∫•y c√≥ v·∫ª th√¢n thi·ªán, t√¥i v·∫´n kh√¥ng th√≠ch anh ·∫•y.<br><b>2. Ph√¢n t√≠ch:</b> 'Although' (M·∫∑c d√π) c√≥ th·ªÉ thay b·∫±ng li√™n t·ª´ 'but' (nh∆∞ng) ·ªü gi·ªØa hai v·∫ø."
            },
            {
                type: "abcd",
                exercise: "Exercise 13",
                question: "8. Jim loves animals, so he likes to watch Animal programme. ‚Üí Jim likes to watch Animal programme ______.",
                options: [
                    "because he loves animals",
                    "but he loves animals",
                    "so he loves animals",
                    "although he loves animals"
                ],
                correct: 0,
                explanation: "<b>1. D·ªãch:</b> Jim th√≠ch xem ch∆∞∆°ng tr√¨nh ƒë·ªông v·∫≠t v√¨ anh ·∫•y y√™u ƒë·ªông v·∫≠t.<br><b>2. Ph√¢n t√≠ch:</b> V·∫ø 'Jim loves animals' l√† nguy√™n nh√¢n, n√™n d√πng 'because' (b·ªüi v√¨)."
            },
             // Exercise 14
             {
                type: "abcd",
                exercise: "Exercise 14: Make questions for underlined part",
                question: "1. They didn't have a TV set <u>because it was too expensive</u>.",
                options: [
                    "Why didn't they have a TV set?",
                    "How didn't they have a TV set?",
                    "What didn't they have a TV set?",
                    "Why they didn't have a TV set?"
                ],
                correct: 0,
                explanation: "<b>1. D·ªãch:</b> T·∫°i sao h·ªç kh√¥ng c√≥ TV?<br><b>2. Ph√¢n t√≠ch:</b> C·ª•m g·∫°ch ch√¢n b·∫Øt ƒë·∫ßu b·∫±ng 'because' ch·ªâ l√Ω do -> D√πng t·ª´ h·ªèi 'Why'.<br><b>3. C·∫•u tr√∫c:</b> Why + tr·ª£ ƒë·ªông t·ª´ + S + V-inf?"
            },
            {
                type: "abcd",
                exercise: "Exercise 14",
                question: "2. The news programme often finishes <u>at eight o‚Äôclock</u>.",
                options: [
                    "What time does the news programme often finish?",
                    "What time the news programme often finishes?",
                    "When does the news programme often finishes?",
                    "What time often finishes the news programme?"
                ],
                correct: 0,
                explanation: "<b>1. D·ªãch:</b> Ch∆∞∆°ng tr√¨nh tin t·ª©c th∆∞·ªùng k·∫øt th√∫c l√∫c m·∫•y gi·ªù?<br><b>2. Ph√¢n t√≠ch:</b> 'at eight o‚Äôclock' ch·ªâ th·ªùi gian -> D√πng 'What time' ho·∫∑c 'When'.<br><b>3. L∆∞u √Ω:</b> M∆∞·ª£n tr·ª£ ƒë·ªông t·ª´ 'does', ƒë·ªông t·ª´ ch√≠nh 'finish' b·ªè 'es'."
            },
            {
                type: "abcd",
                exercise: "Exercise 14",
                question: "3. My family <u>usually</u> watches TV in the evening.",
                options: [
                    "How often does your family watch TV in the evening?",
                    "How usually does your family watch TV?",
                    "What does your family usually do?",
                    "How many times your family watches TV?"
                ],
                correct: 0,
                explanation: "<b>1. D·ªãch:</b> Gia ƒë√¨nh b·∫°n c√≥ th∆∞·ªùng xuy√™n xem TV v√†o bu·ªïi t·ªëi kh√¥ng?<br><b>2. Ph√¢n t√≠ch:</b> 'usually' ch·ªâ t·∫ßn su·∫•t -> D√πng t·ª´ h·ªèi 'How often'."
            },
            {
                type: "abcd",
                exercise: "Exercise 14",
                question: "4. That newsreader usually gets to work <u>by bus</u>.",
                options: [
                    "How does that newsreader usually get to work?",
                    "What does that newsreader usually get to work?",
                    "By what does that newsreader usually get to work?",
                    "How that newsreader usually gets to work?"
                ],
                correct: 0,
                explanation: "<b>1. D·ªãch:</b> Ng∆∞·ªùi d·∫´n ch∆∞∆°ng tr√¨nh ƒë√≥ th∆∞·ªùng ƒëi l√†m b·∫±ng c√°ch n√†o?<br><b>2. Ph√¢n t√≠ch:</b> 'by bus' ch·ªâ ph∆∞∆°ng ti·ªán/c√°ch th·ª©c -> D√πng t·ª´ h·ªèi 'How'."
            },
            {
                type: "abcd",
                exercise: "Exercise 14",
                question: "5. I went to <u>Nha Trang</u> last summer vacation.",
                options: [
                    "Where did you go last summer vacation?",
                    "When did you go to Nha Trang?",
                    "Where you went last summer vacation?",
                    "Where do you go last summer vacation?"
                ],
                correct: 0,
                explanation: "<b>1. D·ªãch:</b> B·∫°n ƒë√£ ƒëi ƒë√¢u v√†o k·ª≥ ngh·ªâ h√® nƒÉm ngo√°i?<br><b>2. Ph√¢n t√≠ch:</b> 'Nha Trang' l√† ƒë·ªãa ƒëi·ªÉm -> D√πng 'Where'. Qu√° kh·ª© 'went' m∆∞·ª£n tr·ª£ ƒë·ªông t·ª´ 'did'."
            },
            // Exercise 15
            {
                type: "abcd",
                exercise: "Exercise 15: Combine sentences",
                question: "1. Your arguments are strong. They don‚Äôt convince me. (but)",
                options: [
                    "Your arguments are strong, but they don‚Äôt convince me.",
                    "Your arguments are strong but don‚Äôt convince me.",
                    "Both A and B are correct.",
                    "Your arguments are strong, and they don‚Äôt convince me."
                ],
                correct: 2,
                explanation: "<b>1. D·ªãch:</b> L√Ω l·∫Ω c·ªßa b·∫°n r·∫•t m·∫°nh m·∫Ω, nh∆∞ng ch√∫ng kh√¥ng thuy·∫øt ph·ª•c ƒë∆∞·ª£c t√¥i.<br><b>2. Ph√¢n t√≠ch:</b> 'But' n·ªëi hai v·∫ø ƒë·ªëi l·∫≠p. Ta c√≥ th·ªÉ gi·ªØ l·∫°i ch·ªß ng·ªØ ho·∫∑c l∆∞·ª£c b·ªè n·∫øu c√πng ch·ªß ng·ªØ (·ªü ƒë√¢y 'they' thay cho 'arguments'). C·∫£ A v√† B ƒë·ªÅu ƒë√∫ng."
            },
            {
                type: "abcd",
                exercise: "Exercise 15",
                question: "2. I work in a restaurant. She works in the same restaurant. (and)",
                options: [
                    "I and she work in the same restaurant.",
                    "She and I work in the same restaurant.",
                    "I work in a restaurant and she works in the same restaurant.",
                    "All are correct."
                ],
                correct: 3,
                explanation: "<b>1. D·ªãch:</b> T√¥i v√† c√¥ ·∫•y l√†m vi·ªác trong c√πng m·ªôt nh√† h√†ng.<br><b>2. Ph√¢n t√≠ch:</b> 'And' d√πng ƒë·ªÉ n·ªëi hai th√¥ng tin t∆∞∆°ng ƒë·ªìng. C√°c c√°ch vi·∫øt tr√™n ƒë·ªÅu ƒë√∫ng ng·ªØ ph√°p v√† truy·ªÅn ƒë·∫°t ƒë·ªß √Ω."
            }
        ];

        let currentScore = 0;
        const quizContainer = document.getElementById('quiz-container');

        // √Çm thanh
        function playSound(type) {
            const context = new (window.AudioContext || window.webkitAudioContext)();
            const osc = context.createOscillator();
            const gain = context.createGain();
            osc.connect(gain);
            gain.connect(context.destination);

            if (type === 'correct') {
                osc.type = 'sine';
                osc.frequency.setValueAtTime(523.25, context.currentTime); // C5
                osc.frequency.exponentialRampToValueAtTime(880, context.currentTime + 0.1);
                gain.gain.setValueAtTime(0.5, context.currentTime);
                gain.gain.exponentialRampToValueAtTime(0.01, context.currentTime + 0.3);
                osc.start();
                osc.stop(context.currentTime + 0.3);
            } else {
                osc.type = 'sawtooth';
                osc.frequency.setValueAtTime(150, context.currentTime);
                gain.gain.setValueAtTime(0.5, context.currentTime);
                gain.gain.exponentialRampToValueAtTime(0.01, context.currentTime + 0.3);
                osc.start();
                osc.stop(context.currentTime + 0.3);
            }
        }

        function shuffle(array) {
            return array.sort(() => Math.random() - 0.5);
        }

        function renderQuiz() {
            let currentExercise = "";
            quizData.forEach((q, index) => {
                if (q.exercise !== currentExercise) {
                    currentExercise = q.exercise;
                    const exHeader = document.createElement('div');
                    exHeader.className = 'exercise-title';
                    exHeader.innerText = currentExercise;
                    quizContainer.appendChild(exHeader);
                }

                const card = document.createElement('div');
                card.className = 'question-card';
                card.id = `q-${index}`;

                const qText = document.createElement('div');
                qText.className = 'question-text';
                qText.innerHTML = q.question;
                card.appendChild(qText);

                const optionsGrid = document.createElement('div');
                optionsGrid.className = 'options-grid';

                // L∆∞u index ƒë√°p √°n ƒë√∫ng sau khi shuffle
                const options = q.options.map((opt, i) => ({ text: opt, isCorrect: i === q.correct }));
                shuffle(options);

                options.forEach(opt => {
                    const btn = document.createElement('button');
                    btn.className = 'option-btn';
                    btn.innerText = opt.text;
                    btn.onclick = () => checkAnswer(index, opt.isCorrect, btn);
                    optionsGrid.appendChild(btn);
                });

                card.appendChild(optionsGrid);

                const expl = document.createElement('div');
                expl.className = 'explanation';
                expl.id = `expl-${index}`;
                expl.innerHTML = q.explanation;
                card.appendChild(expl);

                quizContainer.appendChild(card);
            });
        }

        function checkAnswer(qIdx, isCorrect, btn) {
            const card = document.getElementById(`q-${qIdx}`);
            const buttons = card.querySelectorAll('.option-btn');
            const expl = document.getElementById(`expl-${qIdx}`);

            // NgƒÉn ch·ªçn l·∫°i
            buttons.forEach(b => b.disabled = true);

            if (isCorrect) {
                btn.classList.add('correct');
                playSound('correct');
                confetti({
                    particleCount: 50,
                    spread: 70,
                    origin: { y: 0.6 }
                });
                currentScore++;
            } else {
                btn.classList.add('wrong');
                playSound('wrong');
                // Hi·ªán ƒë√°p √°n ƒë√∫ng
                buttons.forEach(b => {
                    // Trong logic n√†y ta so s√°nh text ƒë·ªÉ t√¨m ƒë√°p √°n ƒë√∫ng g·ªëc
                    const originalCorrectText = quizData[qIdx].options[quizData[qIdx].correct];
                    if (b.innerText === originalCorrectText) {
                        b.classList.add('correct');
                    }
                });
            }

            expl.style.display = 'block';
        }

        function showFinalResult() {
            const popup = document.getElementById('popup');
            const overlay = document.getElementById('overlay');
            const scoreText = document.getElementById('score-text');
            const feedbackText = document.getElementById('feedback-text');

            overlay.style.display = 'block';
            popup.classList.add('show');
            
            scoreText.innerText = `ƒêi·ªÉm c·ªßa em: ${currentScore}/${quizData.length}`;
            
            if (currentScore === quizData.length) {
                feedbackText.innerText = "Xu·∫•t s·∫Øc! Em l√† m·ªôt thi√™n t√†i ti·∫øng Anh! üåü";
            } else if (currentScore > quizData.length / 2) {
                feedbackText.innerText = "L√†m t·ªët l·∫Øm! C·ªë g·∫Øng ph√°t huy em nh√©! üëç";
            } else {
                feedbackText.innerText = "ƒê·ª´ng bu·ªìn nh√©, xem k·ªπ ph·∫ßn gi·∫£i th√≠ch v√† th·ª≠ l·∫°i n√†o! üí™";
            }
        }

        renderQuiz();
    </script>
</body>
</html>

