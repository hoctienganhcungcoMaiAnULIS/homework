<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Reading Challenge - Ms Mai An ULIS</title>
    <link href="https://fonts.googleapis.com/css2?family=Nunito:wght@400;600;700;800;900&display=swap" rel="stylesheet">
    <style>
        :root {
            --primary-color: #009688; /* Ocean Teal */
            --secondary-color: #4CAF50; /* Forest Green */
            --correct-color: #00D26A;
            --incorrect-color: #FF4757;
            --bg-light: rgba(255, 255, 255, 0.9);
            --text-dark: #2d3436;
        }

        * {
            box-sizing: border-box;
            margin: 0;
            padding: 0;
            font-family: 'Nunito', sans-serif;
        }

        body {
            /* Dynamic SVG Background (Ocean & Forest Emoji Theme) */
            background-color: #e0f2f1;
            background-image: 
                url('data:image/svg+xml;utf8,<svg xmlns="http://www.w3.org/2000/svg" width="300" height="300" opacity="0.3"><text x="30" y="50" font-size="40">üåä</text><text x="200" y="100" font-size="40">üå≤</text><text x="100" y="200" font-size="40">üåç</text><text x="250" y="280" font-size="40">üçÉ</text></svg>'),
                radial-gradient(circle at top left, #b2dfdb 0%, #c8e6c9 100%);
            background-attachment: fixed;
            color: var(--text-dark);
            height: 100vh;
            display: flex;
            flex-direction: column;
            overflow: hidden;
        }

        /* Top Control Bar */
        .top-bar {
            background: linear-gradient(135deg, var(--primary-color), var(--secondary-color));
            color: white;
            padding: 10px 20px;
            display: flex;
            justify-content: space-between;
            align-items: center;
            box-shadow: 0 4px 15px rgba(0,0,0,0.1);
            z-index: 10;
        }

        .header-info h3 {
            font-size: 14px;
            font-weight: 700;
            opacity: 0.9;
            text-transform: uppercase;
            letter-spacing: 1px;
        }

        .timer-container {
            display: flex;
            align-items: center;
            gap: 15px;
            background: rgba(0,0,0,0.2);
            padding: 8px 20px;
            border-radius: 30px;
            box-shadow: inset 0 3px 5px rgba(0,0,0,0.2);
        }

        .timer-display {
            font-size: 24px;
            font-weight: 900;
            font-variant-numeric: tabular-nums;
        }

        .btn-timer {
            background: #FFD166;
            color: #d35400;
            border: none;
            padding: 8px 15px;
            border-radius: 15px;
            font-weight: 800;
            cursor: pointer;
            box-shadow: 0 4px 0 #e67e22;
            transition: all 0.1s;
        }

        .btn-timer:active {
            transform: translateY(4px);
            box-shadow: 0 0 0 #e67e22;
        }

        /* Split Screen Layout */
        .main-container {
            display: flex;
            flex: 1;
            overflow: hidden;
        }

        .panel {
            flex: 1;
            overflow-y: auto;
            padding: 20px;
            scroll-behavior: smooth;
        }

        .left-panel {
            border-right: 4px dashed rgba(0, 150, 136, 0.3);
            background: rgba(255, 255, 255, 0.6);
            backdrop-filter: blur(10px);
        }

        .right-panel {
            background: rgba(255, 255, 255, 0.4);
        }

        /* Scrollbar styling */
        ::-webkit-scrollbar {
            width: 10px;
        }
        ::-webkit-scrollbar-track {
            background: #f1f1f1; 
            border-radius: 10px;
        }
        ::-webkit-scrollbar-thumb {
            background: #888; 
            border-radius: 10px;
        }
        ::-webkit-scrollbar-thumb:hover {
            background: #555; 
        }

        /* Reading Passage Styles */
        .passage-card {
            background: white;
            padding: 25px;
            border-radius: 20px;
            box-shadow: 0 8px 20px rgba(0,0,0,0.05);
            margin-bottom: 30px;
            line-height: 1.8;
            font-size: 17px;
        }

        .passage-card h2 {
            color: var(--primary-color);
            margin-bottom: 15px;
            border-bottom: 2px solid #eee;
            padding-bottom: 10px;
            font-size: 22px;
        }

        .blank {
            display: inline-block;
            min-width: 60px;
            border-bottom: 2px dashed var(--text-dark);
            text-align: center;
            font-weight: bold;
            color: var(--primary-color);
        }

        .btn-translate {
            background: #118AB2;
            color: white;
            border: none;
            padding: 10px 20px;
            border-radius: 15px;
            font-weight: 800;
            font-size: 15px;
            cursor: pointer;
            box-shadow: 0 4px 0 #0b5e7a;
            margin-top: 15px;
            display: flex;
            align-items: center;
            gap: 8px;
            transition: all 0.2s;
        }
        .btn-translate:hover { transform: scale(1.05); }
        .btn-translate:active { transform: translateY(4px); box-shadow: 0 0 0 #0b5e7a; }

        .translation-box {
            display: none;
            margin-top: 15px;
            padding: 15px;
            background: #e1f5fe;
            border-left: 5px solid #03a9f4;
            border-radius: 10px;
            font-style: italic;
            color: #0277bd;
        }

        /* Glossary Table */
        .glossary-table {
            width: 100%;
            border-collapse: separate;
            border-spacing: 0;
            margin-top: 20px;
            border-radius: 15px;
            overflow: hidden;
            box-shadow: 0 4px 10px rgba(0,0,0,0.05);
        }
        .glossary-table th, .glossary-table td {
            padding: 12px 15px;
            text-align: left;
            border-bottom: 1px solid #eee;
        }
        .glossary-table th {
            background: var(--secondary-color);
            color: white;
            font-weight: 800;
        }
        .glossary-table tr:nth-child(even) { background-color: #f9f9f9; }
        .glossary-table tr:last-child td { border-bottom: none; }
        .glossary-table tr:hover { background-color: #f1f8e9; }

        /* Question Cards */
        .question-card {
            background: white;
            padding: 25px;
            border-radius: 20px;
            box-shadow: 0 8px 20px rgba(0,0,0,0.08);
            margin-bottom: 25px;
            transition: all 0.3s ease;
            position: relative;
        }

        .question-text {
            font-size: 19px;
            font-weight: 800;
            margin-bottom: 20px;
            color: var(--text-dark);
        }

        .options-grid {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 15px;
        }

        .option-btn {
            background: #f8f9fa;
            border: 2px solid #e9ecef;
            padding: 15px 20px;
            border-radius: 15px;
            font-size: 16px;
            font-weight: 700;
            color: #495057;
            cursor: pointer;
            text-align: left;
            box-shadow: 0 5px 0 #dee2e6;
            transition: all 0.2s cubic-bezier(0.175, 0.885, 0.32, 1.275);
            position: relative;
            display: flex;
            align-items: center;
        }

        .option-btn:hover:not(.disabled) {
            transform: scale(1.03);
            border-color: var(--primary-color);
            color: var(--primary-color);
        }

        .option-btn:active:not(.disabled) {
            transform: translateY(5px) scale(0.98);
            box-shadow: 0 0 0 #dee2e6;
        }

        .option-btn.disabled {
            cursor: not-allowed;
            opacity: 0.8;
        }

        .option-btn.correct {
            background: var(--correct-color);
            color: white;
            border-color: var(--correct-color);
            box-shadow: 0 5px 0 #009e50;
        }

        .option-btn.wrong {
            background: var(--incorrect-color);
            color: white;
            border-color: var(--incorrect-color);
            box-shadow: 0 5px 0 #d63031;
        }

        /* Explanation Box */
        .explanation-box {
            display: none;
            margin-top: 20px;
            padding: 20px;
            background: #fff9c4;
            border: 2px dashed #fbc02d;
            border-radius: 15px;
            animation: slideDown 0.4s ease forwards;
        }
        
        .explanation-box h4 {
            color: #f57f17;
            margin-bottom: 10px;
            font-size: 18px;
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .explanation-content {
            font-size: 15px;
            line-height: 1.6;
        }
        
        .explanation-content strong { color: #d32f2f; }
        .vocab-list { margin: 10px 0; padding-left: 20px; }

        /* Animations */
        @keyframes slideDown {
            from { opacity: 0; transform: translateY(-10px); }
            to { opacity: 1; transform: translateY(0); }
        }

        @keyframes shake {
            0%, 100% { transform: translateX(0); }
            25% { transform: translateX(-8px) rotate(-2deg); }
            50% { transform: translateX(8px) rotate(2deg); }
            75% { transform: translateX(-8px) rotate(-2deg); }
        }
        .shake { animation: shake 0.4s ease-in-out; }

        /* Custom Confetti Elements */
        .confetti-piece {
            position: fixed;
            width: 10px;
            height: 20px;
            background-color: #f00;
            top: -20px;
            z-index: 9999;
            animation: fall linear forwards;
        }
        @keyframes fall {
            to { transform: translateY(110vh) rotate(720deg); }
        }

        /* Submit Button & Modal */
        .submit-container {
            text-align: center;
            margin: 40px 0;
        }

        .btn-submit {
            background: linear-gradient(135deg, #EF476F, #FFD166);
            color: white;
            font-size: 24px;
            font-weight: 900;
            padding: 15px 50px;
            border: none;
            border-radius: 30px;
            cursor: pointer;
            box-shadow: 0 8px 0 #c23652;
            transition: all 0.2s;
            text-transform: uppercase;
            letter-spacing: 2px;
        }
        .btn-submit:hover { transform: scale(1.05) translateY(-3px); }
        .btn-submit:active { transform: translateY(8px); box-shadow: 0 0 0 #c23652; }

        .modal-overlay {
            display: none;
            position: fixed;
            top: 0; left: 0; right: 0; bottom: 0;
            background: rgba(0,0,0,0.8);
            z-index: 1000;
            justify-content: center;
            align-items: center;
            backdrop-filter: blur(5px);
        }

        .result-card {
            background: white;
            padding: 40px;
            border-radius: 30px;
            text-align: center;
            max-width: 400px;
            width: 90%;
            box-shadow: 0 20px 50px rgba(0,0,0,0.5);
            transform: scale(0.8);
            opacity: 0;
            transition: all 0.5s cubic-bezier(0.175, 0.885, 0.32, 1.275);
        }
        .result-card.show {
            transform: scale(1);
            opacity: 1;
        }
        .result-score {
            font-size: 60px;
            font-weight: 900;
            color: var(--primary-color);
            margin: 20px 0;
        }
        .result-message {
            font-size: 22px;
            font-weight: 700;
            color: #555;
            margin-bottom: 30px;
        }
        .btn-restart {
            background: var(--primary-color);
            color: white;
            padding: 12px 30px;
            border: none;
            border-radius: 20px;
            font-size: 18px;
            font-weight: bold;
            cursor: pointer;
            box-shadow: 0 5px 0 #00796b;
        }

        /* Responsive */
        @media (max-width: 900px) {
            .main-container { flex-direction: column; overflow: auto; }
            .panel { overflow-y: visible; flex: none; height: auto; }
            .left-panel { border-right: none; border-bottom: 4px dashed rgba(0, 150, 136, 0.3); }
            body { overflow: auto; }
            .options-grid { grid-template-columns: 1fr; }
        }
    </style>
</head>
<body>

    <div class="top-bar">
        <div class="header-info">
            <h3>üë®‚Äçüè´ Gi√°o vi√™n t·∫°o: Ms Mai An ULIS</h3>
        </div>
        <div class="timer-container">
            <span class="timer-display" id="timerDisplay">10:00</span>
            <button class="btn-timer" id="timerBtn" onclick="toggleTimer()">‚ñ∂ B·∫ÆT ƒê·∫¶U T√çNH GI·ªú</button>
        </div>
    </div>

    <div class="main-container">
        
        <div class="panel left-panel">
            
            <div class="passage-card">
                <h2>üåä Passage 1: The Giant Waves</h2>
                <p>The large movement of the earth under the water causes a very large and powerful tsunami. That tsunami was called the Asian Tsunami in most of the world. It was called the Boxing Day Tsunami in England, Australia, South Africa and Canada because it happened on the holiday which they call Boxing Day. The tsunami caused a lot of damage to countries such as the Philippines, Thailand, Indonesia and Sri Lanka.</p>
                <br>
                <p>Waves as high as 30 meters killed many people and damaged or destroyed a lot of buildings and other property. Over 225,000 people died or they were not found after the tsunami. The waves traveled as far away as South Africa (8,000 kilometers) where as many as 8 people died because of high water caused by the waves. Because of how much damage was caused and the number of people the earthquake affected, over $7 billion was donated to help the survivors and rebuild the areas damaged.</p>
                
                <button class="btn-translate" onclick="toggleTranslation('trans1')">üáªüá≥ B·∫¢N D·ªäCH ƒê·∫¶Y ƒê·ª¶</button>
                <div id="trans1" class="translation-box">
                    S·ª± chuy·ªÉn ƒë·ªông l·ªõn c·ªßa tr√°i ƒë·∫•t d∆∞·ªõi m·∫∑t n∆∞·ªõc g√¢y ra m·ªôt c∆°n s√≥ng th·∫ßn r·∫•t l·ªõn v√† m·∫°nh m·∫Ω. Tr·∫≠n s√≥ng th·∫ßn ƒë√≥ ƒë∆∞·ª£c g·ªçi l√† S√≥ng th·∫ßn Ch√¢u √Å ·ªü h·∫ßu h·∫øt c√°c n∆°i tr√™n th·∫ø gi·ªõi. N√≥ ƒë∆∞·ª£c g·ªçi l√† S√≥ng th·∫ßn Ng√†y t·∫∑ng qu√† (Boxing Day) ·ªü Anh, √öc, Nam Phi v√† Canada v√¨ n√≥ x·∫£y ra v√†o ng√†y l·ªÖ m√† h·ªç g·ªçi l√† Boxing Day. S√≥ng th·∫ßn ƒë√£ g√¢y ra r·∫•t nhi·ªÅu thi·ªát h·∫°i cho c√°c qu·ªëc gia nh∆∞ Philippines, Th√°i Lan, Indonesia v√† Sri Lanka.<br><br>
                    Nh·ªØng con s√≥ng cao t·ªõi 30 m√©t ƒë√£ gi·∫øt ch·∫øt nhi·ªÅu ng∆∞·ªùi v√† l√†m h∆∞ h·ªèng ho·∫∑c ph√° h·ªßy r·∫•t nhi·ªÅu t√≤a nh√† v√† t√†i s·∫£n kh√°c. H∆°n 225.000 ng∆∞·ªùi ƒë√£ ch·∫øt ho·∫∑c kh√¥ng ƒë∆∞·ª£c t√¨m th·∫•y sau tr·∫≠n s√≥ng th·∫ßn. Nh·ªØng con s√≥ng lan xa ƒë·∫øn t·∫≠n Nam Phi (8.000 km), n∆°i c√≥ t·ªõi 8 ng∆∞·ªùi ch·∫øt do m·ª±c n∆∞·ªõc d√¢ng cao b·ªüi nh·ªØng con s√≥ng. Do m·ª©c ƒë·ªô thi·ªát h·∫°i v√† s·ªë ng∆∞·ªùi b·ªã ·∫£nh h∆∞·ªüng b·ªüi tr·∫≠n ƒë·ªông ƒë·∫•t, h∆°n 7 t·ª∑ ƒë√¥ la ƒë√£ ƒë∆∞·ª£c quy√™n g√≥p ƒë·ªÉ gi√∫p ƒë·ª° nh·ªØng ng∆∞·ªùi s·ªëng s√≥t v√† t√°i thi·∫øt nh·ªØng khu v·ª±c b·ªã t√†n ph√°.
                </div>

                <table class="glossary-table">
                    <tr><th>Vocabulary (T·ª´ v·ª±ng)</th><th>PoS (T·ª´ lo·∫°i)</th><th>Meaning (Nghƒ©a)</th></tr>
                    <tr><td>1. Movement</td><td>Noun (Danh t·ª´)</td><td>S·ª± chuy·ªÉn ƒë·ªông, s·ª± di chuy·ªÉn</td></tr>
                    <tr><td>2. Powerful</td><td>Adj (T√≠nh t·ª´)</td><td>M·∫°nh m·∫Ω, ƒë·∫ßy s·ª©c m·∫°nh</td></tr>
                    <tr><td>3. Tsunami</td><td>Noun (Danh t·ª´)</td><td>S√≥ng th·∫ßn</td></tr>
                    <tr><td>4. Damage</td><td>Noun/Verb</td><td>S·ª± thi·ªát h·∫°i / L√†m h∆∞ h·∫°i</td></tr>
                    <tr><td>5. Destroy</td><td>Verb (ƒê·ªông t·ª´)</td><td>Ph√° h·ªßy, t√†n ph√°</td></tr>
                    <tr><td>6. Property</td><td>Noun (Danh t·ª´)</td><td>T√†i s·∫£n, c·ªßa c·∫£i</td></tr>
                    <tr><td>7. Survivor</td><td>Noun (Danh t·ª´)</td><td>Ng∆∞·ªùi s·ªëng s√≥t</td></tr>
                    <tr><td>8. Rebuild</td><td>Verb (ƒê·ªông t·ª´)</td><td>T√°i thi·∫øt, x√¢y d·ª±ng l·∫°i</td></tr>
                    <tr><td>9. Donate</td><td>Verb (ƒê·ªông t·ª´)</td><td>Quy√™n g√≥p, ·ªßng h·ªô</td></tr>
                    <tr><td>10. Affect</td><td>Verb (ƒê·ªông t·ª´)</td><td>T√°c ƒë·ªông, ·∫£nh h∆∞·ªüng ƒë·∫øn</td></tr>
                </table>
            </div>

            <div class="passage-card">
                <h2>üå≤ Passage 2: The Green Lungs</h2>
                <p>Tropical forests have <span class="blank">(1)</span> us with many sorts of plants for food, <span class="blank">(2)</span> and industry. They could probably supply man more. They also reduce <span class="blank">(3)</span> and droughts, keep water clean, and slow down the Greenhouse Effect. About 20 million hectares are lost each year - an area more than twice the size of Austria. The World Wildlife Fund is working to <span class="blank">(4)</span> and save the forests that are <span class="blank">(5)</span> danger.</p>
                
                <button class="btn-translate" onclick="toggleTranslation('trans2')">üáªüá≥ B·∫¢N D·ªäCH ƒê·∫¶Y ƒê·ª¶</button>
                <div id="trans2" class="translation-box">
                    C√°c khu r·ª´ng nhi·ªát ƒë·ªõi ƒë√£ cung c·∫•p cho ch√∫ng ta nhi·ªÅu lo·∫°i th·ª±c v·∫≠t l√†m th·ª©c ƒÉn, thu·ªëc men v√† c√¥ng nghi·ªáp. Ch√∫ng c√≥ th·ªÉ s·∫Ω c√≤n cung c·∫•p cho con ng∆∞·ªùi nhi·ªÅu h∆°n th·∫ø n·ªØa. Ch√∫ng c≈©ng l√†m gi·∫£m l≈© l·ª•t v√† h·∫°n h√°n, gi·ªØ cho ngu·ªìn n∆∞·ªõc trong s·∫°ch v√† l√†m ch·∫≠m Hi·ªáu ·ª©ng Nh√† k√≠nh. Kho·∫£ng 20 tri·ªáu ha r·ª´ng b·ªã m·∫•t ƒëi m·ªói nƒÉm - m·ªôt di·ªán t√≠ch l·ªõn h∆°n g·∫•p ƒë√¥i k√≠ch th∆∞·ªõc c·ªßa n∆∞·ªõc √Åo. Qu·ªπ ƒê·ªông v·∫≠t Hoang d√£ Th·∫ø gi·ªõi ƒëang n·ªó l·ª±c ƒë·ªÉ b·∫£o v·ªá v√† c·ª©u nh·ªØng khu r·ª´ng ƒëang g·∫∑p nguy hi·ªÉm.
                </div>

                <table class="glossary-table">
                    <tr><th>Vocabulary (T·ª´ v·ª±ng)</th><th>PoS (T·ª´ lo·∫°i)</th><th>Meaning (Nghƒ©a)</th></tr>
                    <tr><td>1. Tropical forest</td><td>Noun phrase</td><td>R·ª´ng nhi·ªát ƒë·ªõi</td></tr>
                    <tr><td>2. Supply</td><td>Verb (ƒê·ªông t·ª´)</td><td>Cung c·∫•p, ƒë√°p ·ª©ng</td></tr>
                    <tr><td>3. Medicine</td><td>Noun (Danh t·ª´)</td><td>Thu·ªëc men, y h·ªçc</td></tr>
                    <tr><td>4. Industry</td><td>Noun (Danh t·ª´)</td><td>C√¥ng nghi·ªáp, ng√†nh ngh·ªÅ</td></tr>
                    <tr><td>5. Reduce</td><td>Verb (ƒê·ªông t·ª´)</td><td>L√†m gi·∫£m b·ªõt, h·∫° th·∫•p</td></tr>
                    <tr><td>6. Flood</td><td>Noun (Danh t·ª´)</td><td>L≈© l·ª•t</td></tr>
                    <tr><td>7. Drought</td><td>Noun (Danh t·ª´)</td><td>H·∫°n h√°n</td></tr>
                    <tr><td>8. Greenhouse Effect</td><td>Noun phrase</td><td>Hi·ªáu ·ª©ng nh√† k√≠nh</td></tr>
                    <tr><td>9. Protect</td><td>Verb (ƒê·ªông t·ª´)</td><td>B·∫£o v·ªá, che ch·ªü</td></tr>
                    <tr><td>10. Danger</td><td>Noun (Danh t·ª´)</td><td>S·ª± nguy hi·ªÉm, m·ªëi ƒëe d·ªça</td></tr>
                </table>
            </div>

        </div>

        <div class="panel right-panel" id="quizContainer">
            <div class="submit-container">
                <button class="btn-submit" onclick="submitQuiz()">üöÄ N·ªòP B√ÄI</button>
            </div>
        </div>

    </div>

    <div class="modal-overlay" id="resultModal">
        <div class="result-card" id="resultCard">
            <h2 style="font-size:30px">üéâ K·∫æT QU·∫¢ C·ª¶A B·∫†N üéâ</h2>
            <div class="result-score" id="scoreDisplay">0/10</div>
            <div class="result-message" id="scoreMessage">Tuy·ªát v·ªùi!</div>
            <button class="btn-restart" onclick="location.reload()">üîÑ L√ÄM L·∫†I B√ÄI</button>
        </div>
    </div>

    <script>
        // --- TIMER LOGIC ---
        let timeLeft = 600; // 10 minutes
        let timerInterval;
        let isRunning = false;

        function updateTimerDisplay() {
            let m = Math.floor(timeLeft / 60).toString().padStart(2, '0');
            let s = (timeLeft % 60).toString().padStart(2, '0');
            document.getElementById('timerDisplay').innerText = `${m}:${s}`;
        }

        function toggleTimer() {
            let btn = document.getElementById('timerBtn');
            if (isRunning) {
                clearInterval(timerInterval);
                btn.innerText = "‚ñ∂ TI·∫æP T·ª§C";
                btn.style.background = "#FFD166";
            } else {
                btn.innerText = "‚è∏ T·∫†M D·ª™NG";
                btn.style.background = "#FF9F1C";
                timerInterval = setInterval(() => {
                    timeLeft--;
                    updateTimerDisplay();
                    if (timeLeft <= 0) {
                        clearInterval(timerInterval);
                        alert("‚è∞ ƒê√£ h·∫øt gi·ªù l√†m b√†i. B·∫°n v·∫´n c√≥ th·ªÉ ti·∫øp t·ª•c l√†m, nh∆∞ng nh·ªõ l√† trong ph√≤ng thi th·∫≠t, b·∫°n ch·ªâ n√™n l√†m m·ªôt b√†i nh∆∞ th·∫ø n√†y trong 10 ph√∫t th√¥i nha.");
                    }
                }, 1000);
            }
            isRunning = !isRunning;
        }

        // --- TRANSLATION TOGGLE ---
        function toggleTranslation(id) {
            let el = document.getElementById(id);
            if(el.style.display === 'block') {
                el.style.display = 'none';
            } else {
                el.style.display = 'block';
                el.scrollIntoView({ behavior: 'smooth', block: 'nearest' });
            }
        }

        // --- AUDIO SYNTHESIS (No external links) ---
        const audioCtx = new (window.AudioContext || window.webkitAudioContext)();
        
        function playDing() {
            if (audioCtx.state === 'suspended') audioCtx.resume();
            const osc = audioCtx.createOscillator();
            const gain = audioCtx.createGain();
            osc.connect(gain);
            gain.connect(audioCtx.destination);
            osc.type = 'sine';
            osc.frequency.setValueAtTime(800, audioCtx.currentTime);
            osc.frequency.exponentialRampToValueAtTime(1200, audioCtx.currentTime + 0.1);
            gain.gain.setValueAtTime(0.5, audioCtx.currentTime);
            gain.gain.exponentialRampToValueAtTime(0.01, audioCtx.currentTime + 0.5);
            osc.start();
            osc.stop(audioCtx.currentTime + 0.5);
        }

        function playBuzzer() {
            if (audioCtx.state === 'suspended') audioCtx.resume();
            const osc = audioCtx.createOscillator();
            const gain = audioCtx.createGain();
            osc.connect(gain);
            gain.connect(audioCtx.destination);
            osc.type = 'sawtooth';
            // Sound: "t√©o t√®o t√®o t√®o" (descending pitch)
            osc.frequency.setValueAtTime(300, audioCtx.currentTime);
            osc.frequency.exponentialRampToValueAtTime(100, audioCtx.currentTime + 0.6);
            gain.gain.setValueAtTime(0.3, audioCtx.currentTime);
            gain.gain.exponentialRampToValueAtTime(0.01, audioCtx.currentTime + 0.6);
            osc.start();
            osc.stop(audioCtx.currentTime + 0.6);
        }

        // --- CUSTOM CONFETTI ---
        function shootConfetti() {
            const colors = ['#FF4757', '#2ED573', '#1E90FF', '#FFA502', '#FF6348'];
            for(let i=0; i<40; i++) {
                let conf = document.createElement('div');
                conf.className = 'confetti-piece';
                conf.style.left = (Math.random() * 100) + 'vw';
                conf.style.backgroundColor = colors[Math.floor(Math.random() * colors.length)];
                conf.style.animationDuration = (Math.random() * 2 + 1.5) + 's';
                conf.style.transform = `rotate(${Math.random() * 360}deg)`;
                document.body.appendChild(conf);
                setTimeout(() => conf.remove(), 3500);
            }
        }

        // --- QUIZ DATA & LOGIC ---
        const quizData = [
            // PASSAGE 1
            {
                qText: "1. Why was the tsunami called the Boxing Day Tsunami in England?",
                options: [
                    "Because it happened when people were boxing.",
                    "Because it happened when people were collecting boxes.",
                    "Because it happened on Boxing Day.",
                    "Because it destroyed a lot of boxes."
                ],
                correctAnswer: "Because it happened on Boxing Day.",
                explanation: `
                    <ul class="vocab-list">
                        <li><strong>boxing</strong>: ƒë·∫•m b·ªëc</li>
                        <li><strong>collecting boxes</strong>: thu th·∫≠p h·ªôp</li>
                        <li><strong>Boxing Day</strong>: Ng√†y l·ªÖ t·∫∑ng qu√† (sau Gi√°ng Sinh)</li>
                    </ul>
                    <p><strong>D·ªãch c√¢u h·ªèi:</strong> T·∫°i sao s√≥ng th·∫ßn l·∫°i ƒë∆∞·ª£c g·ªçi l√† S√≥ng th·∫ßn Boxing Day ·ªü Anh?</p>
                    <p><strong>Gi·∫£i th√≠ch:</strong> H√£y nh√¨n v√†o ƒëo·∫°n 1, d√≤ng 2-3: <em>"It was called the Boxing Day Tsunami in England... <strong>because it happened on the holiday which they call Boxing Day.</strong>"</em> (N√≥ x·∫£y ra v√†o ƒë√∫ng ng√†y l·ªÖ t√™n l√† Boxing Day).</p>
                    <p>=> Do ƒë√≥, ch·ªçn ƒë√°p √°n ch·ª©a th√¥ng tin n√†y!</p>
                `
            },
            {
                qText: "2. How high were the waves?",
                options: ["thirteen meters", "eighteen meters", "thirty meters", "two hundred meters"],
                correctAnswer: "thirty meters",
                explanation: `
                    <p><strong>D·ªãch c√¢u h·ªèi:</strong> Nh·ªØng con s√≥ng cao bao nhi√™u?</p>
                    <p><strong>Ph√¢n t√≠ch t·ª´ v·ª±ng s·ªë ƒë·∫øm:</strong> thirteen (13), eighteen (18), thirty (30), two hundred (200).</p>
                    <p><strong>Gi·∫£i th√≠ch:</strong> Nh√¨n ngay c√¢u ƒë·∫ßu ti√™n c·ªßa ƒëo·∫°n 2: <em>"Waves as high as <strong>30 meters</strong> killed many people..."</em> (Nh·ªØng con s√≥ng cao t·ªõi 30 m√©t...).</p>
                    <p>=> 30 ƒë·ªçc l√† "thirty", v·∫≠y ƒë√°p √°n ƒë√∫ng l√† <strong>thirty meters</strong> nh√©!</p>
                `
            },
            {
                qText: "3. What were some people in South Africa killed by?",
                options: ["earthquake", "high water", "high wind", "volcano"],
                correctAnswer: "high water",
                explanation: `
                    <ul class="vocab-list">
                        <li><strong>earthquake</strong> (n): ƒë·ªông ƒë·∫•t</li>
                        <li><strong>high water</strong> (n): m·ª±c n∆∞·ªõc d√¢ng cao</li>
                        <li><strong>high wind</strong> (n): gi√≥ l·ªõn</li>
                        <li><strong>volcano</strong> (n): n√∫i l·ª≠a</li>
                    </ul>
                    <p><strong>D·ªãch c√¢u h·ªèi:</strong> M·ªôt s·ªë ng∆∞·ªùi ·ªü Nam Phi b·ªã gi·∫øt b·ªüi c√°i g√¨?</p>
                    <p><strong>Gi·∫£i th√≠ch:</strong> T√¨m t·ª´ kh√≥a "South Africa". ·ªû ƒëo·∫°n 2: <em>"...as far away as South Africa (8,000 kilometers) where as many as 8 people died <strong>because of high water</strong> caused by the waves."</em> (8 ng∆∞·ªùi ch·∫øt v√¨ m·ª±c n∆∞·ªõc d√¢ng cao do s√≥ng).</p>
                `
            },
            {
                qText: "4. Which of the following sentences is NOT true?",
                options: [
                    "Only in Asia the tsunami was called the Asian Tsunami.",
                    "The tsunami caused a lot of damage to Indonesia.",
                    "Many people died because of the high waves.",
                    "A lot of money was raised to help people."
                ],
                correctAnswer: "Only in Asia the tsunami was called the Asian Tsunami.",
                explanation: `
                    <p><strong>D·ªãch c√¢u h·ªèi:</strong> C√¢u n√†o d∆∞·ªõi ƒë√¢y KH√îNG ƒë√∫ng (NOT true)?</p>
                    <p><strong>Gi·∫£i th√≠ch chi ti·∫øt:</strong> D·∫°ng b√†i n√†y ta ph·∫£i ki·ªÉm tra t·ª´ng c√¢u:</p>
                    <ul class="vocab-list">
                        <li>C√¢u sai l√† "Only in Asia..." (Ch·ªâ ·ªü Ch√¢u √Å n√≥ m·ªõi ƒë∆∞·ª£c g·ªçi l√† S√≥ng th·∫ßn Ch√¢u √Å). <strong>T·∫°i sao sai?</strong> V√¨ trong b√†i vi·∫øt: <em>"That tsunami was called the Asian Tsunami in <strong>most of the world</strong>."</em> (h·∫ßu h·∫øt th·∫ø gi·ªõi ƒë·ªÅu g·ªçi th·∫ø, ch·ª© kh√¥ng ph·∫£i ch·ªâ ri√™ng ·ªü Ch√¢u √Å).</li>
                        <li>C√°c th√¥ng tin c√≤n l·∫°i ƒë·ªÅu c√≥ trong b√†i: g√¢y thi·ªát h·∫°i cho Indonesia, nhi·ªÅu ng∆∞·ªùi ch·∫øt v√¨ s√≥ng cao, v√† r·∫•t nhi·ªÅu ti·ªÅn ($7 billion) ƒë∆∞·ª£c quy√™n g√≥p.</li>
                    </ul>
                `
            },
            {
                qText: "5. What does the word ‚Äúsurvivors‚Äù in the last sentence mean?",
                options: [
                    "Houses that aren‚Äôt destroyed.",
                    "Offices are being rebuilt.",
                    "People who were dead.",
                    "People who are left alive."
                ],
                correctAnswer: "People who are left alive.",
                explanation: `
                    <p><strong>D·ªãch c√¢u h·ªèi:</strong> T·ª´ "survivors" ·ªü c√¢u cu·ªëi nghƒ©a l√† g√¨?</p>
                    <p><strong>Ph√¢n t√≠ch:</strong></p>
                    <ul class="vocab-list">
                        <li>"survive" (ƒë·ªông t·ª´) l√† s·ªëng s√≥t. Th√™m ƒëu√¥i "-or" ch·ªâ ng∆∞·ªùi -> "survivors" l√† nh·ªØng ng∆∞·ªùi s·ªëng s√≥t.</li>
                        <li>Ng·ªØ c·∫£nh: <em>"...donated to help the survivors"</em> (quy√™n g√≥p ti·ªÅn ƒë·ªÉ gi√∫p ƒë·ª° nh·ªØng ____). Ch·∫Øc ch·∫Øn l√† gi√∫p ƒë·ª° <strong>nh·ªØng ng∆∞·ªùi c√≤n s·ªëng</strong> (People who are left alive). Kh√¥ng th·ªÉ l√† ng∆∞·ªùi ƒë√£ ch·∫øt (dead) hay ng√¥i nh√† (houses).</li>
                    </ul>
                `
            },
            // PASSAGE 2 (Cloze Test)
            {
                qText: "Cloze 1. Tropical forests have (1) _______ us with many sorts of plants...",
                options: ["given", "brought", "supplied", "donated"],
                correctAnswer: "supplied",
                explanation: `
                    <ul class="vocab-list">
                        <li><strong>give</strong> sb sth / give sth <strong>to</strong> sb: cho ai c√°i g√¨</li>
                        <li><strong>bring</strong> sth <strong>to</strong> sb: mang c√°i g√¨ cho ai</li>
                        <li><strong>supply</strong> sb <strong>with</strong> sth: cung c·∫•p cho ai c√°i g√¨</li>
                    </ul>
                    <p><strong>Gi·∫£i th√≠ch:</strong> Nh√¨n v√†o ch·ªó tr·ªëng, ƒë·∫±ng sau c√≥ gi·ªõi t·ª´ <strong>"with"</strong> (<em>_____ us <strong>with</strong> many sorts...</em>). Do ƒë√≥, ch·ªâ c√≥ ƒë·ªông t·ª´ <strong>supplied</strong> l√† ph√π h·ª£p ƒë√∫ng c·∫•u tr√∫c ng·ªØ ph√°p!</p>
                `
            },
            {
                qText: "Cloze 2. ...plants for food, (2) _______ and industry.",
                options: ["medicine", "hospitals", "doctors", "surgeons"],
                correctAnswer: "medicine",
                explanation: `
                    <ul class="vocab-list">
                        <li><strong>medicine</strong> (n): thu·ªëc men, y h·ªçc</li>
                        <li><strong>hospitals</strong> (n): b·ªánh vi·ªán</li>
                        <li><strong>doctors / surgeons</strong> (n): b√°c sƒ© / b√°c sƒ© ph·∫´u thu·∫≠t</li>
                    </ul>
                    <p><strong>Gi·∫£i th√≠ch:</strong> Th·ª±c v·∫≠t cung c·∫•p cho ch√∫ng ta "th·ª©c ƒÉn, [___] v√† c√¥ng nghi·ªáp". V·ªÅ m·∫∑t logic, th·ª±c v·∫≠t (th·∫£o d∆∞·ª£c) ƒë∆∞·ª£c d√πng ƒë·ªÉ l√†m <strong>thu·ªëc men (medicine)</strong>, ch·ª© kh√¥ng th·ªÉ cung c·∫•p ra b√°c sƒ© hay b·ªánh vi·ªán ƒë∆∞·ª£c!</p>
                `
            },
            {
                qText: "Cloze 3. They also reduce (3) ___________ and droughts...",
                options: ["deserts", "floods", "heat", "hazards"],
                correctAnswer: "floods",
                explanation: `
                    <ul class="vocab-list">
                        <li><strong>deserts</strong> (n): sa m·∫°c</li>
                        <li><strong>floods</strong> (n): l≈© l·ª•t</li>
                        <li><strong>heat</strong> (n): s·ª©c n√≥ng</li>
                        <li><strong>hazards</strong> (n): m·ªëi nguy hi·ªÉm</li>
                    </ul>
                    <p><strong>Gi·∫£i th√≠ch:</strong> R·ª´ng gi√∫p l√†m gi·∫£m ____ v√† h·∫°n h√°n (droughts). Trong ti·∫øng Anh, <strong>floods and droughts</strong> (L≈© l·ª•t v√† h·∫°n h√°n) l√† m·ªôt c·∫∑p t·ª´ v·ª±ng hay ƒëi li·ªÅn v·ªõi nhau khi n√≥i v·ªÅ thi√™n tai li√™n quan ƒë·∫øn n∆∞·ªõc. R·ª´ng gi·ªØ n∆∞·ªõc l√†m gi·∫£m c·∫£ hai hi·ªán t∆∞·ª£ng n√†y.</p>
                `
            },
            {
                qText: "Cloze 4. The World Wildlife Fund is working to (4) ______ and save the forests...",
                options: ["keep", "protect", "maintain", "hold"],
                correctAnswer: "protect",
                explanation: `
                    <p><strong>D·ªãch:</strong> Qu·ªπ ƒê·ªông v·∫≠t Hoang d√£ ƒëang n·ªó l·ª±c ƒë·ªÉ [___] v√† c·ª©u nh·ªØng khu r·ª´ng...</p>
                    <ul class="vocab-list">
                        <li><strong>keep</strong>: gi·ªØ</li>
                        <li><strong>protect</strong>: b·∫£o v·ªá</li>
                        <li><strong>maintain</strong>: duy tr√¨</li>
                        <li><strong>hold</strong>: c·∫ßm, n·∫Øm</li>
                    </ul>
                    <p><strong>Gi·∫£i th√≠ch:</strong> ƒêi ƒë√¥i v·ªõi t·ª´ "save" (c·ª©u/b·∫£o t·ªìn) th√¨ <strong>"protect" (b·∫£o v·ªá)</strong> l√† t·ª´ mang s·∫Øc th√°i nghƒ©a ho√†n h·∫£o v√† ph√π h·ª£p nh·∫•t trong ch·ªß ƒë·ªÅ M√¥i tr∆∞·ªùng.</p>
                `
            },
            {
                qText: "Cloze 5. ...save the forests that are (5) _____ danger.",
                options: ["at", "within", "on", "in"],
                correctAnswer: "in",
                explanation: `
                    <p><strong>Ph√¢n t√≠ch ng·ªØ ph√°p:</strong></p>
                    <p>ƒê√¢y l√† c√¢u ki·ªÉm tra v·ªÅ c·ª•m gi·ªõi t·ª´ c·ªë ƒë·ªãnh (Collocation / Idiom). ƒê·ªÉ di·ªÖn ƒë·∫°t "ƒëang g·∫∑p nguy hi·ªÉm", ch√∫ng ta c√≥ c·∫•u tr√∫c c·ªë ƒë·ªãnh l√†: <strong>be IN danger</strong>.</p>
                    <p>=> Kh√¥ng d√πng at, within hay on danger nh√©. ƒê√°p √°n duy nh·∫•t ƒë√∫ng l√† <strong>IN</strong>.</p>
                `
            }
        ];

        let score = 0;
        let answeredQuestions = 0;

        // Shuffle utility
        function shuffleArray(array) {
            for (let i = array.length - 1; i > 0; i--) {
                const j = Math.floor(Math.random() * (i + 1));
                [array[i], array[j]] = [array[j], array[i]];
            }
            return array;
        }

        // Render Quiz
        const quizContainer = document.getElementById('quizContainer');
        const submitBtnContainer = document.querySelector('.submit-container');

        quizData.forEach((q, index) => {
            // Create Card
            const card = document.createElement('div');
            card.className = 'question-card';
            card.id = `qCard_${index}`;

            // Question Text
            const qTitle = document.createElement('div');
            qTitle.className = 'question-text';
            qTitle.innerText = q.qText;
            card.appendChild(qTitle);

            // Options Grid
            const grid = document.createElement('div');
            grid.className = 'options-grid';

            // Shuffle options
            let shuffledOptions = shuffleArray([...q.options]);

            shuffledOptions.forEach((optText) => {
                const btn = document.createElement('button');
                btn.className = 'option-btn';
                // Prefix with circle for UI
                btn.innerHTML = `<span style="margin-right:10px; opacity:0.5;">‚óè</span> ${optText}`;
                
                btn.onclick = () => handleAnswer(btn, optText, q.correctAnswer, index, grid, q.explanation);
                grid.appendChild(btn);
            });

            card.appendChild(grid);

            // Explanation Box (Hidden initially)
            const expBox = document.createElement('div');
            expBox.className = 'explanation-box';
            expBox.id = `exp_${index}`;
            expBox.innerHTML = `<h4>üí° Gi·∫£i th√≠ch chi ti·∫øt t·ª´ C√¥ Mai An:</h4><div class="explanation-content">${q.explanation}</div>`;
            card.appendChild(expBox);

            quizContainer.insertBefore(card, submitBtnContainer);
        });

        // Handle Answer Click
        function handleAnswer(clickedBtn, selectedText, correctText, qIndex, gridElement, expHtml) {
            // Disable all buttons in this grid
            const allBtns = gridElement.querySelectorAll('.option-btn');
            allBtns.forEach(b => {
                b.classList.add('disabled');
                b.onclick = null; // Remove event listener
            });

            const isCorrect = (selectedText === correctText);
            
            if (isCorrect) {
                clickedBtn.classList.add('correct');
                playDing();
                shootConfetti();
                score++;
            } else {
                clickedBtn.classList.add('wrong');
                // Find and highlight correct answer
                allBtns.forEach(b => {
                    if (b.innerText.replace('‚óè ', '').trim() === correctText) {
                        b.classList.add('correct');
                    }
                });
                playBuzzer();
                document.getElementById(`qCard_${qIndex}`).classList.add('shake');
            }

            // Show explanation
            document.getElementById(`exp_${qIndex}`).style.display = 'block';
            answeredQuestions++;
        }

        // Submit Logic
        function submitQuiz() {
            if (answeredQuestions < quizData.length) {
                if(!confirm(`B·∫°n m·ªõi l√†m ${answeredQuestions}/${quizData.length} c√¢u. B·∫°n c√≥ ch·∫Øc ch·∫Øn mu·ªën n·ªôp b√†i kh√¥ng?`)) {
                    return;
                }
            }

            // Pause timer
            if(isRunning) toggleTimer();

            // Setup Modal
            const modal = document.getElementById('resultModal');
            const card = document.getElementById('resultCard');
            const scoreDisplay = document.getElementById('scoreDisplay');
            const scoreMessage = document.getElementById('scoreMessage');

            scoreDisplay.innerText = `${score} / ${quizData.length}`;
            
            let msg = "";
            let percent = score / quizData.length;
            if (percent === 1) msg = "üèÜ THI√äN T√ÄI XU·∫§T CH√öNG! ƒêi·ªÉm tuy·ªát ƒë·ªëi lu√¥n!";
            else if (percent >= 0.8) msg = "üåü R·∫•t Xu·∫•t S·∫Øc! L√†m t·ªët l·∫Øm nh√©!";
            else if (percent >= 0.5) msg = "üëç Kh√° l·∫Øm! H√£y xem l·∫°i ph·∫ßn gi·∫£i th√≠ch ƒë·ªÉ gi·ªèi h∆°n nha!";
            else msg = "üí™ ƒê·ª´ng bu·ªìn! Th·∫•t b·∫°i l√† m·∫π th√†nh c√¥ng, xem k·ªπ gi·∫£i th√≠ch v√† l√†m l·∫°i nh√©!";

            scoreMessage.innerText = msg;
            
            modal.style.display = 'flex';
            setTimeout(() => {
                card.classList.add('show');
                if(percent >= 0.5) shootConfetti();
            }, 100);
        }
    </script>
</body>
</html>