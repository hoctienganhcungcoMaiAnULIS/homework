<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Ms Mai An ULIS - Luy·ªán t·∫≠p chuy√™n s√¢u ED/ING</title>
    <!-- Google Fonts -->
    <link href="https://fonts.googleapis.com/css2?family=Nunito:wght@400;600;700;800&family=Quicksand:wght@500;700&display=swap" rel="stylesheet">
    <!-- FontAwesome for Icons -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
    
    <style>
        :root {
            --primary: #8854C0; /* T√≠m h·ªìng */
            --secondary: #00C9A7; /* Xanh ng·ªçc */
            --correct: #00D26A; /* Xanh l√° */
            --wrong: #FF4757; /* ƒê·ªè cam */
            --background: #f0f4f8;
            --card-bg: #ffffff;
            --text-main: #2f3542;
        }

        body {
            font-family: 'Nunito', sans-serif;
            background-color: #E0EAFC;
            background-image: radial-gradient(#8854C0 1px, transparent 1px), radial-gradient(#00C9A7 1px, transparent 1px);
            background-size: 40px 40px;
            background-position: 0 0, 20px 20px;
            color: var(--text-main);
            margin: 0;
            padding: 20px;
            min-height: 100vh;
        }

        .container {
            max-width: 800px;
            margin: 0 auto;
            position: relative;
        }

        /* Header Styles */
        header {
            text-align: center;
            margin-bottom: 40px;
            background: white;
            padding: 20px;
            border-radius: 20px;
            box-shadow: 0 10px 0 rgba(0,0,0,0.1);
            border: 4px solid var(--primary);
            position: relative;
            overflow: hidden;
        }

        h1 {
            color: var(--primary);
            font-family: 'Quicksand', sans-serif;
            font-weight: 800;
            margin: 0;
            font-size: 2rem;
            text-transform: uppercase;
            letter-spacing: 1px;
        }

        .sub-header {
            color: #57606f;
            font-weight: 600;
            margin-top: 10px;
        }

        /* Score Board */
        .score-board {
            position: fixed;
            top: 20px;
            right: 20px;
            background: var(--secondary);
            color: white;
            padding: 15px 25px;
            border-radius: 50px;
            font-weight: 800;
            font-size: 1.2rem;
            box-shadow: 0 5px 0 #009e82;
            z-index: 1000;
            animation: popIn 0.5s cubic-bezier(0.175, 0.885, 0.32, 1.275);
        }

        /* Question Card */
        .quiz-card {
            background: var(--card-bg);
            border-radius: 25px;
            padding: 30px;
            margin-bottom: 30px;
            box-shadow: 0 8px 20px rgba(136, 84, 192, 0.15);
            transition: transform 0.3s ease;
            position: relative;
            border: 3px solid transparent;
        }

        .quiz-card:hover {
            transform: translateY(-5px);
        }

        .question-number {
            display: inline-block;
            background: var(--primary);
            color: white;
            padding: 5px 15px;
            border-radius: 15px;
            font-weight: 700;
            font-size: 0.9rem;
            margin-bottom: 15px;
        }

        .question-text {
            font-size: 1.3rem;
            font-weight: 700;
            color: #2f3542;
            margin-bottom: 25px;
            line-height: 1.5;
        }

        /* Options Grid */
        .options-grid {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 15px;
        }

        @media (max-width: 600px) {
            .options-grid {
                grid-template-columns: 1fr;
            }
        }

        .option-btn {
            background: white;
            border: 2px solid #e1e1e1;
            border-radius: 15px;
            padding: 15px 20px;
            font-family: 'Nunito', sans-serif;
            font-size: 1.1rem;
            font-weight: 600;
            color: #57606f;
            cursor: pointer;
            transition: all 0.2s;
            text-align: left;
            position: relative;
            box-shadow: 0 5px 0 #d1d1d1;
            transform: translateY(0);
            display: flex;
            align-items: center;
        }

        .option-btn:hover:not(:disabled) {
            transform: translateY(-2px);
            border-color: var(--primary);
            color: var(--primary);
            box-shadow: 0 7px 0 #d1d1d1;
        }

        .option-btn:active:not(:disabled) {
            transform: translateY(5px);
            box-shadow: none;
        }

        .option-btn:disabled {
            cursor: default;
            transform: translateY(5px);
            box-shadow: none;
            opacity: 0.7;
        }

        /* States */
        .option-btn.correct {
            background-color: var(--correct) !important;
            color: white !important;
            border-color: var(--correct) !important;
            box-shadow: none !important;
        }

        .option-btn.wrong {
            background-color: var(--wrong) !important;
            color: white !important;
            border-color: var(--wrong) !important;
            box-shadow: none !important;
            animation: shake 0.5s;
        }

        .option-label {
            width: 30px;
            height: 30px;
            background: #f1f2f6;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            margin-right: 15px;
            font-weight: 800;
            font-size: 0.9rem;
            color: #a4b0be;
        }

        .option-btn.correct .option-label, 
        .option-btn.wrong .option-label {
            background: rgba(255,255,255,0.3);
            color: white;
        }

        /* Detailed Explanation Box */
        .explanation-box {
            margin-top: 25px;
            background: #f8f9fa;
            border-left: 5px solid var(--secondary);
            border-radius: 0 15px 15px 0;
            padding: 20px;
            display: none; /* Hidden by default */
            animation: slideDown 0.4s ease-out;
        }

        .explanation-header {
            font-weight: 800;
            color: var(--primary);
            margin-bottom: 10px;
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .expl-section {
            margin-bottom: 12px;
        }

        .expl-title {
            font-weight: 700;
            color: #2f3542;
            font-size: 0.95rem;
            text-decoration: underline;
            text-decoration-color: var(--secondary);
            margin-bottom: 5px;
            display: block;
        }

        .expl-content {
            font-size: 0.95rem;
            color: #57606f;
            line-height: 1.6;
        }

        .vocab-item {
            display: block;
            margin-bottom: 4px;
        }

        .vocab-highlight {
            font-weight: 700;
            color: var(--primary);
        }

        /* Animations */
        @keyframes shake {
            0% { transform: translateX(0); }
            25% { transform: translateX(-10px); }
            50% { transform: translateX(10px); }
            75% { transform: translateX(-10px); }
            100% { transform: translateX(0); }
        }

        @keyframes popIn {
            0% { transform: scale(0); opacity: 0; }
            100% { transform: scale(1); opacity: 1; }
        }

        @keyframes slideDown {
            from { opacity: 0; transform: translateY(-10px); }
            to { opacity: 1; transform: translateY(0); }
        }

        /* Submit Section */
        .submit-section {
            text-align: center;
            margin-top: 50px;
            margin-bottom: 50px;
        }

        .finish-btn {
            background: var(--primary);
            color: white;
            border: none;
            padding: 20px 60px;
            font-size: 1.5rem;
            font-family: 'Quicksand', sans-serif;
            font-weight: 800;
            border-radius: 50px;
            cursor: pointer;
            box-shadow: 0 10px 0 #6c429c;
            transition: transform 0.2s;
        }

        .finish-btn:active {
            transform: translateY(10px);
            box-shadow: none;
        }

        /* Modal */
        .modal-overlay {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0,0,0,0.5);
            display: none;
            justify-content: center;
            align-items: center;
            z-index: 2000;
        }

        .result-card {
            background: white;
            padding: 40px;
            border-radius: 30px;
            text-align: center;
            max-width: 500px;
            width: 90%;
            animation: popIn 0.5s;
            position: relative;
            overflow: hidden;
        }

        .result-score {
            font-size: 4rem;
            font-weight: 800;
            color: var(--secondary);
            margin: 20px 0;
        }

        .result-message {
            font-size: 1.2rem;
            color: #57606f;
            margin-bottom: 30px;
        }

        .close-btn {
            background: #ff4757;
            color: white;
            border: none;
            padding: 10px 30px;
            border-radius: 20px;
            font-weight: 700;
            cursor: pointer;
            box-shadow: 0 5px 0 #d63031;
        }

        /* Canvas Confetti */
        #confetti-canvas {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            pointer-events: none;
            z-index: 9999;
        }

    </style>
</head>
<body>

    <div class="score-board">
        <i class="fas fa-star" style="color: #f1c40f;"></i> <span id="current-score">0</span>/30
    </div>

    <div class="container">
        <header>
            <h1>Ms Mai An ULIS</h1>
            <div class="sub-header">Luy·ªán t·∫≠p chuy√™n s√¢u: T√≠nh t·ª´ ƒëu√¥i -ED v√† -ING</div>
            <div style="margin-top:10px; font-size: 0.9rem; color: #888;">
                <i class="fas fa-info-circle"></i> Ch·ªçn ƒë√°p √°n ƒë√∫ng ƒë·ªÉ xem gi·∫£i th√≠ch chi ti·∫øt ngay l·∫≠p t·ª©c!
            </div>
        </header>

        <div id="quiz-container">
            <!-- Questions will be injected here by JavaScript -->
        </div>

        <div class="submit-section">
            <button class="finish-btn" onclick="showFinalResult()">
                <i class="fas fa-flag-checkered"></i> N·ªòP B√ÄI
            </button>
        </div>
    </div>

    <!-- Result Modal -->
    <div class="modal-overlay" id="resultModal">
        <div class="result-card">
            <h2>K·∫øt Qu·∫£ C·ªßa B·∫°n</h2>
            <div class="result-score" id="final-score">0/30</div>
            <p class="result-message" id="final-message">B·∫°n l√†m t·ªët l·∫Øm!</p>
            <button class="close-btn" onclick="closeModal()">ƒê√≥ng</button>
        </div>
    </div>

    <canvas id="confetti-canvas"></canvas>

    <script>
        // DATA NGU·ªíN (30 C√¢u h·ªèi t·ª´ ƒë·ªÅ b√†i)
        const quizData = [
            {
                q: 1,
                text: "The film was long and ______, so I went home early.",
                options: ["bored", "boring", "bore", "boredom"],
                correct: 1, // Index of "boring" (0, 1, 2, 3)
                trans: "B·ªô phim d√†i v√† t·∫ª nh·∫°t, n√™n t√¥i v·ªÅ s·ªõm.",
                analysis: [
                    "bored (adj): c·∫£m th·∫•y ch√°n (d√πng cho ng∆∞·ªùi)",
                    "boring (adj): t·∫ª nh·∫°t (d√πng cho v·∫≠t/s·ª± vi·ªác)",
                    "bore (v): l√†m ch√°n",
                    "boredom (n): s·ª± ch√°n n·∫£n"
                ],
                why: "Ch·ªß ng·ªØ l√† 'The film' (v·∫≠t) -> c·∫ßn t√≠nh t·ª´ ch·ªâ ƒë·∫∑c ƒëi·ªÉm (-ING)."
            },
            {
                q: 2,
                text: "I was really ______ by the horror movie.",
                options: ["terrifying", "terrified", "terrify", "terror"],
                correct: 1,
                trans: "T√¥i th·ª±c s·ª± khi·∫øp s·ª£ b·ªüi b·ªô phim kinh d·ªã.",
                analysis: [
                    "terrifying (adj): g√¢y khi·∫øp s·ª£",
                    "terrified (adj): c·∫£m th·∫•y khi·∫øp s·ª£",
                    "terrify (v): l√†m khi·∫øp s·ª£",
                    "terror (n): n·ªói kinh ho√†ng"
                ],
                why: "Ch·ªß ng·ªØ 'I' (ng∆∞·ªùi) c·∫£m nh·∫≠n n·ªói s·ª£ -> d√πng t√≠nh t·ª´ ƒëu√¥i -ED."
            },
            {
                q: 3,
                text: "We were ______ to hear that our favorite actor is coming to town.",
                options: ["exciting", "excited", "excite", "excitement"],
                correct: 1,
                trans: "Ch√∫ng t√¥i r·∫•t ph·∫•n kh√≠ch khi nghe tin di·ªÖn vi√™n y√™u th√≠ch s·∫Øp ƒë·∫øn th·ªã tr·∫•n.",
                analysis: [
                    "exciting (adj): th√∫ v·ªã (ƒë·∫∑c ƒëi·ªÉm)",
                    "excited (adj): h√†o h·ª©ng, ph·∫•n kh√≠ch (c·∫£m x√∫c)",
                    "excite (v): l√†m h√†o h·ª©ng",
                    "excitement (n): s·ª± h√†o h·ª©ng"
                ],
                why: "Ch·ªß ng·ªØ 'We' (ng∆∞·ªùi) c·∫£m th·∫•y h√†o h·ª©ng -> d√πng t√≠nh t·ª´ ƒëu√¥i -ED."
            },
            {
                q: 4,
                text: "The football match was ______. Both teams played very well.",
                options: ["excited", "exciting", "excite", "excitedly"],
                correct: 1,
                trans: "Tr·∫≠n b√≥ng ƒë√° r·∫•t k·ªãch t√≠nh. C·∫£ hai ƒë·ªôi ƒë·ªÅu ch∆°i r·∫•t hay.",
                analysis: [
                    "excited (adj): c·∫£m th·∫•y h√†o h·ª©ng",
                    "exciting (adj): k·ªãch t√≠nh, th√∫ v·ªã",
                    "excite (v): k√≠ch th√≠ch",
                    "excitedly (adv): m·ªôt c√°ch h√†o h·ª©ng"
                ],
                why: "Ch·ªß ng·ªØ 'The football match' (s·ª± vi·ªác) mang l·∫°i c·∫£m gi√°c h√†o h·ª©ng -> d√πng t√≠nh t·ª´ ƒëu√¥i -ING."
            },
            {
                q: 5,
                text: "She is ______ in learning English.",
                options: ["interesting", "interested", "interest", "interests"],
                correct: 1,
                trans: "C√¥ ·∫•y h·ª©ng th√∫ v·ªõi vi·ªác h·ªçc ti·∫øng Anh.",
                analysis: [
                    "interesting (adj): th√∫ v·ªã (g√¢y h·ª©ng th√∫)",
                    "interested (adj): quan t√¢m, h·ª©ng th√∫ (c·∫£m x√∫c)",
                    "interest (n/v): s·ª± quan t√¢m/l√†m quan t√¢m",
                    "interests (n/v): s·ªë nhi·ªÅu/ng√¥i 3 s·ªë √≠t"
                ],
                why: "C·∫•u tr√∫c 'to be interested in' (quan t√¢m ƒë·∫øn c√°i g√¨). Ch·ªß ng·ªØ 'She' c·∫£m th·∫•y h·ª©ng th√∫."
            },
            {
                q: 6,
                text: "My teacher is an ______ person. He knows a lot of stories.",
                options: ["interested", "interesting", "interest", "interestingly"],
                correct: 1,
                trans: "Th·∫ßy gi√°o t√¥i l√† m·ªôt ng∆∞·ªùi th√∫ v·ªã. Th·∫ßy bi·∫øt r·∫•t nhi·ªÅu c√¢u chuy·ªán.",
                analysis: [
                    "interested (adj): c·∫£m th·∫•y quan t√¢m",
                    "interesting (adj): th√∫ v·ªã (ch·ªâ t√≠nh c√°ch/ƒë·∫∑c ƒëi·ªÉm)",
                    "interest (n): s·ª± quan t√¢m",
                    "interestingly (adv): m·ªôt c√°ch th√∫ v·ªã"
                ],
                why: "M√¥ t·∫£ ƒë·∫∑c ƒëi·ªÉm/t√≠nh c√°ch c·ªßa th·∫ßy gi√°o (ng∆∞·ªùi mang l·∫°i s·ª± th√∫ v·ªã cho ng∆∞·ªùi kh√°c) -> d√πng t√≠nh t·ª´ ƒëu√¥i -ING."
            },
            {
                q: 7,
                text: "The ending of the book was quite ______.",
                options: ["disappointed", "disappointing", "disappoint", "disappointment"],
                correct: 1,
                trans: "K·∫øt th√∫c c·ªßa cu·ªën s√°ch kh√° g√¢y th·∫•t v·ªçng.",
                analysis: [
                    "disappointed (adj): c·∫£m th·∫•y th·∫•t v·ªçng",
                    "disappointing (adj): g√¢y th·∫•t v·ªçng (ƒë·∫∑c ƒëi·ªÉm)",
                    "disappoint (v): l√†m th·∫•t v·ªçng",
                    "disappointment (n): s·ª± th·∫•t v·ªçng"
                ],
                why: "Ch·ªß ng·ªØ 'The ending' (v·∫≠t/s·ª± vi·ªác) c√≥ t√≠nh ch·∫•t g√¢y th·∫•t v·ªçng -> d√πng t√≠nh t·ª´ ƒëu√¥i -ING."
            },
            {
                q: 8,
                text: "He was ______ because he failed the test.",
                options: ["disappointing", "disappointed", "disappoint", "disappoints"],
                correct: 1,
                trans: "Anh ·∫•y ƒë√£ th·∫•t v·ªçng v√¨ thi tr∆∞·ª£t.",
                analysis: [
                    "disappointing (adj): g√¢y th·∫•t v·ªçng",
                    "disappointed (adj): c·∫£m th·∫•y th·∫•t v·ªçng",
                    "disappoint (v): l√†m th·∫•t v·ªçng",
                    "disappoints (v): ƒë·ªông t·ª´ ng√¥i 3 s·ªë √≠t"
                ],
                why: "Ch·ªß ng·ªØ 'He' (ng∆∞·ªùi) c·∫£m th·∫•y bu·ªìn/th·∫•t v·ªçng -> d√πng t√≠nh t·ª´ ƒëu√¥i -ED."
            },
            {
                q: 9,
                text: "It was a ______ day. I worked for 12 hours.",
                options: ["tired", "tiring", "tire", "tiresome"],
                correct: 1,
                trans: "ƒê√≥ l√† m·ªôt ng√†y m·ªát m·ªèi. T√¥i ƒë√£ l√†m vi·ªác 12 ti·∫øng.",
                analysis: [
                    "tired (adj): c·∫£m th·∫•y m·ªát",
                    "tiring (adj): g√¢y m·ªát m·ªèi (ƒë·∫∑c ƒëi·ªÉm)",
                    "tire (v): l√†m m·ªát",
                    "tiresome (adj): phi·ªÅn h√†"
                ],
                why: "M√¥ t·∫£ t√≠nh ch·∫•t c·ªßa 'a day' (ng√†y l√†m vi·ªác) g√¢y ra s·ª± m·ªát m·ªèi -> d√πng t√≠nh t·ª´ ƒëu√¥i -ING."
            },
            {
                q: 10,
                text: "I am so ______ I need to go to sleep.",
                options: ["tiring", "tired", "tire", "tiredly"],
                correct: 1,
                trans: "T√¥i m·ªát qu√°. T√¥i c·∫ßn ƒëi ng·ªß.",
                analysis: [
                    "tiring (adj): g√¢y m·ªát",
                    "tired (adj): c·∫£m th·∫•y m·ªát",
                    "tire (v): l√†m m·ªát",
                    "tiredly (adv): m·ªôt c√°ch m·ªát m·ªèi"
                ],
                why: "Ch·ªß ng·ªØ 'I' (ng∆∞·ªùi) c·∫£m th·∫•y m·ªát -> d√πng t√≠nh t·ª´ ƒëu√¥i -ED."
            },
            {
                q: 11,
                text: "The news is ______! I can't believe it.",
                options: ["surprised", "surprising", "surprise", "surprisingly"],
                correct: 1,
                trans: "Tin t·ª©c th·∫≠t b·∫•t ng·ªù! T√¥i kh√¥ng th·ªÉ tin ƒë∆∞·ª£c.",
                analysis: [
                    "surprised (adj): c·∫£m th·∫•y ng·∫°c nhi√™n",
                    "surprising (adj): g√¢y ng·∫°c nhi√™n/b·∫•t ng·ªù",
                    "surprise (n/v): s·ª± ng·∫°c nhi√™n/l√†m ng·∫°c nhi√™n",
                    "surprisingly (adv): m·ªôt c√°ch ng·∫°c nhi√™n"
                ],
                why: "Ch·ªß ng·ªØ 'The news' (s·ª± vi·ªác) c√≥ t√≠nh ch·∫•t g√¢y s·ªëc -> d√πng t√≠nh t·ª´ ƒëu√¥i -ING."
            },
            {
                q: 12,
                text: "Are you ______ by the result of the game?",
                options: ["surprising", "surprised", "surprise", "surprises"],
                correct: 1,
                trans: "B·∫°n c√≥ ng·∫°c nhi√™n v·ªõi k·∫øt qu·∫£ tr·∫≠n ƒë·∫•u kh√¥ng?",
                analysis: [
                    "surprising (adj): g√¢y ng·∫°c nhi√™n",
                    "surprised (adj): c·∫£m th·∫•y ng·∫°c nhi√™n",
                    "surprise (n): s·ª± ng·∫°c nhi√™n",
                    "surprises (v): ƒë·ªông t·ª´ s·ªë √≠t"
                ],
                why: "H·ªèi v·ªÅ c·∫£m x√∫c c·ªßa 'you' (ng∆∞·ªùi) -> d√πng t√≠nh t·ª´ ƒëu√¥i -ED."
            },
            {
                q: 13,
                text: "The map was ______. We got lost.",
                options: ["confused", "confusing", "confuse", "confusion"],
                correct: 1,
                trans: "T·∫•m b·∫£n ƒë·ªì th·∫≠t r·ªëi r·∫Øm (g√¢y kh√≥ hi·ªÉu). Ch√∫ng t√¥i ƒë√£ b·ªã l·∫°c.",
                analysis: [
                    "confused (adj): c·∫£m th·∫•y b·ªëi r·ªëi",
                    "confusing (adj): g√¢y kh√≥ hi·ªÉu, r·∫Øc r·ªëi",
                    "confuse (v): l√†m b·ªëi r·ªëi",
                    "confusion (n): s·ª± h·ªón lo·∫°n"
                ],
                why: "M√¥ t·∫£ ƒë·∫∑c ƒëi·ªÉm c·ªßa 'The map' (v·∫≠t) g√¢y ra s·ª± b·ªëi r·ªëi -> d√πng t√≠nh t·ª´ ƒëu√¥i -ING."
            },
            {
                q: 14,
                text: "Students often feel ______ before exams.",
                options: ["worrying", "worried", "worry", "worries"],
                correct: 1,
                trans: "H·ªçc sinh th∆∞·ªùng c·∫£m th·∫•y lo l·∫Øng tr∆∞·ªõc c√°c k·ª≥ thi.",
                analysis: [
                    "worrying (adj): ƒë√°ng lo ng·∫°i (g√¢y lo l·∫Øng)",
                    "worried (adj): c·∫£m th·∫•y lo l·∫Øng",
                    "worry (v): lo l·∫Øng",
                    "worries (n): nh·ªØng n·ªói lo"
                ],
                why: "C·∫£m x√∫c c·ªßa 'Students' (ng∆∞·ªùi) -> d√πng t√≠nh t·ª´ ƒëu√¥i -ED."
            },
            {
                q: 15,
                text: "The noise from the neighbor is very ______.",
                options: ["annoyed", "annoying", "annoy", "annoyance"],
                correct: 1,
                trans: "Ti·∫øng ·ªìn t·ª´ nh√† h√†ng x√≥m r·∫•t phi·ªÅn ph·ª©c.",
                analysis: [
                    "annoyed (adj): c·∫£m th·∫•y b·ª±c m√¨nh",
                    "annoying (adj): g√¢y phi·ªÅn ph·ª©c, kh√≥ ch·ªãu",
                    "annoy (v): l√†m phi·ªÅn",
                    "annoyance (n): s·ª± phi·ªÅn to√°i"
                ],
                why: "Ch·ªß ng·ªØ 'The noise' (v·∫≠t) g√¢y ra s·ª± kh√≥ ch·ªãu -> d√πng t√≠nh t·ª´ ƒëu√¥i -ING."
            },
            {
                q: 16,
                text: "I get ______ when people talk during the movie.",
                options: ["annoying", "annoyed", "annoy", "annoys"],
                correct: 1,
                trans: "T√¥i ph√°t b·ª±c khi m·ªçi ng∆∞·ªùi n√≥i chuy·ªán trong l√∫c chi·∫øu phim.",
                analysis: [
                    "annoying (adj): g√¢y phi·ªÅn ph·ª©c",
                    "annoyed (adj): c·∫£m th·∫•y b·ª±c m√¨nh",
                    "annoy (v): l√†m phi·ªÅn",
                    "annoys (v): ƒë·ªông t·ª´ s·ªë √≠t"
                ],
                why: "C·∫•u tr√∫c 'get + adj' ch·ªâ tr·∫°ng th√°i c·∫£m x√∫c c·ªßa 'I' -> d√πng t√≠nh t·ª´ ƒëu√¥i -ED."
            },
            {
                q: 17,
                text: "The view from the mountain was ______.",
                options: ["amazed", "amazing", "amaze", "amazement"],
                correct: 1,
                trans: "C·∫£nh nh√¨n t·ª´ tr√™n n√∫i th·∫≠t tuy·ªát v·ªùi (kinh ng·∫°c).",
                analysis: [
                    "amazed (adj): c·∫£m th·∫•y kinh ng·∫°c",
                    "amazing (adj): tuy·ªát v·ªùi, g√¢y kinh ng·∫°c",
                    "amaze (v): l√†m kinh ng·∫°c",
                    "amazement (n): s·ª± kinh ng·∫°c"
                ],
                why: "M√¥ t·∫£ ƒë·∫∑c ƒëi·ªÉm c·ªßa 'The view' (c·∫£nh v·∫≠t) -> d√πng t√≠nh t·ª´ ƒëu√¥i -ING."
            },
            {
                q: 18,
                text: "She was ______ by his magic tricks.",
                options: ["amazing", "amazed", "amaze", "amazement"],
                correct: 1,
                trans: "C√¥ ·∫•y ƒë√£ kinh ng·∫°c tr∆∞·ªõc nh·ªØng m√†n ·∫£o thu·∫≠t c·ªßa anh ta.",
                analysis: [
                    "amazing (adj): g√¢y kinh ng·∫°c",
                    "amazed (adj): c·∫£m th·∫•y kinh ng·∫°c, th√°n ph·ª•c",
                    "amaze (v): l√†m kinh ng·∫°c",
                    "amazement (n): s·ª± kinh ng·∫°c"
                ],
                why: "C·∫£m x√∫c c·ªßa 'She' b·ªã t√°c ƒë·ªông b·ªüi ·∫£o thu·∫≠t -> d√πng t√≠nh t·ª´ ƒëu√¥i -ED."
            },
            {
                q: 19,
                text: "This roller coaster ride is ______!",
                options: ["frightened", "frightening", "frighten", "fright"],
                correct: 1,
                trans: "Chuy·∫øn t√†u l∆∞·ª£n si√™u t·ªëc n√†y th·∫≠t ƒë√°ng s·ª£!",
                analysis: [
                    "frightened (adj): c·∫£m th·∫•y s·ª£",
                    "frightening (adj): ƒë√°ng s·ª£ (g√¢y s·ª£ h√£i)",
                    "frighten (v): l√†m s·ª£",
                    "fright (n): s·ª± ho·∫£ng s·ª£"
                ],
                why: "M√¥ t·∫£ t√≠nh ch·∫•t c·ªßa 'ride' (chuy·∫øn ƒëi) g√¢y s·ª£ h√£i -> d√πng t√≠nh t·ª´ ƒëu√¥i -ING."
            },
            {
                q: 20,
                text: "The little boy was ______ of the dark.",
                options: ["frightening", "frightened", "frighten", "frightens"],
                correct: 1,
                trans: "C·∫≠u b√© s·ª£ b√≥ng t·ªëi.",
                analysis: [
                    "frightening (adj): ƒë√°ng s·ª£",
                    "frightened (adj): c·∫£m th·∫•y s·ª£ h√£i",
                    "frighten (v): l√†m s·ª£",
                    "frightens (v): ƒë·ªông t·ª´ s·ªë √≠t"
                ],
                why: "C·∫•u tr√∫c 'to be frightened of' (s·ª£ c√°i g√¨). C·∫£m x√∫c c·ªßa c·∫≠u b√© -> d√πng ƒëu√¥i -ED."
            },
            {
                q: 21,
                text: "The story was very ______. It made me cry.",
                options: ["moved", "moving", "move", "movement"],
                correct: 1,
                trans: "C√¢u chuy·ªán r·∫•t c·∫£m ƒë·ªông. N√≥ l√†m t√¥i kh√≥c.",
                analysis: [
                    "moved (adj): c·∫£m th·∫•y x√∫c ƒë·ªông",
                    "moving (adj): c·∫£m ƒë·ªông (g√¢y x√∫c ƒë·ªông)",
                    "move (v): di chuy·ªÉn/l√†m c·∫£m ƒë·ªông",
                    "movement (n): s·ª± chuy·ªÉn ƒë·ªông"
                ],
                why: "Ch·ªß ng·ªØ 'The story' (v·∫≠t) c√≥ t√≠nh ch·∫•t g√¢y x√∫c ƒë·ªông -> d√πng t√≠nh t·ª´ ƒëu√¥i -ING."
            },
            {
                q: 22,
                text: "I was ______ by the beautiful song.",
                options: ["moving", "moved", "move", "movement"],
                correct: 1,
                trans: "T√¥i ƒë√£ r·∫•t x√∫c ƒë·ªông tr∆∞·ªõc b√†i h√°t tuy·ªát ƒë·∫πp ƒë√≥.",
                analysis: [
                    "moving (adj): g√¢y x√∫c ƒë·ªông",
                    "moved (adj): c·∫£m th·∫•y x√∫c ƒë·ªông/rung ƒë·ªông",
                    "move (v): di chuy·ªÉn",
                    "movement (n): phong tr√†o"
                ],
                why: "C·∫£m x√∫c c·ªßa 'I' b·ªã b√†i h√°t lay ƒë·ªông -> d√πng t√≠nh t·ª´ ƒëu√¥i -ED."
            },
            {
                q: 23,
                text: "It was an ______ situation. I dropped my cake in front of everyone.",
                options: ["embarrassed", "embarrassing", "embarrass", "embarrassment"],
                correct: 1,
                trans: "ƒê√≥ l√† m·ªôt t√¨nh hu·ªëng x·∫•u h·ªï. T√¥i l√†m r∆°i b√°nh tr∆∞·ªõc m·∫∑t m·ªçi ng∆∞·ªùi.",
                analysis: [
                    "embarrassed (adj): c·∫£m th·∫•y x·∫•u h·ªï",
                    "embarrassing (adj): g√¢y x·∫•u h·ªï/ng∆∞·ª£ng ng√πng",
                    "embarrass (v): l√†m x·∫•u h·ªï",
                    "embarrassment (n): s·ª± l√∫ng t√∫ng"
                ],
                why: "M√¥ t·∫£ t√≠nh ch·∫•t c·ªßa 'situation' (t√¨nh hu·ªëng) -> d√πng t√≠nh t·ª´ ƒëu√¥i -ING."
            },
            {
                q: 24,
                text: "He felt ______ when he forgot his lines on stage.",
                options: ["embarrassing", "embarrassed", "embarrass", "embarrasses"],
                correct: 1,
                trans: "Anh ·∫•y c·∫£m th·∫•y x·∫•u h·ªï khi qu√™n l·ªùi tho·∫°i tr√™n s√¢n kh·∫•u.",
                analysis: [
                    "embarrassing (adj): g√¢y x·∫•u h·ªï",
                    "embarrassed (adj): c·∫£m th·∫•y x·∫•u h·ªï/ng∆∞·ª£ng",
                    "embarrass (v): l√†m x·∫•u h·ªï",
                    "embarrasses (v): ƒë·ªông t·ª´ s·ªë √≠t"
                ],
                why: "C·∫£m x√∫c c·ªßa 'He' (ng∆∞·ªùi) -> d√πng t√≠nh t·ª´ ƒëu√¥i -ED."
            },
            {
                q: 25,
                text: "After a long run, I was completely ______.",
                options: ["exhausting", "exhausted", "exhaust", "exhaustion"],
                correct: 1,
                trans: "Sau qu√£ng ƒë∆∞·ªùng ch·∫°y d√†i, t√¥i ho√†n to√†n ki·ªát s·ª©c.",
                analysis: [
                    "exhausting (adj): g√¢y ki·ªát s·ª©c",
                    "exhausted (adj): c·∫£m th·∫•y ki·ªát s·ª©c/m·ªát l·ª≠",
                    "exhaust (v/n): l√†m ki·ªát s·ª©c/kh√≠ th·∫£i",
                    "exhaustion (n): s·ª± ki·ªát s·ª©c"
                ],
                why: "Tr·∫°ng th√°i/c·∫£m x√∫c c·ªßa 'I' (ng∆∞·ªùi) -> d√πng t√≠nh t·ª´ ƒëu√¥i -ED."
            },
            {
                q: 26,
                text: "The marathon was ______. Everyone was tired.",
                options: ["exhausted", "exhausting", "exhaust", "exhausts"],
                correct: 1,
                trans: "Cu·ªôc ƒëua marathon th·∫≠t v·∫•t v·∫£ (g√¢y ki·ªát s·ª©c). M·ªçi ng∆∞·ªùi ƒë·ªÅu m·ªát.",
                analysis: [
                    "exhausted (adj): c·∫£m th·∫•y ki·ªát s·ª©c",
                    "exhausting (adj): g√¢y ki·ªát s·ª©c, r·∫•t m·ªát",
                    "exhaust (v): l√†m ki·ªát s·ª©c",
                    "exhausts (v): ƒë·ªông t·ª´ s·ªë √≠t"
                ],
                why: "ƒê·∫∑c ƒëi·ªÉm c·ªßa 'The marathon' (s·ª± vi·ªác) -> d√πng t√≠nh t·ª´ ƒëu√¥i -ING."
            },
            {
                q: 27,
                text: "Scientific documentaries are very ______.",
                options: ["fascinated", "fascinating", "fascinate", "fascination"],
                correct: 1,
                trans: "Phim t√†i li·ªáu khoa h·ªçc r·∫•t l√¥i cu·ªën.",
                analysis: [
                    "fascinated (adj): b·ªã m√™ ho·∫∑c",
                    "fascinating (adj): l√¥i cu·ªën, h·∫•p d·∫´n (ƒë·∫∑c ƒëi·ªÉm)",
                    "fascinate (v): m√™ ho·∫∑c",
                    "fascination (n): s·ª± quy·∫øn r≈©"
                ],
                why: "ƒê·∫∑c ƒëi·ªÉm c·ªßa 'Scientific documentaries' (v·∫≠t) -> d√πng t√≠nh t·ª´ ƒëu√¥i -ING."
            },
            {
                q: 28,
                text: "The children were ______ by the clown.",
                options: ["amusing", "amused", "amuse", "amusement"],
                correct: 1,
                trans: "B·ªçn tr·∫ª r·∫•t th√≠ch th√∫ v·ªõi ch√∫ h·ªÅ.",
                analysis: [
                    "amusing (adj): g√¢y c∆∞·ªùi",
                    "amused (adj): c·∫£m th·∫•y th√≠ch th√∫/vui v·∫ª",
                    "amuse (v): l√†m vui",
                    "amusement (n): s·ª± gi·∫£i tr√≠"
                ],
                why: "C·∫£m x√∫c c·ªßa 'children' (ng∆∞·ªùi) khi xem ch√∫ h·ªÅ -> d√πng t√≠nh t·ª´ ƒëu√¥i -ED."
            },
            {
                q: 29,
                text: "I found the instructions quite ______.",
                options: ["confused", "confusing", "confuse", "confusion"],
                correct: 1,
                trans: "T√¥i th·∫•y b·∫£n h∆∞·ªõng d·∫´n kh√° kh√≥ hi·ªÉu.",
                analysis: [
                    "confused (adj): c·∫£m th·∫•y b·ªëi r·ªëi",
                    "confusing (adj): g√¢y kh√≥ hi·ªÉu (ƒë·∫∑c ƒëi·ªÉm)",
                    "confuse (v): l√†m b·ªëi r·ªëi",
                    "confusion (n): s·ª± h·ªón lo·∫°n"
                ],
                why: "C·∫•u tr√∫c 'Find + something + adj' (Th·∫•y c√°i g√¨ ƒë√≥ nh∆∞ th·∫ø n√†o). Nh·∫≠n x√©t v·ªÅ t√≠nh ch·∫•t c·ªßa 'instructions' -> d√πng ƒëu√¥i -ING."
            },
            {
                q: 30,
                text: "Stop that noise! It's really ______.",
                options: ["irritated", "irritating", "irritate", "irritation"],
                correct: 1,
                trans: "D·ª´ng ti·∫øng ·ªìn ƒë√≥ l·∫°i! N√≥ th·ª±c s·ª± g√¢y kh√≥ ch·ªãu.",
                analysis: [
                    "irritated (adj): c·∫£m th·∫•y c√°u",
                    "irritating (adj): g√¢y kh√≥ ch·ªãu, phi·ªÅn ph·ª©c",
                    "irritate (v): ch·ªçc t·ª©c",
                    "irritation (n): s·ª± k√≠ch th√≠ch"
                ],
                why: "Ch·ªß ng·ªØ 'It' thay th·∫ø cho 'noise' (v·∫≠t) -> d√πng t√≠nh t·ª´ ƒëu√¥i -ING."
            }
        ];

        let score = 0;
        const totalQuestions = quizData.length;

        // Sound Effects Generator (Lightweight - No external files needed)
        const audioCtx = new (window.AudioContext || window.webkitAudioContext)();

        function playSound(type) {
            if (audioCtx.state === 'suspended') audioCtx.resume();
            const osc = audioCtx.createOscillator();
            const gainNode = audioCtx.createGain();
            osc.connect(gainNode);
            gainNode.connect(audioCtx.destination);

            if (type === 'correct') {
                // "Ding" sound: High pitch sine wave + decay
                osc.type = 'sine';
                osc.frequency.setValueAtTime(600, audioCtx.currentTime);
                osc.frequency.exponentialRampToValueAtTime(1200, audioCtx.currentTime + 0.1);
                gainNode.gain.setValueAtTime(0.3, audioCtx.currentTime);
                gainNode.gain.exponentialRampToValueAtTime(0.01, audioCtx.currentTime + 0.5);
                osc.start();
                osc.stop(audioCtx.currentTime + 0.5);
            } else if (type === 'wrong') {
                // "Buzz" sound: Low pitch sawtooth + flutter
                osc.type = 'sawtooth';
                osc.frequency.setValueAtTime(150, audioCtx.currentTime);
                osc.frequency.linearRampToValueAtTime(100, audioCtx.currentTime + 0.3);
                gainNode.gain.setValueAtTime(0.3, audioCtx.currentTime);
                gainNode.gain.exponentialRampToValueAtTime(0.01, audioCtx.currentTime + 0.3);
                osc.start();
                osc.stop(audioCtx.currentTime + 0.3);
            }
        }

        function renderQuiz() {
            const container = document.getElementById('quiz-container');
            
            quizData.forEach((item, index) => {
                const card = document.createElement('div');
                card.className = 'quiz-card';
                card.id = `question-${index}`;

                // Question Header
                const qNum = document.createElement('div');
                qNum.className = 'question-number';
                qNum.innerText = `C√¢u ${index + 1}`;
                card.appendChild(qNum);

                // Question Text
                const qText = document.createElement('div');
                qText.className = 'question-text';
                qText.innerText = item.text;
                card.appendChild(qText);

                // Options
                const grid = document.createElement('div');
                grid.className = 'options-grid';
                
                item.options.forEach((opt, optIndex) => {
                    const btn = document.createElement('button');
                    btn.className = 'option-btn';
                    const label = String.fromCharCode(65 + optIndex); // A, B, C, D
                    btn.innerHTML = `<span class="option-label">${label}</span> ${opt}`;
                    btn.onclick = () => checkAnswer(index, optIndex, btn, item.correct);
                    grid.appendChild(btn);
                });
                card.appendChild(grid);

                // Explanation Box (Hidden initially)
                const explBox = document.createElement('div');
                explBox.className = 'explanation-box';
                explBox.id = `expl-${index}`;
                
                // Build HTML for explanation
                let analysisHTML = '';
                item.analysis.forEach((line) => {
                    // Highlight the word part before ':'
                    const parts = line.split(':');
                    if(parts.length > 1) {
                        analysisHTML += `<span class="vocab-item"><span class="vocab-highlight">${parts[0]}:</span> ${parts[1]}</span>`;
                    } else {
                        analysisHTML += `<span class="vocab-item">${line}</span>`;
                    }
                });

                explBox.innerHTML = `
                    <div class="explanation-header"><i class="fas fa-chalkboard-teacher"></i> C√¥ Mai An gi·∫£i th√≠ch:</div>
                    
                    <div class="expl-section">
                        <span class="expl-title">üìù D·ªãch nghƒ©a:</span>
                        <div class="expl-content">"${item.trans}"</div>
                    </div>

                    <div class="expl-section">
                        <span class="expl-title">üîç Ph√¢n t√≠ch ƒë√°p √°n:</span>
                        <div class="expl-content">${analysisHTML}</div>
                    </div>

                    <div class="expl-section">
                        <span class="expl-title">üí° T·∫°i sao ch·ªçn ƒë√°p √°n n√†y?</span>
                        <div class="expl-content" style="color: var(--secondary); font-weight:600;">${item.why}</div>
                    </div>
                `;
                card.appendChild(explBox);
                container.appendChild(card);
            });
        }

        function checkAnswer(questionIndex, selectedOptIndex, btnElement, correctIndex) {
            // Prevent clicking again if already answered
            const card = document.getElementById(`question-${questionIndex}`);
            const buttons = card.querySelectorAll('.option-btn');
            
            // Check if this question is already answered by looking for disabled buttons
            if (buttons[0].disabled) return;

            // Lock buttons
            buttons.forEach(btn => btn.disabled = true);

            // Check correctness
            if (selectedOptIndex === correctIndex) {
                // Correct
                btnElement.classList.add('correct');
                playSound('correct');
                score++;
                document.getElementById('current-score').innerText = score;
                fireConfetti(btnElement);
            } else {
                // Wrong
                btnElement.classList.add('wrong');
                playSound('wrong');
                // Highlight the correct answer automatically
                buttons[correctIndex].classList.add('correct');
            }

            // Show explanation immediately
            const expl = document.getElementById(`expl-${questionIndex}`);
            expl.style.display = 'block';
        }

        function showFinalResult() {
            const modal = document.getElementById('resultModal');
            document.getElementById('final-score').innerText = `${score}/30`;
            
            let msg = "";
            const percentage = (score / totalQuestions) * 100;
            if (percentage === 100) msg = "Xu·∫•t s·∫Øc! B·∫°n l√† thi√™n t√†i ti·∫øng Anh! üèÜ";
            else if (percentage >= 80) msg = "R·∫•t t·ªët! B·∫°n n·∫Øm r·∫•t ch·∫Øc ki·∫øn th·ª©c! üåü";
            else if (percentage >= 50) msg = "Kh√° t·ªët! C·ªë g·∫Øng th√™m ch√∫t n·ªØa nh√©! üí™";
            else msg = "ƒê·ª´ng bu·ªìn! H√£y xem l·∫°i gi·∫£i th√≠ch v√† th·ª≠ l·∫°i nh√©! üìö";
            
            document.getElementById('final-message').innerText = msg;
            modal.style.display = 'flex';
            
            if (percentage >= 50) fireConfettiGlobal();
        }

        function closeModal() {
            document.getElementById('resultModal').style.display = 'none';
        }

        // --- Confetti Logic (Simplified version of canvas-confetti) ---
        function fireConfetti(element) {
            // Quick visual burst near the button? 
            // Since coordinates are tricky without library, we'll do a small global burst
            fireConfettiGlobal(0.5); // Short duration
        }

        function fireConfettiGlobal(durationSeconds = 2) {
            const canvas = document.getElementById('confetti-canvas');
            const ctx = canvas.getContext('2d');
            canvas.width = window.innerWidth;
            canvas.height = window.innerHeight;

            let particles = [];
            const colors = ['#8854C0', '#00C9A7', '#ff4757', '#ffa502', '#2ed573'];

            for (let i = 0; i < 100; i++) {
                particles.push({
                    x: Math.random() * canvas.width,
                    y: Math.random() * canvas.height - canvas.height, // Start above
                    r: Math.random() * 6 + 2,
                    d: Math.random() * 20 + 10, // density
                    color: colors[Math.floor(Math.random() * colors.length)],
                    tilt: Math.floor(Math.random() * 10) - 10,
                    tiltAngleIncremental: (Math.random() * 0.07) + 0.05,
                    tiltAngle: 0
                });
            }

            let animationId;
            let startTime = Date.now();

            function draw() {
                ctx.clearRect(0, 0, canvas.width, canvas.height);
                
                particles.forEach((p, index) => {
                    p.tiltAngle += p.tiltAngleIncremental;
                    p.y += (Math.cos(p.d) + 3 + p.r / 2) / 2;
                    p.x += Math.sin(0);
                    p.tilt = Math.sin(p.tiltAngle) * 15;

                    ctx.beginPath();
                    ctx.lineWidth = p.r;
                    ctx.strokeStyle = p.color;
                    ctx.moveTo(p.x + p.tilt + (p.r / 2), p.y);
                    ctx.lineTo(p.x + p.tilt, p.y + p.tilt + (p.r / 2));
                    ctx.stroke();

                    // Reset particle if it falls off screen
                    if (p.y > canvas.height) {
                         // Only respawn if time isn't up
                         if (Date.now() - startTime < durationSeconds * 1000) {
                            p.x = Math.random() * canvas.width;
                            p.y = -10;
                            p.tilt = Math.floor(Math.random() * 10) - 10;
                         }
                    }
                });

                if (Date.now() - startTime < durationSeconds * 1000 + 1000) { // Keep animating a bit after stop respawning to clear screen
                    animationId = requestAnimationFrame(draw);
                }
            }
            
            draw();
        }

        // Initialize
        window.onload = renderQuiz;
        
        // Handle Resize for canvas
        window.addEventListener('resize', () => {
            const canvas = document.getElementById('confetti-canvas');
            canvas.width = window.innerWidth;
            canvas.height = window.innerHeight;
        });

    </script>
</body>
</html>
