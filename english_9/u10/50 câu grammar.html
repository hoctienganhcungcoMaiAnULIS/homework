<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Tiếng Anh 9 - Mệnh đề quan hệ (Câu 40-89) | Ms Mai An ULIS</title>
    <link href="https://fonts.googleapis.com/css2?family=Nunito:wght@400;600;700;800&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdn.jsdelivr.net/npm/canvas-confetti@1.6.0/dist/confetti.browser.min.js"></script>
    
    <style>
        :root {
            --primary: #8854C0; /* Tím Pastel */
            --secondary: #00C9A7; /* Xanh ngọc */
            --success: #00D26A; /* Xanh lá */
            --error: #FF4757; /* Đỏ cam */
            --bg-pattern: #F0F4F8;
            --text-main: #2D3436;
        }

        body {
            font-family: 'Nunito', sans-serif;
            background-color: var(--bg-pattern);
            background-image: radial-gradient(#dfe6e9 2px, transparent 2px);
            background-size: 30px 30px;
            color: var(--text-main);
            overflow-x: hidden;
        }

        /* 3D Button Styles */
        .btn-3d {
            transition: all 0.1s;
            border-bottom: 5px solid rgba(0,0,0,0.2);
            transform: translateY(0);
        }

        .btn-3d:active {
            transform: translateY(4px);
            border-bottom: 1px solid rgba(0,0,0,0.2);
        }

        .option-card {
            background: white;
            border: 2px solid #e2e8f0;
            border-radius: 15px;
            padding: 15px 20px;
            cursor: pointer;
            transition: all 0.2s ease;
            box-shadow: 0 4px 0 #cbd5e1;
            font-weight: 700;
            color: #475569;
            display: flex;
            align-items: center;
        }

        .option-card:hover:not(.disabled) {
            transform: scale(1.02);
            border-color: var(--primary);
            color: var(--primary);
            background-color: #F3E8FF;
        }

        .option-card:active:not(.disabled) {
            transform: translateY(4px);
            box-shadow: none;
        }

        /* Correct State */
        .option-card.correct {
            background-color: #D1FAE5;
            border-color: var(--success);
            color: #065F46;
            box-shadow: 0 4px 0 #059669;
        }

        /* Incorrect State */
        .option-card.incorrect {
            background-color: #FFE4E6;
            border-color: var(--error);
            color: #991B1B;
            box-shadow: 0 4px 0 #B91C1C;
            animation: shake 0.5s;
        }

        /* Shake Animation */
        @keyframes shake {
            0% { transform: translateX(0); }
            25% { transform: translateX(-5px) rotate(-2deg); }
            50% { transform: translateX(5px) rotate(2deg); }
            75% { transform: translateX(-5px) rotate(-2deg); }
            100% { transform: translateX(0); }
        }

        /* Explanation Box */
        .explanation-box {
            background: #fff;
            border-left: 5px solid var(--primary);
            box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1);
            animation: slideDown 0.4s ease-out;
        }

        @keyframes slideDown {
            from { opacity: 0; transform: translateY(-10px); }
            to { opacity: 1; transform: translateY(0); }
        }

        .teacher-avatar {
            width: 50px;
            height: 50px;
            background: var(--primary);
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-size: 24px;
            border: 3px solid white;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
        }

        /* Sticky Header */
        .sticky-header {
            position: sticky;
            top: 0;
            z-index: 50;
            background: rgba(255, 255, 255, 0.95);
            backdrop-filter: blur(10px);
            box-shadow: 0 2px 10px rgba(0,0,0,0.05);
        }

        /* Custom Scrollbar */
        ::-webkit-scrollbar {
            width: 8px;
        }
        ::-webkit-scrollbar-track {
            background: #f1f1f1;
        }
        ::-webkit-scrollbar-thumb {
            background: var(--primary);
            border-radius: 4px;
        }
    </style>
</head>
<body>

    <!-- Audio Elements -->
    <audio id="sound-correct" src="https://assets.mixkit.co/active_storage/sfx/2000/2000-preview.mp3"></audio>
    <audio id="sound-incorrect" src="https://assets.mixkit.co/active_storage/sfx/2018/2018-preview.mp3"></audio>
    <audio id="sound-finish" src="https://assets.mixkit.co/active_storage/sfx/2013/2013-preview.mp3"></audio>

    <!-- Header -->
    <div class="sticky-header py-3 px-4 mb-6">
        <div class="max-w-4xl mx-auto flex justify-between items-center">
            <div>
                <h1 class="text-lg md:text-2xl font-extrabold text-gray-800">
                    <span style="color: var(--primary)"><i class="fas fa-graduation-cap"></i> Ms Mai An ULIS</span>
                </h1>
                <p class="text-xs md:text-sm text-gray-500 font-semibold">Tiếng Anh 9 - Mệnh đề quan hệ (Câu 40-89)</p>
            </div>
            <div class="flex items-center space-x-4">
                <div class="bg-gray-100 px-4 py-2 rounded-full font-bold text-gray-700 shadow-inner border border-gray-200">
                    <i class="fas fa-star text-yellow-400 mr-1"></i>
                    <span id="score-display">0</span>/50
                </div>
                <button onclick="finishQuiz()" class="bg-red-500 hover:bg-red-600 text-white px-4 py-2 rounded-xl font-bold btn-3d shadow-[0_4px_0_#991B1B]">
                    Nộp bài
                </button>
            </div>
        </div>
        <!-- Progress Bar -->
        <div class="w-full bg-gray-200 h-2 mt-3 rounded-full overflow-hidden">
            <div id="progress-bar" class="bg-teal-400 h-full transition-all duration-500 ease-out" style="width: 0%"></div>
        </div>
    </div>

    <!-- Main Quiz Container -->
    <div class="max-w-4xl mx-auto px-4 pb-20" id="quiz-container">
        <!-- Questions will be injected here by JS -->
    </div>

    <!-- Finish Modal -->
    <div id="finish-modal" class="fixed inset-0 bg-black bg-opacity-50 z-50 hidden flex items-center justify-center p-4">
        <div class="bg-white rounded-3xl p-8 max-w-md w-full text-center transform scale-100 transition-transform shadow-2xl relative overflow-hidden">
            <div class="absolute top-0 left-0 w-full h-4 bg-gradient-to-r from-purple-400 to-teal-400"></div>
            
            <div class="mb-6 inline-block p-4 rounded-full bg-yellow-100 text-yellow-500 text-5xl shadow-lg border-4 border-white">
                <i class="fas fa-trophy"></i>
            </div>
            
            <h2 class="text-3xl font-extrabold text-gray-800 mb-2">Kết quả của em</h2>
            <p id="final-message" class="text-lg text-gray-600 mb-6 italic">"Good job!"</p>
            
            <div class="grid grid-cols-2 gap-4 mb-8">
                <div class="bg-green-50 p-4 rounded-2xl border border-green-100">
                    <p class="text-green-600 font-bold text-sm">ĐÚNG</p>
                    <p class="text-3xl font-black text-green-500" id="final-score">0</p>
                </div>
                <div class="bg-red-50 p-4 rounded-2xl border border-red-100">
                    <p class="text-red-600 font-bold text-sm">SAI</p>
                    <p class="text-3xl font-black text-red-500" id="final-wrong">0</p>
                </div>
            </div>

            <button onclick="location.reload()" class="w-full bg-purple-600 hover:bg-purple-700 text-white py-4 rounded-2xl font-bold text-xl btn-3d shadow-[0_5px_0_#5b21b6]">
                <i class="fas fa-redo-alt mr-2"></i> Làm lại bài
            </button>
        </div>
    </div>

    <script>
        // --- DATA SOURCE ---
        const questionsData = [
    {
      "questionNumber": 40,
      "question": "Researchers, ________ are developing new technologies for renewable energy, are making a positive impact.",
      "answerOptions": [
        { "text": "who", "isCorrect": true },
        { "text": "that", "isCorrect": false },
        { "text": "when", "isCorrect": false },
        { "text": "whom", "isCorrect": false }
      ],
      "explanation": `
        <b>1. Dịch nghĩa:</b> Các nhà nghiên cứu, những người đang phát triển công nghệ mới cho năng lượng tái tạo, đang tạo ra tác động tích cực.<br><br>
        <b>2. Phân tích đáp án:</b><br>
        - A. who: đại từ quan hệ chỉ người, làm chủ ngữ.<br>
        - B. that: đại từ quan hệ chỉ người/vật, KHÔNG dùng sau dấu phẩy.<br>
        - C. when: trạng từ quan hệ chỉ thời gian.<br>
        - D. whom: đại từ quan hệ chỉ người, làm tân ngữ.<br><br>
        <b>3. Giải thích chi tiết:</b><br>
        Tiền ngữ 'Researchers' (nhà nghiên cứu) là danh từ chỉ người. Mệnh đề quan hệ nằm giữa hai dấu phẩy (non-defining). Chỗ trống cần một chủ ngữ cho động từ 'are developing'. Vì vậy, ta dùng 'who'.<br>
        -> Loại 'that' vì có dấu phẩy. Loại 'whom' vì cần chủ ngữ. Loại 'when' vì sai nghĩa.
      `
    },
    {
      "questionNumber": 41,
      "question": "My physics teacher, ________ I always admire, has a vast knowledge about outer space.",
      "answerOptions": [
        { "text": "whom", "isCorrect": true },
        { "text": "whose", "isCorrect": false },
        { "text": "which", "isCorrect": false },
        { "text": "that", "isCorrect": false }
      ],
      "explanation": `
        <b>1. Dịch nghĩa:</b> Giáo viên vật lý của tôi, người mà tôi luôn ngưỡng mộ, có kiến thức rộng lớn về không gian vũ trụ.<br><br>
        <b>2. Phân tích đáp án:</b><br>
        - A. whom: đại từ quan hệ chỉ người, làm tân ngữ.<br>
        - B. whose: đại từ quan hệ chỉ sự sở hữu.<br>
        - C. which: đại từ quan hệ chỉ vật.<br>
        - D. that: đại từ quan hệ không dùng sau dấu phẩy.<br><br>
        <b>3. Giải thích chi tiết:</b><br>
        Tiền ngữ là 'My physics teacher' (người). Phía sau có chủ ngữ 'I' và động từ 'admire' (ngưỡng mộ ai đó), nên vị trí này đóng vai trò tân ngữ. Trong mệnh đề có dấu phẩy, tân ngữ chỉ người dùng 'whom'.<br>
        -> Chọn 'whom'.
      `
    },
    {
      "questionNumber": 42,
      "question": "The atmosphere, ________ protects us from harmful radiation, is essential for life on Earth.",
      "answerOptions": [
        { "text": "which", "isCorrect": true },
        { "text": "where", "isCorrect": false },
        { "text": "that", "isCorrect": false },
        { "text": "whom", "isCorrect": false }
      ],
      "explanation": `
        <b>1. Dịch nghĩa:</b> Bầu khí quyển, cái mà bảo vệ chúng ta khỏi bức xạ có hại, là thiết yếu cho sự sống trên Trái Đất.<br><br>
        <b>2. Phân tích đáp án:</b><br>
        - A. which: đại từ quan hệ chỉ vật.<br>
        - B. where: trạng từ quan hệ chỉ nơi chốn (dùng khi thay thế cho 'at/in/on which').<br>
        - C. that: đại từ quan hệ không dùng sau dấu phẩy.<br>
        - D. whom: đại từ quan hệ chỉ người.<br><br>
        <b>3. Giải thích chi tiết:</b><br>
        Tiền ngữ 'The atmosphere' (bầu khí quyển) là danh từ chỉ vật. Mệnh đề có dấu phẩy (non-defining) và chỗ trống làm chủ ngữ cho động từ 'protects'. Dùng 'which' cho vật sau dấu phẩy.
      `
    },
    {
      "questionNumber": 43,
      "question": "Will Smith, ________ recent movies have been serious, was once considered a comic actor.",
      "answerOptions": [
        { "text": "whose", "isCorrect": true },
        { "text": "which", "isCorrect": false },
        { "text": "who", "isCorrect": false },
        { "text": "(Empty Option)", "isCorrect": false }
      ],
      "explanation": `
        <b>1. Dịch nghĩa:</b> Will Smith, người có những bộ phim gần đây rất nghiêm túc, từng được coi là một diễn viên hài.<br><br>
        <b>2. Phân tích đáp án:</b><br>
        - A. whose: chỉ sự sở hữu (người/vật).<br>
        - B. which: chỉ vật.<br>
        - C. who: chỉ người (chủ ngữ).<br><br>
        <b>3. Giải thích chi tiết:</b><br>
        Ta thấy mối quan hệ sở hữu: 'recent movies' (những bộ phim gần đây) là CỦA Will Smith. Khi cần chỉ sự sở hữu cho danh từ đứng trước, ta dùng 'whose'.<br>
        -> Cấu trúc: [Người] + whose + [Danh từ].
      `
    },
    {
      "questionNumber": 44,
      "question": "She captured a photo of the bird ________ nested in the tree outside her window.",
      "answerOptions": [
        { "text": "that", "isCorrect": true },
        { "text": "whom", "isCorrect": false },
        { "text": "whose", "isCorrect": false },
        { "text": "who", "isCorrect": false }
      ],
      "explanation": `
        <b>1. Dịch nghĩa:</b> Cô ấy chụp một bức ảnh con chim đang làm tổ trên cây bên ngoài cửa sổ.<br><br>
        <b>2. Phân tích đáp án:</b><br>
        - A. that: dùng cho người/vật/động vật trong mệnh đề xác định.<br>
        - B. whom: chỉ người (tân ngữ).<br>
        - C. whose: chỉ sở hữu.<br>
        - D. who: chỉ người.<br><br>
        <b>3. Giải thích chi tiết:</b><br>
        Tiền ngữ 'the bird' là động vật. Trong mệnh đề quan hệ xác định (không có dấu phẩy), ta dùng 'which' hoặc 'that'. Ở đây chỉ có 'that' là phù hợp.
      `
    },
    {
      "questionNumber": 45,
      "question": "Ms. Jane, ________ studies ocean currents, is presenting her findings today.",
      "answerOptions": [
        { "text": "who", "isCorrect": true },
        { "text": "that", "isCorrect": false },
        { "text": "whom", "isCorrect": false },
        { "text": "whose", "isCorrect": false }
      ],
      "explanation": `
        <b>1. Dịch nghĩa:</b> Cô Jane, người nghiên cứu các dòng hải lưu, hôm nay sẽ trình bày những phát hiện của mình.<br><br>
        <b>2. Phân tích đáp án:</b><br>
        - A. who: chỉ người (chủ ngữ).<br>
        - B. that: không dùng sau dấu phẩy.<br>
        - C. whom: chỉ người (tân ngữ).<br>
        - D. whose: chỉ sở hữu.<br><br>
        <b>3. Giải thích chi tiết:</b><br>
        Tiền ngữ 'Ms. Jane' là người. Sau chỗ trống là động từ 'studies' -> Cần một chủ ngữ. Vì có dấu phẩy (non-defining), ta dùng 'who'.
      `
    },
    {
      "questionNumber": 46,
      "question": "The number of polar bears, _______ natural habitat is the Arctic, is decreasing.",
      "answerOptions": [
        { "text": "whose", "isCorrect": true },
        { "text": "that", "isCorrect": false },
        { "text": "which", "isCorrect": false },
        { "text": "who", "isCorrect": false }
      ],
      "explanation": `
        <b>1. Dịch nghĩa:</b> Số lượng gấu bắc cực, loài có môi trường sống tự nhiên là Bắc Cực, đang giảm dần.<br><br>
        <b>2. Phân tích đáp án:</b><br>
        - A. whose: chỉ sở hữu.<br>
        - B. that: không dùng sau dấu phẩy.<br>
        - C. which: chỉ vật (nhưng không chỉ sở hữu).<br>
        - D. who: chỉ người.<br><br>
        <b>3. Giải thích chi tiết:</b><br>
        'Natural habitat' (môi trường sống) thuộc về 'polar bears' (gấu bắc cực). Đây là quan hệ sở hữu -> Dùng 'whose'.<br>
        Lưu ý: 'Whose' có thể dùng cho cả người và vật/động vật.
      `
    },
    {
      "questionNumber": 47,
      "question": "The severe drought ________ occurred last summer ruined the corn crop.",
      "answerOptions": [
        { "text": "that", "isCorrect": true },
        { "text": "which it", "isCorrect": false },
        { "text": "it", "isCorrect": false },
        { "text": "that it", "isCorrect": false }
      ],
      "explanation": `
        <b>1. Dịch nghĩa:</b> Trận hạn hán nghiêm trọng xảy ra vào mùa hè năm ngoái đã phá hủy vụ ngô.<br><br>
        <b>2. Phân tích đáp án:</b><br>
        - A. that: đại từ quan hệ chỉ vật.<br>
        - B. which it: thừa đại từ 'it'.<br>
        - C. it: đại từ nhân xưng, không có chức năng nối mệnh đề.<br>
        - D. that it: thừa đại từ 'it'.<br><br>
        <b>3. Giải thích chi tiết:</b><br>
        Tiền ngữ 'The severe drought' (trận hạn hán) là sự vật. Ta cần một đại từ quan hệ làm chủ ngữ cho động từ 'occurred'. 'That' hoặc 'which' đều được. Các đáp án khác sai vì lặp lại chủ ngữ 'it'.
      `
    },
    {
      "questionNumber": 48,
      "question": "What is the name of the hotel ________ you recommended I stay at when visiting Seoul?",
      "answerOptions": [
        { "text": "that", "isCorrect": true },
        { "text": "what", "isCorrect": false },
        { "text": "whom", "isCorrect": false },
        { "text": "whose", "isCorrect": false }
      ],
      "explanation": `
        <b>1. Dịch nghĩa:</b> Tên của khách sạn mà bạn đã giới thiệu tôi ở khi đến Seoul là gì?<br><br>
        <b>2. Phân tích đáp án:</b><br>
        - A. that: chỉ vật.<br>
        - B. what: nghĩa là "những gì", không làm đại từ quan hệ thay thế cho danh từ đứng trước.<br>
        - C. whom: chỉ người.<br>
        - D. whose: chỉ sở hữu.<br><br>
        <b>3. Giải thích chi tiết:</b><br>
        Tiền ngữ 'the hotel' (khách sạn) chỉ vật. Trong mệnh đề quan hệ xác định, ta dùng 'that' hoặc 'which'.
      `
    },
    {
      "questionNumber": 49,
      "question": "The carnivores, ________ diet consists of meat, occupy the secondary level of the food chain.",
      "answerOptions": [
        { "text": "whose", "isCorrect": true },
        { "text": "which", "isCorrect": false },
        { "text": "who", "isCorrect": false },
        { "text": "that", "isCorrect": false }
      ],
      "explanation": `
        <b>1. Dịch nghĩa:</b> Động vật ăn thịt, loài có chế độ ăn bao gồm thịt, chiếm cấp độ thứ hai của chuỗi thức ăn.<br><br>
        <b>2. Phân tích đáp án:</b><br>
        - A. whose: chỉ sở hữu.<br>
        - B. which: chỉ vật.<br>
        - C. who: chỉ người.<br>
        - D. that: không dùng sau dấu phẩy.<br><br>
        <b>3. Giải thích chi tiết:</b><br>
        'Diet' (chế độ ăn) là thuộc tính CỦA 'carnivores' (động vật ăn thịt). Mối quan hệ sở hữu -> Dùng 'whose'.
      `
    },
    {
      "questionNumber": 50,
      "question": "The land and the people ________ I have met are nice.",
      "answerOptions": [
        { "text": "that", "isCorrect": true },
        { "text": "whom", "isCorrect": false },
        { "text": "who", "isCorrect": false },
        { "text": "which", "isCorrect": false }
      ],
      "explanation": `
        <b>1. Dịch nghĩa:</b> Mảnh đất và con người mà tôi đã gặp đều rất tuyệt.<br><br>
        <b>2. Phân tích đáp án:</b><br>
        - A. that: dùng cho cả người và vật.<br>
        - B. whom: chỉ người.<br>
        - C. who: chỉ người.<br>
        - D. which: chỉ vật.<br><br>
        <b>3. Giải thích chi tiết:</b><br>
        Tiền ngữ là cụm hỗn hợp 'The land and the people' (Vật và Người). Trong trường hợp này, bắt buộc phải dùng 'that' vì 'who/whom' chỉ dùng cho người, 'which' chỉ dùng cho vật.
      `
    },
    {
      "questionNumber": 51,
      "question": "Elizabeth Cady Santon, ________, was one of the famous women's-rights activists.",
      "answerOptions": [
        { "text": "who was born in 1815", "isCorrect": true },
        { "text": "whose year was 1815", "isCorrect": false },
        { "text": "which she was born in 1815", "isCorrect": false },
        { "text": "that was born in 1815", "isCorrect": false }
      ],
      "explanation": `
        <b>1. Dịch nghĩa:</b> Elizabeth Cady Stanton, người sinh năm 1815, là một trong những nhà hoạt động vì quyền phụ nữ nổi tiếng.<br><br>
        <b>2. Phân tích đáp án:</b><br>
        - A. who was born...: đúng ngữ pháp (who thay cho người, làm chủ ngữ).<br>
        - B. whose year...: diễn đạt vụng về, không tự nhiên.<br>
        - C. which...: 'which' không dùng cho người.<br>
        - D. that...: 'that' không dùng sau dấu phẩy.<br><br>
        <b>3. Giải thích chi tiết:</b><br>
        Tiền ngữ là tên riêng chỉ người. Mệnh đề trong dấu phẩy bổ sung thông tin về năm sinh. Cấu trúc đúng: 'who' + động từ (was born).
      `
    },
    {
      "questionNumber": 52,
      "question": "He’s the professor ________ classes always score well on standardized tests.",
      "answerOptions": [
        { "text": "whose", "isCorrect": true },
        { "text": "who", "isCorrect": false },
        { "text": "whom", "isCorrect": false },
        { "text": "that", "isCorrect": false }
      ],
      "explanation": `
        <b>1. Dịch nghĩa:</b> Ông ấy là vị giáo sư mà các lớp học của ông luôn đạt điểm cao trong các bài kiểm tra chuẩn hóa.<br><br>
        <b>2. Phân tích đáp án:</b><br>
        - A. whose: chỉ sở hữu.<br>
        - B. who: chủ ngữ chỉ người.<br>
        - C. whom: tân ngữ chỉ người.<br>
        - D. that: chỉ người/vật.<br><br>
        <b>3. Giải thích chi tiết:</b><br>
        'Classes' (các lớp học) là CỦA 'the professor' (giáo sư). Mối quan hệ sở hữu -> Dùng 'whose'. Các từ còn lại không mang nghĩa sở hữu.
      `
    },
    {
      "questionNumber": 53,
      "question": "Forest habitats, _______ include tropical, temperate, and boreal forests, are considered the Earth's lung.",
      "answerOptions": [
        { "text": "which", "isCorrect": true },
        { "text": "who", "isCorrect": false },
        { "text": "where", "isCorrect": false },
        { "text": "that", "isCorrect": false }
      ],
      "explanation": `
        <b>1. Dịch nghĩa:</b> Các môi trường sống rừng, bao gồm rừng nhiệt đới, ôn đới và phương bắc, được coi là lá phổi của Trái Đất.<br><br>
        <b>2. Phân tích đáp án:</b><br>
        - A. which: chỉ vật.<br>
        - B. who: chỉ người.<br>
        - C. where: chỉ nơi chốn (trạng từ).<br>
        - D. that: không dùng sau dấu phẩy.<br><br>
        <b>3. Giải thích chi tiết:</b><br>
        Tiền ngữ 'Forest habitats' (môi trường sống rừng) là vật. Mệnh đề có dấu phẩy. Chỗ trống cần chủ ngữ cho động từ 'include'.
        -> 'Which' là đáp án đúng. 'Where' sai vì 'where' = 'in which', không làm chủ ngữ cho động từ.
      `
    },
    {
      "questionNumber": 54,
      "question": "The coral reef ________ thrives in warm, shallow waters, supports a vast array of marine life.",
      "answerOptions": [
        { "text": "which", "isCorrect": true },
        { "text": "who", "isCorrect": false },
        { "text": "that", "isCorrect": false },
        { "text": "(Duplicate which)", "isCorrect": false }
      ],
      "explanation": `
        <b>1. Dịch nghĩa:</b> Rạn san hô, thứ phát triển mạnh ở vùng nước ấm và nông, nuôi dưỡng vô số sinh vật biển.<br><br>
        <b>2. Phân tích đáp án:</b><br>
        - A. which: chỉ vật.<br>
        - B. who: chỉ người.<br>
        - C. that: thường dùng cho mệnh đề xác định (không dấu phẩy) hoặc không dùng trong non-defining.<br><br>
        <b>3. Giải thích chi tiết:</b><br>
        'The coral reef' (rạn san hô) là vật. Câu này mang tính chất cung cấp thêm thông tin đặc điểm (non-defining, dù đề bài có thể thiếu dấu phẩy trước đó nhưng ngữ cảnh gợi ý). 'Which' là lựa chọn an toàn và chính xác nhất cho vật trong trường hợp này.
      `
    },
    {
      "questionNumber": 55,
      "question": "The committee, ________ by the Board of Directors next week, is going to be responsible for solving the discipline problems.",
      "answerOptions": [
        { "text": "which will be appointed", "isCorrect": true },
        { "text": "who is appointed", "isCorrect": false },
        { "text": "appointing", "isCorrect": false },
        { "text": "be appointed", "isCorrect": false }
      ],
      "explanation": `
        <b>1. Dịch nghĩa:</b> Ủy ban, cái mà sẽ được bổ nhiệm bởi Hội đồng quản trị vào tuần tới, sẽ chịu trách nhiệm giải quyết các vấn đề kỷ luật.<br><br>
        <b>2. Phân tích đáp án:</b><br>
        - A. which will be appointed: Đúng (which thay cho vật/tổ chức + bị động tương lai).<br>
        - B. who is appointed: Sai (dùng who cho tổ chức không hay bằng which, sai thì hiện tại với 'next week').<br>
        - C. appointing: Sai (dạng chủ động, trong khi ủy ban ĐƯỢC bổ nhiệm).<br>
        - D. be appointed: Sai ngữ pháp (thiếu chủ ngữ/trợ động từ).<br><br>
        <b>3. Giải thích chi tiết:</b><br>
        Tiền ngữ 'The committee' là danh từ chỉ tập hợp/vật. Có cụm 'next week' -> thì tương lai. Có 'by...' -> thể bị động.
        -> Đáp án A đầy đủ và chính xác nhất.
      `
    },
    {
      "questionNumber": 56,
      "question": "Is that the same film ________ we watched last year?",
      "answerOptions": [
        { "text": "which", "isCorrect": true },
        { "text": "why", "isCorrect": false },
        { "text": "when", "isCorrect": false },
        { "text": "who", "isCorrect": false }
      ],
      "explanation": `
        <b>1. Dịch nghĩa:</b> Đó có phải là cùng bộ phim mà chúng ta đã xem năm ngoái không?<br><br>
        <b>2. Phân tích đáp án:</b><br>
        - A. which: chỉ vật.<br>
        - B. why: chỉ lý do.<br>
        - C. when: chỉ thời gian.<br>
        - D. who: chỉ người.<br><br>
        <b>3. Giải thích chi tiết:</b><br>
        Tiền ngữ là 'film' (vật). Bình thường sau 'the same' ta ưu tiên dùng 'that', nhưng nếu không có 'that' thì 'which' là lựa chọn thay thế duy nhất đúng về loại từ.
      `
    },
    {
      "questionNumber": 57,
      "question": "Mr Johnson, ________ only son died in Vietnam War, is working in Vietnam now.",
      "answerOptions": [
        { "text": "whose", "isCorrect": true },
        { "text": "whom", "isCorrect": false },
        { "text": "which", "isCorrect": false },
        { "text": "who", "isCorrect": false }
      ],
      "explanation": `
        <b>1. Dịch nghĩa:</b> Ông Johnson, người có con trai duy nhất hy sinh trong chiến tranh Việt Nam, hiện đang làm việc tại Việt Nam.<br><br>
        <b>2. Phân tích đáp án:</b><br>
        - A. whose: chỉ sở hữu.<br>
        - B. whom: chỉ tân ngữ.<br>
        - C. which: chỉ vật.<br>
        - D. who: chỉ chủ ngữ.<br><br>
        <b>3. Giải thích chi tiết:</b><br>
        'Only son' (con trai duy nhất) là con CỦA ông Johnson. Mối quan hệ huyết thống/sở hữu -> Dùng 'whose'.
      `
    },
    {
      "questionNumber": 58,
      "question": "Mount Everest, ________ peak is the tallest mountain in the world, is located in the Himalayas.",
      "answerOptions": [
        { "text": "whose", "isCorrect": true },
        { "text": "which", "isCorrect": false },
        { "text": "who", "isCorrect": false },
        { "text": "that", "isCorrect": false }
      ],
      "explanation": `
        <b>1. Dịch nghĩa:</b> Đỉnh Everest, nơi có đỉnh núi cao nhất thế giới, nằm ở dãy Himalayas.<br><br>
        <b>2. Phân tích đáp án:</b><br>
        - A. whose: chỉ sở hữu (dùng được cho cả vật).<br>
        - B. which: chỉ vật.<br>
        - C. who: chỉ người.<br>
        - D. that: không dùng sau dấu phẩy.<br><br>
        <b>3. Giải thích chi tiết:</b><br>
        'Peak' (đỉnh) là một phần CỦA 'Mount Everest'. Để chỉ sự sở hữu của vật, ta dùng 'whose' (hoặc of which the peak). Ở đây 'whose' là đáp án đúng.
      `
    },
    {
      "questionNumber": 59,
      "question": "I have always wanted to visit Paris, ________ of France.",
      "answerOptions": [
        { "text": "the capital", "isCorrect": true },
        { "text": "is the capital", "isCorrect": false },
        { "text": "which the capital is", "isCorrect": false },
        { "text": "that is the capital", "isCorrect": false }
      ],
      "explanation": `
        <b>1. Dịch nghĩa:</b> Tôi luôn muốn đến thăm Paris, thủ đô của Pháp.<br><br>
        <b>2. Phân tích đáp án:</b><br>
        - A. the capital: Cụm danh từ (Đồng vị ngữ).<br>
        - B. is the capital: Thiếu đại từ quan hệ (sai ngữ pháp: Paris is... is...).<br>
        - C. which the capital is: Trật tự từ sai.<br>
        - D. that is the capital: 'that' không dùng sau dấu phẩy.<br><br>
        <b>3. Giải thích chi tiết:</b><br>
        Đây là dạng rút gọn mệnh đề quan hệ (Appositive - Đồng vị ngữ). Câu đầy đủ là: "Paris, which is the capital of France". Khi rút gọn, ta bỏ 'which is', chỉ còn lại cụm danh từ 'the capital'.
      `
    },
    {
      "questionNumber": 60,
      "question": "I must find a time ________ I can tell her the truth.",
      "answerOptions": [
        { "text": "when", "isCorrect": true },
        { "text": "how", "isCorrect": false },
        { "text": "why", "isCorrect": false },
        { "text": "where", "isCorrect": false }
      ],
      "explanation": `
        <b>1. Dịch nghĩa:</b> Tôi phải tìm một thời điểm khi mà tôi có thể nói cho cô ấy sự thật.<br><br>
        <b>2. Phân tích đáp án:</b><br>
        - A. when: trạng từ quan hệ chỉ thời gian.<br>
        - B. how: chỉ cách thức.<br>
        - C. why: chỉ lý do.<br>
        - D. where: chỉ nơi chốn.<br><br>
        <b>3. Giải thích chi tiết:</b><br>
        Tiền ngữ là 'a time' (một thời điểm/thời gian). Từ dùng để thay thế cho thời gian là 'when' (hoặc 'at which').
      `
    },
    {
      "questionNumber": 61,
      "question": "Dr. Patel, ________ we owe a great deal for her work on climate change, is a leading researcher.",
      "answerOptions": [
        { "text": "whom", "isCorrect": true },
        { "text": "whose", "isCorrect": false },
        { "text": "who", "isCorrect": false },
        { "text": "which", "isCorrect": false }
      ],
      "explanation": `
        <b>1. Dịch nghĩa:</b> Tiến sĩ Patel, người mà chúng tôi mang ơn rất nhiều vì công việc của bà về biến đổi khí hậu, là một nhà nghiên cứu hàng đầu.<br><br>
        <b>2. Phân tích đáp án:</b><br>
        - A. whom: chỉ tân ngữ (người).<br>
        - B. whose: chỉ sở hữu.<br>
        - C. who: chỉ chủ ngữ (người).<br>
        - D. which: chỉ vật.<br><br>
        <b>3. Giải thích chi tiết:</b><br>
        Tiền ngữ 'Dr. Patel' là người. Cấu trúc câu sau: 'we owe (something) TO someone' -> Dr. Patel đóng vai trò tân ngữ.
        Trong văn phong trang trọng hoặc mệnh đề có dấu phẩy, tân ngữ chỉ người dùng 'whom' là chính xác nhất.
      `
    },
    {
      "questionNumber": 62,
      "question": "I enjoyed talking to the people ________ I had dinner last night.",
      "answerOptions": [
        { "text": "with whom", "isCorrect": true },
        { "text": "with that", "isCorrect": false },
        { "text": "to whom", "isCorrect": false },
        { "text": "with whose", "isCorrect": false }
      ],
      "explanation": `
        <b>1. Dịch nghĩa:</b> Tôi thích nói chuyện với những người mà tôi đã ăn tối cùng tối qua.<br><br>
        <b>2. Phân tích đáp án:</b><br>
        - A. with whom: Chính xác (have dinner WITH someone).<br>
        - B. with that: Sai (không dùng 'that' sau giới từ).<br>
        - C. to whom: Sai giới từ (không nói 'have dinner TO someone').<br>
        - D. with whose: Sai nghĩa/ngữ pháp.<br><br>
        <b>3. Giải thích chi tiết:</b><br>
        Cấu trúc: 'have dinner with someone' (ăn tối với ai).
        Khi đảo giới từ lên trước đại từ quan hệ chỉ người, ta bắt buộc dùng 'whom'. -> 'with whom'.
      `
    },
    {
      "questionNumber": 63,
      "question": "I know a place ________ there are a lot of daffodils.",
      "answerOptions": [
        { "text": "where", "isCorrect": true },
        { "text": "how", "isCorrect": false },
        { "text": "when", "isCorrect": false },
        { "text": "why", "isCorrect": false }
      ],
      "explanation": `
        <b>1. Dịch nghĩa:</b> Tôi biết một nơi mà ở đó có rất nhiều hoa thủy tiên vàng.<br><br>
        <b>2. Phân tích đáp án:</b><br>
        - A. where: chỉ nơi chốn.<br>
        - B. how: chỉ cách thức.<br>
        - C. when: chỉ thời gian.<br>
        - D. why: chỉ lý do.<br><br>
        <b>3. Giải thích chi tiết:</b><br>
        Tiền ngữ 'a place' (một nơi). Mệnh đề phía sau chỉ sự tồn tại của hoa TẠI nơi đó. Dùng trạng từ quan hệ 'where' (hoặc 'in which').
      `
    },
    {
      "questionNumber": 64,
      "question": "An architect is someone ______________ designs buildings.",
      "answerOptions": [
        { "text": "who", "isCorrect": true },
        { "text": "which", "isCorrect": false },
        { "text": "whose", "isCorrect": false },
        { "text": "whom", "isCorrect": false }
      ],
      "explanation": `
        <b>1. Dịch nghĩa:</b> Kiến trúc sư là người thiết kế các tòa nhà.<br><br>
        <b>2. Phân tích đáp án:</b><br>
        - A. who: chỉ người (chủ ngữ).<br>
        - B. which: chỉ vật.<br>
        - C. whose: chỉ sở hữu.<br>
        - D. whom: chỉ người (tân ngữ).<br><br>
        <b>3. Giải thích chi tiết:</b><br>
        Tiền ngữ 'someone' (ai đó) chỉ người. Động từ 'designs' phía sau cần một chủ ngữ. -> Dùng 'who'.
      `
    },
    {
      "questionNumber": 65,
      "question": "Da Lat, ______________ I'd like to visit most, is very romantic.",
      "answerOptions": [
        { "text": "which", "isCorrect": true },
        { "text": "that", "isCorrect": false },
        { "text": "when", "isCorrect": false },
        { "text": "whose", "isCorrect": false }
      ],
      "explanation": `
        <b>1. Dịch nghĩa:</b> Đà Lạt, nơi mà tôi muốn đến thăm nhất, rất lãng mạn.<br><br>
        <b>2. Phân tích đáp án:</b><br>
        - A. which: đại từ quan hệ (làm tân ngữ ở đây).<br>
        - B. that: không dùng sau dấu phẩy.<br>
        - C. when: chỉ thời gian.<br>
        - D. whose: chỉ sở hữu.<br><br>
        <b>3. Giải thích chi tiết:</b><br>
        Lưu ý bẫy: Nhiều bạn thấy địa danh thường chọn 'where'. Nhưng hãy nhìn động từ 'visit'. Ta nói 'visit Da Lat' (thăm Đà Lạt - tân ngữ trực tiếp), chứ không nói 'visit AT Da Lat'.
        -> Do đó, Đà Lạt ở đây đóng vai trò tân ngữ -> Dùng 'which'.
        (Nếu dùng 'where' thì câu phải là: Da Lat, where I lived... - sống TẠI Đà Lạt).
      `
    },
    {
      "questionNumber": 66,
      "question": "One of the world's most famous Earth scientists is James Hutton, _______ is a British geologist.",
      "answerOptions": [
        { "text": "who", "isCorrect": true },
        { "text": "which", "isCorrect": false },
        { "text": "whom", "isCorrect": false },
        { "text": "that", "isCorrect": false }
      ],
      "explanation": `
        <b>1. Dịch nghĩa:</b> Một trong những nhà khoa học Trái đất nổi tiếng nhất thế giới là James Hutton, ông là một nhà địa chất học người Anh.<br><br>
        <b>2. Phân tích đáp án:</b><br>
        - A. who: chỉ người (chủ ngữ).<br>
        - B. which: chỉ vật.<br>
        - C. whom: chỉ người (tân ngữ).<br>
        - D. that: không dùng sau dấu phẩy.<br><br>
        <b>3. Giải thích chi tiết:</b><br>
        Tiền ngữ 'James Hutton' là tên người. Mệnh đề non-defining có động từ 'is' phía sau -> Cần chủ ngữ chỉ người -> Chọn 'who'.
      `
    },
    {
      "questionNumber": 67,
      "question": "That's the reason ______________ I didn't come to the meeting last night.",
      "answerOptions": [
        { "text": "why", "isCorrect": true },
        { "text": "which", "isCorrect": false },
        { "text": "where", "isCorrect": false },
        { "text": "when", "isCorrect": false }
      ],
      "explanation": `
        <b>1. Dịch nghĩa:</b> Đó là lý do tại sao tôi không đến cuộc họp tối qua.<br><br>
        <b>2. Phân tích đáp án:</b><br>
        - A. why: trạng từ quan hệ chỉ lý do.<br>
        - B. which: đại từ quan hệ (nếu dùng phải là 'for which').<br>
        - C. where: chỉ nơi chốn.<br>
        - D. when: chỉ thời gian.<br><br>
        <b>3. Giải thích chi tiết:</b><br>
        Tiền ngữ là 'the reason' (lý do). Đi với 'reason' ta dùng 'why' (hoặc 'for which').
      `
    },
    {
      "questionNumber": 68,
      "question": "The Earth’s core, ______________ temperature is extremely hot, is made up mostly of iron and nickel.",
      "answerOptions": [
        { "text": "whose", "isCorrect": true },
        { "text": "why", "isCorrect": false },
        { "text": "where", "isCorrect": false },
        { "text": "which", "isCorrect": false }
      ],
      "explanation": `
        <b>1. Dịch nghĩa:</b> Lõi Trái Đất, nơi có nhiệt độ cực nóng, được cấu tạo chủ yếu từ sắt và niken.<br><br>
        <b>2. Phân tích đáp án:</b><br>
        - A. whose: chỉ sở hữu.<br>
        - B. why: chỉ lý do.<br>
        - C. where: chỉ nơi chốn.<br>
        - D. which: chỉ vật.<br><br>
        <b>3. Giải thích chi tiết:</b><br>
        'Temperature' (nhiệt độ) là đặc tính CỦA 'Earth's core' (lõi Trái Đất). Mối quan hệ sở hữu -> Dùng 'whose'.
      `
    },
    {
      "questionNumber": 69,
      "question": "Please don’t waste a lot of time correcting details ________ completely inaccurate.",
      "answerOptions": [
        { "text": "that are", "isCorrect": true },
        { "text": "that they aren’t", "isCorrect": false },
        { "text": "that isn’t", "isCorrect": false },
        { "text": "that it isn’t", "isCorrect": false }
      ],
      "explanation": `
        <b>1. Dịch nghĩa:</b> Làm ơn đừng tốn thời gian sửa những chi tiết hoàn toàn không chính xác.<br><br>
        <b>2. Phân tích đáp án:</b><br>
        - A. that are: 'that' thay cho 'details', 'are' chia số nhiều -> Đúng.<br>
        - B. that they...: thừa chủ ngữ 'they' (vì that đã là chủ ngữ).<br>
        - C. that isn't: sai động từ 'is' (vì details là số nhiều).<br>
        - D. that it...: thừa 'it', sai 'is'.<br><br>
        <b>3. Giải thích chi tiết:</b><br>
        Tiền ngữ 'details' là danh từ số nhiều. Cần đại từ quan hệ 'that' (hoặc which) làm chủ ngữ, và động từ tobe phải chia số nhiều 'are'.
      `
    },
    {
      "questionNumber": 70,
      "question": "______________ instructed me how to make a good preparation for a job interview.",
      "answerOptions": [
        { "text": "Mr. Brown, whom I spoke to by telephone,", "isCorrect": true },
        { "text": "Mr. Brown I spoke to telephone", "isCorrect": false },
        { "text": "Mr. Brown, that I spoke by telephone", "isCorrect": false },
        { "text": "Mr. Brown to that I spoke by telephone", "isCorrect": false }
      ],
      "explanation": `
        <b>1. Dịch nghĩa:</b> Ông Brown, người mà tôi đã nói chuyện qua điện thoại, đã hướng dẫn tôi cách chuẩn bị tốt cho buổi phỏng vấn xin việc.<br><br>
        <b>2. Phân tích đáp án:</b><br>
        - A. Cấu trúc đúng: S + , + whom... + , + V.<br>
        - B. Sai vì thiếu đại từ quan hệ/dấu phẩy.<br>
        - C. Sai vì dùng 'that' sau dấu phẩy.<br>
        - D. Sai vì dùng 'to that'.<br><br>
        <b>3. Giải thích chi tiết:</b><br>
        Câu gốc thiếu chủ ngữ cho động từ 'instructed'. Đáp án A cung cấp chủ ngữ 'Mr. Brown' kèm theo một mệnh đề quan hệ bổ sung thông tin (non-defining) được ngăn cách bởi dấu phẩy là hoàn toàn chính xác.
      `
    },
    {
      "questionNumber": 71,
      "question": "The Amazon rainforest, ______________ is considered the “lungs of the planet,” is crucial for our environment.",
      "answerOptions": [
        { "text": "which", "isCorrect": true },
        { "text": "whom", "isCorrect": false },
        { "text": "who", "isCorrect": false },
        { "text": "that", "isCorrect": false }
      ],
      "explanation": `
        <b>1. Dịch nghĩa:</b> Rừng mưa Amazon, nơi được coi là “lá phổi của hành tinh”, rất quan trọng đối với môi trường của chúng ta.<br><br>
        <b>2. Phân tích đáp án:</b><br>
        - A. which: chỉ vật.<br>
        - B. whom: chỉ người.<br>
        - C. who: chỉ người.<br>
        - D. that: không dùng sau dấu phẩy.<br><br>
        <b>3. Giải thích chi tiết:</b><br>
        Tiền ngữ 'The Amazon rainforest' là vật. Mệnh đề non-defining (có dấu phẩy). -> Dùng 'which'.
      `
    },
    {
      "questionNumber": 72,
      "question": "The Earth’s magnetic field, ______________ protection deflects charged particles from the sun, is crucial for life.",
      "answerOptions": [
        { "text": "whose", "isCorrect": true },
        { "text": "where", "isCorrect": false },
        { "text": "when", "isCorrect": false },
        { "text": "which", "isCorrect": false }
      ],
      "explanation": `
        <b>1. Dịch nghĩa:</b> Từ trường Trái đất, sự bảo vệ của nó làm lệch hướng các hạt tích điện từ mặt trời, rất quan trọng cho sự sống.<br><br>
        <b>2. Phân tích đáp án:</b><br>
        - A. whose: chỉ sở hữu.<br>
        - B. where: chỉ nơi chốn.<br>
        - C. when: chỉ thời gian.<br>
        - D. which: chỉ vật (không có nghĩa sở hữu).<br><br>
        <b>3. Giải thích chi tiết:</b><br>
        'Protection' (sự bảo vệ) là chức năng/thuộc tính CỦA 'magnetic field' (từ trường). Mối quan hệ sở hữu -> Dùng 'whose'.
      `
    },
    {
      "questionNumber": 73,
      "question": "The boy to ______________ I lent my money is poor.",
      "answerOptions": [
        { "text": "whom", "isCorrect": true },
        { "text": "which", "isCorrect": false },
        { "text": "who", "isCorrect": false },
        { "text": "that", "isCorrect": false }
      ],
      "explanation": `
        <b>1. Dịch nghĩa:</b> Cậu bé mà tôi đã cho mượn tiền rất nghèo.<br><br>
        <b>2. Phân tích đáp án:</b><br>
        - A. whom: dùng sau giới từ chỉ người.<br>
        - B. which: chỉ vật.<br>
        - C. who: không đứng ngay sau giới từ (thường who...to).<br>
        - D. that: không đứng sau giới từ.<br><br>
        <b>3. Giải thích chi tiết:</b><br>
        Cấu trúc: Lend money TO someone. Giới từ 'to' đã được đảo lên trước. Sau giới từ chỉ người, bắt buộc phải dùng 'whom'.
      `
    },
    {
      "questionNumber": 74,
      "question": "The girl ______________ I borrowed the dictionary asked me to use it carefully.",
      "answerOptions": [
        { "text": "from whom", "isCorrect": true },
        { "text": "from whose", "isCorrect": false },
        { "text": "whom", "isCorrect": false },
        { "text": "whose", "isCorrect": false }
      ],
      "explanation": `
        <b>1. Dịch nghĩa:</b> Cô gái mà tôi mượn cuốn từ điển đã yêu cầu tôi sử dụng nó cẩn thận.<br><br>
        <b>2. Phân tích đáp án:</b><br>
        - A. from whom: Đúng (borrow from + whom).<br>
        - B. from whose: Sai nghĩa.<br>
        - C. whom: Thiếu giới từ 'from'.<br>
        - D. whose: Sai nghĩa.<br><br>
        <b>3. Giải thích chi tiết:</b><br>
        Cấu trúc: 'Borrow something FROM someone' (Mượn cái gì từ ai).
        Khi đảo ngữ, 'from' đi với đại từ quan hệ chỉ người 'whom' -> 'from whom'.
      `
    },
    {
      "questionNumber": 75,
      "question": "The oceans, ______________ cover most of the planet’s surface, are home to a vast variety of life.",
      "answerOptions": [
        { "text": "which", "isCorrect": true },
        { "text": "whose", "isCorrect": false },
        { "text": "where", "isCorrect": false },
        { "text": "that", "isCorrect": false }
      ],
      "explanation": `
        <b>1. Dịch nghĩa:</b> Các đại dương, bao phủ phần lớn bề mặt hành tinh, là nhà của vô số sự sống.<br><br>
        <b>2. Phân tích đáp án:</b><br>
        - A. which: chỉ vật, làm chủ ngữ.<br>
        - B. whose: chỉ sở hữu.<br>
        - C. where: chỉ nơi chốn (trạng từ).<br>
        - D. that: không dùng sau dấu phẩy.<br><br>
        <b>3. Giải thích chi tiết:</b><br>
        Tiền ngữ 'The oceans' là vật. Mệnh đề non-defining. Chỗ trống cần chủ ngữ cho động từ 'cover' (bao phủ).
        -> Chọn 'which'. ('Where' sai vì 'where' không làm chủ ngữ).
      `
    },
    {
      "questionNumber": 76,
      "question": "\"Is April twenty-first the day ______________?\" - \"No, the twenty - second\".",
      "answerOptions": [
        { "text": "when you'll arrive", "isCorrect": true },
        { "text": "when you'll arrive on", "isCorrect": false },
        { "text": "on that you'll arrive", "isCorrect": false },
        { "text": "you'll arrive then", "isCorrect": false }
      ],
      "explanation": `
        <b>1. Dịch nghĩa:</b> "Ngày 21 tháng 4 có phải là ngày bạn sẽ đến không?" - "Không, ngày 22".<br><br>
        <b>2. Phân tích đáp án:</b><br>
        - A. when you'll arrive: Đúng (when = on which).<br>
        - B. when you'll arrive on: Thừa giới từ 'on'.<br>
        - C. on that...: Sai vì không dùng 'on that' trong mệnh đề quan hệ.<br>
        - D. you'll arrive then: Sai cấu trúc nối câu.<br><br>
        <b>3. Giải thích chi tiết:</b><br>
        Tiền ngữ 'the day' chỉ thời gian. Ta dùng 'when' hoặc 'on which'. Đáp án A chính xác nhất.
      `
    },
    {
      "questionNumber": 77,
      "question": "They encountered a pack of wolves ________ hunted together, preying on deer in the forest.",
      "answerOptions": [
        { "text": "that", "isCorrect": true },
        { "text": "who", "isCorrect": false },
        { "text": "(Duplicate who)", "isCorrect": false },
        { "text": "which", "isCorrect": false }
      ],
      "explanation": `
        <b>1. Dịch nghĩa:</b> Họ gặp một bầy sói săn mồi cùng nhau, săn nai trong rừng.<br><br>
        <b>2. Phân tích đáp án:</b><br>
        - A. that: dùng cho người/vật/thú.<br>
        - B. who: thường dùng cho người.<br>
        - D. which: dùng cho vật/thú.<br><br>
        <b>3. Giải thích chi tiết:</b><br>
        Tiền ngữ 'wolves' (chó sói) là động vật. Trong mệnh đề xác định, cả 'that' và 'which' đều dùng được. Tuy nhiên, trong các bài trắc nghiệm, 'that' thường được ưu tiên hoặc chấp nhận như một đáp án phổ biến cho động vật trong defining clause. (Nếu đề bắt chọn 1 giữa that và which thì hơi khó, nhưng 'that' là đáp án an toàn).
      `
    },
    {
      "questionNumber": 78,
      "question": "The Moon, _______ is Earth's natural satellite, orbits around our planet.",
      "answerOptions": [
        { "text": "which", "isCorrect": true },
        { "text": "where", "isCorrect": false },
        { "text": "who", "isCorrect": false },
        { "text": "that", "isCorrect": false }
      ],
      "explanation": `
        <b>1. Dịch nghĩa:</b> Mặt trăng, vệ tinh tự nhiên của Trái đất, quay quanh hành tinh của chúng ta.<br><br>
        <b>2. Phân tích đáp án:</b><br>
        - A. which: chỉ vật.<br>
        - B. where: chỉ nơi chốn.<br>
        - C. who: chỉ người.<br>
        - D. that: không dùng sau dấu phẩy.<br><br>
        <b>3. Giải thích chi tiết:</b><br>
        'The Moon' (vật). Mệnh đề có dấu phẩy -> Bắt buộc dùng 'which'.
      `
    },
    {
      "questionNumber": 79,
      "question": "The book was written by his wife, Joan, ________.",
      "answerOptions": [
        { "text": "whom he married in 1962", "isCorrect": true },
        { "text": "he married in 1962", "isCorrect": false },
        { "text": "who she married him in 1962", "isCorrect": false },
        { "text": "that he married her in 1962", "isCorrect": false }
      ],
      "explanation": `
        <b>1. Dịch nghĩa:</b> Cuốn sách được viết bởi vợ ông, Joan, người mà ông cưới năm 1962.<br><br>
        <b>2. Phân tích đáp án:</b><br>
        - A. whom he married...: Đúng (whom thay cho Joan, làm tân ngữ của married).<br>
        - B. he married...: Sai vì thiếu đại từ quan hệ (không được lược bỏ trong mệnh đề có dấu phẩy).<br>
        - C. who she married him...: Thừa 'she' và 'him'.<br>
        - D. that he married her...: 'that' không dùng sau dấu phẩy, thừa 'her'.<br><br>
        <b>3. Giải thích chi tiết:</b><br>
        'Joan' là tên riêng (người). Cấu trúc 'marry someone' (cưới ai). Joan là tân ngữ. Mệnh đề non-defining dùng 'whom'.
      `
    },
    {
      "questionNumber": 80,
      "question": "I told my professor I’d turn in the essay at 9 o’clock, ________ means I’m going to be up all night.",
      "answerOptions": [
        { "text": "which", "isCorrect": true },
        { "text": "that", "isCorrect": false },
        { "text": "who", "isCorrect": false },
        { "text": "when", "isCorrect": false }
      ],
      "explanation": `
        <b>1. Dịch nghĩa:</b> Tôi đã nói với giáo sư là sẽ nộp bài luận lúc 9 giờ, điều này có nghĩa là tôi sẽ phải thức trắng đêm.<br><br>
        <b>2. Phân tích đáp án:</b><br>
        - A. which: thay thế cho cả mệnh đề phía trước.<br>
        - B. that: không có chức năng này.<br>
        - C. who: chỉ người.<br>
        - D. when: chỉ thời gian.<br><br>
        <b>3. Giải thích chi tiết:</b><br>
        Khi muốn dùng một đại từ quan hệ để thay thế cho **toàn bộ sự việc** được nhắc đến trong mệnh đề phía trước, ta dùng 'which'. (Việc tôi hứa nộp bài lúc 9h -> việc đó có nghĩa là...).
      `
    },
    {
      "questionNumber": 81,
      "question": "Habitat loss, _______ is the destruction of a natural habitat, is the primary threat to the survival of wildlife in the United States.",
      "answerOptions": [
        { "text": "which", "isCorrect": true },
        { "text": "who", "isCorrect": false },
        { "text": "that", "isCorrect": false },
        { "text": "whose", "isCorrect": false }
      ],
      "explanation": `
        <b>1. Dịch nghĩa:</b> Mất môi trường sống, là sự phá hủy môi trường sống tự nhiên, là mối đe dọa chính đối với sự sống còn của động vật hoang dã ở Hoa Kỳ.<br><br>
        <b>2. Phân tích đáp án:</b><br>
        - A. which: chỉ vật/sự việc.<br>
        - B. who: chỉ người.<br>
        - C. that: không dùng sau dấu phẩy.<br>
        - D. whose: chỉ sở hữu.<br><br>
        <b>3. Giải thích chi tiết:</b><br>
        Tiền ngữ 'Habitat loss' là danh từ chỉ sự việc/khái niệm. Mệnh đề non-defining -> Dùng 'which'.
      `
    },
    {
      "questionNumber": 82,
      "question": "I don't want to sit on the chair of ______________ one leg is broken.",
      "answerOptions": [
        { "text": "which", "isCorrect": true },
        { "text": "whom", "isCorrect": false },
        { "text": "who", "isCorrect": false },
        { "text": "whose", "isCorrect": false }
      ],
      "explanation": `
        <b>1. Dịch nghĩa:</b> Tôi không muốn ngồi trên cái ghế mà một chân của nó bị gãy.<br><br>
        <b>2. Phân tích đáp án:</b><br>
        - A. which: đi với giới từ 'of' -> 'of which' = 'whose'.<br>
        - B, C: chỉ người.<br>
        - D. whose: nếu dùng whose thì không có 'of' (whose one leg).<br><br>
        <b>3. Giải thích chi tiết:</b><br>
        Để chỉ sở hữu cho vật, ta có 2 cách:<br>
        1. whose + Noun<br>
        2. Noun + of which (hoặc of which + Noun)<br>
        Ở đây đề bài đã cho sẵn 'of', nên đáp án phải là 'which'.
      `
    },
    {
      "questionNumber": 83,
      "question": "My favourite holiday was the one ________ in a cottage in the mountains.",
      "answerOptions": [
        { "text": "we spent", "isCorrect": true },
        { "text": "that we spent it", "isCorrect": false },
        { "text": "which spent", "isCorrect": false },
        { "text": "where we spent", "isCorrect": false }
      ],
      "explanation": `
        <b>1. Dịch nghĩa:</b> Kỳ nghỉ yêu thích của tôi là kỳ nghỉ mà chúng tôi đã dành trong một ngôi nhà gỗ trên núi.<br><br>
        <b>2. Phân tích đáp án:</b><br>
        - A. we spent: Đã lược bỏ đại từ quan hệ (that/which).<br>
        - B. that we spent it: Thừa tân ngữ 'it'.<br>
        - C. which spent: Sai vì 'holiday' không tự 'spent' (thiếu chủ ngữ we).<br>
        - D. where we spent: Sai vì 'spent' là ngoại động từ (spend time/holiday), cần tân ngữ trực tiếp (which/that), không dùng trạng từ 'where'.<br><br>
        <b>3. Giải thích chi tiết:</b><br>
        'The one' là tân ngữ của động từ 'spent'. Trong mệnh đề quan hệ xác định, khi đại từ quan hệ làm tân ngữ, ta có thể lược bỏ nó. -> 'we spent'.
      `
    },
    {
      "questionNumber": 84,
      "question": "We should listen to the experts ______________ have dedicated their lives to studying our planet.",
      "answerOptions": [
        { "text": "who", "isCorrect": true },
        { "text": "whose", "isCorrect": false },
        { "text": "which", "isCorrect": false },
        { "text": "whom", "isCorrect": false }
      ],
      "explanation": `
        <b>1. Dịch nghĩa:</b> Chúng ta nên lắng nghe những chuyên gia, những người đã cống hiến cuộc đời để nghiên cứu hành tinh của chúng ta.<br><br>
        <b>2. Phân tích đáp án:</b><br>
        - A. who: chỉ người (chủ ngữ).<br>
        - B. whose: chỉ sở hữu.<br>
        - C. which: chỉ vật.<br>
        - D. whom: chỉ người (tân ngữ).<br><br>
        <b>3. Giải thích chi tiết:</b><br>
        Tiền ngữ 'experts' (chuyên gia) là người. Động từ 'have dedicated' cần một chủ ngữ. -> Dùng 'who'.
      `
    },
    {
      "questionNumber": 85,
      "question": "The chemistry book ______________ was a little expensive.",
      "answerOptions": [
        { "text": "I bought", "isCorrect": true },
        { "text": "I bought that", "isCorrect": false },
        { "text": "what I bought", "isCorrect": false },
        { "text": "that I bought it", "isCorrect": false }
      ],
      "explanation": `
        <b>1. Dịch nghĩa:</b> Cuốn sách hóa học tôi đã mua hơi đắt một chút.<br><br>
        <b>2. Phân tích đáp án:</b><br>
        - A. I bought: Lược bỏ đại từ quan hệ (which/that).<br>
        - B. I bought that: Sai vị trí từ 'that'.<br>
        - C. what I bought: Sai ('what' = the thing that).<br>
        - D. that I bought it: Thừa 'it'.<br><br>
        <b>3. Giải thích chi tiết:</b><br>
        Tương tự câu 83, 'book' là tân ngữ của 'bought'. Ta có thể lược bỏ đại từ quan hệ -> 'The chemistry book (which) I bought...'.
      `
    },
    {
      "questionNumber": 86,
      "question": "The polar ice caps ________ are melting at an alarming rate contribute to the rise in sea levels.",
      "answerOptions": [
        { "text": "which", "isCorrect": true },
        { "text": "that", "isCorrect": false },
        { "text": "who", "isCorrect": false },
        { "text": "whose", "isCorrect": false }
      ],
      "explanation": `
        <b>1. Dịch nghĩa:</b> Các chỏm băng cực, cái mà đang tan chảy ở mức đáng báo động, góp phần làm mực nước biển dâng cao.<br><br>
        <b>2. Phân tích đáp án:</b><br>
        - A. which: chỉ vật.<br>
        - B. that: chỉ vật (thường dùng trong defining).<br>
        - C. who: chỉ người.<br>
        - D. whose: chỉ sở hữu.<br><br>
        <b>3. Giải thích chi tiết:</b><br>
        Tiền ngữ 'polar ice caps' là vật. Mặc dù mệnh đề này có thể hiểu là xác định (defining - dùng that/which đều được), nhưng trong nhiều tài liệu ngữ pháp truyền thống và đáp án trắc nghiệm, 'which' vẫn là đáp án đúng phổ biến cho vật.
      `
    },
    {
      "questionNumber": 87,
      "question": "Those were the days ______________ we played truant.",
      "answerOptions": [
        { "text": "when", "isCorrect": true },
        { "text": "where", "isCorrect": false },
        { "text": "which", "isCorrect": false },
        { "text": "why", "isCorrect": false }
      ],
      "explanation": `
        <b>1. Dịch nghĩa:</b> Đó là những ngày mà chúng ta đã trốn học.<br><br>
        <b>2. Phân tích đáp án:</b><br>
        - A. when: chỉ thời gian.<br>
        - B. where: chỉ nơi chốn.<br>
        - C. which: chỉ vật (thiếu giới từ 'on').<br>
        - D. why: chỉ lý do.<br><br>
        <b>3. Giải thích chi tiết:</b><br>
        Tiền ngữ 'days' (ngày tháng) chỉ thời gian. -> Dùng trạng từ quan hệ 'when'.
      `
    },
    {
      "questionNumber": 88,
      "question": "That was the time ______________ I was unhappy.",
      "answerOptions": [
        { "text": "when", "isCorrect": true },
        { "text": "where", "isCorrect": false },
        { "text": "why", "isCorrect": false },
        { "text": "which", "isCorrect": false }
      ],
      "explanation": `
        <b>1. Dịch nghĩa:</b> Đó là khoảng thời gian mà tôi không hạnh phúc.<br><br>
        <b>2. Phân tích đáp án:</b><br>
        - A. when: chỉ thời gian.<br>
        - B. where: chỉ nơi chốn.<br>
        - C. why: chỉ lý do.<br>
        - D. which: chỉ vật (thiếu giới từ).<br><br>
        <b>3. Giải thích chi tiết:</b><br>
        Tiền ngữ 'time' (thời gian) -> Dùng 'when'.
      `
    },
    {
      "questionNumber": 89,
      "question": "The bridge is the place ______________ the accident occurred.",
      "answerOptions": [
        { "text": "where", "isCorrect": true },
        { "text": "that", "isCorrect": false },
        { "text": "which", "isCorrect": false },
        { "text": "on which", "isCorrect": false }
      ],
      "explanation": `
        <b>1. Dịch nghĩa:</b> Cây cầu là nơi vụ tai nạn đã xảy ra.<br><br>
        <b>2. Phân tích đáp án:</b><br>
        - A. where: chỉ nơi chốn (= at which).<br>
        - B. that: không thay thế cho trạng ngữ nơi chốn (trừ khi có giới từ cuối câu).<br>
        - C. which: thiếu giới từ (at which).<br>
        - D. on which: về ngữ pháp là đúng (trên cầu), nhưng với từ 'place' thì 'where' (hoặc at which) phổ biến và tự nhiên hơn.<br><br>
        <b>3. Giải thích chi tiết:</b><br>
        Tiền ngữ 'the place' chỉ nơi chốn. Tai nạn xảy ra TẠI nơi đó -> Dùng 'where'.
      `
    }
];

        let currentScore = 0;
        let wrongCount = 0;
        const totalQuestions = questionsData.length;
        const container = document.getElementById('quiz-container');
        const scoreDisplay = document.getElementById('score-display');
        const progressBar = document.getElementById('progress-bar');

        // Sounds
        const audioCorrect = document.getElementById('sound-correct');
        const audioIncorrect = document.getElementById('sound-incorrect');
        const audioFinish = document.getElementById('sound-finish');

        // Render Questions
        function renderQuiz() {
            questionsData.forEach((item, index) => {
                const questionBlock = document.createElement('div');
                questionBlock.className = 'bg-white rounded-3xl p-6 mb-8 shadow-lg border border-gray-100 relative overflow-hidden';
                
                // Question Header
                const qHeader = `
                    <div class="flex items-start mb-6">
                        <div class="bg-purple-100 text-purple-600 rounded-full w-10 h-10 flex items-center justify-center font-bold text-lg mr-4 flex-shrink-0 shadow-inner">
                            ${item.questionNumber}
                        </div>
                        <h3 class="text-xl md:text-2xl font-bold text-gray-800 leading-relaxed pt-1">
                            ${item.question}
                        </h3>
                    </div>
                `;

                // Options Grid
                let optionsHTML = `<div class="grid grid-cols-1 md:grid-cols-2 gap-4" id="options-${index}">`;
                item.answerOptions.forEach((opt, optIndex) => {
                    optionsHTML += `
                        <div class="option-card" 
                             onclick="checkAnswer(${index}, ${optIndex}, this, ${opt.isCorrect})">
                            <span class="mr-3 text-lg opacity-50">${String.fromCharCode(65 + optIndex)}.</span>
                            <span class="text-lg">${opt.text}</span>
                        </div>
                    `;
                });
                optionsHTML += `</div>`;

                // Explanation Box (Hidden by default)
                // Removed redundant "Tai sao SAI" block since it is now integrated
                const explanationHTML = `
                    <div id="explanation-${index}" class="explanation-box rounded-xl p-6 mt-6 hidden">
                        <div class="flex items-center mb-4">
                            <div class="teacher-avatar mr-4">
                                <i class="fas fa-chalkboard-teacher"></i>
                            </div>
                            <div>
                                <h4 class="font-bold text-lg text-purple-700">Cô Mai An giải thích:</h4>
                                <p class="text-xs text-gray-500">Thạc sỹ Ngôn ngữ Anh</p>
                            </div>
                        </div>
                        <div class="prose prose-purple max-w-none text-gray-700 text-sm md:text-base leading-relaxed">
                            ${item.explanation}
                        </div>
                    </div>
                `;

                questionBlock.innerHTML = qHeader + optionsHTML + explanationHTML;
                container.appendChild(questionBlock);
            });
        }

        // Handle Answer Logic
        function checkAnswer(qIndex, optIndex, element, isCorrect) {
            // Prevent re-answering
            const parentGrid = document.getElementById(`options-${qIndex}`);
            if (parentGrid.classList.contains('answered')) return;
            parentGrid.classList.add('answered');

            // Add disable style to all siblings
            const allOptions = parentGrid.children;
            for (let opt of allOptions) {
                opt.classList.add('disabled', 'cursor-not-allowed', 'opacity-60');
            }
            element.classList.remove('opacity-60'); // Keep chosen one clear

            // Show Explanation
            const expBox = document.getElementById(`explanation-${qIndex}`);
            expBox.classList.remove('hidden');

            if (isCorrect) {
                // Correct Logic
                element.classList.add('correct');
                currentScore++;
                scoreDisplay.innerText = currentScore;
                scoreDisplay.classList.add('text-green-600', 'scale-125');
                setTimeout(() => scoreDisplay.classList.remove('scale-125'), 200);
                
                audioCorrect.currentTime = 0;
                audioCorrect.play();
                
                // Confetti from click position
                const rect = element.getBoundingClientRect();
                const x = (rect.left + rect.width / 2) / window.innerWidth;
                const y = (rect.top + rect.height / 2) / window.innerHeight;
                fireConfetti(x, y);

            } else {
                // Incorrect Logic
                element.classList.add('incorrect');
                wrongCount++;
                audioIncorrect.currentTime = 0;
                audioIncorrect.play();
                
                // Highlight the correct one
                const questionData = questionsData[qIndex];
                const correctOptIndex = questionData.answerOptions.findIndex(o => o.isCorrect);
                if (correctOptIndex !== -1) {
                    allOptions[correctOptIndex].classList.add('correct', 'border-4');
                    allOptions[correctOptIndex].classList.remove('opacity-60');
                }
            }

            // Update Progress
            const answeredCount = document.querySelectorAll('.grid.answered').length;
            const progressPercent = (answeredCount / totalQuestions) * 100;
            progressBar.style.width = `${progressPercent}%`;
        }

        // Confetti Effect
        function fireConfetti(x, y) {
            confetti({
                particleCount: 60,
                spread: 70,
                origin: { x: x, y: y },
                colors: ['#8854C0', '#00C9A7', '#FF4757', '#F1C40F'],
                disableForReducedMotion: true
            });
        }

        // Finish Quiz
        function finishQuiz() {
            audioFinish.play();
            document.getElementById('final-score').innerText = currentScore;
            document.getElementById('final-wrong').innerText = wrongCount;
            
            // Random Praise
            const praises = [
                "Xuất sắc! Cô rất tự hào về em!",
                "Làm tốt lắm! Em đã nắm vững kiến thức.",
                "Cố gắng thêm chút nữa là hoàn hảo!",
                "Tuyệt vời! Hãy tiếp tục phát huy nhé."
            ];
            const randomPraise = praises[Math.floor(Math.random() * praises.length)];
            document.getElementById('final-message').innerText = `"${randomPraise}"`;
            
            // Show Confetti Shower
            const duration = 3000;
            const end = Date.now() + duration;

            (function frame() {
                confetti({
                    particleCount: 5,
                    angle: 60,
                    spread: 55,
                    origin: { x: 0 },
                    colors: ['#8854C0', '#00C9A7']
                });
                confetti({
                    particleCount: 5,
                    angle: 120,
                    spread: 55,
                    origin: { x: 1 },
                    colors: ['#FF4757', '#F1C40F']
                });

                if (Date.now() < end) {
                    requestAnimationFrame(frame);
                }
            }());

            document.getElementById('finish-modal').classList.remove('hidden');
        }

        // Initialize
        renderQuiz();
    </script>
</body>
</html>
