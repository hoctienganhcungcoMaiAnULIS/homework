<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Luy·ªán t·∫≠p Hi·ªán t·∫°i ƒë∆°n & Ti·∫øp di·ªÖn - Ms Mai An ULIS</title>
    <link href="https://fonts.googleapis.com/css2?family=Nunito:wght@400;600;700;800&display=swap" rel="stylesheet">
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdn.jsdelivr.net/npm/canvas-confetti@1.6.0/dist/confetti.browser.min.js"></script>
    <style>
        :root {
            --primary: #8854C0;
            --secondary: #00C9A7;
            --correct: #00D26A;
            --wrong: #FF4757;
            --bg-color: #F0F4F8;
            --card-shadow: 0 8px 0 rgba(0,0,0,0.1);
        }

        body {
            font-family: 'Nunito', sans-serif;
            background-color: var(--bg-color);
            background-image: radial-gradient(#8854c033 1px, transparent 1px);
            background-size: 20px 20px;
            color: #2D3436;
        }

        .header-title {
            background: linear-gradient(135deg, var(--primary), #a278d3);
            color: white;
            box-shadow: 0 4px 15px rgba(136, 84, 192, 0.4);
        }

        .quiz-card {
            background: white;
            border-radius: 25px;
            box-shadow: 0 10px 25px rgba(0,0,0,0.05);
            transition: transform 0.3s ease;
            border: 3px solid #E2E8F0;
            margin-bottom: 2rem;
            overflow: hidden;
        }

        .option-btn {
            background: white;
            border: 3px solid #E2E8F0;
            border-bottom-width: 6px;
            border-radius: 18px;
            padding: 15px 20px;
            text-align: left;
            transition: all 0.2s;
            cursor: pointer;
            font-weight: 700;
            font-size: 1.1rem;
            display: block;
            width: 100%;
            margin-bottom: 12px;
            position: relative;
        }

        .option-btn:hover:not(.disabled) {
            transform: translateY(-2px);
            border-color: var(--primary);
            background-color: #F8F4FF;
        }

        .option-btn:active:not(.disabled) {
            transform: translateY(2px);
            border-bottom-width: 3px;
        }

        .option-btn.correct {
            background-color: var(--correct) !important;
            border-color: #00A955 !important;
            color: white !important;
        }

        .option-btn.wrong {
            background-color: var(--wrong) !important;
            border-color: #D63031 !important;
            color: white !important;
        }

        .explanation-box {
            display: none;
            background: #F8F9FA;
            border-left: 6px solid var(--primary);
            border-radius: 15px;
            padding: 20px;
            margin-top: 15px;
            animation: slideDown 0.4s ease-out forwards;
        }

        @keyframes slideDown {
            from { opacity: 0; transform: translateY(-10px); }
            to { opacity: 1; transform: translateY(0); }
        }

        .shake {
            animation: shake 0.5s cubic-bezier(.36,.07,.19,.97) both;
        }

        @keyframes shake {
            10%, 90% { transform: translate3d(-1px, 0, 0); }
            20%, 80% { transform: translate3d(2px, 0, 0); }
            30%, 50%, 70% { transform: translate3d(-4px, 0, 0); }
            40%, 60% { transform: translate3d(4px, 0, 0); }
        }

        .glossary-table th {
            background-color: var(--secondary);
            color: white;
        }

        .floating-score {
            position: fixed;
            top: 20px;
            right: 20px;
            background: white;
            padding: 10px 20px;
            border-radius: 50px;
            box-shadow: var(--card-shadow);
            font-weight: 800;
            border: 3px solid var(--primary);
            z-index: 100;
        }

        /* Q29 & Q30 Custom Styling */
        .phone-mockup {
            background: #e5ddd5;
            border: 12px solid #333;
            border-radius: 30px;
            padding: 10px;
            max-width: 300px;
            margin: 0 auto 20px;
        }
        .message-bubble {
            background: #dcf8c6;
            padding: 10px;
            border-radius: 10px;
            margin-bottom: 5px;
            font-size: 0.9rem;
            box-shadow: 0 1px 1px rgba(0,0,0,0.1);
        }

        .sign-board {
            background: #FFD93D;
            border: 5px solid #000;
            padding: 15px;
            text-align: center;
            font-weight: 900;
            transform: rotate(-2deg);
            box-shadow: 5px 5px 0 #333;
            margin: 20px auto;
            max-width: 400px;
        }

        #summary-modal {
            display: none;
            position: fixed;
            inset: 0;
            background: rgba(0,0,0,0.7);
            z-index: 1000;
            align-items: center;
            justify-content: center;
            backdrop-filter: blur(5px);
        }

        .modal-content {
            background: white;
            padding: 40px;
            border-radius: 30px;
            text-align: center;
            max-width: 500px;
            width: 90%;
            border: 5px solid var(--primary);
        }
    </style>
</head>
<body class="p-4 md:p-8">

    <div class="floating-score">
        Score: <span id="current-score">0</span> / 30
    </div>

    <header class="max-w-4xl mx-auto mb-10 text-center">
        <div class="header-title rounded-3xl py-6 px-4 mb-4">
            <h1 class="text-3xl md:text-4xl font-extrabold mb-1">LUY·ªÜN T·∫¨P HI·ªÜN T·∫†I ƒê∆†N & TI·∫æP DI·ªÑN</h1>
            <p class="text-lg opacity-90 font-semibold">Gi√°o vi√™n t·∫°o: Ms Mai An ULIS</p>
        </div>
        <p class="text-gray-600 italic">Ch·ªçn ƒë√°p √°n ƒë√∫ng nh·∫•t cho m·ªói c√¢u h·ªèi b√™n d∆∞·ªõi!</p>
    </header>

    <main id="quiz-container" class="max-w-4xl mx-auto">
        <!-- Questions will be injected here -->
    </main>

    <div class="max-w-4xl mx-auto text-center py-10">
        <button onclick="showSummary()" class="bg-indigo-600 hover:bg-indigo-700 text-white font-extrabold py-4 px-12 rounded-2xl text-xl shadow-lg transition-all transform hover:scale-105 active:scale-95">
            N·ªòP B√ÄI XEM K·∫æT QU·∫¢ üöÄ
        </button>
    </div>

    <div id="summary-modal">
        <div class="modal-content">
            <h2 class="text-4xl font-extrabold text-indigo-600 mb-4">K·∫æT QU·∫¢ B√ÄI THI</h2>
            <div id="result-emoji" class="text-6xl mb-4">üéâ</div>
            <p id="result-text" class="text-2xl font-bold mb-6"></p>
            <p class="text-xl mb-8">B·∫°n ƒë√∫ng <span id="total-correct" class="text-green-500 font-extrabold">0</span> / 30 c√¢u.</p>
            <button onclick="location.reload()" class="bg-indigo-600 text-white font-bold py-3 px-8 rounded-xl">L√ÄM L·∫†I B√ÄI</button>
        </div>
    </div>

    <!-- Audio Effects -->
    <audio id="sound-correct" src="https://assets.mixkit.co/active_storage/sfx/2000/2000-preview.mp3"></audio>
    <audio id="sound-wrong" src="https://assets.mixkit.co/active_storage/sfx/2003/2003-preview.mp3"></audio>

    <script>
        const questions = [
            {
                q: "Look! The students ______ their new uniforms.",
                options: ["wear", "are wearing", "wears", "wearing"],
                correct: 1,
                hint: "C√≥ 'Look!' th√¨ chia ti·∫øp di·ªÖn.",
                explanation: {
                    translateQ: "Nh√¨n k√¨a! C√°c b·∫°n h·ªçc sinh ƒëang m·∫∑c ƒë·ªìng ph·ª•c m·ªõi.",
                    optionsMap: "A. wear (v): m·∫∑c; B. are wearing (v-ing): ƒëang m·∫∑c; C. wears (v-s): m·∫∑c; D. wearing (thi·∫øu tobe).",
                    whyCorrect: "C√¢u c√≥ t·ª´ 'Look!' b√°o hi·ªáu h√†nh ƒë·ªông ƒëang x·∫£y ra t·∫°i th·ªùi ƒëi·ªÉm n√≥i -> D√πng Hi·ªán t·∫°i ti·∫øp di·ªÖn. Ch·ªß ng·ªØ 'Students' s·ªë nhi·ªÅu n√™n d√πng 'are wearing'.",
                    whyWrong: "A v√† C l√† th√¨ Hi·ªán t·∫°i ƒë∆°n (ch·ªâ th√≥i quen). D thi·∫øu ƒë·ªông t·ª´ tobe 'are'."
                }
            },
            {
                q: "Phong ______ to school by bicycle every day.",
                options: ["cycle", "cycles", "is cycling", "cycling"],
                correct: 1,
                explanation: {
                    translateQ: "Phong ƒë·∫°p xe ƒëi h·ªçc m·ªói ng√†y.",
                    optionsMap: "A. cycle (v-nguy√™n th·ªÉ); B. cycles (v-s); C. is cycling (ti·∫øp di·ªÖn); D. cycling (sai c·∫•u tr√∫c).",
                    whyCorrect: "D·∫•u hi·ªáu 'every day' ch·ªâ th√≥i quen l·∫∑p ƒëi l·∫∑p l·∫°i -> d√πng Hi·ªán t·∫°i ƒë∆°n. Ch·ªß ng·ªØ 'Phong' l√† ng√¥i th·ª© 3 s·ªë √≠t n√™n ƒë·ªông t·ª´ 'cycle' th√™m 's'.",
                    whyWrong: "A sai v√¨ ch·ªß ng·ªØ s·ªë √≠t kh√¥ng d√πng v-nguy√™n th·ªÉ. C d√πng cho h√†nh ƒë·ªông ƒëang x·∫£y ra. D thi·∫øu tobe."
                }
            },
            {
                q: "Keep silent! The students ______ a test.",
                options: ["do", "are doing", "doing", "does"],
                correct: 1,
                explanation: {
                    translateQ: "H√£y gi·ªØ im l·∫∑ng! C√°c b·∫°n h·ªçc sinh ƒëang l√†m b√†i ki·ªÉm tra.",
                    optionsMap: "A. do (v); B. are doing (v-ing); C. doing (thi·∫øu tobe); D. does (v-es).",
                    whyCorrect: "M·ªánh l·ªánh 'Keep silent!' cho th·∫•y h√†nh ƒë·ªông ƒëang di·ªÖn ra n√™n ph·∫£i d√πng Hi·ªán t·∫°i ti·∫øp di·ªÖn. 'Students' s·ªë nhi·ªÅu ƒëi v·ªõi 'are doing'.",
                    whyWrong: "A v√† D l√† hi·ªán t·∫°i ƒë∆°n. C kh√¥ng ƒë·ªß c·∫•u tr√∫c c·ªßa th√¨ ti·∫øp di·ªÖn."
                }
            },
            {
                q: "My sister ______ have short hair. She has long hair.",
                options: ["isn't", "doesn't", "don't", "not"],
                correct: 1,
                explanation: {
                    translateQ: "Ch·ªã t√¥i kh√¥ng c√≥ t√≥c ng·∫Øn. Ch·ªã ·∫•y c√≥ t√≥c d√†i.",
                    optionsMap: "A. isn't (kh√¥ng ph·∫£i); B. doesn't (tr·ª£ ƒë·ªông t·ª´ ph·ªß ƒë·ªãnh s·ªë √≠t); C. don't (s·ªë nhi·ªÅu); D. not (thi·∫øu tr·ª£ ƒë·ªông t·ª´).",
                    whyCorrect: "M√¥ t·∫£ ngo·∫°i h√¨nh/s·ª± th·∫≠t d√πng Hi·ªán t·∫°i ƒë∆°n. ƒê·ªông t·ª´ th∆∞·ªùng 'have' khi ph·ªß ƒë·ªãnh c·∫ßn m∆∞·ª£n tr·ª£ ƒë·ªông t·ª´ 'does' cho ch·ªß ng·ªØ 'My sister' (s·ªë √≠t).",
                    whyWrong: "A kh√¥ng ƒëi v·ªõi ƒë·ªông t·ª´ 'have'. C sai ng√¥i. D sai ng·ªØ ph√°p."
                }
            },
            {
                q: "Where is Vy? - She ______ in the school garden.",
                options: ["is working", "works", "work", "working"],
                correct: 0,
                explanation: {
                    translateQ: "Vy ƒë√¢u r·ªìi? - C√¥ ·∫•y ƒëang l√†m vi·ªác trong v∆∞·ªùn tr∆∞·ªùng.",
                    optionsMap: "A. is working (ƒëang l√†m); B. works (th√≥i quen); C. work (sai ng√¥i); D. working (thi·∫øu tobe).",
                    whyCorrect: "C√¢u h·ªèi 'Where is...?' ng·ª• √Ω h·ªèi ng∆∞·ªùi ƒë√≥ ƒëang ·ªü ƒë√¢u l√†m g√¨ ngay l√∫c n√†y -> d√πng Hi·ªán t·∫°i ti·∫øp di·ªÖn.",
                    whyWrong: "B v√† C d√πng cho th√≥i quen. D thi·∫øu tobe."
                }
            },
            {
                q: "I ______ Literature on Mondays and Fridays.",
                options: ["have", "having", "am having", "has"],
                correct: 0,
                explanation: {
                    translateQ: "T√¥i c√≥ m√¥n Ng·ªØ vƒÉn v√†o c√°c ng√†y th·ª© Hai v√† th·ª© S√°u.",
                    optionsMap: "A. have (c√≥); B. having (v-ing); C. am having (ƒëang c√≥); D. has (s·ªë √≠t).",
                    whyCorrect: "N√≥i v·ªÅ th·ªùi kh√≥a bi·ªÉu (On Mondays and Fridays) l√† vi·ªác c·ªë ƒë·ªãnh l·∫∑p l·∫°i -> d√πng Hi·ªán t·∫°i ƒë∆°n. Ch·ªß ng·ªØ 'I' ƒëi v·ªõi 'have'.",
                    whyWrong: "B sai c·∫•u tr√∫c. C th∆∞·ªùng kh√¥ng d√πng cho s·ªü h·ªØu/l·ªãch tr√¨nh. D sai ng√¥i."
                }
            },
            {
                q: "At the moment, Nick ______ a video game.",
                options: ["play", "is playing", "plays", "are playing"],
                correct: 1,
                explanation: {
                    translateQ: "Ngay l√∫c n√†y, Nick ƒëang ch∆°i tr√≤ ch∆°i ƒëi·ªán t·ª≠.",
                    optionsMap: "A. play (v); B. is playing (ƒëang ch∆°i - s·ªë √≠t); C. plays (v-s); D. are playing (ƒëang ch∆°i - s·ªë nhi·ªÅu).",
                    whyCorrect: "'At the moment' l√† d·∫•u hi·ªáu ƒë·∫∑c tr∆∞ng c·ªßa Hi·ªán t·∫°i ti·∫øp di·ªÖn. Nick l√† s·ªë √≠t n√™n ch·ªçn 'is playing'.",
                    whyWrong: "A v√† C l√† hi·ªán t·∫°i ƒë∆°n. D sai ng√¥i s·ªë √≠t."
                }
            },
            {
                q: "My brother usually ______ his homework in the evening.",
                options: ["do", "does", "is doing", "doing"],
                correct: 1,
                explanation: {
                    translateQ: "Anh trai t√¥i th∆∞·ªùng l√†m b√†i t·∫≠p v·ªÅ nh√† v√†o bu·ªïi t·ªëi.",
                    optionsMap: "A. do (v); B. does (v-es); C. is doing (ƒëang l√†m); D. doing (v-ing).",
                    whyCorrect: "Tr·∫°ng t·ª´ 'usually' ch·ªâ th√≥i quen -> d√πng Hi·ªán t·∫°i ƒë∆°n. 'My brother' s·ªë √≠t n√™n 'do' th√†nh 'does'.",
                    whyWrong: "A sai ng√¥i. C d√πng cho h√†nh ƒë·ªông ƒëang x·∫£y ra. D thi·∫øu tobe."
                }
            },
            {
                q: "Don't talk! The baby ______.",
                options: ["sleeps", "is sleeping", "are sleeping", "sleeping"],
                correct: 1,
                explanation: {
                    translateQ: "ƒê·ª´ng n√≥i chuy·ªán! Em b√© ƒëang ng·ªß.",
                    optionsMap: "A. sleeps (v-s); B. is sleeping (ƒëang ng·ªß); C. are sleeping (s·ªë nhi·ªÅu); D. sleeping (thi·∫øu tobe).",
                    whyCorrect: "Y√™u c·∫ßu 'Don't talk!' ng·ª• √Ω h√†nh ƒë·ªông ƒëang di·ªÖn ra -> Hi·ªán t·∫°i ti·∫øp di·ªÖn. 'The baby' s·ªë √≠t d√πng 'is'.",
                    whyWrong: "A l√† hi·ªán t·∫°i ƒë∆°n. C sai ng√¥i. D thi·∫øu tobe."
                }
            },
            {
                q: "______ you ______ playing football?",
                options: ["Do / like", "Are / liking", "Does / like", "Do / liking"],
                correct: 0,
                explanation: {
                    translateQ: "B·∫°n c√≥ th√≠ch ch∆°i b√≥ng ƒë√° kh√¥ng?",
                    optionsMap: "A. Do / like (H·ªèi s·ªü th√≠ch); B. Are / liking (Sai v√¨ like kh√¥ng chia ti·∫øp di·ªÖn); C. Does / like (Sai ng√¥i); D. Do / liking (Sai c·∫•u tr√∫c).",
                    whyCorrect: "Like l√† ƒë·ªông t·ª´ ch·ªâ c·∫£m x√∫c (Stative verb), th∆∞·ªùng kh√¥ng d√πng ·ªü th√¨ Ti·∫øp di·ªÖn. ƒê√¢y l√† c√¢u h·ªèi v·ªÅ s·ªü th√≠ch c√° nh√¢n -> Hi·ªán t·∫°i ƒë∆°n.",
                    whyWrong: "Ti·∫øng Anh kh√¥ng d√πng 'Are you liking' ƒë·ªÉ h·ªèi s·ªü th√≠ch th√¥ng th∆∞·ªùng."
                }
            },
            {
                q: "Listen! The birds ______.",
                options: ["sing", "are singing", "is singing", "sings"],
                correct: 1,
                explanation: {
                    translateQ: "Nghe k√¨a! Nh·ªØng ch√∫ chim ƒëang h√≥t.",
                    optionsMap: "A. sing (v); B. are singing (ƒëang h√≥t); C. is singing (s·ªë √≠t); D. sings (v-s).",
                    whyCorrect: "'Listen!' l√† d·∫•u hi·ªáu Hi·ªán t·∫°i ti·∫øp di·ªÖn. 'The birds' s·ªë nhi·ªÅu n√™n d√πng 'are singing'.",
                    whyWrong: "A v√† D l√† hi·ªán t·∫°i ƒë∆°n. C sai ng√¥i s·ªë nhi·ªÅu."
                }
            },
            {
                q: "We ______ usually ______ lunch at school.",
                options: ["don't / have", "aren't / having", "doesn't / have", "don't / has"],
                correct: 0,
                explanation: {
                    translateQ: "Ch√∫ng t√¥i th∆∞·ªùng kh√¥ng ƒÉn tr∆∞a ·ªü tr∆∞·ªùng.",
                    optionsMap: "A. don't / have (ph·ªß ƒë·ªãnh ƒë∆°n); B. aren't / having (ti·∫øp di·ªÖn); C. doesn't / have (sai ng√¥i); D. don't / has (sai ng·ªØ ph√°p).",
                    whyCorrect: "'Usually' b√°o hi·ªáu th√≥i quen -> Hi·ªán t·∫°i ƒë∆°n. 'We' d√πng tr·ª£ ƒë·ªông t·ª´ 'don't'.",
                    whyWrong: "B sai th√¨. C sai ng√¥i. D sau tr·ª£ ƒë·ªông t·ª´ ƒë·ªông t·ª´ ph·∫£i nguy√™n th·ªÉ (have)."
                }
            },
            {
                q: "What ______ your father ______ now?",
                options: ["is / doing", "does / do", "is / do", "are / doing"],
                correct: 0,
                explanation: {
                    translateQ: "B·ªë b·∫°n ƒëang l√†m g√¨ v√†o l√∫c n√†y?",
                    optionsMap: "A. is / doing (ƒëang l√†m); B. does / do (h·ªèi ngh·ªÅ nghi·ªáp/th√≥i quen); C. is / do (sai c·∫•u tr√∫c); D. are / doing (sai ng√¥i).",
                    whyCorrect: "T·ª´ 'now' b·∫Øt bu·ªôc d√πng Hi·ªán t·∫°i ti·∫øp di·ªÖn. 'Your father' l√† ng√¥i th·ª© 3 s·ªë √≠t n√™n d√πng 'is'.",
                    whyWrong: "B d√πng cho th√≥i quen. D sai ng√¥i s·ªë √≠t."
                }
            },
            {
                q: "They ______ friendly. They help me a lot.",
                options: ["are", "is", "being", "are being"],
                correct: 0,
                explanation: {
                    translateQ: "H·ªç r·∫•t th√¢n thi·ªán. H·ªç gi√∫p t√¥i r·∫•t nhi·ªÅu.",
                    optionsMap: "A. are (tobe s·ªë nhi·ªÅu); B. is (tobe s·ªë √≠t); C. being (v-ing); D. are being (ƒëang tr·ªü n√™n - √≠t d√πng ·ªü ƒë√¢y).",
                    whyCorrect: "M√¥ t·∫£ t√≠nh c√°ch l√† s·ª± th·∫≠t l√¢u d√†i -> d√πng Hi·ªán t·∫°i ƒë∆°n v·ªõi ƒë·ªông t·ª´ 'To be'. 'They' ƒëi v·ªõi 'are'.",
                    whyWrong: "B sai ng√¥i. C thi·∫øu tobe. D kh√¥ng ph√π h·ª£p ng·ªØ c·∫£nh m√¥ t·∫£ b·∫£n ch·∫•t."
                }
            },
            {
                q: "Look! The bus ______.",
                options: ["come", "is coming", "comes", "coming"],
                correct: 1,
                explanation: {
                    translateQ: "Nh√¨n k√¨a! Xe bu√Ωt ƒëang ƒë·∫øn.",
                    optionsMap: "A. come (v); B. is coming (ƒëang ƒë·∫øn); C. comes (v-s); D. coming (v-ing).",
                    whyCorrect: "'Look!' + h√†nh ƒë·ªông ƒëang x·∫£y ra -> Hi·ªán t·∫°i ti·∫øp di·ªÖn. 'The bus' s·ªë √≠t d√πng 'is coming'.",
                    whyWrong: "A v√† C d√πng cho th√≥i quen. D thi·∫øu tobe."
                }
            },
            {
                q: "Mi and Lan ______ their homework at present.",
                options: ["are doing", "do", "is doing", "does"],
                correct: 0,
                explanation: {
                    translateQ: "Mi v√† Lan ƒëang l√†m b√†i t·∫≠p v·ªÅ nh√† v√†o l√∫c n√†y.",
                    optionsMap: "A. are doing (ƒëang l√†m); B. do (v); C. is doing (s·ªë √≠t); D. does (v-es).",
                    whyCorrect: "'At present' = Now -> Hi·ªán t·∫°i ti·∫øp di·ªÖn. Mi v√† Lan l√† 2 ng∆∞·ªùi (s·ªë nhi·ªÅu) -> d√πng 'are doing'.",
                    whyWrong: "B v√† D l√† hi·ªán t·∫°i ƒë∆°n. C sai ng√¥i s·ªë nhi·ªÅu."
                }
            },
            {
                q: "How often ______ you ______ your grandparents?",
                options: ["do / visit", "are / visiting", "does / visit", "do / visiting"],
                correct: 0,
                explanation: {
                    translateQ: "B·∫°n c√≥ th∆∞·ªùng xuy√™n ƒëi thƒÉm √¥ng b√† kh√¥ng?",
                    optionsMap: "A. do / visit (h·ªèi t·∫ßn su·∫•t); B. are / visiting (ti·∫øp di·ªÖn); C. does / visit (sai ng√¥i); D. do / visiting (sai c·∫•u tr√∫c).",
                    whyCorrect: "C√¢u h·ªèi 'How often' d√πng ƒë·ªÉ h·ªèi t·∫ßn su·∫•t th√≥i quen -> Hi·ªán t·∫°i ƒë∆°n. 'You' m∆∞·ª£n tr·ª£ ƒë·ªông t·ª´ 'do'.",
                    whyWrong: "Th√¨ ti·∫øp di·ªÖn kh√¥ng d√πng v·ªõi 'How often' trong ng·ªØ c·∫£nh n√†y."
                }
            },
            {
                q: "I ______ to music every night.",
                options: ["listen", "listening", "am listening", "listens"],
                correct: 0,
                explanation: {
                    translateQ: "T√¥i nghe nh·∫°c m·ªói t·ªëi.",
                    optionsMap: "A. listen (v); B. listening (v-ing); C. am listening (ƒëang nghe); D. listens (v-s).",
                    whyCorrect: "'Every night' l√† th√≥i quen m·ªói t·ªëi -> Hi·ªán t·∫°i ƒë∆°n. Ch·ªß ng·ªØ 'I' ƒë·ªông t·ª´ nguy√™n th·ªÉ.",
                    whyWrong: "B thi·∫øu tobe. C d√πng cho l√∫c n√†y. D sai ng√¥i 'I'."
                }
            },
            {
                q: "My mom is in the kitchen. She ______ dinner.",
                options: ["cooks", "is cooking", "cooking", "cook"],
                correct: 1,
                explanation: {
                    translateQ: "M·∫π t√¥i ƒëang ·ªü trong b·∫øp. B√† ·∫•y ƒëang n·∫•u b·ªØa t·ªëi.",
                    optionsMap: "A. cooks (v-s); B. is cooking (ƒëang n·∫•u); C. cooking (v-ing); D. cook (v).",
                    whyCorrect: "V·∫ø tr∆∞·ªõc 'is in the kitchen' l√† ng·ªØ c·∫£nh cho th·∫•y h√†nh ƒë·ªông ƒëang di·ªÖn ra -> Hi·ªán t·∫°i ti·∫øp di·ªÖn.",
                    whyWrong: "A v√† D d√πng cho th√≥i quen. C thi·∫øu tobe."
                }
            },
            {
                q: "The Mekong River ______ through Vietnam.",
                options: ["flow", "flows", "is flowing", "flowing"],
                correct: 1,
                explanation: {
                    translateQ: "S√¥ng M√™ K√¥ng ch·∫£y qua Vi·ªát Nam.",
                    optionsMap: "A. flow (v); B. flows (v-s); C. is flowing (ƒëang ch·∫£y); D. flowing (v-ing).",
                    whyCorrect: "ƒê√¢y l√† m·ªôt s·ª± th·∫≠t hi·ªÉn nhi√™n/ch√¢n l√Ω ƒë·ªãa l√Ω -> d√πng Hi·ªán t·∫°i ƒë∆°n. S√¥ng M√™ K√¥ng (s·ªë √≠t) n√™n ƒë·ªông t·ª´ th√™m 's'.",
                    whyWrong: "Th√¨ ti·∫øp di·ªÖn (C) ch·ªâ h√†nh ƒë·ªông t·∫°m th·ªùi, trong khi d√≤ng ch·∫£y c·ªßa s√¥ng l√† l√¢u d√†i."
                }
            },
            {
                q: "______ Ba ______ his room right now?",
                options: ["Is / cleaning", "Does / clean", "Do / clean", "Is / clean"],
                correct: 0,
                explanation: {
                    translateQ: "Ba c√≥ ƒëang d·ªçn ph√≤ng ngay b√¢y gi·ªù kh√¥ng?",
                    optionsMap: "A. Is / cleaning (ƒëang d·ªçn); B. Does / clean (th√≥i quen); C. Do / clean (sai ng√¥i); D. Is / clean (sai c·∫•u tr√∫c).",
                    whyCorrect: "'Right now' l√† d·∫•u hi·ªáu th√¨ Hi·ªán t·∫°i ti·∫øp di·ªÖn. Ba (s·ªë √≠t) ƒëi v·ªõi 'Is... cleaning'.",
                    whyWrong: "B v√† C sai th√¨. D thi·∫øu ƒëu√¥i -ing cho ƒë·ªông t·ª´."
                }
            },
            {
                q: "I ______ a pencil. Can I borrow yours?",
                options: ["don't have", "am not having", "doesn't have", "not having"],
                correct: 0,
                explanation: {
                    translateQ: "T√¥i kh√¥ng c√≥ b√∫t ch√¨. T√¥i c√≥ th·ªÉ m∆∞·ª£n c·ªßa b·∫°n kh√¥ng?",
                    optionsMap: "A. don't have (kh√¥ng c√≥); B. am not having (ƒëang kh√¥ng c√≥ - sai); C. doesn't have (sai ng√¥i); D. not having (sai c·∫•u tr√∫c).",
                    whyCorrect: "ƒê·ªông t·ª´ 'have' (s·ªü h·ªØu) kh√¥ng chia ·ªü th√¨ ti·∫øp di·ªÖn. D√πng Hi·ªán t·∫°i ƒë∆°n ƒë·ªÉ n√≥i v·ªÅ s·ª± chi·∫øm h·ªØu.",
                    whyWrong: "Ti·∫øng Anh kh√¥ng n√≥i 'I am having a car' ƒë·ªÉ ch·ªâ s·ªü h·ªØu."
                }
            },
            {
                q: "We usually walk to school, but today we ______ the bus.",
                options: ["are taking", "take", "taking", "takes"],
                correct: 0,
                explanation: {
                    translateQ: "Ch√∫ng t√¥i th∆∞·ªùng ƒëi b·ªô ƒë·∫øn tr∆∞·ªùng, nh∆∞ng h√¥m nay ch√∫ng t√¥i ƒëi xe bu√Ωt.",
                    optionsMap: "A. are taking (ƒëang ƒëi/h√¥m nay ƒëi); B. take (v); C. taking (v-ing); D. takes (v-s).",
                    whyCorrect: "D√πng Hi·ªán t·∫°i ti·∫øp di·ªÖn ƒë·ªÉ di·ªÖn t·∫£ h√†nh ƒë·ªông mang t√≠nh ch·∫•t t·∫°m th·ªùi, kh√°c v·ªõi th√≥i quen h·∫±ng ng√†y (c√≥ t·ª´ 'but today').",
                    whyWrong: "B d√πng cho th√≥i quen th√¥ng th∆∞·ªùng, kh√¥ng nh·∫•n m·∫°nh s·ª± kh√°c bi·ªát c·ªßa h√¥m nay."
                }
            },
            {
                q: "Look at the sign! You ______ walk on the grass.",
                options: ["don't", "aren't", "doesn't", "not"],
                correct: 0,
                explanation: {
                    translateQ: "Nh√¨n bi·ªÉn b√°o k√¨a! B·∫°n kh√¥ng ƒë∆∞·ª£c ƒëi tr√™n c·ªè.",
                    optionsMap: "A. don't (kh√¥ng); B. aren't (sai ng·ªØ ph√°p); C. doesn't (sai ng√¥i); D. not (thi·∫øu tr·ª£ ƒë·ªông t·ª´).",
                    whyCorrect: "ƒê√¢y l√† m·ªôt bi·ªÉn b√°o quy ƒë·ªãnh chung -> d√πng Hi·ªán t·∫°i ƒë∆°n. Ph·ªß ƒë·ªãnh m∆∞·ª£n 'don't' cho ch·ªß ng·ªØ 'You'.",
                    whyWrong: "B kh√¥ng ƒëi tr·ª±c ti·∫øp v·ªõi ƒë·ªông t·ª´ nguy√™n th·ªÉ 'walk'."
                }
            },
            {
                q: "What ______ your favorite subject?",
                options: ["is", "are", "does", "do"],
                correct: 0,
                explanation: {
                    translateQ: "M√¥n h·ªçc y√™u th√≠ch c·ªßa b·∫°n l√† g√¨?",
                    optionsMap: "A. is (l√† - s·ªë √≠t); B. are (l√† - s·ªë nhi·ªÅu); C. does (tr·ª£ ƒë·ªông t·ª´); D. do (tr·ª£ ƒë·ªông t·ª´).",
                    whyCorrect: "C√¢u h·ªèi v·ªÅ s·ª± th·∫≠t/th√¥ng tin c∆° b·∫£n d√πng ƒë·ªông t·ª´ To be. 'Subject' l√† danh t·ª´ s·ªë √≠t n√™n d√πng 'is'.",
                    whyWrong: "C v√† D ch·ªâ d√πng khi c√≥ ƒë·ªông t·ª´ th∆∞·ªùng h√†nh ƒë·ªông (nh∆∞ play, study) trong c√¢u."
                }
            },
            {
                q: "It ______ very often in the summer.",
                options: ["rains", "is raining", "rain", "raining"],
                correct: 0,
                explanation: {
                    translateQ: "Tr·ªùi th∆∞·ªùng xuy√™n m∆∞a v√†o m√πa h√®.",
                    optionsMap: "A. rains (v-s); B. is raining (ƒëang m∆∞a); C. rain (v); D. raining (v-ing).",
                    whyCorrect: "N√≥i v·ªÅ quy lu·∫≠t th·ªùi ti·∫øt l·∫∑p l·∫°i (often) -> Hi·ªán t·∫°i ƒë∆°n. Ch·ªß ng·ªØ 'It' ƒë·ªông t·ª´ th√™m 's'.",
                    whyWrong: "B d√πng cho l√∫c n√†y. C sai ng√¥i s·ªë √≠t."
                }
            },
            {
                q: "Please be quiet! My baby sister ______.",
                options: ["is sleeping", "sleeps", "sleep", "are sleeping"],
                correct: 0,
                explanation: {
                    translateQ: "L√†m ∆°n gi·ªØ im l·∫∑ng! Em g√°i t√¥i ƒëang ng·ªß.",
                    optionsMap: "A. is sleeping (ƒëang ng·ªß); B. sleeps (v-s); C. sleep (v); D. are sleeping (s·ªë nhi·ªÅu).",
                    whyCorrect: "D·∫•u hi·ªáu 'Please be quiet!' cho th·∫•y h√†nh ƒë·ªông ƒëang di·ªÖn ra. Em g√°i (s·ªë √≠t) d√πng 'is sleeping'.",
                    whyWrong: "B v√† C l√† hi·ªán t·∫°i ƒë∆°n. D sai ng√¥i s·ªë √≠t."
                }
            },
            {
                q: "They ______ big eyes and black hair.",
                options: ["have", "are having", "has", "having"],
                correct: 0,
                explanation: {
                    translateQ: "H·ªç c√≥ ƒë√¥i m·∫Øt to v√† m√°i t√≥c ƒëen.",
                    optionsMap: "A. have (c√≥); B. are having (ƒëang c√≥ - sai); C. has (s·ªë √≠t); D. having (v-ing).",
                    whyCorrect: "M√¥ t·∫£ ƒë·∫∑c ƒëi·ªÉm ngo·∫°i h√¨nh (s·ª± th·∫≠t) d√πng Hi·ªán t·∫°i ƒë∆°n. ƒê·ªông t·ª´ 'have' kh√¥ng chia ti·∫øp di·ªÖn khi ch·ªâ ƒë·∫∑c ƒëi·ªÉm c∆° th·ªÉ.",
                    whyWrong: "B sai th√¨. C sai ng√¥i s·ªë nhi·ªÅu."
                }
            },
            {
                q: "Look! The boys ______ football in the playground.",
                options: ["are playing", "play", "plays", "is playing"],
                correct: 0,
                type: 'special_message',
                explanation: {
                    translateQ: "Nh√¨n k√¨a! Nh·ªØng c·∫≠u b√© ƒëang ch∆°i b√≥ng ƒë√° ·ªü s√¢n ch∆°i.",
                    optionsMap: "A. are playing (ƒëang ch∆°i); B. play (v); C. plays (v-s); D. is playing (s·ªë √≠t).",
                    whyCorrect: "'Look!' b√°o hi·ªáu th√¨ ti·∫øp di·ªÖn. 'The boys' s·ªë nhi·ªÅu n√™n d√πng 'are playing'.",
                    whyWrong: "B v√† C l√† hi·ªán t·∫°i ƒë∆°n. D sai ng√¥i s·ªë nhi·ªÅu."
                }
            },
            {
                q: "My class ______ at 7:00 a.m every morning.",
                options: ["starts", "is starting", "start", "starting"],
                correct: 0,
                type: 'special_sign',
                explanation: {
                    translateQ: "L·ªõp h·ªçc c·ªßa t√¥i b·∫Øt ƒë·∫ßu l√∫c 7 gi·ªù m·ªói s√°ng.",
                    optionsMap: "A. starts (b·∫Øt ƒë·∫ßu - s·ªë √≠t); B. is starting (ƒëang b·∫Øt ƒë·∫ßu); C. start (v); D. starting (v-ing).",
                    whyCorrect: "Th·ªùi gian bi·ªÉu/L·ªãch tr√¨nh c·ªë ƒë·ªãnh d√πng th√¨ Hi·ªán t·∫°i ƒë∆°n. 'My class' ƒë∆∞·ª£c xem l√† danh t·ª´ s·ªë √≠t (m·ªôt t·∫≠p th·ªÉ).",
                    whyWrong: "B kh√¥ng d√πng cho l·ªãch tr√¨nh l·∫∑p l·∫°i h·∫±ng ng√†y. C sai ng√¥i s·ªë √≠t."
                }
            }
        ];

        let score = 0;
        const answeredQuestions = new Array(questions.length).fill(null);

        function initQuiz() {
            const container = document.getElementById('quiz-container');
            questions.forEach((q, idx) => {
                const card = document.createElement('div');
                card.className = 'quiz-card p-6 md:p-8 mb-8';
                card.id = `q-card-${idx}`;

                let specialHTML = '';
                if (q.type === 'special_message') {
                    specialHTML = `
                        <div class="phone-mockup">
                            <div class="message-bubble">Hey! Look out the window!</div>
                            <div class="message-bubble" style="background:white; align-self:flex-start">What's happening?</div>
                            <div class="message-bubble">The boys ______ football in the playground!</div>
                        </div>
                    `;
                } else if (q.type === 'special_sign') {
                    specialHTML = `
                        <div class="sign-board">
                            SCHOOL SCHEDULE<br>
                            <span class="text-sm">DAILY ROUTINE</span><br>
                            My class ______ at 7:00 a.m
                        </div>
                    `;
                }

                card.innerHTML = `
                    <div class="flex items-center mb-4">
                        <span class="bg-indigo-100 text-indigo-700 w-10 h-10 rounded-full flex items-center justify-center font-extrabold mr-3">
                            ${idx + 1}
                        </span>
                        <h3 class="text-xl font-bold">${q.q}</h3>
                    </div>
                    ${specialHTML}
                    <div class="grid grid-cols-1 md:grid-cols-2 gap-3 mt-4">
                        ${q.options.map((opt, optIdx) => `
                            <button class="option-btn" onclick="checkAnswer(${idx}, ${optIdx})">
                                <span class="text-indigo-400 mr-2">${String.fromCharCode(65 + optIdx)}.</span> ${opt}
                            </button>
                        `).join('')}
                    </div>
                    <div id="exp-${idx}" class="explanation-box">
                        <div class="font-extrabold text-indigo-600 mb-2">üí° C√¥ Mai An gi·∫£i th√≠ch:</div>
                        <div class="space-y-2 text-sm md:text-base">
                            <p><strong>1. D·ªãch c√¢u:</strong> ${q.explanation.translateQ}</p>
                            <p><strong>2. Ph√¢n t√≠ch 4 ƒë√°p √°n:</strong> ${q.explanation.optionsMap}</p>
                            <p><strong>3. T·∫°i sao ƒê√öNG:</strong> ${q.explanation.whyCorrect}</p>
                            <p><strong>4. T·∫°i sao SAI:</strong> ${q.explanation.whyWrong}</p>
                            <div class="mt-4 p-3 bg-indigo-50 rounded-lg border border-indigo-100">
                                <p class="font-bold text-indigo-700">üìå Ghi ch√∫ t·ª´ v·ª±ng (Glossary):</p>
                                <table class="w-full mt-2 text-xs border-collapse">
                                    <thead>
                                        <tr class="bg-indigo-200">
                                            <th class="p-1 border">T·ª´ v·ª±ng</th>
                                            <th class="p-1 border">Lo·∫°i t·ª´</th>
                                            <th class="p-1 border">Nghƒ©a</th>
                                        </tr>
                                    </thead>
                                    <tbody>
                                        <tr>
                                            <td class="p-1 border">Uniform</td>
                                            <td class="p-1 border">n</td>
                                            <td class="p-1 border">ƒê·ªìng ph·ª•c</td>
                                        </tr>
                                        <tr>
                                            <td class="p-1 border">Subject</td>
                                            <td class="p-1 border">n</td>
                                            <td class="p-1 border">M√¥n h·ªçc</td>
                                        </tr>
                                    </tbody>
                                </table>
                            </div>
                        </div>
                    </div>
                `;
                container.appendChild(card);
            });
        }

        window.checkAnswer = function(qIdx, optIdx) {
            if (answeredQuestions[qIdx] !== null) return;
            
            answeredQuestions[qIdx] = optIdx;
            const card = document.getElementById(`q-card-${qIdx}`);
            const buttons = card.querySelectorAll('.option-btn');
            const exp = document.getElementById(`exp-${qIdx}`);
            const isCorrect = optIdx === questions[qIdx].correct;

            buttons.forEach(btn => btn.classList.add('disabled', 'opacity-50', 'cursor-default'));

            if (isCorrect) {
                buttons[optIdx].classList.remove('opacity-50');
                buttons[optIdx].classList.add('correct');
                score++;
                document.getElementById('current-score').innerText = score;
                playCorrect();
                fireConfetti();
            } else {
                buttons[optIdx].classList.remove('opacity-50');
                buttons[optIdx].classList.add('wrong');
                buttons[questions[qIdx].correct].classList.remove('opacity-50');
                buttons[questions[qIdx].correct].classList.add('correct');
                card.classList.add('shake');
                playWrong();
            }

            exp.style.display = 'block';
        }

        function playCorrect() {
            const s = document.getElementById('sound-correct');
            s.currentTime = 0;
            s.play().catch(e => {});
        }

        function playWrong() {
            const s = document.getElementById('sound-wrong');
            s.currentTime = 0;
            s.play().catch(e => {});
        }

        function fireConfetti() {
            confetti({
                particleCount: 100,
                spread: 70,
                origin: { y: 0.6 },
                colors: ['#8854C0', '#00C9A7', '#FFD93D']
            });
        }

        window.showSummary = function() {
            const modal = document.getElementById('summary-modal');
            const resultText = document.getElementById('result-text');
            const resultEmoji = document.getElementById('result-emoji');
            const totalCorrect = document.getElementById('total-correct');

            totalCorrect.innerText = score;
            
            if (score === 30) {
                resultText.innerText = "XU·∫§T S·∫ÆC! B·∫°n l√† thi√™n t√†i ng·ªØ ph√°p!";
                resultEmoji.innerText = "üèÜ";
            } else if (score >= 25) {
                resultText.innerText = "TUY·ªÜT V·ªúI! C√¥ Mai An r·∫•t t·ª± h√†o v·ªÅ b·∫°n!";
                resultEmoji.innerText = "üåü";
            } else if (score >= 15) {
                resultText.innerText = "KH√Å T·ªêT! C·ªë g·∫Øng luy·ªán t·∫≠p th√™m nh√©!";
                resultEmoji.innerText = "üëç";
            } else {
                resultText.innerText = "C·ªê G·∫ÆNG L√äN! ƒê·ªçc k·ªπ gi·∫£i th√≠ch ƒë·ªÉ ti·∫øn b·ªô nh√©!";
                resultEmoji.innerText = "üìö";
            }

            modal.style.display = 'flex';
        }

        initQuiz();
    </script>
</body>
</html>
