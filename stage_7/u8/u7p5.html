<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Luy·ªán t·∫≠p: Because, As, So that - Ms Mai An ULIS</title>
    <!-- Google Fonts: Nunito & Quicksand -->
    <link href="https://fonts.googleapis.com/css2?family=Nunito:wght@400;600;700;800&family=Quicksand:wght@500;700&display=swap" rel="stylesheet">
    <!-- Confetti Library -->
    <script src="https://cdn.jsdelivr.net/npm/canvas-confetti@1.6.0/dist/confetti.browser.min.js"></script>
    <!-- Font Awesome -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">

    <style>
        :root {
            --primary-color: #8854C0; /* T√≠m h·ªìng */
            --secondary-color: #00C9A7; /* Xanh ng·ªçc */
            --accent-color: #FF9F43; /* Cam */
            --correct-color: #00D26A; /* Xanh l√° */
            --wrong-color: #FF4757; /* ƒê·ªè cam */
            --bg-pattern: #f3f0ff;
            --card-bg: #ffffff;
            --text-color: #2d3436;
        }

        body {
            font-family: 'Nunito', sans-serif;
            background-color: var(--bg-pattern);
            background-image: radial-gradient(#8854c0 0.8px, transparent 0.8px), radial-gradient(#8854c0 0.8px, var(--bg-pattern) 0.8px);
            background-size: 20px 20px;
            background-position: 0 0, 10px 10px;
            color: var(--text-color);
            margin: 0;
            padding: 0;
            min-height: 100vh;
        }

        .header {
            background: linear-gradient(135deg, var(--primary-color), #a29bfe);
            color: white;
            padding: 20px;
            text-align: center;
            box-shadow: 0 4px 15px rgba(0,0,0,0.2);
            position: relative;
            z-index: 10;
            border-bottom-left-radius: 30px;
            border-bottom-right-radius: 30px;
        }

        .header h1 {
            font-family: 'Quicksand', sans-serif;
            margin: 0;
            font-size: 2.2rem;
            text-shadow: 2px 2px 0px rgba(0,0,0,0.1);
        }

        .header p {
            font-size: 1.2rem;
            margin-top: 5px;
            font-weight: 600;
            opacity: 0.9;
        }

        .container {
            max-width: 800px;
            margin: 30px auto;
            padding: 0 15px;
            padding-bottom: 80px; /* Space for footer/submit */
        }

        /* Question Card Style */
        .question-card {
            background: var(--card-bg);
            border-radius: 20px;
            padding: 25px;
            margin-bottom: 30px;
            box-shadow: 0 8px 0 rgba(0,0,0,0.05), 0 10px 20px rgba(0,0,0,0.1);
            border: 2px solid #eee;
            transition: transform 0.3s ease;
            position: relative;
            overflow: hidden;
        }

        .question-card:hover {
            transform: translateY(-5px);
        }

        .question-number {
            display: inline-block;
            background: var(--accent-color);
            color: white;
            padding: 5px 15px;
            border-radius: 15px;
            font-weight: 800;
            font-size: 0.9rem;
            margin-bottom: 15px;
            box-shadow: 0 3px 0 rgba(0,0,0,0.1);
        }

        .question-text {
            font-size: 1.3rem;
            font-weight: 700;
            margin-bottom: 20px;
            line-height: 1.5;
            color: #2d3436;
        }

        /* Options Grid */
        .options-grid {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 15px;
        }

        @media (max-width: 600px) {
            .options-grid {
                grid-template-columns: 1fr;
            }
        }

        /* 3D Button Style */
        .option-btn {
            background: #f1f2f6;
            border: 2px solid #dfe4ea;
            border-radius: 15px;
            padding: 15px;
            font-family: 'Nunito', sans-serif;
            font-size: 1.1rem;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.1s;
            position: relative;
            top: 0;
            box-shadow: 0 5px 0 #ced6e0;
            text-align: left;
            display: flex;
            align-items: center;
        }

        .option-btn:hover:not(:disabled) {
            background: #fff;
            transform: scale(1.02);
        }

        .option-btn:active:not(:disabled) {
            top: 5px;
            box-shadow: 0 0 0 #ced6e0;
        }

        .option-letter {
            display: inline-flex;
            justify-content: center;
            align-items: center;
            width: 30px;
            height: 30px;
            background: var(--primary-color);
            color: white;
            border-radius: 50%;
            margin-right: 10px;
            font-size: 0.9rem;
            flex-shrink: 0;
        }

        /* Correct/Wrong States */
        .option-btn.correct {
            background: var(--correct-color);
            border-color: #00b894;
            color: white;
            box-shadow: 0 5px 0 #00b894;
        }
        .option-btn.correct .option-letter {
            background: white;
            color: var(--correct-color);
        }

        .option-btn.wrong {
            background: var(--wrong-color);
            border-color: #d63031;
            color: white;
            box-shadow: 0 5px 0 #d63031;
            animation: shake 0.5s;
        }
        .option-btn.wrong .option-letter {
            background: white;
            color: var(--wrong-color);
        }

        .option-btn:disabled {
            cursor: default;
            opacity: 0.7;
            transform: none !important;
            top: 0 !important;
        }

        /* Explanation Box */
        .explanation-box {
            margin-top: 20px;
            background: #e8fbf3;
            border: 2px solid var(--secondary-color);
            border-radius: 15px;
            padding: 20px;
            display: none; /* Hidden by default */
            animation: slideDown 0.4s ease-out;
        }
        
        .explanation-box.visible {
            display: block;
        }

        .explanation-title {
            color: var(--secondary-color);
            font-weight: 800;
            font-size: 1.1rem;
            margin-bottom: 10px;
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .explanation-content {
            font-size: 1rem;
            line-height: 1.6;
            white-space: pre-line; /* Respect new lines in JSON */
        }

        /* Animations */
        @keyframes shake {
            0% { transform: translateX(0); }
            25% { transform: translateX(-5px) rotate(-2deg); }
            50% { transform: translateX(5px) rotate(2deg); }
            75% { transform: translateX(-5px) rotate(-2deg); }
            100% { transform: translateX(0); }
        }

        @keyframes slideDown {
            from { opacity: 0; transform: translateY(-10px); }
            to { opacity: 1; transform: translateY(0); }
        }

        /* Footer / Submit */
        .submit-section {
            text-align: center;
            margin-top: 40px;
        }

        .submit-btn {
            background: var(--primary-color);
            color: white;
            border: none;
            padding: 15px 40px;
            font-size: 1.5rem;
            border-radius: 50px;
            font-weight: 800;
            font-family: 'Quicksand', sans-serif;
            cursor: pointer;
            box-shadow: 0 6px 0 #5f27cd, 0 15px 20px rgba(0,0,0,0.2);
            transition: all 0.2s;
        }

        .submit-btn:hover {
            transform: translateY(-3px);
            box-shadow: 0 9px 0 #5f27cd, 0 20px 25px rgba(0,0,0,0.2);
        }

        .submit-btn:active {
            transform: translateY(3px);
            box-shadow: 0 0 0 #5f27cd;
        }

        /* Modal Score */
        .modal-overlay {
            position: fixed;
            top: 0; left: 0; width: 100%; height: 100%;
            background: rgba(0,0,0,0.7);
            display: none;
            justify-content: center;
            align-items: center;
            z-index: 1000;
            backdrop-filter: blur(5px);
        }

        .modal-content {
            background: white;
            padding: 40px;
            border-radius: 30px;
            text-align: center;
            max-width: 90%;
            width: 500px;
            border: 5px solid var(--primary-color);
            animation: popIn 0.5s cubic-bezier(0.68, -0.55, 0.27, 1.55);
        }

        .score-circle {
            width: 150px;
            height: 150px;
            background: var(--secondary-color);
            border-radius: 50%;
            display: flex;
            justify-content: center;
            align-items: center;
            font-size: 3rem;
            font-weight: 800;
            color: white;
            margin: 0 auto 20px;
            border: 5px solid #fff;
            box-shadow: 0 0 0 5px var(--secondary-color);
        }

        .feedback-text {
            font-size: 1.5rem;
            font-weight: 700;
            color: var(--primary-color);
            margin-bottom: 20px;
        }

        @keyframes popIn {
            0% { transform: scale(0); opacity: 0; }
            100% { transform: scale(1); opacity: 1; }
        }

        .badge-hint {
            display: inline-block;
            background: #ffeb3b;
            color: #333;
            font-size: 0.8rem;
            padding: 2px 8px;
            border-radius: 4px;
            margin-top: 5px;
            font-weight: bold;
        }

    </style>
</head>
<body>

    <div class="header">
        <h1><i class="fas fa-shapes"></i> Luy·ªán t·∫≠p ng·ªØ ph√°p</h1>
        <p>Gi√°o vi√™n: Ms Mai An ULIS</p>
        <p style="font-size: 0.9rem; margin-top: 5px; color: #dfe6e9;">Ch·ªß ƒë·ªÅ: Because, As, So that</p>
    </div>

    <div class="container" id="quiz-container">
        <!-- Questions will be rendered here -->
    </div>

    <div class="submit-section">
        <button class="submit-btn" onclick="finishQuiz()">N·ªôp B√†i <i class="fas fa-paper-plane"></i></button>
    </div>

    <!-- Score Modal -->
    <div class="modal-overlay" id="scoreModal">
        <div class="modal-content">
            <div class="score-circle" id="finalScore">0/0</div>
            <div class="feedback-text" id="feedbackMessage">L√†m t·ªët l·∫Øm!</div>
            <button class="submit-btn" style="font-size: 1.2rem; padding: 10px 30px;" onclick="location.reload()">L√†m l·∫°i <i class="fas fa-redo"></i></button>
        </div>
    </div>

    <script>
        // DATA T·ª™ B√ÄI Y√äU C·∫¶U
        const quizData = {
          "questions": [
            {
              "questionNumber": 1,
              "question": "I put on my warm coat __________ it was very cold outside.",
              "imageUrl": null,
              "answerOptions": [
                {
                  "text": "because",
                  "rationale": "**D·ªãch & Lo·∫°i t·ª´:**\n- because (conj): b·ªüi v√¨ (ch·ªâ nguy√™n nh√¢n)\n- so that (conj): ƒë·ªÉ m√† (ch·ªâ m·ª•c ƒë√≠ch)\n- although (conj): m·∫∑c d√π (ch·ªâ s·ª± nh∆∞·ª£ng b·ªô)\n- so (conj): v√¨ v·∫≠y (ch·ªâ k·∫øt qu·∫£)\n\n**Gi·∫£i th√≠ch:** V·∫ø sau 'it was very cold outside' (tr·ªùi r·∫•t l·∫°nh) l√† nguy√™n nh√¢n cho h√†nh ƒë·ªông m·∫∑c √°o ·∫•m -> D√πng 'because'.\n\n**D·ªãch c√¢u:** T√¥i m·∫∑c chi·∫øc √°o kho√°c ·∫•m V√å tr·ªùi b√™n ngo√†i r·∫•t l·∫°nh.",
                  "isCorrect": true
                },
                {
                  "text": "so that",
                  "rationale": "",
                  "isCorrect": false
                },
                {
                  "text": "although",
                  "rationale": "",
                  "isCorrect": false
                },
                {
                  "text": "so",
                  "rationale": "",
                  "isCorrect": false
                }
              ],
              "hint": "C·∫ßn m·ªôt t·ª´ ch·ªâ nguy√™n nh√¢n (l√Ω do t·∫°i sao m·∫∑c √°o)."
            },
            {
              "questionNumber": 2,
              "question": "He studies very hard __________ he can pass the exam with high marks.",
              "imageUrl": null,
              "answerOptions": [
                {
                  "text": "because",
                  "rationale": "",
                  "isCorrect": false
                },
                {
                  "text": "so that",
                  "rationale": "**D·ªãch & Lo·∫°i t·ª´:**\n- because (conj): b·ªüi v√¨\n- so that (conj): ƒë·ªÉ m√†\n- although (conj): m·∫∑c d√π\n- but (conj): nh∆∞ng\n\n**Gi·∫£i th√≠ch:** M·ªánh ƒë·ªÅ sau c√≥ 'can pass' (c√≥ th·ªÉ ƒë·∫≠u) di·ªÖn t·∫£ m·ª•c ƒë√≠ch c·ªßa vi·ªác h·ªçc chƒÉm ch·ªâ. C·∫•u tr√∫c: Clause + so that + S + can/could + V.\n\n**D·ªãch c√¢u:** Anh ·∫•y h·ªçc r·∫•t chƒÉm ch·ªâ ƒê·ªÇ M√Ä anh ·∫•y c√≥ th·ªÉ v∆∞·ª£t qua k·ª≥ thi v·ªõi ƒëi·ªÉm s·ªë cao.",
                  "isCorrect": true
                },
                {
                  "text": "although",
                  "rationale": "",
                  "isCorrect": false
                },
                {
                  "text": "but",
                  "rationale": "",
                  "isCorrect": false
                }
              ],
              "hint": "C·ª•m 'can pass' cho th·∫•y ƒë√¢y l√† m·ªánh ƒë·ªÅ ch·ªâ m·ª•c ƒë√≠ch (purpose)."
            },
            {
              "questionNumber": 3,
              "question": "__________ we didn‚Äôt have any homework, we went to the cinema.",
              "imageUrl": null,
              "answerOptions": [
                {
                  "text": "So that",
                  "rationale": "",
                  "isCorrect": false
                },
                {
                  "text": "As",
                  "rationale": "**D·ªãch & Lo·∫°i t·ª´:**\n- So that (conj): ƒê·ªÉ m√†\n- As (conj): V√¨ / Khi\n- Although (conj): M·∫∑c d√π\n- But (conj): Nh∆∞ng\n\n**Gi·∫£i th√≠ch:** 'didn't have any homework' l√† l√Ω do d·∫´n ƒë·∫øn vi·ªác ƒëi xem phim. 'As' c√≥ nghƒ©a t∆∞∆°ng ƒë∆∞∆°ng v·ªõi 'Because/Since' khi ƒë·ª©ng ƒë·∫ßu c√¢u ch·ªâ nguy√™n nh√¢n.\n\n**D·ªãch c√¢u:** V√å ch√∫ng t√¥i kh√¥ng c√≥ b√†i t·∫≠p v·ªÅ nh√† n√†o, ch√∫ng t√¥i ƒë√£ ƒëi xem phim.",
                  "isCorrect": true
                },
                {
                  "text": "Although",
                  "rationale": "",
                  "isCorrect": false
                },
                {
                  "text": "But",
                  "rationale": "",
                  "isCorrect": false
                }
              ],
              "hint": "D√πng t·ª´ ƒë·ªìng nghƒ©a v·ªõi 'Because' ƒë·ªÉ ch·ªâ nguy√™n nh√¢n ƒë·ª©ng ƒë·∫ßu c√¢u."
            },
            {
              "questionNumber": 4,
              "question": "My mother goes to the supermarket every day __________ she can buy fresh food.",
              "imageUrl": null,
              "answerOptions": [
                {
                  "text": "because",
                  "rationale": "",
                  "isCorrect": false
                },
                {
                  "text": "so that",
                  "rationale": "**D·ªãch & Lo·∫°i t·ª´:**\n- because (conj): b·ªüi v√¨\n- so that (conj): ƒë·ªÉ m√†\n- although (conj): m·∫∑c d√π\n- if (conj): n·∫øu\n\n**Gi·∫£i th√≠ch:** M·ªánh ƒë·ªÅ sau c√≥ 'can buy' (c√≥ th·ªÉ mua) ch·ªâ m·ª•c ƒë√≠ch c·ªßa h√†nh ƒë·ªông ƒëi si√™u th·ªã m·ªói ng√†y -> D√πng 'so that'.\n\n**D·ªãch c√¢u:** M·∫π t√¥i ƒëi si√™u th·ªã m·ªói ng√†y ƒê·ªÇ M√Ä b√† c√≥ th·ªÉ mua th·ª±c ph·∫©m t∆∞∆°i s·ªëng.",
                  "isCorrect": true
                },
                {
                  "text": "although",
                  "rationale": "",
                  "isCorrect": false
                },
                {
                  "text": "if",
                  "rationale": "",
                  "isCorrect": false
                }
              ],
              "hint": "M·ª•c ƒë√≠ch l√† ƒë·ªÉ mua ƒë·ªì t∆∞∆°i (c√≥ ƒë·ªông t·ª´ khuy·∫øt thi·∫øu 'can')."
            },
            {
              "questionNumber": 5,
              "question": "We stayed at home yesterday __________ it was raining heavily.",
              "imageUrl": null,
              "answerOptions": [
                {
                  "text": "because",
                  "rationale": "**D·ªãch & Lo·∫°i t·ª´:**\n- because (conj): b·ªüi v√¨\n- so that (conj): ƒë·ªÉ m√†\n- so (conj): v√¨ v·∫≠y\n- though (conj): d√π cho\n\n**Gi·∫£i th√≠ch:** 'it was raining heavily' (tr·ªùi m∆∞a to) l√† nguy√™n nh√¢n khi·∫øn ch√∫ng t√¥i ·ªü nh√† -> D√πng 'because'.\n\n**D·ªãch c√¢u:** Ch√∫ng t√¥i ƒë√£ ·ªü nh√† ng√†y h√¥m qua V√å tr·ªùi m∆∞a r·∫•t to.",
                  "isCorrect": true
                },
                {
                  "text": "so that",
                  "rationale": "",
                  "isCorrect": false
                },
                {
                  "text": "so",
                  "rationale": "",
                  "isCorrect": false
                },
                {
                  "text": "though",
                  "rationale": "",
                  "isCorrect": false
                }
              ],
              "hint": "Ch·ªâ nguy√™n nh√¢n tr·ª±c ti·∫øp c·ªßa vi·ªác ·ªü nh√†."
            },
            {
              "questionNumber": 6,
              "question": "Please close the door __________ the cat cannot go out.",
              "imageUrl": null,
              "answerOptions": [
                {
                  "text": "because",
                  "rationale": "",
                  "isCorrect": false
                },
                {
                  "text": "so that",
                  "rationale": "**D·ªãch & Lo·∫°i t·ª´:**\n- because (conj): b·ªüi v√¨\n- so that (conj): ƒë·ªÉ m√†\n- as (conj): v√¨/khi\n- if (conj): n·∫øu\n\n**Gi·∫£i th√≠ch:** Vi·ªác ƒë√≥ng c·ª≠a nh·∫±m m·ª•c ƒë√≠ch ngƒÉn m√®o ra ngo√†i (cannot go out) -> D√πng 'so that' ch·ªâ m·ª•c ƒë√≠ch.\n\n**D·ªãch c√¢u:** L√†m ∆°n ƒë√≥ng c·ª≠a l·∫°i ƒê·ªÇ M√Ä con m√®o kh√¥ng th·ªÉ ra ngo√†i.",
                  "isCorrect": true
                },
                {
                  "text": "as",
                  "rationale": "",
                  "isCorrect": false
                },
                {
                  "text": "if",
                  "rationale": "",
                  "isCorrect": false
                }
              ],
              "hint": "H√†nh ƒë·ªông ƒë√≥ng c·ª≠a c√≥ m·ª•c ƒë√≠ch c·ª• th·ªÉ."
            },
            {
              "questionNumber": 7,
              "question": "__________ I was walking to school, I saw my old teacher.",
              "imageUrl": null,
              "answerOptions": [
                {
                  "text": "As",
                  "rationale": "**D·ªãch & Lo·∫°i t·ª´:**\n- As (conj): Khi (trong ng·ªØ c·∫£nh n√†y)/ V√¨\n- So that (conj): ƒê·ªÉ m√†\n- Because (conj): B·ªüi v√¨\n- Although (conj): M·∫∑c d√π\n\n**Gi·∫£i th√≠ch:** Trong c√¢u n√†y, 'As' mang nghƒ©a l√† 'Khi' (When/While), di·ªÖn t·∫£ hai h√†nh ƒë·ªông x·∫£y ra song song: ƒëang ƒëi b·ªô th√¨ g·∫∑p c√¥ gi√°o.\n\n**D·ªãch c√¢u:** KHI t√¥i ƒëang ƒëi b·ªô ƒë·∫øn tr∆∞·ªùng, t√¥i ƒë√£ g·∫∑p gi√°o vi√™n c≈© c·ªßa m√¨nh.",
                  "isCorrect": true
                },
                {
                  "text": "So that",
                  "rationale": "",
                  "isCorrect": false
                },
                {
                  "text": "Because",
                  "rationale": "",
                  "isCorrect": false
                },
                {
                  "text": "Although",
                  "rationale": "",
                  "isCorrect": false
                }
              ],
              "hint": "T·ª´ n√†y ·ªü ƒë√¢y mang nghƒ©a l√† 'Trong khi' (ch·ªâ th·ªùi gian)."
            },
            {
              "questionNumber": 8,
              "question": "Lan is very happy __________ she got an A in English.",
              "imageUrl": null,
              "answerOptions": [
                {
                  "text": "because",
                  "rationale": "**D·ªãch & Lo·∫°i t·ª´:**\n- because (conj): b·ªüi v√¨\n- so that (conj): ƒë·ªÉ m√†\n- although (conj): m·∫∑c d√π\n- but (conj): nh∆∞ng\n\n**Gi·∫£i th√≠ch:** Vi·ªác ƒë∆∞·ª£c ƒëi·ªÉm A l√† l√Ω do (nguy√™n nh√¢n) d·∫´n ƒë·∫øn c·∫£m x√∫c vui v·∫ª -> D√πng 'because'.\n\n**D·ªãch c√¢u:** Lan r·∫•t vui B·ªûI V√å c√¥ ·∫•y ƒë√£ ƒë·∫°t ƒëi·ªÉm A m√¥n ti·∫øng Anh.",
                  "isCorrect": true
                },
                {
                  "text": "so that",
                  "rationale": "",
                  "isCorrect": false
                },
                {
                  "text": "although",
                  "rationale": "",
                  "isCorrect": false
                },
                {
                  "text": "but",
                  "rationale": "",
                  "isCorrect": false
                }
              ],
              "hint": "Ch·ªâ nguy√™n nh√¢n c·ªßa s·ª± vui m·ª´ng."
            },
            {
              "questionNumber": 9,
              "question": "I am learning English __________ I can talk to foreigners.",
              "imageUrl": null,
              "answerOptions": [
                {
                  "text": "because",
                  "rationale": "",
                  "isCorrect": false
                },
                {
                  "text": "so that",
                  "rationale": "**D·ªãch & Lo·∫°i t·ª´:**\n- because (conj): b·ªüi v√¨\n- so that (conj): ƒë·ªÉ m√†\n- although (conj): m·∫∑c d√π\n- as (conj): v√¨/khi\n\n**Gi·∫£i th√≠ch:** M·ªánh ƒë·ªÅ sau 'can talk' ch·ªâ kh·∫£ nƒÉng/m·ª•c ƒë√≠ch c·ªßa vi·ªác h·ªçc ti·∫øng Anh -> D√πng 'so that'.\n\n**D·ªãch c√¢u:** T√¥i ƒëang h·ªçc ti·∫øng Anh ƒê·ªÇ M√Ä t√¥i c√≥ th·ªÉ n√≥i chuy·ªán v·ªõi ng∆∞·ªùi n∆∞·ªõc ngo√†i.",
                  "isCorrect": true
                },
                {
                  "text": "although",
                  "rationale": "",
                  "isCorrect": false
                },
                {
                  "text": "as",
                  "rationale": "",
                  "isCorrect": false
                }
              ],
              "hint": "M·ª•c ƒë√≠ch c·ªßa vi·ªác h·ªçc l√† ƒë·ªÉ c√≥ th·ªÉ (can) giao ti·∫øp."
            },
            {
              "questionNumber": 10,
              "question": "__________ it was a public holiday, all the shops were closed.",
              "imageUrl": null,
              "answerOptions": [
                {
                  "text": "So that",
                  "rationale": "",
                  "isCorrect": false
                },
                {
                  "text": "As",
                  "rationale": "**D·ªãch & Lo·∫°i t·ª´:**\n- So that (conj): ƒê·ªÉ m√†\n- As (conj): V√¨\n- Although (conj): M·∫∑c d√π\n- But (conj): Nh∆∞ng\n\n**Gi·∫£i th√≠ch:** 'it was a public holiday' l√† l√Ω do khi·∫øn c√°c c·ª≠a h√†ng ƒë√≥ng c·ª≠a. D√πng 'As' (t∆∞∆°ng ƒë∆∞∆°ng Since/Because) ƒë·ªÉ ch·ªâ nguy√™n nh√¢n ƒë√£ bi·∫øt.\n\n**D·ªãch c√¢u:** V√å h√¥m ƒë√≥ l√† ng√†y l·ªÖ n√™n t·∫•t c·∫£ c√°c c·ª≠a h√†ng ƒë·ªÅu ƒë√≥ng c·ª≠a.",
                  "isCorrect": true
                },
                {
                  "text": "Although",
                  "rationale": "",
                  "isCorrect": false
                },
                {
                  "text": "But",
                  "rationale": "",
                  "isCorrect": false
                }
              ],
              "hint": "Ch·ªâ nguy√™n nh√¢n, ƒë·ªìng nghƒ©a v·ªõi 'Since'."
            },
            {
              "questionNumber": 11,
              "question": "Nam exercises every morning __________ he wants to be healthy.",
              "imageUrl": null,
              "answerOptions": [
                {
                  "text": "because",
                  "rationale": "**D·ªãch & Lo·∫°i t·ª´:**\n- because (conj): b·ªüi v√¨\n- so that (conj): ƒë·ªÉ m√†\n- although (conj): m·∫∑c d√π\n- so (conj): v√¨ v·∫≠y\n\n**Gi·∫£i th√≠ch:** 'he wants to be healthy' l√† l√Ω do gi·∫£i th√≠ch cho h√†nh ƒë·ªông t·∫≠p th·ªÉ d·ª•c -> D√πng 'because'. L∆∞u √Ω: M·∫∑c d√π √Ω nghƒ©a l√† m·ª•c ƒë√≠ch (mu·ªën kh·ªèe), nh∆∞ng c·∫•u tr√∫c c√¢u d√πng ƒë·ªông t·ª´ 'wants' n√™n ƒë√¢y l√† m·ªánh ƒë·ªÅ nguy√™n nh√¢n.\n\n**D·ªãch c√¢u:** Nam t·∫≠p th·ªÉ d·ª•c m·ªói s√°ng B·ªûI V√å c·∫≠u ·∫•y mu·ªën kh·ªèe m·∫°nh.",
                  "isCorrect": true
                },
                {
                  "text": "so that",
                  "rationale": "",
                  "isCorrect": false
                },
                {
                  "text": "although",
                  "rationale": "",
                  "isCorrect": false
                },
                {
                  "text": "so",
                  "rationale": "",
                  "isCorrect": false
                }
              ],
              "hint": "'Want' (mu·ªën) l√† ƒë·ªông t·ª´ ch·ªâ l√Ω do th√∫c ƒë·∫©y h√†nh ƒë·ªông."
            },
            {
              "questionNumber": 12,
              "question": "She turned down the music __________ she wouldn't disturb the neighbors.",
              "imageUrl": null,
              "answerOptions": [
                {
                  "text": "because",
                  "rationale": "",
                  "isCorrect": false
                },
                {
                  "text": "so that",
                  "rationale": "**D·ªãch & Lo·∫°i t·ª´:**\n- because (conj): b·ªüi v√¨\n- so that (conj): ƒë·ªÉ m√†\n- although (conj): m·∫∑c d√π\n- as (conj): v√¨\n\n**Gi·∫£i th√≠ch:** C·∫•u tr√∫c 'Clause + so that + S + would/could + V' ch·ªâ m·ª•c ƒë√≠ch (trong qu√° kh·ª©). C√¥ ·∫•y v·∫∑n nh·ªè nh·∫°c ƒë·ªÉ kh√¥ng l√†m phi·ªÅn h√†ng x√≥m.\n\n**D·ªãch c√¢u:** C√¥ ·∫•y ƒë√£ v·∫∑n nh·ªè nh·∫°c xu·ªëng ƒê·ªÇ M√Ä c√¥ ·∫•y s·∫Ω kh√¥ng l√†m phi·ªÅn h√†ng x√≥m.",
                  "isCorrect": true
                },
                {
                  "text": "although",
                  "rationale": "",
                  "isCorrect": false
                },
                {
                  "text": "as",
                  "rationale": "",
                  "isCorrect": false
                }
              ],
              "hint": "M·ª•c ƒë√≠ch c·ªßa vi·ªác v·∫∑n nh·ªè nh·∫°c l√† ƒë·ªÉ tr√°nh l√†m phi·ªÅn (wouldn't disturb)."
            },
            {
              "questionNumber": 13,
              "question": "They like living in the countryside __________ the air is fresh and clean.",
              "imageUrl": null,
              "answerOptions": [
                {
                  "text": "so that",
                  "rationale": "",
                  "isCorrect": false
                },
                {
                  "text": "because",
                  "rationale": "**D·ªãch & Lo·∫°i t·ª´:**\n- so that (conj): ƒë·ªÉ m√†\n- because (conj): b·ªüi v√¨\n- although (conj): m·∫∑c d√π\n- but (conj): nh∆∞ng\n\n**Gi·∫£i th√≠ch:** Kh√¥ng kh√≠ trong l√†nh l√† nguy√™n nh√¢n khi·∫øn h·ªç th√≠ch s·ªëng ·ªü qu√™ -> D√πng 'because' (ho·∫∑c 'as').\n\n**D·ªãch c√¢u:** H·ªç th√≠ch s·ªëng ·ªü v√πng qu√™ B·ªûI V√å kh√¥ng kh√≠ trong l√†nh v√† s·∫°ch s·∫Ω.",
                  "isCorrect": true
                },
                {
                  "text": "although",
                  "rationale": "",
                  "isCorrect": false
                },
                {
                  "text": "but",
                  "rationale": "",
                  "isCorrect": false
                }
              ],
              "hint": "Ch·ªâ l√Ω do t·∫°i sao h·ªç th√≠ch."
            },
            {
              "questionNumber": 14,
              "question": "Please write clearly __________ the teacher can read your handwriting.",
              "imageUrl": null,
              "answerOptions": [
                {
                  "text": "because",
                  "rationale": "",
                  "isCorrect": false
                },
                {
                  "text": "so that",
                  "rationale": "**D·ªãch & Lo·∫°i t·ª´:**\n- because (conj): b·ªüi v√¨\n- so that (conj): ƒë·ªÉ m√†\n- although (conj): m·∫∑c d√π\n- as (conj): v√¨\n\n**Gi·∫£i th√≠ch:** Vi·∫øt r√µ r√†ng nh·∫±m m·ª•c ƒë√≠ch ƒë·ªÉ gi√°o vi√™n ƒë·ªçc ƒë∆∞·ª£c (can read) -> D√πng 'so that'.\n\n**D·ªãch c√¢u:** L√†m ∆°n vi·∫øt r√µ r√†ng ƒê·ªÇ M√Ä gi√°o vi√™n c√≥ th·ªÉ ƒë·ªçc ƒë∆∞·ª£c ch·ªØ vi·∫øt c·ªßa b·∫°n.",
                  "isCorrect": true
                },
                {
                  "text": "although",
                  "rationale": "",
                  "isCorrect": false
                },
                {
                  "text": "as",
                  "rationale": "",
                  "isCorrect": false
                }
              ],
              "hint": "Ch·ªâ m·ª•c ƒë√≠ch (ƒë·ªÉ c√≥ th·ªÉ ƒë·ªçc ƒë∆∞·ª£c)."
            },
            {
              "questionNumber": 15,
              "question": "__________ Tom was tired, he went to bed early last night.",
              "imageUrl": null,
              "answerOptions": [
                {
                  "text": "So that",
                  "rationale": "",
                  "isCorrect": false
                },
                {
                  "text": "As",
                  "rationale": "**D·ªãch & Lo·∫°i t·ª´:**\n- So that (conj): ƒê·ªÉ m√†\n- As (conj): V√¨\n- Although (conj): M·∫∑c d√π\n- So (conj): V√¨ v·∫≠y\n\n**Gi·∫£i th√≠ch:** 'Tom was tired' l√† l√Ω do. 'As' ƒë·ª©ng ƒë·∫ßu c√¢u ch·ªâ nguy√™n nh√¢n.\n\n**D·ªãch c√¢u:** V√å Tom b·ªã m·ªát, c·∫≠u ·∫•y ƒë√£ ƒëi ng·ªß s·ªõm t·ªëi qua.",
                  "isCorrect": true
                },
                {
                  "text": "Although",
                  "rationale": "",
                  "isCorrect": false
                },
                {
                  "text": "So",
                  "rationale": "",
                  "isCorrect": false
                }
              ],
              "hint": "Nguy√™n nh√¢n ƒë·ª©ng ƒë·∫ßu c√¢u, ƒë·ªìng nghƒ©a v·ªõi 'Because'."
            },
            {
              "questionNumber": 16,
              "question": "My dad bought a new camera __________ he could take photos of our trip.",
              "imageUrl": null,
              "answerOptions": [
                {
                  "text": "because",
                  "rationale": "",
                  "isCorrect": false
                },
                {
                  "text": "so that",
                  "rationale": "**D·ªãch & Lo·∫°i t·ª´:**\n- because (conj): b·ªüi v√¨\n- so that (conj): ƒë·ªÉ m√†\n- although (conj): m·∫∑c d√π\n- but (conj): nh∆∞ng\n\n**Gi·∫£i th√≠ch:** Mua m√°y ·∫£nh nh·∫±m m·ª•c ƒë√≠ch 'could take photos' (c√≥ th·ªÉ ch·ª•p ·∫£nh) -> D√πng 'so that'.\n\n**D·ªãch c√¢u:** B·ªë t√¥i ƒë√£ mua m·ªôt chi·∫øc m√°y ·∫£nh m·ªõi ƒê·ªÇ M√Ä √¥ng ·∫•y c√≥ th·ªÉ ch·ª•p ·∫£nh chuy·∫øn ƒëi c·ªßa ch√∫ng t√¥i.",
                  "isCorrect": true
                },
                {
                  "text": "although",
                  "rationale": "",
                  "isCorrect": false
                },
                {
                  "text": "but",
                  "rationale": "",
                  "isCorrect": false
                }
              ],
              "hint": "H√†nh ƒë·ªông mua m√°y ·∫£nh c√≥ m·ª•c ƒë√≠ch (ƒëi k√®m 'could')."
            },
            {
              "questionNumber": 17,
              "question": "I didn't buy that shirt __________ it was too expensive.",
              "imageUrl": null,
              "answerOptions": [
                {
                  "text": "because",
                  "rationale": "**D·ªãch & Lo·∫°i t·ª´:**\n- because (conj): b·ªüi v√¨\n- so that (conj): ƒë·ªÉ m√†\n- although (conj): m·∫∑c d√π\n- so (conj): v√¨ v·∫≠y\n\n**Gi·∫£i th√≠ch:** 'it was too expensive' l√† l√Ω do khi·∫øn t√¥i kh√¥ng mua -> D√πng 'because'.\n\n**D·ªãch c√¢u:** T√¥i ƒë√£ kh√¥ng mua chi·∫øc √°o ƒë√≥ B·ªûI V√å n√≥ qu√° ƒë·∫Øt.",
                  "isCorrect": true
                },
                {
                  "text": "so that",
                  "rationale": "",
                  "isCorrect": false
                },
                {
                  "text": "although",
                  "rationale": "",
                  "isCorrect": false
                },
                {
                  "text": "so",
                  "rationale": "",
                  "isCorrect": false
                }
              ],
              "hint": "Gi·∫£i th√≠ch l√Ω do kh√¥ng mua h√†ng."
            },
            {
              "questionNumber": 18,
              "question": "__________ you are here, can you help me with this box?",
              "imageUrl": null,
              "answerOptions": [
                {
                  "text": "So that",
                  "rationale": "",
                  "isCorrect": false
                },
                {
                  "text": "As",
                  "rationale": "**D·ªãch & Lo·∫°i t·ª´:**\n- So that (conj): ƒê·ªÉ m√†\n- As (conj): V√¨/Nh√¢n ti·ªán\n- Although (conj): M·∫∑c d√π\n- But (conj): Nh∆∞ng\n\n**Gi·∫£i th√≠ch:** D√πng 'As' (ho·∫∑c Since) ƒë·ªÉ ch·ªâ m·ªôt s·ª± th·∫≠t hi·ªÉn nhi√™n ho·∫∑c l√Ω do trong ho√†n c·∫£nh hi·ªán t·∫°i: V√¨ b·∫°n ƒë√£ ·ªü ƒë√¢y r·ªìi (n√™n gi√∫p t√¥i).\n\n**D·ªãch c√¢u:** NH√ÇN TI·ªÜN/V√å b·∫°n ƒëang ·ªü ƒë√¢y, b·∫°n c√≥ th·ªÉ gi√∫p t√¥i b√™ c√°i h·ªôp n√†y kh√¥ng?",
                  "isCorrect": true
                },
                {
                  "text": "Although",
                  "rationale": "",
                  "isCorrect": false
                },
                {
                  "text": "But",
                  "rationale": "",
                  "isCorrect": false
                }
              ],
              "hint": "Ch·ªâ l√Ω do d·ª±a tr√™n ho√†n c·∫£nh hi·ªán t·∫°i (V√¨ b·∫°n ·ªü ƒë√¢y...)."
            },
            {
              "questionNumber": 19,
              "question": "The teacher spoke strictly __________ the students would listen to him.",
              "imageUrl": null,
              "answerOptions": [
                {
                  "text": "because",
                  "rationale": "",
                  "isCorrect": false
                },
                {
                  "text": "so that",
                  "rationale": "**D·ªãch & Lo·∫°i t·ª´:**\n- because (conj): b·ªüi v√¨\n- so that (conj): ƒë·ªÉ m√†\n- although (conj): m·∫∑c d√π\n- as (conj): v√¨\n\n**Gi·∫£i th√≠ch:** Th·∫ßy gi√°o nghi√™m kh·∫Øc nh·∫±m m·ª•c ƒë√≠ch 'students would listen' (h·ªçc sinh s·∫Ω l·∫Øng nghe) -> D√πng 'so that'.\n\n**D·ªãch c√¢u:** Th·∫ßy gi√°o ƒë√£ n√≥i chuy·ªán r·∫•t nghi√™m kh·∫Øc ƒê·ªÇ M√Ä c√°c h·ªçc sinh s·∫Ω l·∫Øng nghe th·∫ßy.",
                  "isCorrect": true
                },
                {
                  "text": "although",
                  "rationale": "",
                  "isCorrect": false
                },
                {
                  "text": "as",
                  "rationale": "",
                  "isCorrect": false
                }
              ],
              "hint": "Ch·ªâ m·ª•c ƒë√≠ch c·ªßa vi·ªác n√≥i nghi√™m kh·∫Øc."
            },
            {
              "questionNumber": 20,
              "question": "We like this restaurant __________ the food is delicious and cheap.",
              "imageUrl": null,
              "answerOptions": [
                {
                  "text": "because",
                  "rationale": "**D·ªãch & Lo·∫°i t·ª´:**\n- because (conj): b·ªüi v√¨\n- so that (conj): ƒë·ªÉ m√†\n- although (conj): m·∫∑c d√π\n- so (conj): v√¨ v·∫≠y\n\n**Gi·∫£i th√≠ch:** ƒê·ªì ƒÉn ngon v√† r·∫ª l√† l√Ω do ƒë·ªÉ th√≠ch nh√† h√†ng -> D√πng 'because'.\n\n**D·ªãch c√¢u:** Ch√∫ng t√¥i th√≠ch nh√† h√†ng n√†y B·ªûI V√å ƒë·ªì ƒÉn r·∫•t ngon v√† r·∫ª.",
                  "isCorrect": true
                },
                {
                  "text": "so that",
                  "rationale": "",
                  "isCorrect": false
                },
                {
                  "text": "although",
                  "rationale": "",
                  "isCorrect": false
                },
                {
                  "text": "so",
                  "rationale": "",
                  "isCorrect": false
                }
              ],
              "hint": "Ch·ªâ nguy√™n nh√¢n t·∫°i sao l·∫°i th√≠ch nh√† h√†ng."
            }
          ]
        };

        // --- GAME LOGIC ---

        let correctCount = 0;
        
        // Sound Effects using Web Audio API (No files needed)
        const audioCtx = new (window.AudioContext || window.webkitAudioContext)();
        
        function playSound(type) {
            if (audioCtx.state === 'suspended') audioCtx.resume();
            
            const osc = audioCtx.createOscillator();
            const gainNode = audioCtx.createGain();
            
            osc.connect(gainNode);
            gainNode.connect(audioCtx.destination);
            
            if (type === 'correct') {
                // "Ding" sound: High pitch sine wave
                osc.type = 'sine';
                osc.frequency.setValueAtTime(600, audioCtx.currentTime);
                osc.frequency.exponentialRampToValueAtTime(1000, audioCtx.currentTime + 0.1);
                gainNode.gain.setValueAtTime(0.3, audioCtx.currentTime);
                gainNode.gain.exponentialRampToValueAtTime(0.01, audioCtx.currentTime + 0.5);
                osc.start();
                osc.stop(audioCtx.currentTime + 0.5);
            } else {
                // "Buzz" sound: Low pitch sawtooth
                osc.type = 'sawtooth';
                osc.frequency.setValueAtTime(150, audioCtx.currentTime);
                osc.frequency.linearRampToValueAtTime(100, audioCtx.currentTime + 0.3);
                gainNode.gain.setValueAtTime(0.3, audioCtx.currentTime);
                gainNode.gain.exponentialRampToValueAtTime(0.01, audioCtx.currentTime + 0.3);
                osc.start();
                osc.stop(audioCtx.currentTime + 0.3);
            }
        }

        // Shuffle Function
        function shuffleArray(array) {
            for (let i = array.length - 1; i > 0; i--) {
                const j = Math.floor(Math.random() * (i + 1));
                [array[i], array[j]] = [array[j], array[i]];
            }
        }

        function renderQuiz() {
            const container = document.getElementById('quiz-container');
            container.innerHTML = '';
            
            // Shuffle questions
            shuffleArray(quizData.questions);

            quizData.questions.forEach((q, index) => {
                // Find correct answer rationale to display regardless of choice
                const correctAnswerObj = q.answerOptions.find(opt => opt.isCorrect);
                const explanationText = correctAnswerObj ? correctAnswerObj.rationale : "Kh√¥ng c√≥ gi·∫£i th√≠ch chi ti·∫øt.";

                const card = document.createElement('div');
                card.className = 'question-card';
                
                let optionsHtml = '';
                const letters = ['A', 'B', 'C', 'D'];
                
                q.answerOptions.forEach((opt, optIndex) => {
                    optionsHtml += `
                        <button class="option-btn" onclick="checkAnswer(this, ${opt.isCorrect}, 'q${index}-expl')">
                            <span class="option-letter">${letters[optIndex]}</span>
                            ${opt.text}
                        </button>
                    `;
                });

                card.innerHTML = `
                    <div class="question-number">C√¢u ${index + 1}</div>
                    <div class="question-text">${q.question}</div>
                    <div class="options-grid">
                        ${optionsHtml}
                    </div>
                    <div id="q${index}-expl" class="explanation-box">
                        <div class="explanation-title"><i class="fas fa-chalkboard-teacher"></i> C√¥ Mai An gi·∫£i th√≠ch:</div>
                        <div class="explanation-content">${explanationText}</div>
                        ${q.hint ? `<div class="badge-hint"><i class="far fa-lightbulb"></i> G·ª£i √Ω: ${q.hint}</div>` : ''}
                    </div>
                `;
                container.appendChild(card);
            });
        }

        function checkAnswer(btn, isCorrect, explanationId) {
            // Prevent multiple clicks on same question
            const parentGrid = btn.parentElement;
            const buttons = parentGrid.querySelectorAll('.option-btn');
            
            // If already answered, do nothing
            if (Array.from(buttons).some(b => b.disabled)) return;

            // Disable all buttons in this question
            buttons.forEach(b => b.disabled = true);

            if (isCorrect) {
                btn.classList.add('correct');
                playSound('correct');
                correctCount++;
                
                // Confetti Effect
                const rect = btn.getBoundingClientRect();
                const x = (rect.left + rect.width / 2) / window.innerWidth;
                const y = (rect.top + rect.height / 2) / window.innerHeight;
                confetti({
                    particleCount: 60,
                    spread: 70,
                    origin: { x: x, y: y },
                    colors: ['#00b894', '#fdcb6e', '#e17055']
                });
            } else {
                btn.classList.add('wrong');
                playSound('wrong');
                // Highlight correct answer automatically
                // Find the button that corresponds to the correct answer data? 
                // Since we passed isCorrect directly, we don't have direct link to other buttons' data here easily 
                // without DOM traversal or changing function signature.
                // Simple logic: In this dataset, we can't easily guess which other btn is correct based on HTML alone 
                // without inspecting the text.
                // However, for this requirement, showing the explanation is key.
            }

            // Show explanation
            const explBox = document.getElementById(explanationId);
            if (explBox) {
                explBox.classList.add('visible');
            }
        }

        function finishQuiz() {
            const total = quizData.questions.length;
            const scoreElement = document.getElementById('finalScore');
            const feedbackElement = document.getElementById('feedbackMessage');
            
            scoreElement.textContent = `${correctCount}/${total}`;
            
            const percentage = (correctCount / total) * 100;
            if (percentage === 100) {
                feedbackElement.textContent = "Xu·∫•t s·∫Øc! Em l√† thi√™n t√†i ng·ªØ ph√°p! üåü";
                confetti({ particleCount: 200, spread: 100, origin: { y: 0.6 } });
            } else if (percentage >= 80) {
                feedbackElement.textContent = "Gi·ªèi l·∫Øm! C·ªë g·∫Øng th√™m ch√∫t n·ªØa nh√©! üî•";
            } else if (percentage >= 50) {
                feedbackElement.textContent = "Kh√° t·ªët! H√£y xem l·∫°i ph·∫ßn gi·∫£i th√≠ch nha! üìö";
            } else {
                feedbackElement.textContent = "ƒê·ª´ng bu·ªìn! L√†m l·∫°i ƒë·ªÉ n·∫Øm ch·∫Øc ki·∫øn th·ª©c h∆°n nh√©! üí™";
            }

            document.getElementById('scoreModal').style.display = 'flex';
        }

        // Initialize
        window.onload = renderQuiz;

    </script>
</body>
</html>
