<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>B√†i T·∫≠p Ti·∫øng Anh - Ms Mai An ULIS</title>
    <link href="https://fonts.googleapis.com/css2?family=Nunito:wght@400;600;700;800&display=swap" rel="stylesheet">
    <style>
        :root {
            --primary-purple: #8854C0;
            --primary-teal: #00C9A7;
            --success-green: #00D26A;
            --error-red: #FF4757;
            --bg-color: #f0f3f8;
            --card-bg: #ffffff;
            --text-color: #2c3e50;
        }

        body {
            font-family: 'Nunito', sans-serif;
            background-color: var(--bg-color);
            background-image: radial-gradient(#8854c0 0.5px, transparent 0.5px), radial-gradient(#8854c0 0.5px, #f0f3f8 0.5px);
            background-size: 20px 20px;
            background-position: 0 0, 10px 10px;
            color: var(--text-color);
            margin: 0;
            padding: 20px;
            line-height: 1.6;
        }

        .container {
            max-width: 900px;
            margin: 0 auto;
        }

        /* HEADER */
        header {
            text-align: center;
            margin-bottom: 40px;
            background: white;
            padding: 20px;
            border-radius: 20px;
            box-shadow: 0 8px 0 rgba(0,0,0,0.1);
            border: 2px solid var(--primary-purple);
        }

        h1 {
            color: var(--primary-purple);
            font-weight: 800;
            margin: 0;
            font-size: 1.8rem;
            text-transform: uppercase;
        }

        .teacher-name {
            color: var(--primary-teal);
            font-weight: 700;
            font-size: 1.1rem;
        }

        /* EXERCISE BOXES */
        .exercise-section {
            background: var(--card-bg);
            border-radius: 20px;
            padding: 30px;
            margin-bottom: 40px;
            box-shadow: 0 10px 25px rgba(136, 84, 192, 0.1);
            border: 3px solid #e0e0e0;
            position: relative;
        }

        .exercise-title {
            background: var(--primary-purple);
            color: white;
            padding: 10px 20px;
            border-radius: 15px;
            display: inline-block;
            font-weight: 700;
            margin-bottom: 20px;
            box-shadow: 0 4px 0 #6c429c;
        }

        /* READING PASSAGE */
        .reading-text {
            background: #f9f9ff;
            padding: 25px;
            border-radius: 15px;
            border-left: 5px solid var(--primary-teal);
            font-size: 1.1rem;
            margin-bottom: 20px;
            text-align: justify;
        }

        .gap-marker {
            background: var(--primary-purple);
            color: white;
            padding: 2px 8px;
            border-radius: 8px;
            font-weight: bold;
            cursor: pointer;
            transition: transform 0.2s;
            display: inline-block;
        }

        .gap-marker:hover {
            transform: scale(1.1);
            background: var(--primary-teal);
        }

        /* GLOSSARY TABLE */
        .glossary-container {
            margin: 20px 0;
            border: 2px dashed var(--primary-teal);
            border-radius: 15px;
            padding: 15px;
            background: #eafffa;
        }

        .glossary-title {
            font-weight: 800;
            color: var(--primary-teal);
            text-align: center;
            margin-bottom: 10px;
            text-transform: uppercase;
        }

        .glossary-table {
            width: 100%;
            border-collapse: collapse;
            font-size: 0.95rem;
        }

        .glossary-table th {
            background: var(--primary-teal);
            color: white;
            padding: 8px;
            border-radius: 5px;
        }

        .glossary-table td {
            padding: 8px;
            border-bottom: 1px solid #ddd;
        }

        .glossary-table tr:last-child td {
            border-bottom: none;
        }

        /* QUESTIONS */
        .question-grid {
            display: grid;
            gap: 20px;
        }

        .question-card {
            background: #fff;
            border: 2px solid #eee;
            border-radius: 15px;
            padding: 20px;
            transition: all 0.3s ease;
        }

        .question-card.active-focus {
            border-color: var(--primary-purple);
            box-shadow: 0 0 15px rgba(136, 84, 192, 0.2);
        }

        .q-number {
            font-weight: 800;
            color: var(--primary-purple);
            margin-bottom: 10px;
            display: block;
        }

        .options-container {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(120px, 1fr));
            gap: 15px;
            margin-top: 10px;
        }

        .option-btn {
            background: white;
            border: 2px solid #e0e0e0;
            padding: 12px;
            border-radius: 12px;
            font-family: 'Nunito', sans-serif;
            font-weight: 700;
            font-size: 1rem;
            color: #555;
            cursor: pointer;
            transition: all 0.2s;
            box-shadow: 0 4px 0 #ccc;
            position: relative;
            top: 0;
        }

        .option-btn:hover:not(:disabled) {
            transform: scale(1.05);
            border-color: var(--primary-purple);
        }

        .option-btn:active:not(:disabled) {
            top: 4px;
            box-shadow: 0 0 0 #ccc;
        }

        /* STATES */
        .option-btn.correct {
            background: var(--success-green);
            color: white;
            border-color: #00b85c;
            box-shadow: 0 4px 0 #008f47 !important;
        }

        .option-btn.wrong {
            background: var(--error-red);
            color: white;
            border-color: #ff2e40;
            box-shadow: 0 4px 0 #c70014 !important;
            animation: shake 0.5s;
        }

        /* EXPLANATION BOX */
        .explanation-box {
            margin-top: 15px;
            background: #fff9c4; /* Light yellow friendly */
            border: 2px solid #fbc02d;
            border-radius: 12px;
            padding: 15px;
            display: none; /* Hidden by default */
            font-size: 0.95rem;
            animation: slideDown 0.4s ease-out;
        }

        .teacher-avatar {
            font-weight: 800;
            color: #d35400;
            margin-bottom: 5px;
            display: flex;
            align-items: center;
            gap: 10px;
        }
        
        .teacher-avatar::before {
            content: "üë©‚Äçüè´";
            font-size: 1.5rem;
        }

        .exp-section {
            margin-bottom: 8px;
        }
        
        .exp-label {
            font-weight: bold;
            color: #333;
            text-decoration: underline;
        }

        .exp-correct-tag {
            color: var(--success-green);
            font-weight: bold;
        }

        .exp-wrong-tag {
            color: var(--error-red);
            font-weight: bold;
        }

        /* ANIMATIONS */
        @keyframes shake {
            0% { transform: translateX(0); }
            25% { transform: translateX(-5px); }
            50% { transform: translateX(5px); }
            75% { transform: translateX(-5px); }
            100% { transform: translateX(0); }
        }

        @keyframes slideDown {
            from { opacity: 0; transform: translateY(-10px); }
            to { opacity: 1; transform: translateY(0); }
        }

        /* SUBMIT BTN */
        .submit-section {
            text-align: center;
            margin-top: 50px;
            padding-bottom: 50px;
        }

        .submit-btn {
            background: var(--primary-teal);
            color: white;
            font-size: 1.5rem;
            padding: 15px 40px;
            border: none;
            border-radius: 50px;
            font-weight: 800;
            box-shadow: 0 8px 0 #009e82;
            cursor: pointer;
            transition: transform 0.2s;
        }

        .submit-btn:hover {
            transform: scale(1.05);
        }

        .submit-btn:active {
            transform: translateY(4px);
            box-shadow: 0 4px 0 #009e82;
        }

        /* MODAL */
        .modal {
            display: none;
            position: fixed;
            z-index: 1000;
            left: 0;
            top: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0,0,0,0.6);
            backdrop-filter: blur(5px);
        }

        .modal-content {
            background-color: white;
            margin: 15% auto;
            padding: 30px;
            border: 4px solid var(--primary-purple);
            border-radius: 20px;
            width: 80%;
            max-width: 500px;
            text-align: center;
            animation: popIn 0.5s cubic-bezier(0.68, -0.55, 0.265, 1.55);
        }

        @keyframes popIn {
            0% { transform: scale(0); opacity: 0; }
            100% { transform: scale(1); opacity: 1; }
        }

        .score-display {
            font-size: 3rem;
            color: var(--primary-purple);
            font-weight: 800;
        }

        /* Canvas for Confetti */
        #confetti-canvas {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            pointer-events: none;
            z-index: 999;
        }

    </style>
</head>
<body>

<canvas id="confetti-canvas"></canvas>

<div class="container">
    <header>
        <h1>B√†i Ki·ªÉm Tra T·ªïng H·ª£p</h1>
        <div class="teacher-name">Gi√°o vi√™n: Ms Mai An ULIS</div>
    </header>

    <div class="exercise-section" id="ex8">
        <div class="exercise-title">Exercise 8: Solar Energy</div>
        
        <div class="reading-text">
            Are you looking for a cheap, clean, effective source of power that doesn‚Äôt cause <span class="gap-marker" onclick="scrollToQ('ex8-q1')">(1)</span> or waste natural resources? Look no further than solar energy from the <span class="gap-marker" onclick="scrollToQ('ex8-q2')">(2)</span>. At present, most of our electricity comes from the use of coal, gas, oil or nuclear power. This power could be provided by the Sun. One percent of the solar energy that reaches the Earth is enough to provide power for the total <span class="gap-marker" onclick="scrollToQ('ex8-q3')">(3)</span>. Many countries are already using solar energy. Solar panels are placed <span class="gap-marker" onclick="scrollToQ('ex8-q4')">(4)</span> the roof of a house and the Sun‚Äôs energy is used to heat water.
        </div>

        <div class="glossary-container">
            <div class="glossary-title">üìö Glossary - T·ª´ v·ª±ng c·∫ßn nh·ªõ</div>
            <table class="glossary-table">
                <tr><th>T·ª´ v·ª±ng</th><th>Lo·∫°i t·ª´</th><th>Nghƒ©a ti·∫øng Vi·ªát</th></tr>
                <tr><td>Effective</td><td>Adj</td><td>Hi·ªáu qu·∫£</td></tr>
                <tr><td>Source of power</td><td>Phrase</td><td>Ngu·ªìn nƒÉng l∆∞·ª£ng</td></tr>
                <tr><td>Natural resources</td><td>Noun</td><td>T√†i nguy√™n thi√™n nhi√™n</td></tr>
                <tr><td>Nuclear power</td><td>Noun</td><td>NƒÉng l∆∞·ª£ng h·∫°t nh√¢n</td></tr>
                <tr><td>Solar panel</td><td>Noun</td><td>T·∫•m pin m·∫∑t tr·ªùi</td></tr>
            </table>
        </div>

        <div class="question-grid" id="ex8-questions">
            </div>
    </div>

    <div class="exercise-section" id="ex9">
        <div class="exercise-title">Exercise 9: Renewable vs Fossil Fuels</div>
        
        <div class="reading-text">
            Most of our energy comes from fossil fuels <span class="gap-marker" onclick="scrollToQ('ex9-q1')">(1)</span> coal, oil, and natural gas. Although the supplies of these energy sources are plentiful, they are limited. The <span class="gap-marker" onclick="scrollToQ('ex9-q2')">(2)</span> of coal and oil is also having very harmful impacts <span class="gap-marker" onclick="scrollToQ('ex9-q3')">(3)</span> the environment. However, fossil fuels are not the only source of energy and burning fuel is not the only way to <span class="gap-marker" onclick="scrollToQ('ex9-q4')">(4)</span> heat and motion. Renewable energy offers us a better way. Some energy sources are renewable because they are naturally available <span class="gap-marker" onclick="scrollToQ('ex9-q5')">(5)</span> last forever. Some sources have enormous supply so humans can never use them up. Moreover, renewable energy sources <span class="gap-marker" onclick="scrollToQ('ex9-q6')">(6)</span> much smaller impacts on the environment than fossil and nuclear fuels. <span class="gap-marker" onclick="scrollToQ('ex9-q7')">(7)</span> include solar energy, which comes from the sun and can be converted into electricity and heat. Wind, geothermal energy from inside the earth, biomass from plants, and hydropower from water are <span class="gap-marker" onclick="scrollToQ('ex9-q8')">(8)</span> renewable sources of energy.
        </div>

        <div class="glossary-container">
            <div class="glossary-title">üìö Glossary - T·ª´ v·ª±ng c·∫ßn nh·ªõ</div>
            <table class="glossary-table">
                <tr><th>T·ª´ v·ª±ng</th><th>Lo·∫°i t·ª´</th><th>Nghƒ©a ti·∫øng Vi·ªát</th></tr>
                <tr><td>Fossil fuels</td><td>Noun</td><td>Nhi√™n li·ªáu h√≥a th·∫°ch</td></tr>
                <tr><td>Plentiful</td><td>Adj</td><td>Phong ph√∫, d·ªìi d√†o</td></tr>
                <tr><td>Impact</td><td>Noun/Verb</td><td>T√°c ƒë·ªông, ·∫£nh h∆∞·ªüng</td></tr>
                <tr><td>Renewable</td><td>Adj</td><td>C√≥ th·ªÉ t√°i t·∫°o</td></tr>
                <tr><td>Geothermal</td><td>Adj</td><td>ƒê·ªãa nhi·ªát</td></tr>
                <tr><td>Biomass</td><td>Noun</td><td>Sinh kh·ªëi</td></tr>
                <tr><td>Hydropower</td><td>Noun</td><td>Th·ªßy ƒëi·ªán</td></tr>
            </table>
        </div>

        <div class="question-grid" id="ex9-questions">
            </div>
    </div>

    <div class="exercise-section" id="ex10">
        <div class="exercise-title">Exercise 10: Education & Energy</div>
        
        <div class="reading-text">
            It‚Äôs hard to imagine education without <span class="gap-marker" onclick="scrollToQ('ex10-q1')">(1)</span>. Without energy, people‚Äôs ability to get a decent education is severely <span class="gap-marker" onclick="scrollToQ('ex10-q2')">(2)</span>. Education is acknowledged as a crucial factor in helping people escape <span class="gap-marker" onclick="scrollToQ('ex10-q3')">(3)</span> poverty. In communities without energy children are often forced out of school to help <span class="gap-marker" onclick="scrollToQ('ex10-q4')">(4)</span> cooking <span class="gap-marker" onclick="scrollToQ('ex10-q5')">(5)</span> or earn money. When they do go to school it has to be in <span class="gap-marker" onclick="scrollToQ('ex10-q6')">(6)</span> which restricts their hours especially as many children walk for hours to get there. When they arrive home to do their schoolwork, they have no <span class="gap-marker" onclick="scrollToQ('ex10-q7')">(7)</span> to study and all that greets them is darkness. Or they have to rely on kerosene to provide precious light, which is both expensive and dangerous; if a lamp is knocked over it can cause serious burns. Computers, radio or TV are important tools in the <span class="gap-marker" onclick="scrollToQ('ex10-q8')">(8)</span> education. A <span class="gap-marker" onclick="scrollToQ('ex10-q9')">(9)</span> of electricity restricts the <span class="gap-marker" onclick="scrollToQ('ex10-q10')">(10)</span> for children to further their education. And teachers don‚Äôt want to work in communities where there are no lights, little equipment, no TVs, computers, or life after dark.
        </div>

        <div class="glossary-container">
            <div class="glossary-title">üìö Glossary - T·ª´ v·ª±ng c·∫ßn nh·ªõ</div>
            <table class="glossary-table">
                <tr><th>T·ª´ v·ª±ng</th><th>Lo·∫°i t·ª´</th><th>Nghƒ©a ti·∫øng Vi·ªát</th></tr>
                <tr><td>Decent</td><td>Adj</td><td>T·ª≠ t·∫ø, t∆∞∆°m t·∫•t</td></tr>
                <tr><td>Severely</td><td>Adv</td><td>Nghi√™m tr·ªçng, kh·∫Øt khe</td></tr>
                <tr><td>Crucial</td><td>Adj</td><td>C·ªët y·∫øu, quan tr·ªçng</td></tr>
                <tr><td>Kerosene</td><td>Noun</td><td>D·∫ßu h·ªèa</td></tr>
                <tr><td>Restrict</td><td>Verb</td><td>H·∫°n ch·∫ø</td></tr>
                <tr><td>Knocked over</td><td>Phr V</td><td>B·ªã l√†m ƒë·ªï</td></tr>
            </table>
        </div>

        <div class="question-grid" id="ex10-questions">
            </div>
    </div>

    <div class="submit-section">
        <button class="submit-btn" onclick="finishTest()">N·ªòP B√ÄI & XEM ƒêI·ªÇM üöÄ</button>
    </div>
</div>

<div id="resultModal" class="modal">
    <div class="modal-content">
        <h2>üéâ K·∫æT QU·∫¢ C·ª¶A B·∫†N üéâ</h2>
        <div class="score-display" id="scoreText">0/0</div>
        <p id="feedbackText" style="font-size: 1.2rem; margin-top: 20px;">L√†m t·ªët l·∫Øm!</p>
        <button class="submit-btn" style="font-size: 1rem; padding: 10px 30px; margin-top: 20px;" onclick="closeModal()">Xem l·∫°i b√†i l√†m</button>
    </div>
</div>

<script>
    // --- DATABASE D·ªÆ LI·ªÜU & GI·∫¢I TH√çCH ---
    const exercisesData = {
        ex8: [
            {
                id: "ex8-q1",
                num: 1,
                options: {A: "pollute", B: "pollutes", C: "polluted", D: "pollution"},
                correct: "D",
                trans: "B·∫°n ƒëang t√¨m ki·∫øm m·ªôt ngu·ªìn nƒÉng l∆∞·ª£ng r·∫ª, s·∫°ch, hi·ªáu qu·∫£ m√† kh√¥ng g√¢y ra ______ ho·∫∑c l√£ng ph√≠ t√†i nguy√™n thi√™n nhi√™n?",
                vocab: {A: "g√¢y √¥ nhi·ªÖm (v)", B: "g√¢y √¥ nhi·ªÖm (v-s/es)", C: "b·ªã √¥ nhi·ªÖm (adj/v-ed)", D: "s·ª± √¥ nhi·ªÖm (n)"},
                whyCorrect: "Sau ƒë·ªông t·ª´ 'cause' (g√¢y ra) c·∫ßn m·ªôt Danh t·ª´ l√†m t√¢n ng·ªØ. 'Pollution' l√† danh t·ª´.",
                whyWrong: "C√°c ƒë√°p √°n c√≤n l·∫°i l√† ƒë·ªông t·ª´ ho·∫∑c t√≠nh t·ª´, kh√¥ng ƒë·ª©ng sau 'cause' ƒë·ªÉ l√†m t√¢n ng·ªØ trong ng·ªØ c·∫£nh n√†y."
            },
            {
                id: "ex8-q2",
                num: 2,
                options: {A: "Moon", B: "Sun", C: "Earth", D: "Mars"},
                correct: "B",
                trans: "Kh√¥ng c·∫ßn t√¨m ƒë√¢u xa ngo√†i nƒÉng l∆∞·ª£ng m·∫∑t tr·ªùi t·ª´ ______.",
                vocab: {A: "M·∫∑t trƒÉng", B: "M·∫∑t tr·ªùi", C: "Tr√°i ƒë·∫•t", D: "Sao H·ªèa"},
                whyCorrect: "C·ª•m t·ª´ 'Solar energy' nghƒ©a l√† nƒÉng l∆∞·ª£ng m·∫∑t tr·ªùi, n√™n ngu·ªìn g·ªëc ph·∫£i l√† t·ª´ 'Sun'.",
                whyWrong: "C√°c h√†nh tinh kh√°c kh√¥ng cung c·∫•p 'Solar energy'."
            },
            {
                id: "ex8-q3",
                num: 3,
                options: {A: "popular", B: "population", C: "world", D: "Vietnam"},
                correct: "C",
                trans: "1% nƒÉng l∆∞·ª£ng m·∫∑t tr·ªùi t·ªõi Tr√°i ƒë·∫•t ƒë·ªß ƒë·ªÉ cung c·∫•p ƒëi·ªán cho to√†n b·ªô ______.",
                vocab: {A: "ph·ªï bi·∫øn (adj)", B: "d√¢n s·ªë (n)", C: "th·∫ø gi·ªõi (n)", D: "Vi·ªát Nam (n)"},
                whyCorrect: "C·ª•m t·ª´ 'the total world' (to√†n th·∫ø gi·ªõi) ho·∫∑c hi·ªÉu theo nghƒ©a 'to√†n b·ªô th·∫ø gi·ªõi'. D√π 'population' c≈©ng c√≥ l√Ω nh∆∞ng trong ng·ªØ c·∫£nh nƒÉng l∆∞·ª£ng to√†n c·∫ßu, ng∆∞·ªùi ta th∆∞·ªùng n√≥i 'provide power for the total world' (cung c·∫•p cho c·∫£ th·∫ø gi·ªõi). *L∆∞u √Ω: N·∫øu ƒë·ªÅ g·ªëc c√≥ √Ω 'total population', ƒë√°p √°n B c≈©ng h·ª£p l√Ω, nh∆∞ng 'world' bao qu√°t c·∫£ c√¥ng nghi·ªáp/v·∫≠n h√†nh.* Tuy nhi√™n, x√©t ƒë√°p √°n C 'world' l√† ph·ªï bi·∫øn nh·∫•t trong ng·ªØ c·∫£nh b√†i ƒë·ªçc n√†y.",
                whyWrong: "'Popular' l√† t√≠nh t·ª´. 'Vietnam' qu√° h·∫πp."
            },
            {
                id: "ex8-q4",
                num: 4,
                options: {A: "on", B: "in", C: "of", D: "to"},
                correct: "A",
                trans: "C√°c t·∫•m pin m·∫∑t tr·ªùi ƒë∆∞·ª£c ƒë·∫∑t ______ m√°i nh√†.",
                vocab: {A: "tr√™n (b·ªÅ m·∫∑t)", B: "trong", C: "c·ªßa", D: "ƒë·∫øn"},
                whyCorrect: "C·∫•u tr√∫c: 'On the roof' (tr√™n m√°i nh√†).",
                whyWrong: "Ch√∫ng ta kh√¥ng ƒë·∫∑t pin 'trong' (in) m√°i nh√† hay 'c·ªßa' (of) m√°i nh√†."
            }
        ],
        ex9: [
            {
                id: "ex9-q1",
                num: 1,
                options: {A: "include", B: "such as", C: "unlike", D: "is"},
                correct: "B",
                trans: "H·∫ßu h·∫øt nƒÉng l∆∞·ª£ng ƒë·∫øn t·ª´ nhi√™n li·ªáu h√≥a th·∫°ch ______ than ƒë√°, d·∫ßu m·ªè v√† kh√≠ ƒë·ªët.",
                vocab: {A: "bao g·ªìm (v)", B: "nh∆∞ l√† (li·ªát k√™)", C: "kh√¥ng gi·ªëng", D: "l√†"},
                whyCorrect: "D√πng 'such as' ƒë·ªÉ li·ªát k√™ c√°c v√≠ d·ª• c·ª• th·ªÉ c·ªßa nh√≥m ƒë·ª©ng tr∆∞·ªõc (fossil fuels).",
                whyWrong: "'Include' l√† ƒë·ªông t·ª´, ·ªü ƒë√¢y c√¢u ƒë√£ c√≥ ƒë·ªông t·ª´ ch√≠nh 'comes'. C·∫ßn t·ª´ n·ªëi li·ªát k√™."
            },
            {
                id: "ex9-q2",
                num: 2,
                options: {A: "burn", B: "to burn", C: "burns", D: "burning"},
                correct: "D",
                trans: "Vi·ªác ______ than v√† d·∫ßu c≈©ng ƒëang g√¢y ra nh·ªØng t√°c ƒë·ªông r·∫•t c√≥ h·∫°i.",
                vocab: {A: "ƒë·ªët (v)", B: "ƒë·ªÉ ƒë·ªët", C: "ƒë·ªët (v-s)", D: "vi·ªác ƒë·ªët (Danh ƒë·ªông t·ª´)"},
                whyCorrect: "C·∫ßn m·ªôt Danh t·ª´ ho·∫∑c Danh ƒë·ªông t·ª´ (V-ing) ƒë·ª©ng ƒë·∫ßu c·ª•m danh t·ª´ l√†m ch·ªß ng·ªØ 'The ______ of coal'. 'Burning' l√† danh ƒë·ªông t·ª´ ch·ªâ h√†nh ƒë·ªông ƒë·ªët.",
                whyWrong: "Sau 'The' kh√¥ng d√πng ƒë·ªông t·ª´ nguy√™n th·ªÉ (burn) hay to-V."
            },
            {
                id: "ex9-q3",
                num: 3,
                options: {A: "at", B: "of", C: "on", D: "in"},
                correct: "C",
                trans: "...t√°c ƒë·ªông r·∫•t c√≥ h·∫°i ______ m√¥i tr∆∞·ªùng.",
                vocab: {A: "t·∫°i", B: "c·ªßa", C: "l√™n/ƒë·ªëi v·ªõi", D: "trong"},
                whyCorrect: "C·ª•m t·ª´ c·ªë ƒë·ªãnh (Collocation): 'Impact on' (T√°c ƒë·ªông l√™n c√°i g√¨).",
                whyWrong: "Kh√¥ng d√πng impact at/of/in trong ng·ªØ c·∫£nh t√°c ƒë·ªông l√™n ƒë·ªëi t∆∞·ª£ng n√†o ƒë√≥."
            },
            {
                id: "ex9-q4",
                num: 4,
                options: {A: "produce", B: "save", C: "reuse", D: "recycle"},
                correct: "A",
                trans: "...ƒë·ªët nhi√™n li·ªáu kh√¥ng ph·∫£i l√† c√°ch duy nh·∫•t ƒë·ªÉ ______ nhi·ªát v√† chuy·ªÉn ƒë·ªông.",
                vocab: {A: "t·∫°o ra/s·∫£n xu·∫•t", B: "ti·∫øt ki·ªám", C: "t√°i s·ª≠ d·ª•ng", D: "t√°i ch·∫ø"},
                whyCorrect: "Nhi√™n li·ªáu ƒë·ªët ch√°y ƒë·ªÉ 't·∫°o ra' (produce) nhi·ªát nƒÉng.",
                whyWrong: "Ta kh√¥ng 'ti·∫øt ki·ªám', 't√°i s·ª≠ d·ª•ng' nhi·ªát theo c√°ch ƒë·ªët nhi√™n li·ªáu."
            },
            {
                id: "ex9-q5",
                num: 5,
                options: {A: "so", B: "but", C: "for", D: "and"},
                correct: "D",
                trans: "...ch√∫ng c√≥ s·∫µn trong t·ª± nhi√™n ______ t·ªìn t·∫°i m√£i m√£i.",
                vocab: {A: "v√¨ v·∫≠y", B: "nh∆∞ng", C: "cho", D: "v√†"},
                whyCorrect: "D√πng 'and' ƒë·ªÉ n·ªëi hai ƒë·∫∑c ƒëi·ªÉm t√≠ch c·ª±c song song: c√≥ s·∫µn v√† t·ªìn t·∫°i m√£i m√£i.",
                whyWrong: "'But' d√πng cho √Ω t∆∞∆°ng ph·∫£n. 'So' d√πng cho k·∫øt qu·∫£."
            },
            {
                id: "ex9-q6",
                num: 6,
                options: {A: "are", B: "had", C: "have", D: "has"},
                correct: "C",
                trans: "H∆°n n·ªØa, c√°c ngu·ªìn nƒÉng l∆∞·ª£ng t√°i t·∫°o ______ t√°c ƒë·ªông nh·ªè h∆°n nhi·ªÅu...",
                vocab: {A: "l√†", B: "ƒë√£ c√≥", C: "c√≥ (s·ªë nhi·ªÅu)", D: "c√≥ (s·ªë √≠t)"},
                whyCorrect: "Ch·ªß ng·ªØ l√† 'renewable energy sources' (s·ªë nhi·ªÅu) -> ƒê·ªông t·ª´ chia s·ªë nhi·ªÅu 'have'. C√¢u ·ªü th√¨ hi·ªán t·∫°i ƒë∆°n.",
                whyWrong: "'Has' l√† s·ªë √≠t. 'Are' kh√¥ng ƒëi v·ªõi danh t·ª´ 'impacts' theo nghƒ©a s·ªü h·ªØu."
            },
            {
                id: "ex9-q7",
                num: 7,
                options: {A: "It", B: "There", C: "That", D: "They"},
                correct: "D",
                trans: "______ bao g·ªìm nƒÉng l∆∞·ª£ng m·∫∑t tr·ªùi...",
                vocab: {A: "N√≥", B: "ƒê√≥/C√≥", C: "ƒê√≥", D: "Ch√∫ng"},
                whyCorrect: "'They' thay th·∫ø cho 'renewable energy sources' ·ªü c√¢u tr∆∞·ªõc (danh t·ª´ s·ªë nhi·ªÅu).",
                whyWrong: "'It', 'That' d√πng cho s·ªë √≠t."
            },
            {
                id: "ex9-q8",
                num: 8,
                options: {A: "also", B: "only", C: "last", D: "then"},
                correct: "A",
                trans: "Gi√≥, ƒë·ªãa nhi·ªát... ______ l√† c√°c ngu·ªìn nƒÉng l∆∞·ª£ng t√°i t·∫°o.",
                vocab: {A: "c≈©ng", B: "duy nh·∫•t", C: "cu·ªëi c√πng", D: "sau ƒë√≥"},
                whyCorrect: "'Also' d√πng ƒë·ªÉ b·ªï sung th√™m th√¥ng tin, kh·∫≥ng ƒë·ªãnh c√°c lo·∫°i k·ªÉ tr√™n *c≈©ng* l√† nƒÉng l∆∞·ª£ng t√°i t·∫°o.",
                whyWrong: "'Only' sai nghƒ©a (kh√¥ng ph·∫£i duy nh·∫•t). 'Last'/'Then' kh√¥ng h·ª£p ng·ªØ ph√°p v·ªã tr√≠ n√†y."
            }
        ],
        ex10: [
            { id: "ex10-q1", num: 1, options: {A: "like", B: "energy", C: "such as", D: "similar"}, correct: "B", trans: "Kh√≥ m√† t∆∞·ªüng t∆∞·ª£ng gi√°o d·ª•c m√† kh√¥ng c√≥ ______.", vocab: {A: "gi·ªëng", B: "nƒÉng l∆∞·ª£ng", C: "nh∆∞ l√†", D: "t∆∞∆°ng t·ª±"}, whyCorrect: "D·ª±a v√†o c√¢u sau 'Without energy...', t·ª´ c·∫ßn ƒëi·ªÅn l√† ch·ªß ƒë·ªÅ ch√≠nh: energy.", whyWrong: "C√°c t·ª´ kh√°c kh√¥ng t·∫°o nghƒ©a h·ª£p l√Ω." },
            { id: "ex10-q2", num: 2, options: {A: "approximately", B: "expressively", C: "affected", D: "progressively"}, correct: "C", trans: "...kh·∫£ nƒÉng nh·∫≠n ƒë∆∞·ª£c n·ªÅn gi√°o d·ª•c t·ª≠ t·∫ø b·ªã ______ nghi√™m tr·ªçng.", vocab: {A: "x·∫•p x·ªâ", B: "bi·ªÉu c·∫£m", C: "b·ªã ·∫£nh h∆∞·ªüng", D: "ti·∫øn b·ªô"}, whyCorrect: "C·∫•u tr√∫c b·ªã ƒë·ªông 'be severely affected' (b·ªã ·∫£nh h∆∞·ªüng nghi√™m tr·ªçng).", whyWrong: "C√°c tr·∫°ng t·ª´ A, D kh√¥ng ph·∫£i ƒë·ªông t·ª´/t√≠nh t·ª´ ƒë·ªÉ ƒëi sau to be trong ng·ªØ c·∫£nh n√†y." },
            { id: "ex10-q3", num: 3, options: {A: "from", B: "pioneering", C: "pioneering", D: "pioneers"}, correct: "A", trans: "...gi√∫p con ng∆∞·ªùi tho√°t ______ ngh√®o ƒë√≥i.", vocab: {A: "kh·ªèi", B: "ti√™n phong", C: "ti√™n phong", D: "ng∆∞·ªùi ti√™n phong"}, whyCorrect: "C·ª•m 'escape from poverty' (tho√°t kh·ªèi ngh√®o ƒë√≥i). *L∆∞u √Ω: ƒê√¥i khi escape poverty kh√¥ng c·∫ßn from, nh∆∞ng trong c√°c l·ª±a ch·ªçn th√¨ 'from' l√† h·ª£p l√Ω nh·∫•t.*", whyWrong: "Pioneering/Pioneers kh√¥ng li√™n quan ƒë·∫øn c·∫•u tr√∫c tho√°t ngh√®o." },
            { id: "ex10-q4", num: 4, options: {A: "custom", B: "waiter", C: "collect", D: "pill"}, correct: "C", trans: "...tr·∫ª em ph·∫£i ngh·ªâ h·ªçc ƒë·ªÉ gi√∫p ______ v·∫≠t li·ªáu n·∫•u ƒÉn.", vocab: {A: "phong t·ª•c", B: "b·ªìi b√†n", C: "thu gom/nh·∫∑t", D: "thu·ªëc"}, whyCorrect: "H√†nh ƒë·ªông 'collect cooking materials' (nh·∫∑t c·ªßi/nhi√™n li·ªáu n·∫•u ƒÉn).", whyWrong: "Custom/Waiter/Pill l√† danh t·ª´ kh√¥ng li√™n quan h√†nh ƒë·ªông." },
            { id: "ex10-q5", num: 5, options: {A: "tourists", B: "materials", C: "pilot", D: "guess"}, correct: "B", trans: "...v·∫≠t li·ªáu n·∫•u ƒÉn (cooking materials).", vocab: {A: "du kh√°ch", B: "v·∫≠t li·ªáu/nguy√™n li·ªáu", C: "phi c√¥ng", D: "ƒëo√°n"}, whyCorrect: "Cooking materials: Nguy√™n li·ªáu ƒë·ªët/n·∫•u (c·ªßi, than).", whyWrong: "Kh√¥ng ai ƒëi thu gom tourists hay pilot ƒë·ªÉ n·∫•u ƒÉn c·∫£." },
            { id: "ex10-q6", num: 6, options: {A: "orbit", B: "orbition", C: "orbital", D: "daylight"}, correct: "D", trans: "Khi ƒëi h·ªçc, ch√∫ng ph·∫£i ƒëi v√†o ______...", vocab: {A: "qu·ªπ ƒë·∫°o", B: "(kh√¥ng c√≥ t·ª´ n√†y)", C: "thu·ªôc qu·ªπ ƒë·∫°o", D: "ban ng√†y/√°nh s√°ng ng√†y"}, whyCorrect: "√ù n√≥i ph·∫£i ƒëi h·ªçc v√†o ban ng√†y (in daylight) v√¨ kh√¥ng c√≥ ƒëi·ªán v√†o ban ƒë√™m.", whyWrong: "Orbit li√™n quan v≈© tr·ª•." },
            { id: "ex10-q7", num: 7, options: {A: "light", B: "designed", C: "draw", D: "painted"}, correct: "A", trans: "...ch√∫ng kh√¥ng c√≥ ______ ƒë·ªÉ h·ªçc.", vocab: {A: "√°nh s√°ng", B: "ƒë∆∞·ª£c thi·∫øt k·∫ø", C: "v·∫Ω", D: "ƒë∆∞·ª£c s∆°n"}, whyCorrect: "C·∫ßn danh t·ª´. 'Have no light to study' (kh√¥ng c√≥ ƒë√®n/√°nh s√°ng ƒë·ªÉ h·ªçc).", whyWrong: "Designed/Painted l√† ƒë·ªông t·ª´/t√≠nh t·ª´." },
            { id: "ex10-q8", num: 8, options: {A: "equipment", B: "tool", C: "modern", D: "furniture"}, correct: "C", trans: "...l√† c√¥ng c·ª• quan tr·ªçng trong n·ªÅn gi√°o d·ª•c ______.", vocab: {A: "thi·∫øt b·ªã", B: "c√¥ng c·ª•", C: "hi·ªán ƒë·∫°i", D: "n·ªôi th·∫•t"}, whyCorrect: "Modern education: Gi√°o d·ª•c hi·ªán ƒë·∫°i (n∆°i d√πng m√°y t√≠nh, TV).", whyWrong: "Equipment/Tool/Furniture l√† danh t·ª´, kh√¥ng b·ªï nghƒ©a cho education h·ª£p l√Ω b·∫±ng t√≠nh t·ª´ 'modern'." },
            { id: "ex10-q9", num: 9, options: {A: "invitation", B: "lack", C: "space", D: "aviation"}, correct: "B", trans: "S·ª± ______ ƒëi·ªán h·∫°n ch·∫ø c∆° h·ªôi...", vocab: {A: "l·ªùi m·ªùi", B: "thi·∫øu h·ª•t", C: "kh√¥ng gian", D: "h√†ng kh√¥ng"}, whyCorrect: "'A lack of electricity' (S·ª± thi·∫øu ƒëi·ªán).", whyWrong: "C√°c t·ª´ kh√°c kh√¥ng ƒëi v·ªõi 'of electricity' ƒë·ªÉ t·∫°o nghƒ©a ph√π h·ª£p ng·ªØ c·∫£nh ngh√®o kh√≥." },
            { id: "ex10-q10", num: 10, options: {A: "landscape", B: "departures", C: "islands", D: "opportunity"}, correct: "D", trans: "...h·∫°n ch·∫ø ______ ƒë·ªÉ tr·∫ª em n√¢ng cao vi·ªác h·ªçc.", vocab: {A: "phong c·∫£nh", B: "s·ª± kh·ªüi h√†nh", C: "ƒë·∫£o", D: "c∆° h·ªôi"}, whyCorrect: "'Restrict the opportunity' (H·∫°n ch·∫ø c∆° h·ªôi).", whyWrong: "Landscape/Islands kh√¥ng li√™n quan gi√°o d·ª•c." }
        ]
    };

    let userScore = 0;
    const totalQuestions = Object.values(exercisesData).reduce((acc, curr) => acc + curr.length, 0);
    const answeredState = {};

    // --- RENDER H·ªÜ TH·ªêNG C√ÇU H·ªéI ---
    function renderQuestions() {
        for (const [key, questions] of Object.entries(exercisesData)) {
            const container = document.getElementById(`${key}-questions`);
            questions.forEach(q => {
                const card = document.createElement('div');
                card.className = 'question-card';
                card.id = q.id; // ID ƒë·ªÉ scroll t·ªõi
                
                card.innerHTML = `
                    <span class="q-number">C√¢u h·ªèi (${q.num}):</span>
                    <div class="options-container">
                        ${Object.entries(q.options).map(([optKey, optVal]) => `
                            <button class="option-btn" onclick="checkAnswer('${key}', '${q.id}', '${optKey}', this)">
                                ${optKey}. ${optVal}
                            </button>
                        `).join('')}
                    </div>
                    <div class="explanation-box" id="exp-${q.id}">
                        <div class="teacher-avatar">C√¥ Mai An gi·∫£i th√≠ch:</div>
                        <div class="exp-section"><strong>üó£Ô∏è D·ªãch:</strong> ${q.trans}</div>
                        <div class="exp-section"><strong>üìñ Ph√¢n t√≠ch:</strong><br>
                            ${Object.entries(q.vocab).map(([k, v]) => `- ${k}: ${v}`).join('<br>')}
                        </div>
                        <div class="exp-section"><span class="exp-correct-tag">‚úÖ T·∫°i sao ƒê√öNG:</span> ${q.whyCorrect}</div>
                        <div class="exp-section"><span class="exp-wrong-tag">‚ö†Ô∏è T·∫°i sao SAI:</span> ${q.whyWrong}</div>
                    </div>
                `;
                container.appendChild(card);
            });
        }
    }

    // --- LOGIC CHECK ANSWER ---
    function checkAnswer(exKey, qId, selectedOpt, btnElement) {
        // Prevent re-answering if already correct (optional logic, here we allow changing unless we want strict mode)
        // But for "Super Detailed" viewing, we allow clicking around.
        // Let's mark visuals.

        const qData = exercisesData[exKey].find(q => q.id === qId);
        const parent = btnElement.parentElement;
        const allBtns = parent.querySelectorAll('.option-btn');
        const explanationBox = document.getElementById(`exp-${qId}`);

        // Reset visual state for this question
        allBtns.forEach(b => {
            b.classList.remove('correct', 'wrong');
            // b.disabled = true; // N·∫øu mu·ªën kh√≥a sau 1 l·∫ßn ch·ªçn th√¨ uncomment
        });

        if (selectedOpt === qData.correct) {
            // ƒê√öNG
            btnElement.classList.add('correct');
            playSound('ding');
            triggerConfetti();
            if (!answeredState[qId]) {
                userScore++;
                answeredState[qId] = true; // Mark as scored
            }
        } else {
            // SAI
            btnElement.classList.add('wrong');
            // Highlight ƒë√°p √°n ƒë√∫ng
            const correctBtn = Array.from(allBtns).find(b => b.innerText.startsWith(qData.correct));
            if(correctBtn) correctBtn.classList.add('correct'); // Show correct answer visually
            
            playSound('buzz');
            if (answeredState[qId]) {
                userScore--; // Minus score if changed from right to wrong (optional)
                delete answeredState[qId];
            }
        }

        // Hi·ªán gi·∫£i th√≠ch
        explanationBox.style.display = 'block';
    }

    // --- SCROLL TO QUESTION ---
    function scrollToQ(id) {
        const el = document.getElementById(id);
        el.scrollIntoView({behavior: 'smooth', block: 'center'});
        el.classList.add('active-focus');
        setTimeout(() => el.classList.remove('active-focus'), 2000);
    }

    // --- FINISH TEST ---
    function finishTest() {
        const modal = document.getElementById('resultModal');
        const scoreText = document.getElementById('scoreText');
        const feedback = document.getElementById('feedbackText');
        
        // T√≠nh ƒëi·ªÉm d·ª±a tr√™n s·ªë c√¢u ƒë√£ l√†m ƒë√∫ng trong state
        let currentScore = 0;
        // Duy·ªát l·∫°i UI ƒë·ªÉ ƒë·∫øm ch√≠nh x√°c (v√¨ user c√≥ th·ªÉ ch·ªçn ƒëi ch·ªçn l·∫°i)
        document.querySelectorAll('.question-card').forEach(card => {
             const correctBtn = card.querySelector('.option-btn.correct');
             // Logic: Button ƒë∆∞·ª£c ch·ªçn (c√≥ class correct) v√† ƒë√∫ng logic (ƒë√£ check trong checkAnswer)
             // ·ªû ƒë√¢y checkAnswer ƒë√£ g√°n class correct cho ƒë√°p √°n ƒë√∫ng.
             // Ta c·∫ßn ki·ªÉm tra xem ng∆∞·ªùi d√πng C√ì CLICK V√ÄO N√ì KH√îNG?
             // C√°ch ƒë∆°n gi·∫£n: ƒë·∫øm s·ªë l∆∞·ª£ng key trong answeredState
        });

        // Use strict calculated score
        scoreText.innerText = `${userScore} / ${totalQuestions}`;

        if (userScore === totalQuestions) {
            feedback.innerText = "üåü Xu·∫•t s·∫Øc! Em l√† thi√™n t√†i ti·∫øng Anh! üåü";
            triggerConfetti();
            triggerConfetti();
        } else if (userScore > totalQuestions * 0.7) {
            feedback.innerText = "üëè R·∫•t t·ªët! C·ªë g·∫Øng th√™m ch√∫t n·ªØa l√† ho√†n h·∫£o!";
        } else {
            feedback.innerText = "üí™ ƒê·ª´ng n·∫£n ch√≠! H√£y xem k·ªπ gi·∫£i th√≠ch c·ªßa c√¥ nh√©!";
        }

        modal.style.display = 'block';
    }

    function closeModal() {
        document.getElementById('resultModal').style.display = 'none';
    }

    // --- SOUND EFFECTS (Base64) ---
    // Short beep for Correct
    const dingSound = "data:audio/wav;base64,UklGRl9vT19XQVZFZm10IBAAAAABAAEAQB8AAEAfAAABAAgAZGF0YU"; 
    // *L∆∞u √Ω: ƒê·ªÉ file g·ªçn nh·∫π, t√¥i d√πng placeholder. Trong th·ª±c t·∫ø c·∫ßn chu·ªói base64 d√†i h∆°n ho·∫∑c file mp3.
    // D∆∞·ªõi ƒë√¢y l√† gi·∫£ l·∫≠p √¢m thanh b·∫±ng Web Audio API ƒë·ªÉ kh√¥ng c·∫ßn file ngo√†i.*
    
    const audioCtx = new (window.AudioContext || window.webkitAudioContext)();

    function playSound(type) {
        if (audioCtx.state === 'suspended') audioCtx.resume();
        const osc = audioCtx.createOscillator();
        const gainNode = audioCtx.createGain();
        osc.connect(gainNode);
        gainNode.connect(audioCtx.destination);

        if (type === 'ding') {
            osc.type = 'sine';
            osc.frequency.setValueAtTime(500, audioCtx.currentTime);
            osc.frequency.exponentialRampToValueAtTime(1000, audioCtx.currentTime + 0.1);
            gainNode.gain.setValueAtTime(0.3, audioCtx.currentTime);
            gainNode.gain.exponentialRampToValueAtTime(0.01, audioCtx.currentTime + 0.5);
            osc.start();
            osc.stop(audioCtx.currentTime + 0.5);
        } else {
            // Buzz
            osc.type = 'sawtooth';
            osc.frequency.setValueAtTime(150, audioCtx.currentTime);
            osc.frequency.linearRampToValueAtTime(100, audioCtx.currentTime + 0.3);
            gainNode.gain.setValueAtTime(0.3, audioCtx.currentTime);
            gainNode.gain.linearRampToValueAtTime(0.01, audioCtx.currentTime + 0.3);
            osc.start();
            osc.stop(audioCtx.currentTime + 0.3);
        }
    }

    // --- CONFETTI EFFECT (Minimal JS) ---
    function triggerConfetti() {
        const canvas = document.getElementById('confetti-canvas');
        const ctx = canvas.getContext('2d');
        canvas.width = window.innerWidth;
        canvas.height = window.innerHeight;
        
        const pieces = [];
        const colors = ['#8854C0', '#00C9A7', '#FF4757', '#FFD700'];

        for(let i=0; i<100; i++) {
            pieces.push({
                x: Math.random() * canvas.width,
                y: Math.random() * canvas.height - canvas.height,
                w: Math.random() * 10 + 5,
                h: Math.random() * 10 + 5,
                color: colors[Math.floor(Math.random() * colors.length)],
                vy: Math.random() * 5 + 2,
                vx: Math.random() * 4 - 2
            });
        }

        function draw() {
            ctx.clearRect(0,0,canvas.width, canvas.height);
            let active = false;
            pieces.forEach(p => {
                p.y += p.vy;
                p.x += p.vx;
                ctx.fillStyle = p.color;
                ctx.fillRect(p.x, p.y, p.w, p.h);
                if(p.y < canvas.height) active = true;
            });
            if(active) requestAnimationFrame(draw);
            else ctx.clearRect(0,0,canvas.width, canvas.height);
        }
        draw();
    }

    // INIT
    window.onload = function() {
        renderQuestions();
    };

</script>

</body>
</html>