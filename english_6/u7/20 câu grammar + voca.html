<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>English Grade 6 - Ms Mai An ULIS</title>
    <link href="https://fonts.googleapis.com/css2?family=Nunito:wght@400;600;700;800&display=swap" rel="stylesheet">
    <script src="https://cdn.jsdelivr.net/npm/canvas-confetti@1.6.0/dist/confetti.browser.min.js"></script>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        :root {
            --primary: #8854C0;
            --secondary: #00C9A7;
            --correct: #00D26A;
            --wrong: #FF4757;
            --bg-light: #F0F4F8;
        }

        body {
            font-family: 'Nunito', sans-serif;
            background-color: var(--bg-light);
            background-image: radial-gradient(#8854c033 1px, transparent 1px);
            background-size: 20px 20px;
            color: #2D3436;
            min-height: 100vh;
            display: flex;
            flex-direction: column;
            align-items: center;
            padding: 20px;
        }

        .header-small {
            font-size: 0.9rem;
            color: var(--primary);
            font-weight: 700;
            margin-bottom: 5px;
            text-transform: uppercase;
            letter-spacing: 1px;
        }

        .quiz-container {
            width: 100%;
            max-width: 800px;
            background: white;
            border-radius: 30px;
            box-shadow: 0 15px 0px rgba(0, 0, 0, 0.05), 0 20px 25px -5px rgba(0, 0, 0, 0.1);
            padding: 30px;
            position: relative;
            overflow: hidden;
        }

        .progress-bar {
            height: 12px;
            background: #E2E8F0;
            border-radius: 10px;
            margin-bottom: 25px;
            overflow: hidden;
        }

        .progress-fill {
            height: 100%;
            background: linear-gradient(90deg, var(--secondary), var(--primary));
            width: 0%;
            transition: width 0.5s ease;
        }

        .card {
            transition: all 0.3s ease;
        }

        .option-btn {
            background: white;
            border: 2px solid #E2E8F0;
            border-radius: 20px;
            padding: 15px 25px;
            font-size: 1.1rem;
            font-weight: 700;
            text-align: left;
            transition: all 0.2s cubic-bezier(0.175, 0.885, 0.32, 1.275);
            box-shadow: 0 6px 0px #E2E8F0;
            cursor: pointer;
            margin-bottom: 12px;
            display: flex;
            align-items: center;
            width: 100%;
        }

        .option-btn:hover:not(:disabled) {
            transform: translateY(-3px);
            border-color: var(--primary);
            box-shadow: 0 9px 0px #D1D5DB;
            scale: 1.02;
        }

        .option-btn:active:not(:disabled) {
            transform: translateY(2px);
            box-shadow: 0 2px 0px #D1D5DB;
        }

        .option-btn.correct {
            background-color: var(--correct);
            border-color: #00B359;
            color: white;
            box-shadow: 0 6px 0px #008F47;
        }

        .option-btn.wrong {
            background-color: var(--wrong);
            border-color: #E63946;
            color: white;
            box-shadow: 0 6px 0px #CC3340;
        }

        .explanation-box {
            margin-top: 20px;
            padding: 20px;
            border-radius: 20px;
            background-color: #F8FAFC;
            border-left: 6px solid var(--primary);
            display: none;
            animation: slideUp 0.4s ease-out;
        }

        @keyframes slideUp {
            from { opacity: 0; transform: translateY(20px); }
            to { opacity: 1; transform: translateY(0); }
        }

        @keyframes shake {
            0%, 100% { transform: translateX(0); }
            25% { transform: translateX(-10px); }
            75% { transform: translateX(10px); }
        }

        .shake {
            animation: shake 0.3s ease-in-out;
        }

        .glossary-table {
            width: 100%;
            margin-top: 30px;
            border-collapse: collapse;
            border-radius: 15px;
            overflow: hidden;
            box-shadow: 0 4px 6px rgba(0,0,0,0.05);
        }

        .glossary-table th {
            background-color: var(--primary);
            color: white;
            padding: 12px;
            text-align: left;
        }

        .glossary-table td {
            padding: 10px;
            border-bottom: 1px solid #EDF2F7;
            background: white;
        }

        .score-popup {
            position: fixed;
            top: 0; left: 0; width: 100%; height: 100%;
            background: rgba(0,0,0,0.8);
            display: flex;
            justify-content: center;
            align-items: center;
            z-index: 1000;
            display: none;
        }

        .popup-content {
            background: white;
            padding: 40px;
            border-radius: 30px;
            text-align: center;
            max-width: 500px;
            width: 90%;
            box-shadow: 0 20px 50px rgba(0,0,0,0.3);
        }

        .btn-primary {
            background: var(--primary);
            color: white;
            padding: 12px 30px;
            border-radius: 15px;
            font-weight: 800;
            box-shadow: 0 6px 0px #6B4399;
            transition: all 0.2s;
        }

        .btn-primary:active {
            transform: translateY(4px);
            box-shadow: 0 2px 0px #6B4399;
        }

        u { text-decoration: underline; font-weight: bold; color: var(--primary); }
    </style>
</head>
<body>

    <div class="header-small">Gi√°o vi√™n t·∫°o: Ms Mai An ULIS</div>
    <h1 class="text-3xl font-black text-[#2D3436] mb-6 text-center">Grammar Master: <span class="text-[#8854C0]">Wh-Questions & Conjunctions</span></h1>

    <div class="quiz-container" id="quiz-wrapper">
        <!-- Progress -->
        <div class="progress-bar">
            <div class="progress-fill" id="progress-fill"></div>
        </div>

        <!-- Question Card -->
        <div id="question-card" class="card">
            <div class="flex justify-between items-center mb-4">
                <span class="bg-purple-100 text-purple-700 px-4 py-1 rounded-full font-bold" id="q-number">Question 1/20</span>
                <span class="text-sm text-gray-400 font-bold" id="category">Wh-Questions</span>
            </div>
            
            <h2 class="text-2xl font-bold mb-6 leading-relaxed" id="q-text">
                Loading question...
            </h2>

            <div class="grid grid-cols-1 gap-3" id="options-grid">
                <!-- Options will be injected here -->
            </div>

            <!-- Explanation Area -->
            <div class="explanation-box" id="explanation-box">
                <div class="flex items-center gap-2 mb-2">
                    <span class="text-2xl">üë©‚Äçüè´</span>
                    <h3 class="font-black text-purple-800">C√¥ Mai An gi·∫£i th√≠ch:</h3>
                </div>
                <div id="explanation-content" class="text-sm leading-relaxed text-gray-700 space-y-2">
                    <!-- Content -->
                </div>
                <button onclick="nextQuestion()" class="mt-4 w-full btn-primary bg-green-500 shadow-[0_6px_0px_#38a169]">Ti·∫øp t·ª•c th√¥i! üöÄ</button>
            </div>
        </div>

        <!-- Glossary Table (Only shows if it's a reading/hard part) -->
        <div id="glossary-section" class="mt-8">
            <h3 class="font-black text-lg text-gray-800 mb-3 flex items-center gap-2">
                <span>üìö</span> Mini Glossary (T·ª´ v·ª±ng b·ªï tr·ª£)
            </h3>
            <table class="glossary-table">
                <thead>
                    <tr>
                        <th>T·ª´ v·ª±ng</th>
                        <th>Lo·∫°i t·ª´</th>
                        <th>Nghƒ©a ti·∫øng Vi·ªát</th>
                    </tr>
                </thead>
                <tbody>
                    <tr><td>Forecast</td><td>(n)</td><td>D·ª± b√°o</td></tr>
                    <tr><td>Cartoon</td><td>(n)</td><td>Phim ho·∫°t h√¨nh</td></tr>
                    <tr><td>Prefer</td><td>(v)</td><td>Th√≠ch h∆°n</td></tr>
                    <tr><td>Outdoor</td><td>(adv/adj)</td><td>Ngo√†i tr·ªùi</td></tr>
                    <tr><td>Educational</td><td>(adj)</td><td>Mang t√≠nh gi√°o d·ª•c</td></tr>
                    <tr><td>Violent</td><td>(adj)</td><td>B·∫°o l·ª±c</td></tr>
                    <tr><td>Frequency</td><td>(n)</td><td>T·∫ßn su·∫•t</td></tr>
                    <tr><td>Attract</td><td>(v)</td><td>Thu h√∫t</td></tr>
                    <tr><td>Channel</td><td>(n)</td><td>K√™nh truy·ªÅn h√¨nh</td></tr>
                    <tr><td>Busy</td><td>(adj)</td><td>B·∫≠n r·ªôn</td></tr>
                </tbody>
            </table>
        </div>
    </div>

    <!-- Final Score Popup -->
    <div id="score-popup" class="score-popup">
        <div class="popup-content">
            <div class="text-6xl mb-4">üèÜ</div>
            <h2 class="text-3xl font-black mb-2">Tuy·ªát v·ªùi!</h2>
            <p class="text-gray-600 mb-6" id="final-stats">B·∫°n ƒë√£ ho√†n th√†nh b√†i thi v·ªõi 20/20 c√¢u ƒë√∫ng.</p>
            <div class="text-4xl font-black text-purple-600 mb-8" id="feedback-msg">Xu·∫•t s·∫Øc qu√° ƒëi! üåü</div>
            <button onclick="location.reload()" class="btn-primary">L√†m l·∫°i b√†i thi</button>
        </div>
    </div>

    <!-- Audio Effects -->
    <audio id="snd-correct" src="https://assets.mixkit.co/active_storage/sfx/2000/2000-preview.mp3"></audio>
    <audio id="snd-wrong" src="https://assets.mixkit.co/active_storage/sfx/2013/2013-preview.mp3"></audio>

    <script>
        const questions = [
            {
                q: "<u>What</u> is your favorite TV channel? - It's the Disney Channel.",
                options: ["What", "Where", "When", "Who"],
                correct: 0,
                explanation: {
                    translation: "K√™nh truy·ªÅn h√¨nh y√™u th√≠ch c·ªßa b·∫°n l√† g√¨? - ƒê√≥ l√† k√™nh Disney.",
                    analysis: [
                        "What (G√¨/C√°i g√¨): D√πng ƒë·ªÉ h·ªèi v·ªÅ s·ª± v·∫≠t, s·ª± vi·ªác.",
                        "Where (·ªû ƒë√¢u): D√πng ƒë·ªÉ h·ªèi v·ªÅ ƒë·ªãa ƒëi·ªÉm.",
                        "When (Khi n√†o): D√πng ƒë·ªÉ h·ªèi v·ªÅ th·ªùi gian.",
                        "Who (Ai): D√πng ƒë·ªÉ h·ªèi v·ªÅ ng∆∞·ªùi."
                    ],
                    whyCorrect: "C√¢u tr·∫£ l·ªùi l√† 'Disney Channel' (m·ªôt k√™nh truy·ªÅn h√¨nh - s·ª± v·∫≠t), n√™n ta ch·ªçn 'What'.",
                    whyWrong: "C√°c t·ª´ Where, When, Who kh√¥ng d√πng ƒë·ªÉ h·ªèi v·ªÅ danh t·ª´ ch·ªâ s·ª± v·∫≠t nh∆∞ 'channel'."
                }
            },
            {
                q: "______ do you usually watch cartoons? - In the morning.",
                options: ["Where", "When", "Who", "Why"],
                correct: 1,
                explanation: {
                    translation: "B·∫°n th∆∞·ªùng xem phim ho·∫°t h√¨nh khi n√†o? - V√†o bu·ªïi s√°ng.",
                    analysis: [
                        "Where: ·ªû ƒë√¢u",
                        "When: Khi n√†o",
                        "Who: Ai",
                        "Why: T·∫°i sao"
                    ],
                    whyCorrect: "C√¢u tr·∫£ l·ªùi 'In the morning' (v√†o bu·ªïi s√°ng) l√† tr·∫°ng ng·ªØ ch·ªâ th·ªùi gian, n√™n d√πng 'When'.",
                    whyWrong: "Where, Who, Why kh√¥ng ph√π h·ª£p ƒë·ªÉ tr·∫£ l·ªùi v·ªÅ m·ªëc th·ªùi gian."
                }
            },
            {
                q: "______ does the weather forecast start? - At 7:30 PM.",
                options: ["How much", "How many", "What time", "How far"],
                correct: 2,
                explanation: {
                    translation: "D·ª± b√°o th·ªùi ti·∫øt b·∫Øt ƒë·∫ßu l√∫c m·∫•y gi·ªù? - L√∫c 7:30 t·ªëi.",
                    analysis: [
                        "How much: Bao nhi√™u (kh√¥ng ƒë·∫øm ƒë∆∞·ª£c/gi√° ti·ªÅn)",
                        "How many: Bao nhi√™u (ƒë·∫øm ƒë∆∞·ª£c s·ªë l∆∞·ª£ng)",
                        "What time: M·∫•y gi·ªù (h·ªèi gi·ªù c·ª• th·ªÉ)",
                        "How far: Bao xa"
                    ],
                    whyCorrect: "C√¢u tr·∫£ l·ªùi 'At 7:30 PM' l√† gi·ªù gi·∫•c c·ª• th·ªÉ n√™n d√πng 'What time'.",
                    whyWrong: "C√°c ƒë√°p √°n kh√°c d√πng ƒë·ªÉ h·ªèi s·ªë l∆∞·ª£ng ho·∫∑c kho·∫£ng c√°ch."
                }
            },
            {
                q: "______ watches football with you on weekends? - My dad.",
                options: ["Who", "When", "Where", "What"],
                correct: 0,
                explanation: {
                    translation: "Ai xem b√≥ng ƒë√° v·ªõi b·∫°n v√†o cu·ªëi tu·∫ßn? - B·ªë t√¥i.",
                    analysis: ["Who: Ai", "When: Khi n√†o", "Where: ·ªû ƒë√¢u", "What: C√°i g√¨"],
                    whyCorrect: "C√¢u tr·∫£ l·ªùi 'My dad' l√† ch·ªâ ng∆∞·ªùi, ƒë√≥ng vai tr√≤ ch·ªß ng·ªØ th·ª±c hi·ªán h√†nh ƒë·ªông 'watches'.",
                    whyWrong: "When, Where, What kh√¥ng d√πng ƒë·ªÉ h·ªèi cho ch·ªß ng·ªØ ch·ªâ ng∆∞·ªùi."
                }
            },
            {
                q: "______ TV is this? - It's my brother's.",
                options: ["Who", "Whose", "Which", "What"],
                correct: 1,
                explanation: {
                    translation: "Chi·∫øc TV n√†y l√† c·ªßa ai? - N√≥ l√† c·ªßa anh trai t√¥i.",
                    analysis: ["Who: Ai", "Whose: C·ªßa ai (h·ªèi s·ªü h·ªØu)", "Which: C√°i n√†o", "What: C√°i g√¨"],
                    whyCorrect: "C√¢u tr·∫£ l·ªùi c√≥ d·∫°ng s·ªü h·ªØu c√°ch 'my brother's', v√¨ v·∫≠y c√¢u h·ªèi ph·∫£i b·∫Øt ƒë·∫ßu b·∫±ng 'Whose'.",
                    whyWrong: "Who kh√¥ng ƒëi tr·ª±c ti·∫øp v·ªõi danh t·ª´ 'TV' ƒë·ªÉ h·ªèi v·ªÅ s·ªü h·ªØu."
                }
            },
            {
                q: "______ program do you prefer, the news or cartoons? - Cartoons.",
                options: ["Where", "When", "Which", "Who"],
                correct: 2,
                explanation: {
                    translation: "B·∫°n th√≠ch ch∆∞∆°ng tr√¨nh n√†o h∆°n, tin t·ª©c hay ho·∫°t h√¨nh? - Ho·∫°t h√¨nh.",
                    analysis: ["Where: ·ªû ƒë√¢u", "When: Khi n√†o", "Which: C√°i n√†o (l·ª±a ch·ªçn)", "Who: Ai"],
                    whyCorrect: "Khi c√≥ s·ª± l·ª±a ch·ªçn gi·ªØa 2 ƒë·ªëi t∆∞·ª£ng x√°c ƒë·ªãnh (the news or cartoons), ta d√πng 'Which'.",
                    whyWrong: "What/Where/When kh√¥ng d√πng ƒë·ªÉ ƒë∆∞a ra s·ª± l·ª±a ch·ªçn gi·ªõi h·∫°n nh∆∞ Which."
                }
            },
            {
                q: "______ don't you like watching TV outdoors? - Because it's too bright.",
                options: ["Why", "When", "Where", "Who"],
                correct: 0,
                explanation: {
                    translation: "T·∫°i sao b·∫°n kh√¥ng th√≠ch xem TV ngo√†i tr·ªùi? - B·ªüi v√¨ tr·ªùi qu√° s√°ng.",
                    analysis: ["Why: T·∫°i sao", "When: Khi n√†o", "Where: ·ªû ƒë√¢u", "Who: Ai"],
                    whyCorrect: "C√¢u tr·∫£ l·ªùi b·∫Øt ƒë·∫ßu b·∫±ng 'Because' (B·ªüi v√¨), ƒë√¢y l√† d·∫•u hi·ªáu ƒë·∫∑c tr∆∞ng c·ªßa c√¢u h·ªèi 'Why'.",
                    whyWrong: "C√°c t·ª´ kh√°c kh√¥ng d√πng ƒë·ªÉ h·ªèi l√Ω do."
                }
            },
            {
                q: "______ do you get to the TV station? - By bus.",
                options: ["What", "How", "When", "Where"],
                correct: 1,
                explanation: {
                    translation: "B·∫°n ƒë·∫øn ƒë√†i truy·ªÅn h√¨nh b·∫±ng c√°ch n√†o? - B·∫±ng xe bu√Ωt.",
                    analysis: ["What: C√°i g√¨", "How: B·∫±ng c√°ch n√†o", "When: Khi n√†o", "Where: ·ªû ƒë√¢u"],
                    whyCorrect: "C√¢u tr·∫£ l·ªùi 'By bus' ch·ªâ ph∆∞∆°ng ti·ªán/c√°ch th·ª©c di chuy·ªÉn, n√™n d√πng 'How'.",
                    whyWrong: "What/When/Where kh√¥ng d√πng ƒë·ªÉ h·ªèi v·ªÅ ph∆∞∆°ng ti·ªán ƒëi l·∫°i."
                }
            },
            {
                q: "______ does this cartoon last? - It's 30 minutes.",
                options: ["How far", "How much", "How long", "How many"],
                correct: 2,
                explanation: {
                    translation: "B·ªô phim ho·∫°t h√¨nh n√†y k√©o d√†i bao l√¢u? - N√≥ d√†i 30 ph√∫t.",
                    analysis: ["How far: Bao xa", "How much: Bao nhi√™u", "How long: Bao l√¢u (th·ªùi gian)", "How many: Bao nhi√™u"],
                    whyCorrect: "H·ªèi v·ªÅ kho·∫£ng th·ªùi gian (duration) ta s·ª≠ d·ª•ng c·ª•m t·ª´ 'How long'.",
                    whyWrong: "C√°c c·ª•m kh√°c h·ªèi v·ªÅ kho·∫£ng c√°ch ho·∫∑c s·ªë l∆∞·ª£ng."
                }
            },
            {
                q: "______ do you watch your favorite program? - Every weekend.",
                options: ["How often", "How old", "How many", "How much"],
                correct: 0,
                explanation: {
                    translation: "B·∫°n c√≥ th∆∞·ªùng xem ch∆∞∆°ng tr√¨nh y√™u th√≠ch kh√¥ng? - M·ªói cu·ªëi tu·∫ßn.",
                    analysis: ["How often: Th∆∞·ªùng xuy√™n th·∫ø n√†o", "How old: Bao nhi√™u tu·ªïi", "How many: Bao nhi√™u", "How much: Bao nhi√™u"],
                    whyCorrect: "C√¢u tr·∫£ l·ªùi 'Every weekend' ch·ªâ t·∫ßn su·∫•t th·ª±c hi·ªán h√†nh ƒë·ªông, n√™n d√πng 'How often'.",
                    whyWrong: "C√°c ƒë√°p √°n c√≤n l·∫°i sai ho√†n to√†n v·ªÅ nghƒ©a."
                }
            },
            {
                q: "I love watching cartoons ______ my sister prefers sports programs.",
                options: ["and", "but", "or", "so"],
                correct: 1,
                explanation: {
                    translation: "T√¥i th√≠ch xem ho·∫°t h√¨nh nh∆∞ng ch·ªã t√¥i l·∫°i th√≠ch ch∆∞∆°ng tr√¨nh th·ªÉ thao.",
                    analysis: ["and: v√† (b·ªï sung)", "but: nh∆∞ng (t∆∞∆°ng ph·∫£n)", "or: ho·∫∑c (l·ª±a ch·ªçn)", "so: v√¨ v·∫≠y (k·∫øt qu·∫£)"],
                    whyCorrect: "Hai v·∫ø c√¢u c√≥ s·ª± tr√°i ng∆∞·ª£c v·ªÅ s·ªü th√≠ch (t√¥i th√≠ch A - ch·ªã th√≠ch B) n√™n d√πng 'but'.",
                    whyWrong: "And/So/Or kh√¥ng d√πng ƒë·ªÉ n·ªëi hai v·∫ø mang nghƒ©a ƒë·ªëi l·∫≠p."
                }
            },
            {
                q: "We can watch TV today ______ go outdoors to play football.",
                options: ["because", "however", "or", "so"],
                correct: 2,
                explanation: {
                    translation: "H√¥m nay ch√∫ng ta c√≥ th·ªÉ xem TV ho·∫∑c ra ngo√†i ch∆°i b√≥ng ƒë√°.",
                    analysis: ["because: b·ªüi v√¨", "however: tuy nhi√™n", "or: ho·∫∑c", "so: v√¨ v·∫≠y"],
                    whyCorrect: "ƒê√¢y l√† hai l·ª±a ch·ªçn h√†nh ƒë·ªông kh√°c nhau cho ng∆∞·ªùi nghe, n√™n d√πng li√™n t·ª´ 'or'.",
                    whyWrong: "Because/So ch·ªâ nguy√™n nh√¢n k·∫øt qu·∫£, kh√¥ng h·ª£p nghƒ©a."
                }
            },
            {
                q: "The weather forecast is boring, ______ I still watch it every evening.",
                options: ["because", "so", "or", "but"],
                correct: 3,
                explanation: {
                    translation: "D·ª± b√°o th·ªùi ti·∫øt th√¨ nh√†m ch√°n, nh∆∞ng t√¥i v·∫´n xem n√≥ m·ªói t·ªëi.",
                    analysis: ["because: b·ªüi v√¨", "so: v√¨ v·∫≠y", "or: ho·∫∑c", "but: nh∆∞ng"],
                    whyCorrect: "Hai v·∫ø c√≥ s·ª± m√¢u thu·∫´n (Ch√°n >< V·∫´n xem). D√πng 'but' ƒë·ªÉ n·ªëi.",
                    whyWrong: "Kh√¥ng th·ªÉ d√πng 'so' (v√¨ v·∫≠y) v√¨ 'nh√†m ch√°n' kh√¥ng ph·∫£i nguy√™n nh√¢n d·∫´n ƒë·∫øn vi·ªác 'v·∫´n xem'."
                }
            },
            {
                q: "I feel tired ______ I watched TV for three hours.",
                options: ["because", "but", "and", "or"],
                correct: 0,
                explanation: {
                    translation: "T√¥i c·∫£m th·∫•y m·ªát b·ªüi v√¨ t√¥i ƒë√£ xem TV su·ªët ba ti·∫øng ƒë·ªìng h·ªì.",
                    analysis: ["because: b·ªüi v√¨", "but: nh∆∞ng", "and: v√†", "or: ho·∫∑c"],
                    whyCorrect: "V·∫ø 'watched TV for three hours' l√† nguy√™n nh√¢n d·∫´n ƒë·∫øn k·∫øt qu·∫£ 'feel tired'.",
                    whyWrong: "C√°c li√™n t·ª´ kh√°c kh√¥ng ch·ªâ nguy√™n nh√¢n."
                }
            },
            {
                q: "My pet rabbit is cute ______ it attracts many children on TV shows.",
                options: ["but", "so", "or", "because"],
                correct: 1,
                explanation: {
                    translation: "Con th·ªè c∆∞ng c·ªßa t√¥i r·∫•t d·ªÖ th∆∞∆°ng v√¨ v·∫≠y n√≥ thu h√∫t nhi·ªÅu tr·∫ª em.",
                    analysis: ["but: nh∆∞ng", "so: v√¨ v·∫≠y", "or: ho·∫∑c", "because: b·ªüi v√¨"],
                    whyCorrect: "V·∫ø tr∆∞·ªõc l√† nguy√™n nh√¢n (cute) d·∫´n ƒë·∫øn v·∫ø sau l√† k·∫øt qu·∫£ (thu h√∫t tr·∫ª em) -> D√πng 'so'.",
                    whyWrong: "N·∫øu d√πng 'because', v·∫ø sau ph·∫£i l√† nguy√™n nh√¢n cho v·∫ø tr∆∞·ªõc (Sai logic)."
                }
            },
            {
                q: "I'm busy with homework, ______ I can't watch my favorite channel tonight.",
                options: ["but", "or", "so", "because"],
                correct: 2,
                explanation: {
                    translation: "T√¥i b·∫≠n l√†m b√†i t·∫≠p, v√¨ v·∫≠y t·ªëi nay t√¥i kh√¥ng th·ªÉ xem k√™nh y√™u th√≠ch.",
                    analysis: ["but: nh∆∞ng", "or: ho·∫∑c", "so: v√¨ v·∫≠y", "because: b·ªüi v√¨"],
                    whyCorrect: "D√πng 'so' ƒë·ªÉ ch·ªâ k·∫øt qu·∫£ c·ªßa vi·ªác b·∫≠n h·ªçc l√† kh√¥ng xem ƒë∆∞·ª£c TV.",
                    whyWrong: "But/Or kh√¥ng h·ª£p ng·ªØ nghƒ©a logic."
                }
            },
            {
                q: "Children enjoy cartoons ______ they learn many things from educational programs.",
                options: ["and", "but", "so", "because"],
                correct: 0,
                explanation: {
                    translation: "Tr·∫ª em th√≠ch ho·∫°t h√¨nh v√† ch√∫ng h·ªçc ƒë∆∞·ª£c nhi·ªÅu ƒëi·ªÅu t·ª´ c√°c ch∆∞∆°ng tr√¨nh gi√°o d·ª•c.",
                    analysis: ["and: v√†", "but: nh∆∞ng", "so: v√¨ v·∫≠y", "because: b·ªüi v√¨"],
                    whyCorrect: "ƒê√¢y l√† hai th√¥ng tin b·ªï sung cho nhau v·ªÅ th√≥i quen c·ªßa tr·∫ª em, d√πng 'and' l√† h·ª£p nh·∫•t.",
                    whyWrong: "C√°c li√™n t·ª´ kh√°c khi·∫øn c√¢u mang nghƒ©a nguy√™n nh√¢n-k·∫øt qu·∫£ khi√™n c∆∞·ª°ng."
                }
            },
            {
                q: "Tomorrow is the weekend, ______ we will watch movies together.",
                options: ["but", "or", "because", "so"],
                correct: 3,
                explanation: {
                    translation: "Ng√†y mai l√† cu·ªëi tu·∫ßn, v√¨ v·∫≠y ch√∫ng t√¥i s·∫Ω xem phim c√πng nhau.",
                    analysis: ["but: nh∆∞ng", "or: ho·∫∑c", "because: b·ªüi v√¨", "so: v√¨ v·∫≠y"],
                    whyCorrect: "V·∫ø sau l√† k·∫ø ho·∫°ch n·∫£y sinh t·ª´ v·∫ø ƒë·∫ßu (k·∫øt qu·∫£), d√πng 'so'.",
                    whyWrong: "Sai logic ng·ªØ nghƒ©a n·∫øu ch·ªçn c√°c t·ª´ c√≤n l·∫°i."
                }
            },
            {
                q: "I want to follow this program. ______, I don't have enough time.",
                options: ["Because", "However", "And", "Or"],
                correct: 1,
                explanation: {
                    translation: "T√¥i mu·ªën theo d√µi ch∆∞∆°ng tr√¨nh n√†y. Tuy nhi√™n, t√¥i kh√¥ng c√≥ ƒë·ªß th·ªùi gian.",
                    analysis: ["Because: B·ªüi v√¨", "However: Tuy nhi√™n", "And: V√†", "Or: Ho·∫∑c"],
                    whyCorrect: "C√¢u th·ª© hai b·∫Øt ƒë·∫ßu b·∫±ng m·ªôt tr·∫°ng t·ª´ ch·ªâ s·ª± t∆∞∆°ng ph·∫£n v√† ngƒÉn c√°ch b·ªüi d·∫•u ph·∫©y, n√™n d√πng 'However'.",
                    whyWrong: "And/Or/Because kh√¥ng ƒë·ª©ng ƒë·ªôc l·∫≠p ƒë·∫ßu c√¢u ngƒÉn c√°ch d·∫•u ph·∫©y nh∆∞ However trong tr∆∞·ªùng h·ª£p n√†y."
                }
            },
            {
                q: "You can watch animal shows ______ you don't like violent programs.",
                options: ["so", "and", "because", "but"],
                correct: 2,
                explanation: {
                    translation: "B·∫°n c√≥ th·ªÉ xem c√°c ch∆∞∆°ng tr√¨nh ƒë·ªông v·∫≠t b·ªüi v√¨ b·∫°n kh√¥ng th√≠ch c√°c ch∆∞∆°ng tr√¨nh b·∫°o l·ª±c.",
                    analysis: ["so: v√¨ v·∫≠y", "and: v√†", "because: b·ªüi v√¨", "but: nh∆∞ng"],
                    whyCorrect: "V·∫ø sau gi·∫£i th√≠ch l√Ω do t·∫°i sao l·∫°i c√≥ th·ªÉ xem animal shows.",
                    whyWrong: "Sai logic n·∫øu ch·ªçn c√°c li√™n t·ª´ kh√°c."
                }
            }
        ];

        let currentQ = 0;
        let score = 0;

        const qText = document.getElementById('q-text');
        const optionsGrid = document.getElementById('options-grid');
        const explanationBox = document.getElementById('explanation-box');
        const explanationContent = document.getElementById('explanation-content');
        const progressFill = document.getElementById('progress-fill');
        const qNumberDisplay = document.getElementById('q-number');
        const categoryDisplay = document.getElementById('category');

        function loadQuestion() {
            const data = questions[currentQ];
            qText.innerHTML = data.q;
            qNumberDisplay.innerText = `Question ${currentQ + 1}/${questions.length}`;
            categoryDisplay.innerText = currentQ < 10 ? "Wh-Questions" : "Conjunctions";
            
            optionsGrid.innerHTML = '';
            data.options.forEach((opt, index) => {
                const btn = document.createElement('button');
                btn.className = 'option-btn';
                btn.innerHTML = `<span class="bg-gray-100 w-8 h-8 rounded-full inline-flex items-center justify-center mr-3 text-sm">${String.fromCharCode(65 + index)}</span> ${opt}`;
                btn.onclick = () => checkAnswer(index);
                optionsGrid.appendChild(btn);
            });

            explanationBox.style.display = 'none';
            progressFill.style.width = `${(currentQ / questions.length) * 100}%`;
        }

        function checkAnswer(selectedIndex) {
            const data = questions[currentQ];
            const btns = optionsGrid.getElementsByTagName('button');
            const isCorrect = selectedIndex === data.correct;

            // Disable all buttons
            for (let btn of btns) btn.disabled = true;

            if (isCorrect) {
                score++;
                btns[selectedIndex].classList.add('correct');
                playSnd('snd-correct');
                confetti({
                    particleCount: 100,
                    spread: 70,
                    origin: { y: 0.6 },
                    colors: ['#8854C0', '#00C9A7', '#00D26A']
                });
            } else {
                btns[selectedIndex].classList.add('wrong');
                btns[data.correct].classList.add('correct');
                document.getElementById('quiz-wrapper').classList.add('shake');
                setTimeout(() => document.getElementById('quiz-wrapper').classList.remove('shake'), 500);
                playSnd('snd-wrong');
            }

            showExplanation(data.explanation);
        }

        function showExplanation(exp) {
            explanationContent.innerHTML = `
                <p><strong>üìç D·ªãch c√¢u:</strong> "${exp.translation}"</p>
                <div class="bg-white p-3 rounded-xl border border-gray-100 my-2">
                    <p class="font-bold mb-1">üîç Ph√¢n t√≠ch ƒë√°p √°n:</p>
                    <ul class="list-disc ml-5 space-y-1">
                        ${exp.analysis.map(item => `<li>${item}</li>`).join('')}
                    </ul>
                </div>
                <p class="text-green-600"><strong>‚úÖ T·∫°i sao ƒë√∫ng?</strong> ${exp.whyCorrect}</p>
                <p class="text-red-500"><strong>‚ùå T·∫°i sao sai?</strong> ${exp.whyWrong}</p>
            `;
            explanationBox.style.display = 'block';
        }

        function nextQuestion() {
            currentQ++;
            if (currentQ < questions.length) {
                loadQuestion();
            } else {
                showFinalScore();
            }
        }

        function showFinalScore() {
            const popup = document.getElementById('score-popup');
            const stats = document.getElementById('final-stats');
            const feedback = document.getElementById('feedback-msg');
            
            stats.innerText = `B·∫°n ƒë√£ ho√†n th√†nh b√†i thi v·ªõi ${score}/${questions.length} c√¢u ƒë√∫ng.`;
            
            if (score === questions.length) feedback.innerText = "Xu·∫•t s·∫Øc qu√° ƒëi! üåü";
            else if (score >= 15) feedback.innerText = "Gi·ªèi l·∫Øm, c·ªë l√™n nh√©! üëç";
            else feedback.innerText = "C·∫ßn c·ªë g·∫Øng h∆°n n·ªØa nha! üí™";

            popup.style.display = 'flex';
            progressFill.style.width = '100%';
        }

        function playSnd(id) {
            const audio = document.getElementById(id);
            audio.currentTime = 0;
            audio.play().catch(e => console.log("Audio play blocked"));
        }

        // Init
        window.onload = loadQuestion;
    </script>
</body>
</html>
