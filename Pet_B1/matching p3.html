<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Reading Test - Ms Mai An ULIS</title>
    <link href="https://fonts.googleapis.com/css2?family=Nunito:wght@400;600;700;800&family=Quicksand:wght@500;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <script src="https://cdn.jsdelivr.net/npm/canvas-confetti@1.6.0/dist/confetti.browser.min.js"></script>

    <style>
        :root {
            --primary-purple: #8854C0;
            --primary-mint: #00C9A7;
            --correct-green: #00D26A;
            --wrong-red: #FF4757;
            --bg-pastel: #fdf2f8; /* Pink pastel tint */
            --card-shadow: 0 8px 0 rgba(0,0,0,0.15);
            --btn-shadow: 0 5px 0;
        }

        body {
            font-family: 'Nunito', sans-serif;
            background-color: var(--bg-pastel);
            /* Watercolor texture effect via CSS gradient */
            background-image: 
                radial-gradient(circle at 10% 20%, rgba(255, 183, 178, 0.4) 0%, transparent 20%),
                radial-gradient(circle at 90% 80%, rgba(199, 236, 238, 0.6) 0%, transparent 25%),
                radial-gradient(circle at 50% 50%, rgba(223, 249, 251, 0.3) 0%, transparent 50%);
            margin: 0;
            padding: 0;
            height: 100vh;
            overflow: hidden;
            color: #4b4b4b;
        }

        /* --- Header --- */
        header {
            background: white;
            height: 60px;
            display: flex;
            align-items: center;
            justify-content: space-between;
            padding: 0 20px;
            box-shadow: 0 4px 10px rgba(0,0,0,0.05);
            z-index: 100;
            position: relative;
        }

        .teacher-name {
            font-family: 'Quicksand', sans-serif;
            font-weight: 700;
            color: var(--primary-purple);
            font-size: 0.9rem;
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .timer-container {
            background: var(--primary-purple);
            color: white;
            padding: 8px 20px;
            border-radius: 30px;
            font-weight: 800;
            font-size: 1.2rem;
            display: flex;
            align-items: center;
            gap: 10px;
            cursor: pointer;
            box-shadow: 0 4px 0 #6c429c;
            transition: transform 0.1s;
        }

        .timer-container:active {
            transform: translateY(4px);
            box-shadow: none;
        }

        /* --- Main Layout --- */
        .main-container {
            display: flex;
            height: calc(100vh - 60px);
        }

        .split-pane {
            flex: 1;
            padding: 20px;
            overflow-y: auto;
            scroll-behavior: smooth;
        }

        /* Custom Scrollbar */
        .split-pane::-webkit-scrollbar {
            width: 10px;
        }
        .split-pane::-webkit-scrollbar-track {
            background: #f1f1f1; 
        }
        .split-pane::-webkit-scrollbar-thumb {
            background: var(--primary-mint); 
            border-radius: 10px;
        }

        /* --- Left Side: Reading --- */
        .reading-section {
            background: rgba(255, 255, 255, 0.8);
            border-radius: 20px;
            padding: 25px;
            border: 2px solid white;
            box-shadow: 0 10px 25px rgba(136, 84, 192, 0.1);
        }

        .passage-title {
            color: var(--primary-purple);
            font-family: 'Quicksand', sans-serif;
            font-size: 1.8rem;
            margin-bottom: 5px;
            text-align: center;
        }
        
        .passage-subtitle {
            text-align: center;
            color: #777;
            margin-bottom: 20px;
            font-style: italic;
        }

        .shop-card {
            background: white;
            border-radius: 15px;
            padding: 15px;
            margin-bottom: 20px;
            border-left: 5px solid var(--primary-mint);
            box-shadow: 0 2px 5px rgba(0,0,0,0.05);
        }

        .shop-title {
            font-weight: 800;
            color: var(--primary-mint);
            font-size: 1.2rem;
            margin-bottom: 5px;
        }

        .translate-btn {
            background: #ffeaa7;
            color: #d35400;
            border: none;
            padding: 5px 10px;
            border-radius: 8px;
            font-size: 0.8rem;
            font-weight: 700;
            cursor: pointer;
            margin-top: 10px;
            transition: all 0.2s;
        }

        .translate-btn:hover {
            transform: scale(1.05);
        }

        .translation-text {
            margin-top: 10px;
            padding: 10px;
            background: #fff8e1;
            border-radius: 8px;
            color: #555;
            font-size: 0.95rem;
            display: none; /* Hidden by default */
            border-left: 3px solid #ffca28;
        }

        .translation-text.show {
            display: block;
            animation: fadeIn 0.5s;
        }

        /* Glossary */
        .glossary-box {
            margin-top: 30px;
            background: #fff;
            border-radius: 15px;
            padding: 15px;
            border: 2px dashed var(--primary-purple);
        }
        .glossary-table {
            width: 100%;
            border-collapse: collapse;
            margin-top: 10px;
        }
        .glossary-table th, .glossary-table td {
            padding: 8px;
            text-align: left;
            border-bottom: 1px solid #eee;
        }
        .glossary-table th {
            color: var(--primary-purple);
        }
        .word-type {
            font-size: 0.8em;
            color: #888;
            font-style: italic;
        }

        /* --- Right Side: Exercises --- */
        .exercise-card {
            background: white;
            border-radius: 20px;
            padding: 25px;
            margin-bottom: 30px;
            box-shadow: var(--card-shadow);
            border: 2px solid #eee;
            position: relative;
        }

        .question-header {
            font-weight: 700;
            color: #555;
            margin-bottom: 15px;
            display: flex;
            align-items: flex-start;
            gap: 10px;
        }

        .q-number {
            background: var(--primary-purple);
            color: white;
            width: 30px;
            height: 30px;
            display: flex;
            align-items: center;
            justify-content: center;
            border-radius: 50%;
            flex-shrink: 0;
        }

        /* Options Grid for A-H */
        .options-grid {
            display: grid;
            grid-template-columns: repeat(4, 1fr);
            gap: 10px;
            margin-bottom: 15px;
        }

        .option-btn {
            background: white;
            border: 2px solid #e0e0e0;
            border-radius: 12px;
            padding: 10px;
            font-weight: 800;
            font-size: 1.1rem;
            color: #555;
            cursor: pointer;
            transition: all 0.2s;
            box-shadow: 0 4px 0 #ccc;
            position: relative;
        }

        .option-btn:hover {
            transform: scale(1.1);
            border-color: var(--primary-purple);
        }

        .option-btn:active {
            transform: translateY(4px);
            box-shadow: none;
        }

        /* States */
        .option-btn.correct {
            background-color: var(--correct-green);
            color: white;
            border-color: var(--correct-green);
            box-shadow: 0 4px 0 #00a653;
        }

        .option-btn.wrong {
            background-color: var(--wrong-red);
            color: white;
            border-color: var(--wrong-red);
            box-shadow: 0 4px 0 #d63031;
            animation: shake 0.5s;
        }
        
        /* Highlight correct answer when user is wrong */
        .option-btn.show-correct {
            background-color: var(--correct-green) !important;
            color: white !important;
            border-color: var(--correct-green) !important;
            box-shadow: 0 4px 0 #00a653 !important;
            opacity: 1 !important;
        }

        .disabled-grid {
            pointer-events: none;
            opacity: 0.8;
        }

        /* --- Feedback Section --- */
        .feedback-panel {
            margin-top: 15px;
            padding-top: 15px;
            border-top: 2px dashed #eee;
            display: none; /* Hidden initially */
        }

        .feedback-controls {
            display: flex;
            gap: 10px;
            margin-bottom: 10px;
            flex-wrap: wrap;
        }

        .fb-btn {
            flex: 1;
            padding: 8px;
            border: none;
            border-radius: 10px;
            font-weight: 700;
            cursor: pointer;
            font-size: 0.9rem;
            color: white;
            box-shadow: 0 3px 0 rgba(0,0,0,0.2);
            transition: transform 0.1s;
        }
        .fb-btn:active { transform: translateY(3px); box-shadow: none; }
        
        .btn-explain { background: #3498db; }
        .btn-trans { background: #e67e22; }
        .btn-vocab { background: #9b59b6; }

        .feedback-content {
            background: #f8f9fa;
            padding: 15px;
            border-radius: 10px;
            font-size: 0.95rem;
            line-height: 1.5;
            display: none;
            animation: fadeIn 0.3s;
        }

        .feedback-content strong { color: var(--primary-purple); }

        /* --- Submit Button --- */
        .submit-container {
            text-align: center;
            margin-top: 20px;
            margin-bottom: 50px;
        }

        .submit-btn {
            background: var(--primary-mint);
            color: white;
            border: none;
            padding: 15px 40px;
            font-size: 1.5rem;
            font-weight: 800;
            border-radius: 50px;
            cursor: pointer;
            box-shadow: 0 6px 0 #009e82;
            transition: all 0.2s;
            font-family: 'Quicksand', sans-serif;
        }

        .submit-btn:hover {
            transform: scale(1.05);
        }
        .submit-btn:active {
            transform: translateY(6px);
            box-shadow: none;
        }

        /* --- Modal --- */
        .modal-overlay {
            position: fixed;
            top: 0; left: 0;
            width: 100%; height: 100%;
            background: rgba(0,0,0,0.5);
            display: none;
            justify-content: center;
            align-items: center;
            z-index: 1000;
            backdrop-filter: blur(5px);
        }

        .modal-content {
            background: white;
            padding: 40px;
            border-radius: 30px;
            text-align: center;
            max-width: 500px;
            width: 90%;
            position: relative;
            box-shadow: 0 20px 50px rgba(0,0,0,0.2);
            animation: popIn 0.5s cubic-bezier(0.68, -0.55, 0.265, 1.55);
        }

        .score-display {
            font-size: 4rem;
            font-weight: 800;
            color: var(--primary-purple);
            margin: 20px 0;
        }

        .modal-msg {
            font-size: 1.2rem;
            color: #555;
            margin-bottom: 20px;
        }

        /* Animations */
        @keyframes shake {
            0% { transform: translateX(0); }
            25% { transform: translateX(-5px) rotate(-5deg); }
            50% { transform: translateX(5px) rotate(5deg); }
            75% { transform: translateX(-5px) rotate(-5deg); }
            100% { transform: translateX(0); }
        }

        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(-5px); }
            to { opacity: 1; transform: translateY(0); }
        }

        @keyframes popIn {
            0% { transform: scale(0); opacity: 0; }
            100% { transform: scale(1); opacity: 1; }
        }

        /* Responsive */
        @media (max-width: 768px) {
            .main-container { flex-direction: column; height: auto; }
            .split-pane { height: auto; overflow: visible; }
            header { position: sticky; top: 0; }
        }

    </style>
</head>
<body>

    <audio id="sound-correct" src="https://assets.mixkit.co/active_storage/sfx/2000/2000-preview.mp3"></audio>
    <audio id="sound-wrong" src="https://assets.mixkit.co/active_storage/sfx/2003/2003-preview.mp3"></audio>
    <audio id="sound-finish" src="https://assets.mixkit.co/active_storage/sfx/2013/2013-preview.mp3"></audio>

    <header>
        <div class="teacher-name">
            <i class="fas fa-graduation-cap fa-lg"></i>
            <span>Giáo viên tạo: Ms Mai An ULIS</span>
        </div>
        <div class="timer-container" onclick="toggleTimer()">
            <i class="fas fa-clock"></i>
            <span id="timer-display">10:00</span>
            <span id="timer-status" style="font-size:0.6em; margin-left:5px;">(PAUSED)</span>
        </div>
    </header>

    <div class="main-container">
        
        <div class="split-pane">
            <div class="reading-section">
                <h1 class="passage-title">Popular Local Shops</h1>
                <p class="passage-subtitle">B1 English Reading Test - Matching</p>
                <div style="background:#eef; padding:10px; border-radius:10px; margin-bottom:20px; font-size:0.9rem;">
                    <strong><i class="fas fa-info-circle"></i> Nhiệm vụ:</strong> Đọc 8 đoạn mô tả cửa hàng (A-H) và chọn cửa hàng phù hợp nhất cho từng người (1-5) bên phải.
                </div>

                <div id="shops-container">
                    <div class="shop-card">
                        <div class="shop-title">A. Wedges</div>
                        <p>Take a break while you’re shopping and try our delicious home-cooked hot meals. Popular with students, everything is reasonably priced. While you’re here have a look at some of the second-hand clothes we have available.</p>
                        <button class="translate-btn" onclick="toggleTrans(this)">BẢN DỊCH ĐẦY ĐỦ</button>
                        <div class="translation-text">
                            Hãy nghỉ ngơi trong khi mua sắm và thử những bữa ăn nóng sốt tự nấu ngon tuyệt của chúng tôi. Phổ biến với sinh viên, mọi thứ đều có giá cả phải chăng. Trong khi ở đây, hãy ngó qua một số quần áo cũ (second-hand) mà chúng tôi có sẵn.
                        </div>
                    </div>

                    <div class="shop-card">
                        <div class="shop-title">B. New Street Corner Shop</div>
                        <p>Get something to remind you of your visit here and look around at our wide range of souvenirs. We have lots of toys, sweets, locally made chocolates and attractive postcards and posters. Looking for something to read? Pick up a newspaper, a magazine or the latest novel for the journey home.</p>
                        <button class="translate-btn" onclick="toggleTrans(this)">BẢN DỊCH ĐẦY ĐỦ</button>
                        <div class="translation-text">
                            Hãy mua thứ gì đó để gợi nhớ về chuyến thăm của bạn tại đây và ngắm nhìn vô số quà lưu niệm của chúng tôi. Chúng tôi có rất nhiều đồ chơi, kẹo, sô cô la sản xuất tại địa phương cùng bưu thiếp và áp phích bắt mắt. Bạn đang tìm thứ gì đó để đọc? Hãy chọn một tờ báo, một cuốn tạp chí hoặc cuốn tiểu thuyết mới nhất cho chuyến hành trình về nhà.
                        </div>
                    </div>

                    <div class="shop-card">
                        <div class="shop-title">C. Stella’s Boutique</div>
                        <p>Late-night shopping in Stella’s boutique. Many of our clothes are on special offer, with some items two for the price of one. Visitors can also enjoy locally made cakes and snacks in our café. Just a short two-minute walk from the train station.</p>
                        <button class="translate-btn" onclick="toggleTrans(this)">BẢN DỊCH ĐẦY ĐỦ</button>
                        <div class="translation-text">
                            Mua sắm đêm muộn tại cửa hàng thời trang của Stella. Nhiều bộ quần áo của chúng tôi đang được khuyến mãi đặc biệt, với một số mặt hàng mua 1 tặng 1 (hai cái giá một cái). Du khách cũng có thể thưởng thức các loại bánh và đồ ăn nhẹ làm tại địa phương trong quán cà phê của chúng tôi. Chỉ cách ga tàu hai phút đi bộ ngắn ngủi.
                        </div>
                    </div>

                    <div class="shop-card">
                        <div class="shop-title">D. Masons</div>
                        <p>We’re closing down next week and have a fantastic sale. Everything must go! We have the cheapest range of clothes in town and a great selection of men’s wear, including suits, shirts and shoes. Open late this Saturday.</p>
                        <button class="translate-btn" onclick="toggleTrans(this)">BẢN DỊCH ĐẦY ĐỦ</button>
                        <div class="translation-text">
                            Chúng tôi sẽ đóng cửa vào tuần tới và có một đợt giảm giá tuyệt vời. Mọi thứ phải được bán hết! Chúng tôi có các loại quần áo rẻ nhất thị trấn và tuyển tập đồ nam tuyệt vời, bao gồm vest, sơ mi và giày. Mở cửa muộn vào thứ Bảy này.
                        </div>
                    </div>

                    <div class="shop-card">
                        <div class="shop-title">E. Henry’s</div>
                        <p>Henry’s is known for its high-quality clothing, as our users’ comments prove, whether that’s dresses, skirts or stylish suits. Our highly experienced staff will measure you and make sure you get the perfect fit. A little more expensive than the high street shops but worth every penny.</p>
                        <button class="translate-btn" onclick="toggleTrans(this)">BẢN DỊCH ĐẦY ĐỦ</button>
                        <div class="translation-text">
                            Henry’s nổi tiếng với quần áo chất lượng cao, như những bình luận của khách hàng đã chứng minh, cho dù đó là váy, chân váy hay những bộ vest sành điệu. Đội ngũ nhân viên giàu kinh nghiệm của chúng tôi sẽ đo cho bạn và đảm bảo bạn có bộ đồ vừa vặn hoàn hảo. Đắt hơn một chút so với các cửa hàng trên phố lớn nhưng đáng đồng tiền bát gạo.
                        </div>
                    </div>

                    <div class="shop-card">
                        <div class="shop-title">F. Design Corner</div>
                        <p>We’re a new shop in the old part of town and away from the crowds. But there’s nothing old about our goods. We sell dresses, skirts and blouses made by local designers, and beautiful posters, pens and pencils that will look great in the office or on a student’s desk.</p>
                        <button class="translate-btn" onclick="toggleTrans(this)">BẢN DỊCH ĐẦY ĐỦ</button>
                        <div class="translation-text">
                            Chúng tôi là một cửa hàng mới ở khu phố cổ và tránh xa đám đông. Nhưng hàng hóa của chúng tôi không hề cũ kỹ chút nào. Chúng tôi bán váy, chân váy và áo kiểu do các nhà thiết kế địa phương làm ra, cùng các tấm áp phích, bút mực và bút chì đẹp mắt sẽ trông rất tuyệt trong văn phòng hoặc trên bàn học sinh.
                        </div>
                    </div>

                    <div class="shop-card">
                        <div class="shop-title">G. Walkers Department Store</div>
                        <p>Visit one of the city’s most popular shopping destinations. We sell the latest luxury designer clothes and everything for the home, and we have a restaurant with an international menu. You should reserve a table if you wish to eat as we can get quite busy!</p>
                        <button class="translate-btn" onclick="toggleTrans(this)">BẢN DỊCH ĐẦY ĐỦ</button>
                        <div class="translation-text">
                            Ghé thăm một trong những điểm mua sắm nổi tiếng nhất của thành phố. Chúng tôi bán những bộ quần áo thiết kế sang trọng mới nhất và mọi thứ cho gia đình, và chúng tôi có một nhà hàng với thực đơn quốc tế. Bạn nên đặt bàn nếu muốn ăn vì chúng tôi có thể khá đông khách!
                        </div>
                    </div>

                    <div class="shop-card">
                        <div class="shop-title">H. Bartons</div>
                        <p>If you’re in town looking for a bargain don’t forget to pay us a visit. Situated in the heart of the shopping mall, our popular sale has everything for the professional man, including suits, shirts and shoes. Don’t forget our roof-top café! Late-night shopping Monday to Friday.</p>
                        <button class="translate-btn" onclick="toggleTrans(this)">BẢN DỊCH ĐẦY ĐỦ</button>
                        <div class="translation-text">
                            Nếu bạn đang ở thị trấn và tìm kiếm một món hời, đừng quên ghé thăm chúng tôi. Nằm ở trung tâm của trung tâm mua sắm, đợt giảm giá phổ biến của chúng tôi có mọi thứ cho người đàn ông chuyên nghiệp, bao gồm vest, sơ mi và giày. Đừng quên quán cà phê trên sân thượng của chúng tôi! Mở cửa mua sắm đêm muộn từ thứ Hai đến thứ Sáu.
                        </div>
                    </div>
                </div>

                <div class="glossary-box">
                    <h3 style="color:var(--primary-purple); text-align:center;">
                        <i class="fas fa-book"></i> Từ Vựng Cần Nhớ (Glossary)
                    </h3>
                    <table class="glossary-table">
                        <thead>
                            <tr>
                                <th>Word</th>
                                <th>Meaning</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr><td><strong>reasonably</strong> <span class="word-type">(adv)</span></td><td>Hợp lý, vừa phải (về giá cả)</td></tr>
                            <tr><td><strong>souvenir</strong> <span class="word-type">(n)</span></td><td>Quà lưu niệm</td></tr>
                            <tr><td><strong>boutique</strong> <span class="word-type">(n)</span></td><td>Cửa hàng thời trang nhỏ (bán đồ độc lạ)</td></tr>
                            <tr><td><strong>closing down</strong> <span class="word-type">(phrasal verb)</span></td><td>Đóng cửa vĩnh viễn (ngừng kinh doanh)</td></tr>
                            <tr><td><strong>measure</strong> <span class="word-type">(v)</span></td><td>Đo (kích thước cơ thể để may đồ)</td></tr>
                            <tr><td><strong>worth every penny</strong> <span class="word-type">(idiom)</span></td><td>Đáng đồng tiền bát gạo</td></tr>
                            <tr><td><strong>crowd</strong> <span class="word-type">(n)</span></td><td>Đám đông</td></tr>
                            <tr><td><strong>luxury</strong> <span class="word-type">(adj/n)</span></td><td>Sang trọng, xa xỉ</td></tr>
                            <tr><td><strong>bargain</strong> <span class="word-type">(n)</span></td><td>Món hời (mua được giá rẻ)</td></tr>
                            <tr><td><strong>mall</strong> <span class="word-type">(n)</span></td><td>Trung tâm thương mại</td></tr>
                        </tbody>
                    </table>
                </div>
            </div>
        </div>

        <div class="split-pane">
            <h2 style="color: var(--primary-purple); text-align: center; margin-bottom: 20px;">
                <i class="fas fa-puzzle-piece"></i> Bài Tập
            </h2>

            <div class="exercise-card" id="q1">
                <div class="question-header">
                    <div class="q-number">1</div>
                    <p><strong>Jim</strong> wants to buy some new shoes for work. He needs something reasonably cheap and, as he’s working long hours, he needs a shop that is open late during the week.</p>
                </div>
                <div class="options-grid" data-qid="1" data-ans="H">
                    <button class="option-btn" onclick="checkAnswer(1, 'A')">A</button>
                    <button class="option-btn" onclick="checkAnswer(1, 'B')">B</button>
                    <button class="option-btn" onclick="checkAnswer(1, 'C')">C</button>
                    <button class="option-btn" onclick="checkAnswer(1, 'D')">D</button>
                    <button class="option-btn" onclick="checkAnswer(1, 'E')">E</button>
                    <button class="option-btn" onclick="checkAnswer(1, 'F')">F</button>
                    <button class="option-btn" onclick="checkAnswer(1, 'G')">G</button>
                    <button class="option-btn" onclick="checkAnswer(1, 'H')">H</button>
                </div>
                <div class="feedback-panel" id="fb-1">
                    <div class="feedback-controls">
                        <button class="fb-btn btn-explain" onclick="showContent(1, 'explain')"><i class="fas fa-lightbulb"></i> Giải thích</button>
                        <button class="fb-btn btn-trans" onclick="showContent(1, 'trans')"><i class="fas fa-language"></i> Dịch câu hỏi</button>
                        <button class="fb-btn btn-vocab" onclick="showContent(1, 'vocab')"><i class="fas fa-exchange-alt"></i> Paraphrase</button>
                    </div>
                    <div id="content-1-explain" class="feedback-content">
                        <strong>Đáp án đúng là H.</strong><br>
                        Cô Mai An giải thích nè: Jim cần 2 điều kiện:<br>
                        1. Giày rẻ (reasonably cheap).<br>
                        2. Mở cửa muộn trong tuần (open late during the week).<br>
                        => <strong>Shop H (Bartons)</strong> đáp ứng cả hai: Có "bargain" (món hời ~ cheap), có "shoes", và đặc biệt là "Late-night shopping Monday to Friday" (Mở muộn T2-T6).<br>
                        <em>Lưu ý: Shop D cũng rẻ nhưng chỉ mở muộn vào "Saturday" (cuối tuần), không hợp với Jim.</em>
                    </div>
                    <div id="content-1-trans" class="feedback-content">
                        <strong>Dịch:</strong> Jim muốn mua một đôi giày mới để đi làm. Anh ấy cần thứ gì đó giá cả phải chăng và vì anh ấy làm việc nhiều giờ liền, anh ấy cần một cửa hàng mở cửa muộn trong tuần.
                    </div>
                    <div id="content-1-vocab" class="feedback-content">
                        <table style="width:100%; font-size:0.9em;">
                            <tr><th>Trong câu hỏi</th><th>Trong bài đọc (Shop H)</th></tr>
                            <tr><td>cheap</td><td>bargain (món hời)</td></tr>
                            <tr><td>open late during the week</td><td>Late-night shopping Monday to Friday</td></tr>
                        </table>
                    </div>
                </div>
            </div>

            <div class="exercise-card" id="q2">
                <div class="question-header">
                    <div class="q-number">2</div>
                    <p><strong>Hamid</strong> wants a shop where he can get measured for a new suit. He is happy to spend quite a lot but wants a place that has been recommended by other customers.</p>
                </div>
                <div class="options-grid" data-qid="2" data-ans="E">
                    <button class="option-btn" onclick="checkAnswer(2, 'A')">A</button>
                    <button class="option-btn" onclick="checkAnswer(2, 'B')">B</button>
                    <button class="option-btn" onclick="checkAnswer(2, 'C')">C</button>
                    <button class="option-btn" onclick="checkAnswer(2, 'D')">D</button>
                    <button class="option-btn" onclick="checkAnswer(2, 'E')">E</button>
                    <button class="option-btn" onclick="checkAnswer(2, 'F')">F</button>
                    <button class="option-btn" onclick="checkAnswer(2, 'G')">G</button>
                    <button class="option-btn" onclick="checkAnswer(2, 'H')">H</button>
                </div>
                <div class="feedback-panel" id="fb-2">
                    <div class="feedback-controls">
                        <button class="fb-btn btn-explain" onclick="showContent(2, 'explain')">Giải thích</button>
                        <button class="fb-btn btn-trans" onclick="showContent(2, 'trans')">Dịch</button>
                        <button class="fb-btn btn-vocab" onclick="showContent(2, 'vocab')">Paraphrase</button>
                    </div>
                    <div id="content-2-explain" class="feedback-content">
                        <strong>Đáp án đúng là E.</strong><br>
                        Phân tích cùng cô nhé:<br>
                        - "get measured" (được đo may): Shop E có "staff will measure you".<br>
                        - "recommended by other customers" (được khách khác khuyên dùng): Shop E có "users' comments prove" (bình luận người dùng chứng minh).<br>
                        - "spend quite a lot": Shop E thừa nhận "A little more expensive... but worth every penny".
                    </div>
                    <div id="content-2-trans" class="feedback-content">
                        <strong>Dịch:</strong> Hamid muốn một cửa hàng nơi anh ấy có thể được đo may một bộ vest mới. Anh ấy vui lòng chi tiêu khá nhiều nhưng muốn một nơi đã được các khách hàng khác giới thiệu.
                    </div>
                    <div id="content-2-vocab" class="feedback-content">
                        <table style="width:100%; font-size:0.9em;">
                            <tr><th>Question</th><th>Text (Shop E)</th></tr>
                            <tr><td>get measured</td><td>measure you</td></tr>
                            <tr><td>recommended by other customers</td><td>users’ comments prove</td></tr>
                            <tr><td>spend quite a lot</td><td>more expensive</td></tr>
                        </table>
                    </div>
                </div>
            </div>

            <div class="exercise-card" id="q3">
                <div class="question-header">
                    <div class="q-number">3</div>
                    <p><strong>Sheila</strong> wants to go shopping after she finishes work. She wants to buy an inexpensive dress or a skirt and would like to eat something made locally before her train leaves.</p>
                </div>
                <div class="options-grid" data-qid="3" data-ans="C">
                    <button class="option-btn" onclick="checkAnswer(3, 'A')">A</button>
                    <button class="option-btn" onclick="checkAnswer(3, 'B')">B</button>
                    <button class="option-btn" onclick="checkAnswer(3, 'C')">C</button>
                    <button class="option-btn" onclick="checkAnswer(3, 'D')">D</button>
                    <button class="option-btn" onclick="checkAnswer(3, 'E')">E</button>
                    <button class="option-btn" onclick="checkAnswer(3, 'F')">F</button>
                    <button class="option-btn" onclick="checkAnswer(3, 'G')">G</button>
                    <button class="option-btn" onclick="checkAnswer(3, 'H')">H</button>
                </div>
                <div class="feedback-panel" id="fb-3">
                    <div class="feedback-controls">
                        <button class="fb-btn btn-explain" onclick="showContent(3, 'explain')">Giải thích</button>
                        <button class="fb-btn btn-trans" onclick="showContent(3, 'trans')">Dịch</button>
                        <button class="fb-btn btn-vocab" onclick="showContent(3, 'vocab')">Paraphrase</button>
                    </div>
                    <div id="content-3-explain" class="feedback-content">
                        <strong>Đáp án đúng là C.</strong><br>
                        Keyword của Sheila:<br>
                        - "after finishes work" -> Shop C: "Late-night shopping".<br>
                        - "inexpensive" (không đắt) -> Shop C: "special offer", "two for the price of one".<br>
                        - "eat something made locally" -> Shop C: "locally made cakes".<br>
                        - "train leaves" -> Shop C: "two-minute walk from the train station".
                    </div>
                    <div id="content-3-trans" class="feedback-content">
                        <strong>Dịch:</strong> Sheila muốn đi mua sắm sau khi tan làm. Cô ấy muốn mua một chiếc váy hoặc chân váy rẻ tiền và muốn ăn món gì đó được làm tại địa phương trước khi tàu chạy.
                    </div>
                    <div id="content-3-vocab" class="feedback-content">
                        <table style="width:100%; font-size:0.9em;">
                            <tr><th>Question</th><th>Text (Shop C)</th></tr>
                            <tr><td>inexpensive</td><td>special offer / two for the price of one</td></tr>
                            <tr><td>eat locally</td><td>locally made cakes</td></tr>
                            <tr><td>train leaves</td><td>walk from the train station</td></tr>
                        </table>
                    </div>
                </div>
            </div>

            <div class="exercise-card" id="q4">
                <div class="question-header">
                    <div class="q-number">4</div>
                    <p><strong>Natalie</strong> is looking for a gift for her daughter who has passed her exams. She’d like to buy her something for university and wants to avoid the busy shopping centre.</p>
                </div>
                <div class="options-grid" data-qid="4" data-ans="F">
                    <button class="option-btn" onclick="checkAnswer(4, 'A')">A</button>
                    <button class="option-btn" onclick="checkAnswer(4, 'B')">B</button>
                    <button class="option-btn" onclick="checkAnswer(4, 'C')">C</button>
                    <button class="option-btn" onclick="checkAnswer(4, 'D')">D</button>
                    <button class="option-btn" onclick="checkAnswer(4, 'E')">E</button>
                    <button class="option-btn" onclick="checkAnswer(4, 'F')">F</button>
                    <button class="option-btn" onclick="checkAnswer(4, 'G')">G</button>
                    <button class="option-btn" onclick="checkAnswer(4, 'H')">H</button>
                </div>
                <div class="feedback-panel" id="fb-4">
                    <div class="feedback-controls">
                        <button class="fb-btn btn-explain" onclick="showContent(4, 'explain')">Giải thích</button>
                        <button class="fb-btn btn-trans" onclick="showContent(4, 'trans')">Dịch</button>
                        <button class="fb-btn btn-vocab" onclick="showContent(4, 'vocab')">Paraphrase</button>
                    </div>
                    <div id="content-4-explain" class="feedback-content">
                        <strong>Đáp án đúng là F.</strong><br>
                        Natalie cần:<br>
                        - "something for university" (đồ dùng đại học) -> Shop F có "pens and pencils... student's desk" (bút viết cho bàn học sinh).<br>
                        - "avoid the busy shopping centre" (tránh trung tâm đông đúc) -> Shop F nằm ở "old part of town and away from the crowds" (khu phố cổ, xa đám đông).
                    </div>
                    <div id="content-4-trans" class="feedback-content">
                        <strong>Dịch:</strong> Natalie đang tìm quà cho con gái vừa thi đỗ. Bà ấy muốn mua thứ gì đó dùng cho đại học và muốn tránh trung tâm mua sắm đông đúc.
                    </div>
                    <div id="content-4-vocab" class="feedback-content">
                        <table style="width:100%; font-size:0.9em;">
                            <tr><th>Question</th><th>Text (Shop F)</th></tr>
                            <tr><td>avoid busy centre</td><td>away from the crowds</td></tr>
                            <tr><td>something for university</td><td>student's desk</td></tr>
                        </table>
                    </div>
                </div>
            </div>

            <div class="exercise-card" id="q5">
                <div class="question-header">
                    <div class="q-number">5</div>
                    <p><strong>Manuela</strong> is on holiday in the UK and is looking for some chocolate for her friend. She would also like to buy something to read when she gets back to her hotel.</p>
                </div>
                <div class="options-grid" data-qid="5" data-ans="B">
                    <button class="option-btn" onclick="checkAnswer(5, 'A')">A</button>
                    <button class="option-btn" onclick="checkAnswer(5, 'B')">B</button>
                    <button class="option-btn" onclick="checkAnswer(5, 'C')">C</button>
                    <button class="option-btn" onclick="checkAnswer(5, 'D')">D</button>
                    <button class="option-btn" onclick="checkAnswer(5, 'E')">E</button>
                    <button class="option-btn" onclick="checkAnswer(5, 'F')">F</button>
                    <button class="option-btn" onclick="checkAnswer(5, 'G')">G</button>
                    <button class="option-btn" onclick="checkAnswer(5, 'H')">H</button>
                </div>
                <div class="feedback-panel" id="fb-5">
                    <div class="feedback-controls">
                        <button class="fb-btn btn-explain" onclick="showContent(5, 'explain')">Giải thích</button>
                        <button class="fb-btn btn-trans" onclick="showContent(5, 'trans')">Dịch</button>
                        <button class="fb-btn btn-vocab" onclick="showContent(5, 'vocab')">Paraphrase</button>
                    </div>
                    <div id="content-5-explain" class="feedback-content">
                        <strong>Đáp án đúng là B.</strong><br>
                        Manuela cần:<br>
                        - "on holiday" (đang đi nghỉ) -> Shop B có "souvenirs" (quà lưu niệm), "remind you of your visit".<br>
                        - "chocolate" -> Shop B bán "locally made chocolates".<br>
                        - "something to read" -> Shop B có "newspaper, a magazine or the latest novel".
                    </div>
                    <div id="content-5-trans" class="feedback-content">
                        <strong>Dịch:</strong> Manuela đang đi nghỉ ở Anh và đang tìm sô cô la cho bạn. Cô ấy cũng muốn mua thứ gì đó để đọc khi trở về khách sạn.
                    </div>
                    <div id="content-5-vocab" class="feedback-content">
                        <table style="width:100%; font-size:0.9em;">
                            <tr><th>Question</th><th>Text (Shop B)</th></tr>
                            <tr><td>something to read</td><td>newspaper, novel</td></tr>
                            <tr><td>on holiday</td><td>visit / souvenirs</td></tr>
                        </table>
                    </div>
                </div>
            </div>

            <div class="submit-container">
                <button class="submit-btn" onclick="finishTest()">NỘP BÀI <i class="fas fa-paper-plane"></i></button>
            </div>
        </div>
    </div>

    <div class="modal-overlay" id="score-modal">
        <div class="modal-content">
            <h2 style="color:var(--primary-mint); margin:0;">KẾT QUẢ CỦA BẠN</h2>
            <div class="score-display" id="final-score">0/5</div>
            <p class="modal-msg" id="modal-msg">...</p>
            <button class="submit-btn" onclick="location.reload()" style="font-size:1rem; padding:10px 30px;">Làm lại bài</button>
        </div>
    </div>

    <script>
        /* --- Timer Logic --- */
        let timeLeft = 600; // 10 minutes in seconds
        let timerInterval;
        let isPaused = true;

        function updateTimerDisplay() {
            const m = Math.floor(timeLeft / 60);
            const s = timeLeft % 60;
            document.getElementById('timer-display').textContent = 
                `${m.toString().padStart(2, '0')}:${s.toString().padStart(2, '0')}`;
        }

        function toggleTimer() {
            const statusSpan = document.getElementById('timer-status');
            if (isPaused) {
                isPaused = false;
                statusSpan.textContent = "";
                statusSpan.style.color = "lightgreen";
                document.querySelector('.timer-container').style.background = "#e056fd";
                
                timerInterval = setInterval(() => {
                    if (timeLeft > 0) {
                        timeLeft--;
                        updateTimerDisplay();
                    } else {
                        clearInterval(timerInterval);
                        alert("Đã hết giờ làm bài. Bạn vẫn có thể tiếp tục làm, nhưng nhớ là trong phòng thi thật, bạn chỉ nên làm một bài như thế này trong 10 phút thôi nha.");
                    }
                }, 1000);
            } else {
                isPaused = true;
                clearInterval(timerInterval);
                statusSpan.textContent = "(PAUSED)";
                document.querySelector('.timer-container').style.background = "var(--primary-purple)";
            }
        }

        /* --- UI Logic --- */
        function toggleTrans(btn) {
            const text = btn.nextElementSibling;
            text.classList.toggle('show');
            btn.textContent = text.classList.contains('show') ? "ẨN BẢN DỊCH" : "BẢN DỊCH ĐẦY ĐỦ";
        }

        function showContent(qID, type) {
            // Hide all contents for this question
            const parent = document.getElementById(`fb-${qID}`);
            const contents = parent.querySelectorAll('.feedback-content');
            contents.forEach(c => c.style.display = 'none');
            
            // Show specific content
            document.getElementById(`content-${qID}-${type}`).style.display = 'block';
        }

        /* --- Answer Logic --- */
        let userScore = 0;
        const totalQuestions = 5;
        // Track which questions have been answered to avoid double counting score (optional, simplified here)
        const answeredQs = new Set();

        function checkAnswer(qID, selectedOption) {
            const grid = document.querySelector(`.options-grid[data-qid="${qID}"]`);
            const correctAns = grid.getAttribute('data-ans');
            const feedbackPanel = document.getElementById(`fb-${qID}`);
            
            // Prevent re-answering
            if (grid.classList.contains('disabled-grid')) return;
            
            grid.classList.add('disabled-grid');
            feedbackPanel.style.display = 'block';
            
            // Find buttons
            const buttons = grid.querySelectorAll('.option-btn');
            let selectedBtn, correctBtn;
            
            buttons.forEach(btn => {
                if (btn.textContent === selectedOption) selectedBtn = btn;
                if (btn.textContent === correctAns) correctBtn = btn;
            });

            if (selectedOption === correctAns) {
                // Correct
                selectedBtn.classList.add('correct');
                playSound('correct');
                confetti({
                    particleCount: 100,
                    spread: 70,
                    origin: { y: 0.6 }
                });
                if (!answeredQs.has(qID)) {
                    userScore++;
                    answeredQs.add(qID);
                }
                // Default show explanation
                showContent(qID, 'explain');
            } else {
                // Wrong
                selectedBtn.classList.add('wrong');
                correctBtn.classList.add('show-correct');
                playSound('wrong');
                // Default show explanation
                showContent(qID, 'explain');
            }
        }

        function playSound(type) {
            const audio = document.getElementById(`sound-${type}`);
            if (audio) {
                audio.currentTime = 0;
                audio.play().catch(e => console.log("Audio autoplay might be blocked"));
            }
        }

        function finishTest() {
            playSound('finish');
            const modal = document.getElementById('score-modal');
            const scoreText = document.getElementById('final-score');
            const msgText = document.getElementById('modal-msg');

            // Force calculate score based on class state in case logic slipped
            let currentScore = 0;
            document.querySelectorAll('.options-grid').forEach(grid => {
                const correctBtn = Array.from(grid.querySelectorAll('.option-btn')).find(b => b.classList.contains('correct'));
                // Note: If user selected wrong, 'correct' class isn't on the selected button, but on the correct one IF logic differ.
                // In my logic: .correct is only added if user CLICKED the correct one.
                if (correctBtn) currentScore++;
            });

            scoreText.textContent = `${currentScore}/${totalQuestions}`;
            
            if (currentScore === 5) {
                msgText.textContent = "Xuất sắc! Bạn đúng là thiên tài Reading!";
                confetti({ particleCount: 200, spread: 100 });
            } else if (currentScore >= 3) {
                msgText.textContent = "Làm tốt lắm! Bạn đã nắm vững kiến thức cơ bản.";
            } else {
                msgText.textContent = "Cố lên nhé! Hãy xem kỹ lại phần giải thích để hiểu bài hơn.";
            }

            modal.style.display = 'flex';
        }
    </script>
</body>
</html>