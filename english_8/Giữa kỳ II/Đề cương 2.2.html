<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Ms Mai An ULIS - Super Fun English Quiz</title>
    <link href="https://fonts.googleapis.com/css2?family=Quicksand:wght@500;700;900&display=swap" rel="stylesheet">
    <script src="https://cdn.jsdelivr.net/npm/canvas-confetti@1.6.0/dist/confetti.browser.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script>
    <style>
        :root {
            --bg-gradient: linear-gradient(135deg, #8854C0, #fceabb, #00C9A7);
            --correct-color: #00D26A;
            --incorrect-color: #FF4757;
            --btn-color: #ffffff;
            --text-main: #333333;
            --shadow-color: rgba(0,0,0,0.15);
        }

        body {
            font-family: 'Quicksand', sans-serif;
            background: var(--bg-gradient);
            background-attachment: fixed;
            margin: 0;
            padding: 20px;
            color: var(--text-main);
            display: flex;
            flex-direction: column;
            align-items: center;
        }

        /* Th√™m h·ªça ti·∫øt vui nh·ªôn ch√¨m d∆∞·ªõi background */
        body::before {
            content: '';
            position: fixed;
            top: 0; left: 0; width: 100%; height: 100%;
            background-image: radial-gradient(rgba(255,255,255,0.2) 2px, transparent 2px);
            background-size: 30px 30px;
            z-index: -1;
        }

        .header-title {
            background: #fff;
            padding: 10px 30px;
            border-radius: 20px;
            box-shadow: 0 6px 0 var(--shadow-color);
            margin-bottom: 20px;
            font-weight: 900;
            color: #8854C0;
            text-align: center;
            font-size: 1.5rem;
        }

        .quiz-container {
            max-width: 800px;
            width: 100%;
        }

        .card {
            background: #ffffff;
            border-radius: 25px;
            padding: 25px;
            margin-bottom: 30px;
            box-shadow: 0 10px 0 var(--shadow-color);
            transition: transform 0.2s;
        }

        .section-title {
            font-size: 1.4rem;
            color: #FF4757;
            margin-bottom: 15px;
            font-weight: 900;
            text-transform: uppercase;
            border-bottom: 3px dashed #fceabb;
            padding-bottom: 10px;
        }

        .question-text {
            font-size: 1.2rem;
            font-weight: 700;
            margin-bottom: 20px;
        }

        .options-grid {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 15px;
        }

        .btn-option {
            background: var(--btn-color);
            border: 3px solid #e0e0e0;
            border-radius: 15px;
            padding: 15px;
            font-size: 1.1rem;
            font-family: 'Quicksand', sans-serif;
            font-weight: 700;
            cursor: pointer;
            box-shadow: 0 6px 0 #e0e0e0;
            transition: all 0.1s ease;
            position: relative;
            text-align: left;
            display: flex;
            align-items: center;
        }

        .btn-option:hover {
            transform: scale(1.02);
            border-color: #8854C0;
        }

        .btn-option:active {
            transform: translateY(6px);
            box-shadow: 0 0 0 transparent;
        }

        .btn-option.correct {
            background: var(--correct-color);
            color: white;
            border-color: #009e4f;
            box-shadow: 0 6px 0 #009e4f;
        }

        .btn-option.incorrect {
            background: var(--incorrect-color);
            color: white;
            border-color: #cc3945;
            box-shadow: 0 6px 0 #cc3945;
            animation: shake 0.4s;
        }

        .explanation {
            display: none;
            margin-top: 20px;
            padding: 15px;
            background: #f8f9fa;
            border-left: 5px solid #00C9A7;
            border-radius: 10px;
            font-size: 1rem;
            line-height: 1.6;
            animation: fadeIn 0.5s;
        }

        .explanation.show {
            display: block;
        }

        .exp-step { margin-bottom: 10px; }
        .exp-step strong { color: #8854C0; }

        @keyframes shake {
            0% { transform: translateX(0); }
            25% { transform: translateX(-8px); }
            50% { transform: translateX(8px); }
            75% { transform: translateX(-8px); }
            100% { transform: translateX(0); }
        }

        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(-10px); }
            to { opacity: 1; transform: translateY(0); }
        }

        .submit-btn {
            display: block;
            width: 100%;
            background: #FF9F43;
            color: white;
            border: none;
            border-radius: 20px;
            padding: 20px;
            font-size: 1.5rem;
            font-weight: 900;
            font-family: 'Quicksand', sans-serif;
            cursor: pointer;
            box-shadow: 0 8px 0 #cc7f35;
            margin: 40px 0;
            text-transform: uppercase;
        }

        .submit-btn:active {
            transform: translateY(8px);
            box-shadow: 0 0 0 transparent;
        }

        /* Ki·ªÉu d√°ng cho ph·∫ßn ƒëi·ªÅn t·ª´ / s·∫Øp x·∫øp (Duolingo style) */
        .word-bank {
            display: flex;
            flex-wrap: wrap;
            gap: 10px;
            margin-bottom: 15px;
            min-height: 50px;
            padding: 10px;
            background: #f1f2f6;
            border-radius: 15px;
            border: 2px dashed #ced6e0;
        }

        .word-piece {
            background: white;
            border: 2px solid #e0e0e0;
            border-radius: 10px;
            padding: 8px 15px;
            font-weight: 700;
            cursor: pointer;
            box-shadow: 0 4px 0 #e0e0e0;
            user-select: none;
        }

        .word-piece:active {
            transform: translateY(4px);
            box-shadow: 0 0 0 transparent;
        }

        .answer-slot {
            display: flex;
            flex-wrap: wrap;
            gap: 10px;
            min-height: 50px;
            padding: 15px;
            border-bottom: 3px solid #333;
            margin-bottom: 15px;
        }

        .inline-options select {
            font-family: 'Quicksand', sans-serif;
            font-size: 1.1rem;
            font-weight: 700;
            padding: 5px 10px;
            border-radius: 10px;
            border: 2px solid #8854C0;
            background: #fff;
            color: #8854C0;
            cursor: pointer;
            outline: none;
        }

        .dialogue-box {
            background: #eef2f3;
            padding: 20px;
            border-radius: 15px;
            font-family: monospace;
            font-size: 1.1rem;
        }
        .dialogue-line { margin-bottom: 10px; display: flex; align-items: center; gap: 10px;}
        .dialogue-line select { font-size: 1rem; padding: 5px; border-radius: 8px; border: 2px solid #00C9A7; }

        @media(max-width: 600px) {
            .options-grid { grid-template-columns: 1fr; }
        }
    </style>
</head>
<body>

    <div class="header-title">üëë Gi√°o vi√™n t·∫°o: Ms Mai An ULIS üëë</div>
    <div id="app" class="quiz-container"></div>

    <button id="submitBtn" class="submit-btn" onclick="submitQuiz()">N·ªôp B√†i Khoe ƒêi·ªÉm!</button>

    <script>
        // --- DATA N·ªòI DUNG & GI·∫¢I TH√çCH ---
        const quizData = [
            // PART I: STRESS
            {
                section: "I. Find the word which has a different stress position from the others.",
                id: "1_1", type: "mcq",
                question: "1. A. a<u>gain</u> B. <u>wild</u>life C. <u>fi</u>nish D. <u>rare</u>ly",
                options: ["A. again", "B. wildlife", "C. finish", "D. rarely"],
                correct: 0,
                exp: `<div class="exp-step"><strong>1. D·ªãch c√¢u h·ªèi:</strong> T√¨m t·ª´ c√≥ tr·ªçng √¢m kh√°c v·ªõi c√°c t·ª´ c√≤n l·∫°i.</div>
                      <div class="exp-step"><strong>2. Ph√¢n t√≠ch tr·ªçng √¢m:</strong><br>A. again /…ôÀà…°en/ (Tr·ªçng √¢m 2)<br>B. wildlife /Ààwa…™ldla…™f/ (Tr·ªçng √¢m 1)<br>C. finish /Ààf…™n…™ É/ (Tr·ªçng √¢m 1)<br>D. rarely /Ààre…ôli/ (Tr·ªçng √¢m 1)</div>
                      <div class="exp-step"><strong>3. T·∫°i sao ch·ªçn A?</strong> T·ª´ 'again' c√≥ tr·ªçng √¢m r∆°i v√†o √¢m ti·∫øt th·ª© 2, trong khi 3 t·ª´ c√≤n l·∫°i ƒë·ªÅu c√≥ tr·ªçng √¢m r∆°i v√†o √¢m ti·∫øt th·ª© 1.</div>`
            },
            {
                id: "1_2", type: "mcq",
                question: "2. A. ar<u>ri</u>val B. <u>ty</u>pical C. <u>nu</u>merous D. <u>ha</u>bitat",
                options: ["A. arrival", "B. typical", "C. numerous", "D. habitat"],
                correct: 0,
                exp: `<div class="exp-step"><strong>1. D·ªãch c√¢u h·ªèi:</strong> T√¨m t·ª´ c√≥ tr·ªçng √¢m kh√°c v·ªõi c√°c t·ª´ c√≤n l·∫°i.</div>
                      <div class="exp-step"><strong>2. Ph√¢n t√≠ch:</strong><br>A. arrival /…ôÀàra…™vl/ (√¢m 2)<br>B. typical /Ààt…™p…™kl/ (√¢m 1)<br>C. numerous /ÀànjuÀêm…ôr…ôs/ (√¢m 1)<br>D. habitat /Ààh√¶b…™t√¶t/ (√¢m 1)</div>
                      <div class="exp-step"><strong>3. Gi·∫£i th√≠ch:</strong> ƒê√°p √°n A tr·ªçng √¢m 2, c√°c ƒë√°p √°n c√≤n l·∫°i tr·ªçng √¢m 1. ƒêu√¥i '-al' th∆∞·ªùng kh√¥ng l√†m thay ƒë·ªïi tr·ªçng √¢m c·ªßa t·ª´ g·ªëc (arrive -> arrival).</div>`
            },
            {
                id: "1_3", type: "mcq",
                question: "3. A. <u>luc</u>kily B. after<u>noon</u> C. <u>cul</u>tural D. <u>res</u>cuer",
                options: ["A. luckily", "B. afternoon", "C. cultural", "D. rescuer"],
                correct: 1,
                exp: `<div class="exp-step"><strong>1. D·ªãch c√¢u h·ªèi:</strong> T√¨m t·ª´ c√≥ tr·ªçng √¢m kh√°c v·ªõi c√°c t·ª´ c√≤n l·∫°i.</div>
                      <div class="exp-step"><strong>2. Ph√¢n t√≠ch:</strong><br>A. luckily /Ààl åk…™li/ (√¢m 1)<br>B. afternoon /Àå…ëÀêft…ôÀànuÀên/ (√¢m 3)<br>C. cultural /Ààk ålt É…ôr…ôl/ (√¢m 1)<br>D. rescuer /ÀàreskjuÀê…ô(r)/ (√¢m 1)</div>
                      <div class="exp-step"><strong>3. Gi·∫£i th√≠ch:</strong> T·ª´ ch·ªâ c√°c bu·ªïi c√≥ ƒëu√¥i '-noon' th∆∞·ªùng nh·∫≠n tr·ªçng √¢m ch√≠nh v√†o ch√≠nh n√≥. ƒê√°p √°n B tr·ªçng √¢m 3, c√≤n l·∫°i tr·ªçng √¢m 1.</div>`
            },
            {
                id: "1_4", type: "mcq",
                question: "4. A. e<u>lec</u>tric B. <u>na</u>tural C. am<u>bi</u>tion D. ad<u>dic</u>tion",
                options: ["A. electric", "B. natural", "C. ambition", "D. addiction"],
                correct: 1,
                exp: `<div class="exp-step"><strong>1. D·ªãch c√¢u h·ªèi:</strong> T√¨m t·ª´ c√≥ tr·ªçng √¢m kh√°c v·ªõi c√°c t·ª´ c√≤n l·∫°i.</div>
                      <div class="exp-step"><strong>2. Ph√¢n t√≠ch:</strong><br>A. electric /…™Ààlektr…™k/ (√¢m 2)<br>B. natural /Ààn√¶t Ér…ôl/ (√¢m 1)<br>C. ambition /√¶mÀàb…™ Én/ (√¢m 2)<br>D. addiction /…ôÀàd…™k Én/ (√¢m 2)</div>
                      <div class="exp-step"><strong>3. Gi·∫£i th√≠ch:</strong> C√°c t·ª´ k·∫øt th√∫c b·∫±ng ƒëu√¥i '-ic', '-tion' th∆∞·ªùng c√≥ tr·ªçng √¢m r∆°i v√†o √¢m ti·∫øt ngay tr∆∞·ªõc n√≥. ƒê√°p √°n B tr·ªçng √¢m 1, c√≤n l·∫°i tr·ªçng √¢m 2.</div>`
            },
            {
                id: "1_5", type: "mcq",
                question: "5. A. a<u>vai</u>lable B. e<u>co</u>nomy C. deco<u>ra</u>tion D. at<u>trac</u>tiveness",
                options: ["A. available", "B. economy", "C. decoration", "D. attractiveness"],
                correct: 2,
                exp: `<div class="exp-step"><strong>1. D·ªãch c√¢u h·ªèi:</strong> T√¨m t·ª´ c√≥ tr·ªçng √¢m kh√°c v·ªõi c√°c t·ª´ c√≤n l·∫°i.</div>
                      <div class="exp-step"><strong>2. Ph√¢n t√≠ch:</strong><br>A. available /…ôÀàve…™l…ôbl/ (√¢m 2)<br>B. economy /…™Ààk…ín…ômi/ (√¢m 2)<br>C. decoration /Àådek…ôÀàre…™ Én/ (√¢m 3)<br>D. attractiveness /…ôÀàtr√¶kt…™vn…ôs/ (√¢m 2)</div>
                      <div class="exp-step"><strong>3. Gi·∫£i th√≠ch:</strong> ƒêu√¥i '-tion' k√©o tr·ªçng √¢m r∆°i v√†o tr∆∞·ªõc n√≥ (ra-). N√™n C tr·ªçng √¢m 3, c√°c t·ª´ c√≤n l·∫°i tr·ªçng √¢m 2.</div>`
            },

            // PART II: VOCABULARY
            {
                section: "II. Choose the correct word to complete the sentences.",
                id: "2_1", type: "mcq",
                question: "1. A volcano in the South Pacific __________ violently last Saturday.",
                options: ["A. caused", "B. flooded", "C. erupted", "D. blew"],
                correct: 2,
                exp: `<div class="exp-step"><strong>1. D·ªãch c√¢u:</strong> M·ªôt ng·ªçn n√∫i l·ª≠a ·ªü Nam Th√°i B√¨nh D∆∞∆°ng ƒë√£ _____ d·ªØ d·ªôi v√†o th·ª© B·∫£y tu·∫ßn tr∆∞·ªõc.</div>
                      <div class="exp-step"><strong>2. Ph√¢n t√≠ch t·ª´ v·ª±ng:</strong><br>A. caused (v): g√¢y ra.<br>B. flooded (v): l√†m ng·∫≠p l·ª•t.<br>C. erupted (v): phun tr√†o.<br>D. blew (v): th·ªïi.</div>
                      <div class="exp-step"><strong>3. T·∫°i sao ch·ªçn C?</strong> Collocation (C·ª•m t·ª´ c·ªë ƒë·ªãnh): "volcano erupts" nghƒ©a l√† n√∫i l·ª≠a phun tr√†o. S·ª± vi·ªác x·∫£y ra trong qu√° kh·ª© n√™n d√πng V-ed (erupted).</div>
                      <div class="exp-step"><strong>4. T·∫°i sao sai?</strong> N√∫i l·ª≠a kh√¥ng th·ªÉ "g√¢y ra" (n·∫øu kh√¥ng c√≥ t√¢n ng·ªØ), kh√¥ng th·ªÉ "ng·∫≠p l·ª•t" hay "th·ªïi". Ch·ªâ c√≥ C h·ª£p nghƒ©a.</div>`
            },
            {
                id: "2_2", type: "mcq",
                question: "2. The tsunami __________ hundreds of homes on some small islands.",
                options: ["A. built", "B. burned", "C. destroyed", "D. trembled"],
                correct: 2,
                exp: `<div class="exp-step"><strong>1. D·ªãch c√¢u:</strong> Tr·∫≠n s√≥ng th·∫ßn ƒë√£ _____ h√†ng trƒÉm ng√¥i nh√† tr√™n m·ªôt s·ªë h√≤n ƒë·∫£o nh·ªè.</div>
                      <div class="exp-step"><strong>2. Ph√¢n t√≠ch t·ª´ v·ª±ng:</strong><br>A. built (v): x√¢y d·ª±ng.<br>B. burned (v): ƒë·ªët ch√°y.<br>C. destroyed (v): ph√° h·ªßy.<br>D. trembled (v): rung l·∫Øc.</div>
                      <div class="exp-step"><strong>3. T·∫°i sao ch·ªçn C?</strong> S√≥ng th·∫ßn l√† thi√™n tai mang t√≠nh h·ªßy di·ªát, h√†nh ƒë·ªông ph√π h·ª£p nh·∫•t t√°c ƒë·ªông l√™n "homes" (nh√† c·ª≠a) l√† "destroyed" (ph√° h·ªßy).</div>`
            },
            {
                id: "2_3", type: "mcq",
                question: "3. They were very hard to __________ the villagers from the flooded area.",
                options: ["A. shelter", "B. rescue", "C. provide", "D. hide"],
                correct: 1,
                exp: `<div class="exp-step"><strong>1. D·ªãch c√¢u:</strong> H·ªç ƒë√£ r·∫•t v·∫•t v·∫£ ƒë·ªÉ _____ d√¢n l√†ng kh·ªèi khu v·ª±c b·ªã ng·∫≠p l·ª•t.</div>
                      <div class="exp-step"><strong>2. Ph√¢n t√≠ch t·ª´ v·ª±ng:</strong><br>A. shelter (v): che ch·ªü.<br>B. rescue (v): gi·∫£i c·ª©u.<br>C. provide (v): cung c·∫•p.<br>D. hide (v): tr·ªën/gi·∫•u.</div>
                      <div class="exp-step"><strong>3. T·∫°i sao ch·ªçn B?</strong> "Rescue somebody from something" l√† c·ª•m t·ª´ chu·∫©n: Gi·∫£i c·ª©u ai ƒë√≥ kh·ªèi c√°i g√¨. ·ªû ƒë√¢y l√† c·ª©u kh·ªèi v√πng ng·∫≠p l·ª•t.</div>`
            },
            {
                id: "2_4", type: "mcq",
                question: "4. You can help protect the environment by picking up litter and __________ trees.",
                options: ["A. planting", "B. cutting", "C. reusing", "D. buying"],
                correct: 0,
                exp: `<div class="exp-step"><strong>1. D·ªãch c√¢u:</strong> B·∫°n c√≥ th·ªÉ gi√∫p b·∫£o v·ªá m√¥i tr∆∞·ªùng b·∫±ng c√°ch nh·∫∑t r√°c v√† _____ c√¢y.</div>
                      <div class="exp-step"><strong>2. Ph√¢n t√≠ch t·ª´ v·ª±ng:</strong><br>A. planting (v-ing): tr·ªìng.<br>B. cutting (v-ing): ch·∫∑t, c·∫Øt.<br>C. reusing (v-ing): t√°i s·ª≠ d·ª•ng.<br>D. buying (v-ing): mua.</div>
                      <div class="exp-step"><strong>3. T·∫°i sao ch·ªçn A?</strong> H√†nh ƒë·ªông b·∫£o v·ªá m√¥i tr∆∞·ªùng ƒëi ƒë√¥i v·ªõi "trees" (c√¢y c·ªëi) ch·∫Øc ch·∫Øn l√† "tr·ªìng c√¢y" (planting). C·∫•u tr√∫c song song: picking up... and planting...</div>`
            },
            {
                id: "2_5", type: "mcq",
                question: "5. Water pollution has caused a wide range of __________ problems in humans.",
                options: ["A. traffic", "B. education", "C. history", "D. health"],
                correct: 3,
                exp: `<div class="exp-step"><strong>1. D·ªãch c√¢u:</strong> √î nhi·ªÖm n∆∞·ªõc ƒë√£ g√¢y ra h√†ng lo·∫°t c√°c v·∫•n ƒë·ªÅ v·ªÅ _____ ·ªü con ng∆∞·ªùi.</div>
                      <div class="exp-step"><strong>2. Ph√¢n t√≠ch t·ª´ v·ª±ng:</strong><br>A. traffic (n): giao th√¥ng.<br>B. education (n): gi√°o d·ª•c.<br>C. history (n): l·ªãch s·ª≠.<br>D. health (n): s·ª©c kh·ªèe.</div>
                      <div class="exp-step"><strong>3. T·∫°i sao ch·ªçn D?</strong> C·ª•m t·ª´ "health problems" (c√°c v·∫•n ƒë·ªÅ v·ªÅ s·ª©c kh·ªèe) l√† h·ª£p l√Ω nh·∫•t khi n√≥i v·ªÅ t√°c h·∫°i c·ªßa √¥ nhi·ªÖm m√¥i tr∆∞·ªùng ƒë·ªëi v·ªõi con ng∆∞·ªùi.</div>`
            },
            {
                id: "2_6", type: "mcq",
                question: "6. This forest provides a habitat for hundreds of __________ of plants and animals.",
                options: ["A. styles", "B. species", "C. families", "D. collections"],
                correct: 1,
                exp: `<div class="exp-step"><strong>1. D·ªãch c√¢u:</strong> Khu r·ª´ng n√†y cung c·∫•p m√¥i tr∆∞·ªùng s·ªëng cho h√†ng trƒÉm _____ th·ª±c v·∫≠t v√† ƒë·ªông v·∫≠t.</div>
                      <div class="exp-step"><strong>2. Ph√¢n t√≠ch t·ª´ v·ª±ng:</strong><br>A. styles (n): phong c√°ch.<br>B. species (n): lo√†i (sinh h·ªçc).<br>C. families (n): gia ƒë√¨nh.<br>D. collections (n): b·ªô s∆∞u t·∫≠p.</div>
                      <div class="exp-step"><strong>3. T·∫°i sao ch·ªçn B?</strong> Khi n√≥i v·ªÅ th·ª±c v·∫≠t v√† ƒë·ªông v·∫≠t trong t·ª± nhi√™n, ta d√πng t·ª´ "species" (lo√†i).</div>`
            },
            {
                id: "2_7", type: "mcq",
                question: "7. Some people say that protecting the environment is the government‚Äôs _________.",
                options: ["A. responsive", "B. responsible", "C. responsibly", "D. responsibility"],
                correct: 3,
                exp: `<div class="exp-step"><strong>1. D·ªãch c√¢u:</strong> M·ªôt s·ªë ng∆∞·ªùi n√≥i r·∫±ng b·∫£o v·ªá m√¥i tr∆∞·ªùng l√† _____ c·ªßa ch√≠nh ph·ªß.</div>
                      <div class="exp-step"><strong>2. Ph√¢n t√≠ch t·ª´ v·ª±ng:</strong><br>A. responsive (adj): ph·∫£n h·ªìi nhanh.<br>B. responsible (adj): ch·ªãu tr√°ch nhi·ªám.<br>C. responsibly (adv): m·ªôt c√°ch c√≥ tr√°ch nhi·ªám.<br>D. responsibility (n): tr√°ch nhi·ªám.</div>
                      <div class="exp-step"><strong>3. T·∫°i sao ch·ªçn D?</strong> Sau s·ªü h·ªØu c√°ch "the government's" b·∫Øt bu·ªôc ph·∫£i l√† m·ªôt danh t·ª´. Trong 4 ƒë√°p √°n ch·ªâ c√≥ D l√† danh t·ª´.</div>`
            },
            {
                id: "2_8", type: "mcq",
                question: "8. __________ is a mass of rock and earth moving suddenly and quickly down a steep slope.",
                options: ["A. Drought", "B. Flood", "C. Landslide", "D. Tornado"],
                correct: 2,
                exp: `<div class="exp-step"><strong>1. D·ªãch c√¢u:</strong> _____ l√† m·ªôt kh·ªëi ƒë√° v√† ƒë·∫•t di chuy·ªÉn b·∫•t ng·ªù v√† nhanh ch√≥ng xu·ªëng m·ªôt s∆∞·ªùn d·ªëc.</div>
                      <div class="exp-step"><strong>2. Ph√¢n t√≠ch t·ª´ v·ª±ng:</strong><br>A. Drought (n): h·∫°n h√°n.<br>B. Flood (n): l≈© l·ª•t.<br>C. Landslide (n): s·∫°t l·ªü ƒë·∫•t.<br>D. Tornado (n): l·ªëc xo√°y.</div>
                      <div class="exp-step"><strong>3. T·∫°i sao ch·ªçn C?</strong> D·ª±a v√†o ƒë·ªãnh nghƒ©a "mass of rock and earth" (kh·ªëi ƒë·∫•t ƒë√°) tr∆∞·ª£t xu·ªëng d·ªëc, ƒë√¢y ch√≠nh x√°c l√† hi·ªán t∆∞·ª£ng s·∫°t l·ªü ƒë·∫•t (Landslide).</div>`
            },
            {
                id: "2_9", type: "mcq",
                question: "9. Shopping centres attract lots of __________ during the sales season.",
                options: ["A. customers", "B. habitats", "C. products", "D. disasters"],
                correct: 0,
                exp: `<div class="exp-step"><strong>1. D·ªãch c√¢u:</strong> C√°c trung t√¢m mua s·∫Øm thu h√∫t r·∫•t nhi·ªÅu _____ trong m√πa gi·∫£m gi√°.</div>
                      <div class="exp-step"><strong>2. Ph√¢n t√≠ch t·ª´ v·ª±ng:</strong><br>A. customers (n): kh√°ch h√†ng.<br>B. habitats (n): m√¥i tr∆∞·ªùng s·ªëng.<br>C. products (n): s·∫£n ph·∫©m.<br>D. disasters (n): th·∫£m h·ªça.</div>
                      <div class="exp-step"><strong>3. T·∫°i sao ch·ªçn A?</strong> M√πa gi·∫£m gi√° (sales season) th√¨ ƒë·ªëi t∆∞·ª£ng b·ªã thu h√∫t ƒë·∫øn trung t√¢m mua s·∫Øm ch·∫Øc ch·∫Øn l√† ng∆∞·ªùi mua h√†ng (customers).</div>`
            },
            {
                id: "2_10", type: "mcq",
                question: "10. We should recycle single-use products instead __________ throwing them away.",
                options: ["A. on", "B. to", "C. of", "D. in"],
                correct: 2,
                exp: `<div class="exp-step"><strong>1. D·ªãch c√¢u:</strong> Ch√∫ng ta n√™n t√°i ch·∫ø c√°c s·∫£n ph·∫©m d√πng m·ªôt l·∫ßn thay v√¨ v·ª©t ch√∫ng ƒëi.</div>
                      <div class="exp-step"><strong>2. Ph√¢n t√≠ch ng·ªØ ph√°p:</strong> C·ª•m t·ª´ c·ªë ƒë·ªãnh (Prepositional phrase).</div>
                      <div class="exp-step"><strong>3. T·∫°i sao ch·ªçn C?</strong> "Instead of + V-ing/Noun" nghƒ©a l√† "thay v√¨ l√†m g√¨ ƒë√≥". ƒê√¢y l√† c·∫•u tr√∫c b·∫Øt bu·ªôc n√™n ch·ªçn gi·ªõi t·ª´ 'of'.</div>`
            },

            // PART III: CIRCLE CORRECT OPTION
            {
                section: "III. Circle the correct option in brackets. (Ki·ªÉm tra Ng·ªØ ph√°p L·ªõp 8/9 - Will vs Hi·ªán t·∫°i ƒë∆°n)",
                id: "3_1", type: "binary",
                question: "1. I _______ it to you as soon as I come home.",
                options: ["send", "will send"],
                correct: 1,
                exp: `<div class="exp-step"><strong>1. D·ªãch c√¢u:</strong> T√¥i s·∫Ω g·ª≠i n√≥ cho b·∫°n ngay khi t√¥i v·ªÅ nh√†.</div>
                      <div class="exp-step"><strong>2. Gi·∫£i th√≠ch ng·ªØ ph√°p:</strong> C·∫•u tr√∫c m·ªánh ƒë·ªÅ th·ªùi gian t∆∞∆°ng lai: T∆∞∆°ng lai ƒë∆°n + As soon as + Hi·ªán t·∫°i ƒë∆°n. Do v·∫ø sau l√† "come" (hi·ªán t·∫°i ƒë∆°n), v·∫ø ch√≠nh ph·∫£i l√† t∆∞∆°ng lai ƒë∆°n "will send".</div>`
            },
            {
                id: "3_2", type: "binary",
                question: "2. You should help her if she _______.",
                options: ["needs", "will need"],
                correct: 0,
                exp: `<div class="exp-step"><strong>1. D·ªãch c√¢u:</strong> B·∫°n n√™n gi√∫p c√¥ ·∫•y n·∫øu c√¥ ·∫•y c·∫ßn.</div>
                      <div class="exp-step"><strong>2. Gi·∫£i th√≠ch ng·ªØ ph√°p:</strong> C√¢u ƒëi·ªÅu ki·ªán lo·∫°i 1: If + S + V(hi·ªán t·∫°i ƒë∆°n), S + can/should/will + V(nguy√™n th·ªÉ). Sau 'If' kh√¥ng d√πng 'will' trong tr∆∞·ªùng h·ª£p n√†y, n√™n ch·ªçn 'needs'.</div>`
            },
            {
                id: "3_3", type: "binary",
                question: "3. They _______ to England to visit their aunt next year.",
                options: ["go", "will go"],
                correct: 1,
                exp: `<div class="exp-step"><strong>1. D·ªãch c√¢u:</strong> H·ªç s·∫Ω t·ªõi Anh ƒë·ªÉ thƒÉm d√¨ c·ªßa h·ªç v√†o nƒÉm sau.</div>
                      <div class="exp-step"><strong>2. Gi·∫£i th√≠ch ng·ªØ ph√°p:</strong> D·∫•u hi·ªáu "next year" (nƒÉm sau) ch·ªâ s·ª± vi·ªác trong t∆∞∆°ng lai, n√™n d√πng th√¨ T∆∞∆°ng lai ƒë∆°n "will go".</div>`
            },
            {
                id: "3_4", type: "binary",
                question: "4. The side effects of the drug _______ not always predictable.",
                options: ["are", "will be"],
                correct: 0,
                exp: `<div class="exp-step"><strong>1. D·ªãch c√¢u:</strong> C√°c t√°c d·ª•ng ph·ª• c·ªßa thu·ªëc th√¨ kh√¥ng ph·∫£i l√∫c n√†o c≈©ng c√≥ th·ªÉ ƒëo√°n tr∆∞·ªõc ƒë∆∞·ª£c.</div>
                      <div class="exp-step"><strong>2. Gi·∫£i th√≠ch ng·ªØ ph√°p:</strong> ƒê√¢y l√† m·ªôt s·ª± th·∫≠t hi·ªÉn nhi√™n, m·ªôt t√≠nh ch·∫•t chung c·ªßa thu·ªëc men, n√™n ta d√πng th√¨ Hi·ªán t·∫°i ƒë∆°n "are".</div>`
            },
            {
                id: "3_5", type: "binary",
                question: "5. Our shop _______ at 8 o‚Äôclock every day.",
                options: ["opens", "will open"],
                correct: 0,
                exp: `<div class="exp-step"><strong>1. D·ªãch c√¢u:</strong> C·ª≠a h√†ng c·ªßa ch√∫ng t√¥i m·ªü c·ª≠a l√∫c 8 gi·ªù m·ªói ng√†y.</div>
                      <div class="exp-step"><strong>2. Gi·∫£i th√≠ch ng·ªØ ph√°p:</strong> "Every day" ch·ªâ m·ªôt l·ªãch tr√¨nh, th√≥i quen l·∫∑p ƒëi l·∫∑p l·∫°i. V·ªõi l·ªãch tr√¨nh t√†u xe, m·ªü c·ª≠a h√†ng, ta lu√¥n d√πng Hi·ªán t·∫°i ƒë∆°n "opens".</div>`
            },
            {
                id: "3_6", type: "binary",
                question: "6. She _______ weight if she eats lots of fried food.",
                options: ["gain", "will gain"],
                correct: 1,
                exp: `<div class="exp-step"><strong>1. D·ªãch c√¢u:</strong> C√¥ ·∫•y s·∫Ω tƒÉng c√¢n n·∫øu c√¥ ·∫•y ƒÉn nhi·ªÅu th·ª©c ƒÉn chi√™n r√°n.</div>
                      <div class="exp-step"><strong>2. Gi·∫£i th√≠ch ng·ªØ ph√°p:</strong> C√¢u ƒëi·ªÅu ki·ªán lo·∫°i 1 di·ªÖn t·∫£ s·ª± vi·ªác c√≥ th·ªÉ x·∫£y ra ·ªü hi·ªán t·∫°i ho·∫∑c t∆∞∆°ng lai. M·ªánh ƒë·ªÅ ch√≠nh (kh√¥ng ch·ª©a If) ph·∫£i d√πng th√¨ t∆∞∆°ng lai "will gain".</div>`
            },
            {
                id: "3_7", type: "binary",
                question: "7. My father often _______ breakfast at home before he goes to work.",
                options: ["has", "will have"],
                correct: 0,
                exp: `<div class="exp-step"><strong>1. D·ªãch c√¢u:</strong> B·ªë t√¥i th∆∞·ªùng ƒÉn s√°ng ·ªü nh√† tr∆∞·ªõc khi ƒëi l√†m.</div>
                      <div class="exp-step"><strong>2. Gi·∫£i th√≠ch ng·ªØ ph√°p:</strong> C√≥ tr·∫°ng t·ª´ ch·ªâ t·∫ßn su·∫•t "often" (th∆∞·ªùng xuy√™n), di·ªÖn t·∫£ th√≥i quen ·ªü hi·ªán t·∫°i -> D√πng th√¨ Hi·ªán t·∫°i ƒë∆°n "has".</div>`
            },
            {
                id: "3_8", type: "binary",
                question: "8. The bus _______ at 7 o‚Äôclock every morning to take students to school.",
                options: ["leaves", "will leave"],
                correct: 0,
                exp: `<div class="exp-step"><strong>1. D·ªãch c√¢u:</strong> Xe bu√Ωt kh·ªüi h√†nh l√∫c 7 gi·ªù m·ªói s√°ng ƒë·ªÉ ƒë∆∞a h·ªçc sinh t·ªõi tr∆∞·ªùng.</div>
                      <div class="exp-step"><strong>2. Gi·∫£i th√≠ch ng·ªØ ph√°p:</strong> Gi·ªëng c√¢u 5, ƒë√¢y l√† l·ªãch tr√¨nh t√†u xe c·ªë ƒë·ªãnh ("every morning"), n√™n ta d√πng th√¨ Hi·ªán t·∫°i ƒë∆°n "leaves".</div>`
            },
            {
                id: "3_9", type: "binary",
                question: "9. I _______ a big cake on your birthday next week.",
                options: ["make", "will make"],
                correct: 1,
                exp: `<div class="exp-step"><strong>1. D·ªãch c√¢u:</strong> M√¨nh s·∫Ω l√†m m·ªôt chi·∫øc b√°nh l·ªõn v√†o sinh nh·∫≠t c·∫≠u tu·∫ßn t·ªõi.</div>
                      <div class="exp-step"><strong>2. Gi·∫£i th√≠ch ng·ªØ ph√°p:</strong> D·∫•u hi·ªáu "next week" (tu·∫ßn t·ªõi) ch·ªâ m·ªôt h√†nh ƒë·ªông s·∫Ω x·∫£y ra trong t∆∞∆°ng lai. D√πng T∆∞∆°ng lai ƒë∆°n "will make".</div>`
            },
            {
                id: "3_10", type: "binary",
                question: "10. We are allowed to go when the traffic lights _______ green.",
                options: ["turn", "will turn"],
                correct: 0,
                exp: `<div class="exp-step"><strong>1. D·ªãch c√¢u:</strong> Ch√∫ng ta ƒë∆∞·ª£c ph√©p ƒëi khi ƒë√®n giao th√¥ng chuy·ªÉn sang m√†u xanh.</div>
                      <div class="exp-step"><strong>2. Gi·∫£i th√≠ch ng·ªØ ph√°p:</strong> M·ªánh ƒë·ªÅ ch·ªâ th·ªùi gian b·∫Øt ƒë·∫ßu b·∫±ng "when" (khi n√†o) kh√¥ng d√πng th√¨ T∆∞∆°ng lai ƒë∆°n, m√† d√πng Hi·ªán t·∫°i ƒë∆°n ƒë·ªÉ ch·ªâ t∆∞∆°ng lai. N√™n ch·ªçn "turn".</div>`
            },

            // PART IV: FIND CORRECTION
            {
                section: "IV. Choose the part that needs correction. (T√¨m l·ªói sai)",
                id: "4_1", type: "mcq",
                question: "1. I <u>did</u> my homework <u>at 8 o‚Äôclock last night</u>.",
                options: ["A. did", "B. my", "C. at 8 o'clock", "D. last night"],
                correct: 0,
                exp: `<div class="exp-step"><strong>1. D·ªãch c√¢u:</strong> T√¥i ƒëang l√†m b√†i t·∫≠p v·ªÅ nh√† v√†o l√∫c 8 gi·ªù t·ªëi qua.</div>
                      <div class="exp-step"><strong>2. Ph√¢n t√≠ch l·ªói sai:</strong> C√≥ m·ªëc th·ªùi gian c·ª• th·ªÉ trong qu√° kh·ª© ("at 8 o'clock last night") -> Ph·∫£i d√πng th√¨ Qu√° kh·ª© ti·∫øp di·ªÖn (Past Continuous).</div>
                      <div class="exp-step"><strong>3. S·ª≠a l·ªói:</strong> 'did' -> 'was doing'.</div>`
            },
            {
                id: "4_2", type: "mcq",
                question: "2. Your <u>health</u> <u>will to get</u> <u>bad</u> if you <u>work</u> too hard.",
                options: ["A. health", "B. will to get", "C. bad", "D. work"],
                correct: 1,
                exp: `<div class="exp-step"><strong>1. D·ªãch c√¢u:</strong> S·ª©c kh·ªèe c·ªßa b·∫°n s·∫Ω tr·ªü n√™n t·ªìi t·ªá n·∫øu b·∫°n l√†m vi·ªác qu√° s·ª©c.</div>
                      <div class="exp-step"><strong>2. Ph√¢n t√≠ch l·ªói sai:</strong> ƒê·ªông t·ª´ khuy·∫øt thi·∫øu "will" lu√¥n c·ªông v·ªõi ƒë·ªông t·ª´ nguy√™n th·ªÉ KH√îNG "to" (will + V-infinitive).</div>
                      <div class="exp-step"><strong>3. S·ª≠a l·ªói:</strong> 'will to get' -> 'will get'.</div>`
            },
            {
                id: "4_3", type: "mcq",
                question: "3. One of <u>the most</u> difficult <u>decisions</u> is <u>choose</u> a job <u>for a living</u>.",
                options: ["A. the most", "B. decisions", "C. choose", "D. for a living"],
                correct: 2,
                exp: `<div class="exp-step"><strong>1. D·ªãch c√¢u:</strong> M·ªôt trong nh·ªØng quy·∫øt ƒë·ªãnh kh√≥ khƒÉn nh·∫•t l√† ch·ªçn m·ªôt c√¥ng vi·ªác ƒë·ªÉ m∆∞u sinh.</div>
                      <div class="exp-step"><strong>2. Ph√¢n t√≠ch l·ªói sai:</strong> ƒê·ª©ng sau ƒë·ªông t·ª´ to-be "is" ƒë·ªÉ ƒë√≥ng vai tr√≤ l√†m b·ªï ng·ªØ cho ch·ªß ng·ªØ (vi·ªác l√† vi·ªác g√¨), ƒë·ªông t·ª´ ph·∫£i ·ªü d·∫°ng V-ing ho·∫∑c To V.</div>
                      <div class="exp-step"><strong>3. S·ª≠a l·ªói:</strong> 'choose' -> 'choosing' / 'to choose'.</div>`
            },
            {
                id: "4_4", type: "mcq",
                question: "4. You can <u>save</u> energy by <u>turning</u> off lights and <u>use</u> public <u>transport</u>.",
                options: ["A. save", "B. turning", "C. use", "D. transport"],
                correct: 2,
                exp: `<div class="exp-step"><strong>1. D·ªãch c√¢u:</strong> B·∫°n c√≥ th·ªÉ ti·∫øt ki·ªám nƒÉng l∆∞·ª£ng b·∫±ng c√°ch t·∫Øt ƒë√®n v√† s·ª≠ d·ª•ng ph∆∞∆°ng ti·ªán c√¥ng c·ªông.</div>
                      <div class="exp-step"><strong>2. Ph√¢n t√≠ch l·ªói sai:</strong> C·∫•u tr√∫c song song v·ªõi li√™n t·ª´ "and". Tr∆∞·ªõc "and" l√† V-ing ("turning"), th√¨ sau "and" c≈©ng ph·∫£i l√† V-ing.</div>
                      <div class="exp-step"><strong>3. S·ª≠a l·ªói:</strong> 'use' -> 'using'.</div>`
            },
            {
                id: "4_5", type: "mcq",
                question: "5. <u>Should</u> we delay the party <u>because</u> nobody can <u>coming</u> <u>that day</u>?",
                options: ["A. Should", "B. because", "C. coming", "D. that day"],
                correct: 2,
                exp: `<div class="exp-step"><strong>1. D·ªãch c√¢u:</strong> Ch√∫ng ta c√≥ n√™n ho√£n b·ªØa ti·ªác v√¨ kh√¥ng ai c√≥ th·ªÉ ƒë·∫øn v√†o ng√†y h√¥m ƒë√≥ kh√¥ng?</div>
                      <div class="exp-step"><strong>2. Ph√¢n t√≠ch l·ªói sai:</strong> "Can" l√† ƒë·ªông t·ª´ khuy·∫øt thi·∫øu (modal verb), theo sau n√≥ ph·∫£i l√† ƒë·ªông t·ª´ nguy√™n th·ªÉ kh√¥ng "to".</div>
                      <div class="exp-step"><strong>3. S·ª≠a l·ªói:</strong> 'coming' -> 'come'.</div>`
            },
            {
                id: "4_6", type: "mcq",
                question: "6. <u>There were</u> a <u>terrible</u> thunderstorm <u>yesterday</u> <u>evening</u>.",
                options: ["A. There were", "B. terrible", "C. yesterday", "D. evening"],
                correct: 0,
                exp: `<div class="exp-step"><strong>1. D·ªãch c√¢u:</strong> C√≥ m·ªôt tr·∫≠n b√£o s·∫•m s√©t t·ªìi t·ªá v√†o t·ªëi qua.</div>
                      <div class="exp-step"><strong>2. Ph√¢n t√≠ch l·ªói sai:</strong> Danh t·ª´ theo sau l√† "a thunderstorm" (danh t·ª´ s·ªë √≠t ƒë·∫øm ƒë∆∞·ª£c), do ƒë√≥ ƒë·ªông t·ª´ to-be ph·∫£i chia ·ªü s·ªë √≠t.</div>
                      <div class="exp-step"><strong>3. S·ª≠a l·ªói:</strong> 'There were' -> 'There was'.</div>`
            },
            {
                id: "4_7", type: "mcq",
                question: "7. <u>Humans</u> need a <u>constancy</u> supply <u>of water</u> to <u>live</u>.",
                options: ["A. Humans", "B. constancy", "C. of water", "D. live"],
                correct: 1,
                exp: `<div class="exp-step"><strong>1. D·ªãch c√¢u:</strong> Con ng∆∞·ªùi c·∫ßn m·ªôt ngu·ªìn cung c·∫•p n∆∞·ªõc li√™n t·ª•c ƒë·ªÉ s·ªëng.</div>
                      <div class="exp-step"><strong>2. Ph√¢n t√≠ch l·ªói sai:</strong> ƒê·ª©ng tr∆∞·ªõc danh t·ª´ "supply" c·∫ßn m·ªôt t√≠nh t·ª´ ƒë·ªÉ b·ªï nghƒ©a. "Constancy" ƒëang l√† danh t·ª´ (s·ª± ki√™n ƒë·ªãnh, s·ª± kh√¥ng thay ƒë·ªïi).</div>
                      <div class="exp-step"><strong>3. S·ª≠a l·ªói:</strong> 'constancy' (N) -> 'constant' (Adj).</div>`
            },
            {
                id: "4_8", type: "mcq",
                question: "8. The storm <u>sudden</u> <u>hit</u> and <u>destroyed</u> the <u>whole</u> village.",
                options: ["A. sudden", "B. hit", "C. destroyed", "D. whole"],
                correct: 0,
                exp: `<div class="exp-step"><strong>1. D·ªãch c√¢u:</strong> C∆°n b√£o b·∫•t ng·ªù ·∫≠p ƒë·∫øn v√† ph√° h·ªßy to√†n b·ªô ng√¥i l√†ng.</div>
                      <div class="exp-step"><strong>2. Ph√¢n t√≠ch l·ªói sai:</strong> B·ªï nghƒ©a cho ƒë·ªông t·ª´ th∆∞·ªùng "hit" (·∫≠p ƒë·∫øn) c·∫ßn m·ªôt tr·∫°ng t·ª´ (Adverb), kh√¥ng ph·∫£i t√≠nh t·ª´ (Adjective).</div>
                      <div class="exp-step"><strong>3. S·ª≠a l·ªói:</strong> 'sudden' (Adj) -> 'suddenly' (Adv).</div>`
            },
            {
                id: "4_9", type: "mcq",
                question: "9. They <u>buy</u> a house <u>near</u> the <u>beach</u> last <u>summer</u>.",
                options: ["A. buy", "B. near", "C. beach", "D. summer"],
                correct: 0,
                exp: `<div class="exp-step"><strong>1. D·ªãch c√¢u:</strong> H·ªç ƒë√£ mua m·ªôt ng√¥i nh√† g·∫ßn b√£i bi·ªÉn v√†o m√πa h√® nƒÉm ngo√°i.</div>
                      <div class="exp-step"><strong>2. Ph√¢n t√≠ch l·ªói sai:</strong> Tr·∫°ng t·ª´ ch·ªâ th·ªùi gian "last summer" (m√πa h√® tr∆∞·ªõc) y√™u c·∫ßu s·ª≠ d·ª•ng th√¨ Qu√° kh·ª© ƒë∆°n. ƒê·ªông t·ª´ "buy" ƒëang chia ·ªü hi·ªán t·∫°i.</div>
                      <div class="exp-step"><strong>3. S·ª≠a l·ªói:</strong> 'buy' -> 'bought'.</div>`
            },
            {
                id: "4_10", type: "mcq",
                question: "10. <u>Were</u> the children <u>studying</u> <u>at school</u> <u>in this time</u> yesterday?",
                options: ["A. Were", "B. studying", "C. at school", "D. in this time"],
                correct: 3,
                exp: `<div class="exp-step"><strong>1. D·ªãch c√¢u:</strong> C√°c ƒë·ª©a tr·∫ª c√≥ ƒëang h·ªçc ·ªü tr∆∞·ªùng v√†o gi·ªù n√†y ng√†y h√¥m qua kh√¥ng?</div>
                      <div class="exp-step"><strong>2. Ph√¢n t√≠ch l·ªói sai:</strong> C·ª•m gi·ªõi t·ª´ ch·ªâ th·ªùi gian "v√†o th·ªùi ƒëi·ªÉm n√†y" trong ti·∫øng Anh chu·∫©n l√† "at this time", kh√¥ng d√πng "in this time".</div>
                      <div class="exp-step"><strong>3. S·ª≠a l·ªói:</strong> 'in this time' -> 'at this time'.</div>`
            },

            // PART VIII: SENTENCE BUILDING (Drag/Drop style implemented as Jumbled Words)
            {
                section: "VIII. Write complete sentences using the given words and phrases. (S·∫Øp x·∫øp t·ª´ ƒë·ªÉ t·∫°o th√†nh c√¢u)",
                id: "8_1", type: "jumble",
                question: "1. be / your sister / addict / shop / ?",
                words: ["Is", "your", "sister", "a", "shop", "addict", "?"],
                correctStr: "Is your sister a shop addict ?",
                exp: `<div class="exp-step"><strong>1. D·ªãch c√¢u:</strong> Ch·ªã c·ªßa b·∫°n c√≥ ph·∫£i l√† m·ªôt ng∆∞·ªùi nghi·ªán mua s·∫Øm kh√¥ng?</div>
                      <div class="exp-step"><strong>2. Ph√¢n t√≠ch c·∫•u tr√∫c:</strong> C√¢u h·ªèi Yes/No v·ªõi ƒë·ªông t·ª´ To-be ƒë∆∞a l√™n ƒë·∫ßu. C·ª•m t·ª´ "shop addict" (ng∆∞·ªùi nghi·ªán mua s·∫Øm) c·∫ßn m·∫°o t·ª´ "a" ph√≠a tr∆∞·ªõc do l√† danh t·ª´ ƒë·∫øm ƒë∆∞·ª£c s·ªë √≠t.</div>`
            },
            {
                id: "8_2", type: "jumble",
                question: "2. We / can‚Äôt / bargain / prices of goods / supermarkets/.",
                words: ["We", "can't", "bargain", "over", "prices", "of", "goods", "in", "supermarkets", "."],
                correctStr: "We can't bargain over prices of goods in supermarkets .",
                exp: `<div class="exp-step"><strong>1. D·ªãch c√¢u:</strong> Ch√∫ng ta kh√¥ng th·ªÉ m·∫∑c c·∫£ gi√° c·ªßa h√†ng h√≥a trong si√™u th·ªã.</div>
                      <div class="exp-step"><strong>2. Ph√¢n t√≠ch c·∫•u tr√∫c:</strong> C·ª•m "bargain over something" (m·∫∑c c·∫£ v·ªÅ c√°i g√¨). Ch·ªâ ƒë·ªãa ƒëi·ªÉm "supermarkets" d√πng gi·ªõi t·ª´ "in".</div>`
            },
            {
                id: "8_3", type: "jumble",
                question: "3. What / you / do / 9 o‚Äôclock yesterday morning / ?",
                words: ["What", "were", "you", "doing", "at", "9 o'clock", "yesterday", "morning", "?"],
                correctStr: "What were you doing at 9 o'clock yesterday morning ?",
                exp: `<div class="exp-step"><strong>1. D·ªãch c√¢u:</strong> B·∫°n ƒëang l√†m g√¨ l√∫c 9 gi·ªù s√°ng ng√†y h√¥m qua?</div>
                      <div class="exp-step"><strong>2. Ph√¢n t√≠ch c·∫•u tr√∫c:</strong> C√≥ m·ªëc th·ªùi gian c·ª• th·ªÉ trong qu√° kh·ª© -> D√πng th√¨ Qu√° kh·ª© ti·∫øp di·ªÖn. C·∫•u tr√∫c c√¢u h·ªèi: Wh-word + was/were + S + V-ing? Th√™m gi·ªõi t·ª´ "at" tr∆∞·ªõc gi·ªù.</div>`
            },
            {
                id: "8_4", type: "jumble",
                question: "4. residents / tall buildings / be frightened / when / they / fell / slight shaking /.",
                words: ["The", "residents", "of", "tall", "buildings", "were", "frightened", "when", "they", "felt", "a", "slight", "shaking", "."],
                correctStr: "The residents of tall buildings were frightened when they felt a slight shaking .",
                exp: `<div class="exp-step"><strong>1. D·ªãch c√¢u:</strong> C∆∞ d√¢n c·ªßa c√°c t√≤a nh√† cao t·∫ßng ƒë√£ ho·∫£ng s·ª£ khi h·ªç c·∫£m nh·∫≠n th·∫•y m·ªôt s·ª± rung l·∫Øc nh·∫π.</div>
                      <div class="exp-step"><strong>2. Ph√¢n t√≠ch:</strong> Th√™m m·∫°o t·ª´ "The" tr∆∞·ªõc ch·ªß ng·ªØ x√°c ƒë·ªãnh, gi·ªõi t·ª´ "of" (c·ªßa). ƒê·ªïi 'fell' (r∆°i - ƒë·ªÅ b√†i g√µ sai) th√†nh 'felt' (c·∫£m th·∫•y). Th√™m m·∫°o t·ª´ "a" tr∆∞·ªõc c·ª•m danh t·ª´ ƒë·∫øm ƒë∆∞·ª£c "slight shaking".</div>`
            },
            {
                id: "8_5", type: "jumble",
                question: "5. When / natural disaster / happen, / we / must / listen / instruction from local authorities /.",
                words: ["When", "a", "natural", "disaster", "happens", ",", "we", "must", "listen", "to", "instructions", "from", "local", "authorities", "."],
                correctStr: "When a natural disaster happens , we must listen to instructions from local authorities .",
                exp: `<div class="exp-step"><strong>1. D·ªãch c√¢u:</strong> Khi m·ªôt th·∫£m h·ªça thi√™n nhi√™n x·∫£y ra, ch√∫ng ta ph·∫£i l·∫Øng nghe ch·ªâ d·∫´n t·ª´ ch√≠nh quy·ªÅn ƒë·ªãa ph∆∞∆°ng.</div>
                      <div class="exp-step"><strong>2. Ph√¢n t√≠ch:</strong> Th√™m "a" tr∆∞·ªõc natural disaster v√† chia ƒë·ªông t·ª´ "happens" (s·ªë √≠t). "Listen" ph·∫£i ƒëi v·ªõi gi·ªõi t·ª´ "to". Th√™m 's' v√†o "instructions" v√¨ l√† danh t·ª´ ƒë·∫øm ƒë∆∞·ª£c ch·ªâ s·ªë nhi·ªÅu chung chung.</div>`
            },
            {
                id: "8_6", type: "jumble",
                question: "6. One disadvantage / shop online / be / that / you / not know exactly / what / you / get /.",
                words: ["One", "disadvantage", "of", "shopping", "online", "is", "that", "you", "don't", "know", "exactly", "what", "you", "will", "get", "."],
                correctStr: "One disadvantage of shopping online is that you don't know exactly what you will get .",
                exp: `<div class="exp-step"><strong>1. D·ªãch c√¢u:</strong> M·ªôt b·∫•t l·ª£i c·ªßa vi·ªác mua s·∫Øm tr·ª±c tuy·∫øn l√† b·∫°n kh√¥ng bi·∫øt ch√≠nh x√°c m√¨nh s·∫Ω nh·∫≠n ƒë∆∞·ª£c g√¨.</div>
                      <div class="exp-step"><strong>2. Ph√¢n t√≠ch:</strong> C·∫•u tr√∫c "disadvantage of V-ing" (b·∫•t l·ª£i c·ªßa vi·ªác g√¨). Chia ƒë·ªông t·ª´ to-be l√† "is". Ph·ªß ƒë·ªãnh ·ªü hi·ªán t·∫°i d√πng "don't know". M·ªánh ƒë·ªÅ sau 'what' di·ªÖn t·∫£ t∆∞∆°ng lai n√™n d√πng "will get".</div>`
            }
        ];

        // √Çm thanh
        const playAudio = (type) => {
            const ctx = new (window.AudioContext || window.webkitAudioContext)();
            const osc = ctx.createOscillator();
            const gain = ctx.createGain();
            osc.connect(gain);
            gain.connect(ctx.destination);
            
            if (type === 'correct') {
                osc.type = 'sine';
                osc.frequency.setValueAtTime(880, ctx.currentTime);
                osc.frequency.exponentialRampToValueAtTime(1760, ctx.currentTime + 0.1);
                gain.gain.setValueAtTime(0.5, ctx.currentTime);
                gain.gain.exponentialRampToValueAtTime(0.01, ctx.currentTime + 0.3);
                osc.start(); osc.stop(ctx.currentTime + 0.3);
            } else {
                osc.type = 'sawtooth';
                osc.frequency.setValueAtTime(150, ctx.currentTime);
                osc.frequency.exponentialRampToValueAtTime(100, ctx.currentTime + 0.2);
                gain.gain.setValueAtTime(0.5, ctx.currentTime);
                gain.gain.exponentialRampToValueAtTime(0.01, ctx.currentTime + 0.3);
                osc.start(); osc.stop(ctx.currentTime + 0.3);
            }
        };

        // H√†m x√°o tr·ªôn m·∫£ng
        const shuffle = (array) => {
            for (let i = array.length - 1; i > 0; i--) {
                const j = Math.floor(Math.random() * (i + 1));
                [array[i], array[j]] = [array[j], array[i]];
            }
            return array;
        };

        let score = 0;
        let answeredQuestions = new Set();
        const totalScore = quizData.length + 6; // C·ªông 6 c√¢u ph·∫ßn V

        // Render Quiz
        const app = document.getElementById('app');
        let currentSection = "";

        quizData.forEach((item, index) => {
            if (item.section && item.section !== currentSection) {
                app.innerHTML += `<div class="section-title">${item.section}</div>`;
                currentSection = item.section;
            }

            const card = document.createElement('div');
            card.className = 'card';
            card.id = `card_${item.id}`;

            let contentHTML = `<div class="question-text">${item.question}</div>`;

            if (item.type === 'mcq') {
                // X√°o tr·ªôn ƒë√°p √°n m√† v·∫´n gi·ªØ ƒë√∫ng logic
                let optionsData = item.options.map((opt, i) => ({ text: opt, isCorrect: i === item.correct }));
                optionsData = shuffle(optionsData);
                
                contentHTML += `<div class="options-grid">`;
                optionsData.forEach((opt) => {
                    contentHTML += `<button class="btn-option" onclick="handleMCQ(this, '${item.id}', ${opt.isCorrect})">${opt.text}</button>`;
                });
                contentHTML += `</div>`;
            } else if (item.type === 'binary') {
                let optionsData = item.options.map((opt, i) => ({ text: opt, isCorrect: i === item.correct }));
                contentHTML += `<div class="options-grid">`;
                optionsData.forEach((opt) => {
                    contentHTML += `<button class="btn-option" style="text-align: center; justify-content: center;" onclick="handleMCQ(this, '${item.id}', ${opt.isCorrect})">${opt.text}</button>`;
                });
                contentHTML += `</div>`;
            } else if (item.type === 'jumble') {
                let shuffledWords = shuffle([...item.words]);
                contentHTML += `
                    <div class="answer-slot" id="slot_${item.id}" onclick="returnWord('${item.id}', event)"></div>
                    <div class="word-bank" id="bank_${item.id}">
                        ${shuffledWords.map(w => `<div class="word-piece" onclick="moveWord(this, '${item.id}')">${w}</div>`).join('')}
                    </div>
                    <button class="submit-btn" style="margin: 10px 0; padding: 10px; font-size: 1.1rem; background: #00C9A7; box-shadow: 0 5px 0 #008f76" onclick="checkJumble('${item.id}', '${item.correctStr.replace(/'/g, "\\'")}')">Ki·ªÉm Tra C√¢u</button>
                `;
            }

            contentHTML += `<div class="explanation" id="exp_${item.id}">${item.exp}</div>`;
            card.innerHTML = contentHTML;
            app.appendChild(card);
        });

        // --- Render Ph·∫ßn V (Dialogue Gap Fill) ---
        app.innerHTML += `<div class="section-title">V. Complete the dialogue with the sentences from the box.</div>`;
        const dialogueHTML = `
            <div class="card">
                <div class="question-text">Ch·ªçn c√¢u ph√π h·ª£p ƒëi·ªÅn v√†o ƒëo·∫°n h·ªôi tho·∫°i:</div>
                <div style="background: #fff3cd; padding: 15px; border-radius: 10px; margin-bottom: 15px; font-weight: bold; border: 2px solid #ffe69c;">
                    A. I‚Äôm very sorry about that.<br>
                    B. I‚Äôd like a full refund, please.<br>
                    C. I‚Äôm afraid I can‚Äôt help you without the receipt.<br>
                    D. I understand that.<br>
                    E. Do you have the receipt?<br>
                    F. What‚Äôs the matter with it, sir?
                </div>
                <div class="dialogue-box">
                    <p><b>Customer:</b> Hello, I‚Äôd like to make a complaint about the cell phone that I bought last month.</p>
                    <div class="dialogue-line"><b>Manager:</b> (1) <select id="d1" onchange="checkDialogue(this, 'F')"><option value="">-- Ch·ªçn --</option><option value="A">A</option><option value="B">B</option><option value="C">C</option><option value="D">D</option><option value="E">E</option><option value="F">F</option></select></div>
                    <p><b>Customer:</b> The screen doesn't work.</p>
                    <div class="dialogue-line"><b>Manager:</b> (2) <select id="d2" onchange="checkDialogue(this, 'A')"><option value="">-- Ch·ªçn --</option><option value="A">A</option><option value="B">B</option><option value="C">C</option><option value="D">D</option><option value="E">E</option><option value="F">F</option></select> Can I offer you a full refund or an exchange?</div>
                    <div class="dialogue-line"><b>Customer:</b> (3) <select id="d3" onchange="checkDialogue(this, 'B')"><option value="">-- Ch·ªçn --</option><option value="A">A</option><option value="B">B</option><option value="C">C</option><option value="D">D</option><option value="E">E</option><option value="F">F</option></select></div>
                    <div class="dialogue-line"><b>Manager:</b> No problem. (4) <select id="d4" onchange="checkDialogue(this, 'E')"><option value="">-- Ch·ªçn --</option><option value="A">A</option><option value="B">B</option><option value="C">C</option><option value="D">D</option><option value="E">E</option><option value="F">F</option></select></div>
                    <p><b>Customer:</b> Oh, sorry. I lost it.</p>
                    <div class="dialogue-line"><b>Manager:</b> (5) <select id="d5" onchange="checkDialogue(this, 'C')"><option value="">-- Ch·ªçn --</option><option value="A">A</option><option value="B">B</option><option value="C">C</option><option value="D">D</option><option value="E">E</option><option value="F">F</option></select></div>
                    <p><b>Customer:</b> I know, but the phone was very expensive and now I can't use it.</p>
                    <div class="dialogue-line"><b>Manager:</b> (6) <select id="d6" onchange="checkDialogue(this, 'D')"><option value="">-- Ch·ªçn --</option><option value="A">A</option><option value="B">B</option><option value="C">C</option><option value="D">D</option><option value="E">E</option><option value="F">F</option></select> You can get it repaired. There‚Äôs a repair shop near our shop.</p>
                    <p><b>Customer:</b> Thanks.</p>
                </div>
                <div class="explanation" id="exp_dialogue">
                    <div class="exp-step"><strong>Gi·∫£i th√≠ch chi ti·∫øt ƒëo·∫°n h·ªôi tho·∫°i:</strong></div>
                    <div class="exp-step"><strong>(1) F:</strong> Kh√°ch than phi·ªÅn v·ªÅ ƒëi·ªán tho·∫°i, qu·∫£n l√Ω ph·∫£i h·ªèi v·∫•n ƒë·ªÅ l√† g√¨ ("What's the matter with it, sir?").</div>
                    <div class="exp-step"><strong>(2) A:</strong> Kh√°ch n√≥i m√†n h√¨nh h·ªèng. Qu·∫£n l√Ω xin l·ªói ("I'm very sorry about that").</div>
                    <div class="exp-step"><strong>(3) B:</strong> Qu·∫£n l√Ω h·ªèi mu·ªën ho√†n ti·ªÅn hay ƒë·ªïi tr·∫£. Kh√°ch ch·ªçn ho√†n ti·ªÅn ("I'd like a full refund, please").</div>
                    <div class="exp-step"><strong>(4) E:</strong> ƒê·ªÉ ho√†n ti·ªÅn th√¨ c·∫ßn bi√™n lai, n√™n qu·∫£n l√Ω h·ªèi ("Do you have the receipt?").</div>
                    <div class="exp-step"><strong>(5) C:</strong> Kh√°ch l√†m m·∫•t bi√™n lai, qu·∫£n l√Ω t·ª´ ch·ªëi kh√©o ("I'm afraid I can't help you without the receipt").</div>
                    <div class="exp-step"><strong>(6) D:</strong> Kh√°ch n√†i n·ªâ v√¨ m√°y ƒë·∫Øt. Qu·∫£n l√Ω th·ªÉ hi·ªán s·ª± th·∫•u hi·ªÉu ("I understand that") nh∆∞ng v·∫´n t∆∞ v·∫•n ƒëem ƒëi s·ª≠a.</div>
                </div>
            </div>`;
        app.innerHTML += dialogueHTML;


        // --- LOGIC X·ª¨ L√ù ---
        function handleMCQ(btn, id, isCorrect) {
            if (answeredQuestions.has(id)) return; // Ch·ªâ cho l√†m 1 l·∫ßn
            answeredQuestions.add(id);

            const card = document.getElementById(`card_${id}`);
            const buttons = card.querySelectorAll('.btn-option');
            buttons.forEach(b => b.style.pointerEvents = 'none'); // Kh√≥a c√°c n√∫t kh√°c

            if (isCorrect) {
                btn.classList.add('correct');
                playAudio('correct');
                confetti({ particleCount: 50, spread: 60, origin: { y: 0.8 }, colors: ['#00D26A', '#FF9F43', '#8854C0'] });
                score++;
            } else {
                btn.classList.add('incorrect');
                playAudio('wrong');
                // Hi·ªÉn th·ªã ƒë√°p √°n ƒë√∫ng
                buttons.forEach(b => {
                    if(b.onclick.toString().includes('true')) b.classList.add('correct');
                });
            }

            document.getElementById(`exp_${id}`).classList.add('show');
        }

        // Logic Duolingo Jumbled words
        function moveWord(element, id) {
            const slot = document.getElementById(`slot_${id}`);
            slot.appendChild(element);
        }

        function returnWord(id, event) {
            if (event.target.classList.contains('word-piece')) {
                const bank = document.getElementById(`bank_${id}`);
                bank.appendChild(event.target);
            }
        }

        function checkJumble(id, correctStr) {
            if (answeredQuestions.has(id)) return;
            
            const slot = document.getElementById(`slot_${id}`);
            const userWords = Array.from(slot.children).map(el => el.innerText);
            const userStr = userWords.join(' ');
            
            if (userWords.length === 0) {
                Swal.fire({ icon: 'warning', title: 'Oops...', text: 'B·∫°n ch∆∞a gh√©p ch·ªØ n√†o k√¨a!' });
                return;
            }

            answeredQuestions.add(id);
            const isCorrect = userStr.trim() === correctStr.trim();

            if (isCorrect) {
                slot.style.borderColor = '#00D26A';
                slot.style.backgroundColor = '#e8f5e9';
                playAudio('correct');
                confetti();
                score++;
            } else {
                slot.style.borderColor = '#FF4757';
                slot.style.backgroundColor = '#ffebee';
                slot.classList.add('shake');
                setTimeout(() => slot.classList.remove('shake'), 400);
                playAudio('wrong');
                
                // Show correct string physically
                const correctDiv = document.createElement('div');
                correctDiv.innerHTML = `<strong>ƒê√°p √°n ƒë√∫ng:</strong> ${correctStr}`;
                correctDiv.style.color = '#FF4757';
                correctDiv.style.marginTop = '10px';
                slot.parentNode.insertBefore(correctDiv, slot.nextSibling);
            }

            document.getElementById(`exp_${id}`).classList.add('show');
            document.getElementById(`bank_${id}`).style.display = 'none'; // ·∫®n bank
            event.target.style.display = 'none'; // ·∫®n n√∫t check
        }

        // Logic Dialogue Dropdown
        let dialogueScoreCounted = 0;
        function checkDialogue(selectElem, correctVal) {
            if (selectElem.disabled) return;
            
            if (selectElem.value === correctVal) {
                selectElem.style.borderColor = '#00D26A';
                selectElem.style.backgroundColor = '#e8f5e9';
                selectElem.disabled = true;
                playAudio('correct');
                score++;
                dialogueScoreCounted++;
            } else {
                selectElem.style.borderColor = '#FF4757';
                selectElem.style.backgroundColor = '#ffebee';
                playAudio('wrong');
                selectElem.value = ""; // Reset cho ch·ªçn l·∫°i (Ho·∫∑c c√≥ th·ªÉ kh√≥a lu√¥n t√πy √Ω, ·ªü ƒë√¢y cho ch·ªçn l·∫°i ƒë·∫øn khi ƒë√∫ng ƒë·ªÉ h·ªçc)
            }

            // Hi·ªán gi·∫£i th√≠ch khi l√†m xong 6 c√¢u
            if (dialogueScoreCounted === 6) {
                document.getElementById('exp_dialogue').classList.add('show');
                confetti();
            }
        }

        // N·ªôp B√†i
        function submitQuiz() {
            const percent = Math.round((score / totalScore) * 100);
            let msg, imgUrl;

            if (percent === 100) {
                msg = "Qu√° xu·∫•t s·∫Øc! Perfect Score! H·ªçc tr√≤ c∆∞ng c·ªßa c√¥ Mai An ƒë√¢y r·ªìi! üèÜ";
                imgUrl = "https://media.giphy.com/media/11sBLVxNs7v6WA/giphy.gif";
            } else if (percent >= 80) {
                msg = "Gi·ªèi l·∫Øm! C·ªë g·∫Øng ch√∫t n·ªØa l√† ƒë·∫°t ƒëi·ªÉm tuy·ªát ƒë·ªëi nh√©! üåü";
                imgUrl = "https://media.giphy.com/media/3o7abKhOpu0NwenH3O/giphy.gif";
            } else if (percent >= 50) {
                msg = "Kh√° t·ªët! ƒê·ªçc k·ªπ ph·∫ßn gi·∫£i th√≠ch chi ti·∫øt ƒë·ªÉ r√∫t kinh nghi·ªám nha! üëç";
                imgUrl = "https://media.giphy.com/media/26hirEPeos6yugLDO/giphy.gif";
            } else {
                msg = "C·∫ßn n·ªó l·ª±c h∆°n n·ªØa nh√©! C√¥ Mai An tin b·∫°n s·∫Ω l√†m t·ªët h∆°n ·ªü l·∫ßn sau! üí™";
                imgUrl = "https://media.giphy.com/media/l41YkxvU8c7J7Bba0/giphy.gif";
            }

            Swal.fire({
                title: 'B·∫£ng ƒêi·ªÉm C·ªßa B·∫°n!',
                html: `<h1>${score} / ${totalScore}</h1><p>${msg}</p>`,
                imageUrl: imgUrl,
                imageWidth: 300,
                imageHeight: 200,
                confirmButtonText: 'L√†m l·∫°i b√†i thi',
                confirmButtonColor: '#8854C0',
                allowOutsideClick: false
            }).then((result) => {
                if (result.isConfirmed) {
                    location.reload();
                }
            });
        }
    </script>
</body>
</html>