<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>B√†i T·∫≠p Gi·ªõi T·ª´ - Ms Mai An ULIS</title>
    <link href="https://fonts.googleapis.com/css2?family=Nunito:wght@400;600;700;800&family=Quicksand:wght@500;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
    <script src="https://cdn.jsdelivr.net/npm/canvas-confetti@1.5.1/dist/confetti.browser.min.js"></script>
    <style>
        :root {
            --primary-pink: #8854C0;
            --primary-teal: #00C9A7;
            --correct-color: #00D26A;
            --wrong-color: #FF4757;
            --bg-color: #f0f4f8;
            --card-bg: #ffffff;
            --text-color: #2d3436;
        }

        body {
            font-family: 'Nunito', sans-serif;
            background-color: var(--bg-color);
            background-image: radial-gradient(#8854C0 1px, transparent 1px), radial-gradient(#00C9A7 1px, transparent 1px);
            background-position: 0 0, 25px 25px;
            background-size: 50px 50px;
            margin: 0;
            padding: 20px;
            color: var(--text-color);
            display: flex;
            justify-content: center;
            min-height: 100vh;
        }

        .container {
            width: 100%;
            max-width: 800px;
            background: transparent;
        }

        /* Header */
        header {
            text-align: center;
            margin-bottom: 30px;
            background: white;
            padding: 15px;
            border-radius: 20px;
            box-shadow: 0 8px 0 rgba(0,0,0,0.1);
            border: 2px solid var(--primary-pink);
        }

        h1 {
            font-family: 'Quicksand', sans-serif;
            color: var(--primary-pink);
            font-size: 1.5rem;
            margin: 0;
            text-transform: uppercase;
            letter-spacing: 1px;
        }
        
        .teacher-name {
            font-size: 0.9rem;
            color: #666;
            margin-top: 5px;
        }

        /* Question Card */
        .quiz-card {
            background: var(--card-bg);
            border-radius: 20px;
            padding: 25px;
            margin-bottom: 25px;
            box-shadow: 0 10px 25px rgba(136, 84, 192, 0.15);
            position: relative;
            transition: transform 0.3s ease;
            border: 1px solid #eee;
        }

        .question-number {
            display: inline-block;
            background: var(--primary-pink);
            color: white;
            padding: 5px 15px;
            border-radius: 15px;
            font-weight: 800;
            font-size: 0.9rem;
            margin-bottom: 15px;
        }

        .question-text {
            font-size: 1.3rem;
            font-weight: 700;
            margin-bottom: 25px;
            line-height: 1.5;
        }

        /* Options Grid */
        .options-grid {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 15px;
        }

        @media (max-width: 600px) {
            .options-grid {
                grid-template-columns: 1fr;
            }
        }

        .option-btn {
            background: white;
            border: 2px solid #e0e0e0;
            border-radius: 15px;
            padding: 15px;
            font-family: 'Nunito', sans-serif;
            font-size: 1.1rem;
            font-weight: 600;
            color: var(--text-color);
            cursor: pointer;
            position: relative;
            transition: all 0.2s;
            box-shadow: 0 5px 0 #dcdcdc;
            text-align: left;
        }

        .option-btn:hover:not(:disabled) {
            transform: scale(1.02);
            border-color: var(--primary-teal);
        }

        .option-btn:active:not(:disabled) {
            transform: translateY(5px);
            box-shadow: 0 0 0 #dcdcdc;
        }

        /* States */
        .option-btn.correct {
            background-color: var(--correct-color);
            color: white;
            border-color: #00a352;
            box-shadow: 0 5px 0 #00a352;
        }

        .option-btn.wrong {
            background-color: var(--wrong-color);
            color: white;
            border-color: #d63031;
            box-shadow: 0 5px 0 #d63031;
            animation: shake 0.5s;
        }

        @keyframes shake {
            0% { transform: translateX(0); }
            25% { transform: translateX(-5px) rotate(-2deg); }
            50% { transform: translateX(5px) rotate(2deg); }
            75% { transform: translateX(-5px) rotate(-2deg); }
            100% { transform: translateX(0); }
        }

        /* Explanation Box */
        .explanation-box {
            display: none; /* Hidden by default */
            margin-top: 25px;
            background: #f8f9fa;
            border-left: 5px solid var(--primary-pink);
            padding: 20px;
            border-radius: 10px;
            animation: slideDown 0.4s ease-out;
        }

        @keyframes slideDown {
            from { opacity: 0; transform: translateY(-10px); }
            to { opacity: 1; transform: translateY(0); }
        }

        .exp-header {
            font-weight: 800;
            color: var(--primary-pink);
            margin-bottom: 10px;
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .exp-content p {
            margin: 8px 0;
            line-height: 1.6;
        }

        .vocab-list {
            background: white;
            padding: 10px;
            border-radius: 8px;
            border: 1px dashed #ccc;
            margin-bottom: 10px;
        }
        
        .vocab-item {
            font-size: 0.95rem;
            color: #444;
        }

        .translation {
            font-style: italic;
            color: #0984e3;
            font-weight: 600;
        }

        .reason-correct {
            color: var(--correct-color);
            font-weight: 700;
        }

        .reason-wrong {
            color: #636e72;
            font-size: 0.9rem;
        }

        /* Special UI: Sale Sign */
        .sale-sign {
            background: #ff4757;
            color: white;
            padding: 15px;
            text-align: center;
            border: 4px dashed white;
            box-shadow: 0 0 0 4px #ff4757;
            border-radius: 10px;
            font-family: 'Arial Black', sans-serif;
            text-transform: uppercase;
            transform: rotate(-2deg);
            margin: 20px auto;
            width: 80%;
        }

        /* Special UI: Phone Message */
        .phone-msg {
            background: #e5e5ea;
            color: black;
            padding: 15px 20px;
            border-radius: 20px;
            border-bottom-left-radius: 5px;
            width: fit-content;
            margin: 20px 0;
            position: relative;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        }
        .phone-msg::before {
            content: "From: Mom";
            position: absolute;
            top: -20px;
            left: 5px;
            font-size: 0.8rem;
            color: #888;
        }

        /* Footer / Submit */
        .footer-controls {
            text-align: center;
            margin-top: 40px;
            padding-bottom: 40px;
        }

        .submit-btn {
            background: var(--primary-teal);
            color: white;
            border: none;
            padding: 15px 40px;
            font-size: 1.2rem;
            font-weight: 800;
            border-radius: 50px;
            box-shadow: 0 8px 0 #009e82;
            cursor: pointer;
            transition: all 0.2s;
        }

        .submit-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 10px 0 #009e82;
        }
        
        .submit-btn:active {
            transform: translateY(5px);
            box-shadow: 0 0 0 #009e82;
        }

        /* Score Modal */
        .modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0,0,0,0.7);
            z-index: 1000;
            justify-content: center;
            align-items: center;
        }

        .modal-content {
            background: white;
            padding: 40px;
            border-radius: 30px;
            text-align: center;
            max-width: 500px;
            animation: zoomIn 0.3s;
        }

        @keyframes zoomIn {
            from { transform: scale(0); }
            to { transform: scale(1); }
        }

        .score-display {
            font-size: 3rem;
            font-weight: 800;
            color: var(--primary-pink);
            margin: 20px 0;
        }
    </style>
</head>
<body>

<div class="container">
    <header>
        <h1>B√ÄI KI·ªÇM TRA GI·ªöI T·ª™: IN - ON - AT - TO</h1>
        <div class="teacher-name"><i class="fas fa-chalkboard-teacher"></i> Gi√°o vi√™n t·∫°o: Ms Mai An ULIS</div>
    </header>

    <div id="quiz-area">
        </div>

    <div class="footer-controls">
        <button class="submit-btn" onclick="submitQuiz()">N·ªòP B√ÄI & XEM ƒêI·ªÇM</button>
    </div>
</div>

<div id="scoreModal" class="modal">
    <div class="modal-content">
        <h2>K·∫æT QU·∫¢ C·ª¶A CON</h2>
        <div class="score-display" id="finalScore">0/30</div>
        <p id="feedbackMessage" style="font-size: 1.2rem; margin-bottom: 20px;"></p>
        <button class="submit-btn" onclick="location.reload()">L√ÄM L·∫†I B√ÄI</button>
    </div>
</div>

<script>
    // DATA SOURCE
    const questionData = [
        {
            q: "We often go swimming ______ the summer.",
            a: "in", b: "on", c: "at", d: "to", correct: "a",
            vocab: "A. in (trong - d√πng cho m√πa); B. on (tr√™n - d√πng cho ng√†y); C. at (t·∫°i - d√πng cho gi·ªù); D. to (ƒë·∫øn - d√πng cho chuy·ªÉn ƒë·ªông)",
            trans: "Ch√∫ng t√¥i th∆∞·ªùng ƒëi b∆°i v√†o m√πa h√®.",
            why_true: "D√πng 'in' tr∆∞·ªõc c√°c m√πa trong nƒÉm (in spring, in summer, in autumn, in winter).",
            why_false: "Sai v√¨ 'summer' l√† m√πa, kh√¥ng d√πng on, at hay to."
        },
        {
            q: "My father usually wakes up ______ 6 o'clock.",
            a: "in", b: "on", c: "at", d: "to", correct: "c",
            vocab: "A. in; B. on; C. at (l√∫c - d√πng cho gi·ªù c·ª• th·ªÉ); D. to",
            trans: "B·ªë t√¥i th∆∞·ªùng th·ª©c d·∫≠y l√∫c 6 gi·ªù.",
            why_true: "D√πng 'at' tr∆∞·ªõc gi·ªù c·ª• th·ªÉ (at 6 o'clock, at 7 p.m.).",
            why_false: "In/On kh√¥ng d√πng cho gi·ªù ƒë·ªìng h·ªì."
        },
        {
            q: "Are you free ______ Sunday morning?",
            a: "in", b: "on", c: "at", d: "of", correct: "b",
            vocab: "A. in; B. on (v√†o); C. at; D. of (c·ªßa)",
            trans: "B·∫°n c√≥ r·∫£nh v√†o s√°ng Ch·ªß nh·∫≠t kh√¥ng?",
            why_true: "D√πng 'on' khi c·ª•m t·ª´ ch·ªâ th·ªùi gian c√≥ ch·ª©a Th·ª© (Sunday) d√π c√≥ bu·ªïi (morning) ƒëi k√®m.",
            why_false: "N·∫øu ch·ªâ c√≥ 'morning' th√¨ d√πng 'in', nh∆∞ng c√≥ 'Sunday' ph·∫£i ∆∞u ti√™n d√πng 'on'."
        },
        {
            q: "I was born ______ 2015.",
            a: "at", b: "on", c: "in", d: "to", correct: "c",
            vocab: "A. at; B. on; C. in (trong/v√†o); D. to",
            trans: "T√¥i sinh nƒÉm 2015.",
            why_true: "D√πng 'in' tr∆∞·ªõc nƒÉm (in 1990, in 2020, in 2015).",
            why_false: "On d√πng cho ng√†y c·ª• th·ªÉ; At d√πng cho gi·ªù."
        },
        {
            q: "We give each other gifts ______ Christmas Day.",
            a: "in", b: "on", c: "at", d: "for", correct: "b",
            vocab: "A. in; B. on; C. at; D. for (cho)",
            trans: "Ch√∫ng t√¥i t·∫∑ng qu√† cho nhau v√†o ng√†y Gi√°ng sinh.",
            why_true: "C√≥ ch·ªØ 'Day' trong ng√†y l·ªÖ th√¨ b·∫Øt bu·ªôc d√πng 'on' (On Christmas Day).",
            why_false: "N·∫øu ch·ªâ n√≥i 'Christmas' (d·ªãp l·ªÖ) th√¨ d√πng 'at', nh∆∞ng c√≥ 'Day' ph·∫£i d√πng 'on'."
        },
        {
            q: "My family stays at home ______ Christmas.",
            a: "in", b: "on", c: "at", d: "to", correct: "c",
            vocab: "A. in; B. on; C. at (v√†o d·ªãp); D. to",
            trans: "Gia ƒë√¨nh t√¥i ·ªü nh√† v√†o d·ªãp Gi√°ng sinh.",
            why_true: "D√πng 'at' cho c√°c d·ªãp l·ªÖ h·ªôi n√≥i chung kh√¥ng c√≥ ch·ªØ 'Day' (at Christmas, at Easter).",
            why_false: "Sai v√¨ ƒë√¢y l√† d·ªãp l·ªÖ, kh√¥ng ph·∫£i ng√†y c·ª• th·ªÉ."
        },
        {
            q: "The stars shine brightly ______ night.",
            a: "in", b: "on", c: "at", d: "to", correct: "c",
            vocab: "A. in; B. on; C. at; D. to",
            trans: "Nh·ªØng ng√¥i sao t·ªèa s√°ng r·ª±c r·ª° v√†o ban ƒë√™m.",
            why_true: "C·ª•m c·ªë ƒë·ªãnh: 'at night' (v√†o ban ƒë√™m).",
            why_false: "Ta n√≥i 'in the morning/afternoon/evening' nh∆∞ng ph·∫£i l√† 'at night'."
        },
        {
            q: "She walks ______ the park every afternoon.",
            a: "in", b: "at", c: "to", d: "on", correct: "c",
            vocab: "A. in (trong); B. at (t·∫°i); C. to (ƒë·∫øn); D. on (tr√™n)",
            trans: "C√¥ ·∫•y ƒëi b·ªô ƒë·∫øn c√¥ng vi√™n m·ªói bu·ªïi chi·ªÅu.",
            why_true: "ƒê·ªông t·ª´ 'walk' (ƒëi b·ªô) ch·ªâ s·ª± chuy·ªÉn ƒë·ªông ƒë·∫øn m·ªôt ƒë·ªãa ƒëi·ªÉm -> d√πng 'to'.",
            why_false: "'Walk in the park' nghƒ©a l√† ƒëi d·∫°o loanh quanh b√™n trong c√¥ng vi√™n. Nh∆∞ng ng·ªØ c·∫£nh ƒëi t·ª´ ch·ªó kh√°c 'ƒë·∫øn' c√¥ng vi√™n th√¨ 'to' t·ª± nhi√™n h∆°n v·ªõi ƒë·ªông t·ª´ chuy·ªÉn ƒë·ªông h∆∞·ªõng ƒë√≠ch."
        },
        {
            q: "The bus will arrive ______ a minute.",
            a: "in", b: "on", c: "at", d: "about", correct: "a",
            vocab: "A. in (trong v√≤ng); B. on; C. at; D. about (kho·∫£ng)",
            trans: "Xe bu√Ωt s·∫Ω ƒë·∫øn trong 1 ph√∫t n·ªØa.",
            why_true: "D√πng 'in' + kho·∫£ng th·ªùi gian ƒë·ªÉ ch·ªâ t∆∞∆°ng lai (trong bao l√¢u n·ªØa vi·ªác g√¨ s·∫Ω x·∫£y ra).",
            why_false: "At/On kh√¥ng d√πng cho kho·∫£ng th·ªùi gian theo nghƒ©a n√†y."
        },
        {
            q: "Ho Chi Minh was born ______ May 19th, 1890.",
            a: "in", b: "on", c: "at", d: "of", correct: "b",
            vocab: "A. in; B. on; C. at; D. of",
            trans: "H·ªì Ch√≠ Minh sinh ng√†y 19 th√°ng 5 nƒÉm 1890.",
            why_true: "D√πng 'on' tr∆∞·ªõc ng√†y th√°ng nƒÉm c·ª• th·ªÉ.",
            why_false: "D√π c√≥ th√°ng v√† nƒÉm, nh∆∞ng v√¨ c√≥ 'ng√†y 19' (Specific Day) n√™n 'on' l√† m·∫°nh nh·∫•t."
        },
        {
            q: "Someone is knocking ______ the door.",
            a: "in", b: "on", c: "at", d: "to", correct: "c",
            vocab: "A. in; B. on; C. at (t·∫°i); D. to",
            trans: "Ai ƒë√≥ ƒëang g√µ c·ª≠a (ƒë·ª©ng t·∫°i c·ª≠a).",
            why_true: "C·ª•m t·ª´ ch·ªâ v·ªã tr√≠ c·ª• th·ªÉ: 'at the door' (t·∫°i c√°nh c·ª≠a).",
            why_false: "'On the door' nghƒ©a l√† d√°n c√°i g√¨ l√™n m·∫∑t c·ª≠a. Ng∆∞·ªùi ƒë·ª©ng th√¨ d√πng 'at'."
        },
        {
            q: "I am busy ______ the moment.",
            a: "in", b: "on", c: "at", d: "with", correct: "c",
            vocab: "A. in; B. on; C. at; D. with",
            trans: "L√∫c n√†y t√¥i ƒëang b·∫≠n.",
            why_true: "C·ª•m c·ªë ƒë·ªãnh: 'at the moment' = now (ngay l√∫c n√†y).",
            why_false: "Kh√¥ng d√πng in/on the moment."
        },
        {
            q: "We are flying to Da Nang ______ tomorrow morning.",
            a: "in", b: "on", c: "at", d: "X (no word)", correct: "d",
            vocab: "A. in; B. on; C. at; D. X (kh√¥ng ƒëi·ªÅn g√¨)",
            trans: "Ch√∫ng t√¥i s·∫Ω bay ƒë·∫øn ƒê√† N·∫µng v√†o s√°ng mai.",
            why_true: "Kh√¥ng d√πng gi·ªõi t·ª´ tr∆∞·ªõc 'tomorrow', 'yesterday', 'tonight'.",
            why_false: "'On tomorrow morning' l√† sai ng·ªØ ph√°p."
        },
        {
            q: "The picture is ______ the wall.",
            a: "in", b: "on", c: "at", d: "to", correct: "b",
            vocab: "A. in; B. on (tr√™n b·ªÅ m·∫∑t); C. at; D. to",
            trans: "B·ª©c tranh ·ªü tr√™n t∆∞·ªùng.",
            why_true: "D√πng 'on' khi v·∫≠t n·∫±m tr√™n b·ªÅ m·∫∑t c·ªßa v·∫≠t kh√°c (on the wall, on the table).",
            why_false: "'In the wall' l√† n·∫±m trong kh·ªëi t∆∞·ªùng."
        },
        {
            q: "He goes ______ school by bike.",
            a: "in", b: "on", c: "at", d: "to", correct: "d",
            vocab: "A. in; B. on; C. at; D. to (ƒë·∫øn)",
            trans: "C·∫≠u ·∫•y ƒëi ƒë·∫øn tr∆∞·ªùng b·∫±ng xe ƒë·∫°p.",
            why_true: "C·∫•u tr√∫c 'go to [place]' (ƒëi ƒë·∫øn ƒë√¢u).",
            why_false: "Go in/on/at school l√† sai ng·ªØ ph√°p v·ªõi ƒë·ªông t·ª´ 'go'."
        },
        {
            q: "We have lunch ______ noon.",
            a: "in", b: "on", c: "at", d: "to", correct: "c",
            vocab: "A. in; B. on; C. at; D. to",
            trans: "Ch√∫ng t√¥i ƒÉn tr∆∞a v√†o bu·ªïi tr∆∞a.",
            why_true: "C·ª•m c·ªë ƒë·ªãnh: 'at noon' (l√∫c 12 gi·ªù tr∆∞a).",
            why_false: "In the noon (Sai) -> Ph·∫£i l√† In the afternoon."
        },
        {
            q: "Dinosaurs lived ______ the 19th century.",
            a: "in", b: "on", c: "at", d: "to", correct: "a",
            vocab: "A. in (trong); B. on; C. at; D. to",
            trans: "Kh·ªßng long (v√≠ d·ª•) s·ªëng trong th·∫ø k·ª∑ 19.",
            why_true: "D√πng 'in' tr∆∞·ªõc th·∫ø k·ª∑ (in the 19th century).",
            why_false: "Th·∫ø k·ª∑ l√† kho·∫£ng th·ªùi gian d√†i, d√πng 'in'."
        },
        {
            q: "I received many flowers ______ my birthday.",
            a: "in", b: "on", c: "at", d: "to", correct: "b",
            vocab: "A. in; B. on; C. at; D. to",
            trans: "T√¥i nh·∫≠n ƒë∆∞·ª£c nhi·ªÅu hoa v√†o ng√†y sinh nh·∫≠t c·ªßa m√¨nh.",
            why_true: "Birthday l√† m·ªôt ng√†y c·ª• th·ªÉ -> D√πng 'on'.",
            why_false: "C√°c ƒë√°p √°n kh√°c kh√¥ng d√πng cho ng√†y."
        },
        {
            q: "Look! There is a bird ______ the top of the tree.",
            a: "in", b: "on", c: "at", d: "to", correct: "c",
            vocab: "A. in; B. on; C. at; D. to",
            trans: "Nh√¨n k√¨a! C√≥ m·ªôt con chim ·ªü tr√™n ng·ªçn c√¢y.",
            why_true: "C·ª•m c·ªë ƒë·ªãnh: 'at the top of' (·ªü ƒë·ªânh/ng·ªçn) ho·∫∑c 'at the bottom of' (·ªü d∆∞·ªõi ƒë√°y).",
            why_false: "On the top c≈©ng d√πng ƒë∆∞·ª£c nh∆∞ng 'at the top' ch·ªâ v·ªã tr√≠ ƒëi·ªÉm ch√≠nh x√°c h∆°n trong ng·ªØ c·∫£nh n√†y theo l√Ω thuy·∫øt."
        },
        {
            q: "Turn left! The bank is ______ the right.",
            a: "in", b: "on", c: "at", d: "to", correct: "b",
            vocab: "A. in; B. on; C. at; D. to",
            trans: "R·∫Ω tr√°i ƒëi! Ng√¢n h√†ng ·ªü b√™n tay ph·∫£i.",
            why_true: "C·ª•m c·ªë ƒë·ªãnh: 'on the left' / 'on the right'.",
            why_false: "At/in the right l√† sai."
        },
        {
            q: "My dad is sitting ______ the armchair.",
            a: "in", b: "on", c: "at", d: "to", correct: "a",
            vocab: "A. in (trong); B. on (tr√™n); C. at; D. to",
            trans: "B·ªë t√¥i ƒëang ng·ªìi trong gh·∫ø b√†nh.",
            why_true: "V·ªõi gh·∫ø b√†nh (armchair) c√≥ tay v·ªãn bao quanh, ta d√πng 'in'. V·ªõi gh·∫ø ƒë·∫©u/gh·∫ø th∆∞·ªùng (chair) ta d√πng 'on'.",
            why_false: "On the armchair (√≠t d√πng h∆°n, ch·ªâ ng·ªìi l√™n tay v·ªãn ho·∫∑c kh√¥ng ng·ªìi l·ªçt th·ªèm)."
        },
        {
            q: "Please write your name ______ the bottom of the page.",
            a: "in", b: "on", c: "at", d: "to", correct: "c",
            vocab: "A. in; B. on; C. at; D. to",
            trans: "L√†m ∆°n vi·∫øt t√™n b·∫°n ·ªü cu·ªëi trang gi·∫•y.",
            why_true: "C·ª•m c·ªë ƒë·ªãnh: 'at the bottom of...' (·ªü d∆∞·ªõi c√πng/ƒë√°y).",
            why_false: "In/On kh√¥ng ƒëi v·ªõi bottom trong ng·ªØ c·∫£nh n√†y."
        },
        {
            q: "It often rains ______ May.",
            a: "in", b: "on", c: "at", d: "to", correct: "a",
            vocab: "A. in; B. on; C. at; D. to",
            trans: "Tr·ªùi th∆∞·ªùng m∆∞a v√†o th√°ng 5.",
            why_true: "D√πng 'in' tr∆∞·ªõc th√°ng (in May, in June).",
            why_false: "Th√°ng d√πng In, Ng√†y d√πng On, Gi·ªù d√πng At."
        },
        {
            q: "Don't sit ______ the floor! It's dirty.",
            a: "in", b: "on", c: "at", d: "to", correct: "b",
            vocab: "A. in; B. on; C. at; D. to",
            trans: "ƒê·ª´ng ng·ªìi tr√™n s√†n nh√†! N√≥ b·∫©n l·∫Øm.",
            why_true: "S√†n nh√† l√† b·ªÅ m·∫∑t -> D√πng 'on'.",
            why_false: "In the floor l√† chui xu·ªëng d∆∞·ªõi s√†n."
        },
        {
            q: "She arrived home ______ yesterday afternoon.",
            a: "in", b: "on", c: "at", d: "X (no word)", correct: "d",
            vocab: "A. in; B. on; C. at; D. X",
            trans: "C√¥ ·∫•y v·ªÅ nh√† v√†o chi·ªÅu h√¥m qua.",
            why_true: "Kh√¥ng d√πng gi·ªõi t·ª´ tr∆∞·ªõc 'yesterday' + bu·ªïi.",
            why_false: "In yesterday afternoon l√† l·ªói sai ph·ªï bi·∫øn."
        },
        {
            q: "We usually visit our grandparents ______ the weekend.",
            a: "in", b: "on", c: "at", d: "to", correct: "c",
            vocab: "A. in; B. on; C. at; D. to",
            trans: "Ch√∫ng t√¥i th∆∞·ªùng thƒÉm √¥ng b√† v√†o cu·ªëi tu·∫ßn.",
            why_true: "Theo Anh-Anh: 'at the weekend'. (Anh-M·ªπ d√πng On, nh∆∞ng At ph·ªï bi·∫øn trong gi√°o tr√¨nh chu·∫©n Cambridge/Oxford).",
            why_false: "In the weekend l√† sai."
        },
        {
            q: "There is a big tree ______ front of my house.",
            a: "in", b: "on", c: "at", d: "to", correct: "a",
            vocab: "A. in; B. on; C. at; D. to",
            trans: "C√≥ m·ªôt c√°i c√¢y l·ªõn ·ªü ph√≠a tr∆∞·ªõc nh√† t√¥i.",
            why_true: "C·ª•m c·ªë ƒë·ªãnh: 'in front of' (·ªü ph√≠a tr∆∞·ªõc).",
            why_false: "On/At front of l√† sai gi·ªõi t·ª´."
        },
        {
            q: "Come ______ my house and we will study together.",
            a: "in", b: "on", c: "at", d: "to", correct: "d",
            vocab: "A. in; B. on; C. at; D. to",
            trans: "H√£y ƒë·∫øn nh√† t·ªõ v√† ch√∫ng ta s·∫Ω h·ªçc c√πng nhau.",
            why_true: "Come (ƒë·ªông t·ª´ chuy·ªÉn ƒë·ªông) + to + ƒë·ªãa ƒëi·ªÉm.",
            why_false: "Come in my house (v√†o trong nh√† - √≠t d√πng h∆°n 'ƒë·∫øn nh√†'), Come at l√† sai."
        },
        // Visual Question 1: Sale Sign
        {
            q: "Sale ends ______ Friday!",
            type: "visual-sign",
            a: "in", b: "on", c: "at", d: "to", correct: "b",
            vocab: "A. in; B. on; C. at; D. to",
            trans: "ƒê·ª£t gi·∫£m gi√° k·∫øt th√∫c v√†o th·ª© S√°u!",
            why_true: "Friday l√† ng√†y trong tu·∫ßn -> D√πng 'on'.",
            why_false: "Ng√†y d√πng On."
        },
        // Visual Question 2: Phone Msg
        {
            q: "Are you coming ______ the party tonight?",
            type: "visual-phone",
            a: "in", b: "on", c: "at", d: "to", correct: "d",
            vocab: "A. in; B. on; C. at; D. to",
            trans: "T·ªëi nay b·∫°n c√≥ ƒë·∫øn b·ªØa ti·ªác kh√¥ng?",
            why_true: "Come (chuy·ªÉn ƒë·ªông) + to + ƒë·ªãa ƒëi·ªÉm (the party).",
            why_false: "Come at/in l√† sai ng·ªØ c·∫£nh n√†y."
        }
    ];

    // AUDIO
    const audioCorrect = new Audio('https://actions.google.com/sounds/v1/cartoon/cartoon_boing.ogg');
    const audioWrong = new Audio('https://actions.google.com/sounds/v1/cartoon/clown_horn.ogg'); // Funny wrong sound

    // UTILS
    function shuffleArray(array) {
        for (let i = array.length - 1; i > 0; i--) {
            const j = Math.floor(Math.random() * (i + 1));
            [array[i], array[j]] = [array[j], array[i]];
        }
    }

    // STATE
    let score = 0;
    
    // INIT
    window.onload = function() {
        shuffleArray(questionData);
        renderQuiz();
    }

    function renderQuiz() {
        const area = document.getElementById('quiz-area');
        area.innerHTML = '';

        questionData.forEach((item, index) => {
            let questionHTML = '';
            
            // Special UI Check
            if (item.type === 'visual-sign') {
                questionHTML = `<div class="sale-sign">${item.q}</div>`;
            } else if (item.type === 'visual-phone') {
                questionHTML = `<div class="phone-msg">${item.q}</div>`;
            } else {
                questionHTML = `<div class="question-text">${item.q}</div>`;
            }

            const card = document.createElement('div');
            card.className = 'quiz-card';
            card.innerHTML = `
                <span class="question-number">Question ${index + 1}</span>
                ${questionHTML}
                <div class="options-grid">
                    <button class="option-btn" onclick="checkAnswer(this, '${item.correct}', ${index}, 'a')">A. ${item.a}</button>
                    <button class="option-btn" onclick="checkAnswer(this, '${item.correct}', ${index}, 'b')">B. ${item.b}</button>
                    <button class="option-btn" onclick="checkAnswer(this, '${item.correct}', ${index}, 'c')">C. ${item.c}</button>
                    <button class="option-btn" onclick="checkAnswer(this, '${item.correct}', ${index}, 'd')">D. ${item.d}</button>
                </div>
                <div class="explanation-box" id="exp-${index}">
                    <div class="exp-header"><i class="fas fa-glasses"></i> C√¥ Mai An gi·∫£i th√≠ch:</div>
                    <div class="vocab-list">
                        <div class="vocab-item"><strong>Ph√¢n t√≠ch t·ª´ v·ª±ng:</strong> ${item.vocab}</div>
                    </div>
                    <div class="exp-content">
                        <p class="translation">üëâ D·ªãch: "${item.trans}"</p>
                        <p>‚úÖ <span class="reason-correct">T·∫°i sao ƒê√öNG:</span> ${item.why_true}</p>
                        <p>‚ùå <span class="reason-wrong">T·∫°i sao SAI:</span> ${item.why_false}</p>
                    </div>
                </div>
            `;
            area.appendChild(card);
        });
    }

    function checkAnswer(btn, correctVal, index, userChoice) {
        const parent = btn.parentElement;
        const buttons = parent.getElementsByClassName('option-btn');
        
        // Disable all buttons in this card
        for (let b of buttons) {
            b.disabled = true;
            if (b.innerText.toLowerCase().startsWith(correctVal + ".")) {
                b.classList.add('correct');
            }
        }

        const expBox = document.getElementById(`exp-${index}`);
        expBox.style.display = "block";

        if (userChoice === correctVal) {
            // Correct
            btn.classList.add('correct');
            score++;
            audioCorrect.currentTime = 0;
            audioCorrect.play();
            fireConfetti();
        } else {
            // Wrong
            btn.classList.add('wrong');
            audioWrong.currentTime = 0;
            audioWrong.play();
        }
    }

    function fireConfetti() {
        confetti({
            particleCount: 100,
            spread: 70,
            origin: { y: 0.6 },
            colors: ['#8854C0', '#00C9A7', '#FF4757']
        });
    }

    function submitQuiz() {
        const modal = document.getElementById('scoreModal');
        const scoreText = document.getElementById('finalScore');
        const msg = document.getElementById('feedbackMessage');
        
        scoreText.innerText = `${score}/30`;
        
        if (score === 30) {
            msg.innerText = "üèÜ TUY·ªÜT V·ªúI! Con l√† thi√™n t√†i gi·ªõi t·ª´! C√¥ Mai An r·∫•t t·ª± h√†o!";
        } else if (score >= 20) {
            msg.innerText = "üéâ R·∫•t t·ªët! Con n·∫Øm ch·∫Øc b√†i r·ªìi ƒë·∫•y, c·ªë g·∫Øng th√™m x√≠u n·ªØa nh√©!";
        } else {
            msg.innerText = "üí™ C·ªë l√™n nh√©! H√£y xem l·∫°i ph·∫ßn gi·∫£i th√≠ch chi ti·∫øt b√™n d∆∞·ªõi ƒë·ªÉ hi·ªÉu b√†i h∆°n.";
        }
        
        modal.style.display = "flex";
        fireConfetti();
    }
</script>

</body>
</html>