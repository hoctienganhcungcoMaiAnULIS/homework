<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>B√†i t·∫≠p Ti·∫øng Anh - Ms Mai An ULIS</title>
    <link href="https://fonts.googleapis.com/css2?family=Nunito:wght@400;600;700;800&family=Quicksand:wght@500;700&display=swap" rel="stylesheet">
    <style>
        :root {
            --primary: #8854C0; /* H·ªìng t√≠m pastel */
            --secondary: #00C9A7; /* Xanh ng·ªçc */
            --correct: #00D26A; /* Xanh l√° */
            --wrong: #FF4757; /* ƒê·ªè cam */
            --bg-pattern: #f0f3f8;
            --card-bg: #ffffff;
            --text-color: #2d3436;
        }

        body {
            font-family: 'Nunito', sans-serif;
            background-color: var(--bg-pattern);
            background-image: radial-gradient(var(--primary) 0.5px, transparent 0.5px), radial-gradient(var(--secondary) 0.5px, var(--bg-pattern) 0.5px);
            background-size: 20px 20px;
            color: var(--text-color);
            margin: 0;
            padding: 20px;
            line-height: 1.6;
        }

        .container {
            max-width: 900px;
            margin: 0 auto;
        }

        /* HEADER */
        header {
            text-align: center;
            margin-bottom: 30px;
            background: linear-gradient(135deg, var(--primary), #a29bfe);
            padding: 20px;
            border-radius: 20px;
            color: white;
            box-shadow: 0 10px 20px rgba(136, 84, 192, 0.3);
            border: 3px solid white;
        }

        header h1 {
            margin: 0;
            font-family: 'Quicksand', sans-serif;
            font-size: 1.8rem;
            font-weight: 800;
        }

        header p {
            margin: 5px 0 0;
            font-size: 1rem;
            opacity: 0.9;
        }

        /* CARD STYLE */
        .card {
            background: var(--card-bg);
            border-radius: 20px;
            padding: 25px;
            margin-bottom: 30px;
            box-shadow: 0 8px 0 rgba(0,0,0,0.1);
            border: 2px solid #eee;
            transition: transform 0.3s ease;
        }

        .section-title {
            color: var(--primary);
            font-weight: 800;
            border-bottom: 3px dashed var(--secondary);
            padding-bottom: 10px;
            margin-bottom: 20px;
            font-size: 1.4rem;
        }

        /* READING TEXT BOX */
        .reading-text {
            background-color: #f8f9fa;
            border-left: 5px solid var(--secondary);
            padding: 20px;
            border-radius: 10px;
            margin-bottom: 20px;
            font-size: 1.05rem;
            text-align: justify;
            white-space: pre-line; /* Gi·ªØ nguy√™n xu·ªëng d√≤ng c·ªßa vƒÉn b·∫£n g·ªëc */
        }

        .gap-number {
            font-weight: 800;
            color: var(--primary);
            background: #eee;
            padding: 2px 6px;
            border-radius: 5px;
        }

        /* GLOSSARY TABLE */
        .glossary-table {
            width: 100%;
            border-collapse: collapse;
            margin-top: 15px;
            background: white;
            border-radius: 10px;
            overflow: hidden;
            box-shadow: 0 4px 6px rgba(0,0,0,0.05);
        }

        .glossary-table th {
            background: var(--secondary);
            color: white;
            padding: 10px;
            text-align: left;
        }

        .glossary-table td {
            padding: 10px;
            border-bottom: 1px solid #eee;
        }

        /* QUESTION LAYOUT */
        .question-block {
            margin-bottom: 25px;
            border-bottom: 1px solid #eee;
            padding-bottom: 20px;
        }

        .question-text {
            font-weight: 700;
            margin-bottom: 15px;
            font-size: 1.1rem;
        }

        .options-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 15px;
        }

        .option-btn {
            background: white;
            border: 2px solid #e0e0e0;
            border-radius: 15px;
            padding: 12px 15px;
            cursor: pointer;
            font-family: 'Nunito', sans-serif;
            font-size: 1rem;
            font-weight: 600;
            text-align: left;
            transition: all 0.2s;
            box-shadow: 0 4px 0 #e0e0e0;
            position: relative;
        }

        .option-btn:hover {
            transform: scale(1.02);
            border-color: var(--secondary);
        }

        .option-btn:active {
            transform: translateY(4px);
            box-shadow: 0 0 0 #e0e0e0;
        }

        .option-btn.correct {
            background-color: var(--correct);
            color: white;
            border-color: #00b85c;
            box-shadow: 0 4px 0 #00b85c;
        }

        .option-btn.wrong {
            background-color: var(--wrong);
            color: white;
            border-color: #ff2e43;
            box-shadow: 0 4px 0 #ff2e43;
            animation: shake 0.5s;
        }

        /* MATCHING GAME STYLES */
        .matching-container {
            display: flex;
            flex-direction: column;
            gap: 15px;
        }
        .match-row {
            display: flex;
            justify-content: space-between;
            align-items: center;
            background: #f9f9f9;
            padding: 10px;
            border-radius: 10px;
            margin-bottom: 5px;
        }
        .match-item-left {
            font-weight: bold;
            color: var(--primary);
        }
        .match-select {
            padding: 8px;
            border-radius: 8px;
            border: 2px solid #ddd;
            font-family: 'Nunito';
        }

        /* EXPLANATION BOX */
        .explanation-box {
            display: none; /* Hidden by default */
            margin-top: 15px;
            background-color: #e3f9e5; /* Light green background */
            border: 2px solid var(--correct);
            border-radius: 12px;
            padding: 15px;
            animation: fadeIn 0.5s;
        }
        
        .explanation-box.show {
            display: block;
        }

        .expl-header {
            font-weight: 800;
            color: var(--correct);
            margin-bottom: 10px;
            display: flex;
            align-items: center;
            gap: 5px;
        }

        .expl-content p {
            margin: 5px 0;
            font-size: 0.95rem;
        }

        .expl-tag {
            display: inline-block;
            padding: 2px 8px;
            border-radius: 4px;
            font-size: 0.8rem;
            font-weight: bold;
            margin-right: 5px;
        }
        .tag-trans { background: #dfe6e9; color: #2d3436; }
        .tag-key { background: #ffeaa7; color: #d63031; }
        .tag-why { background: #a29bfe; color: white; }

        /* FOOTER & BUTTONS */
        .footer-controls {
            text-align: center;
            margin-top: 40px;
            padding-bottom: 40px;
        }

        .submit-btn {
            background-color: var(--primary);
            color: white;
            border: none;
            padding: 15px 40px;
            font-size: 1.2rem;
            font-weight: 800;
            border-radius: 50px;
            box-shadow: 0 6px 0 #6c429c;
            cursor: pointer;
            transition: transform 0.2s;
        }

        .submit-btn:hover {
            transform: translateY(-2px);
        }
        
        .submit-btn:active {
            transform: translateY(4px);
            box-shadow: 0 0 0 #6c429c;
        }

        /* ANIMATIONS */
        @keyframes shake {
            0% { transform: translateX(0); }
            25% { transform: translateX(-5px); }
            50% { transform: translateX(5px); }
            75% { transform: translateX(-5px); }
            100% { transform: translateX(0); }
        }

        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(-10px); }
            to { opacity: 1; transform: translateY(0); }
        }

        /* RESPONSIVE */
        @media (max-width: 600px) {
            .options-grid {
                grid-template-columns: 1fr;
            }
        }
        
        /* POPUP SCORE */
        .overlay {
            position: fixed;
            top: 0; left: 0; width: 100%; height: 100%;
            background: rgba(0,0,0,0.8);
            display: none;
            justify-content: center;
            align-items: center;
            z-index: 1000;
        }
        .score-popup {
            background: white;
            padding: 40px;
            border-radius: 20px;
            text-align: center;
            max-width: 400px;
            animation: fadeIn 0.5s;
        }
        .score-num {
            font-size: 3rem;
            color: var(--primary);
            font-weight: 800;
        }
    </style>
</head>
<body>

<div class="container">
    <header>
        <h1>B√ÄI KI·ªÇM TRA TI·∫æNG ANH</h1>
        <p>Gi√°o vi√™n: Ms. Mai An ULIS | Topic: Technology & Nature</p>
    </header>

    <div class="card" id="section-ix">
        <h2 class="section-title">IX. GAP FILL: TECHNOLOGY</h2>
        <div class="reading-text">
            One way we might see (1) <span class="gap-number">1</span> __________ in communication is through augmented reality. In an augmented-reality system, you view the world through a technological overlay. This could take the form of a (2) <span class="gap-number">2</span> __________ device like a smartphone. Another application is through a set of augmented-reality glasses. In either case, you can view the world around you and see real-time digital information about (3) <span class="gap-number">3</span> __________ you're viewing.
            Then there's video conferencing. The technology is not new but video calls have grown (4) <span class="gap-number">4</span> __________ popularity in the United States in the last few years. Mostly used in virtual workplaces or among friends, (5) <span class="gap-number">5</span> __________ on laptops and on phones have helped to facilitate the spread of video conferencing.
            Language barriers are disappearing as well. Devices that can (6) <span class="gap-number">6</span> __________ languages in real-time allow people from different countries and cultures to communicate without the need for an interpreter.
            In the distant future, we may be able to communicate by sending our thoughts through a network (7) <span class="gap-number">7</span> __________ into someone else's brain. We're decades away from such technology, but scientists are working on creating brain-computer interfaces that allow people to transmit thoughts directly to a computer. Perhaps 50 years from now we'll all use an electronic version of (8) <span class="gap-number">8</span> __________.
        </div>
        
        <div id="gap-questions-container">
            </div>
    </div>

    <div class="card" id="section-x">
        <h2 class="section-title">X. READING COMPREHENSION: NATURE & AI</h2>
        
        <div class="reading-text">
            Tools such as digital recorders, drones, and artificial intelligence are now helping us understand the sounds of nature in new ways and may even allow us to someday communicate with animals. Automated listening posts have been set up in ecosystems worldwide, from rainforests to the depths of the ocean. The resulting research from these listening posts is enabling humans to observe and analyse nature's sounds beyond the limits of our own sensory capabilities.
            
            Needless to say, these listening posts generate a lot of data that is virtually impossible to sort through manually. Therefore, researchers in the field are utilizing artificial intelligence to sort through the recordings and find emerging patterns that may help us understand what animals are saying to each other.
            
            As one example, utilizing this AI technology has allowed a research team in Germany to encode honeybee signals into a robot they sent into the hive. After using the AI technology to decode the bees' behavior, the team used the honeybees' waggle dance communication to tell the honeybees to stop moving and to give them directions to fly to a specific nectar source. The next stage of this research is to implant the robots into the honeybee hives so the hives accept the robots as members of their community from birth.
            
            The results of this research have far-reaching implications and many possible applications. In addition to the possibility of one day speaking with animals, this research could even be used to create a form of therapy for animals and plants alike.
        </div>

        <div class="card" style="border: 2px dashed var(--primary); background: #fdf0ff;">
            <h3 style="margin-top:0; color:var(--primary)">üìö Glossary (T·ª´ v·ª±ng h·ªçc thu·∫≠t)</h3>
            <table class="glossary-table">
                <thead><tr><th>Word</th><th>Type</th><th>Meaning</th></tr></thead>
                <tbody>
                    <tr><td>Capabilities</td><td>(n)</td><td>Kh·∫£ nƒÉng, nƒÉng l·ª±c</td></tr>
                    <tr><td>Implant</td><td>(v)</td><td>C·∫•y gh√©p, g·∫Øn v√†o</td></tr>
                    <tr><td>Encode</td><td>(v)</td><td>M√£ h√≥a</td></tr>
                    <tr><td>Decode</td><td>(v)</td><td>Gi·∫£i m√£</td></tr>
                    <tr><td>Manually</td><td>(adv)</td><td>Th·ªß c√¥ng (b·∫±ng tay)</td></tr>
                    <tr><td>Automated</td><td>(adj)</td><td>T·ª± ƒë·ªông h√≥a</td></tr>
                    <tr><td>Far-reaching</td><td>(adj)</td><td>C√≥ ·∫£nh h∆∞·ªüng s√¢u r·ªông</td></tr>
                    <tr><td>Utilize</td><td>(v)</td><td>T·∫≠n d·ª•ng, s·ª≠ d·ª•ng</td></tr>
                    <tr><td>Sensory</td><td>(adj)</td><td>Thu·ªôc v·ªÅ gi√°c quan</td></tr>
                    <tr><td>Implications</td><td>(n)</td><td>H√†m √Ω, h·ªá qu·∫£</td></tr>
                </tbody>
            </table>
        </div>

        <h3 style="color:var(--secondary)">Task A: Match the definitions</h3>
        <p><i>Ch·ªçn ƒë·ªãnh nghƒ©a ƒë√∫ng cho m·ªói t·ª´ b√™n d∆∞·ªõi:</i></p>
        <div id="matching-container"></div>

        <h3 style="color:var(--secondary); margin-top:30px;">Task B: True or False?</h3>
        <div id="tf-container"></div>

        <h3 style="color:var(--secondary); margin-top:30px;">Task C: Multiple Choice</h3>
        <div id="mcq-container"></div>

    </div>

    <div class="footer-controls">
        <button class="submit-btn" onclick="submitExam()">N·ªôp B√†i & Xem ƒêi·ªÉm</button>
    </div>
</div>

<div class="overlay" id="resultOverlay">
    <div class="score-popup">
        <h2>K·∫øt Qu·∫£ C·ªßa B·∫°n</h2>
        <div class="score-num" id="scoreDisplay">0/0</div>
        <p id="scoreMessage">C·ªë g·∫Øng l√™n nh√©!</p>
        <button class="submit-btn" onclick="closeOverlay()">Xem L·∫°i B√†i</button>
    </div>
</div>

<script src="https://cdn.jsdelivr.net/npm/canvas-confetti@1.5.1/dist/confetti.browser.min.js"></script>

<script>
    // --- DATABASE: N·ªòI DUNG V√Ä GI·∫¢I TH√çCH CHI TI·∫æT ---
    const db = {
        gapFill: [
            {
                id: "gap1",
                q: "(1) One way we might see __________ in communication",
                options: ["a. movement", "b. advances", "c. failure", "d. promotions"],
                correct: 1, // index b
                expl: {
                    transQ: "M·ªôt c√°ch ch√∫ng ta c√≥ th·ªÉ th·∫•y s·ª± ti·∫øn b·ªô trong giao ti·∫øp l√† th√¥ng qua th·ª±c t·∫ø ·∫£o tƒÉng c∆∞·ªùng.",
                    transOpt: "A. movement: s·ª± chuy·ªÉn ƒë·ªông | B. advances: s·ª± ti·∫øn b·ªô/b∆∞·ªõc ti·∫øn | C. failure: th·∫•t b·∫°i | D. promotions: s·ª± thƒÉng ch·ª©c/qu·∫£ng c√°o",
                    whyCorrect: "Collocation: 'Advances in communication' (nh·ªØng b∆∞·ªõc ti·∫øn trong giao ti·∫øp) l√† c·ª•m t·ª´ th∆∞·ªùng g·∫∑p ch·ªâ s·ª± ph√°t tri·ªÉn c√¥ng ngh·ªá.",
                    whyWrong: "Movement (chuy·ªÉn ƒë·ªông) kh√¥ng h·ª£p nghƒ©a; Failure (th·∫•t b·∫°i) tr√°i nghƒ©a ng·ªØ c·∫£nh; Promotions th∆∞·ªùng d√πng cho c√¥ng vi·ªác ho·∫∑c marketing."
                }
            },
            {
                id: "gap2",
                q: "(2) This could take the form of a __________ device like a smartphone.",
                options: ["a. hand-held", "b. holding-hand", "c. hand-holding", "d. held-hand"],
                correct: 0,
                expl: {
                    transQ: "ƒêi·ªÅu n√†y c√≥ th·ªÉ d∆∞·ªõi d·∫°ng m·ªôt thi·∫øt b·ªã c·∫ßm tay nh∆∞ ƒëi·ªán tho·∫°i th√¥ng minh.",
                    transOpt: "A. hand-held: c·∫ßm tay (t√≠nh t·ª´ gh√©p) | B, C, D: C√°c t·ª´ gh√©p kh√¥ng ƒë√∫ng quy t·∫Øc ng·ªØ ph√°p cho ng·ªØ c·∫£nh n√†y.",
                    whyCorrect: "T√≠nh t·ª´ gh√©p: 'Hand-held device' (thi·∫øt b·ªã c·∫ßm tay) l√† thu·∫≠t ng·ªØ chu·∫©n.",
                    whyWrong: "C√°c ph∆∞∆°ng √°n c√≤n l·∫°i sai tr·∫≠t t·ª± t·ª´ ho·∫∑c d·∫°ng ph√¢n t·ª´ (V-ing/V-ed)."
                }
            },
            {
                id: "gap3",
                q: "(3) digital information about __________ you're viewing.",
                options: ["a. how", "b. where", "c. when", "d. what"],
                correct: 3,
                expl: {
                    transQ: "...th√¥ng tin k·ªπ thu·∫≠t s·ªë v·ªÅ nh·ªØng g√¨ b·∫°n ƒëang xem.",
                    transOpt: "A. how: c√°ch th·ª©c | B. where: n∆°i ch·ªën | C. when: khi n√†o | D. what: c√°i g√¨/nh·ªØng g√¨",
                    whyCorrect: "·ªû ƒë√¢y c·∫ßn m·ªôt t√¢n ng·ªØ cho gi·ªõi t·ª´ 'about'. 'What' ƒë√≥ng vai tr√≤ l√†m t√¢n ng·ªØ cho m·ªánh ƒë·ªÅ 'you're viewing' (b·∫°n ƒëang xem c√°i g√¨).",
                    whyWrong: "How, Where, When kh√¥ng ph√π h·ª£p v·ªÅ nghƒ©a logic v·ªõi ƒë·ªông t·ª´ 'viewing' trong ng·ªØ c·∫£nh nh√¨n th·∫•y v·∫≠t th·ªÉ."
                }
            },
            {
                id: "gap4",
                q: "(4) video calls have grown __________ popularity",
                options: ["a. in", "b. for", "c. on", "d. into"],
                correct: 0,
                expl: {
                    transQ: "...cu·ªôc g·ªçi video ƒë√£ tr·ªü n√™n ph·ªï bi·∫øn (tƒÉng tr∆∞·ªüng v·ªÅ s·ª± ph·ªï bi·∫øn).",
                    transOpt: "A. in | B. for | C. on | D. into",
                    whyCorrect: "Collocation: 'Grow in popularity' ho·∫∑c 'Gain in popularity' c√≥ nghƒ©a l√† ng√†y c√†ng tr·ªü n√™n ph·ªï bi·∫øn.",
                    whyWrong: "C√°c gi·ªõi t·ª´ kh√°c kh√¥ng ƒëi k√®m v·ªõi 'grown ... popularity'."
                }
            },
            {
                id: "gap5",
                q: "(5) Mostly used..., __________ on laptops and on phones have helped",
                options: ["a. webcams", "b. browsers", "c. cameras", "d. batteries"],
                correct: 0,
                expl: {
                    transQ: "...c√°c webcam tr√™n m√°y t√≠nh x√°ch tay v√† ƒëi·ªán tho·∫°i ƒë√£ gi√∫p th√∫c ƒë·∫©y...",
                    transOpt: "A. webcams: camera m√°y t√≠nh | B. browsers: tr√¨nh duy·ªát | C. cameras: m√°y ·∫£nh | D. batteries: pin",
                    whyCorrect: "Trong ng·ªØ c·∫£nh 'Video conferencing' (h·ªôi ngh·ªã truy·ªÅn h√¨nh) tr√™n laptop, thi·∫øt b·ªã thu h√¨nh ·∫£nh ƒë∆∞·ª£c g·ªçi c·ª• th·ªÉ l√† 'webcams'. D√π ƒëi·ªán tho·∫°i d√πng 'camera' nh∆∞ng 'webcam' bao h√†m √Ω nghƒ©a thi·∫øt b·ªã ph·ª•c v·ª• video call tr√™n m√°y t√≠nh r√µ nh·∫•t.",
                    whyWrong: "Browsers l√† ph·∫ßn m·ªÅm; Batteries l√† pin; Cameras chung chung nh∆∞ng Webcam ch√≠nh x√°c h∆°n cho ng·ªØ c·∫£nh laptop video calls."
                }
            },
            {
                id: "gap6",
                q: "(6) Devices that can __________ languages in real-time",
                options: ["a. receive", "b. instruct", "c. deliver", "d. translate"],
                correct: 3,
                expl: {
                    transQ: "C√°c thi·∫øt b·ªã c√≥ th·ªÉ d·ªãch ng√¥n ng·ªØ theo th·ªùi gian th·ª±c...",
                    transOpt: "A. receive: nh·∫≠n | B. instruct: h∆∞·ªõng d·∫´n | C. deliver: giao | D. translate: d·ªãch",
                    whyCorrect: "Ng·ªØ c·∫£nh n√≥i v·ªÅ 'language barriers' (r√†o c·∫£n ng√¥n ng·ªØ) n√™n h√†nh ƒë·ªông c·∫ßn thi·∫øt l√† 'translate' (d·ªãch).",
                    whyWrong: "C√°c ƒë·ªông t·ª´ kh√°c kh√¥ng gi·∫£i quy·∫øt v·∫•n ƒë·ªÅ r√†o c·∫£n ng√¥n ng·ªØ."
                }
            },
            {
                id: "gap7",
                q: "(7) network __________ into someone else's brain.",
                options: ["a. mostly", "b. frequently", "c. directly", "d. commonly"],
                correct: 2,
                expl: {
                    transQ: "...g·ª≠i suy nghƒ© qua m·ªôt m·∫°ng l∆∞·ªõi tr·ª±c ti·∫øp v√†o n√£o ng∆∞·ªùi kh√°c.",
                    transOpt: "A. mostly: h·∫ßu h·∫øt | B. frequently: th∆∞·ªùng xuy√™n | C. directly: tr·ª±c ti·∫øp | D. commonly: th√¥ng th∆∞·ªùng",
                    whyCorrect: "Ng·ªØ c·∫£nh 'transmit thoughts' (truy·ªÅn suy nghƒ©) ƒëi th·∫≥ng v√†o n√£o b·ªô -> c·∫ßn tr·∫°ng t·ª´ 'directly' (tr·ª±c ti·∫øp).",
                    whyWrong: "Mostly, Frequently, Commonly ch·ªâ t·∫ßn su·∫•t ho·∫∑c m·ª©c ƒë·ªô ph·ªï bi·∫øn, kh√¥ng ch·ªâ c√°ch th·ª©c truy·ªÅn d·∫´n."
                }
            },
            {
                id: "gap8",
                q: "(8) electronic version of __________.",
                options: ["a. holography", "b. telepathy", "c. technology", "d. reality"],
                correct: 1,
                expl: {
                    transQ: "C√≥ l·∫Ω 50 nƒÉm n·ªØa ch√∫ng ta s·∫Ω s·ª≠ d·ª•ng phi√™n b·∫£n ƒëi·ªán t·ª≠ c·ªßa th·∫ßn giao c√°ch c·∫£m.",
                    transOpt: "A. holography: ·∫£nh ba chi·ªÅu | B. telepathy: th·∫ßn giao c√°ch c·∫£m | C. technology: c√¥ng ngh·ªá | D. reality: th·ª±c t·∫ø",
                    whyCorrect: "ƒêo·∫°n vƒÉn n√≥i v·ªÅ 'sending thoughts' (g·ª≠i suy nghƒ©) v√† 'brain-computer interfaces', ƒë·ªãnh nghƒ©a c·ªßa 'Telepathy' l√† giao ti·∫øp b·∫±ng suy nghƒ©.",
                    whyWrong: "Holography l√† v·ªÅ h√¨nh ·∫£nh; Technology qu√° chung chung; Reality kh√¥ng h·ª£p nghƒ©a."
                }
            }
        ],
        matching: [
            { id: "m1", word: "capabilities", def: "e. the abilities to do something", expl: "Capabilities = NƒÉng l·ª±c/Kh·∫£ nƒÉng." },
            { id: "m2", word: "implant", def: "d. to put something into a part of something", expl: "Implant = C·∫•y gh√©p v√†o trong c∆° th·ªÉ/v·∫≠t th·ªÉ." },
            { id: "m3", word: "encode", def: "a. change information into a particular form", expl: "Encode = M√£ h√≥a (chuy·ªÉn th√¥ng tin sang d·∫°ng m√£)." },
            { id: "m4", word: "decode", def: "f. find the meaning of something", expl: "Decode = Gi·∫£i m√£ (t√¨m hi·ªÉu √Ω nghƒ©a)." },
            { id: "m5", word: "manually", def: "g. by hand", expl: "Manually = L√†m b·∫±ng tay (th·ªß c√¥ng)." },
            { id: "m6", word: "automated", def: "b. run by machines and computers", expl: "Automated = T·ª± ƒë·ªông h√≥a (ch·∫°y b·∫±ng m√°y)." },
            { id: "m7", word: "far-reaching", def: "c. likely to have a lot of influence", expl: "Far-reaching = C√≥ ·∫£nh h∆∞·ªüng s√¢u r·ªông." }
        ],
        tf: [
            {
                id: "tf1", q: "1. Artificial intelligence is helping us communicate with animals.", ans: true,
                expl: "D·∫´n ch·ª©ng: '...allow us to someday communicate with animals.' (cho ph√©p ch√∫ng ta m·ªôt ng√†y n√†o ƒë√≥ giao ti·∫øp v·ªõi ƒë·ªông v·∫≠t)."
            },
            {
                id: "tf2", q: "2. Researchers have put listening posts both on land and under the sea.", ans: true,
                expl: "D·∫´n ch·ª©ng: '...from rainforests to the depths of the ocean.' (t·ª´ r·ª´ng nhi·ªát ƒë·ªõi ƒë·∫øn ƒë·ªô s√¢u ƒë·∫°i d∆∞∆°ng)."
            },
            {
                id: "tf3", q: "3. Data from the listening posts allows humans to analyse nature's sounds.", ans: true,
                expl: "D·∫´n ch·ª©ng: '...enabling humans to observe and analyse nature's sounds...'"
            },
            {
                id: "tf4", q: "4. AI technology can help researchers to decode the bees' behavior.", ans: true,
                expl: "D·∫´n ch·ª©ng: 'After using the AI technology to decode the bees' behavior...'"
            },
            {
                id: "tf5", q: "5. The researchers can communicate with the honeybee by dancing.", ans: false,
                expl: "SAI. C√°c nh√† nghi√™n c·ª©u d√πng AI/Robot ƒë·ªÉ b·∫Øt ch∆∞·ªõc ƒëi·ªáu nh·∫£y, ch·ª© kh√¥ng ph·∫£i con ng∆∞·ªùi t·ª± nh·∫£y. Robot 'used the honeybees' waggle dance communication'."
            },
            {
                id: "tf6", q: "6. In the next stage, the researchers will use robots to build a honeybee hives.", ans: false,
                expl: "SAI. D·∫´n ch·ª©ng: 'implant the robots into the honeybee hives so the hives accept the robots' (c·∫•y robot v√†o t·ªï ƒë·ªÉ ong ch·∫•p nh·∫≠n n√≥), kh√¥ng ph·∫£i ƒë·ªÉ x√¢y t·ªï."
            },
            {
                id: "tf7", q: "7. According to the passage, the research brings out positive results.", ans: true,
                expl: "D·∫´n ch·ª©ng: 'far-reaching implications... therapy for animals and plants' (k·∫øt qu·∫£ t√≠ch c·ª±c, ·ª©ng d·ª•ng tr·ªã li·ªáu)."
            }
        ],
        mcq: [
            {
                id: "mcq1",
                q: "1. Why do researchers use AI to sort through data?",
                options: ["A. Because equipment is difficult.", "B. Because data is impossible to sort manually.", "C. AI hears sounds humans can't.", "D. Better quality."],
                correct: 1,
                expl: {
                    transQ: "T·∫°i sao c√°c nh√† nghi√™n c·ª©u d√πng AI ƒë·ªÉ ph√¢n lo·∫°i d·ªØ li·ªáu?",
                    transOpt: "A. Thi·∫øt b·ªã kh√≥ d√πng | B. D·ªØ li·ªáu qu√° nhi·ªÅu kh√¥ng th·ªÉ l√†m th·ªß c√¥ng | C. AI nghe ƒë∆∞·ª£c si√™u √¢m | D. Ch·∫•t l∆∞·ª£ng t·ªët h∆°n",
                    whyCorrect: "D·∫´n ch·ª©ng: 'data that is virtually impossible to sort through manually' (d·ªØ li·ªáu h·∫ßu nh∆∞ kh√¥ng th·ªÉ ph√¢n lo·∫°i th·ªß c√¥ng).",
                    whyWrong: "C√°c √Ω kh√°c kh√¥ng ƒë∆∞·ª£c ƒë·ªÅ c·∫≠p l√† l√Ω do CH√çNH ƒë·ªÉ d√πng AI cho vi·ªác 'sort through' (ph√¢n lo·∫°i)."
                }
            },
            {
                id: "mcq2",
                q: "2. How does AI help researchers understand animals?",
                options: ["A. Translating directly.", "B. Amplifying volume.", "C. Finding emerging patterns.", "D. Eliminating noise."],
                correct: 2,
                expl: {
                    transQ: "AI gi√∫p hi·ªÉu ƒë·ªông v·∫≠t b·∫±ng c√°ch n√†o?",
                    transOpt: "A. D·ªãch tr·ª±c ti·∫øp | B. TƒÉng √¢m l∆∞·ª£ng | C. T√¨m ra c√°c khu√¥n m·∫´u/quy lu·∫≠t | D. Lo·∫°i b·ªè ti·∫øng ·ªìn",
                    whyCorrect: "D·∫´n ch·ª©ng: 'find emerging patterns that may help us understand what animals are saying' (t√¨m ra c√°c khu√¥n m·∫´u m·ªõi n·ªïi).",
                    whyWrong: "B√†i ƒë·ªçc nh·∫•n m·∫°nh v√†o vi·ªác t√¨m 'patterns' ch·ª© ch∆∞a ph·∫£i d·ªãch tr·ª±c ti·∫øp ngay l·∫≠p t·ª©c hay l·ªçc ·ªìn."
                }
            },
            {
                id: "mcq3",
                q: "3. Which animal is mentioned as a specific example?",
                options: ["A. Whales", "B. Birds", "C. Honeybees", "D. Bats"],
                correct: 2,
                expl: {
                    transQ: "Lo√†i v·∫≠t n√†o ƒë∆∞·ª£c l·∫•y l√†m v√≠ d·ª• c·ª• th·ªÉ?",
                    transOpt: "A. C√° voi | B. Chim | C. Ong m·∫≠t | D. D∆°i",
                    whyCorrect: "D·∫´n ch·ª©ng: 'encode honeybee signals...'",
                    whyWrong: "Ch·ªâ c√≥ ong m·∫≠t ƒë∆∞·ª£c nh·∫Øc t√™n c·ª• th·ªÉ trong v√≠ d·ª•."
                }
            },
            {
                id: "mcq4",
                q: "4. What did the German team encode into a robot?",
                options: ["A. Maps.", "B. Human commands.", "C. Honeybee signals.", "D. Software."],
                correct: 2,
                expl: {
                    transQ: "Nh√≥m nghi√™n c·ª©u ƒê·ª©c ƒë√£ m√£ h√≥a c√°i g√¨ v√†o robot?",
                    transOpt: "A. B·∫£n ƒë·ªì | B. L·ªánh con ng∆∞·ªùi | C. T√≠n hi·ªáu ong m·∫≠t | D. Ph·∫ßn m·ªÅm",
                    whyCorrect: "D·∫´n ch·ª©ng: 'encode honeybee signals into a robot'.",
                    whyWrong: "B√°m s√°t vƒÉn b·∫£n, h·ªç m√£ h√≥a t√≠n hi·ªáu c·ªßa ong."
                }
            },
            {
                id: "mcq5",
                q: "5. Where did the researchers guide the bees?",
                options: ["A. New hive.", "B. Specific nectar source.", "C. To the robot.", "D. Water source."],
                correct: 1,
                expl: {
                    transQ: "C√°c nh√† nghi√™n c·ª©u d·∫´n ƒë∆∞·ªùng cho ong ƒëi ƒë√¢u?",
                    transOpt: "A. T·ªï m·ªõi | B. Ngu·ªìn m·∫≠t hoa c·ª• th·ªÉ | C. T·ªõi ch·ªó robot | D. Ngu·ªìn n∆∞·ªõc",
                    whyCorrect: "D·∫´n ch·ª©ng: 'give them directions to fly to a specific nectar source' (ngu·ªìn m·∫≠t hoa).",
                    whyWrong: "Th√¥ng tin trong b√†i ch·ªâ r√µ l√† nectar source."
                }
            },
            {
                id: "mcq6",
                q: "6. How will researchers ensure hives accept robots in the next stage?",
                options: ["A. Smell like honey.", "B. Dance perfectly.", "C. Implanting from birth.", "D. Painting them."],
                correct: 2,
                expl: {
                    transQ: "L√†m sao ƒë·ªÉ t·ªï ong ch·∫•p nh·∫≠n robot trong giai ƒëo·∫°n t·ªõi?",
                    transOpt: "A. C√≥ m√πi m·∫≠t | B. Nh·∫£y ƒë·∫πp | C. C·∫•y gh√©p t·ª´ khi m·ªõi sinh | D. S∆°n m√†u",
                    whyCorrect: "D·∫´n ch·ª©ng: 'implant the robots... from birth' (t·ª´ khi sinh ra).",
                    whyWrong: "C√°c ph∆∞∆°ng √°n kh√°c kh√¥ng c√≥ trong b√†i."
                }
            },
            {
                id: "mcq7",
                q: "7. Besides talking to animals, what is another usage?",
                options: ["A. Controlling invasive species.", "B. Therapy for animals/plants.", "C. Honey production.", "D. Predicting disasters."],
                correct: 1,
                expl: {
                    transQ: "Ngo√†i n√≥i chuy·ªán v·ªõi ƒë·ªông v·∫≠t, ·ª©ng d·ª•ng kh√°c l√† g√¨?",
                    transOpt: "A. Ki·ªÉm so√°t lo√†i x√¢m l·∫•n | B. Tr·ªã li·ªáu cho ƒë·ªông th·ª±c v·∫≠t | C. S·∫£n xu·∫•t m·∫≠t | D. D·ª± b√°o thi√™n tai",
                    whyCorrect: "D·∫´n ch·ª©ng: 'create a form of therapy for animals and plants alike'.",
                    whyWrong: "Ch·ªâ c√≥ Therapy (tr·ªã li·ªáu) ƒë∆∞·ª£c nh·∫Øc ƒë·∫øn ·ªü ƒëo·∫°n cu·ªëi."
                }
            }
        ]
    };

    // --- RENDER FUNCTIONS ---

    // 1. Render Gap Fill
    const gapContainer = document.getElementById('gap-questions-container');
    db.gapFill.forEach((item, index) => {
        const div = document.createElement('div');
        div.className = 'question-block';
        div.innerHTML = `
            <div class="question-text">${item.q}</div>
            <div class="options-grid">
                ${item.options.map((opt, i) => `
                    <button class="option-btn" onclick="checkGap(${index}, ${i}, this)">${opt}</button>
                `).join('')}
            </div>
            <div class="explanation-box" id="expl-gap-${index}">
                <div class="expl-header">üí° Ms. Mai An gi·∫£i th√≠ch:</div>
                <div class="expl-content">
                    <p><span class="expl-tag tag-trans">D·ªãch c√¢u:</span> ${item.expl.transQ}</p>
                    <p><span class="expl-tag tag-trans">D·ªãch ƒë√°p √°n:</span> ${item.expl.transOpt}</p>
                    <p><span class="expl-tag tag-key">T·∫°i sao ƒë√∫ng?</span> ${item.expl.whyCorrect}</p>
                    <p><span class="expl-tag tag-why">T·∫°i sao sai?</span> ${item.expl.whyWrong}</p>
                </div>
            </div>
        `;
        gapContainer.appendChild(div);
    });

    // 2. Render Matching (Dropdown style for Simplicity on Mobile)
    const matchContainer = document.getElementById('matching-container');
    db.matching.forEach((item, index) => {
        const div = document.createElement('div');
        div.className = 'match-row';
        
        // T·∫°o options cho dropdown
        let optionsHtml = '<option value="">-- Ch·ªçn ƒë·ªãnh nghƒ©a --</option>';
        // Shuffle definitions for display
        const definitions = db.matching.map(m => m.def).sort(); 
        definitions.forEach(def => {
            optionsHtml += `<option value="${def}">${def}</option>`;
        });

        div.innerHTML = `
            <span class="match-item-left">${index+1}. ${item.word}</span>
            <select class="match-select" onchange="checkMatch(${index}, this)">
                ${optionsHtml}
            </select>
        `;
        // Explanation container appended after row
        const explDiv = document.createElement('div');
        explDiv.className = 'explanation-box';
        explDiv.id = `expl-match-${index}`;
        explDiv.innerHTML = `
            <div class="expl-header">‚úÖ Ch√≠nh x√°c!</div>
            <div class="expl-content">
                <p><b>${item.word}</b> nghƒ©a l√†: ${item.expl}</p>
            </div>
        `;
        
        matchContainer.appendChild(div);
        matchContainer.appendChild(explDiv);
    });

    // 3. Render True/False
    const tfContainer = document.getElementById('tf-container');
    db.tf.forEach((item, index) => {
        const div = document.createElement('div');
        div.className = 'question-block';
        div.innerHTML = `
            <div class="question-text">${item.q}</div>
            <div class="options-grid" style="grid-template-columns: 1fr 1fr;">
                <button class="option-btn" onclick="checkTF(${index}, true, this)">TRUE</button>
                <button class="option-btn" onclick="checkTF(${index}, false, this)">FALSE</button>
            </div>
            <div class="explanation-box" id="expl-tf-${index}">
                <div class="expl-header">üìù Gi·∫£i th√≠ch chi ti·∫øt:</div>
                <div class="expl-content">
                    <p>ƒê√°p √°n ƒë√∫ng l√†: <b>${item.ans ? 'TRUE' : 'FALSE'}</b></p>
                    <p>${item.expl}</p>
                </div>
            </div>
        `;
        tfContainer.appendChild(div);
    });

    // 4. Render MCQ Reading
    const mcqContainer = document.getElementById('mcq-container');
    db.mcq.forEach((item, index) => {
        const div = document.createElement('div');
        div.className = 'question-block';
        div.innerHTML = `
            <div class="question-text">${item.q}</div>
            <div class="options-grid">
                ${item.options.map((opt, i) => `
                    <button class="option-btn" onclick="checkMCQ(${index}, ${i}, this)">${opt}</button>
                `).join('')}
            </div>
            <div class="explanation-box" id="expl-mcq-${index}">
                <div class="expl-header">üí° Ph√¢n t√≠ch ƒë√°p √°n:</div>
                <div class="expl-content">
                    <p><span class="expl-tag tag-trans">D·ªãch:</span> ${item.expl.transQ}</p>
                    <p><span class="expl-tag tag-key">D·∫´n ch·ª©ng:</span> ${item.expl.whyCorrect}</p>
                    <p><span class="expl-tag tag-why">Lo·∫°i tr·ª´:</span> ${item.expl.whyWrong}</p>
                </div>
            </div>
        `;
        mcqContainer.appendChild(div);
    });

    // --- SOUND EFFECTS (Base64) ---
    // Short beep sounds to keep file single and light
    const audioContext = new (window.AudioContext || window.webkitAudioContext)();

    function playSound(type) {
        const osc = audioContext.createOscillator();
        const gainNode = audioContext.createGain();
        osc.connect(gainNode);
        gainNode.connect(audioContext.destination);

        if (type === 'correct') {
            // Ding sound (High freq sine wave)
            osc.type = 'sine';
            osc.frequency.setValueAtTime(500, audioContext.currentTime);
            osc.frequency.exponentialRampToValueAtTime(1000, audioContext.currentTime + 0.1);
            gainNode.gain.setValueAtTime(0.3, audioContext.currentTime);
            gainNode.gain.exponentialRampToValueAtTime(0.01, audioContext.currentTime + 0.5);
            osc.start();
            osc.stop(audioContext.currentTime + 0.5);
            // Confetti
            confetti({ particleCount: 100, spread: 70, origin: { y: 0.6 } });
        } else {
            // Buzz sound (Sawtooth wave)
            osc.type = 'sawtooth';
            osc.frequency.setValueAtTime(150, audioContext.currentTime);
            osc.frequency.linearRampToValueAtTime(100, audioContext.currentTime + 0.3);
            gainNode.gain.setValueAtTime(0.3, audioContext.currentTime);
            gainNode.gain.linearRampToValueAtTime(0.01, audioContext.currentTime + 0.3);
            osc.start();
            osc.stop(audioContext.currentTime + 0.3);
        }
    }

    // --- LOGIC CHECKING ---
    let totalScore = 0;
    const totalQuestions = db.gapFill.length + db.matching.length + db.tf.length + db.mcq.length;
    let answeredCount = 0;

    function disableButtons(container) {
        const btns = container.parentElement.querySelectorAll('.option-btn');
        btns.forEach(btn => btn.disabled = true);
    }

    // Check Gap Fill
    function checkGap(qIndex, optIndex, btn) {
        const qData = db.gapFill[qIndex];
        const explBox = document.getElementById(`expl-gap-${qIndex}`);
        
        if (optIndex === qData.correct) {
            btn.classList.add('correct');
            playSound('correct');
            totalScore++;
        } else {
            btn.classList.add('wrong');
            playSound('wrong');
            // Highlight correct one
            const allBtns = btn.parentElement.querySelectorAll('.option-btn');
            allBtns[qData.correct].classList.add('correct');
        }
        explBox.classList.add('show');
        disableButtons(btn);
        answeredCount++;
    }

    // Check Matching
    function checkMatch(qIndex, selectElement) {
        const qData = db.matching[qIndex];
        const selectedVal = selectElement.value;
        const explBox = document.getElementById(`expl-match-${qIndex}`);

        if (selectedVal === qData.def) {
            selectElement.style.borderColor = "var(--correct)";
            selectElement.style.background = "#e3f9e5";
            playSound('correct');
            explBox.classList.add('show');
            selectElement.disabled = true;
            totalScore++;
            answeredCount++;
        } else if (selectedVal !== "") {
            selectElement.style.borderColor = "var(--wrong)";
            playSound('wrong');
            // Kh√¥ng disable ƒë·ªÉ ch·ªçn l·∫°i (ƒë·ªëi v·ªõi d·∫°ng matching th√¨ cho ph√©p s·ª≠a ƒë·∫øn khi ƒë√∫ng ƒë·ªÉ h·ªçc)
            // Nh∆∞ng ƒë·ªÉ t√≠nh ƒëi·ªÉm c√¥ng b·∫±ng, n·∫øu mu·ªën hard mode th√¨ c√≥ th·ªÉ tr·ª´ ƒëi·ªÉm.
            // ·ªû ƒë√¢y t√¥i gi·ªØ simple: Sai th√¨ b√°o ƒë·ªè, ch·ªçn l·∫°i.
        }
    }

    // Check True/False
    function checkTF(qIndex, userChoice, btn) {
        const qData = db.tf[qIndex];
        const explBox = document.getElementById(`expl-tf-${qIndex}`);

        if (userChoice === qData.ans) {
            btn.classList.add('correct');
            playSound('correct');
            totalScore++;
        } else {
            btn.classList.add('wrong');
            playSound('wrong');
            const siblings = btn.parentElement.querySelectorAll('.option-btn');
            siblings.forEach(b => {
                if(b !== btn) b.classList.add('correct');
            });
        }
        explBox.classList.add('show');
        disableButtons(btn);
        answeredCount++;
    }

    // Check MCQ
    function checkMCQ(qIndex, optIndex, btn) {
        const qData = db.mcq[qIndex];
        const explBox = document.getElementById(`expl-mcq-${qIndex}`);

        if (optIndex === qData.correct) {
            btn.classList.add('correct');
            playSound('correct');
            totalScore++;
        } else {
            btn.classList.add('wrong');
            playSound('wrong');
            const allBtns = btn.parentElement.querySelectorAll('.option-btn');
            allBtns[qData.correct].classList.add('correct');
        }
        explBox.classList.add('show');
        disableButtons(btn);
        answeredCount++;
    }

    // Submit
    function submitExam() {
        const overlay = document.getElementById('resultOverlay');
        const scoreDisplay = document.getElementById('scoreDisplay');
        const msg = document.getElementById('scoreMessage');

        overlay.style.display = 'flex';
        scoreDisplay.innerText = `${totalScore}/${totalQuestions}`;

        const percentage = (totalScore / totalQuestions) * 100;
        if (percentage === 100) {
            msg.innerText = "Xu·∫•t s·∫Øc! C√¥ Mai An r·∫•t t·ª± h√†o v·ªÅ em! üåü";
            confetti({ particleCount: 200, spread: 100 });
        } else if (percentage >= 70) {
            msg.innerText = "L√†m t·ªët l·∫Øm! Em ƒë√£ n·∫Øm v·ªØng b√†i h·ªçc. üëç";
        } else {
            msg.innerText = "H√£y xem l·∫°i ph·∫ßn gi·∫£i th√≠ch chi ti·∫øt ƒë·ªÉ hi·ªÉu b√†i h∆°n nh√©! üí™";
        }
    }

    function closeOverlay() {
        document.getElementById('resultOverlay').style.display = 'none';
    }

</script>
</body>
</html>