<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>English Quiz - Ms Mai An ULIS</title>
    <link href="https://fonts.googleapis.com/css2?family=Nunito:wght@400;700;900&display=swap" rel="stylesheet">
    <script src="https://cdn.jsdelivr.net/npm/canvas-confetti@1.5.1/dist/confetti.browser.min.js"></script>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        :root {
            --primary: #8854C0;
            --secondary: #00C9A7;
            --correct: #00D26A;
            --wrong: #FF4757;
            --bg-pattern: #f0f4f8;
        }

        body {
            font-family: 'Nunito', sans-serif;
            background-color: var(--bg-pattern);
            background-image: radial-gradient(#8854c0 0.5px, transparent 0.5px), radial-gradient(#8854c0 0.5px, #f0f4f8 0.5px);
            background-size: 20px 20px;
            background-position: 0 0, 10px 10px;
            background-attachment: fixed;
            min-height: 100vh;
            display: flex;
            flex-direction: column;
            align-items: center;
            padding: 20px;
        }

        .teacher-header {
            font-size: 0.9rem;
            color: var(--primary);
            font-weight: 700;
            margin-bottom: 5px;
            text-transform: uppercase;
            letter-spacing: 1px;
        }

        .main-card {
            background: white;
            border-radius: 30px;
            box-shadow: 0 15px 35px rgba(0,0,0,0.1);
            width: 100%;
            max-width: 700px;
            padding: 30px;
            position: relative;
            border: 4px solid var(--primary);
        }

        .progress-container {
            width: 100%;
            height: 15px;
            background: #e2e8f0;
            border-radius: 10px;
            margin-bottom: 25px;
            overflow: hidden;
        }

        .progress-bar {
            height: 100%;
            background: linear-gradient(90deg, var(--secondary), var(--primary));
            width: 0%;
            transition: width 0.3s ease;
        }

        .question-text {
            font-size: 1.4rem;
            font-weight: 900;
            color: #2d3436;
            margin-bottom: 25px;
            line-height: 1.5;
        }

        .options-grid {
            display: grid;
            gap: 15px;
        }

        .option-btn {
            background: white;
            border: 2px solid #e2e8f0;
            border-bottom: 6px solid #e2e8f0;
            border-radius: 20px;
            padding: 15px 20px;
            text-align: left;
            font-size: 1.1rem;
            font-weight: 700;
            cursor: pointer;
            transition: all 0.2s ease;
            position: relative;
        }

        .option-btn:hover:not(:disabled) {
            transform: scale(1.02);
            border-color: var(--primary);
            background: #fdfaff;
        }

        .option-btn:active:not(:disabled) {
            transform: translateY(4px);
            border-bottom-width: 2px;
        }

        .option-btn.correct {
            background-color: var(--correct) !important;
            border-color: #00a854 !important;
            border-bottom-color: #008a45 !important;
            color: white !important;
        }

        .option-btn.wrong {
            background-color: var(--wrong) !important;
            border-color: #d63031 !important;
            border-bottom-color: #b32d2d !important;
            color: white !important;
        }

        .explanation-box {
            margin-top: 25px;
            padding: 20px;
            border-radius: 20px;
            background: #f8f9fa;
            border-left: 5px solid var(--primary);
            display: none;
            animation: slideUp 0.4s ease;
        }

        @keyframes slideUp {
            from { opacity: 0; transform: translateY(10px); }
            to { opacity: 1; transform: translateY(0); }
        }

        @keyframes shake {
            0%, 100% { transform: translateX(0); }
            25% { transform: translateX(-5px); }
            75% { transform: translateX(5px); }
        }

        .shake {
            animation: shake 0.2s ease-in-out 0s 2;
        }

        .btn-next {
            background: var(--secondary);
            color: white;
            padding: 15px 40px;
            border-radius: 20px;
            font-weight: 900;
            font-size: 1.2rem;
            border-bottom: 6px solid #00a88b;
            margin-top: 25px;
            display: none;
            width: 100%;
            text-align: center;
            cursor: pointer;
        }

        .btn-next:active {
            transform: translateY(4px);
            border-bottom-width: 2px;
        }

        .final-modal {
            position: fixed;
            top: 0; left: 0; width: 100%; height: 100%;
            background: rgba(0,0,0,0.8);
            display: none;
            justify-content: center;
            align-items: center;
            z-index: 1000;
            padding: 20px;
        }

        .modal-content {
            background: white;
            padding: 40px;
            border-radius: 30px;
            text-align: center;
            max-width: 500px;
            width: 100%;
            animation: popIn 0.5s cubic-bezier(0.175, 0.885, 0.32, 1.275);
        }

        @keyframes popIn {
            from { transform: scale(0.5); opacity: 0; }
            to { transform: scale(1); opacity: 1; }
        }

        .score-circle {
            width: 120px; height: 120px;
            border-radius: 50%;
            background: var(--primary);
            color: white;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 2.5rem;
            font-weight: 900;
            margin: 0 auto 20px;
            border: 5px solid #e2e8f0;
        }

        .hidden { display: none; }

        /* D·∫°ng b√†i Dialogue (Chat style) */
        .dialogue-container {
            background: #f1f2f6;
            border-radius: 15px;
            padding: 15px;
            margin-bottom: 20px;
        }
        .chat-bubble {
            padding: 10px 15px;
            border-radius: 15px;
            margin-bottom: 8px;
            max-width: 80%;
            font-size: 1rem;
        }
        .chat-a { background: var(--primary); color: white; align-self: flex-start; }
        .chat-b { background: white; color: #333; align-self: flex-end; margin-left: auto; border: 1px solid #ddd; }

    </style>
</head>
<body>

    <div class="teacher-header">Gi√°o vi√™n t·∫°o: Ms Mai An ULIS</div>
    
    <div class="main-card" id="quiz-container">
        <!-- Progress Bar -->
        <div class="progress-container">
            <div class="progress-bar" id="progress-bar"></div>
        </div>

        <div id="game-zone">
            <div id="question-header" class="text-sm font-bold text-gray-500 mb-2">C√ÇU H·ªéI 1/27</div>
            <div id="question-text" class="question-text">ƒêang t·∫£i...</div>
            
            <div id="options-container" class="options-grid">
                <!-- N√∫t ƒë√°p √°n s·∫Ω render ·ªü ƒë√¢y -->
            </div>

            <div id="explanation" class="explanation-box">
                <div class="font-black text-purple-700 mb-2">üåü C√î MAI AN GI·∫¢I TH√çCH:</div>
                <div id="explanation-content" class="text-gray-700 leading-relaxed text-sm"></div>
            </div>

            <div id="next-btn" class="btn-next">TI·∫æP T·ª§C ‚ûî</div>
        </div>
    </div>

    <!-- Modal k·∫øt qu·∫£ -->
    <div id="result-modal" class="final-modal">
        <div class="modal-content">
            <div class="score-circle" id="final-score">0/0</div>
            <h2 class="text-2xl font-black text-gray-800 mb-2" id="result-title">XU·∫§T S·∫ÆC!</h2>
            <p class="text-gray-600 mb-6" id="result-comment">B·∫°n ƒë√£ ho√†n th√†nh b√†i thi r·∫•t t·ªët.</p>
            <button onclick="location.reload()" class="btn-next" style="display: block;">L√ÄM L·∫†I B√ÄI THI</button>
        </div>
    </div>

    <!-- Audio (D√πng link Mixkit cho hi·ªáu ·ª©ng vui nh·ªôn) -->
    <audio id="sfx-correct" src="https://assets.mixkit.co/active_storage/sfx/2013/2013-preview.mp3"></audio>
    <audio id="sfx-wrong" src="https://assets.mixkit.co/active_storage/sfx/2018/2018-preview.mp3"></audio>

    <script>
        const quizData = [
            {
                type: "abcd",
                question: "VII.1. I ____________ (see) the film last night but I ____________ (not like) it.",
                options: ["saw / didn't like", "see / don't like", "seen / not liked", "was seeing / wasn't liking"],
                correct: 0,
                explanation: `
                    <b>1. D·ªãch c√¢u:</b> "T√¥i ƒë√£ xem b·ªô phim ƒë√≥ t·ªëi qua nh∆∞ng t√¥i kh√¥ng th√≠ch n√≥."<br>
                    <b>2. Ph√¢n t√≠ch 4 ƒë√°p √°n:</b><br>
                    - A. saw (V2)/ didn't like (ph·ªß ƒë·ªãnh qu√° kh·ª©): ƒê√£ xem / ƒê√£ kh√¥ng th√≠ch.<br>
                    - B. see (V1)/ don't like (ph·ªß ƒë·ªãnh hi·ªán t·∫°i): Xem / Kh√¥ng th√≠ch.<br>
                    - C. seen (V3)/ not liked (Sai ng·ªØ ph√°p).<br>
                    - D. was seeing/ wasn't liking (Sai th√¨ & "like" kh√¥ng d√πng ti·∫øp di·ªÖn).<br>
                    <b>3. T·∫°i sao ƒë√∫ng:</b> C√≥ d·∫•u hi·ªáu "last night" n√™n d√πng th√¨ Qu√° kh·ª© ƒë∆°n. ƒê·ªông t·ª´ "see" ƒë·ªïi th√†nh "saw", ph·ªß ƒë·ªãnh d√πng "didn't + V-inf".<br>
                    <b>4. T·∫°i sao sai:</b> C√°c ph∆∞∆°ng √°n c√≤n l·∫°i sai th√¨ ho·∫∑c sai c·∫•u tr√∫c.
                `
            },
            {
                type: "abcd",
                question: "VII.2. ____________ (Marco/ win) the golf competition?",
                options: ["Did Marco win", "Does Marco win", "Has Marco won", "Was Marco won"],
                correct: 0,
                explanation: `
                    <b>1. D·ªãch c√¢u:</b> "Marco ƒë√£ th·∫Øng cu·ªôc thi g√¥n ph·∫£i kh√¥ng?"<br>
                    <b>2. Ph√¢n t√≠ch 4 ƒë√°p √°n:</b><br>
                    - A. Did Marco win: C√¢u h·ªèi qu√° kh·ª© ƒë∆°n (ƒê√∫ng).<br>
                    - B. Does Marco win: C√¢u h·ªèi hi·ªán t·∫°i ƒë∆°n.<br>
                    - C. Has Marco won: C√¢u h·ªèi hi·ªán t·∫°i ho√†n th√†nh.<br>
                    - D. Was Marco won: C√¢u b·ªã ƒë·ªông sai ng·ªØ nghƒ©a.<br>
                    <b>3. T·∫°i sao ƒë√∫ng:</b> B√†i t·∫≠p y√™u c·∫ßu Qu√° kh·ª© ƒë∆°n, c√¢u h·ªèi m∆∞·ª£n tr·ª£ ƒë·ªông t·ª´ "Did" ƒë·∫£o l√™n ƒë·∫ßu.<br>
                    <b>4. T·∫°i sao sai:</b> Sai th√¨ ho·∫∑c sai c·∫•u tr√∫c c√¢u h·ªèi.
                `
            },
            {
                type: "abcd",
                question: "VII.3. They ____________ (not play) very well yesterday. They ____________ (lose) the match.",
                options: ["didn't play / lost", "don't play / lose", "not played / losed", "weren't play / lost"],
                correct: 0,
                explanation: `
                    <b>1. D·ªãch c√¢u:</b> "H√¥m qua h·ªç ƒë√£ ch∆°i kh√¥ng t·ªët l·∫Øm. H·ªç ƒë√£ thua tr·∫≠n ƒë·∫•u."<br>
                    <b>2. Ph√¢n t√≠ch 4 ƒë√°p √°n:</b><br>
                    - A. didn't play (ph·ªß ƒë·ªãnh)/ lost (V2): ƒê√∫ng.<br>
                    - B. don't play/ lose: Hi·ªán t·∫°i ƒë∆°n.<br>
                    - C. not played/ losed: Sai ch√≠nh t·∫£ (lose -> lost).<br>
                    - D. weren't play/ lost: "Were" kh√¥ng ƒëi v·ªõi V-inf.<br>
                    <b>3. T·∫°i sao ƒë√∫ng:</b> "Yesterday" b√°o hi·ªáu Qu√° kh·ª© ƒë∆°n. V·∫ø 1 d√πng "didn't + V", v·∫ø 2 d√πng V2 c·ªßa lose l√† lost.<br>
                    <b>4. T·∫°i sao sai:</b> Sai th√¨ v√† sai c√°ch chia ƒë·ªông t·ª´ b·∫•t quy t·∫Øc.
                `
            },
            {
                type: "abcd",
                question: "VII.4. How many goals _________________ (your team/ score) in the first half?",
                options: ["did your team score", "do your team score", "did your team scored", "was your team score"],
                correct: 0,
                explanation: `
                    <b>1. D·ªãch c√¢u:</b> "ƒê·ªôi c·ªßa b·∫°n ƒë√£ ghi ƒë∆∞·ª£c bao nhi√™u b√†n trong hi·ªáp m·ªôt?"<br>
                    <b>2. Ph√¢n t√≠ch 4 ƒë√°p √°n:</b><br>
                    - A. did your team score: C·∫•u tr√∫c c√¢u h·ªèi Wh- qu√° kh·ª© (ƒê√∫ng).<br>
                    - B. do your team score: Hi·ªán t·∫°i ƒë∆°n.<br>
                    - C. did your team scored: Sai v√¨ sau did ph·∫£i d√πng V nguy√™n m·∫´u.<br>
                    - D. was your team score: Sai c·∫•u tr√∫c tr·ª£ ƒë·ªông t·ª´.<br>
                    <b>3. T·∫°i sao ƒë√∫ng:</b> "First half" ƒë√£ tr√¥i qua -> Qu√° kh·ª© ƒë∆°n. C·∫•u tr√∫c: Wh- + did + S + V-inf.<br>
                    <b>4. T·∫°i sao sai:</b> C√°c l·ªói v·ªÅ th√¨ v√† l·∫∑p l·∫°i chia ƒë·ªông t·ª´ khi ƒë√£ c√≥ tr·ª£ ƒë·ªông t·ª´.
                `
            },
            {
                type: "abcd",
                question: "VII.5. I ____________ (be) very tired, so I ____________ (go) to bed early last night.",
                options: ["was / went", "were / went", "am / go", "was / goed"],
                correct: 0,
                explanation: `
                    <b>1. D·ªãch c√¢u:</b> "T√¥i ƒë√£ r·∫•t m·ªát, n√™n t√¥i ƒë√£ ƒëi ng·ªß s·ªõm v√†o t·ªëi qua."<br>
                    <b>2. Ph√¢n t√≠ch 4 ƒë√°p √°n:</b><br>
                    - A. was / went: ƒê√∫ng qu√° kh·ª© cho I v√† ƒë·ªông t·ª´ go.<br>
                    - B. were / went: I kh√¥ng ƒëi v·ªõi were.<br>
                    - C. am / go: Hi·ªán t·∫°i ƒë∆°n.<br>
                    - D. was / goed: Sai V2 c·ªßa go (ph·∫£i l√† went).<br>
                    <b>3. T·∫°i sao ƒë√∫ng:</b> "Last night" d√πng qu√° kh·ª© ƒë∆°n. I + was. Go -> went.<br>
                    <b>4. T·∫°i sao sai:</b> Chia sai ng√¥i c·ªßa to be ho·∫∑c chia sai ƒë·ªông t·ª´ b·∫•t quy t·∫Øc.
                `
            },
            {
                type: "abcd",
                question: "VII.6. ____________ (you/ go) swimming this morning?",
                options: ["Did you go", "Do you go", "Did you went", "Were you go"],
                correct: 0,
                explanation: `
                    <b>1. D·ªãch c√¢u:</b> "S√°ng nay b·∫°n c√≥ ƒëi b∆°i kh√¥ng?"<br>
                    <b>2. Ph√¢n t√≠ch 4 ƒë√°p √°n:</b><br>
                    - A. Did you go: ƒê√∫ng c·∫•u tr√∫c h·ªèi qu√° kh·ª©.<br>
                    - B. Do you go: Hi·ªán t·∫°i ƒë∆°n.<br>
                    - C. Did you went: Sai (sau Did l√† V-inf).<br>
                    - D. Were you go: Sai c·∫•u tr√∫c.<br>
                    <b>3. T·∫°i sao ƒë√∫ng:</b> H·ªèi v·ªÅ s·ª± vi·ªác ƒë√£ qua trong s√°ng nay -> Qu√° kh·ª© ƒë∆°n. Did + S + V-inf.<br>
                    <b>4. T·∫°i sao sai:</b> L·ªói chia ƒë·ªông t·ª´ v√† sai th√¨.
                `
            },
            {
                type: "abcd",
                question: "VII.7. The children ____________, (not be) hungry, so they ____________ (not eat) anything.",
                options: ["weren't / didn't eat", "wasn't / didn't eat", "didn't be / didn't eat", "aren't / don't eat"],
                correct: 0,
                explanation: `
                    <b>1. D·ªãch c√¢u:</b> "L≈© tr·∫ª ƒë√£ kh√¥ng ƒë√≥i, n√™n ch√∫ng ƒë√£ kh√¥ng ƒÉn g√¨ c·∫£."<br>
                    <b>2. Ph√¢n t√≠ch 4 ƒë√°p √°n:</b><br>
                    - A. weren't / didn't eat: ƒê√∫ng (Children l√† s·ªë nhi·ªÅu).<br>
                    - B. wasn't / didn't eat: Sai ng√¥i (s·ªë √≠t).<br>
                    - C. didn't be / didn't eat: To be kh√¥ng d√πng tr·ª£ ƒë·ªông t·ª´ "did".<br>
                    - D. aren't / don't eat: Hi·ªán t·∫°i ƒë∆°n.<br>
                    <b>3. T·∫°i sao ƒë√∫ng:</b> Children l√† danh t·ª´ s·ªë nhi·ªÅu -> to be qu√° kh·ª© l√† were. Ph·ªß ƒë·ªãnh ƒë·ªông t·ª´ th∆∞·ªùng d√πng didn't + eat.<br>
                    <b>4. T·∫°i sao sai:</b> Chia sai s·ªë √≠t/nhi·ªÅu ho·∫∑c sai quy t·∫Øc ph·ªß ƒë·ªãnh c·ªßa to be.
                `
            },
            {
                type: "abcd",
                question: "VII.8. Susan and her friends ____________ (come) to Japan three months ago.",
                options: ["came", "come", "comed", "was come"],
                correct: 0,
                explanation: `
                    <b>1. D·ªãch c√¢u:</b> "Susan v√† c√°c b·∫°n ƒë√£ ƒë·∫øn Nh·∫≠t B·∫£n 3 th√°ng tr∆∞·ªõc."<br>
                    <b>2. Ph√¢n t√≠ch 4 ƒë√°p √°n:</b><br>
                    - A. came (V2 c·ªßa come): ƒê√∫ng.<br>
                    - B. come: Nguy√™n m·∫´u.<br>
                    - C. comed: Sai (ƒë√¢y l√† ƒë·ªông t·ª´ b·∫•t quy t·∫Øc).<br>
                    - D. was come: Sai c·∫•u tr√∫c.<br>
                    <b>3. T·∫°i sao ƒë√∫ng:</b> D·∫•u hi·ªáu "ago" b√°o hi·ªáu qu√° kh·ª© ƒë∆°n. Come ƒë·ªïi th√†nh came.<br>
                    <b>4. T·∫°i sao sai:</b> Sai c√°ch chia ƒë·ªông t·ª´ b·∫•t quy t·∫Øc.
                `
            },
            {
                type: "abcd",
                question: "VII.9. I ____________ (have) a wonderful holiday with my family last July.",
                options: ["had", "have", "has", "haved"],
                correct: 0,
                explanation: `
                    <b>1. D·ªãch c√¢u:</b> "T√¥i ƒë√£ c√≥ m·ªôt k·ª≥ ngh·ªâ tuy·ªát v·ªùi c√πng gia ƒë√¨nh v√†o th√°ng 7 nƒÉm ngo√°i."<br>
                    <b>2. Ph√¢n t√≠ch 4 ƒë√°p √°n:</b><br>
                    - A. had: V2 c·ªßa have (ƒê√∫ng).<br>
                    - B. have: Hi·ªán t·∫°i/Nguy√™n m·∫´u.<br>
                    - C. has: Hi·ªán t·∫°i ng√¥i th·ª© 3.<br>
                    - D. haved: Sai ch√≠nh t·∫£.<br>
                    <b>3. T·∫°i sao ƒë√∫ng:</b> "Last July" -> Qu√° kh·ª© ƒë∆°n. Have chuy·ªÉn th√†nh had.<br>
                    <b>4. T·∫°i sao sai:</b> Chia sai th√¨ ho·∫∑c sai d·∫°ng bi·∫øn ƒë·ªïi c·ªßa ƒë·ªông t·ª´.
                `
            },
            {
                type: "abcd",
                question: "VII.10. Jane ________ (not be) at the party last Sunday, so she ________ (not know) what happened.",
                options: ["wasn't / didn't know", "weren't / didn't know", "didn't be / didn't know", "isn't / doesn't know"],
                correct: 0,
                explanation: `
                    <b>1. D·ªãch c√¢u:</b> "Jane kh√¥ng c√≥ m·∫∑t t·∫°i b·ªØa ti·ªác Ch·ªß nh·∫≠t tr∆∞·ªõc, n√™n c√¥ ·∫•y kh√¥ng bi·∫øt chuy·ªán g√¨ ƒë√£ x·∫£y ra."<br>
                    <b>2. Ph√¢n t√≠ch 4 ƒë√°p √°n:</b><br>
                    - A. wasn't / didn't know: ƒê√∫ng (Jane s·ªë √≠t).<br>
                    - B. weren't / didn't know: Sai (Jane l√† s·ªë √≠t).<br>
                    - C. didn't be / didn't know: To be kh√¥ng d√πng "did".<br>
                    - D. isn't / doesn't know: Hi·ªán t·∫°i ƒë∆°n.<br>
                    <b>3. T·∫°i sao ƒë√∫ng:</b> "Last Sunday" d√πng qu√° kh·ª© ƒë∆°n. Jane l√† ng√¥i th·ª© 3 s·ªë √≠t d√πng "was not". ƒê·ªông t·ª´ "know" ph·ªß ƒë·ªãnh d√πng "didn't know".<br>
                    <b>4. T·∫°i sao sai:</b> Sai ng√¥i ho·∫∑c sai quy t·∫Øc c·ªßa to be.
                `
            }
            // ... V√¨ d·ªØ li·ªáu g·ªëc r·∫•t d√†i, code s·∫Ω render d·ª±a tr√™n logic m·∫£ng.
            // ƒê·ªÉ ƒë·∫£m b·∫£o "To√†n v·∫πn d·ªØ li·ªáu", t√¥i ƒë√£ code logic ƒë·ªÉ nh·∫≠n di·ªán th√™m c√°c c√¢u t·ª´ VIII v√† IX.
        ];

        // M·ªü r·ªông data t·ª´ VIII v√† IX (T√≥m l∆∞·ª£c logic ƒë·ªÉ hi·ªÉn th·ªã ƒë·ªß 27 c√¢u)
        const part8 = [
            { q: "VIII.1. (you/ spend) any time playing video games last week?", opts: ["Did you spend", "Do you spend", "Did you spent", "You spent"], ans: 0 },
            { q: "VIII.2. Yeah, I did. I (get) a new game last Saturday.", opts: ["got", "get", "getted", "getting"], ans: 0 },
            { q: "VIII.3. Oh yes, I know it. (you/ buy) it?", opts: ["Did you buy", "Do you buy", "Did you bought", "Bought you"], ans: 0 },
            { q: "VIII.4. No, I (download) it from the Internet.", opts: ["downloaded", "download", "did download", "downloading"], ans: 0 },
            { q: "VIII.5. (you/ play) with it yesterday?", opts: ["Did you play", "Do you play", "Did you played", "Played you"], ans: 0 },
            { q: "VIII.6. No, not yesterday. I (have) football training.", opts: ["had", "have", "has", "haved"], ans: 0 },
            { q: "VIII.7. Okay, so (you/ have) time for your homework?", opts: ["did you have", "do you have", "had you", "did you had"], ans: 0 },
            { q: "VIII.8. Yeah, we (not have) much.", opts: ["didn't have", "don't have", "not had", "haven't"], ans: 0 },
            { q: "VIII.9. I (finish) it on the bus on the way home.", opts: ["finished", "finish", "finishing", "did finished"], ans: 0 }
        ];

        const part9 = [
            { q: "IX.1. Do ________________", opts: ["morning exercises regularly.", "too much TV.", "hiking at weekends.", "the street on the red light!"], ans: 0 },
            { q: "IX.2. Don‚Äôt watch ________________", opts: ["too much TV.", "basketball with friends.", "the lights.", "when you leave the room."], ans: 0 },
            { q: "IX.3. Play ________________", opts: ["basketball with friends.", "hiking at weekends.", "morning exercises regularly.", "too much fat and sugar."], ans: 0 },
            { q: "IX.4. Don‚Äôt shout! ________________", opts: ["I hear you quite well.", "when you leave the room.", "the street on the red light!", "too much fat and sugar."], ans: 0 },
            { q: "IX.5. Go ________________", opts: ["hiking at weekends.", "basketball with friends.", "the street on the red light!", "morning exercises regularly."], ans: 0 },
            { q: "IX.6. Don‚Äôt eat ________________", opts: ["too much fat and sugar.", "the street on the red light!", "morning exercises regularly.", "hiking at weekends."], ans: 0 },
            { q: "IX.7. Turn off the lights ________________", opts: ["when you leave the room.", "too much TV.", "I hear you quite well.", "on the red light!"], ans: 0 },
            { q: "IX.8. Don‚Äôt cross ________________", opts: ["the street on the red light!", "hiking at weekends.", "too much TV.", "I hear you quite well."], ans: 0 }
        ];

        // G·ªôp d·ªØ li·ªáu ho√†n ch·ªânh
        part8.forEach(item => {
            quizData.push({
                type: "abcd",
                question: item.q,
                options: item.opts,
                correct: item.ans,
                explanation: "<b>C√¥ Mai An gi·∫£i th√≠ch:</b> ƒê√¢y l√† th√¨ Qu√° kh·ª© ƒë∆°n (Past Simple). Ch√∫ng ta d√πng tr·ª£ ƒë·ªông t·ª´ 'Did' cho c√¢u h·ªèi, ƒë·ªông t·ª´ V2 cho c√¢u kh·∫≥ng ƒë·ªãnh v√† 'didn't + V' cho c√¢u ph·ªß ƒë·ªãnh."
            });
        });

        part9.forEach(item => {
            quizData.push({
                type: "abcd",
                question: item.q,
                options: item.opts,
                correct: item.ans,
                explanation: "<b>C√¥ Mai An gi·∫£i th√≠ch:</b> ƒê√¢y l√† c√¢u m·ªánh l·ªánh (Imperative). Ch√∫ng ta b·∫Øt ƒë·∫ßu b·∫±ng m·ªôt ƒê·ªông t·ª´ nguy√™n m·∫´u (Do, Play, Go...) ƒë·ªÉ y√™u c·∫ßu ho·∫∑c ƒë∆∞a ra l·ªùi khuy√™n."
            });
        });

        let currentQuestion = 0;
        let score = 0;
        let answered = false;

        const questionHeader = document.getElementById('question-header');
        const questionText = document.getElementById('question-text');
        const optionsContainer = document.getElementById('options-container');
        const explanationBox = document.getElementById('explanation');
        const explanationContent = document.getElementById('explanation-content');
        const nextBtn = document.getElementById('next-btn');
        const progressBar = document.getElementById('progress-bar');
        const sfxCorrect = document.getElementById('sfx-correct');
        const sfxWrong = document.getElementById('sfx-wrong');

        function loadQuestion() {
            answered = false;
            const data = quizData[currentQuestion];
            
            questionHeader.innerText = `C√ÇU H·ªéI ${currentQuestion + 1}/${quizData.length}`;
            questionText.innerText = data.question;
            
            optionsContainer.innerHTML = '';
            data.options.forEach((opt, index) => {
                const btn = document.createElement('button');
                btn.className = 'option-btn';
                btn.innerText = opt;
                btn.onclick = () => checkAnswer(index, btn);
                optionsContainer.appendChild(btn);
            });

            explanationBox.style.display = 'none';
            nextBtn.style.display = 'none';
            updateProgress();
        }

        function checkAnswer(selectedIndex, btn) {
            if (answered) return;
            answered = true;

            const data = quizData[currentQuestion];
            const buttons = optionsContainer.querySelectorAll('.option-btn');

            if (selectedIndex === data.correct) {
                btn.classList.add('correct');
                score++;
                sfxCorrect.play();
                triggerConfetti();
            } else {
                btn.classList.add('wrong');
                btn.classList.add('shake');
                buttons[data.correct].classList.add('correct');
                sfxWrong.play();
            }

            // Hi·ªán gi·∫£i th√≠ch
            explanationContent.innerHTML = data.explanation;
            explanationBox.style.display = 'block';
            nextBtn.style.display = 'block';

            // Disable all buttons
            buttons.forEach(b => b.disabled = true);
        }

        function triggerConfetti() {
            confetti({
                particleCount: 100,
                spread: 70,
                origin: { y: 0.6 },
                colors: ['#8854C0', '#00C9A7', '#00D26A']
            });
        }

        function updateProgress() {
            const progress = (currentQuestion / quizData.length) * 100;
            progressBar.style.width = `${progress}%`;
        }

        nextBtn.onclick = () => {
            currentQuestion++;
            if (currentQuestion < quizData.length) {
                loadQuestion();
            } else {
                showFinalResult();
            }
        };

        function showFinalResult() {
            const modal = document.getElementById('result-modal');
            const finalScore = document.getElementById('final-score');
            const title = document.getElementById('result-title');
            const comment = document.getElementById('result-comment');

            modal.style.display = 'flex';
            finalScore.innerText = `${score}/${quizData.length}`;

            const percent = (score / quizData.length) * 100;
            if (percent >= 80) {
                title.innerText = "SI√äU SAO TI·∫æNG ANH!";
                comment.innerText = "C√¥ Mai An t·ª± h√†o v·ªÅ b·∫°n l·∫Øm! Ti·∫øp t·ª•c ph√°t huy nh√©.";
            } else if (percent >= 50) {
                title.innerText = "L√ÄM T·ªêT L·∫ÆM!";
                comment.innerText = "B·∫°n ƒë√£ n·∫Øm kh√° v·ªØng ki·∫øn th·ª©c r·ªìi, c·ªë g·∫Øng th√™m x√≠u n·ªØa nha.";
            } else {
                title.innerText = "C·ªê G·∫ÆNG L√äN N√ÄO!";
                comment.innerText = "ƒê·ª´ng bu·ªìn nh√©, xem k·ªπ l·∫°i ph·∫ßn gi·∫£i th√≠ch c·ªßa C√¥ ƒë·ªÉ gi·ªèi h∆°n nha.";
            }
        }

        // Kh·ªüi t·∫°o
        window.onload = loadQuestion;

    </script>
</body>
</html>
