<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>English Quiz - Ms Mai An ULIS</title>
    <link href="https://fonts.googleapis.com/css2?family=Nunito:wght@400;700;800;900&display=swap" rel="stylesheet">
    <style>
        :root {
            --primary-pink: #8854C0;
            --primary-mint: #00C9A7;
            --primary-yellow: #FDCB6E;
            --correct-green: #00D26A;
            --wrong-red: #FF4757;
            --card-bg: rgba(255, 255, 255, 0.95);
            --text-dark: #2d3436;
        }

        body {
            font-family: 'Nunito', sans-serif;
            margin: 0;
            padding: 0;
            /* Background pattern vui nh·ªôn: k·∫øt h·ª£p gradient v√† svg h·ªça ti·∫øt */
            background: linear-gradient(135deg, #a8edea 0%, #fed6e3 100%), url('data:image/svg+xml;utf8,<svg width="120" height="120" viewBox="0 0 120 120" xmlns="http://www.w3.org/2000/svg"><path d="M10 10 L20 10 L15 20 Z" fill="rgba(255,255,255,0.4)"/><circle cx="90" cy="90" r="6" fill="rgba(255,255,255,0.5)"/><rect x="100" y="20" width="10" height="10" transform="rotate(45 105 25)" fill="rgba(255,255,255,0.3)"/><path d="M20 90 Q 25 80 30 90 T 40 90" stroke="rgba(255,255,255,0.4)" fill="none" stroke-width="3"/></svg>');
            background-blend-mode: overlay;
            color: var(--text-dark);
            padding-bottom: 100px;
        }

        .header {
            text-align: center;
            padding: 20px;
            background: rgba(255, 255, 255, 0.9);
            box-shadow: 0 4px 15px rgba(0,0,0,0.1);
            border-radius: 0 0 30px 30px;
            margin-bottom: 30px;
        }

        .header h5 {
            margin: 0;
            color: var(--primary-pink);
            font-size: 1.2rem;
            text-transform: uppercase;
            letter-spacing: 1px;
        }
        
        .header h1 {
            margin: 10px 0 0;
            color: var(--primary-mint);
            font-size: 2.2rem;
            text-shadow: 2px 2px 0px rgba(0,0,0,0.1);
        }

        .container {
            max-width: 850px;
            margin: 0 auto;
            padding: 0 15px;
        }

        /* L√Ω thuy·∫øt Box */
        .theory-box {
            background: #fff;
            border: 4px dashed var(--primary-pink);
            border-radius: 20px;
            padding: 25px;
            margin-bottom: 30px;
            box-shadow: 0 10px 20px rgba(0,0,0,0.05);
            position: relative;
        }
        .theory-title {
            background: var(--primary-pink);
            color: white;
            padding: 8px 20px;
            border-radius: 15px;
            display: inline-block;
            font-size: 1.4rem;
            font-weight: 800;
            margin-top: -45px;
            box-shadow: 0 4px 0 #5f27cd;
        }
        .theory-content h3 { color: var(--primary-mint); margin-top: 15px; margin-bottom: 5px;}
        .theory-content p, .theory-content ul { font-size: 1.1rem; line-height: 1.6; margin-top: 5px;}
        .theory-content .ex { background: #f1f2f6; padding: 10px; border-left: 4px solid var(--primary-yellow); border-radius: 5px; margin: 10px 0;}

        .section-title {
            background: var(--primary-mint);
            color: white;
            padding: 12px 25px;
            border-radius: 20px;
            display: inline-block;
            margin-top: 20px;
            box-shadow: 0 5px 0 #00A388;
            border: 3px solid white;
            font-size: 1.3rem;
        }

        .question-card {
            background: var(--card-bg);
            border-radius: 20px;
            padding: 25px;
            margin: 20px 0;
            box-shadow: 0 8px 0 rgba(0,0,0,0.1);
            border: 2px solid #eee;
            transition: transform 0.2s;
        }

        .question-text {
            font-size: 1.25rem;
            font-weight: 800;
            margin-bottom: 20px;
            color: var(--primary-pink);
        }

        /* MCQ Options */
        .options-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 15px;
        }

        .option-btn {
            background: white;
            border: 2px solid #e0e0e0;
            padding: 15px;
            border-radius: 15px;
            font-size: 1.1rem;
            font-weight: 700;
            color: var(--text-dark);
            cursor: pointer;
            box-shadow: 0 5px 0 #e0e0e0;
            transition: all 0.1s;
            font-family: 'Nunito', sans-serif;
            text-align: center;
        }

        .option-btn:hover {
            transform: scale(1.02) translateY(-2px);
            box-shadow: 0 7px 0 #e0e0e0;
        }

        .option-btn:active {
            transform: scale(0.98) translateY(3px);
            box-shadow: 0 2px 0 #e0e0e0;
        }

        .option-btn.correct { background: var(--correct-green); border-color: #00A355; color: white; box-shadow: 0 5px 0 #00A355; }
        .option-btn.wrong { background: var(--wrong-red); border-color: #D63031; color: white; box-shadow: 0 5px 0 #D63031; }

        /* Explanation Box */
        .explanation {
            display: none;
            margin-top: 25px;
            padding: 20px;
            background: #f8f9fa;
            border-left: 6px solid var(--primary-mint);
            border-radius: 12px;
            animation: slideDown 0.3s ease-out;
            line-height: 1.6;
            font-size: 1.05rem;
        }
        .explanation h4 { margin: 0 0 12px 0; color: var(--primary-pink); font-size: 1.2rem;}
        .explanation p { margin: 8px 0; }
        .explanation .highlight { font-weight: 800; color: var(--primary-mint); }
        
        /* Text Inputs (Ex 2, Ex 4) */
        .text-input-group {
            display: flex;
            gap: 15px;
            align-items: center;
        }
        .write-input {
            flex: 1;
            padding: 15px;
            border: 3px solid #dfe6e9;
            border-radius: 15px;
            font-family: 'Nunito';
            font-size: 1.2rem;
            font-weight: bold;
            color: var(--primary-pink);
            outline: none;
            transition: 0.3s;
        }
        .write-input:focus { border-color: var(--primary-mint); }
        .write-input.correct { background: rgba(0,210,106,0.1); border-color: var(--correct-green); color: var(--correct-green); }
        .write-input.wrong { background: rgba(255,71,87,0.1); border-color: var(--wrong-red); color: var(--wrong-red); }

        .check-btn {
            background: var(--primary-yellow);
            border: none;
            padding: 15px 30px;
            border-radius: 15px;
            font-weight: 800;
            font-size: 1.1rem;
            cursor: pointer;
            box-shadow: 0 5px 0 #e1b12c;
            color: #2d3436;
            transition: 0.1s;
            font-family: 'Nunito';
        }
        .check-btn:active { transform: translateY(4px); box-shadow: 0 0 0 #E1B12C; }

        /* Word Sort (Ex 3) */
        .word-bank {
            display: flex; flex-wrap: wrap; gap: 10px; margin-bottom: 15px; min-height: 60px;
            padding: 15px; background: rgba(0,0,0,0.03); border-radius: 15px;
        }
        .word-pill {
            background: var(--primary-mint); color: white; padding: 10px 20px;
            border-radius: 20px; cursor: pointer; box-shadow: 0 5px 0 #00A388;
            font-weight: 800; font-size: 1.1rem; transition: 0.1s;
        }
        .word-pill:active { transform: translateY(4px); box-shadow: 0 0 0 #00A388; }
        .answer-drop {
            display: flex; flex-wrap: wrap; gap: 10px; min-height: 60px;
            padding: 15px; border: 3px dashed #b2bec3; border-radius: 15px; margin-bottom: 15px;
            transition: 0.3s;
        }

        /* Animations */
        @keyframes slideDown { from { opacity: 0; transform: translateY(-10px); } to { opacity: 1; transform: translateY(0); } }
        @keyframes shake {
            0%, 100% { transform: translateX(0); }
            25% { transform: translateX(-6px) rotate(-2deg); }
            75% { transform: translateX(6px) rotate(2deg); }
        }
        .shake { animation: shake 0.4s; }

        /* Submit Bar */
        .submit-bar {
            position: fixed; bottom: 0; left: 0; width: 100%;
            background: white; padding: 15px; box-shadow: 0 -5px 15px rgba(0,0,0,0.1);
            text-align: center; z-index: 100; box-sizing: border-box;
        }
        .submit-btn {
            background: var(--primary-pink); color: white; border: none; padding: 15px 50px;
            font-size: 1.5rem; font-weight: 900; border-radius: 30px; cursor: pointer;
            box-shadow: 0 6px 0 #5f27cd; font-family: 'Nunito'; transition: 0.2s;
        }
        .submit-btn:hover { transform: translateY(-2px); box-shadow: 0 8px 0 #5f27cd; }
        .submit-btn:active { transform: translateY(6px); box-shadow: 0 0 0 #5f27cd; }

        #confetti-canvas { position: fixed; top: 0; left: 0; width: 100%; height: 100%; pointer-events: none; z-index: 999; }
        
        .modal { display: none; position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0,0,0,0.6); z-index: 1000; justify-content: center; align-items: center; }
        .modal-content { background: white; padding: 40px; border-radius: 20px; text-align: center; max-width: 450px; box-shadow: 0 10px 30px rgba(0,0,0,0.2); }
        .modal-content h2 { color: var(--primary-pink); margin-top: 0; font-size: 2.2rem; }
        .modal-content p { font-size: 1.3rem; font-weight: bold; margin: 15px 0;}
    </style>
</head>
<body>

<canvas id="confetti-canvas"></canvas>

<div class="header">
    <h5>Gi√°o vi√™n t·∫°o: Ms Mai An ULIS</h5>
    <h1>Chinh Ph·ª•c Th√¨ T∆∞∆°ng Lai G·∫ßn üöÄ</h1>
</div>

<div class="container" id="quiz-container">

    <div class="theory-box">
        <div class="theory-title">III. Th√¨ t∆∞∆°ng lai g·∫ßn (s·∫Ω l√†m g√¨ ƒë√≥) üìö</div>
        <div class="theory-content">
            <h3>1. C√¥ng th·ª©c</h3>
            <ul>
                <li><strong>C√¢u kh·∫≥ng ƒë·ªãnh:</strong> S + be + going to V <br><em>(Minh is going to work in America)</em></li>
                <li><strong>C√¢u ph·ªß ƒë·ªãnh:</strong> S + be + not + going to V <br><em>(Lan is not going to work for Korean companies)</em></li>
                <li><strong>C√¢u nghi v·∫•n:</strong> Be + S + going to V ? <br><em>(Are you going to stay with her?)</em></li>
            </ul>
            <h3>2. C√°ch s·ª≠ d·ª•ng</h3>
            <p>üåü <strong>Di·ªÖn ƒë·∫°t m·ªôt h√†nh ƒë·ªông s·∫Ω ti·∫øn h√†nh trong t∆∞∆°ng lai nh∆∞ng ƒë√£ c√≥ k·∫ø ho·∫°ch t·ª´ tr∆∞·ªõc:</strong></p>
            <div class="ex">
                Ex: I am having my birthday party next week.<br>
                ‚ûî I am going to have my birthday party next week.<br>
                <em>(L∆∞u √Ω: V·ªõi ƒë·ªông t·ª´ 'go' v√† 'come' ta kh√¥ng ƒë∆∞·ª£c s·ª≠ d·ª•ng ·ªü th√¨ hi·ªán t·∫°i ti·∫øp di·ªÖn v·ªõi nghƒ©a t∆∞∆°ng lai g·∫ßn).</em>
            </div>
            <p>üåü <strong>Di·ªÖn ƒë·∫°t m·ªôt ƒëi·ªÅu s·∫Øp x·∫£y ra d·ª±a v√†o b·∫±ng ch·ª©ng hi·ªán t·∫°i (evidence):</strong></p>
            <div class="ex">
                Ex 1: Look at the clouds. It's going to rain.<br>
                Ex 2: I failed the interview. My mom is not going to be happy.
            </div>
        </div>
    </div>

    <h2 class="section-title">B√†i t·∫≠p 1: Ch·ªçn ƒë√°p √°n ƒë√∫ng nh·∫•t (10 c√¢u)</h2>
    <p><em>M·ª•c ti√™u: Nh·∫≠n di·ªán c·∫•u tr√∫c "be going to" v√† ph√¢n bi·ªát ng√¥i c·ªßa ch·ªß ng·ªØ.</em></p>

    <div class="question-card" data-type="mcq" data-correct="A">
        <div class="question-text">1. Look at those dark clouds! It ________ rain.</div>
        <div class="options-grid">
            <button class="option-btn" value="A">A. is going to</button>
            <button class="option-btn" value="B">B. are going to</button>
            <button class="option-btn" value="C">C. am going to</button>
        </div>
        <div class="explanation">
            <h4>üí° Gi·∫£i th√≠ch chi ti·∫øt:</h4>
            <p><strong>1. D·ªãch c√¢u h·ªèi:</strong> H√£y nh√¨n nh·ªØng ƒë√°m m√¢y ƒëen k√¨a! Tr·ªùi s·∫Øp m∆∞a r·ªìi.</p>
            <p><strong>2. Ph√¢n t√≠ch ƒë√°p √°n:</strong><br>A. is going to: D√πng cho ch·ªß ng·ªØ s·ªë √≠t (He, She, It...).<br>B. are going to: D√πng cho ch·ªß ng·ªØ s·ªë nhi·ªÅu (You, We, They...).<br>C. am going to: Ch·ªâ d√πng duy nh·∫•t cho ch·ªß ng·ªØ "I".</p>
            <p><strong>3. T·∫°i sao ch·ªçn A ƒë√∫ng?</strong> Ch·ªß ng·ªØ trong c√¢u l√† <span class="highlight">"It"</span> (s·ªë √≠t). ƒê·ªông t·ª´ to be ƒëi k√®m lu√¥n l√† "is". ƒê√¢y l√† c√°ch d√πng t∆∞∆°ng lai g·∫ßn ƒë·ªÉ d·ª± ƒëo√°n d·ª±a tr√™n b·∫±ng ch·ª©ng hi·ªán t·∫°i (dark clouds - m√¢y ƒëen).</p>
            <p><strong>4. T·∫°i sao sai?</strong> Lo·∫°i B v√† C v√¨ sai s·ª± h√≤a h·ª£p gi·ªØa Ch·ªß ng·ªØ v√† ƒê·ªông t·ª´ to be.</p>
        </div>
    </div>

    <div class="question-card" data-type="mcq" data-correct="B">
        <div class="question-text">2. I have bought the tickets. We ________ a movie tonight.</div>
        <div class="options-grid">
            <button class="option-btn" value="A">A. is going to watch</button>
            <button class="option-btn" value="B">B. are going to watch</button>
            <button class="option-btn" value="C">C. am going to watch</button>
        </div>
        <div class="explanation">
            <h4>üí° Gi·∫£i th√≠ch chi ti·∫øt:</h4>
            <p><strong>1. D·ªãch c√¢u h·ªèi:</strong> T·ªõ ƒë√£ mua v√© r·ªìi. Ch√∫ng t·ªõ s·∫Ω xem m·ªôt b·ªô phim v√†o t·ªëi nay.</p>
            <p><strong>2. Ph√¢n t√≠ch ƒë√°p √°n:</strong><br>A. is going to watch: s·∫Ω xem (ƒëi v·ªõi s·ªë √≠t).<br>B. are going to watch: s·∫Ω xem (ƒëi v·ªõi s·ªë nhi·ªÅu/You).<br>C. am going to watch: s·∫Ω xem (ƒëi v·ªõi I).</p>
            <p><strong>3. T·∫°i sao ch·ªçn B ƒë√∫ng?</strong> Ch·ªß ng·ªØ c·ªßa c√¢u l√† <span class="highlight">"We"</span> (ch√∫ng t√¥i) l√† s·ªë nhi·ªÅu, do ƒë√≥ to be ph·∫£i l√† "are". Vi·ªác ƒë√£ mua v√© l√† k·∫ø ho·∫°ch r√µ r√†ng.</p>
            <p><strong>4. T·∫°i sao sai?</strong> A sai v√¨ We kh√¥ng ƒëi v·ªõi is. C sai v√¨ We kh√¥ng ƒëi v·ªõi am.</p>
        </div>
    </div>

    <div class="question-card" data-type="mcq" data-correct="A">
        <div class="question-text">3. He ________ work in America next year.</div>
        <div class="options-grid">
            <button class="option-btn" value="A">A. isn't going to</button>
            <button class="option-btn" value="B">B. aren't going to</button>
            <button class="option-btn" value="C">C. doesn't going to</button>
        </div>
        <div class="explanation">
            <h4>üí° Gi·∫£i th√≠ch chi ti·∫øt:</h4>
            <p><strong>1. D·ªãch c√¢u h·ªèi:</strong> Anh ·∫•y s·∫Ω kh√¥ng l√†m vi·ªác ·ªü M·ªπ v√†o nƒÉm t·ªõi.</p>
            <p><strong>2. Ph√¢n t√≠ch ƒë√°p √°n:</strong><br>A. isn't going to: S·∫Ω kh√¥ng (He/She/It).<br>B. aren't going to: S·∫Ω kh√¥ng (You/We/They).<br>C. doesn't going to: Sai c·∫•u tr√∫c ho√†n to√†n.</p>
            <p><strong>3. T·∫°i sao ch·ªçn A ƒë√∫ng?</strong> Ch·ªß ng·ªØ <span class="highlight">"He"</span> ƒëi v·ªõi to be l√† "is". Th·ªÉ ph·ªß ƒë·ªãnh th√™m "not" th√†nh "isn't" + going to.</p>
            <p><strong>4. T·∫°i sao sai?</strong> B sai v√¨ "He" kh√¥ng ƒëi v·ªõi "are". C sai tr·∫ßm tr·ªçng v√¨ c·∫•u tr√∫c t∆∞∆°ng lai g·∫ßn d√πng ƒë·ªông t·ª´ "to be", kh√¥ng d√πng tr·ª£ ƒë·ªông t·ª´ "do/does" c·ªßa hi·ªán t·∫°i ƒë∆°n.</p>
        </div>
    </div>

    <div class="question-card" data-type="mcq" data-correct="C">
        <div class="question-text">4. ________ you going to stay with her?</div>
        <div class="options-grid">
            <button class="option-btn" value="A">A. Do</button>
            <button class="option-btn" value="B">B. Is</button>
            <button class="option-btn" value="C">C. Are</button>
        </div>
        <div class="explanation">
            <h4>üí° Gi·∫£i th√≠ch chi ti·∫øt:</h4>
            <p><strong>1. D·ªãch c√¢u h·ªèi:</strong> B·∫°n s·∫Ω ·ªü l·∫°i c√πng c√¥ ·∫•y ch·ª©?</p>
            <p><strong>2. Ph√¢n t√≠ch ƒë√°p √°n:</strong><br>A. Do: Tr·ª£ ƒë·ªông t·ª´ hi·ªán t·∫°i ƒë∆°n.<br>B. Is: To be s·ªë √≠t.<br>C. Are: To be s·ªë nhi·ªÅu / You.</p>
            <p><strong>3. T·∫°i sao ch·ªçn C ƒë√∫ng?</strong> ƒê√¢y l√† c√¢u h·ªèi nghi v·∫•n c·ªßa th√¨ t∆∞∆°ng lai g·∫ßn (Be + S + going to V). Ch·ªß ng·ªØ l√† <span class="highlight">"you"</span> n√™n to be ƒë·∫£o l√™n ƒë·∫ßu c√¢u ph·∫£i l√† "Are".</p>
            <p><strong>4. T·∫°i sao sai?</strong> A sai v√¨ c√≥ "going to" (t∆∞∆°ng lai g·∫ßn) th√¨ kh√¥ng d√πng "Do". B sai v√¨ "you" kh√¥ng bao gi·ªù ƒëi v·ªõi "is".</p>
        </div>
    </div>

    <div class="question-card" data-type="mcq" data-correct="A">
        <div class="question-text">5. They ________ play football this weekend. They planned it.</div>
        <div class="options-grid">
            <button class="option-btn" value="A">A. are going to</button>
            <button class="option-btn" value="B">B. are going</button>
            <button class="option-btn" value="C">C. going to</button>
        </div>
        <div class="explanation">
            <h4>üí° Gi·∫£i th√≠ch chi ti·∫øt:</h4>
            <p><strong>1. D·ªãch c√¢u h·ªèi:</strong> H·ªç s·∫Ω ch∆°i b√≥ng ƒë√° v√†o cu·ªëi tu·∫ßn n√†y. H·ªç ƒë√£ l√™n k·∫ø ho·∫°ch r·ªìi.</p>
            <p><strong>2. Ph√¢n t√≠ch ƒë√°p √°n:</strong><br>A. are going to: C·∫•u tr√∫c ho√†n ch·ªânh (to be + going to).<br>B. are going: Thi·∫øu "to" tr∆∞·ªõc ƒë·ªông t·ª´ nguy√™n th·ªÉ.<br>C. going to: Thi·∫øu ƒë·ªông t·ª´ to be (are).</p>
            <p><strong>3. T·∫°i sao ch·ªçn A ƒë√∫ng?</strong> C·∫•u tr√∫c ƒë·∫ßy ƒë·ªß: <span class="highlight">S + be + going to + V</span>. Ch·ªß ng·ªØ "They" ƒëi v·ªõi "are", th√™m "going to" l√† tr·ªçn v·∫πn.</p>
            <p><strong>4. T·∫°i sao sai?</strong> B thi·∫øu gi·ªõi t·ª´ "to" k·∫øt n·ªëi v·ªõi ƒë·ªông t·ª´ "play". C thi·∫øu ƒë·ªông t·ª´ to be chia theo ch·ªß ng·ªØ, c√¢u ti·∫øng Anh kh√¥ng c√≥ to be l√† v√¥ nghƒ©a.</p>
        </div>
    </div>

    <div class="question-card" data-type="mcq" data-correct="B">
        <div class="question-text">6. Watch out! You ________ drop the glasses!</div>
        <div class="options-grid">
            <button class="option-btn" value="A">A. is going to</button>
            <button class="option-btn" value="B">B. are going to</button>
            <button class="option-btn" value="C">C. am going to</button>
        </div>
        <div class="explanation">
            <h4>üí° Gi·∫£i th√≠ch chi ti·∫øt:</h4>
            <p><strong>1. D·ªãch c√¢u h·ªèi:</strong> Coi ch·ª´ng! B·∫°n s·∫Øp l√†m r∆°i nh·ªØng c√°i ly r·ªìi k√¨a!</p>
            <p><strong>2. Ph√¢n t√≠ch ƒë√°p √°n:</strong> (ƒê√£ ph√¢n t√≠ch ·ªü Q1/Q2)</p>
            <p><strong>3. T·∫°i sao ch·ªçn B ƒë√∫ng?</strong> T√¨nh hu·ªëng d·ª±a tr√™n d·∫•u hi·ªáu hi·ªán t·∫°i "Watch out" (Coi ch·ª´ng). Ch·ªß ng·ªØ <span class="highlight">"You"</span> lu√¥n lu√¥n ƒëi v·ªõi to be l√† "are".</p>
            <p><strong>4. T·∫°i sao sai?</strong> A (is) v√† C (am) kh√¥ng h√≤a h·ª£p v·ªõi ch·ªß ng·ªØ "You".</p>
        </div>
    </div>

    <div class="question-card" data-type="mcq" data-correct="C">
        <div class="question-text">7. My mom ________ make a big cake for my birthday.</div>
        <div class="options-grid">
            <button class="option-btn" value="A">A. am going to</button>
            <button class="option-btn" value="B">B. are going to</button>
            <button class="option-btn" value="C">C. is going to</button>
        </div>
        <div class="explanation">
            <h4>üí° Gi·∫£i th√≠ch chi ti·∫øt:</h4>
            <p><strong>1. D·ªãch c√¢u h·ªèi:</strong> M·∫π t√¥i s·∫Ω l√†m m·ªôt c√°i b√°nh l·ªõn cho sinh nh·∫≠t t√¥i.</p>
            <p><strong>2. Ph√¢n t√≠ch ƒë√°p √°n:</strong> (ƒê√£ ph√¢n t√≠ch ·ªü Q1)</p>
            <p><strong>3. T·∫°i sao ch·ªçn C ƒë√∫ng?</strong> Ch·ªß ng·ªØ <span class="highlight">"My mom"</span> (M·∫π c·ªßa t√¥i) t∆∞∆°ng ƒë∆∞∆°ng v·ªõi "She", l√† danh t·ª´ s·ªë √≠t ng√¥i th·ª© 3 -> to be t∆∞∆°ng ·ª©ng ph·∫£i l√† "is".</p>
            <p><strong>4. T·∫°i sao sai?</strong> A d√πng cho "I", B d√πng cho s·ªë nhi·ªÅu. ƒê·ªÅu sai ng·ªØ ph√°p.</p>
        </div>
    </div>

    <div class="question-card" data-type="mcq" data-correct="A">
        <div class="question-text">8. ________ Lan going to work for Korean companies?</div>
        <div class="options-grid">
            <button class="option-btn" value="A">A. Is</button>
            <button class="option-btn" value="B">B. Are</button>
            <button class="option-btn" value="C">C. Does</button>
        </div>
        <div class="explanation">
            <h4>üí° Gi·∫£i th√≠ch chi ti·∫øt:</h4>
            <p><strong>1. D·ªãch c√¢u h·ªèi:</strong> Lan c√≥ d·ª± ƒë·ªãnh l√†m vi·ªác cho c√°c c√¥ng ty H√†n Qu·ªëc kh√¥ng?</p>
            <p><strong>2. Ph√¢n t√≠ch ƒë√°p √°n:</strong><br>A. Is: To be s·ªë √≠t.<br>B. Are: To be s·ªë nhi·ªÅu.<br>C. Does: Tr·ª£ ƒë·ªông t·ª´ hi·ªán t·∫°i ƒë∆°n s·ªë √≠t.</p>
            <p><strong>3. T·∫°i sao ch·ªçn A ƒë√∫ng?</strong> ƒê√¢y l√† c√¢u h·ªèi. Ch·ªß ng·ªØ <span class="highlight">"Lan"</span> l√† t√™n ng∆∞·ªùi (s·ªë √≠t). Ta ƒë·∫£o to be "Is" l√™n tr∆∞·ªõc ch·ªß ng·ªØ.</p>
            <p><strong>4. T·∫°i sao sai?</strong> B sai v√¨ "Lan" l√† s·ªë √≠t. C sai v√¨ c·∫•u tr√∫c "going to" ph·∫£i d√πng ƒë·ªông t·ª´ to be, kh√¥ng d√πng tr·ª£ ƒë·ªông t·ª´ Does.</p>
        </div>
    </div>

    <div class="question-card" data-type="mcq" data-correct="A">
        <div class="question-text">9. I failed the interview. My mom ________ be happy.</div>
        <div class="options-grid">
            <button class="option-btn" value="A">A. is not going to</button>
            <button class="option-btn" value="B">B. not going to</button>
            <button class="option-btn" value="C">C. aren't going to</button>
        </div>
        <div class="explanation">
            <h4>üí° Gi·∫£i th√≠ch chi ti·∫øt:</h4>
            <p><strong>1. D·ªãch c√¢u h·ªèi:</strong> T·ªõ ƒë√£ tr∆∞·ª£t bu·ªïi ph·ªèng v·∫•n. M·∫π t·ªõ s·∫Ω kh√¥ng vui ƒë√¢u.</p>
            <p><strong>2. Ph√¢n t√≠ch ƒë√°p √°n:</strong><br>A. is not going to: Ph·ªß ƒë·ªãnh, ƒë√∫ng to be "is" cho s·ªë √≠t.<br>B. not going to: Thi·∫øu ƒë·ªông t·ª´ to be.<br>C. aren't going to: Sai to be.</p>
            <p><strong>3. T·∫°i sao ch·ªçn A ƒë√∫ng?</strong> "My mom" l√† s·ªë √≠t -> d√πng "is". Th·ªÉ ph·ªß ƒë·ªãnh th√™m "not" v√†o ngay sau to be -> <span class="highlight">is not going to</span>.</p>
            <p><strong>4. T·∫°i sao sai?</strong> B thi·∫øu h·∫≥n to be. C sai v√¨ "My mom" kh√¥ng d√πng "aren't".</p>
        </div>
    </div>

    <div class="question-card" data-type="mcq" data-correct="B">
        <div class="question-text">10. We ________ visit our grandparents next Sunday.</div>
        <div class="options-grid">
            <button class="option-btn" value="A">A. going to</button>
            <button class="option-btn" value="B">B. are going to</button>
            <button class="option-btn" value="C">C. is going to</button>
        </div>
        <div class="explanation">
            <h4>üí° Gi·∫£i th√≠ch chi ti·∫øt:</h4>
            <p><strong>1. D·ªãch c√¢u h·ªèi:</strong> Ch√∫ng t·ªõ d·ª± ƒë·ªãnh s·∫Ω ƒëi thƒÉm √¥ng b√† v√†o Ch·ªß nh·∫≠t t·ªõi.</p>
            <p><strong>2. Ph√¢n t√≠ch ƒë√°p √°n:</strong> (Gi·ªëng c√°c c√¢u tr√™n)</p>
            <p><strong>3. T·∫°i sao ch·ªçn B ƒë√∫ng?</strong> Ch·ªß ng·ªØ <span class="highlight">"We"</span> (s·ªë nhi·ªÅu) b·∫Øt bu·ªôc ph·∫£i ƒëi v·ªõi to be "are". C·∫•u tr√∫c chu·∫©n: are going to + V(visit).</p>
            <p><strong>4. T·∫°i sao sai?</strong> A thi·∫øu to be. C sai to be (is d√πng cho s·ªë √≠t).</p>
        </div>
    </div>

    <h2 class="section-title">B√†i t·∫≠p 2: Chia ƒë·ªông t·ª´ trong ngo·∫∑c (10 c√¢u)</h2>
    <p><em>M·ª•c ti√™u: Th·ª±c h√†nh t·ª± g√µ ƒë√°p √°n ƒë√∫ng theo c√¥ng th·ª©c kh·∫≥ng ƒë·ªãnh, ph·ªß ƒë·ªãnh, nghi v·∫•n. (G·ª£i √Ω: am/is/are + going to + V)</em></p>

    <div id="conjugation-container">
        </div>

    <h2 class="section-title">B√†i t·∫≠p 3: S·∫Øp x·∫øp c√°c t·ª´ th√†nh c√¢u ho√†n ch·ªânh</h2>
    <p><em>M·ª•c ti√™u: N·∫Øm v·ªØng tr·∫≠t t·ª± t·ª´ (B·∫•m v√†o c√°c t·ª´ b√™n d∆∞·ªõi ƒë·ªÉ gh√©p th√†nh c√¢u ƒë√∫ng)</em></p>

    <div id="sort-container">
        </div>

    <h2 class="section-title">B√†i t·∫≠p 4: D·ª±a v√†o t√¨nh hu·ªëng ƒë·ªÉ vi·∫øt c√¢u</h2>
    <p><em>M·ª•c ti√™u: V·∫≠n d·ª•ng linh ho·∫°t v√†o ng·ªØ c·∫£nh th·ª±c t·∫ø. (G√µ to√†n b·ªô c√¢u ho√†n ch·ªânh v√†o √¥ tr·ªëng)</em></p>

    <div id="situation-container">
        </div>

</div>

<div class="submit-bar">
    <button class="submit-btn" id="submitBtn">N·ªòP B√ÄI & XEM ƒêI·ªÇM üèÜ</button>
</div>

<div class="modal" id="scoreModal">
    <div class="modal-content">
        <h2>üéâ CH√öC M·ª™NG üéâ</h2>
        <p id="scoreText">B·∫°n ƒë√£ tr·∫£ l·ªùi ƒë√∫ng 0 / 30 c√¢u.</p>
        <p id="complimentText" style="color: var(--primary-mint);"></p>
        <button class="check-btn" onclick="location.reload()" style="margin-top:20px;">L√†m l·∫°i b√†i</button>
    </div>
</div>

<script>
    /* --- AUDIO EFFECTS --- */
    const AudioContext = window.AudioContext || window.webkitAudioContext;
    let audioCtx = new AudioContext();

    function playDing() {
        if(audioCtx.state === 'suspended') audioCtx.resume();
        const osc = audioCtx.createOscillator();
        const gain = audioCtx.createGain();
        osc.connect(gain); gain.connect(audioCtx.destination);
        osc.type = 'sine';
        osc.frequency.setValueAtTime(800, audioCtx.currentTime);
        osc.frequency.exponentialRampToValueAtTime(1500, audioCtx.currentTime + 0.1);
        gain.gain.setValueAtTime(0, audioCtx.currentTime);
        gain.gain.linearRampToValueAtTime(0.3, audioCtx.currentTime + 0.05);
        gain.gain.exponentialRampToValueAtTime(0.01, audioCtx.currentTime + 0.5);
        osc.start(); osc.stop(audioCtx.currentTime + 0.5);
    }

    function playBuzz() {
        if(audioCtx.state === 'suspended') audioCtx.resume();
        const osc = audioCtx.createOscillator();
        const gain = audioCtx.createGain();
        osc.connect(gain); gain.connect(audioCtx.destination);
        osc.type = 'sawtooth';
        osc.frequency.setValueAtTime(150, audioCtx.currentTime);
        osc.frequency.exponentialRampToValueAtTime(100, audioCtx.currentTime + 0.3);
        gain.gain.setValueAtTime(0, audioCtx.currentTime);
        gain.gain.linearRampToValueAtTime(0.2, audioCtx.currentTime + 0.05);
        gain.gain.exponentialRampToValueAtTime(0.01, audioCtx.currentTime + 0.3);
        osc.start(); osc.stop(audioCtx.currentTime + 0.3);
    }

    /* --- CONFETTI EFFECT --- */
    const canvas = document.getElementById('confetti-canvas');
    const ctx = canvas.getContext('2d');
    canvas.width = window.innerWidth;
    canvas.height = window.innerHeight;
    let particles = [];
    function fireConfetti() {
        const colors = ['#00D26A', '#FF4757', '#FDCB6E', '#0984E3', '#8854C0'];
        for(let i=0; i<60; i++) {
            particles.push({
                x: window.innerWidth / 2, y: window.innerHeight / 2,
                r: Math.random() * 6 + 3,
                dx: Math.random() * 12 - 6, dy: Math.random() * -12 - 6,
                color: colors[Math.floor(Math.random() * colors.length)],
                tilt: Math.random() * 10
            });
        }
    }
    function animateConfetti() {
        requestAnimationFrame(animateConfetti);
        ctx.clearRect(0,0,canvas.width, canvas.height);
        particles.forEach((p, index) => {
            p.dy += 0.25; p.x += p.dx; p.y += p.dy; p.tilt += 0.1;
            ctx.beginPath(); ctx.lineWidth = p.r; ctx.strokeStyle = p.color;
            ctx.moveTo(p.x + p.tilt + p.r, p.y); ctx.lineTo(p.x + p.tilt, p.y + p.tilt + p.r); ctx.stroke();
            if(p.y > canvas.height) particles.splice(index, 1);
        });
    }
    animateConfetti();

    /* --- GLOBAL HELPERS --- */
    let score = 0;
    const TOTAL_QUESTIONS = 30;

    function shuffleArray(array) {
        for (let i = array.length - 1; i > 0; i--) {
            const j = Math.floor(Math.random() * (i + 1));
            [array[i], array[j]] = [array[j], array[i]];
        }
    }

    function cleanString(str) {
        // Lo·∫°i b·ªè kho·∫£ng tr·∫Øng th·ª´a, d·∫•u c√¢u ƒë·ªÉ so s√°nh d·ªÖ h∆°n cho h·ªçc sinh
        return str.toLowerCase().replace(/[.,!?]/g, '').replace(/\s+/g, ' ').trim();
    }

    /* --- EX 1: MCQ LOGIC --- */
    document.querySelectorAll('.question-card[data-type="mcq"]').forEach(card => {
        const correctAns = card.getAttribute('data-correct');
        const btns = Array.from(card.querySelectorAll('.option-btn'));
        const grid = card.querySelector('.options-grid');
        const exp = card.querySelector('.explanation');
        
        shuffleArray(btns);
        btns.forEach(btn => grid.appendChild(btn));

        let answered = false;
        btns.forEach(btn => {
            btn.addEventListener('click', () => {
                if(answered) return;
                answered = true;
                const isCorrect = btn.value === correctAns;
                
                if(isCorrect) {
                    btn.classList.add('correct'); playDing(); fireConfetti(); score++;
                } else {
                    btn.classList.add('wrong'); card.classList.add('shake'); playBuzz();
                    btns.find(b => b.value === correctAns).classList.add('correct');
                }
                exp.style.display = 'block';
            });
        });
    });

    /* --- EX 2: CONJUGATION (FILL IN THE BLANK) --- */
    const conjData = [
        { q: "I (buy) ________ a new bicycle next month.", ans: ["am going to buy", "'m going to buy"], vn: "T√¥i s·∫Ω mua m·ªôt chi·∫øc xe ƒë·∫°p m·ªõi v√†o th√°ng t·ªõi.", exp: "Ch·ªß ng·ªØ 'I' ƒëi v·ªõi 'am'. Kh·∫≥ng ƒë·ªãnh: am going to + buy." },
        { q: "She (not / visit) ________ Hanoi this summer.", ans: ["is not going to visit", "isn't going to visit"], vn: "C√¥ ·∫•y s·∫Ω kh√¥ng thƒÉm H√† N·ªôi v√†o m√πa h√® n√†y.", exp: "Ch·ªß ng·ªØ 'She' -> 'is'. Ph·ªß ƒë·ªãnh th√™m not -> is not going to / isn't going to + visit." },
        { q: "Look at the sky! It (rain) ________ heavily.", ans: ["is going to rain", "'s going to rain"], vn: "Nh√¨n b·∫ßu tr·ªùi k√¨a! Tr·ªùi s·∫Øp m∆∞a to r·ªìi.", exp: "Ch·ªß ng·ªØ 'It' -> 'is'. Kh·∫≥ng ƒë·ªãnh: is going to + rain." },
        { q: "(you / invite) ________ many friends to your party?", ans: ["are you going to invite"], vn: "B·∫°n c√≥ ƒë·ªãnh m·ªùi nhi·ªÅu b·∫°n b√® t·ªõi b·ªØa ti·ªác kh√¥ng?", exp: "C√¢u h·ªèi ƒë·∫£o 'Are' l√™n tr∆∞·ªõc 'you' -> Are you going to + invite." },
        { q: "They (build) ________ a new hospital in this area.", ans: ["are going to build", "'re going to build"], vn: "H·ªç d·ª± ƒë·ªãnh x√¢y m·ªôt b·ªánh vi·ªán m·ªõi ·ªü khu v·ª±c n√†y.", exp: "Ch·ªß ng·ªØ 'They' -> 'are'. Kh·∫≥ng ƒë·ªãnh: are going to + build." },
        { q: "He is very tired. He (sleep) ________ early tonight.", ans: ["is going to sleep", "'s going to sleep"], vn: "Anh ·∫•y r·∫•t m·ªát. Anh ·∫•y s·∫Ω ƒëi ng·ªß s·ªõm t·ªëi nay.", exp: "Ch·ªß ng·ªØ 'He' -> 'is'. Kh·∫≥ng ƒë·ªãnh: is going to + sleep." },
        { q: "We (not / play) ________ tennis tomorrow because it's too hot.", ans: ["are not going to play", "aren't going to play"], vn: "Ch√∫ng t√¥i s·∫Ω kh√¥ng ch∆°i tennis ng√†y mai v√¨ tr·ªùi qu√° n√≥ng.", exp: "Ch·ªß ng·ªØ 'We' -> 'are'. Ph·ªß ƒë·ªãnh -> are not / aren't going to + play." },
        { q: "(he / study) ________ abroad next year?", ans: ["is he going to study"], vn: "Anh ·∫•y s·∫Ω ƒëi du h·ªçc v√†o nƒÉm t·ªõi ch·ª©?", exp: "C√¢u h·ªèi ƒë·∫£o 'Is' l√™n tr∆∞·ªõc 'he' -> Is he going to + study." },
        { q: "The boat is full of water. It (sink) ________!", ans: ["is going to sink", "'s going to sink"], vn: "Thuy·ªÅn ƒë·∫ßy n∆∞·ªõc r·ªìi. N√≥ s·∫Øp ch√¨m!", exp: "Ch·ªß ng·ªØ 'It' -> 'is'. Kh·∫≥ng ƒë·ªãnh: is going to + sink." },
        { q: "I (clean) ________ my room this afternoon. I have already decided.", ans: ["am going to clean", "'m going to clean"], vn: "T·ªõ s·∫Ω d·ªçn ph√≤ng v√†o chi·ªÅu nay. T·ªõ ƒë√£ quy·∫øt ƒë·ªãnh r·ªìi.", exp: "Ch·ªß ng·ªØ 'I' -> 'am'. Kh·∫≥ng ƒë·ªãnh: am going to + clean." }
    ];

    const conjContainer = document.getElementById('conjugation-container');
    conjData.forEach((item, index) => {
        let qText = item.q.replace("________", `<input type="text" class="write-input" placeholder="Nh·∫≠p ƒë√°p √°n..." data-idx="${index}">`);
        let html = `
        <div class="question-card text-card">
            <div class="question-text">${index + 11}. ${qText}</div>
            <button class="check-btn" onclick="checkEx2(this, ${index})">Ki·ªÉm tra</button>
            <div class="explanation">
                <h4>üí° Gi·∫£i th√≠ch chi ti·∫øt:</h4>
                <p><strong>1. D·ªãch nghƒ©a:</strong> ${item.vn}</p>
                <p><strong>2. ƒê√°p √°n ƒë√∫ng:</strong> <span class="highlight">${item.ans[0]}</span></p>
                <p><strong>3. T·∫°i sao?:</strong> ${item.exp}</p>
            </div>
        </div>`;
        conjContainer.innerHTML += html;
    });

    window.checkEx2 = function(btn, idx) {
        const card = btn.closest('.text-card');
        const input = card.querySelector('.write-input');
        const exp = card.querySelector('.explanation');
        if(!input.value.trim()) return;

        btn.style.display = 'none';
        input.disabled = true;
        
        const userVal = cleanString(input.value);
        // Ki·ªÉm tra xem userVal c√≥ n·∫±m trong m·∫£ng c√°c ƒë√°p √°n ch·∫•p nh·∫≠n ƒë∆∞·ª£c kh√¥ng
        const isCorrect = conjData[idx].ans.some(a => cleanString(a) === userVal);

        if(isCorrect) {
            input.classList.add('correct'); playDing(); fireConfetti(); score++;
        } else {
            input.classList.add('wrong'); card.classList.add('shake'); playBuzz();
            input.value = `Sai! S·ª≠a l·∫°i: ${conjData[idx].ans[0]}`;
        }
        exp.style.display = 'block';
    }

    /* --- EX 3: SORT LOGIC --- */
    const sortData = [
        { words: ["is", "going", "to", "Minh", "America.", "work", "in"], ans: "Minh is going to work in America.", vn: "Minh s·∫Ω l√†m vi·ªác ·ªü M·ªπ.", exp: "Ch·ªß ng·ªØ (Minh) + is + going to + V (work) + in America." },
        { words: ["not", "Lan", "is", "going", "to", "for", "work", "Korean", "companies."], ans: "Lan is not going to work for Korean companies.", vn: "Lan s·∫Ω kh√¥ng l√†m vi·ªác cho c√°c c√¥ng ty H√†n Qu·ªëc.", exp: "C√¢u ph·ªß ƒë·ªãnh: S (Lan) + is not + going to + V (work) + for..." },
        { words: ["Are", "you", "to", "stay", "going", "her?", "with"], ans: "Are you going to stay with her?", vn: "B·∫°n s·∫Ω ·ªü l·∫°i v·ªõi c√¥ ·∫•y ch·ª©?", exp: "C√¢u nghi v·∫•n: ƒê·∫£o to be (Are) l√™n tr∆∞·ªõc ch·ªß ng·ªØ (you) + going to + V (stay) + with her?" },
        { words: ["look", "the", "clouds.", "at", "going", "rain.", "It", "is", "to"], ans: "look at the clouds. It is going to rain.", ansAlt: "Look at the clouds. It is going to rain.", vn: "Nh√¨n nh·ªØng ƒë√°m m√¢y k√¨a. Tr·ªùi s·∫Øp m∆∞a r·ªìi.", exp: "C√¢u c√≥ 2 v·∫ø: M·ªánh l·ªánh (Look at the clouds) v√† D·ª± ƒëo√°n (It is going to rain)." },
        { words: ["next", "We", "are", "going", "have", "week.", "a", "party", "to"], ans: "We are going to have a party next week.", vn: "Ch√∫ng t√¥i s·∫Ω t·ªï ch·ª©c m·ªôt b·ªØa ti·ªác v√†o tu·∫ßn t·ªõi.", exp: "Ch·ªß ng·ªØ (We) + are going to + V (have) + a party + tr·∫°ng t·ª´ th·ªùi gian (next week)." }
    ];

    const sortContainer = document.getElementById('sort-container');
    sortData.forEach((item, index) => {
        let card = document.createElement('div');
        card.className = 'question-card sort-card';
        card.innerHTML = `
            <div class="question-text">${index + 21}. S·∫Øp x·∫øp t·ª´:</div>
            <div class="answer-drop"></div>
            <div class="word-bank"></div>
            <div class="explanation">
                <h4>üí° Gi·∫£i th√≠ch chi ti·∫øt:</h4>
                <p><strong>1. D·ªãch nghƒ©a:</strong> ${item.vn}</p>
                <p><strong>2. C√¢u ho√†n ch·ªânh:</strong> <span class="highlight">${item.ans}</span></p>
                <p><strong>3. C·∫•u tr√∫c:</strong> ${item.exp}</p>
            </div>
        `;
        sortContainer.appendChild(card);

        const bank = card.querySelector('.word-bank');
        const drop = card.querySelector('.answer-drop');
        const exp = card.querySelector('.explanation');
        let shuffledWords = [...item.words];
        shuffleArray(shuffledWords);
        
        let answered = false;

        shuffledWords.forEach(w => {
            let pill = document.createElement('div');
            pill.className = 'word-pill'; pill.innerText = w;
            pill.onclick = function() {
                if(answered) return;
                if(this.parentElement === bank) drop.appendChild(this);
                else bank.appendChild(this);
                
                if(bank.children.length === 0) {
                    let userSentence = cleanString(Array.from(drop.children).map(c => c.innerText).join(' '));
                    let correctAns = cleanString(item.ans);
                    let altAns = item.ansAlt ? cleanString(item.ansAlt) : null;

                    answered = true;
                    if(userSentence === correctAns || userSentence === altAns) {
                        drop.style.borderColor = 'var(--correct-green)';
                        drop.style.backgroundColor = 'rgba(0, 210, 106, 0.1)';
                        playDing(); fireConfetti(); score++;
                    } else {
                        drop.style.borderColor = 'var(--wrong-red)';
                        drop.style.backgroundColor = 'rgba(255, 71, 87, 0.1)';
                        card.classList.add('shake'); playBuzz();
                        drop.innerHTML = ''; // Reset and show correct
                        item.ans.split(' ').forEach(aw => {
                            let correctPill = document.createElement('div');
                            correctPill.className = 'word-pill';
                            correctPill.style.backgroundColor = 'var(--correct-green)';
                            correctPill.innerText = aw;
                            drop.appendChild(correctPill);
                        });
                    }
                    exp.style.display = 'block';
                }
            };
            bank.appendChild(pill);
        });
    });

    /* --- EX 4: SITUATION LOGIC --- */
    const sitData = [
        { q: "B·∫ßu tr·ªùi ƒëang ƒë·∫ßy m√¢y ƒëen. (It / rain)", ans: ["It is going to rain", "It's going to rain"], vn: "Tr·ªùi s·∫Øp m∆∞a.", exp: "C√≥ b·∫±ng ch·ª©ng 'm√¢y ƒëen' -> It + is going to + rain." },
        { q: "B·∫°n ƒë√£ l√™n k·∫ø ho·∫°ch l√†m b√†i t·∫≠p v·ªÅ nh√† v√†o t·ªëi nay. (I / do / my homework / tonight)", ans: ["I am going to do my homework tonight", "I'm going to do my homework tonight"], vn: "T√¥i s·∫Ω l√†m b√†i t·∫≠p v·ªÅ nh√† t·ªëi nay.", exp: "K·∫ø ho·∫°ch c√° nh√¢n 'I' -> am going to + do." },
        { q: "B·∫°n th·∫•y m·ªôt c·∫≠u b√© ƒëang ch·∫°y kh√¥ng nh√¨n ƒë∆∞·ªùng v√† c√≥ m·ªôt c√°i h·ªë (hole) ph√≠a tr∆∞·ªõc. (He / fall / into the hole)", ans: ["He is going to fall into the hole", "He's going to fall into the hole"], vn: "C·∫≠u b√© s·∫Øp ng√£ xu·ªëng h·ªë.", exp: "D·ª± ƒëo√°n c√≥ b·∫±ng ch·ª©ng r√µ r√†ng -> He is going to + fall." },
        { q: "Lan ƒë√£ mua v√© m√°y bay ƒëi ƒê√† N·∫µng v√†o ng√†y mai. (Lan / fly / to Da Nang / tomorrow)", ans: ["Lan is going to fly to Da Nang tomorrow"], vn: "Lan s·∫Ω bay v√†o ƒê√† N·∫µng ng√†y mai.", exp: "ƒê√£ c√≥ k·∫ø ho·∫°ch (mua v√©) -> Lan is going to + fly." },
        { q: "ƒêi·ªÉm s·ªë c·ªßa b·∫°n r·∫•t th·∫•p v√† b·∫°n bi·∫øt m·∫π s·∫Ω kh√¥ng vui. (My mom / not / be / happy)", ans: ["My mom is not going to be happy", "My mom isn't going to be happy"], vn: "M·∫π t√¥i s·∫Ω kh√¥ng vui.", exp: "D·ª± ƒëo√°n ch·∫Øc ch·∫Øn x·∫£y ra -> My mom + is + not + going to + be happy." }
    ];

    const sitContainer = document.getElementById('situation-container');
    sitData.forEach((item, index) => {
        let html = `
        <div class="question-card text-card">
            <div class="question-text" style="font-size: 1.15rem; color: #2d3436; font-weight:700">${index + 26}. T√¨nh hu·ªëng: ${item.q}</div>
            <div class="text-input-group">
                <input type="text" class="write-input" placeholder="Vi·∫øt c√¢u ho√†n ch·ªânh t·∫°i ƒë√¢y..." data-idx="${index}">
                <button class="check-btn" onclick="checkEx4(this, ${index})">G·ª≠i</button>
            </div>
            <div class="explanation">
                <h4>üí° Gi·∫£i th√≠ch chi ti·∫øt:</h4>
                <p><strong>1. C√¢u ho√†n ch·ªânh:</strong> <span class="highlight">${item.ans[0]}.</span></p>
                <p><strong>2. D·ªãch nghƒ©a:</strong> ${item.vn}</p>
                <p><strong>3. T·∫°i sao?:</strong> ${item.exp}</p>
            </div>
        </div>`;
        sitContainer.innerHTML += html;
    });

    window.checkEx4 = function(btn, idx) {
        const card = btn.closest('.text-card');
        const input = card.querySelector('.write-input');
        const exp = card.querySelector('.explanation');
        if(!input.value.trim()) return;

        btn.style.display = 'none';
        input.disabled = true;
        
        const userVal = cleanString(input.value);
        const isCorrect = sitData[idx].ans.some(a => cleanString(a) === userVal);

        if(isCorrect) {
            input.classList.add('correct'); playDing(); fireConfetti(); score++;
        } else {
            input.classList.add('wrong'); card.classList.add('shake'); playBuzz();
            input.value = `Sai! ƒê√°p √°n: ${sitData[idx].ans[0]}`;
        }
        exp.style.display = 'block';
    }

    /* --- SUBMIT MODAL --- */
    document.getElementById('submitBtn').addEventListener('click', () => {
        const modal = document.getElementById('scoreModal');
        const scoreText = document.getElementById('scoreText');
        const compText = document.getElementById('complimentText');
        
        scoreText.innerText = `B·∫°n ƒë√£ tr·∫£ l·ªùi ƒë√∫ng ${score} / ${TOTAL_QUESTIONS} c√¢u.`;
        
        let msg = "";
        if(score === TOTAL_QUESTIONS) msg = "ƒê·ªânh c·ªßa ch√≥p! B·∫°n hi·ªÉu b√†i T∆∞∆°ng lai g·∫ßn 100% r·ªìi! üåüüåüüåü";
        else if(score >= 25) msg = "Gi·ªèi l·∫Øm! C·∫•u tr√∫c be going to qu√° d·ªÖ v·ªõi b·∫°n! üî•";
        else if(score >= 15) msg = "Kh√° l·∫Øm, ƒë·ªçc l·∫°i ph·∫ßn L√Ω thuy·∫øt m·ªôt x√≠u l√† ho√†n h·∫£o! üí™";
        else msg = "ƒê·ª´ng bu·ªìn, xem k·ªπ ph·∫ßn gi·∫£i th√≠ch l√† l·∫ßn sau s·∫Ω ƒë√∫ng h·∫øt nha! ‚ù§Ô∏è";
        
        compText.innerText = msg;
        modal.style.display = 'flex';
        
        if(score >= 15) fireConfetti();
    });
</script>

</body>
</html>