<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Luy·ªán t·∫≠p Ng·ªØ √Çm & Tr·ªçng √Çm - Ms Mai An ULIS</title>
    <!-- Google Fonts: Nunito for friendly look -->
    <link href="https://fonts.googleapis.com/css2?family=Nunito:wght@400;600;700;800&display=swap" rel="stylesheet">
    <!-- Font Awesome -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <!-- Tailwind CSS (CDN for single file) -->
    <script src="https://cdn.tailwindcss.com"></script>
    <!-- Confetti Library -->
    <script src="https://cdn.jsdelivr.net/npm/canvas-confetti@1.6.0/dist/confetti.browser.min.js"></script>
    
    <script>
        tailwind.config = {
            theme: {
                extend: {
                    fontFamily: {
                        sans: ['Nunito', 'sans-serif'],
                    },
                    colors: {
                        primary: '#8854C0',    // T√≠m h·ªìng ch·ªß ƒë·∫°o
                        secondary: '#00C9A7',  // Xanh ng·ªçc
                        correct: '#00D26A',    // Xanh l√° ƒë√∫ng
                        wrong: '#FF4757',      // ƒê·ªè sai
                        surface: '#ffffff',
                    },
                    boxShadow: {
                        '3d': '0 6px 0 0 rgba(0,0,0,0.15)',
                        '3d-active': '0 2px 0 0 rgba(0,0,0,0.15)',
                        'card': '0 10px 25px -5px rgba(136, 84, 192, 0.2)',
                    }
                }
            }
        }
    </script>

    <style>
        body {
            background-color: #F3E5F5;
            background-image: radial-gradient(#8854C0 1px, transparent 1px), radial-gradient(#8854C0 1px, transparent 1px);
            background-position: 0 0, 25px 25px;
            background-size: 50px 50px;
            opacity: 1;
        }

        /* 3D Button Styles */
        .btn-option {
            transition: all 0.1s;
            border: 2px solid transparent;
        }
        .btn-option:active {
            transform: translateY(4px);
            box-shadow: 0 2px 0 0 rgba(0,0,0,0.1) !important;
        }
        
        /* Animation Classes */
        @keyframes shake {
            0% { transform: translateX(0); }
            25% { transform: translateX(-5px) rotate(-2deg); }
            50% { transform: translateX(5px) rotate(2deg); }
            75% { transform: translateX(-5px) rotate(-2deg); }
            100% { transform: translateX(0); }
        }
        .animate-shake {
            animation: shake 0.4s ease-in-out;
        }

        @keyframes pop {
            0% { transform: scale(1); }
            50% { transform: scale(1.05); }
            100% { transform: scale(1); }
        }
        .animate-pop {
            animation: pop 0.3s ease-in-out;
        }

        .correct-answer {
            background-color: #00D26A !important;
            color: white !important;
            border-color: #00b359 !important;
            box-shadow: 0 6px 0 0 #00994d !important;
        }

        .wrong-answer {
            background-color: #FF4757 !important;
            color: white !important;
            border-color: #ff2e40 !important;
            box-shadow: 0 6px 0 0 #e60017 !important;
        }
        
        /* Explanation Box Styling */
        .explanation-box {
            border-left: 5px solid #8854C0;
            background: #F8F0FF;
        }

        .highlight-text {
            color: #8854C0;
            font-weight: 800;
        }

        /* Custom Scrollbar */
        ::-webkit-scrollbar {
            width: 8px;
        }
        ::-webkit-scrollbar-track {
            background: #f1f1f1; 
        }
        ::-webkit-scrollbar-thumb {
            background: #8854C0; 
            border-radius: 4px;
        }
    </style>
</head>
<body class="min-h-screen flex flex-col items-center py-6 px-4 selection:bg-purple-200 selection:text-purple-900">

    <!-- Header -->
    <header class="w-full max-w-3xl flex justify-between items-center mb-6 bg-white p-4 rounded-2xl shadow-card border-b-4 border-purple-200">
        <div class="flex items-center gap-3">
            <div class="bg-purple-100 p-2 rounded-full">
                <i class="fa-solid fa-graduation-cap text-2xl text-primary"></i>
            </div>
            <div>
                <h1 class="font-extrabold text-xl text-gray-800">English Practice</h1>
                <p class="text-sm text-primary font-bold">Ms Mai An ULIS</p>
            </div>
        </div>
        <div class="flex items-center gap-4">
            <div class="bg-green-100 px-4 py-2 rounded-xl border-2 border-green-200">
                <span class="text-green-700 font-bold"><i class="fa-solid fa-check mr-2"></i><span id="score-display">0</span></span>
            </div>
        </div>
    </header>

    <!-- Progress Bar -->
    <div class="w-full max-w-3xl mb-6 px-1">
        <div class="flex justify-between text-sm font-bold text-gray-600 mb-2">
            <span>C√¢u h·ªèi: <span id="current-question-num">1</span>/<span id="total-question-num">20</span></span>
            <span id="progress-percent">0%</span>
        </div>
        <div class="w-full bg-white rounded-full h-4 border-2 border-white shadow-sm overflow-hidden">
            <div id="progress-bar" class="bg-secondary h-full rounded-full transition-all duration-500 ease-out" style="width: 0%"></div>
        </div>
    </div>

    <!-- Main Quiz Area -->
    <main id="quiz-container" class="w-full max-w-3xl relative perspective-1000">
        <!-- Question Card -->
        <div class="bg-white rounded-3xl shadow-card p-6 md:p-8 border-b-8 border-gray-100 relative overflow-hidden">
            
            <!-- Question Tag -->
            <div class="mb-4">
                <span id="question-type-badge" class="inline-block px-3 py-1 bg-purple-100 text-primary text-xs font-extrabold rounded-full uppercase tracking-wider mb-2">
                    Phonetics
                </span>
                <h2 id="question-text" class="text-xl md:text-2xl font-bold text-gray-800 leading-relaxed">
                    <!-- Question text goes here -->
                </h2>
                <p id="question-hint" class="text-gray-500 text-sm italic mt-2 flex items-center gap-2">
                    <i class="fa-regular fa-lightbulb text-yellow-500"></i> <span id="hint-text"></span>
                </p>
            </div>

            <!-- Options Grid -->
            <div id="options-container" class="grid grid-cols-1 md:grid-cols-2 gap-4 mt-6">
                <!-- Options will be injected here -->
            </div>

            <!-- Explanation Area (Hidden by default) -->
            <div id="explanation-container" class="hidden mt-8 animate-pop">
                <div class="explanation-box p-5 rounded-xl text-gray-700 text-sm md:text-base leading-relaxed shadow-sm">
                    <div class="flex items-center gap-2 mb-3">
                        <img src="https://ui-avatars.com/api/?name=Mai+An&background=8854C0&color=fff&rounded=true&size=32" alt="Avatar" class="w-8 h-8 shadow-sm">
                        <h3 class="font-bold text-primary text-lg">C√¥ Mai An gi·∫£i th√≠ch chi ti·∫øt:</h3>
                    </div>
                    <div id="explanation-content" class="space-y-3">
                        <!-- Content goes here -->
                    </div>
                </div>
                
                <!-- Next Button -->
                <div class="mt-6 flex justify-end">
                    <button id="next-btn" class="bg-secondary hover:bg-teal-400 text-white font-bold py-3 px-8 rounded-xl shadow-3d active:shadow-3d-active active:translate-y-1 transition-all flex items-center gap-2 text-lg">
                        Ti·∫øp theo <i class="fa-solid fa-arrow-right"></i>
                    </button>
                </div>
            </div>
        </div>
    </main>

    <!-- Result Modal -->
    <div id="result-modal" class="fixed inset-0 bg-black/60 backdrop-blur-sm z-50 hidden flex items-center justify-center p-4">
        <div class="bg-white rounded-3xl shadow-2xl p-8 max-w-md w-full text-center relative border-t-8 border-primary animate-pop">
            <div class="absolute -top-12 left-1/2 transform -translate-x-1/2 bg-white p-4 rounded-full shadow-xl border-4 border-primary">
                <i class="fa-solid fa-trophy text-4xl text-yellow-400"></i>
            </div>
            
            <h2 class="text-3xl font-extrabold text-gray-800 mt-8 mb-2">Ho√†n th√†nh!</h2>
            <p id="result-message" class="text-gray-500 mb-6 font-semibold">B·∫°n ƒë√£ l√†m r·∫•t t·ªët!</p>
            
            <div class="bg-purple-50 rounded-2xl p-6 mb-8">
                <div class="text-4xl font-extrabold text-primary mb-1" id="final-score">0/20</div>
                <div class="text-sm text-gray-400 font-bold uppercase tracking-widest">C√¢u ƒë√∫ng</div>
            </div>

            <button onclick="location.reload()" class="w-full bg-primary hover:bg-purple-600 text-white font-bold py-4 rounded-xl shadow-3d active:shadow-3d-active active:translate-y-1 transition-all text-lg">
                <i class="fa-solid fa-rotate-right mr-2"></i> L√†m l·∫°i b√†i
            </button>
        </div>
    </div>

    <!-- Audio Elements (Base64 for single file portability) -->
    <!-- Sound: Ding (Correct) -->
    <audio id="sound-correct" src="data:audio/mp3;base64,//NExAAAAANIAAAAAExBTUUzLjEwMKqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqq//NExAAAAANIAAAAAExBTUUzLjEwMKqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqq//NExAAAAANIAAAAAExBTUUzLjEwMKqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqq//NExAAAAANIAAAAAExBTUUzLjEwMKqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqq"></audio>
    <!-- We will rely on simple oscillator for sounds to keep file small and reliable if base64 is too long, implementing simple beep in JS below -->

    <script>
        // --- 1. GAME DATA (FROM USER INPUT) ---
        const rawData = {
          "questions": [
            {
              "id": 1,
              "type": "pronunciation",
              "question": "Mark the letter A, B, C, or D to indicate the word whose underlined part differs from the other three in pronunciation.",
              "hint": "Ch√∫ √Ω ƒë·∫øn ph·ª• √¢m ƒë·∫ßu c·ªßa c√°c t·ª´ n√†y (ƒë·∫∑c bi·ªát l√† ch·ªØ 'h').",
              "options": [
                { "text": "sour", "ipa": "/sa ä…ôr/", "meaning": "chua", "correct": false, "note": "Ph·ª• √¢m ƒë·∫ßu /s/ ƒë∆∞·ª£c ph√°t √¢m r√µ." },
                { "text": "hour", "ipa": "/a ä…ôr/", "meaning": "gi·ªù", "correct": true, "note": "ƒê√¢y l√† t·ª´ duy nh·∫•t c√≥ ch·ªØ **'h' b·ªã c√¢m**." },
                { "text": "south", "ipa": "/sa äŒ∏/", "meaning": "ph√≠a nam", "correct": false, "note": "Ph·ª• √¢m ƒë·∫ßu /s/ ƒë∆∞·ª£c ph√°t √¢m r√µ." },
                { "text": "mouse", "ipa": "/ma äs/", "meaning": "con chu·ªôt", "correct": false, "note": "Ph·ª• √¢m ƒë·∫ßu /m/ ƒë∆∞·ª£c ph√°t √¢m r√µ." }
              ]
            },
            {
              "id": 2,
              "type": "pronunciation",
              "question": "Mark the letter A, B, C, or D to indicate the word whose underlined part differs from the other three in pronunciation.",
              "hint": "Ch√∫ √Ω c√°ch ph√°t √¢m ch·ªØ 'g'.",
              "options": [
                { "text": "guide", "ipa": "/…°a…™d/", "meaning": "h∆∞·ªõng d·∫´n", "correct": false, "note": "Ch·ªØ 'g' ph√°t √¢m l√† /…°/." },
                { "text": "guest", "ipa": "/…°est/", "meaning": "kh√°ch", "correct": false, "note": "Ch·ªØ 'g' ph√°t √¢m l√† /…°/." },
                { "text": "gate", "ipa": "/…°e…™t/", "meaning": "c·ªïng", "correct": false, "note": "Ch·ªØ 'g' ph√°t √¢m l√† /…°/." },
                { "text": "general", "ipa": "/Ààd íen.…ôr.…ôl/", "meaning": "chung/t∆∞·ªõng", "correct": true, "note": "Ch·ªØ 'g' ph√°t √¢m l√† **/d í/** (gi·ªëng 'gi')." }
              ]
            },
            {
              "id": 3,
              "type": "pronunciation",
              "question": "Mark the letter A, B, C, or D to indicate the word whose underlined part differs from the other three in pronunciation.",
              "hint": "Quy t·∫Øc ph√°t √¢m ƒëu√¥i -ed.",
              "options": [
                { "text": "booked", "ipa": "/b äkt/", "meaning": "ƒë√£ ƒë·∫∑t ch·ªó", "correct": false, "note": "ƒêu√¥i -ed ph√°t √¢m l√† /t/." },
                { "text": "visited", "ipa": "/Ààv…™z.…™.t…™d/", "meaning": "ƒë√£ gh√© thƒÉm", "correct": true, "note": "ƒêu√¥i -ed ph√°t √¢m l√† **/…™d/** (sau √¢m t, d)." },
                { "text": "traveled", "ipa": "/Ààtr√¶v.…ôld/", "meaning": "ƒë√£ du l·ªãch", "correct": false, "note": "ƒêu√¥i -ed ph√°t √¢m l√† /d/." },
                { "text": "stayed", "ipa": "/ste…™d/", "meaning": "ƒë√£ ·ªü l·∫°i", "correct": false, "note": "ƒêu√¥i -ed ph√°t √¢m l√† /d/." }
              ]
            },
            {
              "id": 4,
              "type": "pronunciation",
              "question": "Mark the letter A, B, C, or D to indicate the word whose underlined part differs from the other three in pronunciation.",
              "hint": "Ch√∫ √Ω c·ª•m nguy√™n √¢m 'ea'.",
              "options": [
                { "text": "beach", "ipa": "/biÀêt É/", "meaning": "b√£i bi·ªÉn", "correct": false, "note": "'ea' ph√°t √¢m l√† /iÀê/." },
                { "text": "seat", "ipa": "/siÀêt/", "meaning": "ch·ªó ng·ªìi", "correct": false, "note": "'ea' ph√°t √¢m l√† /iÀê/." },
                { "text": "meal", "ipa": "/miÀêl/", "meaning": "b·ªØa ƒÉn", "correct": false, "note": "'ea' ph√°t √¢m l√† /iÀê/." },
                { "text": "break", "ipa": "/bre…™k/", "meaning": "ngh·ªâ ng∆°i/v·ª°", "correct": true, "note": "'ea' ph√°t √¢m l√† **/e…™/**." }
              ]
            },
            {
              "id": 5,
              "type": "pronunciation",
              "question": "Mark the letter A, B, C, or D to indicate the word whose underlined part differs from the other three in pronunciation.",
              "hint": "Ch√∫ √Ω ch·ªØ 'c'.",
              "options": [
                { "text": "camera", "ipa": "/Ààk√¶m.r…ô/", "meaning": "m√°y ·∫£nh", "correct": false, "note": "Ch·ªØ 'c' ph√°t √¢m l√† /k/." },
                { "text": "coast", "ipa": "/k…ô äst/", "meaning": "b·ªù bi·ªÉn", "correct": false, "note": "Ch·ªØ 'c' ph√°t √¢m l√† /k/." },
                { "text": "cruise", "ipa": "/kruÀêz/", "meaning": "du thuy·ªÅn", "correct": false, "note": "Ch·ªØ 'c' ph√°t √¢m l√† /k/." },
                { "text": "city", "ipa": "/Ààs…™t.i/", "meaning": "th√†nh ph·ªë", "correct": true, "note": "Ch·ªØ 'c' ph√°t √¢m l√† **/s/**." }
              ]
            },
            {
              "id": 6,
              "type": "pronunciation",
              "question": "Mark the letter A, B, C, or D to indicate the word whose underlined part differs from the other three in pronunciation.",
              "hint": "Ch√∫ √Ω c√°c ch·ªØ c√°i b·ªã c√¢m (silent letters).",
              "options": [
                { "text": "island", "ipa": "/Ààa…™.l…ônd/", "meaning": "h√≤n ƒë·∫£o", "correct": true, "note": "Ch·ªØ **'s' b·ªã c√¢m** ho√†n to√†n." },
                { "text": "castle", "ipa": "/Ààk…ëÀê.sl/", "meaning": "l√¢u ƒë√†i", "correct": false, "note": "Ch·ªØ 't' c√¢m, nh∆∞ng 's' v·∫´n ph√°t √¢m." },
                { "text": "famous", "ipa": "/Ààfe…™.m…ôs/", "meaning": "n·ªïi ti·∫øng", "correct": false, "note": "Ch·ªØ 's' ph√°t √¢m l√† /s/." },
                { "text": "travel", "ipa": "/Ààtr√¶v.…ôl/", "meaning": "du l·ªãch", "correct": false, "note": "Kh√¥ng c√≥ √¢m c√¢m." }
              ]
            },
            {
              "id": 7,
              "type": "pronunciation",
              "question": "Mark the letter A, B, C, or D to indicate the word whose underlined part differs from the other three in pronunciation.",
              "hint": "Ch√∫ √Ω √¢m 'o'.",
              "options": [
                { "text": "hotel", "ipa": "/h…ô äÀàtel/", "meaning": "kh√°ch s·∫°n", "correct": false, "note": "√Çm 'o' l√† /…ô ä/." },
                { "text": "motel", "ipa": "/m…ô äÀàtel/", "meaning": "nh√† ngh·ªâ", "correct": false, "note": "√Çm 'o' l√† /…ô ä/." },
                { "text": "local", "ipa": "/Ààl…ô ä.kl/", "meaning": "ƒë·ªãa ph∆∞∆°ng", "correct": false, "note": "√Çm 'o' l√† /…ô ä/." },
                { "text": "today", "ipa": "/t…ôÀàde…™/", "meaning": "h√¥m nay", "correct": true, "note": "√Çm 'o' ƒë·ªçc l∆∞·ªõt th√†nh **/…ô/**." }
              ]
            },
            {
              "id": 8,
              "type": "pronunciation",
              "question": "Mark the letter A, B, C, or D to indicate the word whose underlined part differs from the other three in pronunciation.",
              "hint": "Ch√∫ √Ω √¢m 'i'.",
              "options": [
                { "text": "sign", "ipa": "/sa…™n/", "meaning": "bi·ªÉn b√°o", "correct": true, "note": "Ch·ªØ 'i' ph√°t √¢m l√† **/a…™/**." },
                { "text": "trip", "ipa": "/tr…™p/", "meaning": "chuy·∫øn ƒëi", "correct": false, "note": "Ch·ªØ 'i' ph√°t √¢m l√† /…™/." },
                { "text": "ticket", "ipa": "/Ààt…™k.…™t/", "meaning": "v√©", "correct": false, "note": "Ch·ªØ 'i' ph√°t √¢m l√† /…™/." },
                { "text": "city", "ipa": "/Ààs…™t.i/", "meaning": "th√†nh ph·ªë", "correct": false, "note": "Ch·ªØ 'i' ph√°t √¢m l√† /…™/." }
              ]
            },
            {
              "id": 9,
              "type": "pronunciation",
              "question": "Mark the letter A, B, C, or D to indicate the word whose underlined part differs from the other three in pronunciation.",
              "hint": "Ch√∫ √Ω ch·ªØ 'c'.",
              "options": [
                { "text": "place", "ipa": "/ple…™s/", "meaning": "n∆°i ch·ªën", "correct": false, "note": "Ch·ªØ 'c' ph√°t √¢m l√† /s/." },
                { "text": "center", "ipa": "/Ààsen.t…ôr/", "meaning": "trung t√¢m", "correct": false, "note": "Ch·ªØ 'c' ph√°t √¢m l√† /s/." },
                { "text": "exciting", "ipa": "/…™kÀàsa…™.t…™≈ã/", "meaning": "th√∫ v·ªã", "correct": false, "note": "Ch·ªØ 'c' ph√°t √¢m l√† /s/." },
                { "text": "cat", "ipa": "/k√¶t/", "meaning": "con m√®o", "correct": true, "note": "Ch·ªØ 'c' ph√°t √¢m l√† **/k/**." }
              ]
            },
            {
              "id": 10,
              "type": "pronunciation",
              "question": "Mark the letter A, B, C, or D to indicate the word whose underlined part differs from the other three in pronunciation.",
              "hint": "Ch√∫ √Ω √¢m 'u'.",
              "options": [
                { "text": "museum", "ipa": "/mjuÀêÀàziÀê.…ôm/", "meaning": "b·∫£o t√†ng", "correct": true, "note": "Ch·ªØ 'u' ph√°t √¢m l√† **/juÀê/**." },
                { "text": "bus", "ipa": "/b ås/", "meaning": "xe bu√Ωt", "correct": false, "note": "Ch·ªØ 'u' ph√°t √¢m l√† / å/." },
                { "text": "summer", "ipa": "/Ààs åm.…ôr/", "meaning": "m√πa h√®", "correct": false, "note": "Ch·ªØ 'u' ph√°t √¢m l√† / å/." },
                { "text": "luggage", "ipa": "/Ààl å…°.…™d í/", "meaning": "h√†nh l√Ω", "correct": false, "note": "Ch·ªØ 'u' ph√°t √¢m l√† / å/." }
              ]
            },
            {
              "id": 11,
              "type": "stress",
              "question": "Mark the letter A, B, C, or D to indicate the word that differs from the other three in the position of primary stress.",
              "hint": "Danh t·ª´ 2 √¢m ti·∫øt th∆∞·ªùng nh·∫•n √¢m 1, nh∆∞ng c√≥ ngo·∫°i l·ªá.",
              "options": [
                { "text": "picnic", "ipa": "/Ààp…™k.n…™k/", "meaning": "d√£ ngo·∫°i", "correct": false, "note": "Tr·ªçng √¢m 1." },
                { "text": "sunset", "ipa": "/Ààs ån.set/", "meaning": "ho√†ng h√¥n", "correct": false, "note": "Tr·ªçng √¢m 1." },
                { "text": "valley", "ipa": "/Ààv√¶l.i/", "meaning": "thung l≈©ng", "correct": false, "note": "Tr·ªçng √¢m 1." },
                { "text": "safari", "ipa": "/s…ôÀàf…ëÀê.ri/", "meaning": "cu·ªôc ƒëi sƒÉn", "correct": true, "note": "Tr·ªçng √¢m r∆°i v√†o **√¢m ti·∫øt 2**." }
              ]
            },
            {
              "id": 12,
              "type": "stress",
              "question": "Mark the letter A, B, C, or D to indicate the word that differs from the other three in the position of primary stress.",
              "hint": "T√¨m t·ª´ c√≥ tr·ªçng √¢m r∆°i v√†o √¢m ti·∫øt th·ª© 2.",
              "options": [
                { "text": "departure", "ipa": "/d…™Ààp…ëÀê.t É…ôr/", "meaning": "s·ª± kh·ªüi h√†nh", "correct": true, "note": "Tr·ªçng √¢m r∆°i v√†o **√¢m ti·∫øt 2**." },
                { "text": "entrance", "ipa": "/Ààen.tr…ôns/", "meaning": "l·ªëi v√†o", "correct": false, "note": "Tr·ªçng √¢m 1." },
                { "text": "baggage", "ipa": "/Ààb√¶…°.…™d í/", "meaning": "h√†nh l√Ω", "correct": false, "note": "Tr·ªçng √¢m 1." },
                { "text": "terminal", "ipa": "/Ààt…úÀê.m…™.n…ôl/", "meaning": "nh√† ga", "correct": false, "note": "Tr·ªçng √¢m 1." }
              ]
            },
            {
              "id": 13,
              "type": "stress",
              "question": "Mark the letter A, B, C, or D to indicate the word that differs from the other three in the position of primary stress.",
              "hint": "T√¨m t·ª´ nh·∫•n √¢m 2.",
              "options": [
                { "text": "adventure", "ipa": "/…ôdÀàven.t É…ôr/", "meaning": "cu·ªôc phi√™u l∆∞u", "correct": true, "note": "Tr·ªçng √¢m r∆°i v√†o **√¢m ti·∫øt 2**." },
                { "text": "waterfall", "ipa": "/Ààw…îÀê.t…ô.f…îÀêl/", "meaning": "th√°c n∆∞·ªõc", "correct": false, "note": "Tr·ªçng √¢m 1." },
                { "text": "mountain", "ipa": "/Ààma än.t…™n/", "meaning": "ng·ªçn n√∫i", "correct": false, "note": "Tr·ªçng √¢m 1." },
                { "text": "wildlife", "ipa": "/Ààwa…™ld.la…™f/", "meaning": "ƒë·ªông v·∫≠t hoang d√£", "correct": false, "note": "Tr·ªçng √¢m 1." }
              ]
            },
            {
              "id": 14,
              "type": "stress",
              "question": "Mark the letter A, B, C, or D to indicate the word that differs from the other three in the position of primary stress.",
              "hint": "Quy t·∫Øc ƒëu√¥i -tion.",
              "options": [
                { "text": "nature", "ipa": "/Ààne…™.t É…ôr/", "meaning": "thi√™n nhi√™n", "correct": false, "note": "Tr·ªçng √¢m 1." },
                { "text": "ocean", "ipa": "/Àà…ô ä. É…ôn/", "meaning": "ƒë·∫°i d∆∞∆°ng", "correct": false, "note": "Tr·ªçng √¢m 1." },
                { "text": "destination", "ipa": "/Àådes.t…™Ààne…™. É…ôn/", "meaning": "ƒëi·ªÉm ƒë·∫øn", "correct": true, "note": "Tr·ªçng √¢m r∆°i v√†o **√¢m ti·∫øt 3** (tr∆∞·ªõc -tion)." },
                { "text": "heritage", "ipa": "/Ààher.…™.t…™d í/", "meaning": "di s·∫£n", "correct": false, "note": "Tr·ªçng √¢m 1." }
              ]
            },
            {
              "id": 15,
              "type": "stress",
              "question": "Mark the letter A, B, C, or D to indicate the word that differs from the other three in the position of primary stress.",
              "hint": "T√¨m t·ª´ nh·∫•n √¢m 2.",
              "options": [
                { "text": "guidebook", "ipa": "/Àà…°a…™d.b äk/", "meaning": "s√°ch h∆∞·ªõng d·∫´n", "correct": false, "note": "Tr·ªçng √¢m 1." },
                { "text": "outdoor", "ipa": "/Ààa ät.d…îÀêr/", "meaning": "ngo√†i tr·ªùi", "correct": false, "note": "Tr·ªçng √¢m 1." },
                { "text": "reception", "ipa": "/r…™Ààsep. É…ôn/", "meaning": "l·ªÖ t√¢n", "correct": true, "note": "Tr·ªçng √¢m r∆°i v√†o **√¢m ti·∫øt 2**." },
                { "text": "leisure", "ipa": "/Ààle í.…ôr/", "meaning": "s·ª± th∆∞ nh√†n", "correct": false, "note": "Tr·ªçng √¢m 1." }
              ]
            },
            {
              "id": 16,
              "type": "stress",
              "question": "Mark the letter A, B, C, or D to indicate the word that differs from the other three in the position of primary stress.",
              "hint": "T√¨m t·ª´ nh·∫•n √¢m 2.",
              "options": [
                { "text": "restaurant", "ipa": "/Ààres.t…ír.…ínt/", "meaning": "nh√† h√†ng", "correct": false, "note": "Tr·ªçng √¢m 1." },
                { "text": "umbrella", "ipa": "/ åmÀàbrel.…ô/", "meaning": "c√°i √¥", "correct": true, "note": "Tr·ªçng √¢m r∆°i v√†o **√¢m ti·∫øt 2**." },
                { "text": "festival", "ipa": "/Ààfes.t…™.v…ôl/", "meaning": "l·ªÖ h·ªôi", "correct": false, "note": "Tr·ªçng √¢m 1." },
                { "text": "photograph", "ipa": "/Ààf…ô ä.t…ô.…°r…ëÀêf/", "meaning": "b·ª©c ·∫£nh", "correct": false, "note": "Tr·ªçng √¢m 1." }
              ]
            },
            {
              "id": 17,
              "type": "stress",
              "question": "Mark the letter A, B, C, or D to indicate the word that differs from the other three in the position of primary stress.",
              "hint": "T√¨m t·ª´ nh·∫•n √¢m 2 (ƒë·ªông t·ª´/ti·ªÅn t·ªë ex-).",
              "options": [
                { "text": "foreign", "ipa": "/Ààf…ír.…ôn/", "meaning": "n∆∞·ªõc ngo√†i", "correct": false, "note": "Tr·ªçng √¢m 1." },
                { "text": "exchange", "ipa": "/…™ksÀàt Ée…™nd í/", "meaning": "trao ƒë·ªïi", "correct": true, "note": "Tr·ªçng √¢m r∆°i v√†o **√¢m ti·∫øt 2**." },
                { "text": "quarter", "ipa": "/Ààkw…îÀê.t…ôr/", "meaning": "m·ªôt ph·∫ßn t∆∞", "correct": false, "note": "Tr·ªçng √¢m 1." },
                { "text": "gallery", "ipa": "/Àà…°√¶l.…ôr.i/", "meaning": "ph√≤ng tr∆∞ng b√†y", "correct": false, "note": "Tr·ªçng √¢m 1." }
              ]
            },
            {
              "id": 18,
              "type": "stress",
              "question": "Mark the letter A, B, C, or D to indicate the word that differs from the other three in the position of primary stress.",
              "hint": "T√¨m t·ª´ nh·∫•n √¢m 2.",
              "options": [
                { "text": "vacation", "ipa": "/ve…™Ààke…™. É…ôn/", "meaning": "k·ª≥ ngh·ªâ", "correct": true, "note": "Tr·ªçng √¢m r∆°i v√†o **√¢m ti·∫øt 2**." },
                { "text": "monument", "ipa": "/Ààm…ín.j…ô.m…ônt/", "meaning": "ƒë√†i t∆∞·ªüng ni·ªám", "correct": false, "note": "Tr·ªçng √¢m 1." },
                { "text": "boarding", "ipa": "/Ààb…îÀê.d…™≈ã/", "meaning": "l√™n t√†u", "correct": false, "note": "Tr·ªçng √¢m 1." },
                { "text": "national", "ipa": "/Ààn√¶ É.…ôn.…ôl/", "meaning": "thu·ªôc qu·ªëc gia", "correct": false, "note": "Tr·ªçng √¢m 1." }
              ]
            },
            {
              "id": 19,
              "type": "stress",
              "question": "Mark the letter A, B, C, or D to indicate the word that differs from the other three in the position of primary stress.",
              "hint": "ƒê·∫øm s·ªë √¢m ti·∫øt v√† t√¨m tr·ªçng √¢m.",
              "options": [
                { "text": "historic", "ipa": "/h…™Ààst…ír.…™k/", "meaning": "mang t√≠nh l·ªãch s·ª≠", "correct": false, "note": "Tr·ªçng √¢m 2." },
                { "text": "activity", "ipa": "/√¶kÀàt…™v.…ô.ti/", "meaning": "ho·∫°t ƒë·ªông", "correct": false, "note": "Tr·ªçng √¢m 2." },
                { "text": "itinerary", "ipa": "/a…™Ààt…™n.…ôr.…ôr.i/", "meaning": "l·ªãch tr√¨nh", "correct": false, "note": "Tr·ªçng √¢m 2." },
                { "text": "information", "ipa": "/Àå…™n.f…ôÀàme…™. É…ôn/", "meaning": "th√¥ng tin", "correct": true, "note": "Tr·ªçng √¢m r∆°i v√†o **√¢m ti·∫øt 3**." }
              ]
            },
            {
              "id": 20,
              "type": "stress",
              "question": "Mark the letter A, B, C, or D to indicate the word that differs from the other three in the position of primary stress.",
              "hint": "T√¨m t·ª´ nh·∫•n √¢m 2.",
              "options": [
                { "text": "uniform", "ipa": "/ÀàjuÀê.n…™.f…îÀêm/", "meaning": "ƒë·ªìng ph·ª•c", "correct": false, "note": "Tr·ªçng √¢m 1." },
                { "text": "climate", "ipa": "/Ààkla…™.m…ôt/", "meaning": "kh√≠ h·∫≠u", "correct": false, "note": "Tr·ªçng √¢m 1." },
                { "text": "distance", "ipa": "/Ààd…™s.t…ôns/", "meaning": "kho·∫£ng c√°ch", "correct": false, "note": "Tr·ªçng √¢m 1." },
                { "text": "location", "ipa": "/l…ô äÀàke…™. É…ôn/", "meaning": "v·ªã tr√≠", "correct": true, "note": "Tr·ªçng √¢m r∆°i v√†o **√¢m ti·∫øt 2**." }
              ]
            }
          ]
        };

        // --- 2. GAME LOGIC ---

        let quizData = rawData.questions;
        let currentQuestionIndex = 0;
        let score = 0;
        let isAnswered = false;

        // Shuffle function (Fisher-Yates)
        function shuffleArray(array) {
            for (let i = array.length - 1; i > 0; i--) {
                const j = Math.floor(Math.random() * (i + 1));
                [array[i], array[j]] = [array[j], array[i]];
            }
        }

        // Initialize Game
        function initGame() {
            shuffleArray(quizData);
            score = 0;
            currentQuestionIndex = 0;
            updateScoreUI();
            loadQuestion();
        }

        // Render Sounds
        const audioCtx = new (window.AudioContext || window.webkitAudioContext)();
        
        function playTone(freq, type, duration) {
            const osc = audioCtx.createOscillator();
            const gain = audioCtx.createGain();
            osc.type = type;
            osc.frequency.value = freq;
            osc.connect(gain);
            gain.connect(audioCtx.destination);
            osc.start();
            gain.gain.exponentialRampToValueAtTime(0.00001, audioCtx.currentTime + duration);
            osc.stop(audioCtx.currentTime + duration);
        }

        function playCorrectSound() {
            playTone(600, 'sine', 0.1);
            setTimeout(() => playTone(800, 'sine', 0.2), 100);
        }

        function playWrongSound() {
            playTone(150, 'sawtooth', 0.3);
            setTimeout(() => playTone(100, 'sawtooth', 0.3), 200);
        }

        // Load Question UI
        function loadQuestion() {
            const q = quizData[currentQuestionIndex];
            isAnswered = false;

            // UI Elements
            document.getElementById('current-question-num').innerText = currentQuestionIndex + 1;
            document.getElementById('total-question-num').innerText = quizData.length;
            document.getElementById('progress-percent').innerText = Math.round(((currentQuestionIndex) / quizData.length) * 100) + '%';
            document.getElementById('progress-bar').style.width = ((currentQuestionIndex) / quizData.length) * 100 + '%';
            
            // Text
            document.getElementById('question-type-badge').innerText = q.type === 'stress' ? 'Tr·ªçng √¢m (Stress)' : 'Ng·ªØ √¢m (Pronunciation)';
            document.getElementById('question-text').innerHTML = `Question ${currentQuestionIndex + 1}: ${q.question}`;
            document.getElementById('hint-text').innerText = q.hint;
            
            // Reset Explanation
            document.getElementById('explanation-container').classList.add('hidden');
            
            // Options
            const optionsContainer = document.getElementById('options-container');
            optionsContainer.innerHTML = '';

            q.options.forEach((opt, index) => {
                const btn = document.createElement('button');
                btn.className = `btn-option w-full bg-white text-gray-700 font-bold py-4 px-6 rounded-2xl shadow-3d border-b-4 border-gray-200 hover:bg-purple-50 hover:border-purple-300 text-left transition-all flex justify-between items-center group`;
                btn.innerHTML = `
                    <span class="text-lg"><span class="inline-block w-8 h-8 bg-gray-100 text-gray-500 rounded-full text-center leading-8 mr-3 text-sm group-hover:bg-primary group-hover:text-white transition-colors">${String.fromCharCode(65 + index)}</span> ${opt.text}</span>
                    <i class="fa-regular fa-circle text-gray-300 text-xl status-icon"></i>
                `;
                btn.onclick = () => checkAnswer(btn, opt, index);
                optionsContainer.appendChild(btn);
            });
        }

        // Check Answer Logic
        function checkAnswer(btn, option, index) {
            if (isAnswered) return;
            isAnswered = true;

            const q = quizData[currentQuestionIndex];
            const allBtns = document.querySelectorAll('.btn-option');

            // Find correct index
            const correctIndex = q.options.findIndex(o => o.correct);
            const correctBtn = allBtns[correctIndex];

            if (option.correct) {
                // CORRECT
                score++;
                updateScoreUI();
                playCorrectSound();
                
                // Style Correct Button
                btn.classList.add('correct-answer');
                btn.querySelector('.status-icon').className = 'fa-solid fa-circle-check text-white text-xl';
                
                // Confetti
                confetti({
                    particleCount: 100,
                    spread: 70,
                    origin: { y: 0.6 },
                    colors: ['#00C9A7', '#8854C0', '#FFD700']
                });

            } else {
                // WRONG
                playWrongSound();
                
                // Style Wrong Button
                btn.classList.add('wrong-answer', 'animate-shake');
                btn.querySelector('.status-icon').className = 'fa-solid fa-circle-xmark text-white text-xl';
                
                // Show Correct Button
                correctBtn.classList.add('bg-green-100', 'border-green-300', 'text-green-700');
                correctBtn.querySelector('.status-icon').className = 'fa-regular fa-circle-check text-green-500 text-xl';
            }

            showExplanation(q);
        }

        function updateScoreUI() {
            document.getElementById('score-display').innerText = score;
        }

        // Generate and Show Explanation
        function showExplanation(q) {
            const container = document.getElementById('explanation-container');
            const content = document.getElementById('explanation-content');
            
            // Generate HTML for explanation
            let html = `
                <div class="mb-4 text-gray-600 italic border-l-4 border-gray-300 pl-3">
                    "D·ªãch ƒë·ªÅ b√†i: ${q.type === 'stress' ? 'Ch·ªçn t·ª´ c√≥ v·ªã tr√≠ tr·ªçng √¢m ch√≠nh kh√°c v·ªõi ba t·ª´ c√≤n l·∫°i.' : 'Ch·ªçn t·ª´ c√≥ ph·∫ßn g·∫°ch ch√¢n ph√°t √¢m kh√°c v·ªõi ba t·ª´ c√≤n l·∫°i.'}"
                </div>
                <div class="grid grid-cols-1 gap-2">
            `;

            q.options.forEach((opt, idx) => {
                const isCorrect = opt.correct;
                const label = String.fromCharCode(65 + idx);
                html += `
                    <div class="p-2 rounded-lg ${isCorrect ? 'bg-green-50 border border-green-200' : 'bg-white border border-gray-100'}">
                        <span class="font-bold ${isCorrect ? 'text-green-600' : 'text-gray-500'}">${label}. ${opt.text}</span> 
                        <span class="text-purple-600 font-mono text-sm mx-1">[${opt.ipa}]</span>
                        <span class="text-gray-500 text-sm">(${opt.meaning})</span>
                        <div class="text-sm mt-1 text-gray-700 ${isCorrect ? 'font-bold' : ''}"><i class="fa-solid fa-angle-right text-xs mr-1"></i> ${opt.note}</div>
                    </div>
                `;
            });

            html += `</div>`;
            
            // Add final conclusion
            const correctOpt = q.options.find(o => o.correct);
            html += `
                <div class="mt-4 p-3 bg-purple-100 rounded-lg text-primary font-bold text-center">
                    <i class="fa-solid fa-star text-yellow-500 mr-1"></i> ƒê√°p √°n ƒë√∫ng l√†: <span class="text-lg uppercase">${correctOpt.text}</span>
                </div>
            `;

            content.innerHTML = html;
            container.classList.remove('hidden');
            
            // Scroll to explanation on mobile
            if(window.innerWidth < 768) {
                setTimeout(() => {
                    container.scrollIntoView({behavior: 'smooth', block: 'start'});
                }, 300);
            }
        }

        // Next Button Logic
        document.getElementById('next-btn').addEventListener('click', () => {
            if (currentQuestionIndex < quizData.length - 1) {
                currentQuestionIndex++;
                loadQuestion();
                window.scrollTo({top: 0, behavior: 'smooth'});
            } else {
                finishQuiz();
            }
        });

        function finishQuiz() {
            const modal = document.getElementById('result-modal');
            const finalScore = document.getElementById('final-score');
            const msg = document.getElementById('result-message');
            
            finalScore.innerText = `${score}/${quizData.length}`;
            
            const percentage = (score / quizData.length) * 100;
            if (percentage === 100) {
                msg.innerText = "Tuy·ªát v·ªùi! B·∫°n l√† thi√™n t√†i ng·ªØ √¢m! üåü";
                confetti({ particleCount: 200, spread: 100, origin: { y: 0.6 } });
            } else if (percentage >= 80) {
                msg.innerText = "Gi·ªèi l·∫Øm! Ch·ªâ c·∫ßn c·∫©n th·∫≠n h∆°n ch√∫t x√≠u th√¥i! üí™";
            } else if (percentage >= 50) {
                msg.innerText = "Kh√° t·ªët! H√£y luy·ªán t·∫≠p th√™m ƒë·ªÉ ƒëi·ªÉm cao h∆°n nh√©! üìö";
            } else {
                msg.innerText = "ƒê·ª´ng bu·ªìn nh√©! H√£y xem l·∫°i ph·∫ßn gi·∫£i th√≠ch v√† th·ª≠ l·∫°i n√†o! üî•";
            }
            
            modal.classList.remove('hidden');
        }

        // Start Game
        initGame();

    </script>
</body>
</html>
