<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Ms Mai An ULIS - English Master Test</title>
    <link href="https://fonts.googleapis.com/css2?family=Nunito:wght@400;600;700;900&display=swap" rel="stylesheet">
    <script src="https://cdn.jsdelivr.net/npm/canvas-confetti@1.6.0/dist/confetti.browser.min.js"></script>
    
    <style>
        :root {
            --primary-pink: #8854C0;
            --primary-teal: #00C9A7;
            --correct-green: #00D26A;
            --wrong-red: #FF4757;
            --bg-color: #F0F4F8;
            --card-bg: #FFFFFF;
            --text-main: #2D3436;
        }

        body {
            font-family: 'Nunito', sans-serif;
            background-color: var(--primary-pink);
            background-image: radial-gradient(var(--primary-teal) 15%, transparent 16%),
            radial-gradient(var(--primary-teal) 15%, transparent 16%);
            background-size: 60px 60px;
            background-position: 0 0, 30px 30px;
            margin: 0;
            padding: 20px;
            color: var(--text-main);
        }

        .container {
            max-width: 800px;
            margin: 0 auto;
        }

        /* HEADER */
        header {
            text-align: center;
            background: white;
            padding: 15px;
            border-radius: 20px;
            box-shadow: 0 8px 0 rgba(0,0,0,0.1);
            margin-bottom: 30px;
            position: relative;
            border: 4px solid var(--primary-teal);
        }

        h1 {
            font-size: 1.5rem;
            color: var(--primary-pink);
            margin: 0;
            font-weight: 900;
            text-transform: uppercase;
        }

        .score-board {
            margin-top: 10px;
            font-size: 1.2rem;
            font-weight: bold;
            color: var(--primary-teal);
        }

        /* CARD STYLE */
        .card {
            background: var(--card-bg);
            border-radius: 20px;
            padding: 25px;
            margin-bottom: 30px;
            box-shadow: 0 10px 0 rgba(0,0,0,0.1);
            transition: transform 0.3s ease;
            position: relative;
            border: 2px solid #eee;
        }

        .question-title {
            font-size: 1.1rem;
            color: #636e72;
            margin-bottom: 10px;
            font-weight: 700;
            text-transform: uppercase;
            border-bottom: 2px dashed #dfe6e9;
            padding-bottom: 5px;
        }

        .question-text {
            font-size: 1.3rem;
            font-weight: 700;
            margin-bottom: 20px;
            line-height: 1.5;
        }

        .question-text u {
            color: var(--primary-pink);
            text-decoration-thickness: 3px;
            text-underline-offset: 4px;
        }

        /* OPTIONS GRID */
        .options-grid {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 15px;
        }

        @media (max-width: 600px) {
            .options-grid {
                grid-template-columns: 1fr;
            }
        }

        .option-btn {
            background: white;
            border: 2px solid #dfe6e9;
            border-radius: 15px;
            padding: 15px 20px;
            font-size: 1.1rem;
            font-family: 'Nunito', sans-serif;
            font-weight: 700;
            color: var(--text-main);
            cursor: pointer;
            transition: all 0.2s;
            box-shadow: 0 4px 0 #dfe6e9;
            text-align: left;
            position: relative;
        }

        .option-btn:hover:not(.disabled) {
            transform: scale(1.02);
            border-color: var(--primary-teal);
        }

        .option-btn:active:not(.disabled) {
            transform: translateY(4px);
            box-shadow: none;
        }

        /* STATES */
        .option-btn.correct {
            background-color: var(--correct-green);
            color: white;
            border-color: #00b85c;
            box-shadow: 0 4px 0 #00b85c;
        }

        .option-btn.wrong {
            background-color: var(--wrong-red);
            color: white;
            border-color: #ff3344;
            box-shadow: 0 4px 0 #ff3344;
            animation: shake 0.5s;
        }

        .option-btn.disabled {
            cursor: default;
            opacity: 0.7;
            pointer-events: none;
        }

        /* EXPLANATION BOX */
        .explanation {
            display: none;
            margin-top: 20px;
            background: #f1faff;
            border: 2px solid var(--primary-teal);
            border-radius: 15px;
            padding: 20px;
            animation: slideDown 0.4s ease-out;
        }

        .exp-header {
            font-weight: 900;
            color: var(--primary-pink);
            display: flex;
            align-items: center;
            gap: 10px;
            margin-bottom: 15px;
            font-size: 1.1rem;
        }

        .exp-content p {
            margin: 8px 0;
            line-height: 1.6;
        }

        .exp-translation {
            color: #2d3436;
            font-style: italic;
            background: #fff;
            padding: 10px;
            border-radius: 10px;
            border-left: 4px solid var(--primary-teal);
            margin-bottom: 15px;
        }

        .vocab-list {
            list-style: none;
            padding: 0;
            margin: 10px 0;
        }

        .vocab-item {
            background: white;
            padding: 8px 12px;
            margin-bottom: 5px;
            border-radius: 8px;
            border: 1px solid #eee;
            font-size: 0.95rem;
        }

        .vocab-word {
            font-weight: 800;
            color: var(--primary-pink);
        }

        .why-correct {
            color: var(--correct-green);
            font-weight: bold;
        }

        .why-wrong {
            color: var(--wrong-red);
            font-size: 0.9rem;
        }

        /* SUBMIT BUTTON */
        .submit-section {
            text-align: center;
            margin-top: 40px;
            padding-bottom: 50px;
        }

        .btn-submit {
            background: var(--primary-pink);
            color: white;
            font-size: 1.5rem;
            padding: 15px 50px;
            border: none;
            border-radius: 50px;
            font-family: 'Nunito', sans-serif;
            font-weight: 900;
            cursor: pointer;
            box-shadow: 0 8px 0 #6c429c;
            transition: all 0.2s;
        }

        .btn-submit:hover {
            transform: scale(1.05);
        }

        .btn-submit:active {
            transform: translateY(8px);
            box-shadow: none;
        }

        /* ANIMATIONS */
        @keyframes shake {
            0% { transform: translateX(0); }
            25% { transform: translateX(-10px); }
            50% { transform: translateX(10px); }
            75% { transform: translateX(-10px); }
            100% { transform: translateX(0); }
        }

        @keyframes slideDown {
            from { opacity: 0; transform: translateY(-10px); }
            to { opacity: 1; transform: translateY(0); }
        }

    </style>
</head>
<body>

<div class="container">
    <header>
        <h1>Ms Mai An ULIS - B√†i Ki·ªÉm Tra T∆∞∆°ng T√°c</h1>
        <div class="score-board">ƒêi·ªÉm s·ªë: <span id="currentScore">0</span> / <span id="totalQuestions">0</span></div>
    </header>

    <div id="quiz-container">
        </div>

    <div class="submit-section">
        <button class="btn-submit" onclick="finishQuiz()">N·ªôp B√†i & Xem T·ªïng K·∫øt</button>
    </div>
</div>

<script>
    // --- DATABASE: N·ªòI DUNG ƒê·ªÄ B√ÄI V√Ä GI·∫¢I TH√çCH ---
    const quizData = [
        // --- EXERCISE 4: CLOSEST MEANING ---
        {
            id: "4-1",
            type: "closest",
            title: "Exercise 4: CLOSEST MEANING",
            question: "It is <u>important</u> to contain and properly dispose of hazardous materials to prevent environmental contamination.",
            options: [
                { id: "A", text: "crucial", meaning: "quan tr·ªçng, c·ªët y·∫øu", type: "adj" },
                { id: "B", text: "unnecessary", meaning: "kh√¥ng c·∫ßn thi·∫øt", type: "adj" },
                { id: "C", text: "unimportant", meaning: "kh√¥ng quan tr·ªçng", type: "adj" },
                { id: "D", text: "careful", meaning: "c·∫©n th·∫≠n", type: "adj" }
            ],
            correct: "A",
            translation: "Vi·ªác ch·ª©a v√† x·ª≠ l√Ω ƒë√∫ng c√°ch c√°c v·∫≠t li·ªáu nguy hi·ªÉm ƒë·ªÉ ngƒÉn ng·ª´a √¥ nhi·ªÖm m√¥i tr∆∞·ªùng l√† r·∫•t quan tr·ªçng.",
            explanation: "T·ª´ ƒë∆∞·ª£c g·∫°ch ch√¢n (d·ª±a v√†o ng·ªØ c·∫£nh c√°c ƒë√°p √°n) l√† 'important'. <br><b>Crucial</b> (quan tr·ªçng/c·ªët y·∫øu) ƒë·ªìng nghƒ©a v·ªõi <b>Important</b>. C√°c ƒë√°p √°n B v√† C tr√°i nghƒ©a. D kh√¥ng ph√π h·ª£p ng·ªØ nghƒ©a."
        },
        {
            id: "4-2",
            type: "closest",
            title: "Exercise 4: CLOSEST MEANING",
            question: "The government should strictly regulate and <u>permit</u> industrial activities to minimize their impact on the environment.",
            options: [
                { id: "A", text: "dismiss", meaning: "sa th·∫£i, b√°c b·ªè", type: "v" },
                { id: "B", text: "allow", meaning: "cho ph√©p", type: "v" },
                { id: "C", text: "protect", meaning: "b·∫£o v·ªá", type: "v" },
                { id: "D", text: "reduce", meaning: "gi·∫£m b·ªõt", type: "v" }
            ],
            correct: "B",
            translation: "Ch√≠nh ph·ªß n√™n quy ƒë·ªãnh nghi√™m ng·∫∑t v√† c·∫•p ph√©p cho c√°c ho·∫°t ƒë·ªông c√¥ng nghi·ªáp ƒë·ªÉ gi·∫£m thi·ªÉu t√°c ƒë·ªông c·ªßa ch√∫ng l√™n m√¥i tr∆∞·ªùng.",
            explanation: "T·ª´ g·∫°ch ch√¢n l√† 'permit' (cho ph√©p). <br><b>Allow</b> ƒë·ªìng nghƒ©a v·ªõi <b>Permit</b>. <br>Dismiss (b√°c b·ªè) v√† Reduce (gi·∫£m) sai nghƒ©a ho√†n to√†n."
        },
        {
            id: "4-3",
            type: "closest",
            title: "Exercise 4: CLOSEST MEANING",
            question: "The residents of the community actively <u>participate in</u> environmental conservation efforts.",
            options: [
                { id: "A", text: "throw", meaning: "n√©m", type: "v" },
                { id: "B", text: "ignore", meaning: "ph·ªõt l·ªù", type: "v" },
                { id: "C", text: "impact", meaning: "t√°c ƒë·ªông", type: "v" },
                { id: "D", text: "take part", meaning: "tham gia", type: "v" }
            ],
            correct: "D",
            translation: "C∆∞ d√¢n trong c·ªông ƒë·ªìng t√≠ch c·ª±c tham gia v√†o c√°c n·ªó l·ª±c b·∫£o t·ªìn m√¥i tr∆∞·ªùng.",
            explanation: "C·ª•m t·ª´ <b>participate in</b> ƒë·ªìng nghƒ©a v·ªõi <b>take part (in)</b> (tham gia). <br>Ignore (ph·ªõt l·ªù) l√† tr√°i nghƒ©a."
        },
        {
            id: "4-4",
            type: "closest",
            title: "Exercise 4: CLOSEST MEANING",
            question: "Protecting the environment is crucial for maintaining a <u>diverse</u> range of ecosystems.",
            options: [
                { id: "A", text: "varied", meaning: "ƒëa d·∫°ng, nhi·ªÅu lo·∫°i", type: "adj" },
                { id: "B", text: "same", meaning: "gi·ªëng nhau", type: "adj" },
                { id: "C", text: "similar", meaning: "t∆∞∆°ng t·ª±", type: "adj" },
                { id: "D", text: "polluted", meaning: "b·ªã √¥ nhi·ªÖm", type: "adj" }
            ],
            correct: "A",
            translation: "B·∫£o v·ªá m√¥i tr∆∞·ªùng l√† r·∫•t quan tr·ªçng ƒë·ªÉ duy tr√¨ m·ªôt lo·∫°t c√°c h·ªá sinh th√°i ƒëa d·∫°ng.",
            explanation: "T·ª´ 'diverse' nghƒ©a l√† ƒëa d·∫°ng. <br><b>Varied</b> (ƒëa d·∫°ng/kh√°c nhau) l√† t·ª´ ƒë·ªìng nghƒ©a g·∫ßn nh·∫•t. <br>Same v√† Similar mang nghƒ©a gi·ªëng nhau (ng∆∞·ª£c l·∫°i)."
        },
        {
            id: "4-5",
            type: "closest",
            title: "Exercise 4: CLOSEST MEANING",
            question: "The release of <u>toxic</u> chemicals into the environment poses a serious threat to ecosystems and human health.",
            options: [
                { id: "A", text: "cause", meaning: "nguy√™n nh√¢n", type: "n/v" },
                { id: "B", text: "deadly", meaning: "ch·∫øt ng∆∞·ªùi, ƒë·ªôc h·∫°i", type: "adj" },
                { id: "C", text: "coral", meaning: "san h√¥", type: "n" },
                { id: "D", text: "volunteer", meaning: "t√¨nh nguy·ªán vi√™n", type: "n" }
            ],
            correct: "B",
            translation: "Vi·ªác th·∫£i c√°c h√≥a ch·∫•t ƒë·ªôc h·∫°i ra m√¥i tr∆∞·ªùng g√¢y ra m·ªëi ƒëe d·ªça nghi√™m tr·ªçng cho h·ªá sinh th√°i v√† s·ª©c kh·ªèe con ng∆∞·ªùi.",
            explanation: "T·ª´ 'toxic' nghƒ©a l√† ƒë·ªôc h·∫°i. <br><b>Deadly</b> (g√¢y ch·∫øt ng∆∞·ªùi) c√≥ nghƒ©a g·∫ßn nh·∫•t trong ng·ªØ c·∫£nh n√†y. <br>Coral v√† Volunteer kh√¥ng li√™n quan v·ªÅ lo·∫°i t·ª´ v√† nghƒ©a."
        },

        // --- EXERCISE 5: OPPOSITE MEANING ---
        {
            id: "5-1",
            type: "opposite",
            title: "Exercise 5: OPPOSITE MEANING",
            question: "We should <u>save</u> energy by using energy-efficient appliances and adopting sustainable practices.",
            options: [
                { id: "A", text: "store", meaning: "l∆∞u tr·ªØ", type: "v" },
                { id: "B", text: "waste", meaning: "l√£ng ph√≠", type: "v" },
                { id: "C", text: "renew", meaning: "l√†m m·ªõi", type: "v" },
                { id: "D", text: "resident", meaning: "c∆∞ d√¢n", type: "n" }
            ],
            correct: "B",
            translation: "Ch√∫ng ta n√™n ti·∫øt ki·ªám nƒÉng l∆∞·ª£ng b·∫±ng c√°ch s·ª≠ d·ª•ng c√°c thi·∫øt b·ªã ti·∫øt ki·ªám ƒëi·ªán v√† √°p d·ª•ng c√°c th√≥i quen b·ªÅn v·ªØng.",
            explanation: "<b>Save</b> (ti·∫øt ki·ªám) >< <b>Waste</b> (l√£ng ph√≠). <br>Store l√† l∆∞u tr·ªØ (g·∫ßn nghƒ©a). Resident l√† danh t·ª´ (sai lo·∫°i t·ª´)."
        },
        {
            id: "5-2",
            type: "opposite",
            title: "Exercise 5: OPPOSITE MEANING",
            question: "It is our responsibility to <u>protect</u> the environment and preserve it for future generations.",
            options: [
                { id: "A", text: "destroy", meaning: "ph√° h·ªßy", type: "v" },
                { id: "B", text: "cover", meaning: "che ph·ªß", type: "v" },
                { id: "C", text: "little", meaning: "nh·ªè/√≠t", type: "adj" },
                { id: "D", text: "contain", meaning: "ch·ª©a ƒë·ª±ng/k√¨m h√£m", type: "v" }
            ],
            correct: "A",
            translation: "Tr√°ch nhi·ªám c·ªßa ch√∫ng ta l√† b·∫£o v·ªá m√¥i tr∆∞·ªùng v√† gi·ªØ g√¨n n√≥ cho c√°c th·∫ø h·ªá t∆∞∆°ng lai.",
            explanation: "<b>Protect</b> (b·∫£o v·ªá) >< <b>Destroy</b> (ph√° h·ªßy). <br>C√°c t·ª´ c√≤n l·∫°i kh√¥ng t·∫°o th√†nh c·∫∑p tr√°i nghƒ©a h·ª£p l√Ω."
        },
        {
            id: "5-3",
            type: "opposite",
            title: "Exercise 5: OPPOSITE MEANING",
            question: "Implementing measures to <u>reduce</u> greenhouse gas emissions is crucial in combating climate change.",
            options: [
                { id: "A", text: "decrease", meaning: "gi·∫£m", type: "v" },
                { id: "B", text: "cut down", meaning: "c·∫Øt gi·∫£m", type: "v" },
                { id: "C", text: "minimize", meaning: "gi·∫£m thi·ªÉu", type: "v" },
                { id: "D", text: "increase", meaning: "tƒÉng l√™n", type: "v" }
            ],
            correct: "D",
            translation: "Th·ª±c hi·ªán c√°c bi·ªán ph√°p ƒë·ªÉ gi·∫£m l∆∞·ª£ng kh√≠ th·∫£i nh√† k√≠nh l√† r·∫•t quan tr·ªçng trong vi·ªác ch·ªëng bi·∫øn ƒë·ªïi kh√≠ h·∫≠u.",
            explanation: "<b>Reduce</b> (gi·∫£m) >< <b>Increase</b> (tƒÉng). <br>Decrease, Cut down, Minimize ƒë·ªÅu l√† t·ª´ ƒë·ªìng nghƒ©a v·ªõi Reduce."
        },
        {
            id: "5-4",
            type: "opposite",
            title: "Exercise 5: OPPOSITE MEANING",
            question: "Remember to <u>turn off</u> lights and electronic devices when they are not in use to conserve energy.",
            options: [
                { id: "A", text: "switch on", meaning: "b·∫≠t l√™n", type: "v" },
                { id: "B", text: "turn down", meaning: "v·∫∑n nh·ªè", type: "v" },
                { id: "C", text: "go over", meaning: "ki·ªÉm tra k·ªπ", type: "v" },
                { id: "D", text: "go away", meaning: "ƒëi kh·ªèi", type: "v" }
            ],
            correct: "A",
            translation: "H√£y nh·ªõ t·∫Øt ƒë√®n v√† c√°c thi·∫øt b·ªã ƒëi·ªán t·ª≠ khi kh√¥ng s·ª≠ d·ª•ng ƒë·ªÉ ti·∫øt ki·ªám nƒÉng l∆∞·ª£ng.",
            explanation: "<b>Turn off</b> (t·∫Øt) >< <b>Switch on</b> (b·∫≠t). <br>Turn down l√† v·∫∑n nh·ªè √¢m l∆∞·ª£ng/nhi·ªát ƒë·ªô."
        },
        {
            id: "5-5",
            type: "opposite",
            title: "Exercise 5: OPPOSITE MEANING",
            question: "Cleaning up <u>polluted</u> water sources is a challenging task that requires collaboration and expertise.",
            options: [
                { id: "A", text: "contaminated", meaning: "b·ªã nhi·ªÖm b·∫©n", type: "adj" },
                { id: "B", text: "forget", meaning: "qu√™n", type: "v" },
                { id: "C", text: "pure", meaning: "tinh khi·∫øt, s·∫°ch", type: "adj" },
                { id: "D", text: "non-living", meaning: "v√¥ tri v√¥ gi√°c", type: "adj" }
            ],
            correct: "C",
            translation: "L√†m s·∫°ch c√°c ngu·ªìn n∆∞·ªõc b·ªã √¥ nhi·ªÖm l√† m·ªôt nhi·ªám v·ª• ƒë·∫ßy th√°ch th·ª©c ƒë√≤i h·ªèi s·ª± h·ª£p t√°c v√† chuy√™n m√¥n.",
            explanation: "<b>Polluted</b> (√¥ nhi·ªÖm) >< <b>Pure</b> (tinh khi·∫øt/s·∫°ch). <br>Contaminated l√† t·ª´ ƒë·ªìng nghƒ©a."
        },

        // --- EXERCISE 7: GAP FILL / GRAMMAR ---
        {
            id: "7-1",
            type: "grammar",
            title: "Exercise 7: Choose the correct word",
            question: "You should wait here ______ your parents come back.",
            options: [
                { id: "A", text: "when", meaning: "khi", type: "conj" },
                { id: "B", text: "until", meaning: "cho ƒë·∫øn khi", type: "conj" },
                { id: "C", text: "while", meaning: "trong khi", type: "conj" },
                { id: "D", text: "if", meaning: "n·∫øu", type: "conj" }
            ],
            correct: "B",
            translation: "B·∫°n n√™n ƒë·ª£i ·ªü ƒë√¢y cho ƒë·∫øn khi b·ªë m·∫π b·∫°n quay l·∫°i.",
            explanation: "D√πng <b>Until</b> ƒë·ªÉ ch·ªâ m·ªôt h√†nh ƒë·ªông k√©o d√†i ƒë·∫øn m·ªôt th·ªùi ƒëi·ªÉm c·ª• th·ªÉ. <br>When/While kh√¥ng di·ªÖn t·∫£ √Ω nghƒ©a 'ƒë·ª£i ƒë·∫øn l√∫c ƒë√≥' t·ªët b·∫±ng Until trong ng·ªØ c·∫£nh n√†y."
        },
        {
            id: "7-2",
            type: "grammar",
            title: "Exercise 7: Choose the correct word",
            question: "______ the party, there was a lot of food left.",
            options: [
                { id: "A", text: "While", meaning: "Trong khi", type: "conj" },
                { id: "B", text: "After", meaning: "Sau khi", type: "conj" },
                { id: "C", text: "Before", meaning: "Tr∆∞·ªõc khi", type: "conj" },
                { id: "D", text: "If", meaning: "N·∫øu", type: "conj" }
            ],
            correct: "B",
            translation: "Sau b·ªØa ti·ªác, c√≤n th·ª´a r·∫•t nhi·ªÅu ƒë·ªì ƒÉn.",
            explanation: "D√πng <b>After</b> v√¨ ng·ªØ c·∫£nh n√≥i v·ªÅ k·∫øt qu·∫£ (th·ª´a ƒë·ªì ƒÉn) x·∫£y ra khi b·ªØa ti·ªác ƒë√£ k·∫øt th√∫c. <br>While th∆∞·ªùng ƒëi v·ªõi m·ªánh ƒë·ªÅ (S + V) ch·ª© kh√¥ng ƒëi tr·ª±c ti·∫øp v·ªõi danh t·ª´ 'the party' theo nghƒ©a n√†y."
        },
        {
            id: "7-3",
            type: "grammar",
            title: "Exercise 7: Choose the correct word",
            question: "My sister was sleeping ______ I was studying for the test last night.",
            options: [
                { id: "A", text: "when", meaning: "khi", type: "conj" },
                { id: "B", text: "as soon as", meaning: "ngay khi", type: "conj" },
                { id: "C", text: "while", meaning: "trong khi", type: "conj" },
                { id: "D", text: "until", meaning: "cho ƒë·∫øn khi", type: "conj" }
            ],
            correct: "C",
            translation: "Ch·ªã t√¥i ƒëang ng·ªß trong khi t√¥i ƒëang √¥n thi t·ªëi qua.",
            explanation: "Hai h√†nh ƒë·ªông x·∫£y ra song song c√πng l√∫c trong qu√° kh·ª© -> D√πng <b>While</b>. <br>C·∫•u tr√∫c: Past Continuous + while + Past Continuous."
        },
        {
            id: "7-4",
            type: "grammar",
            title: "Exercise 7: Choose the correct word",
            question: "______ I left home for school, It rained heavily.",
            options: [
                { id: "A", text: "As soon as", meaning: "Ngay khi", type: "conj" },
                { id: "B", text: "While", meaning: "Trong khi", type: "conj" },
                { id: "C", text: "After", meaning: "Sau khi", type: "conj" },
                { id: "D", text: "Until", meaning: "Cho ƒë·∫øn khi", type: "conj" }
            ],
            correct: "A",
            translation: "Ngay khi t√¥i r·ªùi nh√† ƒëi h·ªçc th√¨ tr·ªùi m∆∞a to.",
            explanation: "<b>As soon as</b> di·ªÖn t·∫£ m·ªôt h√†nh ƒë·ªông x·∫£y ra ngay l·∫≠p t·ª©c sau h√†nh ƒë·ªông kh√°c. Ng·ªØ c·∫£nh n√†y nh·∫•n m·∫°nh s·ª± t·ª©c th·ªùi."
        },
        {
            id: "7-5",
            type: "grammar",
            title: "Exercise 7: Choose the correct word",
            question: "The train arrived ______ Elle was having lunch.",
            options: [
                { id: "A", text: "while", meaning: "trong khi", type: "conj" },
                { id: "B", text: "as soon as", meaning: "ngay khi", type: "conj" },
                { id: "C", text: "before", meaning: "tr∆∞·ªõc khi", type: "conj" },
                { id: "D", text: "after", meaning: "sau khi", type: "conj" }
            ],
            correct: "A",
            translation: "T√†u ƒë·∫øn trong l√∫c Elle ƒëang ƒÉn tr∆∞a.",
            explanation: "H√†nh ƒë·ªông xen ngang (t√†u ƒë·∫øn - qu√° kh·ª© ƒë∆°n) x·∫£y ra khi h√†nh ƒë·ªông kh√°c ƒëang di·ªÖn ra (ƒÉn tr∆∞a - qu√° kh·ª© ti·∫øp di·ªÖn) -> D√πng <b>While</b>."
        },
        {
            id: "7-6",
            type: "grammar",
            title: "Exercise 7: Choose the correct word",
            question: "______ the water is very cold in January, they go swimming anyway.",
            options: [
                { id: "A", text: "Because", meaning: "B·ªüi v√¨", type: "conj" },
                { id: "B", text: "Although", meaning: "M·∫∑c d√π", type: "conj" },
                { id: "C", text: "If", meaning: "N·∫øu", type: "conj" },
                { id: "D", text: "When", meaning: "Khi", type: "conj" }
            ],
            correct: "B",
            translation: "M·∫∑c d√π n∆∞·ªõc r·∫•t l·∫°nh v√†o th√°ng Gi√™ng, h·ªç v·∫´n ƒëi b∆°i.",
            explanation: "Hai m·ªánh ƒë·ªÅ t∆∞∆°ng ph·∫£n nhau (l·∫°nh >< ƒëi b∆°i) -> D√πng <b>Although</b>."
        },
        {
            id: "7-7",
            type: "grammar",
            title: "Exercise 7: Choose the correct word",
            question: "My father goes jogging every morning ______ he gets ready for work.",
            options: [
                { id: "A", text: "before", meaning: "tr∆∞·ªõc khi", type: "conj" },
                { id: "B", text: "after", meaning: "sau khi", type: "conj" },
                { id: "C", text: "until", meaning: "cho ƒë·∫øn khi", type: "conj" },
                { id: "D", text: "while", meaning: "trong khi", type: "conj" }
            ],
            correct: "A",
            translation: "B·ªë t√¥i ƒëi ch·∫°y b·ªô m·ªói s√°ng tr∆∞·ªõc khi √¥ng ·∫•y chu·∫©n b·ªã ƒëi l√†m.",
            explanation: "Tr√¨nh t·ª± logic: Ch·∫°y b·ªô -> Chu·∫©n b·ªã ƒëi l√†m. N√™n d√πng <b>Before</b> (tr∆∞·ªõc khi ƒëi l√†m)."
        },
        {
            id: "7-8",
            type: "grammar",
            title: "Exercise 7: Choose the correct word",
            question: "I learned a lot about wildlife ______ I visited Cuc Phuong National Park yesterday.",
            options: [
                { id: "A", text: "until", meaning: "cho ƒë·∫øn khi", type: "conj" },
                { id: "B", text: "after", meaning: "sau khi", type: "conj" },
                { id: "C", text: "as soon as", meaning: "ngay khi", type: "conj" },
                { id: "D", text: "when", meaning: "khi", type: "conj" }
            ],
            correct: "D",
            translation: "T√¥i ƒë√£ h·ªçc ƒë∆∞·ª£c r·∫•t nhi·ªÅu v·ªÅ ƒë·ªông v·∫≠t hoang d√£ khi t√¥i ƒë·∫øn thƒÉm V∆∞·ªùn Qu·ªëc gia C√∫c Ph∆∞∆°ng h√¥m qua.",
            explanation: "D√πng <b>When</b> (khi) ƒë·ªÉ ch·ªâ th·ªùi ƒëi·ªÉm x·∫£y ra s·ª± vi·ªác trong qu√° kh·ª©."
        },
        {
            id: "7-9",
            type: "grammar",
            title: "Exercise 7: Choose the correct word",
            question: "I usually drink a glass of warm milk ______ I go to bed.",
            options: [
                { id: "A", text: "after", meaning: "sau khi", type: "conj" },
                { id: "B", text: "until", meaning: "cho ƒë·∫øn khi", type: "conj" },
                { id: "C", text: "before", meaning: "tr∆∞·ªõc khi", type: "conj" },
                { id: "D", text: "while", meaning: "trong khi", type: "conj" }
            ],
            correct: "C",
            translation: "T√¥i th∆∞·ªùng u·ªëng m·ªôt ly s·ªØa ·∫•m tr∆∞·ªõc khi ƒëi ng·ªß.",
            explanation: "U·ªëng s·ªØa gi√∫p ng·ªß ngon -> H√†nh ƒë·ªông x·∫£y ra <b>Before</b> (tr∆∞·ªõc khi) ƒëi ng·ªß."
        },
        {
            id: "7-10",
            type: "grammar",
            title: "Exercise 7: Choose the correct word",
            question: "Who takes care of the baby ______ your mother is away?",
            options: [
                { id: "A", text: "when", meaning: "khi", type: "conj" },
                { id: "B", text: "after", meaning: "sau khi", type: "conj" },
                { id: "C", text: "before", meaning: "tr∆∞·ªõc khi", type: "conj" },
                { id: "D", text: "until", meaning: "cho ƒë·∫øn khi", type: "conj" }
            ],
            correct: "A",
            translation: "Ai tr√¥ng em b√© khi m·∫π b·∫°n ƒëi v·∫Øng?",
            explanation: "D√πng <b>When</b> (khi) ƒë·ªÉ di·ªÖn t·∫£ kho·∫£ng th·ªùi gian m·∫π v·∫Øng nh√†."
        },
        {
            id: "7-11",
            type: "grammar",
            title: "Exercise 7: Choose the correct word",
            question: "______ we receive your confirmation email, we will send you a link to download the program.",
            options: [
                { id: "A", text: "After", meaning: "Sau khi", type: "conj" },
                { id: "B", text: "Before", meaning: "Tr∆∞·ªõc khi", type: "conj" },
                { id: "C", text: "While", meaning: "Trong khi", type: "conj" },
                { id: "D", text: "Until", meaning: "Cho ƒë·∫øn khi", type: "conj" }
            ],
            correct: "A",
            translation: "Sau khi ch√∫ng t√¥i nh·∫≠n ƒë∆∞·ª£c email x√°c nh·∫≠n c·ªßa b·∫°n, ch√∫ng t√¥i s·∫Ω g·ª≠i li√™n k·∫øt t·∫£i xu·ªëng.",
            explanation: "Tr√¨nh t·ª±: Nh·∫≠n email -> G·ª≠i link. D√πng <b>After</b>."
        },
        {
            id: "7-12",
            type: "grammar",
            title: "Exercise 7: Choose the correct word",
            question: "I have to wait ______ my mum comes home.",
            options: [
                { id: "A", text: "while", meaning: "trong khi", type: "conj" },
                { id: "B", text: "before", meaning: "tr∆∞·ªõc khi", type: "conj" },
                { id: "C", text: "until", meaning: "cho ƒë·∫øn khi", type: "conj" },
                { id: "D", text: "if", meaning: "n·∫øu", type: "conj" }
            ],
            correct: "C",
            translation: "T√¥i ph·∫£i ƒë·ª£i cho ƒë·∫øn khi m·∫π t√¥i v·ªÅ nh√†.",
            explanation: "ƒê·ª£i (wait) th∆∞·ªùng ƒëi v·ªõi <b>Until</b> (cho ƒë·∫øn khi) s·ª± vi·ªác k·∫øt th√∫c."
        },
        {
            id: "7-13",
            type: "grammar",
            title: "Exercise 7: Choose the correct word",
            question: "______ she is ready, we will leave.",
            options: [
                { id: "A", text: "Before", meaning: "Tr∆∞·ªõc khi", type: "conj" },
                { id: "B", text: "When", meaning: "Khi", type: "conj" },
                { id: "C", text: "While", meaning: "Trong khi", type: "conj" },
                { id: "D", text: "Until", meaning: "Cho ƒë·∫øn khi", type: "conj" }
            ],
            correct: "B",
            translation: "Khi c√¥ ·∫•y s·∫µn s√†ng, ch√∫ng t√¥i s·∫Ω r·ªùi ƒëi.",
            explanation: "D√πng <b>When</b> (ho·∫∑c As soon as) ƒë·ªÉ ch·ªâ ƒëi·ªÅu ki·ªán v·ªÅ th·ªùi gian cho h√†nh ƒë·ªông 'r·ªùi ƒëi'."
        },
        {
            id: "7-14",
            type: "grammar",
            title: "Exercise 7: Choose the correct word",
            question: "I'll send you a text message ______ I hear from Nam.",
            options: [
                { id: "A", text: "until", meaning: "cho ƒë·∫øn khi", type: "conj" },
                { id: "B", text: "as soon as", meaning: "ngay khi", type: "conj" },
                { id: "C", text: "before", meaning: "tr∆∞·ªõc khi", type: "conj" },
                { id: "D", text: "while", meaning: "trong khi", type: "conj" }
            ],
            correct: "B",
            translation: "T√¥i s·∫Ω nh·∫Øn tin cho b·∫°n ngay khi t√¥i nh·∫≠n ƒë∆∞·ª£c tin t·ª´ Nam.",
            explanation: "<b>As soon as</b> di·ªÖn t·∫£ s·ª± vi·ªác x·∫£y ra li·ªÅn ngay sau ƒë√≥."
        },
        {
            id: "7-15",
            type: "grammar",
            title: "Exercise 7: Choose the correct word",
            question: "______ she goes, she will turn off all the computers.",
            options: [
                { id: "A", text: "Before", meaning: "Tr∆∞·ªõc khi", type: "conj" },
                { id: "B", text: "After", meaning: "Sau khi", type: "conj" },
                { id: "C", text: "While", meaning: "Trong khi", type: "conj" },
                { id: "D", text: "Until", meaning: "Cho ƒë·∫øn khi", type: "conj" }
            ],
            correct: "A",
            translation: "Tr∆∞·ªõc khi c√¥ ·∫•y ƒëi v·ªÅ, c√¥ ·∫•y s·∫Ω t·∫Øt t·∫•t c·∫£ m√°y t√≠nh.",
            explanation: "H√†nh ƒë·ªông t·∫Øt m√°y ph·∫£i x·∫£y ra <b>Before</b> (tr∆∞·ªõc khi) h√†nh ƒë·ªông r·ªùi ƒëi."
        },
        {
            id: "7-16",
            type: "grammar",
            title: "Exercise 7: Choose the correct word",
            question: "He will send them an email ______ he arrives in London.",
            options: [
                { id: "A", text: "before", meaning: "tr∆∞·ªõc khi", type: "conj" },
                { id: "B", text: "until", meaning: "cho ƒë·∫øn khi", type: "conj" },
                { id: "C", text: "as soon as", meaning: "ngay khi", type: "conj" },
                { id: "D", text: "while", meaning: "trong khi", type: "conj" }
            ],
            correct: "C",
            translation: "Anh ·∫•y s·∫Ω g·ª≠i email cho h·ªç ngay khi anh ·∫•y ƒë·∫øn London.",
            explanation: "D√πng <b>As soon as</b> h·ª£p l√Ω nh·∫•t v·ªÅ ng·ªØ nghƒ©a (th√¥ng b√°o tin ƒë·∫øn n∆°i)."
        },
        {
            id: "7-17",
            type: "grammar",
            title: "Exercise 7: Choose the correct word",
            question: "I will give you my reply ______ I leave this afternoon.",
            options: [
                { id: "A", text: "before", meaning: "tr∆∞·ªõc khi", type: "conj" },
                { id: "B", text: "by", meaning: "tr∆∞·ªõc (th·ªùi ƒëi·ªÉm)", type: "prep" },
                { id: "C", text: "this time", meaning: "l·∫ßn n√†y", type: "n" },
                { id: "D", text: "until", meaning: "cho ƒë·∫øn khi", type: "conj" }
            ],
            correct: "A",
            translation: "T√¥i s·∫Ω ƒë∆∞a c√¢u tr·∫£ l·ªùi cho b·∫°n tr∆∞·ªõc khi t√¥i r·ªùi ƒëi chi·ªÅu nay.",
            explanation: "<b>Before</b> + M·ªánh ƒë·ªÅ (I leave...). By + M·ªëc th·ªùi gian (By 5pm...). ·ªû ƒë√¢y c√≥ m·ªánh ƒë·ªÅ 'I leave' n√™n d√πng Before."
        },
        {
            id: "7-18",
            type: "grammar",
            title: "Exercise 7: Choose the correct word",
            question: "I'll go online ______ I get home.",
            options: [
                { id: "A", text: "while", meaning: "trong khi", type: "conj" },
                { id: "B", text: "as soon as", meaning: "ngay khi", type: "conj" },
                { id: "C", text: "until", meaning: "cho ƒë·∫øn khi", type: "conj" },
                { id: "D", text: "before", meaning: "tr∆∞·ªõc khi", type: "conj" }
            ],
            correct: "B",
            translation: "T√¥i s·∫Ω l√™n m·∫°ng ngay khi t√¥i v·ªÅ ƒë·∫øn nh√†.",
            explanation: "<b>As soon as</b> (ngay khi) ch·ªâ h√†nh ƒë·ªông x·∫£y ra ti·∫øp n·ªëi."
        },
        {
            id: "7-19",
            type: "grammar",
            title: "Exercise 7: Choose the correct word",
            question: "______ Mr. Tan phones, please let me know.",
            options: [
                { id: "A", text: "Before", meaning: "Tr∆∞·ªõc khi", type: "conj" },
                { id: "B", text: "Until", meaning: "Cho ƒë·∫øn khi", type: "conj" },
                { id: "C", text: "When", meaning: "Khi", type: "conj" },
                { id: "D", text: "While", meaning: "Trong khi", type: "conj" }
            ],
            correct: "C",
            translation: "Khi √¥ng T√¢n g·ªçi ƒëi·ªán, l√†m ∆°n cho t√¥i bi·∫øt.",
            explanation: "ƒê√¢y l√† c√¢u m·ªánh l·ªánh ƒëi k√®m m·ªánh ƒë·ªÅ th·ªùi gian. D√πng <b>When</b> (khi c√≥ s·ª± vi·ªác x·∫£y ra)."
        },
        {
            id: "7-20",
            type: "grammar",
            title: "Exercise 7: Choose the correct word",
            question: "Let's play with the children ______ it is time to go.",
            options: [
                { id: "A", text: "after", meaning: "sau khi", type: "conj" },
                { id: "B", text: "until", meaning: "cho ƒë·∫øn khi", type: "conj" },
                { id: "C", text: "while", meaning: "trong khi", type: "conj" },
                { id: "D", text: "before", meaning: "tr∆∞·ªõc khi", type: "conj" }
            ],
            correct: "B",
            translation: "H√£y ch∆°i v·ªõi b·ªçn tr·∫ª cho ƒë·∫øn khi ƒë·∫øn gi·ªù ph·∫£i ƒëi.",
            explanation: "Ch∆°i li√™n t·ª•c -> ƒê·∫øn m·ªëc th·ªùi gian ph·∫£i ƒëi. D√πng <b>Until</b>."
        }
    ];

    let currentScore = 0;
    const totalQuestions = quizData.length;
    document.getElementById('totalQuestions').innerText = totalQuestions;

    // --- RENDER QUESTIONS ---
    const container = document.getElementById('quiz-container');

    quizData.forEach((q, index) => {
        const card = document.createElement('div');
        card.className = 'card';
        card.innerHTML = `
            <div class="question-title">${q.title} - Question ${index + 1}</div>
            <div class="question-text">${q.question}</div>
            
            <div class="options-grid" id="options-${index}">
                ${q.options.map((opt, optIndex) => `
                    <button class="option-btn" onclick="checkAnswer(${index}, '${opt.id}', this)">
                        ${opt.id}. ${opt.text}
                    </button>
                `).join('')}
            </div>

            <div class="explanation" id="exp-${index}">
                <div class="exp-header">
                    <span>üë©‚Äçüè´</span> C√¥ Mai An gi·∫£i th√≠ch:
                </div>
                <div class="exp-content">
                    <div class="exp-translation">
                        üó£ <b>D·ªãch c√¢u h·ªèi:</b> "${q.translation}"
                    </div>
                    
                    <p><b>üîç Ph√¢n t√≠ch ƒë√°p √°n:</b></p>
                    <ul class="vocab-list">
                        ${q.options.map(opt => `
                            <li class="vocab-item">
                                <span class="vocab-word">${opt.text}</span> 
                                <i>(${opt.type || 'word'})</i>: ${opt.meaning}
                            </li>
                        `).join('')}
                    </ul>

                    <p class="why-correct">‚úÖ T·∫°i sao ch·ªçn ${q.correct}? <br> ${q.explanation}</p>
                </div>
            </div>
        `;
        container.appendChild(card);
    });

    // --- AUDIO SYSTEM (Web Audio API - No External Files) ---
    const audioCtx = new (window.AudioContext || window.webkitAudioContext)();

    function playSound(type) {
        const osc = audioCtx.createOscillator();
        const gainNode = audioCtx.createGain();
        osc.connect(gainNode);
        gainNode.connect(audioCtx.destination);

        if (type === 'correct') {
            // Ding sound (High pitch, fast decay)
            osc.type = 'sine';
            osc.frequency.setValueAtTime(600, audioCtx.currentTime);
            osc.frequency.exponentialRampToValueAtTime(1200, audioCtx.currentTime + 0.1);
            gainNode.gain.setValueAtTime(0.3, audioCtx.currentTime);
            gainNode.gain.exponentialRampToValueAtTime(0.01, audioCtx.currentTime + 0.5);
            osc.start();
            osc.stop(audioCtx.currentTime + 0.5);
        } else {
            // Buzz sound (Low saw, wobble)
            osc.type = 'sawtooth';
            osc.frequency.setValueAtTime(150, audioCtx.currentTime);
            osc.frequency.linearRampToValueAtTime(100, audioCtx.currentTime + 0.3);
            gainNode.gain.setValueAtTime(0.3, audioCtx.currentTime);
            gainNode.gain.exponentialRampToValueAtTime(0.01, audioCtx.currentTime + 0.3);
            osc.start();
            osc.stop(audioCtx.currentTime + 0.3);
        }
    }

    // --- LOGIC CHECK ANSWER ---
    function checkAnswer(questionIndex, selectedId, btnElement) {
        const question = quizData[questionIndex];
        const optionsDiv = document.getElementById(`options-${questionIndex}`);
        const allButtons = optionsDiv.querySelectorAll('.option-btn');
        const expDiv = document.getElementById(`exp-${questionIndex}`);

        // Prevent re-clicking
        if (btnElement.classList.contains('disabled')) return;

        // Disable all buttons in this question
        allButtons.forEach(btn => btn.classList.add('disabled'));

        if (selectedId === question.correct) {
            // CORRECT
            btnElement.classList.add('correct');
            playSound('correct');
            currentScore++;
            document.getElementById('currentScore').innerText = currentScore;
            
            // Confetti Effect
            confetti({
                particleCount: 100,
                spread: 70,
                origin: { y: 0.6 },
                colors: ['#00D26A', '#8854C0', '#00C9A7']
            });
        } else {
            // WRONG
            btnElement.classList.add('wrong');
            playSound('wrong');
            
            // Highlight correct answer
            allButtons.forEach(btn => {
                if (btn.innerText.startsWith(question.correct)) {
                    btn.classList.add('correct');
                }
            });
        }

        // Show Explanation
        expDiv.style.display = 'block';
    }

    // --- FINISH QUIZ ---
    function finishQuiz() {
        let message = "";
        const percentage = (currentScore / totalQuestions) * 100;

        if (percentage === 100) message = "üéâ Xu·∫•t s·∫Øc! Em l√† thi√™n t√†i ti·∫øng Anh!";
        else if (percentage >= 80) message = "üåü Gi·ªèi l·∫Øm! C·ªë g·∫Øng th√™m m·ªôt ch√∫t n·ªØa l√† ho√†n h·∫£o!";
        else if (percentage >= 50) message = "üìö Kh√° t·ªët! Em nh·ªõ xem l·∫°i ph·∫ßn gi·∫£i th√≠ch nh√©!";
        else message = "üí™ ƒê·ª´ng bu·ªìn! H√£y xem k·ªπ gi·∫£i th√≠ch ƒë·ªÉ l√†m t·ªët h∆°n l·∫ßn sau nh√©!";

        alert(`K·∫æT QU·∫¢ C·ª¶A B·∫†N:\n\nS·ªë c√¢u ƒë√∫ng: ${currentScore} / ${totalQuestions}\n\n${message}`);
    }

</script>

</body>
</html>