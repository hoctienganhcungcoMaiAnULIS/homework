<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>English Gamified Quiz Part 2 - Ms Mai An ULIS</title>
    <link href="https://fonts.googleapis.com/css2?family=Nunito:wght@400;700;800;900&display=swap" rel="stylesheet">
    <style>
        :root {
            --primary: #8854C0;
            --secondary: #FDCB6E;
            --accent: #00C9A7;
            --correct: #00D26A;
            --correct-shadow: #00a051;
            --wrong: #FF4757;
            --wrong-shadow: #c8303d;
            --btn-bg: #ffffff;
            --btn-shadow: #e0e0e0;
            --text-main: #333333;
        }

        * { box-sizing: border-box; font-family: 'Nunito', sans-serif; }

        body {
            margin: 0; padding: 0;
            background: linear-gradient(-45deg, #00C9A7, #FDCB6E, #FF9A9E, #8854C0);
            background-size: 400% 400%;
            animation: gradientBG 15s ease infinite;
            min-height: 100vh;
            color: var(--text-main);
            overflow-x: hidden;
        }

        /* SVG Pattern L∆° L·ª≠ng */
        .pattern-overlay {
            position: fixed; top: 0; left: 0; width: 100%; height: 100%;
            pointer-events: none; z-index: 0;
            background-image: url("data:image/svg+xml,%3Csvg width='80' height='80' viewBox='0 0 100 100' xmlns='http://www.w3.org/2000/svg'%3E%3Cpath d='M50 15 L58 35 L80 35 L62 48 L68 70 L50 55 L32 70 L38 48 L20 35 L42 35 Z' fill='rgba(255,255,255,0.3)'/%3E%3Ccircle cx='20' cy='80' r='6' fill='rgba(255,255,255,0.4)'/%3E%3C/svg%3E");
            animation: floatUp 25s linear infinite;
        }

        @keyframes gradientBG {
            0% { background-position: 0% 50%; }
            50% { background-position: 100% 50%; }
            100% { background-position: 0% 50%; }
        }

        @keyframes floatUp {
            0% { background-position: 0px 0px; }
            100% { background-position: 100px 1000px; }
        }

        .container {
            position: relative; z-index: 1;
            max-width: 800px; margin: 20px auto; padding: 0 15px;
        }

        header {
            text-align: center; background: rgba(255, 255, 255, 0.95);
            padding: 10px 20px; border-radius: 20px;
            box-shadow: 0 8px 0 rgba(0,0,0,0.1);
            margin-bottom: 30px; display: inline-block;
            left: 50%; transform: translateX(-50%); position: relative;
        }

        h2.teacher-name {
            font-size: 1.2rem; color: var(--primary);
            margin: 0; font-weight: 900;
        }

        .section-title {
            background: #fff; padding: 15px 25px; border-radius: 15px;
            box-shadow: 0 6px 0 rgba(0,0,0,0.1);
            margin-bottom: 20px; font-weight: 800; color: var(--primary); font-size: 1.2rem;
        }

        .card {
            background: rgba(255, 255, 255, 0.97); border-radius: 20px;
            box-shadow: 0 10px 0 rgba(0,0,0,0.1); padding: 25px;
            margin-bottom: 30px; transition: transform 0.2s;
        }

        .question-text {
            font-size: 1.2rem; font-weight: 800; margin-bottom: 20px; line-height: 1.5;
        }

        .options-grid {
            display: grid; grid-template-columns: 1fr 1fr; gap: 15px;
        }

        @media (max-width: 600px) { .options-grid { grid-template-columns: 1fr; } }

        .option-btn {
            background: var(--btn-bg); border: 2px solid #eee; border-radius: 15px;
            padding: 15px 20px; font-size: 1.1rem; font-weight: 700;
            color: var(--text-main); cursor: pointer;
            box-shadow: 0 6px 0 var(--btn-shadow); transition: all 0.1s ease;
            text-align: left;
        }

        .option-btn:hover:not(:disabled) {
            transform: scale(1.02) translateY(-2px); box-shadow: 0 8px 0 var(--btn-shadow);
        }

        .option-btn:active:not(:disabled) {
            transform: translateY(4px); box-shadow: 0 2px 0 var(--btn-shadow);
        }

        .option-btn.correct { background: var(--correct); color: white; border-color: var(--correct); box-shadow: 0 6px 0 var(--correct-shadow); }
        .option-btn.wrong { background: var(--wrong); color: white; border-color: var(--wrong); box-shadow: 0 6px 0 var(--wrong-shadow); }
        .option-btn:disabled { cursor: not-allowed; opacity: 0.9; }

        @keyframes shake {
            0%, 100% { transform: translateX(0); }
            20%, 60% { transform: translateX(-5px); }
            40%, 80% { transform: translateX(5px); }
        }
        .shake { animation: shake 0.4s ease-in-out; }

        .explanation {
            display: none; margin-top: 20px; padding: 20px; background: #F3F4F6;
            border-left: 5px solid var(--accent); border-radius: 10px;
            font-size: 1rem; line-height: 1.6; animation: slideDown 0.3s ease-out;
        }

        .explanation h4 { margin-top: 0; color: var(--primary); font-weight: 900;}
        .expl-step { margin-bottom: 12px; }

        @keyframes slideDown {
            from { opacity: 0; transform: translateY(-10px); }
            to { opacity: 1; transform: translateY(0); }
        }

        /* Gap Fill Style */
        .gap-fill-container { display: flex; flex-direction: column; gap: 15px; }
        .gap-item {
            background: #fff; padding: 20px; border-radius: 15px; box-shadow: 0 6px 0 #eee;
            font-weight: 700; font-size: 1.1rem; line-height: 1.8;
        }
        .gap-btn {
            background: #f0f0f0; border: 2px dashed #ccc; padding: 5px 15px;
            border-radius: 10px; cursor: pointer; color: #666; font-weight: bold;
            font-size: 1.1rem; margin: 0 5px; transition: all 0.2s;
        }
        .gap-btn:hover { background: #e0e0e0; transform: scale(1.05); }
        .gap-btn.filled-correct { background: var(--correct); color: white; border: none; box-shadow: 0 4px 0 var(--correct-shadow);}
        .gap-btn.filled-wrong { background: var(--wrong); color: white; border: none; box-shadow: 0 4px 0 var(--wrong-shadow);}

        /* Popup Ch·ªçn T·ª´ */
        .modal-overlay {
            display: none; position: fixed; top: 0; left: 0; width: 100%; height: 100%;
            background: rgba(0,0,0,0.6); z-index: 1000; justify-content: center; align-items: center;
        }
        .modal-content {
            background: white; padding: 25px; border-radius: 20px; width: 90%; max-width: 400px;
            text-align: center; box-shadow: 0 10px 25px rgba(0,0,0,0.3);
        }
        .modal-options { display: flex; flex-direction: column; gap: 10px; margin-top: 15px; }
        .modal-options .option-btn { width: 100%; text-align: center; }

        .submit-btn {
            display: block; width: 100%; max-width: 300px; margin: 40px auto; padding: 20px;
            font-size: 1.5rem; font-weight: 900; background: #00C9A7; color: white;
            border: none; border-radius: 20px; box-shadow: 0 8px 0 #00967d; cursor: pointer;
            transition: all 0.2s;
        }
        .submit-btn:hover { transform: translateY(-3px); box-shadow: 0 11px 0 #00967d; }
        .submit-btn:active { transform: translateY(5px); box-shadow: 0 3px 0 #00967d; }

        canvas#confetti { position: fixed; top: 0; left: 0; width: 100%; height: 100%; pointer-events: none; z-index: 9999; }
    </style>
</head>
<body>

<div class="pattern-overlay"></div>
<canvas id="confetti"></canvas>

<div class="container">
    <header>
        <h2 class="teacher-name">üåü B√†i thi ti·∫øng Anh (Ph·∫ßn 2) - Ms Mai An ULIS üåü</h2>
    </header>

    <div id="quiz-container"></div>

    <button class="submit-btn" onclick="submitQuiz()">N·ªôp b√†i ngay!</button>
</div>

<div class="modal-overlay" id="gapModal">
    <div class="modal-content">
        <h3 id="modal-title">Ch·ªçn t·ª´ ƒë·ªÉ ƒëi·ªÅn v√†o ch·ªó tr·ªëng</h3>
        <div class="modal-options" id="modal-options"></div>
    </div>
</div>

<div class="modal-overlay" id="resultModal">
    <div class="modal-content">
        <h1 style="font-size: 3rem; margin: 10px 0;">üèÜ</h1>
        <h2 style="color: var(--primary);">Ho√†n th√†nh xu·∫•t s·∫Øc!</h2>
        <h3 id="score-text" style="font-size: 1.5rem;">B·∫°n ƒë√∫ng 0/0 c√¢u</h3>
        <p id="praise-text" style="font-weight: bold; color: #e67e22;"></p>
        <button class="submit-btn" style="margin-top: 20px;" onclick="location.reload()">L√†m l·∫°i b√†i thi</button>
    </div>
</div>

<script>
    // --- √ÇM THANH & HI·ªÜU ·ª®NG (Gi·ªØ nguy√™n c·∫•u tr√∫c Web Audio API) ---
    const AudioContext = window.AudioContext || window.webkitAudioContext;
    const audioCtx = new AudioContext();

    function playDing() {
        if(audioCtx.state === 'suspended') audioCtx.resume();
        const osc = audioCtx.createOscillator(); const gain = audioCtx.createGain();
        osc.connect(gain); gain.connect(audioCtx.destination); osc.type = 'sine';
        osc.frequency.setValueAtTime(800, audioCtx.currentTime);
        osc.frequency.exponentialRampToValueAtTime(1500, audioCtx.currentTime + 0.1);
        gain.gain.setValueAtTime(0.5, audioCtx.currentTime);
        gain.gain.exponentialRampToValueAtTime(0.01, audioCtx.currentTime + 0.5);
        osc.start(); osc.stop(audioCtx.currentTime + 0.5);
    }

    function playBuzz() {
        if(audioCtx.state === 'suspended') audioCtx.resume();
        const osc = audioCtx.createOscillator(); const gain = audioCtx.createGain();
        osc.connect(gain); gain.connect(audioCtx.destination); osc.type = 'sawtooth';
        osc.frequency.setValueAtTime(150, audioCtx.currentTime);
        osc.frequency.exponentialRampToValueAtTime(100, audioCtx.currentTime + 0.3);
        gain.gain.setValueAtTime(0.5, audioCtx.currentTime);
        gain.gain.exponentialRampToValueAtTime(0.01, audioCtx.currentTime + 0.3);
        osc.start(); osc.stop(audioCtx.currentTime + 0.3);
    }

    const canvas = document.getElementById('confetti'); const ctx = canvas.getContext('2d');
    canvas.width = window.innerWidth; canvas.height = window.innerHeight;
    let particles = []; const colors = ['#8854C0', '#FDCB6E', '#00C9A7', '#FF4757', '#00D26A'];

    function triggerConfetti() {
        for(let i=0; i<50; i++) particles.push({ x: Math.random() * canvas.width, y: canvas.height + 10, r: Math.random() * 6 + 4, dx: Math.random() * 4 - 2, dy: Math.random() * -10 - 10, color: colors[Math.floor(Math.random() * colors.length)], tilt: Math.random() * 10 });
        animateConfetti();
    }
    function animateConfetti() {
        ctx.clearRect(0,0,canvas.width,canvas.height); let active = false;
        for(let i=0; i<particles.length; i++) {
            let p = particles[i]; p.dy += 0.3; p.x += p.dx; p.y += p.dy; p.tilt += 0.1;
            ctx.beginPath(); ctx.lineWidth = p.r; ctx.strokeStyle = p.color;
            ctx.moveTo(p.x + p.tilt + p.r, p.y); ctx.lineTo(p.x + p.tilt, p.y + p.tilt + p.r); ctx.stroke();
            if(p.y < canvas.height + 20) active = true;
        }
        if(active) requestAnimationFrame(animateConfetti); else particles = [];
    }

    function shuffleArray(array) {
        let curId = array.length, temp, randId;
        while (0 !== curId) {
            randId = Math.floor(Math.random() * curId); curId -= 1;
            temp = array[curId]; array[curId] = array[randId]; array[randId] = temp;
        }
        return array;
    }

    let score = 0; let totalQuestions = 0;

    // --- D·ªÆ LI·ªÜU ƒê·ªÄ B√ÄI M·ªöI (T·ª´ Ex 5 ƒë·∫øn Ex 12) ---
    // Exercise 5: Gap Fill (Past Simple)
    const gapFillData = [
        { 
            q: "1. Who _gap_ table tennis with yesterday afternoon?", 
            inf: "(you play)", ans: "did you play", wrong: ["do you play", "you played", "were you play"],
            expl: `<div class="expl-step"><b>1. D·ªãch:</b> B·∫°n ƒë√£ ch∆°i b√≥ng b√†n v·ªõi ai v√†o chi·ªÅu h√¥m qua?</div>
                   <div class="expl-step"><b>2. Ph√¢n t√≠ch:</b> D·∫•u hi·ªáu "yesterday" -> Qu√° kh·ª© ƒë∆°n. ƒê√¢y l√† c√¢u h·ªèi v·ªõi ƒë·ªông t·ª´ th∆∞·ªùng "play", ta ph·∫£i m∆∞·ª£n tr·ª£ ƒë·ªông t·ª´ "did". C√¥ng th·ª©c: Wh-word + did + S + V(nguy√™n th·ªÉ)? -> did you play.</div>`
        },
        { 
            q: "2. Last summer, I _gap_ two weeks on my uncle's farm.", 
            inf: "(spend)", ans: "spent", wrong: ["spend", "spended", "was spend"],
            expl: `<div class="expl-step"><b>1. D·ªãch:</b> M√πa h√® nƒÉm ngo√°i, t√¥i ƒë√£ d√†nh hai tu·∫ßn ·ªü n√¥ng tr·∫°i c·ªßa ch√∫ t√¥i.</div>
                   <div class="expl-step"><b>2. Ph√¢n t√≠ch:</b> "Last summer" -> Qu√° kh·ª© ƒë∆°n. ƒê·ªông t·ª´ "spend" l√† ƒë·ªông t·ª´ b·∫•t quy t·∫Øc, c·ªôt 2 (V2) c·ªßa n√≥ l√† "spent".</div>`
        },
        { 
            q: "3. Pel√© _gap_ born in Brazil in 1949.", 
            inf: "(be)", ans: "was", wrong: ["were", "is", "be"],
            expl: `<div class="expl-step"><b>1. D·ªãch:</b> Pel√© ƒë∆∞·ª£c sinh ra ·ªü Brazil v√†o nƒÉm 1949.</div>
                   <div class="expl-step"><b>2. Ph√¢n t√≠ch:</b> C·ª•m t·ª´ "be born" (ƒë∆∞·ª£c sinh ra) lu√¥n d√πng th√¨ qu√° kh·ª© cho ng∆∞·ªùi ƒë√£ sinh ra. Pel√© l√† ng√¥i th·ª© 3 s·ªë √≠t -> d√πng "was".</div>`
        },
        { 
            q: "4. My sister _gap_ part in the singing competition last year.", 
            inf: "(not take)", ans: "didn't take", wrong: ["don't take", "not took", "didn't took"],
            expl: `<div class="expl-step"><b>1. D·ªãch:</b> Ch·ªã g√°i t√¥i ƒë√£ kh√¥ng tham gia cu·ªôc thi h√°t v√†o nƒÉm ngo√°i.</div>
                   <div class="expl-step"><b>2. Ph√¢n t√≠ch:</b> "last year" -> Qu√° kh·ª© ƒë∆°n. D·∫°ng ph·ªß ƒë·ªãnh c·ªßa ƒë·ªông t·ª´ th∆∞·ªùng l√† "didn't + V_nguy√™n th·ªÉ" -> didn't take.</div>`
        },
        { 
            q: "5. People _gap_ the first World Cup in 1930.", 
            inf: "(hold)", ans: "held", wrong: ["holded", "hold", "were hold"],
            expl: `<div class="expl-step"><b>1. D·ªãch:</b> Ng∆∞·ªùi ta ƒë√£ t·ªï ch·ª©c k·ª≥ World Cup ƒë·∫ßu ti√™n v√†o nƒÉm 1930.</div>
                   <div class="expl-step"><b>2. Ph√¢n t√≠ch:</b> "in 1930" -> Qu√° kh·ª© ƒë∆°n. ƒê·ªông t·ª´ "hold" b·∫•t quy t·∫Øc, V2 l√† "held".</div>`
        },
        { 
            q: "6. _gap_ the final match two days ago?", 
            inf: "(you watch)", ans: "Did you watch", wrong: ["Do you watch", "You watched", "Were you watch"],
            expl: `<div class="expl-step"><b>1. D·ªãch:</b> B·∫°n c√≥ xem tr·∫≠n chung k·∫øt c√°ch ƒë√¢y 2 ng√†y kh√¥ng?</div>
                   <div class="expl-step"><b>2. Ph√¢n t√≠ch:</b> D·∫•u hi·ªáu "two days ago" -> Qu√° kh·ª© ƒë∆°n. C√¢u h·ªèi nghi v·∫•n m∆∞·ª£n tr·ª£ ƒë·ªông t·ª´ "Did" ƒë·∫£o l√™n tr∆∞·ªõc ch·ªß ng·ªØ -> Did you watch.</div>`
        },
        { 
            q: "7. Our teacher _gap_ us to be quiet when we went to the mausoleum.", 
            inf: "(tell)", ans: "told", wrong: ["telled", "tells", "telling"],
            expl: `<div class="expl-step"><b>1. D·ªãch:</b> Gi√°o vi√™n ƒë√£ b·∫£o ch√∫ng t√¥i gi·ªØ tr·∫≠t t·ª± khi ch√∫ng t√¥i v√†o thƒÉm lƒÉng.</div>
                   <div class="expl-step"><b>2. Ph√¢n t√≠ch:</b> V·∫ø sau c√≥ "went" (QKƒê) n√™n h√†nh ƒë·ªông "b·∫£o" c≈©ng ·ªü QKƒê. "tell" l√† ƒë·ªông t·ª´ b·∫•t quy t·∫Øc, V2 l√† "told".</div>`
        },
        { 
            q: "8. Yesterday, my brother _gap_ to school because his bike was broken.", 
            inf: "(walk)", ans: "walked", wrong: ["walk", "did walk", "was walk"],
            expl: `<div class="expl-step"><b>1. D·ªãch:</b> H√¥m qua, anh trai t√¥i ƒë√£ ƒëi b·ªô ƒë·∫øn tr∆∞·ªùng v√¨ xe ƒë·∫°p c·ªßa anh ·∫•y b·ªã h·ªèng.</div>
                   <div class="expl-step"><b>2. Ph√¢n t√≠ch:</b> D·∫•u hi·ªáu "Yesterday" -> Qu√° kh·ª© ƒë∆°n. "walk" l√† ƒë·ªông t·ª´ c√≥ quy t·∫Øc, ch·ªâ c·∫ßn th√™m "-ed" -> "walked".</div>`
        }
    ];

    const multipleChoiceData = [
        {
            section: "Exercise 6: Choose the word or phrase that CLOSEST in meaning with the underlined one(s).",
            questions: [
                {
                    q: "1. I love watching talent show. It is usually <u>interesting and surprising</u>.", ans: "B",
                    options: [ {val: "A", text: "boring"}, {val: "B", text: "exciting"}, {val: "C", text: "funny"}, {val: "D", text: "live"} ],
                    expl: `<div class="expl-step"><b>1. D·ªãch c√¢u:</b> T√¥i th√≠ch xem ch∆∞∆°ng tr√¨nh t√¨m ki·∫øm t√†i nƒÉng. N√≥ th∆∞·ªùng r·∫•t th√∫ v·ªã v√† ƒë·∫ßy b·∫•t ng·ªù.</div>
                           <div class="expl-step"><b>2. Ph√¢n t√≠ch 4 ƒë√°p √°n:</b><br>- A. boring (adj): nh√†m ch√°n.<br>- B. exciting (adj): h√†o h·ª©ng, th√∫ v·ªã.<br>- C. funny (adj): bu·ªìn c∆∞·ªùi.<br>- D. live (adj): tr·ª±c ti·∫øp.</div>
                           <div class="expl-step"><b>3. T·∫°i sao ch·ªçn B?</b> C·ª•m g·∫°ch ch√¢n "interesting and surprising" (th√∫ v·ªã v√† b·∫•t ng·ªù) mang nghƒ©a t∆∞∆°ng ƒë∆∞∆°ng nh·∫•t v·ªõi "exciting".</div>`
                },
                {
                    q: "2. Finally, she got the highest score and became the <u>champion</u>.", ans: "A",
                    options: [ {val: "A", text: "winner"}, {val: "B", text: "loser"}, {val: "C", text: "viewer"}, {val: "D", text: "player"} ],
                    expl: `<div class="expl-step"><b>1. D·ªãch c√¢u:</b> Cu·ªëi c√πng, c√¥ ·∫•y ƒë·∫°t ƒëi·ªÉm cao nh·∫•t v√† tr·ªü th√†nh nh√† v√¥ ƒë·ªãch.</div>
                           <div class="expl-step"><b>2. Ph√¢n t√≠ch:</b><br>- A. winner (n): ng∆∞·ªùi chi·∫øn th·∫Øng.<br>- B. loser (n): k·∫ª thua cu·ªôc.<br>- C. viewer (n): ng∆∞·ªùi xem.<br>- D. player (n): ng∆∞·ªùi ch∆°i.</div>
                           <div class="expl-step"><b>3. T·∫°i sao ch·ªçn A?</b> "champion" (nh√† v√¥ ƒë·ªãch) ƒë·ªìng nghƒ©a v·ªõi "winner" (ng∆∞·ªùi chi·∫øn th·∫Øng).</div>`
                },
                {
                    q: "3. Many people agree that he is the best golfer <u>of all time</u>.", ans: "C",
                    options: [ {val: "A", text: "this time"}, {val: "B", text: "nowadays"}, {val: "C", text: "ever"}, {val: "D", text: "in the past"} ],
                    expl: `<div class="expl-step"><b>1. D·ªãch c√¢u:</b> Nhi·ªÅu ng∆∞·ªùi ƒë·ªìng √Ω r·∫±ng anh ·∫•y l√† tay golf gi·ªèi nh·∫•t m·ªçi th·ªùi ƒë·∫°i.</div>
                           <div class="expl-step"><b>2. Ph√¢n t√≠ch:</b><br>- A. this time: l·∫ßn n√†y.<br>- B. nowadays: ng√†y nay.<br>- C. ever: t·ª´ tr∆∞·ªõc ƒë·∫øn nay (bao h√†m m·ªçi th·ªùi gian).<br>- D. in the past: trong qu√° kh·ª©.</div>
                           <div class="expl-step"><b>3. T·∫°i sao ch·ªçn C?</b> "of all time" (m·ªçi th·ªùi ƒë·∫°i) ƒë·ªìng nghƒ©a v·ªõi "ever".</div>`
                },
                {
                    q: "4. Vietnamese people are <u>friendly and helpful</u>.", ans: "A",
                    options: [ {val: "A", text: "kind"}, {val: "B", text: "unkind"}, {val: "C", text: "intelligent"}, {val: "D", text: "funny"} ],
                    expl: `<div class="expl-step"><b>1. D·ªãch c√¢u:</b> Ng∆∞·ªùi Vi·ªát Nam r·∫•t th√¢n thi·ªán v√† hay gi√∫p ƒë·ª°.</div>
                           <div class="expl-step"><b>2. Ph√¢n t√≠ch:</b><br>- A. kind (adj): t·ªët b·ª•ng, t·ª≠ t·∫ø.<br>- B. unkind (adj): kh√¥ng t·ªët.<br>- C. intelligent (adj): th√¥ng minh.<br>- D. funny (adj): vui v·∫ª.</div>
                           <div class="expl-step"><b>3. T·∫°i sao ch·ªçn A?</b> M·ªôt ng∆∞·ªùi "friendly" (th√¢n thi·ªán) v√† "helpful" (hay gi√∫p ƒë·ª°) ch√≠nh l√† m·ªôt ng∆∞·ªùi "kind" (t·ª≠ t·∫ø, t·ªët b·ª•ng).</div>`
                },
                {
                    q: "5. I love trying street food in that city. People say it's so <u>tasty</u>.", ans: "D",
                    options: [ {val: "A", text: "delicious"}, {val: "B", text: "yummy"}, {val: "C", text: "good-tasting"}, {val: "D", text: "All are correct."} ],
                    expl: `<div class="expl-step"><b>1. D·ªãch c√¢u:</b> T√¥i th√≠ch th·ª≠ th·ª©c ƒÉn ƒë∆∞·ªùng ph·ªë ·ªü th√†nh ph·ªë ƒë√≥. M·ªçi ng∆∞·ªùi b·∫£o n√≥ r·∫•t ngon.</div>
                           <div class="expl-step"><b>2. Ph√¢n t√≠ch:</b><br>- A. delicious: ngon mi·ªáng.<br>- B. yummy: ngon tuy·ªát (vƒÉn n√≥i).<br>- C. good-tasting: c√≥ v·ªã ngon.</div>
                           <div class="expl-step"><b>3. T·∫°i sao ch·ªçn D?</b> C·∫£ 3 t·ª´ A, B, C ƒë·ªÅu ƒë·ªìng nghƒ©a v·ªõi t·ª´ "tasty" (ngon).</div>`
                }
            ]
        },
        {
            section: "Exercise 7: Choose the word or phrase that OPPOSITE in meaning with the underlined one(s).",
            questions: [
                {
                    q: "1. The shops are usually <u>full of people</u> during the holiday season.", ans: "B",
                    options: [ {val: "A", text: "crowded"}, {val: "B", text: "empty"}, {val: "C", text: "packed"}, {val: "D", text: "No correct answer."} ],
                    expl: `<div class="expl-step"><b>1. D·ªãch:</b> C√°c c·ª≠a h√†ng th∆∞·ªùng ƒë√¥ng ngh·∫πt ng∆∞·ªùi v√†o m√πa l·ªÖ h·ªôi. (Ch√∫ √Ω b√†i n√†y t√¨m t·ª´ TR√ÅI NGHƒ®A).</div>
                           <div class="expl-step"><b>2. Ph√¢n t√≠ch:</b><br>- A. crowded: ƒë√¥ng ƒë√∫c (ƒê·ªìng nghƒ©a).<br>- B. empty: tr·ªëng r·ªóng, v·∫Øng v·∫ª (Tr√°i nghƒ©a).<br>- C. packed: ch·∫≠t n√≠ch (ƒê·ªìng nghƒ©a).</div>
                           <div class="expl-step"><b>3. K·∫øt lu·∫≠n:</b> Tr√°i nghƒ©a v·ªõi "full of people" l√† "empty" (B).</div>`
                },
                {
                    q: "2. Hoi An is famous for its <u>historic</u> buildings.", ans: "A",
                    options: [ {val: "A", text: "modern"}, {val: "B", text: "old"}, {val: "C", text: "beautiful"}, {val: "D", text: "tall"} ],
                    expl: `<div class="expl-step"><b>1. D·ªãch:</b> H·ªôi An n·ªïi ti·∫øng v·ªõi c√°c t√≤a nh√† mang t√≠nh l·ªãch s·ª≠ (c·ªï k√≠nh).</div>
                           <div class="expl-step"><b>2. Ph√¢n t√≠ch:</b><br>- A. modern: hi·ªán ƒë·∫°i (Tr√°i nghƒ©a).<br>- B. old: c≈©, c·ªï (ƒê·ªìng nghƒ©a).<br>- C. beautiful: ƒë·∫πp.<br>- D. tall: cao.</div>
                           <div class="expl-step"><b>3. K·∫øt lu·∫≠n:</b> Tr√°i nghƒ©a v·ªõi "historic" l√† "modern".</div>`
                },
                {
                    q: "3. VTV3 is a very <u>popular</u> channel in Vietnam.", ans: "B",
                    options: [ {val: "A", text: "well-known"}, {val: "B", text: "uncommon"}, {val: "C", text: "common"}, {val: "D", text: "famous"} ],
                    expl: `<div class="expl-step"><b>1. D·ªãch:</b> VTV3 l√† m·ªôt k√™nh r·∫•t ph·ªï bi·∫øn ·ªü Vi·ªát Nam.</div>
                           <div class="expl-step"><b>2. Ph√¢n t√≠ch:</b><br>- A. well-known / D. famous / C. common: n·ªïi ti·∫øng, ph·ªï bi·∫øn (ƒê·ªìng nghƒ©a).<br>- B. uncommon: kh√¥ng ph·ªï bi·∫øn, hi·∫øm th·∫•y (Tr√°i nghƒ©a).</div>
                           <div class="expl-step"><b>3. K·∫øt lu·∫≠n:</b> Ch·ªçn B.</div>`
                },
                {
                    q: "4. I love staying in this city because it has <u>nice</u> weather during the year.", ans: "D",
                    options: [ {val: "A", text: "sunny"}, {val: "B", text: "good"}, {val: "C", text: "windy"}, {val: "D", text: "bad"} ],
                    expl: `<div class="expl-step"><b>1. D·ªãch:</b> T√¥i th√≠ch ·ªü l·∫°i th√†nh ph·ªë n√†y v√¨ n√≥ c√≥ th·ªùi ti·∫øt ƒë·∫πp quanh nƒÉm.</div>
                           <div class="expl-step"><b>2. Ph√¢n t√≠ch:</b> Tr√°i nghƒ©a v·ªõi "nice" (ƒë·∫πp/t·ªët) ch·∫Øc ch·∫Øn l√† "bad" (x·∫•u/t·ªá).</div>`
                }
            ]
        },
        {
            section: "Exercise 8: Choose the word or phrase that needs correcting.",
            questions: [
                {
                    q: "1. Because my sister didn't <u>finished</u> her homework, she <u>stayed up</u> late <u>last night</u>.", ans: "A",
                    options: [ {val: "A", text: "finished"}, {val: "B", text: "stayed up"}, {val: "C", text: "Because"}, {val: "D", text: "last night"} ],
                    expl: `<div class="expl-step"><b>1. Ph√¢n t√≠ch l·ªói sai:</b> Trong c√¢u ph·ªß ƒë·ªãnh c·ªßa th√¨ Qu√° kh·ª© ƒë∆°n, khi ƒë√£ m∆∞·ª£n tr·ª£ ƒë·ªông t·ª´ "didn't", ƒë·ªông t·ª´ ch√≠nh b·∫Øt bu·ªôc ph·∫£i tr·ªü v·ªÅ d·∫°ng nguy√™n th·ªÉ.</div>
                           <div class="expl-step"><b>2. S·ª≠a l·ªói:</b> "finished" ph·∫£i s·ª≠a th√†nh "finish". (Ch·ªçn A).</div>`
                },
                {
                    q: "2. <u>This</u> is <u>your</u> room. <u>Our</u> is opposite the <u>hall</u>.", ans: "C",
                    options: [ {val: "A", text: "This"}, {val: "B", text: "your"}, {val: "C", text: "Our"}, {val: "D", text: "hall"} ],
                    expl: `<div class="expl-step"><b>1. Ph√¢n t√≠ch l·ªói sai:</b> "Our" l√† t√≠nh t·ª´ s·ªü h·ªØu, n√≥ b·∫Øt bu·ªôc ph·∫£i ƒë·ª©ng tr∆∞·ªõc m·ªôt danh t·ª´ (V√≠ d·ª•: Our room). Trong c√¢u n√†y, t·ª´ n√†y ƒëang ƒë·ª©ng m·ªôt m√¨nh l√†m ch·ªß ng·ªØ ƒë·∫°i di·ªán cho "Ph√≤ng c·ªßa ch√∫ng t√¥i".</div>
                           <div class="expl-step"><b>2. S·ª≠a l·ªói:</b> Ph·∫£i d√πng ƒê·∫°i t·ª´ s·ªü h·ªØu: "Our" -> "Ours". (Ch·ªçn C).</div>`
                },
                {
                    q: "3. <u>Yesterday</u>, I went to bed <u>when</u> I got home <u>so</u> I was very <u>tired</u>.", ans: "C",
                    options: [ {val: "A", text: "Yesterday"}, {val: "B", text: "when"}, {val: "C", text: "so"}, {val: "D", text: "tired"} ],
                    expl: `<div class="expl-step"><b>1. Ph√¢n t√≠ch l·ªói sai v·ªÅ Logic:</b> D·ªãch nghƒ©a c√¢u: "H√¥m qua, t√¥i ƒë√£ ƒëi ng·ªß khi t√¥i v·ªÅ nh√† N√äN t√¥i r·∫•t m·ªát." -> Logic b·ªã ng∆∞·ª£c. S·ª± th·∫≠t ph·∫£i l√†: T√¥i ƒëi ng·ªß V√å t√¥i qu√° m·ªát.</div>
                           <div class="expl-step"><b>2. S·ª≠a l·ªói:</b> Ch·ªØ "so" (n√™n/v√¨ v·∫≠y) ph·∫£i ƒë·ªïi th√†nh "because" (b·ªüi v√¨). Ch·ªçn C.</div>`
                }
            ]
        },
        {
            section: "Exercise 11: Choose the correct rewritten sentence with the meaning unchanged.",
            questions: [
                {
                    q: "1. Your mom doesn‚Äôt want you to play outside when it‚Äôs cold.<br>‚ûî Your mom said: ‚Äú____‚Äù", ans: "B",
                    options: [ 
                        {val: "A", text: "Do play outside when it's cold."}, 
                        {val: "B", text: "Don't play outside when it's cold."}, 
                        {val: "C", text: "Not playing outside when it's cold."}, 
                        {val: "D", text: "Didn't play outside when it's cold."} 
                    ],
                    expl: `<div class="expl-step"><b>1. Ph√¢n t√≠ch:</b> C√¢u g·ªëc: "M·∫π b·∫°n kh√¥ng mu·ªën b·∫°n ch∆°i ngo√†i tr·ªùi khi tr·ªùi l·∫°nh." -> Chuy·ªÉn sang l·ªùi n√≥i tr·ª±c ti·∫øp (c√¢u m·ªánh l·ªánh c·∫•m ƒëo√°n).</div>
                           <div class="expl-step"><b>2. T·∫°i sao ch·ªçn B?</b> C√¢u m·ªánh l·ªánh ph·ªß ƒë·ªãnh b·∫Øt ƒë·∫ßu b·∫±ng "Don't + V_nguy√™n th·ªÉ". (ƒê·ª´ng ch∆°i ngo√†i tr·ªùi...).</div>`
                },
                {
                    q: "2. The teacher wants students to stand in line.<br>‚ûî The teacher said: ‚ÄúEveryone, ____.‚Äù", ans: "A",
                    options: [ 
                        {val: "A", text: "stand in line, please"}, 
                        {val: "B", text: "to stand in line"}, 
                        {val: "C", text: "standing in line"}, 
                        {val: "D", text: "don't stand in line"} 
                    ],
                    expl: `<div class="expl-step"><b>1. Ph√¢n t√≠ch:</b> C√¢u g·ªëc: "Gi√°o vi√™n mu·ªën h·ªçc sinh x·∫øp h√†ng." -> Chuy·ªÉn th√†nh c√¢u ra l·ªánh tr·ª±c ti·∫øp.</div>
                           <div class="expl-step"><b>2. T·∫°i sao ch·ªçn A?</b> C√¢u m·ªánh l·ªánh kh·∫≥ng ƒë·ªãnh b·∫Øt ƒë·∫ßu b·∫±ng ƒê·ªông t·ª´ nguy√™n th·ªÉ (Stand...). C√°c ƒë√°p √°n B, C sai ng·ªØ ph√°p. D sai nghƒ©a.</div>`
                },
                {
                    q: "3. Linda is a good basketball player.<br>‚ûî Linda plays ____.", ans: "C",
                    options: [ 
                        {val: "A", text: "basketball good"}, 
                        {val: "B", text: "good basketball"}, 
                        {val: "C", text: "basketball well"}, 
                        {val: "D", text: "basketball player"} 
                    ],
                    expl: `<div class="expl-step"><b>1. Ph√¢n t√≠ch:</b> C·∫•u tr√∫c t∆∞∆°ng ƒë∆∞∆°ng: S + be + a/an + Adj + Noun (Ch·ªâ ng∆∞·ªùi) <=> S + V_th∆∞·ªùng + Noun (v·∫≠t) + Adv.</div>
                           <div class="expl-step"><b>2. T·∫°i sao ch·ªçn C?</b> ƒê·ªông t·ª´ "plays" l√† ƒë·ªông t·ª´ th∆∞·ªùng n√™n ta ph·∫£i d√πng Tr·∫°ng t·ª´ ƒë·ªÉ b·ªï nghƒ©a. Tr·∫°ng t·ª´ c·ªßa "good" l√† "well".</div>`
                },
                {
                    q: "4. My mom drives her motorbike carefully.<br>‚ûî My mom is a ____.", ans: "A",
                    options: [ 
                        {val: "A", text: "careful motorbike driver"}, 
                        {val: "B", text: "carefully motorbike driver"}, 
                        {val: "C", text: "careful motorbike driving"}, 
                        {val: "D", text: "motorbike driver carefully"} 
                    ],
                    expl: `<div class="expl-step"><b>1. Ph√¢n t√≠ch:</b> C·∫•u tr√∫c chuy·ªÉn ƒë·ªïi ng∆∞·ª£c l·∫°i v·ªõi c√¢u s·ªë 3. T·ª´ tr·∫°ng t·ª´ "carefully" ƒë·ª©ng sau ƒë·ªông t·ª´ "drives", ta chuy·ªÉn th√†nh T√≠nh t·ª´ "careful" ƒë·ª©ng tr∆∞·ªõc danh t·ª´ ch·ªâ ng∆∞·ªùi "driver".</div>
                           <div class="expl-step"><b>2. T·∫°i sao ch·ªçn A?</b> "careful motorbike driver" (ng∆∞·ªùi l√°i xe m√°y c·∫©n th·∫≠n).</div>`
                },
                {
                    q: "5. What TV programme do you like best?<br>‚ûî What's ____?", ans: "D",
                    options: [ 
                        {val: "A", text: "your favorite TV programme like"}, 
                        {val: "B", text: "TV programme you like"}, 
                        {val: "C", text: "best TV programme"}, 
                        {val: "D", text: "your favorite TV programme"} 
                    ],
                    expl: `<div class="expl-step"><b>1. Ph√¢n t√≠ch:</b> "like best" (th√≠ch nh·∫•t) t∆∞∆°ng ƒë∆∞∆°ng v·ªõi t√≠nh t·ª´ "favorite" (y√™u th√≠ch).</div>
                           <div class="expl-step"><b>2. T·∫°i sao ch·ªçn D?</b> D·ªãch: "Ch∆∞∆°ng tr√¨nh truy·ªÅn h√¨nh y√™u th√≠ch C·ª¶A B·∫†N l√† g√¨?" (What's your favorite TV programme?). C√°c ƒë√°p √°n kh√°c sai c·∫•u tr√∫c ng·ªØ ph√°p.</div>`
                }
            ]
        },
        {
            section: "Exercise 12: Choose the meaningful sentence using the words given.",
            questions: [
                {
                    q: "1. How often/ you/ usually/ watch T.V/?", ans: "B",
                    options: [ 
                        {val: "A", text: "How often you usually watch T.V?"}, 
                        {val: "B", text: "How often do you usually watch T.V?"}, 
                        {val: "C", text: "How often are you usually watch T.V?"}, 
                        {val: "D", text: "How often do you usually watching T.V?"} 
                    ],
                    expl: `<div class="expl-step"><b>Ph√¢n t√≠ch:</b> C√¢u h·ªèi v·ªõi ƒë·ªông t·ª´ th∆∞·ªùng "watch" ·ªü th√¨ Hi·ªán t·∫°i ƒë∆°n, ta ph·∫£i m∆∞·ª£n tr·ª£ ƒë·ªông t·ª´ "do" ƒë·ª©ng tr∆∞·ªõc ch·ªß ng·ªØ "you". Ch·ªçn B.</div>`
                },
                {
                    q: "2. This morning/ weather/ bad/ we/ not go/ a picnic.", ans: "A",
                    options: [ 
                        {val: "A", text: "This morning the weather was bad, so we didn't go for a picnic."}, 
                        {val: "B", text: "This morning weather bad so we don't go a picnic."}, 
                        {val: "C", text: "This morning the weather is bad, so we didn't go for a picnic."}, 
                        {val: "D", text: "Because this morning the weather was bad, so we didn't go for a picnic."} 
                    ],
                    expl: `<div class="expl-step"><b>Ph√¢n t√≠ch:</b> "This morning" (S√°ng nay - ƒë√£ qua) -> D√πng th√¨ Qu√° kh·ª© ƒë∆°n. ƒê·ªông t·ª´ to be l√† "was", ph·ªß ƒë·ªãnh c·ªßa go l√† "didn't go". C·ª•m t·ª´: "go for a picnic". Ch·ªçn A. (C√¢u D sai v√¨ ƒë√£ c√≥ Because th√¨ kh√¥ng c√≥ so).</div>`
                },
                {
                    q: "3. My friend/ not take/ sport club/ yesterday/ he/ busy.", ans: "C",
                    options: [ 
                        {val: "A", text: "My friend not take part in sport club yesterday because he was busy."}, 
                        {val: "B", text: "My friend didn't take sport club yesterday because he is busy."}, 
                        {val: "C", text: "My friend didn't take part in the sport club yesterday because he was busy."}, 
                        {val: "D", text: "My friend doesn't take part in the sport club yesterday because he was busy."} 
                    ],
                    expl: `<div class="expl-step"><b>Ph√¢n t√≠ch:</b> "yesterday" -> Qu√° kh·ª© ƒë∆°n. Ph·ªß ƒë·ªãnh l√† "didn't take". C·ª•m t·ª´ tham gia: "take part in". Hai v·∫ø ch·ªâ nguy√™n nh√¢n k·∫øt qu·∫£ n·ªëi b·∫±ng "because". Ch·ªçn C.</div>`
                },
                {
                    q: "4. This book/ mine/ not yours.", ans: "A",
                    options: [ 
                        {val: "A", text: "This book is mine, not yours."}, 
                        {val: "B", text: "This book is mine, it not yours."}, 
                        {val: "C", text: "This book are mine, not yours."}, 
                        {val: "D", text: "This book is mine, doesn't yours."} 
                    ],
                    expl: `<div class="expl-step"><b>Ph√¢n t√≠ch:</b> C·∫•u tr√∫c s·ª≠ d·ª•ng ƒê·∫°i t·ª´ s·ªü h·ªØu (mine / yours). Ch·ªß ng·ªØ "This book" s·ªë √≠t ƒëi v·ªõi ƒë·ªông t·ª´ to be "is". L∆∞·ª£c b·ªè v·∫ø sau cho t·ª± nhi√™n: "...is mine, not yours" (Quy·ªÉn s√°ch n√†y c·ªßa t√¥i, kh√¥ng ph·∫£i c·ªßa b·∫°n). Ch·ªçn A.</div>`
                },
                {
                    q: "5. What/ your brother/ eat/ dinner/ last night?", ans: "B",
                    options: [ 
                        {val: "A", text: "What do your brother eat for dinner last night?"}, 
                        {val: "B", text: "What did your brother eat for dinner last night?"}, 
                        {val: "C", text: "What was your brother eat for dinner last night?"}, 
                        {val: "D", text: "What did your brother ate for dinner last night?"} 
                    ],
                    expl: `<div class="expl-step"><b>Ph√¢n t√≠ch:</b> "last night" -> Qu√° kh·ª© ƒë∆°n. C√¢u h·ªèi v·ªõi ƒë·ªông t·ª´ th∆∞·ªùng m∆∞·ª£n "did", ƒë·ªông t·ª´ ch√≠nh (eat) gi·ªØ nguy√™n th·ªÉ. Gi·ªõi t·ª´ ƒëi v·ªõi b·ªØa ƒÉn l√† "for" (eat for dinner). Ch·ªçn B.</div>`
                }
            ]
        }
    ];

    const quizContainer = document.getElementById('quiz-container');

    // --- RENDER EXERCISE 5 (GAP FILL POPUP) ---
    const ex5Div = document.createElement('div');
    ex5Div.innerHTML = `<div class="section-title">Exercise 5: Give the correct form of the verbs in Past Simple.</div>`;
    const gapContainer = document.createElement('div');
    gapContainer.className = 'gap-fill-container';

    let currentGapBtn = null; let currentGapWord = null;

    gapFillData.forEach((item, index) => {
        totalQuestions++;
        const gapItem = document.createElement('div');
        gapItem.className = 'gap-item';
        
        let parts = item.q.split('_gap_');
        const span1 = document.createElement('span'); span1.innerText = parts[0];
        const span2 = document.createElement('span'); span2.innerText = parts[1] + ` ${item.inf}`;
        
        const btn = document.createElement('button');
        btn.className = 'gap-btn'; btn.innerText = "[ Ch·ªçn ]";
        btn.onclick = () => openGapModal(btn, item);
        
        const qContent = document.createElement('div');
        qContent.appendChild(span1); qContent.appendChild(btn); qContent.appendChild(span2);
        gapItem.appendChild(qContent);
        
        const explDiv = document.createElement('div');
        explDiv.className = 'explanation'; explDiv.id = `expl_gap_${index}`;

        const wrapper = document.createElement('div');
        wrapper.appendChild(gapItem); wrapper.appendChild(explDiv);
        gapContainer.appendChild(wrapper);
    });
    ex5Div.appendChild(gapContainer);
    quizContainer.appendChild(ex5Div);

    // X·ª≠ l√Ω Modal Gap Fill
    const modal = document.getElementById('gapModal');
    const modalOptions = document.getElementById('modal-options');

    function openGapModal(btnElement, wordData) {
        if(btnElement.disabled) return;
        currentGapBtn = btnElement; currentGapWord = wordData;
        modalOptions.innerHTML = '';
        
        let opts = shuffleArray([wordData.ans, ...wordData.wrong]);
        opts.forEach(opt => {
            const optBtn = document.createElement('button');
            optBtn.className = 'option-btn'; optBtn.innerText = opt;
            optBtn.onclick = () => selectGapAnswer(opt, wordData.ans);
            modalOptions.appendChild(optBtn);
        });
        modal.style.display = 'flex';
    }

    function selectGapAnswer(selected, correctAns) {
        modal.style.display = 'none';
        currentGapBtn.innerText = selected; currentGapBtn.disabled = true;

        const wrapper = currentGapBtn.closest('div').parentElement.parentElement;
        const explDiv = wrapper.querySelector('.explanation');

        explDiv.innerHTML = `<h4>üí° Gi·∫£i th√≠ch chi ti·∫øt:</h4>${currentGapWord.expl}`;

        if(selected === correctAns) {
            currentGapBtn.classList.add('filled-correct'); playDing(); triggerConfetti(); score++;
        } else {
            currentGapBtn.classList.add('filled-wrong');
            currentGapBtn.closest('.gap-item').classList.add('shake');
            playBuzz(); setTimeout(() => currentGapBtn.closest('.gap-item').classList.remove('shake'), 400);
            explDiv.innerHTML += `<div class="expl-step" style="color:red; font-weight: bold;">L∆∞u √Ω: ƒê√°p √°n ƒë√∫ng l√† "${correctAns}". L·∫ßn sau c·∫©n th·∫≠n h∆°n nh√©!</div>`;
        }
        explDiv.style.display = 'block';
    }

    window.onclick = function(event) { if (event.target == modal) modal.style.display = "none"; }

    // --- RENDER MULTIPLE CHOICE EXERCISES ---
    multipleChoiceData.forEach(sec => {
        const secDiv = document.createElement('div');
        secDiv.innerHTML = `<div class="section-title">${sec.section}</div>`;
        
        sec.questions.forEach((qObj) => {
            totalQuestions++;
            const card = document.createElement('div'); card.className = 'card';
            
            const qText = document.createElement('div'); qText.className = 'question-text';
            qText.innerHTML = qObj.q; card.appendChild(qText);

            const optionsGrid = document.createElement('div'); optionsGrid.className = 'options-grid';
            let shuffledOptions = shuffleArray([...qObj.options]);

            shuffledOptions.forEach(opt => {
                const btn = document.createElement('button'); btn.className = 'option-btn';
                let cleanText = opt.text.replace(/^[A-D]\.\s*/, '');
                btn.innerHTML = cleanText; 
                
                if (opt.val === qObj.ans) btn.dataset.correct = "true";

                btn.onclick = () => handleAnswer(btn, optionsGrid, opt.val === qObj.ans, qObj.expl, card);
                optionsGrid.appendChild(btn);
            });

            card.appendChild(optionsGrid);
            const explDiv = document.createElement('div'); explDiv.className = 'explanation';
            card.appendChild(explDiv);
            secDiv.appendChild(card);
        });
        quizContainer.appendChild(secDiv);
    });

    function handleAnswer(btn, grid, isCorrect, explHTML, cardDiv) {
        const buttons = grid.querySelectorAll('.option-btn');
        buttons.forEach(b => b.disabled = true);

        const explDiv = cardDiv.querySelector('.explanation');
        explDiv.innerHTML = `<h4>üí° Gi·∫£i th√≠ch chi ti·∫øt:</h4>${explHTML}`;

        if (isCorrect) {
            btn.classList.add('correct'); playDing(); triggerConfetti(); score++;
        } else {
            btn.classList.add('wrong'); cardDiv.classList.add('shake'); playBuzz();
            setTimeout(() => cardDiv.classList.remove('shake'), 400);
            const correctBtn = grid.querySelector('[data-correct="true"]');
            if (correctBtn) correctBtn.classList.add('correct');
        }
        explDiv.style.display = 'block';
    }

    // --- T·ªîNG K·∫æT ---
    function submitQuiz() {
        const resultModal = document.getElementById('resultModal');
        const scoreText = document.getElementById('score-text');
        const praiseText = document.getElementById('praise-text');

        scoreText.innerText = `B·∫°n ƒë√£ ƒë√∫ng ${score} / ${totalQuestions} c√¢u!`;
        
        let ratio = score / totalQuestions;
        let praises = [ "Xu·∫•t s·∫Øc! C√¥ Mai An r·∫•t t·ª± h√†o v·ªÅ em! üåü", "Gi·ªèi l·∫Øm! Em ƒë√£ r·∫•t n·ªó l·ª±c! üéâ", "H√£y ƒë·ªçc k·ªπ ph·∫ßn gi·∫£i th√≠ch ƒë·ªÉ ti·∫øn b·ªô h∆°n nh√©! üí™" ];

        if (ratio > 0.8) praiseText.innerText = praises[0];
        else if (ratio >= 0.5) praiseText.innerText = praises[1];
        else praiseText.innerText = praises[2];

        resultModal.style.display = 'flex'; triggerConfetti(); playDing();
    }
</script>
</body>
</html>