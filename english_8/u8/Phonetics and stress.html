<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Luy·ªán T·∫≠p Ph√°t √Çm & Tr·ªçng √Çm - Ms Mai An ULIS</title>
    <!-- Font ch·ªØ Nunito cho phong c√°ch th√¢n thi·ªán -->
    <link href="https://fonts.googleapis.com/css2?family=Nunito:wght@400;600;700;800&display=swap" rel="stylesheet">
    <!-- Th∆∞ vi·ªán Confetti (Ph√°o gi·∫•y) -->
    <script src="https://cdn.jsdelivr.net/npm/canvas-confetti@1.6.0/dist/confetti.browser.min.js"></script>
    
    <style>
        :root {
            --primary: #8854C0; /* T√≠m Pastel */
            --secondary: #00C9A7; /* Xanh ng·ªçc */
            --background: #F0F4F8;
            --card-bg: #FFFFFF;
            --text-main: #2C3E50;
            --correct: #00D26A; /* Xanh l√° */
            --wrong: #FF4757; /* ƒê·ªè cam */
            --hover-shadow: 0 8px 0 rgba(0,0,0,0.15);
            --btn-shadow: 0 4px 0 rgba(0,0,0,0.15);
        }

        body {
            font-family: 'Nunito', sans-serif;
            background-color: #8EC5FC;
            background-image: linear-gradient(62deg, #8EC5FC 0%, #E0C3FC 100%);
            margin: 0;
            padding: 20px;
            color: var(--text-main);
            min-height: 100vh;
        }

        /* Header */
        header {
            text-align: center;
            margin-bottom: 30px;
            background: white;
            padding: 20px;
            border-radius: 20px;
            box-shadow: 0 10px 20px rgba(0,0,0,0.1);
            border-bottom: 5px solid var(--primary);
            max-width: 800px;
            margin-left: auto;
            margin-right: auto;
        }

        h1 {
            color: var(--primary);
            margin: 0;
            font-weight: 800;
            font-size: 2rem;
            text-transform: uppercase;
        }

        .subtitle {
            color: #666;
            font-size: 1.1rem;
            margin-top: 5px;
            font-weight: 600;
        }

        /* Score Board */
        .score-board {
            position: fixed;
            top: 20px;
            right: 20px;
            background: var(--secondary);
            color: white;
            padding: 10px 20px;
            border-radius: 50px;
            font-weight: 800;
            font-size: 1.2rem;
            box-shadow: 0 4px 10px rgba(0,0,0,0.2);
            z-index: 1000;
            border: 2px solid white;
        }

        /* Container */
        .quiz-container {
            max-width: 800px;
            margin: 0 auto;
        }

        /* Question Card */
        .question-card {
            background: var(--card-bg);
            border-radius: 20px;
            padding: 25px;
            margin-bottom: 30px;
            box-shadow: 0 8px 0 rgba(0,0,0,0.05);
            border: 2px solid #eee;
            transition: transform 0.3s ease;
            position: relative;
            overflow: hidden;
        }

        .question-card:hover {
            transform: translateY(-5px);
        }

        .question-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 15px;
        }

        .q-tag {
            background: var(--primary);
            color: white;
            padding: 5px 15px;
            border-radius: 20px;
            font-size: 0.9rem;
            font-weight: 700;
        }

        .question-text {
            font-size: 1.3rem;
            font-weight: 700;
            margin-bottom: 25px;
            color: #2c3e50;
            line-height: 1.5;
        }

        u {
            text-decoration: none;
            border-bottom: 3px solid var(--primary);
            padding-bottom: 2px;
            color: var(--primary);
            font-weight: 800;
        }

        /* Options Grid */
        .options-grid {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 15px;
        }

        @media (max-width: 600px) {
            .options-grid {
                grid-template-columns: 1fr;
            }
        }

        /* Option Button */
        .option-btn {
            background: white;
            border: 2px solid #ddd;
            border-bottom: 5px solid #ddd;
            padding: 15px;
            border-radius: 15px;
            font-size: 1.1rem;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.1s;
            text-align: left;
            position: relative;
            color: #555;
            font-family: 'Nunito', sans-serif;
        }

        .option-btn:active {
            transform: translateY(3px);
            border-bottom-width: 2px;
        }

        .option-btn:hover:not(.disabled) {
            background-color: #f9f9f9;
            border-color: #ccc;
        }

        /* States */
        .option-btn.correct {
            background-color: var(--correct);
            color: white;
            border-color: #00A653;
            border-bottom-color: #008E47;
        }

        .option-btn.wrong {
            background-color: var(--wrong);
            color: white;
            border-color: #E63B49;
            border-bottom-color: #C92D3A;
            animation: shake 0.5s;
        }

        .disabled {
            pointer-events: none;
            opacity: 0.8;
        }

        /* Explanation Box */
        .explanation-box {
            margin-top: 20px;
            background: #F0F4F8;
            border-radius: 15px;
            padding: 20px;
            display: none; /* Hidden by default */
            border-left: 5px solid var(--primary);
            animation: slideDown 0.4s ease-out;
        }

        .exp-title {
            font-weight: 800;
            color: var(--primary);
            margin-bottom: 10px;
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .exp-content {
            font-size: 1rem;
            line-height: 1.6;
            color: #444;
        }

        .vocab-item {
            display: block;
            margin-bottom: 5px;
            padding-bottom: 5px;
            border-bottom: 1px dashed #ccc;
        }
        
        .vocab-item strong {
            color: var(--secondary);
        }

        /* Animations */
        @keyframes shake {
            0% { transform: translateX(0); }
            25% { transform: translateX(-10px); }
            50% { transform: translateX(10px); }
            75% { transform: translateX(-10px); }
            100% { transform: translateX(0); }
        }

        @keyframes slideDown {
            from { opacity: 0; transform: translateY(-10px); }
            to { opacity: 1; transform: translateY(0); }
        }

        /* Footer */
        .footer-btn {
            display: block;
            width: 100%;
            max-width: 300px;
            margin: 40px auto;
            padding: 15px;
            background: var(--secondary);
            color: white;
            text-align: center;
            font-size: 1.5rem;
            font-weight: 800;
            border: none;
            border-radius: 50px;
            box-shadow: 0 6px 0 #009E82;
            cursor: pointer;
            transition: transform 0.2s;
        }

        .footer-btn:active {
            transform: translateY(4px);
            box-shadow: 0 2px 0 #009E82;
        }
        
        /* Modal Result */
        .modal {
            display: none;
            position: fixed;
            z-index: 2000;
            left: 0;
            top: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0,0,0,0.5);
            align-items: center;
            justify-content: center;
        }
        
        .modal-content {
            background-color: white;
            padding: 40px;
            border-radius: 25px;
            text-align: center;
            width: 90%;
            max-width: 500px;
            box-shadow: 0 10px 30px rgba(0,0,0,0.3);
            animation: slideDown 0.5s;
        }
        
        .result-score {
            font-size: 3rem;
            font-weight: 800;
            color: var(--primary);
            margin: 20px 0;
        }

    </style>
</head>
<body>

    <div class="score-board">
        ƒêi·ªÉm: <span id="current-score">0</span>/<span id="total-questions">20</span>
    </div>

    <header>
        <h1>B√ÄI KI·ªÇM TRA TI·∫æNG ANH</h1>
        <div class="subtitle">Gi√°o vi√™n: Ms. Mai An (ULIS)</div>
        <div style="margin-top:10px; font-size: 0.9em; color: #888;">Ph√°t √¢m & Tr·ªçng √¢m (20 c√¢u)</div>
    </header>

    <div class="quiz-container" id="quiz-container">
        <!-- Questions will be injected here by JavaScript -->
    </div>

    <button class="footer-btn" onclick="finishQuiz()">N·ªòP B√ÄI</button>

    <!-- Result Modal -->
    <div id="resultModal" class="modal">
        <div class="modal-content">
            <h2 style="color: var(--secondary)">K·∫æT QU·∫¢ C·ª¶A B·∫†N</h2>
            <p>B·∫°n ƒë√£ ho√†n th√†nh b√†i ki·ªÉm tra!</p>
            <div class="result-score" id="final-score">0/20</div>
            <p id="feedback-text" style="font-size: 1.2rem; font-weight: 600;">Xu·∫•t s·∫Øc!</p>
            <button class="footer-btn" style="font-size: 1rem; padding: 10px 30px; margin-top: 20px;" onclick="closeModal()">Xem l·∫°i b√†i</button>
        </div>
    </div>

    <script>
        // DATA: D·ªØ li·ªáu c√¢u h·ªèi t·ª´ y√™u c·∫ßu
        const quizData = [
            // PHONETICS (1-10)
            {
                id: 1,
                type: "Phonetics",
                question: "Ch·ªçn t·ª´ c√≥ ph·∫ßn g·∫°ch ch√¢n ph√°t √¢m kh√°c:",
                words: ["minor<u>i</u>ty", "m<u>i</u>ss", "b<u>i</u>ll", "conven<u>i</u>ence"],
                correctIndex: 0,
                explanation: {
                    vocab: [
                        "A. minority (n): thi·ªÉu s·ªë (/a…™/)",
                        "B. miss (v/n): b·ªè l·ª°, nh·ªõ / c√¥ (/…™/)",
                        "C. bill (n): h√≥a ƒë∆°n (/…™/)",
                        "D. convenience (n): s·ª± ti·ªán l·ª£i (/…™/)"
                    ],
                    detail: "'minority' c√≥ ph·∫ßn g·∫°ch ch√¢n ph√°t √¢m l√† nguy√™n √¢m ƒë√¥i <b>/a…™/</b> (ai). Ba t·ª´ c√≤n l·∫°i ph√°t √¢m l√† √¢m ng·∫Øn <b>/…™/</b>."
                }
            },
            {
                id: 2,
                type: "Phonetics",
                question: "Ch·ªçn t·ª´ c√≥ ph·∫ßn g·∫°ch ch√¢n ph√°t √¢m kh√°c:",
                words: ["b<u>a</u>rgain", "m<u>a</u>rket", "l<u>a</u>rge", "r<u>a</u>nge"],
                correctIndex: 3,
                explanation: {
                    vocab: [
                        "A. bargain (n/v): m√≥n h·ªùi, m·∫∑c c·∫£ (/…ëÀê/)",
                        "B. market (n): ch·ª£ (/…ëÀê/)",
                        "C. large (adj): r·ªông l·ªõn (/…ëÀê/)",
                        "D. range (n): ph·∫°m vi (/e…™/)"
                    ],
                    detail: "'range' c√≥ ch·ªØ 'a' ph√°t √¢m l√† <b>/e…™/</b>. Ba t·ª´ c√≤n l·∫°i ph√°t √¢m l√† <b>/…ëÀê/</b> (a d√†i)."
                }
            },
            {
                id: 3,
                type: "Phonetics",
                question: "Ch·ªçn t·ª´ c√≥ ph·∫ßn g·∫°ch ch√¢n ph√°t √¢m kh√°c:",
                words: ["ret<u>u</u>rn", "sched<u>u</u>le", "red<u>u</u>ce", "introd<u>u</u>ce"],
                correctIndex: 0,
                explanation: {
                    vocab: [
                        "A. return (v/n): tr·ªü v·ªÅ (/…úÀê/)",
                        "B. schedule (n): l·ªãch tr√¨nh (/uÀê/)",
                        "C. reduce (v): gi·∫£m b·ªõt (/uÀê/)",
                        "D. introduce (v): gi·ªõi thi·ªáu (/uÀê/)"
                    ],
                    detail: "'return' c√≥ √¢m 'u' ph√°t √¢m l√† <b>/…úÀê/</b> (∆° d√†i). Ba t·ª´ c√≤n l·∫°i ph√°t √¢m l√† <b>/uÀê/</b> (u d√†i)."
                }
            },
            {
                id: 4,
                type: "Phonetics",
                question: "Ch·ªçn t·ª´ c√≥ ph·∫ßn g·∫°ch ch√¢n ph√°t √¢m kh√°c:",
                words: ["l<u>ou</u>d", "neighb<u>ou</u>r", "h<u>ou</u>r", "disc<u>ou</u>nt"],
                correctIndex: 1,
                explanation: {
                    vocab: [
                        "A. loud (adj): ·ªìn √†o (/a ä/)",
                        "B. neighbour (n): h√†ng x√≥m (/…ô/)",
                        "C. hour (n): gi·ªù (/a ä/)",
                        "D. discount (n): gi·∫£m gi√° (/a ä/)"
                    ],
                    detail: "'neighbour' l√† √¢m kh√¥ng nh·∫•n tr·ªçng √¢m n√™n 'ou' ƒë·ªçc l∆∞·ªõt th√†nh <b>/…ô/</b>. C√°c t·ª´ c√≤n l·∫°i ƒë·ªçc r√µ l√† <b>/a ä/</b> (ao)."
                }
            },
            {
                id: 5,
                type: "Phonetics",
                question: "Ch·ªçn t·ª´ c√≥ ph·∫ßn g·∫°ch ch√¢n ph√°t √¢m kh√°c:",
                words: ["pri<u>c</u>e", "spi<u>c</u>y", "<u>c</u>entre", "fa<u>c</u>tory"],
                correctIndex: 3,
                explanation: {
                    vocab: [
                        "A. price (n): gi√° c·∫£ (/s/)",
                        "B. spicy (adj): cay (/s/)",
                        "C. centre (n): trung t√¢m (/s/)",
                        "D. factory (n): nh√† m√°y (/k/)"
                    ],
                    detail: "Quy t·∫Øc: Ch·ªØ 'c' ƒë·ª©ng tr∆∞·ªõc e, i, y th∆∞·ªùng ƒë·ªçc l√† <b>/s/</b>. Trong t·ª´ 'factory', ch·ªØ 'c' ƒë·ª©ng tr∆∞·ªõc ph·ª• √¢m 't' n√™n ƒë·ªçc l√† <b>/k/</b>."
                }
            },
            {
                id: 6,
                type: "Phonetics",
                question: "Ch·ªçn t·ª´ c√≥ ph·∫ßn g·∫°ch ch√¢n ph√°t √¢m kh√°c:",
                words: ["<u>a</u>ccess", "<u>a</u>dvantage", "<u>a</u>ffect", "<u>a</u>ddicted"],
                correctIndex: 0,
                explanation: {
                    vocab: [
                        "A. access (v/n): truy c·∫≠p (/√¶/)",
                        "B. advantage (n): l·ª£i th·∫ø (/…ô/)",
                        "C. affect (v): ·∫£nh h∆∞·ªüng (/…ô/)",
                        "D. addicted (adj): nghi·ªán (/…ô/)"
                    ],
                    detail: "'access' nh·∫•n tr·ªçng √¢m 1 n√™n 'a' ƒë·ªçc l√† <b>/√¶/</b> (e b·∫πt). C√°c t·ª´ c√≤n l·∫°i nh·∫•n √¢m 2 n√™n 'a' ƒë·∫ßu ƒë·ªçc nh·∫π th√†nh <b>/…ô/</b>."
                }
            },
            {
                id: 7,
                type: "Phonetics",
                question: "Ch·ªçn t·ª´ c√≥ ph·∫ßn g·∫°ch ch√¢n ph√°t √¢m kh√°c:",
                words: ["cr<u>e</u>dit", "<u>e</u>pisode", "<u>e</u>xpired", "c<u>e</u>ntre"],
                correctIndex: 2,
                explanation: {
                    vocab: [
                        "A. credit (n): t√≠n d·ª•ng (/e/)",
                        "B. episode (n): t·∫≠p phim (/e/)",
                        "C. expired (adj): h·∫øt h·∫°n (/…™/)",
                        "D. centre (n): trung t√¢m (/e/)"
                    ],
                    detail: "'expired' ƒë·ªçc l√† /…™kÀàspa…™…ôd/ n√™n ch·ªØ 'e' l√† √¢m <b>/…™/</b>. C√°c t·ª´ c√≤n l·∫°i 'e' ƒë·ªçc l√† <b>/e/</b>."
                }
            },
            {
                id: 8,
                type: "Phonetics",
                question: "Ch·ªçn t·ª´ c√≥ ph·∫ßn g·∫°ch ch√¢n ph√°t √¢m kh√°c:",
                words: ["<u>w</u>ander", "ans<u>w</u>er", "<u>w</u>ell-lit", "<u>w</u>henever"],
                correctIndex: 1,
                explanation: {
                    vocab: [
                        "A. wander (v): ƒëi lang thang (/w/)",
                        "B. answer (v): tr·∫£ l·ªùi (√¢m c√¢m)",
                        "C. well-lit (adj): ƒë·ªß s√°ng (/w/)",
                        "D. whenever (conj): b·∫•t c·ª© khi n√†o (/w/)"
                    ],
                    detail: "Trong t·ª´ 'answer', ch·ªØ 'w' l√† <b>√¢m c√¢m</b> (kh√¥ng ƒë·ªçc). C√°c t·ª´ c√≤n l·∫°i ph√°t √¢m /w/ b√¨nh th∆∞·ªùng."
                }
            },
            {
                id: 9,
                type: "Phonetics",
                question: "Ch·ªçn t·ª´ c√≥ ph·∫ßn g·∫°ch ch√¢n ph√°t √¢m kh√°c:",
                words: ["shop<u>a</u>holic", "<u>a</u>dvertisement", "displ<u>a</u>y", "doll<u>a</u>r"],
                correctIndex: 2,
                explanation: {
                    vocab: [
                        "A. shopaholic (n): nghi·ªán mua s·∫Øm (/…ô/)",
                        "B. advertisement (n): qu·∫£ng c√°o (/…ô/)",
                        "C. display (v): tr∆∞ng b√†y (/e…™/)",
                        "D. dollar (n): ƒë√¥ la (/…ô/)"
                    ],
                    detail: "'display' c√≥ √¢m 'ay' ƒë·ªçc l√† <b>/e…™/</b>. C√°c ch·ªØ 'a' trong c√°c t·ª´ c√≤n l·∫°i ƒë·ªÅu ·ªü v·ªã tr√≠ kh√¥ng nh·∫•n tr·ªçng √¢m n√™n ƒë·ªçc l√† <b>/…ô/</b>."
                }
            },
            {
                id: 10,
                type: "Phonetics",
                question: "Ch·ªçn t·ª´ c√≥ ph·∫ßn g·∫°ch ch√¢n ph√°t √¢m kh√°c:",
                words: ["sh<u>u</u>ttle", "g<u>u</u>est", "c<u>u</u>stomer", "p<u>u</u>ppy"],
                correctIndex: 1,
                explanation: {
                    vocab: [
                        "A. shuttle (n): xe trung chuy·ªÉn (/ å/)",
                        "B. guest (n): kh√°ch (√¢m c√¢m)",
                        "C. customer (n): kh√°ch h√†ng (/ å/)",
                        "D. puppy (n): c√∫n con (/ å/)"
                    ],
                    detail: "Trong t·ª´ 'guest', ch·ªØ 'u' ƒëi v·ªõi 'g' ƒë·ªÉ gi·ªØ √¢m c·ª©ng cho 'e' v√† b·∫£n th√¢n n√≥ b·ªã <b>c√¢m</b>. C√°c t·ª´ c√≤n l·∫°i 'u' ƒë·ªçc l√† <b>/ å/</b>."
                }
            },
            // STRESS (11-20)
            {
                id: 11,
                type: "Stress",
                question: "Ch·ªçn t·ª´ c√≥ tr·ªçng √¢m ch√≠nh kh√°c:",
                words: ["reason", "attract", "market", "shopping"],
                correctIndex: 1,
                explanation: {
                    vocab: [
                        "A. reason (n): l√Ω do (√Çm 1)",
                        "B. attract (v): thu h√∫t (√Çm 2)",
                        "C. market (n): ch·ª£ (√Çm 1)",
                        "D. shopping (n): mua s·∫Øm (√Çm 1)"
                    ],
                    detail: "'attract' l√† ƒë·ªông t·ª´ 2 √¢m ti·∫øt th∆∞·ªùng nh·∫•n √¢m 2. C√°c t·ª´ c√≤n l·∫°i l√† danh t·ª´ 2 √¢m ti·∫øt nh·∫•n √¢m 1."
                }
            },
            {
                id: 12,
                type: "Stress",
                question: "Ch·ªçn t·ª´ c√≥ tr·ªçng √¢m ch√≠nh kh√°c:",
                words: ["almost", "awesome", "product", "return"],
                correctIndex: 3,
                explanation: {
                    vocab: [
                        "A. almost (adv): h·∫ßu nh∆∞ (√Çm 1)",
                        "B. awesome (adj): tuy·ªát v·ªùi (√Çm 1)",
                        "C. product (n): s·∫£n ph·∫©m (√Çm 1)",
                        "D. return (v/n): tr·ªü v·ªÅ (√Çm 2)"
                    ],
                    detail: "'return' nh·∫•n √¢m 2. C√°c t·ª´ c√≤n l·∫°i nh·∫•n √¢m 1."
                }
            },
            {
                id: 13,
                type: "Stress",
                question: "Ch·ªçn t·ª´ c√≥ tr·ªçng √¢m ch√≠nh kh√°c:",
                words: ["assistant", "yellowish", "condition", "attractive"],
                correctIndex: 1,
                explanation: {
                    vocab: [
                        "A. assistant (n): tr·ª£ l√Ω (√Çm 2)",
                        "B. yellowish (adj): h∆°i v√†ng (√Çm 1)",
                        "C. condition (n): ƒëi·ªÅu ki·ªán (√Çm 2)",
                        "D. attractive (adj): h·∫•p d·∫´n (√Çm 2)"
                    ],
                    detail: "'yellowish' gi·ªØ tr·ªçng √¢m g·ªëc c·ªßa 'yellow' (√¢m 1), ƒëu√¥i -ish kh√¥ng ·∫£nh h∆∞·ªüng. C√°c t·ª´ c√≤n l·∫°i nh·∫•n √¢m 2 (l∆∞u √Ω ƒëu√¥i -ion nh·∫•n tr∆∞·ªõc n√≥)."
                }
            },
            {
                id: 14,
                type: "Stress",
                question: "Ch·ªçn t·ª´ c√≥ tr·ªçng √¢m ch√≠nh kh√°c:",
                words: ["backpack", "centre", "avoid", "reason"],
                correctIndex: 2,
                explanation: {
                    vocab: [
                        "A. backpack (n): ba l√¥ (√Çm 1)",
                        "B. centre (n): trung t√¢m (√Çm 1)",
                        "C. avoid (v): tr√°nh xa (√Çm 2)",
                        "D. reason (n): l√Ω do (√Çm 1)"
                    ],
                    detail: "'avoid' l√† ƒë·ªông t·ª´ nh·∫•n √¢m 2. C√°c t·ª´ c√≤n l·∫°i l√† danh t·ª´ nh·∫•n √¢m 1."
                }
            },
            {
                id: 15,
                type: "Stress",
                question: "Ch·ªçn t·ª´ c√≥ tr·ªçng √¢m ch√≠nh kh√°c:",
                words: ["decorate", "volunteer", "customer", "exercise"],
                correctIndex: 1,
                explanation: {
                    vocab: [
                        "A. decorate (v): trang tr√≠ (√Çm 1)",
                        "B. volunteer (n): t√¨nh nguy·ªán vi√™n (√Çm 3)",
                        "C. customer (n): kh√°ch h√†ng (√Çm 1)",
                        "D. exercise (n/v): b√†i t·∫≠p (√Çm 1)"
                    ],
                    detail: "Quy t·∫Øc: ƒêu√¥i <b>-eer</b> (trong volunteer) lu√¥n nh·∫≠n tr·ªçng √¢m. C√°c t·ª´ c√≤n l·∫°i nh·∫•n √¢m 1."
                }
            },
            {
                id: 16,
                type: "Stress",
                question: "Ch·ªçn t·ª´ c√≥ tr·ªçng √¢m ch√≠nh kh√°c:",
                words: ["become", "special", "open", "product"],
                correctIndex: 0,
                explanation: {
                    vocab: [
                        "A. become (v): tr·ªü th√†nh (√Çm 2)",
                        "B. special (adj): ƒë·∫∑c bi·ªát (√Çm 1)",
                        "C. open (v/adj): m·ªü (√Çm 1)",
                        "D. product (n): s·∫£n ph·∫©m (√Çm 1)"
                    ],
                    detail: "'become' l√† ƒë·ªông t·ª´ nh·∫•n √¢m 2. C√°c t·ª´ c√≤n l·∫°i nh·∫•n √¢m 1."
                }
            },
            {
                id: 17,
                type: "Stress",
                question: "Ch·ªçn t·ª´ c√≥ tr·ªçng √¢m ch√≠nh kh√°c:",
                words: ["voucher", "shuttle", "online", "usual"],
                correctIndex: 2,
                explanation: {
                    vocab: [
                        "A. voucher (n): phi·∫øu gi·∫£m gi√° (√Çm 1)",
                        "B. shuttle (n): xe ƒë∆∞a ƒë√≥n (√Çm 1)",
                        "C. online (adj/adv): tr·ª±c tuy·∫øn (√Çm 2)",
                        "D. usual (adj): th√¥ng th∆∞·ªùng (√Çm 1)"
                    ],
                    detail: "'online' th∆∞·ªùng nh·∫•n √¢m 2. C√°c t·ª´ c√≤n l·∫°i nh·∫•n √¢m 1."
                }
            },
            {
                id: 18,
                type: "Stress",
                question: "Ch·ªçn t·ª´ c√≥ tr·ªçng √¢m ch√≠nh kh√°c:",
                words: ["costume", "effect", "advice", "attack"],
                correctIndex: 0,
                explanation: {
                    vocab: [
                        "A. costume (n): trang ph·ª•c (√Çm 1)",
                        "B. effect (n): hi·ªáu ·ª©ng (√Çm 2)",
                        "C. advice (n): l·ªùi khuy√™n (√Çm 2)",
                        "D. attack (v/n): t·∫•n c√¥ng (√Çm 2)"
                    ],
                    detail: "'costume' nh·∫•n √¢m 1. Ba t·ª´ c√≤n l·∫°i nh·∫•n √¢m 2."
                }
            },
            {
                id: 19,
                type: "Stress",
                question: "Ch·ªçn t·ª´ c√≥ tr·ªçng √¢m ch√≠nh kh√°c:",
                words: ["pollution", "convenient", "affection", "factory"],
                correctIndex: 3,
                explanation: {
                    vocab: [
                        "A. pollution (n): √¥ nhi·ªÖm (√Çm 2)",
                        "B. convenient (adj): ti·ªán l·ª£i (√Çm 2)",
                        "C. affection (n): t√¨nh c·∫£m (√Çm 2)",
                        "D. factory (n): nh√† m√°y (√Çm 1)"
                    ],
                    detail: "C√°c t·ª´ c√≥ ƒëu√¥i -ion, -ient nh·∫•n v√†o √¢m ti·∫øt ngay tr∆∞·ªõc n√≥ (√Çm 2). 'factory' nh·∫•n √¢m 1."
                }
            },
            {
                id: 20,
                type: "Stress",
                question: "Ch·ªçn t·ª´ c√≥ tr·ªçng √¢m ch√≠nh kh√°c:",
                words: ["activity", "preparation", "enjoyable", "advantage"],
                correctIndex: 1,
                explanation: {
                    vocab: [
                        "A. activity (n): ho·∫°t ƒë·ªông (√Çm 2)",
                        "B. preparation (n): s·ª± chu·∫©n b·ªã (√Çm 3)",
                        "C. enjoyable (adj): th√∫ v·ªã (√Çm 2)",
                        "D. advantage (n): l·ª£i th·∫ø (√Çm 2)"
                    ],
                    detail: "'preparation' nh·∫•n √¢m 3 do quy t·∫Øc ƒëu√¥i -ion. C√°c t·ª´ c√≤n l·∫°i nh·∫•n √¢m 2."
                }
            }
        ];

        let score = 0;
        let answeredCount = 0;
        const totalQuestions = quizData.length;
        document.getElementById('total-questions').innerText = totalQuestions;

        // AUDIO ENGINE (Web Audio API - Kh√¥ng c·∫ßn file ngo√†i)
        const audioCtx = new (window.AudioContext || window.webkitAudioContext)();
        
        function playSound(type) {
            if (audioCtx.state === 'suspended') audioCtx.resume();
            
            const osc = audioCtx.createOscillator();
            const gainNode = audioCtx.createGain();
            
            osc.connect(gainNode);
            gainNode.connect(audioCtx.destination);
            
            if (type === 'correct') {
                // Ding sound (High pitch sine wave fade out)
                osc.type = 'sine';
                osc.frequency.setValueAtTime(800, audioCtx.currentTime);
                osc.frequency.exponentialRampToValueAtTime(1200, audioCtx.currentTime + 0.1);
                gainNode.gain.setValueAtTime(0.5, audioCtx.currentTime);
                gainNode.gain.exponentialRampToValueAtTime(0.01, audioCtx.currentTime + 0.5);
                osc.start();
                osc.stop(audioCtx.currentTime + 0.5);
            } else {
                // Wrong sound (Low pitch sawtooth slide down)
                osc.type = 'sawtooth';
                osc.frequency.setValueAtTime(300, audioCtx.currentTime);
                osc.frequency.linearRampToValueAtTime(100, audioCtx.currentTime + 0.3);
                gainNode.gain.setValueAtTime(0.3, audioCtx.currentTime);
                gainNode.gain.linearRampToValueAtTime(0.01, audioCtx.currentTime + 0.3);
                osc.start();
                osc.stop(audioCtx.currentTime + 0.3);
            }
        }

        // RENDER QUIZ
        function renderQuiz() {
            const container = document.getElementById('quiz-container');
            
            quizData.forEach((item, index) => {
                const card = document.createElement('div');
                card.className = 'question-card';
                card.id = `card-${index}`;
                
                // Header
                const header = document.createElement('div');
                header.className = 'question-header';
                header.innerHTML = `
                    <span class="q-tag">Question ${index + 1}</span>
                    <span style="font-weight:bold; color:#888;">${item.type}</span>
                `;
                
                // Text
                const qText = document.createElement('div');
                qText.className = 'question-text';
                qText.innerHTML = item.question;
                
                // Options Grid
                const grid = document.createElement('div');
                grid.className = 'options-grid';
                
                const labels = ['A', 'B', 'C', 'D'];
                
                item.words.forEach((word, wIndex) => {
                    const btn = document.createElement('div');
                    btn.className = 'option-btn';
                    btn.innerHTML = `<b>${labels[wIndex]}.</b> ${word}`;
                    btn.onclick = () => checkAnswer(index, wIndex, btn, item.correctIndex);
                    grid.appendChild(btn);
                });
                
                // Explanation Box (Hidden initially)
                const expBox = document.createElement('div');
                expBox.className = 'explanation-box';
                expBox.id = `exp-${index}`;
                
                // Build Explanation Content
                let vocabList = item.explanation.vocab.map(v => `<span class="vocab-item">${v}</span>`).join('');
                
                expBox.innerHTML = `
                    <div class="exp-title">
                        <span>üë©‚Äçüè´</span> C√¥ Mai An gi·∫£i th√≠ch:
                    </div>
                    <div class="exp-content">
                        <p style="margin-top:0"><b>Ph√¢n t√≠ch t·ª´ v·ª±ng:</b></p>
                        ${vocabList}
                        <p style="margin-bottom:0; color: var(--primary); margin-top: 10px;">
                            <b>T·∫°i sao ch·ªçn ƒë√°p √°n n√†y?</b><br>
                            ${item.explanation.detail}
                        </p>
                    </div>
                `;

                card.appendChild(header);
                card.appendChild(qText);
                card.appendChild(grid);
                card.appendChild(expBox);
                container.appendChild(card);
            });
        }

        // CHECK ANSWER LOGIC
        function checkAnswer(qIndex, selectedIndex, btnElement, correctIndex) {
            const card = document.getElementById(`card-${qIndex}`);
            const buttons = card.querySelectorAll('.option-btn');
            
            // Prevent re-clicking
            if (card.classList.contains('answered')) return;
            card.classList.add('answered');
            answeredCount++;

            // Disable all buttons
            buttons.forEach(btn => btn.classList.add('disabled'));

            const expBox = document.getElementById(`exp-${qIndex}`);
            
            if (selectedIndex === correctIndex) {
                // CORRECT
                btnElement.classList.add('correct');
                playSound('correct');
                score++;
                document.getElementById('current-score').innerText = score;
                
                // Confetti Effect
                confetti({
                    particleCount: 100,
                    spread: 70,
                    origin: { y: 0.6 },
                    colors: ['#00D26A', '#8854C0', '#F1C40F']
                });
            } else {
                // WRONG
                btnElement.classList.add('wrong');
                buttons[correctIndex].classList.add('correct'); // Show correct one
                playSound('wrong');
            }

            // Show Explanation immediately
            expBox.style.display = 'block';
        }

        // FINISH QUIZ
        function finishQuiz() {
            const modal = document.getElementById('resultModal');
            const finalScore = document.getElementById('final-score');
            const feedback = document.getElementById('feedback-text');
            
            finalScore.innerText = `${score}/20`;
            
            const percentage = (score / 20) * 100;
            if (percentage === 100) feedback.innerText = "Tuy·ªát ƒë·ªëi! Em l√† thi√™n t√†i ng√¥n ng·ªØ! üåü";
            else if (percentage >= 80) feedback.innerText = "Gi·ªèi l·∫Øm! Ch·ªâ c√≤n m·ªôt ch√∫t n·ªØa th√¥i! üî•";
            else if (percentage >= 50) feedback.innerText = "Kh√° t·ªët, nh∆∞ng c·∫ßn √¥n th√™m t·ª´ v·ª±ng nh√©! üí™";
            else feedback.innerText = "ƒê·ª´ng bu·ªìn, h√£y xem k·ªπ l·∫°i ph·∫ßn gi·∫£i th√≠ch nh√©! üìö";
            
            modal.style.display = 'flex';
            
            if (percentage >= 50) {
                confetti({
                    particleCount: 200,
                    spread: 100,
                    origin: { y: 0.6 }
                });
            }
        }

        function closeModal() {
            document.getElementById('resultModal').style.display = 'none';
        }

        // Initialize
        renderQuiz();

    </script>
</body>
</html>
