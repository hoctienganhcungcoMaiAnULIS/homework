<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Baking and Me - Ms Mai An ULIS</title>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Nunito:wght@400;600;700;800&family=Quicksand:wght@500;700&display=swap" rel="stylesheet">
    <style>
        :root {
            --primary-pink: #FF8FAB; /* Hotter pink for baking theme */
            --primary-teal: #00C9A7;
            --correct-green: #00D26A;
            --wrong-red: #FF4757;
            --bg-pastel: #FFF0F5; /* Lavender Blush */
            --card-bg: #ffffff;
            --text-color: #4a4a4a;
        }

        * {
            box-sizing: border-box;
            scrollbar-width: thin;
            scrollbar-color: var(--primary-pink) #f0f0f0;
        }

        body {
            font-family: 'Nunito', sans-serif;
            background-color: var(--bg-pastel);
            /* Cute background with Cupcakes and Bread */
            background-image: 
                radial-gradient(circle at 10% 20%, rgba(255, 183, 178, 0.4) 0%, transparent 20%),
                radial-gradient(circle at 90% 80%, rgba(166, 228, 208, 0.4) 0%, transparent 20%),
                url('data:image/svg+xml;utf8,<svg width="100" height="100" viewBox="0 0 100 100" xmlns="http://www.w3.org/2000/svg"><text x="10" y="30" font-size="20">üßÅ</text><text x="60" y="80" font-size="20">üçû</text></svg>');
            margin: 0;
            padding: 0;
            height: 100vh;
            display: flex;
            flex-direction: column;
            overflow: hidden;
            color: var(--text-color);
        }

        /* --- Header & Timer --- */
        header {
            background: rgba(255, 255, 255, 0.95);
            padding: 10px 20px;
            display: flex;
            justify-content: space-between;
            align-items: center;
            box-shadow: 0 4px 15px rgba(0,0,0,0.05);
            z-index: 100;
            border-bottom: 3px solid var(--primary-pink);
        }

        .teacher-name {
            font-size: 0.9rem;
            color: var(--primary-pink);
            font-weight: 700;
            font-family: 'Quicksand', sans-serif;
        }

        .timer-container {
            position: absolute;
            left: 50%;
            transform: translateX(-50%);
            display: flex;
            align-items: center;
            gap: 10px;
        }

        #timer-display {
            font-size: 1.5rem;
            font-weight: 800;
            color: var(--primary-pink);
            background: #fff;
            padding: 5px 15px;
            border-radius: 20px;
            box-shadow: 0 4px 0 #e0e0e0;
            border: 2px solid var(--primary-pink);
        }

        .timer-btn {
            background: var(--primary-teal);
            border: none;
            color: white;
            padding: 5px 15px;
            border-radius: 15px;
            cursor: pointer;
            font-weight: bold;
            box-shadow: 0 3px 0 #009e82;
            transition: transform 0.1s;
        }

        .timer-btn:active {
            transform: translateY(3px);
            box-shadow: none;
        }

        /* --- Main Layout --- */
        .main-container {
            display: flex;
            flex: 1;
            height: calc(100vh - 70px);
        }

        .split-pane {
            flex: 1;
            padding: 20px;
            overflow-y: auto;
            position: relative;
        }

        .split-pane.left {
            border-right: 2px dashed var(--primary-pink);
            background: rgba(255, 255, 255, 0.6);
        }

        .split-pane.right {
            background: rgba(255, 255, 255, 0.3);
        }

        h2, h3 {
            font-family: 'Quicksand', sans-serif;
            color: var(--primary-pink);
        }

        /* --- Reading Passage Styling --- */
        .passage-title {
            font-size: 1.8rem;
            text-align: center;
            margin-bottom: 20px;
            text-transform: uppercase;
            text-shadow: 2px 2px 0px #fff;
        }

        .paragraph {
            background: #fff;
            padding: 15px;
            margin-bottom: 15px;
            border-radius: 15px;
            box-shadow: 0 4px 10px rgba(0,0,0,0.05);
            line-height: 1.6;
            font-size: 1.1rem;
        }

        .gap-marker {
            display: inline-block;
            width: 45px;
            height: 25px;
            background: var(--primary-pink);
            color: white;
            text-align: center;
            border-radius: 5px;
            font-weight: bold;
            margin: 0 5px;
            line-height: 25px;
        }

        .trans-btn {
            display: block;
            margin-top: 10px;
            font-size: 0.8rem;
            color: var(--primary-teal);
            background: none;
            border: 2px solid var(--primary-teal);
            border-radius: 20px;
            padding: 5px 15px;
            cursor: pointer;
            font-weight: 700;
            transition: all 0.2s;
        }

        .trans-btn:hover {
            background: var(--primary-teal);
            color: white;
        }

        .translation-text {
            display: none;
            margin-top: 10px;
            padding-top: 10px;
            border-top: 1px dotted #ccc;
            color: #666;
            font-style: italic;
            font-size: 1rem;
        }

        .glossary-box {
            background: #eefcf9;
            border: 2px solid var(--primary-teal);
            border-radius: 15px;
            padding: 15px;
            margin-top: 30px;
        }

        .glossary-title {
            text-align: center;
            color: var(--primary-teal);
            margin-top: 0;
        }

        .glossary-table {
            width: 100%;
            border-collapse: collapse;
        }

        .glossary-table th, .glossary-table td {
            text-align: left;
            padding: 8px;
            border-bottom: 1px solid rgba(0, 201, 167, 0.2);
        }

        /* --- Question Styling --- */
        .question-card {
            background: #fff;
            border-radius: 20px;
            padding: 20px;
            margin-bottom: 30px;
            box-shadow: 0 8px 0 rgba(0,0,0,0.05);
            border: 1px solid #eee;
        }

        .question-header {
            font-weight: 800;
            color: var(--primary-pink);
            font-size: 1.2rem;
            margin-bottom: 15px;
            display: flex;
            align-items: center;
        }

        .question-header::before {
            content: '‚ùì';
            margin-right: 10px;
        }

        .options-grid {
            display: grid;
            gap: 10px;
        }

        .option-btn {
            background: #fff;
            border: 2px solid #e0e0e0;
            padding: 15px;
            border-radius: 15px;
            text-align: left;
            font-family: 'Nunito', sans-serif;
            font-size: 1rem;
            cursor: pointer;
            transition: all 0.2s;
            position: relative;
            box-shadow: 0 4px 0 #e0e0e0;
        }

        .option-btn:hover:not(.disabled) {
            transform: scale(1.02);
            border-color: var(--primary-pink);
        }

        .option-btn:active:not(.disabled) {
            transform: translateY(4px);
            box-shadow: none;
        }

        .option-btn.correct {
            background: var(--correct-green);
            color: white;
            border-color: #00a855;
            box-shadow: 0 4px 0 #00a855;
        }

        .option-btn.wrong {
            background: var(--wrong-red);
            color: white;
            border-color: #d6303e;
            box-shadow: 0 4px 0 #d6303e;
            animation: shake 0.5s;
        }

        .option-btn.disabled {
            cursor: default;
            opacity: 0.7;
        }

        .feedback-panel {
            display: none;
            margin-top: 15px;
            background: #f8f0ff;
            border-radius: 15px;
            padding: 15px;
            border: 2px dashed var(--primary-pink);
            animation: slideDown 0.3s ease-out;
        }

        .feedback-tabs {
            display: flex;
            gap: 5px;
            margin-bottom: 10px;
        }

        .fb-tab {
            font-size: 0.8rem;
            padding: 5px 10px;
            background: #eee;
            border-radius: 10px;
            cursor: pointer;
            font-weight: bold;
        }

        .fb-tab.active {
            background: var(--primary-pink);
            color: white;
        }

        .fb-content {
            font-size: 0.95rem;
            line-height: 1.5;
        }

        .teacher-avatar {
            width: 40px;
            height: 40px;
            border-radius: 50%;
            border: 2px solid var(--primary-pink);
            vertical-align: middle;
            margin-right: 10px;
            background-color: #fff;
            display: inline-flex;
            align-items: center;
            justify-content: center;
            font-size: 20px;
        }

        /* Submit Button */
        .submit-section {
            text-align: center;
            margin: 40px 0;
        }

        .submit-btn {
            background: linear-gradient(45deg, var(--primary-pink), #a26bdb);
            color: white;
            font-size: 1.5rem;
            padding: 15px 50px;
            border: none;
            border-radius: 50px;
            box-shadow: 0 8px 0 #6a3da1, 0 15px 20px rgba(136, 84, 192, 0.4);
            cursor: pointer;
            font-family: 'Quicksand', sans-serif;
            font-weight: 800;
            transition: transform 0.2s;
        }

        .submit-btn:hover {
            transform: scale(1.05) translateY(-5px);
        }

        /* Modal Result */
        .modal-overlay {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0,0,0,0.7);
            display: none;
            justify-content: center;
            align-items: center;
            z-index: 1000;
        }

        .modal-content {
            background: white;
            padding: 40px;
            border-radius: 30px;
            text-align: center;
            max-width: 500px;
            width: 90%;
            position: relative;
            box-shadow: 0 20px 50px rgba(0,0,0,0.3);
            border: 5px solid var(--primary-teal);
        }

        .score-circle {
            width: 150px;
            height: 150px;
            background: var(--primary-teal);
            color: white;
            border-radius: 50%;
            display: flex;
            justify-content: center;
            align-items: center;
            font-size: 3rem;
            font-weight: bold;
            margin: 0 auto 20px;
            box-shadow: 0 10px 0 #009e82;
        }

        @keyframes shake {
            0% { transform: translateX(0); }
            25% { transform: translateX(-5px) rotate(-2deg); }
            50% { transform: translateX(5px) rotate(2deg); }
            75% { transform: translateX(-5px) rotate(-2deg); }
            100% { transform: translateX(0); }
        }

        @keyframes slideDown {
            from { opacity: 0; transform: translateY(-10px); }
            to { opacity: 1; transform: translateY(0); }
        }

        @media (max-width: 768px) {
            .main-container { flex-direction: column; height: auto; }
            .split-pane { width: 100%; height: auto; max-height: 50vh; }
            .timer-container { position: relative; left: 0; transform: none; }
            header { flex-direction: column; gap: 10px; }
        }
    </style>
</head>
<body>

    <canvas id="confetti" style="position:fixed; top:0; left:0; width:100%; height:100%; pointer-events:none; z-index:9999;"></canvas>

    <header>
        <div class="teacher-name">Gi√°o vi√™n t·∫°o: Ms Mai An ULIS üë©‚Äçüè´</div>
        <div class="timer-container">
            <button class="timer-btn" id="start-btn" onclick="toggleTimer()">B·∫ÆT ƒê·∫¶U</button>
            <div id="timer-display">10:00</div>
        </div>
        <div></div>
    </header>

    <div class="main-container">
        <div class="split-pane left">
            <h2 class="passage-title">üç∞ Baking and Me ü•ê</h2>
            <p><strong>Five sentences have been removed from the text below. For each question, choose the correct answer. There are three extra sentences which you do not need to use.</strong></p>

            <div class="paragraph">
                I‚Äôve always been keen on cooking and you‚Äôd often find me in the kitchen preparing the evening meal. <span class="gap-marker">(1)</span> ......... It started because of my young children, who were always ready to bake and loved the chance to make cakes at the weekend. I never realised at the time how important it would become in my life. What started as a way of entertaining the kids became a passion for me and one that I love to pass on to others. <span class="gap-marker">(2)</span> .........
                <button class="trans-btn" onclick="toggleTrans(this)">B·∫¢N D·ªäCH ƒê·∫¶Y ƒê·ª¶</button>
                <div class="translation-text">T√¥i lu√¥n y√™u th√≠ch n·∫•u ƒÉn v√† b·∫°n th∆∞·ªùng xuy√™n th·∫•y t√¥i ·ªü trong b·∫øp chu·∫©n b·ªã b·ªØa t·ªëi. (1)......... N√≥ b·∫Øt ƒë·∫ßu v√¨ c√°c con nh·ªè c·ªßa t√¥i, ch√∫ng lu√¥n s·∫µn s√†ng n∆∞·ªõng b√°nh v√† y√™u th√≠ch c∆° h·ªôi l√†m b√°nh v√†o cu·ªëi tu·∫ßn. L√∫c ƒë√≥ t√¥i ch∆∞a bao gi·ªù nh·∫≠n ra n√≥ s·∫Ω tr·ªü n√™n quan tr·ªçng th·∫ø n√†o trong cu·ªôc ƒë·ªùi m√¨nh. Nh·ªØng g√¨ b·∫Øt ƒë·∫ßu nh∆∞ m·ªôt c√°ch ƒë·ªÉ gi·∫£i tr√≠ cho b·ªçn tr·∫ª ƒë√£ tr·ªü th√†nh ni·ªÅm ƒëam m√™ c·ªßa t√¥i v√† l√† ƒëi·ªÅu t√¥i th√≠ch truy·ªÅn l·∫°i cho ng∆∞·ªùi kh√°c. (2).........</div>
            </div>

            <div class="paragraph">
                To begin with there‚Äôs the preparation. Unlike normal cooking, baking requires a great deal of care. <span class="gap-marker">(3)</span> ......... Cooking a spaghetti or a curry does not require the same degree of attention. I find this interesting as being careful like this is not something that I have ever been strong at. Baking gives me the opportunity to challenge myself to get things right.
                <button class="trans-btn" onclick="toggleTrans(this)">B·∫¢N D·ªäCH ƒê·∫¶Y ƒê·ª¶</button>
                <div class="translation-text">ƒê·∫ßu ti√™n l√† kh√¢u chu·∫©n b·ªã. Kh√¥ng gi·ªëng nh∆∞ n·∫•u ƒÉn th√¥ng th∆∞·ªùng, l√†m b√°nh ƒë√≤i h·ªèi s·ª± c·∫©n th·∫≠n r·∫•t l·ªõn. (3)......... N·∫•u m√≥n m√¨ √ù hay c√† ri kh√¥ng ƒë√≤i h·ªèi m·ª©c ƒë·ªô ch√∫ √Ω t∆∞∆°ng t·ª±. T√¥i th·∫•y ƒëi·ªÅu n√†y th√∫ v·ªã v√¨ s·ª± c·∫©n th·∫≠n nh∆∞ th·∫ø n√†y kh√¥ng ph·∫£i l√† th·∫ø m·∫°nh c·ªßa t√¥i. L√†m b√°nh cho t√¥i c∆° h·ªôi th·ª≠ th√°ch b·∫£n th√¢n ƒë·ªÉ l√†m m·ªçi th·ª© th·∫≠t chu·∫©n x√°c.</div>
            </div>

            <div class="paragraph">
                Then there‚Äôs baking itself. Whether it‚Äôs a loaf of bread or some of my favourite cakes, for around 30 minutes my attention is on the oven. I love going back into the kitchen every so often to check to see if the cake or loaf is rising as it should do, and my eyes are always on the clock to make sure I don‚Äôt leave it in too long. <span class="gap-marker">(4)</span> ......... This is why people selling a house or flat are often advised to have a loaf baking in the oven when buyers arrive!
                <button class="trans-btn" onclick="toggleTrans(this)">B·∫¢N D·ªäCH ƒê·∫¶Y ƒê·ª¶</button>
                <div class="translation-text">Sau ƒë√≥ l√† c√¥ng ƒëo·∫°n n∆∞·ªõng b√°nh. D√π l√† m·ªôt ·ªï b√°nh m√¨ hay nh·ªØng chi·∫øc b√°nh ng·ªçt y√™u th√≠ch c·ªßa t√¥i, trong kho·∫£ng 30 ph√∫t, s·ª± ch√∫ √Ω c·ªßa t√¥i ƒë·ªÅu d·ªìn v√†o l√≤ n∆∞·ªõng. T√¥i th√≠ch th·ªânh tho·∫£ng quay l·∫°i b·∫øp ƒë·ªÉ ki·ªÉm tra xem b√°nh hay ·ªï b√°nh m√¨ c√≥ n·ªü ƒë√∫ng nh∆∞ mong ƒë·ª£i kh√¥ng, v√† m·∫Øt t√¥i lu√¥n d√°n v√†o ƒë·ªìng h·ªì ƒë·ªÉ ƒë·∫£m b·∫£o kh√¥ng ƒë·ªÉ qu√° l√¢u. (4)......... ƒê√¢y l√† l√Ω do t·∫°i sao nh·ªØng ng∆∞·ªùi b√°n nh√† ho·∫∑c cƒÉn h·ªô th∆∞·ªùng ƒë∆∞·ª£c khuy√™n n√™n n∆∞·ªõng m·ªôt ·ªï b√°nh m√¨ trong l√≤ khi ng∆∞·ªùi mua ƒë·∫øn!</div>
            </div>

            <div class="paragraph">
                And finally, there‚Äôs the chance to eat what you‚Äôve made. <span class="gap-marker">(5)</span> ......... But cutting a slice and discovering it‚Äôs just right inside as well is always extremely pleasing. After testing to see if it‚Äôs OK, I love calling the family out to the kitchen to invite them all to try a piece. So yes, it‚Äôs a hobby I think will stay with me for life, despite the fact that it might mean I put on weight!
                <button class="trans-btn" onclick="toggleTrans(this)">B·∫¢N D·ªäCH ƒê·∫¶Y ƒê·ª¶</button>
                <div class="translation-text">V√† cu·ªëi c√πng, l√† c∆° h·ªôi ƒë·ªÉ th∆∞·ªüng th·ª©c nh·ªØng g√¨ b·∫°n ƒë√£ l√†m. (5)......... Nh∆∞ng khi c·∫Øt m·ªôt l√°t b√°nh v√† ph√°t hi·ªán ra b√™n trong c≈©ng v·ª´a ch√≠n t·ªõi th·∫≠t l√† v√¥ c√πng h√†i l√≤ng. Sau khi ki·ªÉm tra xem b√°nh c√≥ ·ªïn kh√¥ng, t√¥i th√≠ch g·ªçi c·∫£ nh√† ra b·∫øp ƒë·ªÉ m·ªùi m·ªçi ng∆∞·ªùi n·∫øm th·ª≠ m·ªôt mi·∫øng. V√¨ v·∫≠y, v√¢ng, ƒë√≥ l√† m·ªôt s·ªü th√≠ch m√† t√¥i nghƒ© s·∫Ω g·∫Øn b√≥ v·ªõi t√¥i su·ªët ƒë·ªùi, m·∫∑c d√π ƒëi·ªÅu ƒë√≥ c√≥ th·ªÉ ƒë·ªìng nghƒ©a v·ªõi vi·ªác t√¥i s·∫Ω tƒÉng c√¢n!</div>
            </div>

            <div class="glossary-box">
                <h3 class="glossary-title">üìö Glossary - T·ª´ V·ª±ng Hay</h3>
                <table class="glossary-table">
                    <tr><th>Word</th><th>Type</th><th>Meaning</th></tr>
                    <tr><td>Keen on</td><td>(phr)</td><td>Y√™u th√≠ch, say m√™</td></tr>
                    <tr><td>Passion</td><td>(n)</td><td>Ni·ªÅm ƒëam m√™</td></tr>
                    <tr><td>Preparation</td><td>(n)</td><td>S·ª± chu·∫©n b·ªã</td></tr>
                    <tr><td>Require</td><td>(v)</td><td>Y√™u c·∫ßu, ƒë√≤i h·ªèi</td></tr>
                    <tr><td>Ingredient</td><td>(n)</td><td>Nguy√™n li·ªáu</td></tr>
                    <tr><td>Attention</td><td>(n)</td><td>S·ª± ch√∫ √Ω</td></tr>
                    <tr><td>Challenge</td><td>(v/n)</td><td>Th·ª≠ th√°ch</td></tr>
                    <tr><td>Advise</td><td>(v)</td><td>Khuy√™n b·∫£o</td></tr>
                    <tr><td>Pleasing</td><td>(adj)</td><td>L√†m h√†i l√≤ng, d·ªÖ ch·ªãu</td></tr>
                    <tr><td>Extreme</td><td>(adj)</td><td>C·ª±c k·ª≥, v√¥ c√πng</td></tr>
                </table>
            </div>
            <br><br><br>
        </div>

        <div class="split-pane right">
            <h2 style="text-align:center;">üß© Exercises</h2>
            
            <div id="quiz-container">
                </div>

            <div class="submit-section">
                <button class="submit-btn" onclick="showResults()">N·ªòP B√ÄI üìù</button>
            </div>
        </div>
    </div>

    <div class="modal-overlay" id="result-modal">
        <div class="modal-content">
            <h2>K·∫æT QU·∫¢ C·ª¶A B·∫†N</h2>
            <div class="score-circle" id="final-score">0/5</div>
            <p id="feedback-msg" style="font-size: 1.2rem; margin-bottom: 20px;">...</p>
            <button class="timer-btn" onclick="closeModal()">Xem l·∫°i b√†i</button>
        </div>
    </div>

<script>
    // --- DATA ---
    const optionsListGlobal = [
        {id: "A", text: "The smell of freshly baked bread makes a house feel like home."},
        {id: "B", text: "On one occasion, my baking was not successful."},
        {id: "C", text: "So, what is it that makes baking such an enjoyable experience?"},
        {id: "D", text: "The cake or loaf might look perfectly cooked from outside."},
        {id: "E", text: "However, the children always agreed to clear up the mess in the kitchen."},
        {id: "F", text: "But my love of baking only began a few years ago."},
        {id: "G", text: "Most of these problems have been due to the oven."},
        {id: "H", text: "Ingredients need to be measured out exactly."}
    ];

    const questions = [
        {
            id: 1,
            correct: "F",
            options: "SAME",
            explanation: "<b>D·∫´n ch·ª©ng:</b> C√¢u tr∆∞·ªõc: 'always been keen on cooking' (lu√¥n th√≠ch n·∫•u ƒÉn). C√¢u sau: 'It started because of my young children...' (N√≥ b·∫Øt ƒë·∫ßu v√¨ c√°c con...).<br><b>Gi·∫£i th√≠ch:</b> C√¢u F ('Nh∆∞ng t√¨nh y√™u l√†m b√°nh c·ªßa t√¥i ch·ªâ m·ªõi b·∫Øt ƒë·∫ßu v√†i nƒÉm tr∆∞·ªõc') t·∫°o ra s·ª± t∆∞∆°ng ph·∫£n h·ª£p l√Ω gi·ªØa vi·ªác th√≠ch n·∫•u ƒÉn n√≥i chung (t·ª´ l√¢u) v√† vi·ªác l√†m b√°nh (m·ªõi g·∫ßn ƒë√¢y).",
            translateQ: "Ch·ªçn c√¢u ƒëi·ªÅn v√†o ch·ªó tr·ªëng (1).",
            translateA: "ƒê√°p √°n F: Nh∆∞ng t√¨nh y√™u l√†m b√°nh c·ªßa t√¥i ch·ªâ m·ªõi b·∫Øt ƒë·∫ßu v√†i nƒÉm tr∆∞·ªõc."
        },
        {
            id: 2,
            correct: "C",
            options: "SAME",
            explanation: "<b>D·∫´n ch·ª©ng:</b> ƒêo·∫°n vƒÉn sau ƒë√≥ li·ªát k√™ c√°c l√Ω do: 'To begin with...' (ƒê·∫ßu ti√™n l√†...), 'Then there's baking itself...' (Sau ƒë√≥ l√†...), 'And finally...' (V√† cu·ªëi c√πng...).<br><b>Gi·∫£i th√≠ch:</b> C√¢u C ('V·∫≠y, ƒëi·ªÅu g√¨ l√†m cho vi·ªác l√†m b√°nh tr·ªü th√†nh m·ªôt tr·∫£i nghi·ªám th√∫ v·ªã nh∆∞ v·∫≠y?') l√† c√¢u h·ªèi d·∫´n d·∫Øt ho√†n h·∫£o ƒë·ªÉ m·ªü ƒë·∫ßu cho c√°c ƒëo·∫°n vƒÉn li·ªát k√™ l√Ω do ph√≠a sau.",
            translateA: "ƒê√°p √°n C: V·∫≠y, ƒëi·ªÅu g√¨ l√†m cho vi·ªác l√†m b√°nh tr·ªü th√†nh m·ªôt tr·∫£i nghi·ªám th√∫ v·ªã nh∆∞ v·∫≠y?"
        },
        {
            id: 3,
            correct: "H",
            options: "SAME",
            explanation: "<b>D·∫´n ch·ª©ng:</b> C√¢u tr∆∞·ªõc: 'baking requires a great deal of care' (ƒë√≤i h·ªèi s·ª± c·∫©n th·∫≠n l·ªõn). C√¢u sau so s√°nh v·ªõi n·∫•u m√¨ √ù kh√¥ng c·∫ßn ch√∫ √Ω nhi·ªÅu nh∆∞ v·∫≠y.<br><b>Gi·∫£i th√≠ch:</b> C√¢u H ('C√°c nguy√™n li·ªáu c·∫ßn ƒë∆∞·ª£c c√¢n ƒëo ch√≠nh x√°c') l√† v√≠ d·ª• c·ª• th·ªÉ cho s·ª± 'c·∫©n th·∫≠n' (care) ƒë∆∞·ª£c nh·∫Øc ƒë·∫øn ·ªü c√¢u tr∆∞·ªõc.",
            translateA: "ƒê√°p √°n H: C√°c nguy√™n li·ªáu c·∫ßn ƒë∆∞·ª£c c√¢n ƒëo ch√≠nh x√°c."
        },
        {
            id: 4,
            correct: "A",
            options: "SAME",
            explanation: "<b>D·∫´n ch·ª©ng:</b> ƒêo·∫°n vƒÉn n√≥i v·ªÅ qu√° tr√¨nh n∆∞·ªõng trong l√≤. C√¢u sau: 'This is why people selling a house... advised to have a loaf baking...' (ƒê√≥ l√† l√Ω do ng∆∞·ªùi b√°n nh√† ƒë∆∞·ª£c khuy√™n n√™n n∆∞·ªõng b√°nh...).<br><b>Gi·∫£i th√≠ch:</b> C√¢u A ('M√πi b√°nh m√¨ m·ªõi n∆∞·ªõng l√†m cho ng√¥i nh√† c√≥ c·∫£m gi√°c nh∆∞ t·ªï ·∫•m') gi·∫£i th√≠ch l√Ω do t·∫°i sao m√πi th∆°m l·∫°i quan tr·ªçng v√† li√™n k·∫øt v·ªõi vi·ªác b√°n nh√† ·ªü c√¢u sau.",
            translateA: "ƒê√°p √°n A: M√πi b√°nh m√¨ m·ªõi n∆∞·ªõng l√†m cho ng√¥i nh√† c√≥ c·∫£m gi√°c nh∆∞ t·ªï ·∫•m."
        },
        {
            id: 5,
            correct: "D",
            options: "SAME",
            explanation: "<b>D·∫´n ch·ª©ng:</b> C√¢u sau b·∫Øt ƒë·∫ßu b·∫±ng 'But' (Nh∆∞ng) v√† n√≥i v·ªÅ vi·ªác 'cutting a slice and discovering it's just right inside' (c·∫Øt ra v√† th·∫•y b√™n trong ch√≠n t·ªõi).<br><b>Gi·∫£i th√≠ch:</b> C√¢u D ('Chi·∫øc b√°nh c√≥ th·ªÉ tr√¥ng ch√≠n ho√†n h·∫£o t·ª´ b√™n ngo√†i') t·∫°o ra s·ª± ƒë·ªëi l·∫≠p (Ngo√†i ƒë·∫πp NH∆ØNG trong ch∆∞a ch·∫Øc ƒë√£ ch√≠n). C√¢u sau gi·∫£i quy·∫øt s·ª± lo l·∫Øng n√†y.",
            translateA: "ƒê√°p √°n D: Chi·∫øc b√°nh ho·∫∑c ·ªï b√°nh m√¨ c√≥ th·ªÉ tr√¥ng ch√≠n ho√†n h·∫£o t·ª´ b√™n ngo√†i."
        }
    ];

    // --- SOUND ENGINE ---
    const audioCtx = new (window.AudioContext || window.webkitAudioContext)();
    function playSound(type) {
        if (audioCtx.state === 'suspended') audioCtx.resume();
        const osc = audioCtx.createOscillator();
        const gainNode = audioCtx.createGain();
        osc.connect(gainNode);
        gainNode.connect(audioCtx.destination);
        if (type === 'correct') {
            osc.type = 'sine';
            osc.frequency.setValueAtTime(800, audioCtx.currentTime);
            osc.frequency.exponentialRampToValueAtTime(1200, audioCtx.currentTime + 0.1);
            gainNode.gain.setValueAtTime(0.3, audioCtx.currentTime);
            gainNode.gain.exponentialRampToValueAtTime(0.01, audioCtx.currentTime + 0.5);
            osc.start(); osc.stop(audioCtx.currentTime + 0.5);
        } else {
            osc.type = 'sawtooth';
            osc.frequency.setValueAtTime(150, audioCtx.currentTime);
            osc.frequency.linearRampToValueAtTime(100, audioCtx.currentTime + 0.3);
            gainNode.gain.setValueAtTime(0.3, audioCtx.currentTime);
            gainNode.gain.exponentialRampToValueAtTime(0.01, audioCtx.currentTime + 0.3);
            osc.start(); osc.stop(audioCtx.currentTime + 0.3);
        }
    }

    // --- CONFETTI ENGINE ---
    const canvas = document.getElementById('confetti');
    const ctx = canvas.getContext('2d');
    canvas.width = window.innerWidth;
    canvas.height = window.innerHeight;
    let particles = [];
    function fireConfetti() {
        for(let i=0; i<100; i++) {
            particles.push({
                x: window.innerWidth / 2, y: window.innerHeight / 2,
                vx: (Math.random() - 0.5) * 20, vy: (Math.random() - 0.5) * 20,
                color: `hsl(${Math.random()*360}, 100%, 50%)`, life: 100
            });
        }
        animateConfetti();
    }
    function animateConfetti() {
        if(particles.length === 0) return;
        ctx.clearRect(0,0, canvas.width, canvas.height);
        for(let i=0; i<particles.length; i++) {
            let p = particles[i];
            p.x += p.vx; p.y += p.vy; p.vy += 0.5; p.life--;
            ctx.fillStyle = p.color; ctx.fillRect(p.x, p.y, 8, 8);
        }
        particles = particles.filter(p => p.life > 0);
        if(particles.length > 0) requestAnimationFrame(animateConfetti);
        else ctx.clearRect(0,0, canvas.width, canvas.height);
    }

    // --- APP LOGIC ---
    let timeLeft = 600;
    let timerInterval;
    let isTimerRunning = false;
    let userScore = 0;

    function init() {
        const container = document.getElementById('quiz-container');
        questions.forEach((q, index) => {
            const options = (q.options === "SAME") ? optionsListGlobal : q.options;
            let html = `
                <div class="question-card" id="q-card-${index}">
                    <div class="question-header">C√¢u h·ªèi ${index + 1}: ƒêi·ªÅn v√†o ch·ªó tr·ªëng (${index + 1})</div>
                    <div class="options-grid">
                        ${options.map(opt => `
                            <button class="option-btn" onclick="checkAnswer(${index}, '${opt.id}', this)">
                                <b>${opt.id}.</b> ${opt.text}
                            </button>
                        `).join('')}
                    </div>
                    <div class="feedback-panel" id="feedback-${index}">
                        <div class="feedback-tabs">
                            <div class="fb-tab active" onclick="switchTab(${index}, 'explain')">Gi·∫£i th√≠ch</div>
                            <div class="fb-tab" onclick="switchTab(${index}, 'trans')">D·ªãch</div>
                        </div>
                        <div class="fb-content" id="fb-content-${index}"></div>
                    </div>
                </div>
            `;
            container.innerHTML += html;
        });
    }

    function toggleTimer() {
        const btn = document.getElementById('start-btn');
        if (isTimerRunning) {
            clearInterval(timerInterval);
            btn.textContent = "TI·∫æP T·ª§C ‚ñ∂Ô∏è";
            btn.style.background = "#FFC107";
        } else {
            timerInterval = setInterval(updateTimer, 1000);
            btn.textContent = "T·∫†M D·ª™NG ‚è∏Ô∏è";
            btn.style.background = "#FF4757";
        }
        isTimerRunning = !isTimerRunning;
    }

    function updateTimer() {
        if (timeLeft <= 0) {
            clearInterval(timerInterval);
            alert("‚è∞ ƒê√£ h·∫øt gi·ªù l√†m b√†i! B·∫°n v·∫´n c√≥ th·ªÉ ti·∫øp t·ª•c l√†m.");
            return;
        }
        timeLeft--;
        const m = Math.floor(timeLeft / 60).toString().padStart(2, '0');
        const s = (timeLeft % 60).toString().padStart(2, '0');
        document.getElementById('timer-display').innerText = `${m}:${s}`;
    }

    function checkAnswer(qIndex, selectedId, btnElement) {
        const card = document.getElementById(`q-card-${qIndex}`);
        if (card.classList.contains('answered')) return;
        card.classList.add('answered');

        const q = questions[qIndex];
        const allBtns = card.querySelectorAll('.option-btn');
        allBtns.forEach(b => b.classList.add('disabled'));

        card.dataset.explanation = `<span class="teacher-avatar">üë©‚Äçüè´</span> ${q.explanation}`;
        card.dataset.translation = `<b>C√¢u h·ªèi:</b> ${q.translateQ} <br><br> <b>ƒê√°p √°n:</b> ${q.translateA}`;

        if (selectedId === q.correct) {
            btnElement.classList.add('correct');
            playSound('correct');
            fireConfetti();
            userScore++;
        } else {
            btnElement.classList.add('wrong');
            playSound('wrong');
            allBtns.forEach(b => {
                if(b.innerText.startsWith(q.correct + ".")) b.classList.add('correct');
            });
        }
        
        document.getElementById(`feedback-${qIndex}`).style.display = 'block';
        switchTab(qIndex, 'explain');
    }

    function switchTab(qIndex, type) {
        const card = document.getElementById(`q-card-${qIndex}`);
        const contentDiv = document.getElementById(`fb-content-${qIndex}`);
        const tabs = document.querySelectorAll(`#feedback-${qIndex} .fb-tab`);
        tabs.forEach(t => t.classList.remove('active'));
        if(type === 'explain') {
            tabs[0].classList.add('active');
            contentDiv.innerHTML = card.dataset.explanation;
        } else {
            tabs[1].classList.add('active');
            contentDiv.innerHTML = card.dataset.translation;
        }
    }

    function toggleTrans(btn) {
        const text = btn.nextElementSibling;
        if (text.style.display === "block") {
            text.style.display = "none";
            btn.textContent = "B·∫¢N D·ªäCH ƒê·∫¶Y ƒê·ª¶";
        } else {
            text.style.display = "block";
            btn.textContent = "·∫®N B·∫¢N D·ªäCH";
        }
    }

    function showResults() {
        const modal = document.getElementById('result-modal');
        const scoreDiv = document.getElementById('final-score');
        const feedbackMsg = document.getElementById('feedback-msg');
        scoreDiv.innerText = `${userScore}/5`;
        if (userScore === 5) feedbackMsg.innerText = "üåü XU·∫§T S·∫ÆC! Em l√† ƒë·∫ßu b·∫øp ti·∫øng Anh t√†i ba!";
        else if (userScore >= 3) feedbackMsg.innerText = "üëè L√ÄM T·ªêT L·∫ÆM! C·ªë g·∫Øng ch√∫t n·ªØa l√† ho√†n h·∫£o!";
        else feedbackMsg.innerText = "üí™ C·ªê L√äN NH√â! L√†m b√°nh c·∫ßn ki√™n nh·∫´n, h·ªçc ti·∫øng Anh c≈©ng v·∫≠y!";
        modal.style.display = 'flex';
        playSound('correct');
        fireConfetti();
    }

    function closeModal() {
        document.getElementById('result-modal').style.display = 'none';
    }

    init();
</script>
</body>
</html>