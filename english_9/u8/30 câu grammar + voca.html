<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Exercise 3: Travel Vocabulary Quiz - Ms Mai An ULIS</title>
    <!-- Google Fonts: Quicksand cho cảm giác thân thiện -->
    <link href="https://fonts.googleapis.com/css2?family=Quicksand:wght@400;600;700&display=swap" rel="stylesheet">
    <!-- FontAwesome cho icon -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <!-- Confetti Library -->
    <script src="https://cdn.jsdelivr.net/npm/canvas-confetti@1.6.0/dist/confetti.browser.min.js"></script>

    <style>
        :root {
            --primary-color: #8854C0; /* Tím hồng nhạt */
            --secondary-color: #00C9A7; /* Xanh ngọc */
            --correct-color: #00D26A; /* Xanh lá */
            --wrong-color: #FF4757; /* Đỏ cam */
            --bg-color: #f0f3f9;
            --card-bg: #ffffff;
            --text-color: #2c3e50;
        }

        body {
            font-family: 'Quicksand', sans-serif;
            background-color: var(--bg-color);
            background-image: radial-gradient(#8854c0 0.5px, transparent 0.5px), radial-gradient(#8854c0 0.5px, #f0f3f9 0.5px);
            background-size: 20px 20px;
            background-position: 0 0, 10px 10px;
            margin: 0;
            padding: 20px;
            color: var(--text-color);
        }

        .container {
            max-width: 800px;
            margin: 0 auto;
        }

        /* Header Styling */
        header {
            text-align: center;
            margin-bottom: 30px;
            background: white;
            padding: 20px;
            border-radius: 20px;
            box-shadow: 0 8px 0 rgba(0,0,0,0.1);
            border: 3px solid #e0e0e0;
        }

        header h1 {
            color: var(--primary-color);
            margin: 0;
            font-size: 2rem;
            text-transform: uppercase;
            letter-spacing: 1px;
        }

        header h2 {
            color: #555;
            font-size: 1.2rem;
            margin-top: 10px;
            font-weight: 600;
        }

        /* Progress Bar */
        .progress-container {
            width: 100%;
            background-color: #ddd;
            border-radius: 15px;
            margin-bottom: 30px;
            height: 20px;
            overflow: hidden;
            border: 2px solid #ccc;
        }

        .progress-bar {
            width: 0%;
            height: 100%;
            background-color: var(--secondary-color);
            transition: width 0.3s ease;
            border-radius: 15px;
        }

        /* Question Card */
        .quiz-card {
            background: var(--card-bg);
            border-radius: 20px;
            padding: 30px;
            margin-bottom: 30px;
            box-shadow: 0 10px 0 rgba(0,0,0,0.1);
            border: 3px solid #eee;
            position: relative;
            transition: transform 0.3s ease;
            animation: fadeIn 0.5s ease-out;
        }

        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(20px); }
            to { opacity: 1; transform: translateY(0); }
        }

        .question-number {
            display: inline-block;
            background: var(--primary-color);
            color: white;
            padding: 5px 15px;
            border-radius: 20px;
            font-weight: bold;
            margin-bottom: 15px;
            font-size: 0.9rem;
        }

        .question-text {
            font-size: 1.4rem;
            font-weight: 700;
            margin-bottom: 25px;
            line-height: 1.5;
            color: #333;
        }

        .hint-box {
            background-color: #fff3cd;
            color: #856404;
            padding: 10px 15px;
            border-radius: 10px;
            margin-bottom: 20px;
            font-size: 0.95rem;
            border-left: 5px solid #ffc107;
            display: flex;
            align-items: center;
            gap: 10px;
        }

        /* Options Grid */
        .options-grid {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 15px;
        }

        @media (max-width: 600px) {
            .options-grid {
                grid-template-columns: 1fr;
            }
        }

        .option-btn {
            background: white;
            border: 2px solid #e0e0e0;
            border-radius: 15px;
            padding: 15px 20px;
            font-size: 1.1rem;
            font-family: 'Quicksand', sans-serif;
            font-weight: 600;
            color: #555;
            cursor: pointer;
            transition: all 0.2s;
            box-shadow: 0 4px 0 #e0e0e0;
            text-align: left;
            position: relative;
            outline: none;
        }

        .option-btn:hover:not(:disabled) {
            transform: translateY(-2px);
            box-shadow: 0 6px 0 #e0e0e0;
            border-color: var(--secondary-color);
            color: var(--secondary-color);
        }

        .option-btn:active:not(:disabled) {
            transform: translateY(2px);
            box-shadow: 0 2px 0 #e0e0e0;
        }

        /* Correct/Wrong States */
        .option-btn.correct {
            background-color: var(--correct-color);
            color: white;
            border-color: #00b85c;
            box-shadow: 0 4px 0 #00b85c;
        }

        .option-btn.wrong {
            background-color: var(--wrong-color);
            color: white;
            border-color: #e63b49;
            box-shadow: 0 4px 0 #e63b49;
            animation: shake 0.5s;
        }

        .option-btn:disabled {
            cursor: default;
            opacity: 0.8;
        }

        @keyframes shake {
            0% { transform: translateX(0); }
            25% { transform: translateX(-5px) rotate(-2deg); }
            50% { transform: translateX(5px) rotate(2deg); }
            75% { transform: translateX(-5px) rotate(-2deg); }
            100% { transform: translateX(0); }
        }

        /* Explanation Box */
        .explanation-box {
            margin-top: 25px;
            background-color: #e8f0fe;
            border: 2px solid #b3d7ff;
            border-radius: 15px;
            padding: 20px;
            display: none; /* Hidden by default */
            animation: slideDown 0.4s ease-out;
        }

        @keyframes slideDown {
            from { opacity: 0; transform: translateY(-10px); }
            to { opacity: 1; transform: translateY(0); }
        }

        .teacher-badge {
            display: flex;
            align-items: center;
            gap: 10px;
            margin-bottom: 15px;
            color: #0056b3;
            font-weight: bold;
            font-size: 1.1rem;
            border-bottom: 2px solid #b3d7ff;
            padding-bottom: 10px;
        }

        .teacher-badge i {
            font-size: 1.5rem;
        }

        .exp-section {
            margin-bottom: 15px;
        }

        .exp-label {
            font-weight: 800;
            color: var(--primary-color);
            margin-right: 5px;
            display: block;
            margin-bottom: 5px;
        }

        .exp-content {
            line-height: 1.6;
            color: #444;
        }

        .analysis-item {
            margin-bottom: 8px;
            padding-left: 15px;
            border-left: 3px solid #ddd;
        }
        
        .analysis-item.correct-analysis {
            border-left-color: var(--correct-color);
            background-color: rgba(0, 210, 106, 0.1);
            padding: 5px 15px;
            border-radius: 0 5px 5px 0;
        }

        /* Submit/Finish Button */
        .submit-btn {
            display: block;
            width: 100%;
            max-width: 300px;
            margin: 40px auto;
            padding: 15px;
            background-color: var(--primary-color);
            color: white;
            font-size: 1.5rem;
            font-weight: bold;
            border: none;
            border-radius: 50px;
            cursor: pointer;
            box-shadow: 0 6px 0 #6c4299;
            transition: transform 0.2s;
            font-family: 'Quicksand', sans-serif;
        }

        .submit-btn:hover {
            transform: translateY(-3px);
            box-shadow: 0 8px 0 #6c4299;
        }

        .submit-btn:active {
            transform: translateY(2px);
            box-shadow: 0 2px 0 #6c4299;
        }

        /* Modal Score */
        .modal {
            display: none;
            position: fixed;
            z-index: 1000;
            left: 0;
            top: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0,0,0,0.6);
            backdrop-filter: blur(5px);
            justify-content: center;
            align-items: center;
        }

        .modal-content {
            background-color: white;
            padding: 40px;
            border-radius: 30px;
            text-align: center;
            max-width: 500px;
            width: 90%;
            box-shadow: 0 20px 0 rgba(0,0,0,0.2);
            animation: zoomIn 0.5s cubic-bezier(0.175, 0.885, 0.32, 1.275);
        }

        @keyframes zoomIn {
            from { transform: scale(0.5); opacity: 0; }
            to { transform: scale(1); opacity: 1; }
        }

        .score-circle {
            width: 150px;
            height: 150px;
            border-radius: 50%;
            background: var(--secondary-color);
            color: white;
            display: flex;
            justify-content: center;
            align-items: center;
            font-size: 3rem;
            font-weight: bold;
            margin: 0 auto 20px;
            border: 8px solid white;
            box-shadow: 0 0 0 5px var(--secondary-color);
        }

        .feedback-text {
            font-size: 1.5rem;
            color: var(--primary-color);
            margin-bottom: 20px;
            font-weight: bold;
        }

        /* Floating Action Button for Audio */
        .sound-toggle {
            position: fixed;
            bottom: 20px;
            right: 20px;
            background: white;
            padding: 10px;
            border-radius: 50%;
            box-shadow: 0 4px 10px rgba(0,0,0,0.2);
            cursor: pointer;
            z-index: 900;
        }

    </style>
</head>
<body>

    <div class="container">
        <header>
            <h1>Ms Mai An ULIS</h1>
            <h2>Exercise 3: Travel Vocabulary Quiz</h2>
        </header>

        <!-- Progress Bar -->
        <div class="progress-container">
            <div class="progress-bar" id="progressBar"></div>
        </div>

        <!-- Quiz Container -->
        <div id="quiz-container">
            <!-- Questions will be injected here via JS -->
        </div>

        <!-- Submit Button -->
        <button class="submit-btn" id="submitBtn" onclick="finishQuiz()">Nộp Bài & Xem Điểm</button>
    </div>

    <!-- Score Modal -->
    <div id="scoreModal" class="modal">
        <div class="modal-content">
            <div class="score-circle" id="finalScore">0/30</div>
            <div class="feedback-text" id="finalFeedback">Làm tốt lắm!</div>
            <p>Em đã hoàn thành bài kiểm tra từ vựng.</p>
            <button class="submit-btn" style="margin-top: 20px; font-size: 1.2rem;" onclick="location.reload()">Làm lại bài</button>
        </div>
    </div>

    <!-- Audio Elements -->
    <audio id="sound-correct" src="https://assets.mixkit.co/active_storage/sfx/2000/2000-preview.mp3"></audio>
    <audio id="sound-wrong" src="https://assets.mixkit.co/active_storage/sfx/2955/2955-preview.mp3"></audio>
    <audio id="sound-finish" src="https://assets.mixkit.co/active_storage/sfx/1435/1435-preview.mp3"></audio>

    <script>
        // --- DATA SOURCE ---
        const quizData = {
          "questions": [
            {
              "questionNumber": 1,
              "question": "The travel _______ helped us book our flight tickets and hotel rooms for the trip to Singapore.",
              "hint": "Cơ quan/nơi nào chuyên lo việc đặt vé và phòng cho khách du lịch?",
              "answerOptions": [
                { "text": "market", "rationale": "Sai. **market** (n): chợ/thị trường. Không hợp nghĩa.", "isCorrect": false },
                { "text": "agency", "rationale": "Chính xác! **agency** (n): đại lý/cơ quan. \n**Giải thích:** Cụm từ 'Travel agency' nghĩa là 'Đại lý du lịch'.\n**Dịch câu:** Đại lý du lịch đã giúp chúng tôi đặt vé máy bay và phòng khách sạn cho chuyến đi đến Singapore.", "isCorrect": true },
                { "text": "library", "rationale": "Sai. **library** (n): thư viện.", "isCorrect": false },
                { "text": "hospital", "rationale": "Sai. **hospital** (n): bệnh viện.", "isCorrect": false }
              ]
            },
            {
              "questionNumber": 2,
              "question": "We stayed at a _______ in the countryside where the local family was very friendly and helpful.",
              "hint": "Loại hình lưu trú nào mà bạn sống cùng với gia đình người địa phương?",
              "answerOptions": [
                { "text": "factory", "rationale": "Sai. **factory** (n): nhà máy.", "isCorrect": false },
                { "text": "stadium", "rationale": "Sai. **stadium** (n): sân vận động.", "isCorrect": false },
                { "text": "cinema", "rationale": "Sai. **cinema** (n): rạp chiếu phim.", "isCorrect": false },
                { "text": "homestay", "rationale": "Chính xác! **homestay** (n): dịch vụ ở tại nhà dân.\n**Giải thích:** Ngữ cảnh 'local family' (gia đình địa phương) ám chỉ loại hình homestay.\n**Dịch câu:** Chúng tôi đã ở tại một homestay ở vùng nông thôn nơi gia đình chủ nhà rất thân thiện và hay giúp đỡ.", "isCorrect": true }
              ]
            },
            {
              "questionNumber": 3,
              "question": "The _______ to the museum is only $5 for students with valid ID cards.",
              "hint": "Cái gì bạn cần mua để được đi vào bảo tàng?",
              "answerOptions": [
                { "text": "phone bill", "rationale": "Sai. **phone bill** (n ph): hóa đơn điện thoại.", "isCorrect": false },
                { "text": "medical report", "rationale": "Sai. **medical report** (n ph): báo cáo y tế.", "isCorrect": false },
                { "text": "entrance ticket", "rationale": "Chính xác! **entrance ticket** (n ph): vé vào cửa.\n**Giải thích:** Để vào bảo tàng (museum) thì cần mua vé.\n**Dịch câu:** Vé vào cửa bảo tàng chỉ 5 đô la cho sinh viên có thẻ ID hợp lệ.", "isCorrect": true },
                { "text": "shopping list", "rationale": "Sai. **shopping list** (n ph): danh sách mua sắm.", "isCorrect": false }
              ]
            },
            {
              "questionNumber": 4,
              "question": "Many tourists enjoy eating fresh _______ at the restaurants near the beach.",
              "hint": "Ở gần biển (beach) thì món ăn gì là đặc sản tươi sống?",
              "answerOptions": [
                { "text": "seafood", "rationale": "Chính xác! **seafood** (n): hải sản.\n**Giải thích:** 'Near the beach' (gần biển) thì ăn hải sản là hợp lý nhất.\n**Dịch câu:** Nhiều du khách thích ăn hải sản tươi sống tại các nhà hàng gần bãi biển.", "isCorrect": true },
                { "text": "furniture", "rationale": "Sai. **furniture** (n): đồ nội thất. Không thể ăn được.", "isCorrect": false },
                { "text": "equipment", "rationale": "Sai. **equipment** (n): thiết bị. Không thể ăn được.", "isCorrect": false },
                { "text": "medicine", "rationale": "Sai. **medicine** (n): thuốc.", "isCorrect": false }
              ]
            },
            {
              "questionNumber": 5,
              "question": "Paris is a popular tourist _______ that attracts millions of visitors every year.",
              "hint": "Một nơi chốn mà khách du lịch thường đến gọi là gì?",
              "answerOptions": [
                { "text": "weather", "rationale": "Sai. **weather** (n): thời tiết.", "isCorrect": false },
                { "text": "destination", "rationale": "Chính xác! **destination** (n): điểm đến.\n**Giải thích:** 'Tourist destination' là cụm từ chỉ 'điểm đến du lịch'.\n**Dịch câu:** Paris là một điểm đến du lịch nổi tiếng thu hút hàng triệu du khách mỗi năm.", "isCorrect": true },
                { "text": "climate", "rationale": "Sai. **climate** (n): khí hậu.", "isCorrect": false },
                { "text": "season", "rationale": "Sai. **season** (n): mùa.", "isCorrect": false }
              ]
            },
            {
              "questionNumber": 6,
              "question": "The hotel provides comfortable _______ with clean rooms and good service.",
              "hint": "Từ nào chỉ chung về nơi ăn chốn ở, chỗ lưu trú?",
              "answerOptions": [
                { "text": "education", "rationale": "Sai. **education** (n): giáo dục.", "isCorrect": false },
                { "text": "transportation", "rationale": "Sai. **transportation** (n): giao thông vận tải.", "isCorrect": false },
                { "text": "accommodation", "rationale": "Chính xác! **accommodation** (n): chỗ ở/lưu trú.\n**Giải thích:** Khách sạn (hotel) cung cấp chỗ ở.\n**Dịch câu:** Khách sạn cung cấp chỗ ở thoải mái với phòng sạch sẽ và dịch vụ tốt.", "isCorrect": true },
                { "text": "entertainment", "rationale": "Sai. **entertainment** (n): sự giải trí.", "isCorrect": false }
              ]
            },
            {
              "questionNumber": 7,
              "question": "You need to _______ at least $1,000 for a week-long trip to Japan.",
              "hint": "Khi lên kế hoạch tiền bạc, bạn cần làm gì để biết khoảng bao nhiêu?",
              "answerOptions": [
                { "text": "celebrate", "rationale": "Sai. **celebrate** (v): ăn mừng/kỷ niệm.", "isCorrect": false },
                { "text": "decorate", "rationale": "Sai. **decorate** (v): trang trí.", "isCorrect": false },
                { "text": "graduate", "rationale": "Sai. **graduate** (v): tốt nghiệp.", "isCorrect": false },
                { "text": "estimate", "rationale": "Chính xác! **estimate** (v): ước tính.\n**Giải thích:** Bạn cần ước tính chi phí cho chuyến đi.\n**Dịch câu:** Bạn cần ước tính ít nhất 1.000 đô la cho chuyến đi kéo dài một tuần đến Nhật Bản.", "isCorrect": true }
              ]
            },
            {
              "questionNumber": 8,
              "question": "The travel _______ showed us around the ancient temple and explained its history.",
              "hint": "Ai là người dẫn đường và giải thích lịch sử cho du khách?",
              "answerOptions": [
                { "text": "guide", "rationale": "Chính xác! **guide** (n): hướng dẫn viên.\n**Giải thích:** 'Travel guide' hoặc 'Tour guide' là người dẫn tour.\n**Dịch câu:** Hướng dẫn viên du lịch đã dẫn chúng tôi tham quan ngôi đền cổ và giải thích lịch sử của nó.", "isCorrect": true },
                { "text": "teacher", "rationale": "Sai. **teacher** (n): giáo viên.", "isCorrect": false },
                { "text": "driver", "rationale": "Sai. **driver** (n): tài xế.", "isCorrect": false },
                { "text": "doctor", "rationale": "Sai. **doctor** (n): bác sĩ.", "isCorrect": false }
              ]
            },
            {
              "questionNumber": 9,
              "question": "We decided to take a relaxing _______ around the Caribbean islands this summer.",
              "hint": "Một chuyến du ngoạn trên biển bằng tàu lớn gọi là gì?",
              "answerOptions": [
                { "text": "marathon", "rationale": "Sai. **marathon** (n): cuộc chạy đua marathon.", "isCorrect": false },
                { "text": "concert", "rationale": "Sai. **concert** (n): buổi hòa nhạc.", "isCorrect": false },
                { "text": "cruise", "rationale": "Chính xác! **cruise** (n): chuyến du ngoạn trên biển (bằng du thuyền).\n**Giải thích:** Đi quanh các đảo (islands) thì đi 'cruise' là hợp lý.\n**Dịch câu:** Chúng tôi quyết định thực hiện một chuyến du thuyền thư giãn quanh các đảo Caribbean vào mùa hè này.", "isCorrect": true },
                { "text": "exhibition", "rationale": "Sai. **exhibition** (n): triển lãm.", "isCorrect": false }
              ]
            },
            {
              "questionNumber": 10,
              "question": "The Colosseum in Rome is a famous _______ that was built almost 2,000 years ago.",
              "hint": "Một địa điểm cổ kính có giá trị lịch sử gọi là gì?",
              "answerOptions": [
                { "text": "supermarket", "rationale": "Sai. **supermarket** (n): siêu thị.", "isCorrect": false },
                { "text": "gas station", "rationale": "Sai. **gas station** (n): trạm xăng.", "isCorrect": false },
                { "text": "parking lot", "rationale": "Sai. **parking lot** (n): bãi đậu xe.", "isCorrect": false },
                { "text": "historical place", "rationale": "Chính xác! **historical place** (n ph): di tích lịch sử/địa điểm lịch sử.\n**Giải thích:** Đấu trường La Mã xây cách đây 2000 năm là di tích lịch sử.\n**Dịch câu:** Đấu trường La Mã ở Rome là một địa điểm lịch sử nổi tiếng được xây dựng cách đây gần 2.000 năm.", "isCorrect": true }
              ]
            },
            {
              "questionNumber": 11,
              "question": "Booking flights early can help you _______ money on your vacation.",
              "hint": "Đặt vé sớm thường rẻ hơn, giúp bạn làm gì với tiền của mình?",
              "answerOptions": [
                { "text": "save", "rationale": "Chính xác! **save** (v): tiết kiệm.\n**Giải thích:** Mua vé sớm giá rẻ -> tiết kiệm tiền.\n**Dịch câu:** Đặt vé máy bay sớm có thể giúp bạn tiết kiệm tiền cho kỳ nghỉ.", "isCorrect": true },
                { "text": "waste", "rationale": "Sai. **waste** (v): lãng phí.", "isCorrect": false },
                { "text": "lose", "rationale": "Sai. **lose** (v): đánh mất.", "isCorrect": false },
                { "text": "forget", "rationale": "Sai. **forget** (v): quên.", "isCorrect": false }
              ]
            },
            {
              "questionNumber": 12,
              "question": "Our tour schedule is very _______, so we can change it if the weather is bad.",
              "hint": "Tính từ chỉ sự linh hoạt, dễ thay đổi?",
              "answerOptions": [
                { "text": "expensive", "rationale": "Sai. **expensive** (adj): đắt đỏ.", "isCorrect": false },
                { "text": "flexible", "rationale": "Chính xác! **flexible** (adj): linh hoạt.\n**Giải thích:** Có thể thay đổi (can change it) nghĩa là linh hoạt.\n**Dịch câu:** Lịch trình tour của chúng tôi rất linh hoạt, vì vậy chúng tôi có thể thay đổi nếu thời tiết xấu.", "isCorrect": true },
                { "text": "dangerous", "rationale": "Sai. **dangerous** (adj): nguy hiểm.", "isCorrect": false },
                { "text": "impossible", "rationale": "Sai. **impossible** (adj): không thể.", "isCorrect": false }
              ]
            },
            {
              "questionNumber": 13,
              "question": "The airline offers both _______ and international flights from this airport.",
              "hint": "Trái nghĩa với 'international' (quốc tế) là chuyến bay trong nước, gọi là gì?",
              "answerOptions": [
                { "text": "domestic", "rationale": "Chính xác! **domestic** (adj): nội địa (trong nước).\n**Giải thích:** Cặp từ đối lập thường gặp: Domestic flights (bay nội địa) và International flights (bay quốc tế).\n**Dịch câu:** Hãng hàng không cung cấp cả các chuyến bay nội địa và quốc tế từ sân bay này.", "isCorrect": true },
                { "text": "electric", "rationale": "Sai. **electric** (adj): thuộc về điện.", "isCorrect": false },
                { "text": "automatic", "rationale": "Sai. **automatic** (adj): tự động.", "isCorrect": false },
                { "text": "scientific", "rationale": "Sai. **scientific** (adj): thuộc về khoa học.", "isCorrect": false }
              ]
            },
            {
              "questionNumber": 14,
              "question": "Not everyone can _______ to stay at five-star hotels during their vacation.",
              "hint": "Động từ đi với 'to V', mang nghĩa là 'đủ khả năng chi trả'.",
              "answerOptions": [
                { "text": "refuse", "rationale": "Sai. **refuse** (v): từ chối.", "isCorrect": false },
                { "text": "complain", "rationale": "Sai. **complain** (v): phàn nàn.", "isCorrect": false },
                { "text": "argue", "rationale": "Sai. **argue** (v): tranh luận.", "isCorrect": false },
                { "text": "afford", "rationale": "Chính xác! **afford** (v): đủ khả năng chi trả.\n**Giải thích:** Cấu trúc 'can afford to V'. Khách sạn 5 sao rất đắt nên không phải ai cũng trả nổi.\n**Dịch câu:** Không phải ai cũng có đủ khả năng chi trả để ở tại các khách sạn năm sao trong kỳ nghỉ của họ.", "isCorrect": true }
              ]
            },
            {
              "questionNumber": 15,
              "question": "One _______ of traveling by train is that you can see beautiful scenery along the way.",
              "hint": "Ngắm cảnh đẹp là một điểm tốt/lợi ích. Từ nào mang nghĩa này?",
              "answerOptions": [
                { "text": "accident", "rationale": "Sai. **accident** (n): tai nạn.", "isCorrect": false },
                { "text": "advantage", "rationale": "Chính xác! **advantage** (n): lợi ích/ưu điểm.\n**Giải thích:** Việc ngắm cảnh đẹp là một ưu điểm.\n**Dịch câu:** Một ưu điểm của việc du lịch bằng tàu hỏa là bạn có thể ngắm phong cảnh đẹp dọc đường đi.", "isCorrect": true },
                { "text": "mistake", "rationale": "Sai. **mistake** (n): sai lầm.", "isCorrect": false },
                { "text": "problem", "rationale": "Sai. **problem** (n): vấn đề.", "isCorrect": false }
              ]
            },
            {
              "questionNumber": 16,
              "question": "The Eiffel Tower is a _______ landmark that everyone knows about.",
              "hint": "Nếu ai cũng biết đến (everyone knows about) thì nó là một địa danh như thế nào?",
              "answerOptions": [
                { "text": "broken", "rationale": "Sai. **broken** (adj): bị hỏng/vỡ.", "isCorrect": false },
                { "text": "forgotten", "rationale": "Sai. **forgotten** (adj): bị lãng quên.", "isCorrect": false },
                { "text": "well-known", "rationale": "Chính xác! **well-known** (adj): nổi tiếng (= famous).\n**Giải thích:** Mọi người đều biết đến -> Nổi tiếng.\n**Dịch câu:** Tháp Eiffel là một địa danh nổi tiếng mà mọi người đều biết đến.", "isCorrect": true },
                { "text": "hidden", "rationale": "Sai. **hidden** (adj): bị ẩn giấu.", "isCorrect": false }
              ]
            },
            {
              "questionNumber": 17,
              "question": "We bought a _______ that includes hotel, meals, and guided tours.",
              "hint": "Gói kỳ nghỉ bao gồm tất cả dịch vụ gọi là gì?",
              "answerOptions": [
                { "text": "package holiday", "rationale": "Chính xác! **package holiday** (n ph): kỳ nghỉ trọn gói.\n**Giải thích:** Includes hotel, meals... nghĩa là trọn gói.\n**Dịch câu:** Chúng tôi đã mua một kỳ nghỉ trọn gói bao gồm khách sạn, các bữa ăn và các tour có hướng dẫn viên.", "isCorrect": true },
                { "text": "newspaper", "rationale": "Sai. **newspaper** (n): báo chí.", "isCorrect": false },
                { "text": "textbook", "rationale": "Sai. **textbook** (n): sách giáo khoa.", "isCorrect": false },
                { "text": "dictionary", "rationale": "Sai. **dictionary** (n): từ điển.", "isCorrect": false }
              ]
            },
            {
              "questionNumber": 18,
              "question": "The tour guide will _______ the famous battle that took place here 200 years ago.",
              "hint": "Hướng dẫn viên sẽ 'nhắc đến/kể về' trận chiến. Động từ nào phù hợp?",
              "answerOptions": [
                { "text": "ignore", "rationale": "Sai. **ignore** (v): phớt lờ.", "isCorrect": false },
                { "text": "delete", "rationale": "Sai. **delete** (v): xóa bỏ.", "isCorrect": false },
                { "text": "mention", "rationale": "Chính xác! **mention** (v): đề cập/nhắc đến.\n**Giải thích:** Hướng dẫn viên sẽ kể/nhắc đến sự kiện lịch sử.\n**Dịch câu:** Hướng dẫn viên du lịch sẽ đề cập đến trận chiến nổi tiếng đã diễn ra tại đây 200 năm trước.", "isCorrect": true },
                { "text": "cancel", "rationale": "Sai. **cancel** (v): hủy bỏ.", "isCorrect": false }
              ]
            },
            {
              "questionNumber": 19,
              "question": "Learning about local _______ is an important part of traveling to new countries.",
              "hint": "Khi đến nước khác, việc học hỏi về lối sống, phong tục gọi là gì?",
              "answerOptions": [
                { "text": "furniture", "rationale": "Sai. **furniture** (n): nội thất.", "isCorrect": false },
                { "text": "traffic", "rationale": "Sai. **traffic** (n): giao thông.", "isCorrect": false },
                { "text": "weather", "rationale": "Sai. **weather** (n): thời tiết.", "isCorrect": false },
                { "text": "culture", "rationale": "Chính xác! **culture** (n): văn hóa.\n**Giải thích:** Tìm hiểu văn hóa là phần quan trọng khi đi du lịch.\n**Dịch câu:** Tìm hiểu về văn hóa địa phương là một phần quan trọng của việc đi du lịch đến các quốc gia mới.", "isCorrect": true }
              ]
            },
            {
              "questionNumber": 20,
              "question": "I prefer a _______ because I like to explore places at my own pace.",
              "hint": "Đi du lịch mà tự mình quyết định tốc độ, không theo đoàn gọi là gì?",
              "answerOptions": [
                { "text": "school exam", "rationale": "Sai. **school exam** (n ph): kỳ thi ở trường.", "isCorrect": false },
                { "text": "self-guided tour", "rationale": "Chính xác! **self-guided tour** (n ph): chuyến du lịch tự túc (tự hướng dẫn).\n**Giải thích:** 'At my own pace' (theo tốc độ của riêng tôi) phù hợp với du lịch tự túc.\n**Dịch câu:** Tôi thích một chuyến du lịch tự túc hơn vì tôi muốn khám phá các địa điểm theo tốc độ của riêng mình.", "isCorrect": true },
                { "text": "job interview", "rationale": "Sai. **job interview** (n ph): phỏng vấn xin việc.", "isCorrect": false },
                { "text": "medical checkup", "rationale": "Sai. **medical checkup** (n ph): kiểm tra sức khỏe.", "isCorrect": false }
              ]
            },
            {
              "questionNumber": 21,
              "question": "You will _______ to bring your passport when traveling to another country.",
              "hint": "Bạn 'cần' mang theo hộ chiếu. Động từ nào mang nghĩa yêu cầu/cần thiết?",
              "answerOptions": [
                { "text": "require", "rationale": "Chính xác! **require** (v): cần/yêu cầu.\n**Giải thích:** Trong ngữ cảnh này, 'will require' (sẽ cần) hoặc hàm ý bị động 'will be required' (sẽ được yêu cầu). Tuy nhiên, xét các đáp án thì chỉ 'require' mang nghĩa cần thiết.\n**Dịch câu:** Bạn sẽ cần phải mang theo hộ chiếu khi đi du lịch đến một quốc gia khác.", "isCorrect": true },
                { "text": "repair", "rationale": "Sai. **repair** (v): sửa chữa.", "isCorrect": false },
                { "text": "remove", "rationale": "Sai. **remove** (v): loại bỏ/dời đi.", "isCorrect": false },
                { "text": "reduce", "rationale": "Sai. **reduce** (v): cắt giảm.", "isCorrect": false }
              ]
            },
            {
              "questionNumber": 22,
              "question": "We were lucky to _______ the beautiful sunset from the top of the mountain.",
              "hint": "Chúng tôi may mắn được 'chứng kiến/nhìn thấy' hoàng hôn.",
              "answerOptions": [
                { "text": "prevent", "rationale": "Sai. **prevent** (v): ngăn chặn.", "isCorrect": false },
                { "text": "damage", "rationale": "Sai. **damage** (v): làm hư hại.", "isCorrect": false },
                { "text": "witness", "rationale": "Chính xác! **witness** (v): chứng kiến/nhìn thấy.\n**Giải thích:** Dùng cho việc nhìn thấy một sự kiện/cảnh tượng.\n**Dịch câu:** Chúng tôi đã may mắn được chứng kiến cảnh hoàng hôn tuyệt đẹp từ đỉnh núi.", "isCorrect": true },
                { "text": "destroy", "rationale": "Sai. **destroy** (v): phá hủy.", "isCorrect": false }
              ]
            },
            {
              "questionNumber": 23,
              "question": "The main _______ of traveling in the rainy season is that many activities get cancelled.",
              "hint": "Việc bị hủy hoạt động là một điểm xấu/bất lợi.",
              "answerOptions": [
                { "text": "disadvantage", "rationale": "Chính xác! **disadvantage** (n): bất lợi/nhược điểm.\n**Giải thích:** Mưa làm hủy hoạt động -> Bất lợi.\n**Dịch câu:** Bất lợi chính của việc đi du lịch vào mùa mưa là nhiều hoạt động bị hủy bỏ.", "isCorrect": true },
                { "text": "celebration", "rationale": "Sai. **celebration** (n): lễ kỷ niệm.", "isCorrect": false },
                { "text": "achievement", "rationale": "Sai. **achievement** (n): thành tựu.", "isCorrect": false },
                { "text": "competition", "rationale": "Sai. **competition** (n): cuộc thi.", "isCorrect": false }
              ]
            },
            {
              "questionNumber": 24,
              "question": "A detailed trip _______ helps you organize your time and activities better.",
              "hint": "Một bản kế hoạch chi tiết về lịch trình chuyến đi gọi là gì?",
              "answerOptions": [
                { "text": "recipe", "rationale": "Sai. **recipe** (n): công thức nấu ăn.", "isCorrect": false },
                { "text": "formula", "rationale": "Sai. **formula** (n): công thức (toán/hóa).", "isCorrect": false },
                { "text": "prescription", "rationale": "Sai. **prescription** (n): đơn thuốc.", "isCorrect": false },
                { "text": "itinerary", "rationale": "Chính xác! **itinerary** (n): lịch trình chuyến đi.\n**Giải thích:** Văn bản liệt kê chi tiết đi đâu, làm gì.\n**Dịch câu:** Một lịch trình chuyến đi chi tiết giúp bạn sắp xếp thời gian và các hoạt động tốt hơn.", "isCorrect": true }
              ]
            },
            {
              "questionNumber": 25,
              "question": "This travel app is very _______ for finding restaurants and attractions nearby.",
              "hint": "App giúp tìm nhà hàng thì nó rất 'có ích'.",
              "answerOptions": [
                { "text": "dangerous", "rationale": "Sai. **dangerous** (adj): nguy hiểm.", "isCorrect": false },
                { "text": "useful", "rationale": "Chính xác! **useful** (adj): hữu ích/có ích.\n**Giải thích:** Giúp tìm kiếm thông tin -> hữu ích.\n**Dịch câu:** Ứng dụng du lịch này rất hữu ích để tìm các nhà hàng và điểm tham quan gần đó.", "isCorrect": true },
                { "text": "harmful", "rationale": "Sai. **harmful** (adj): có hại.", "isCorrect": false },
                { "text": "terrible", "rationale": "Sai. **terrible** (adj): khủng khiếp/tồi tệ.", "isCorrect": false }
              ]
            },
            {
              "questionNumber": 26,
              "question": "Budget airlines often offer _______ flights if you book in advance.",
              "hint": "Hãng hàng không giá rẻ (Budget airlines) thì cung cấp vé như thế nào?",
              "answerOptions": [
                { "text": "cheap", "rationale": "Chính xác! **cheap** (adj): rẻ.\n**Giải thích:** Budget airlines = Hãng bay giá rẻ -> cung cấp cheap flights.\n**Dịch câu:** Các hãng hàng không giá rẻ thường cung cấp các chuyến bay giá rẻ nếu bạn đặt trước.", "isCorrect": true },
                { "text": "deaf", "rationale": "Sai. **deaf** (adj): điếc.", "isCorrect": false },
                { "text": "blind", "rationale": "Sai. **blind** (adj): mù.", "isCorrect": false },
                { "text": "silent", "rationale": "Sai. **silent** (adj): im lặng.", "isCorrect": false }
              ]
            },
            {
              "questionNumber": 27,
              "question": "It's _______ to check the weather forecast before planning outdoor activities.",
              "hint": "Trước khi chơi ngoài trời thì việc xem thời tiết là 'cần thiết'.",
              "answerOptions": [
                { "text": "unnecessary", "rationale": "Sai. **unnecessary** (adj): không cần thiết.", "isCorrect": false },
                { "text": "impossible", "rationale": "Sai. **impossible** (adj): không thể.", "isCorrect": false },
                { "text": "invisible", "rationale": "Sai. **invisible** (adj): vô hình.", "isCorrect": false },
                { "text": "necessary", "rationale": "Chính xác! **necessary** (adj): cần thiết.\n**Giải thích:** Để tránh mưa nắng bất chợt thì việc này là cần thiết.\n**Dịch câu:** Việc kiểm tra dự báo thời tiết trước khi lên kế hoạch cho các hoạt động ngoài trời là rất cần thiết.", "isCorrect": true }
              ]
            },
            {
              "questionNumber": 28,
              "question": "Please show your _______ to the conductor when you board the train.",
              "hint": "Lên tàu hỏa thì phải đưa cái gì cho người soát vé?",
              "answerOptions": [
                { "text": "mirror", "rationale": "Sai. **mirror** (n): cái gương.", "isCorrect": false },
                { "text": "pencil", "rationale": "Sai. **pencil** (n): bút chì.", "isCorrect": false },
                { "text": "ticket", "rationale": "Chính xác! **ticket** (n): vé.\n**Giải thích:** Lên tàu thì phải soát vé.\n**Dịch câu:** Vui lòng xuất trình vé của bạn cho người soát vé khi bạn lên tàu.", "isCorrect": true },
                { "text": "towel", "rationale": "Sai. **towel** (n): khăn tắm.", "isCorrect": false }
              ]
            },
            {
              "questionNumber": 29,
              "question": "English is an _______ language that is spoken in many tourist destinations.",
              "hint": "Tiếng Anh được nói ở nhiều nơi trên thế giới, nó là ngôn ngữ gì?",
              "answerOptions": [
                { "text": "ancient", "rationale": "Sai. **ancient** (adj): cổ đại.", "isCorrect": false },
                { "text": "regional", "rationale": "Sai. **regional** (adj): thuộc vùng miền.", "isCorrect": false },
                { "text": "international", "rationale": "Chính xác! **international** (adj): quốc tế.\n**Giải thích:** Được nói ở nhiều nơi -> Quốc tế.\n**Dịch câu:** Tiếng Anh là một ngôn ngữ quốc tế được nói ở nhiều điểm du lịch.", "isCorrect": true },
                { "text": "tribal", "rationale": "Sai. **tribal** (adj): thuộc bộ lạc.", "isCorrect": false }
              ]
            },
            {
              "questionNumber": 30,
              "question": "The _______ industry creates many jobs for local people in coastal areas.",
              "hint": "Ngành công nghiệp nào phát triển mạnh ở vùng ven biển (coastal areas) và tạo việc làm cho dân địa phương phục vụ khách?",
              "answerOptions": [
                { "text": "mining", "rationale": "Sai. **mining** (n): khai khoáng.", "isCorrect": false },
                { "text": "tourism", "rationale": "Chính xác! **tourism** (n): du lịch.\n**Giải thích:** Ngành công nghiệp du lịch (Tourism industry) rất phổ biến ở vùng biển.\n**Dịch câu:** Ngành công nghiệp du lịch tạo ra nhiều việc làm cho người dân địa phương ở các vùng ven biển.", "isCorrect": true },
                { "text": "farming", "rationale": "Sai. **farming** (n): nông nghiệp.", "isCorrect": false },
                { "text": "fishing", "rationale": "Sai. **fishing** (n): đánh cá. (Mặc dù vùng biển có đánh cá, nhưng ngữ cảnh 'industry creates jobs' trong bài học về du lịch thì 'tourism' là đáp án chính xác nhất theo chủ đề).", "isCorrect": false }
              ]
            }
          ]
        };

        let currentScore = 0;
        let answeredCount = 0;
        const totalQuestions = quizData.questions.length;

        // Shuffle function (Fisher-Yates)
        function shuffleArray(array) {
            for (let i = array.length - 1; i > 0; i--) {
                const j = Math.floor(Math.random() * (i + 1));
                [array[i], array[j]] = [array[j], array[i]];
            }
        }

        // Initialize Quiz
        function initQuiz() {
            // Shuffle questions
            shuffleArray(quizData.questions);
            
            const container = document.getElementById('quiz-container');
            container.innerHTML = '';

            quizData.questions.forEach((q, index) => {
                // Shuffle options for each question
                // We need to keep track of the original correct answer logic, so we shuffle a copy
                const shuffledOptions = [...q.answerOptions];
                shuffleArray(shuffledOptions);

                const card = document.createElement('div');
                card.className = 'quiz-card';
                card.id = `question-${index}`;

                // Extract Correct Answer Rationale for Translation
                const correctOption = q.answerOptions.find(opt => opt.isCorrect);
                let translation = "";
                // Simple parsing to find translation in rationale
                if(correctOption && correctOption.rationale.includes("Dịch câu:")) {
                    translation = correctOption.rationale.split("Dịch câu:")[1].trim();
                }

                // Generate HTML for Options
                let optionsHtml = '';
                shuffledOptions.forEach((opt, optIndex) => {
                    optionsHtml += `
                        <button class="option-btn" 
                                onclick="checkAnswer(this, ${opt.isCorrect}, 'explanation-${index}', '${opt.text}')"
                                data-rationale="${opt.rationale.replace(/"/g, '&quot;')}"
                                data-text="${opt.text}"
                        >
                            ${opt.text}
                        </button>
                    `;
                });

                // Generate Explanation List HTML (Pre-render all rationales)
                let explanationListHtml = '';
                // Sort back to original or alphabetical for explanation? Let's use the displayed shuffled order for consistency
                shuffledOptions.forEach(opt => {
                    const isCorrectClass = opt.isCorrect ? 'correct-analysis' : '';
                    explanationListHtml += `
                        <div class="analysis-item ${isCorrectClass}">
                            <strong>${opt.text}:</strong> ${formatRationale(opt.rationale)}
                        </div>
                    `;
                });

                card.innerHTML = `
                    <div class="question-number">Câu ${index + 1}/${totalQuestions}</div>
                    <div class="question-text">${q.question}</div>
                    <div class="hint-box"><i class="fas fa-lightbulb"></i> Gợi ý: ${q.hint}</div>
                    
                    <div class="options-grid">
                        ${optionsHtml}
                    </div>

                    <div id="explanation-${index}" class="explanation-box">
                        <div class="teacher-badge">
                            <i class="fas fa-user-graduate"></i>
                            <span>Cô Mai An giải thích chi tiết:</span>
                        </div>
                        
                        <div class="exp-section">
                            <span class="exp-label">1. Dịch câu hỏi:</span>
                            <div class="exp-content">"${translation}"</div>
                        </div>

                        <div class="exp-section">
                            <span class="exp-label">2. Phân tích đáp án:</span>
                            <div class="exp-content">
                                ${explanationListHtml}
                            </div>
                        </div>
                    </div>
                `;

                container.appendChild(card);
            });
        }

        // Format Rationale text (remove "Chính xác!", "Sai.", etc. for cleaner list)
        function formatRationale(text) {
            // Remove the initial "Chính xác!" or "Sai." if present to make the list look uniform
            return text.replace(/^(Chính xác!|Sai\.)\s*/i, '');
        }

        // Check Answer Function
        function checkAnswer(btn, isCorrect, explanationId, selectedText) {
            // Prevent clicking again
            const parentGrid = btn.parentElement;
            const buttons = parentGrid.querySelectorAll('.option-btn');
            
            // Check if already answered
            if(parentGrid.getAttribute('data-answered') === 'true') return;
            parentGrid.setAttribute('data-answered', 'true');

            // Find correct button to highlight it anyway
            let correctBtn;
            buttons.forEach(b => {
                // b.disabled = true; // Optional: disable buttons immediately
                if (b.onclick.toString().includes('true')) { // Hacky check or use data attribute
                   // Better way: check functionality logic
                }
            });

            if (isCorrect) {
                btn.classList.add('correct');
                playSound('correct');
                confetti({
                    particleCount: 100,
                    spread: 70,
                    origin: { y: 0.6 }
                });
                currentScore++;
            } else {
                btn.classList.add('wrong');
                playSound('wrong');
                // Highlight the correct one
                buttons.forEach(b => {
                    // Re-evaluate correct button based on text match from data
                    // Since we passed isCorrect in onclick, we need to find the correct DOM element
                    // Let's use the logic: find the button where isCorrect was passed as true
                });
                
                // Find and highlight correct answer
                 buttons.forEach(b => {
                    if (b.getAttribute('onclick').includes('true')) {
                        b.classList.add('correct');
                    }
                });
            }

            // Disable all buttons
            buttons.forEach(b => b.disabled = true);

            // Show Explanation
            const expBox = document.getElementById(explanationId);
            expBox.style.display = 'block';

            // Update Progress
            answeredCount++;
            updateProgressBar();
        }

        function updateProgressBar() {
            const percentage = (answeredCount / totalQuestions) * 100;
            document.getElementById('progressBar').style.width = percentage + '%';
        }

        function playSound(type) {
            const sound = document.getElementById(`sound-${type}`);
            if (sound) {
                sound.currentTime = 0;
                sound.play().catch(e => console.log("Audio autoplay prevented"));
            }
        }

        function finishQuiz() {
            if (answeredCount < totalQuestions) {
                const confirmFinish = confirm(`Bạn mới làm ${answeredCount}/${totalQuestions} câu. Bạn có chắc muốn nộp bài không?`);
                if (!confirmFinish) return;
            }

            playSound('finish');
            
            const modal = document.getElementById('scoreModal');
            const scoreDisplay = document.getElementById('finalScore');
            const feedbackDisplay = document.getElementById('finalFeedback');

            scoreDisplay.textContent = `${currentScore}/${totalQuestions}`;
            
            const percentage = (currentScore / totalQuestions) * 100;
            if (percentage === 100) {
                feedbackDisplay.textContent = "Xuất sắc! Cô Mai An rất tự hào!";
                confetti({ particleCount: 200, spread: 100 });
            } else if (percentage >= 80) {
                feedbackDisplay.textContent = "Làm rất tốt! Cố gắng phát huy nhé!";
            } else if (percentage >= 50) {
                feedbackDisplay.textContent = "Khá tốt, nhưng cần ôn lại từ vựng thêm nha!";
            } else {
                feedbackDisplay.textContent = "Đừng buồn, hãy xem lại giải thích và làm lại nhé!";
            }

            modal.style.display = 'flex';
        }

        // Initialize on load
        window.onload = initQuiz;

    </script>
</body>
</html>
