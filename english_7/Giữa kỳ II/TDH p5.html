<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>B√†i ki·ªÉm tra: Ms Mai An ULIS</title>
    <link href="https://fonts.googleapis.com/css2?family=Nunito:wght@400;600;800;900&display=swap" rel="stylesheet">
    <style>
        :root {
            /* Palette theo ch·ªß ƒë·ªÅ Pirate & Festivals: Xanh bi·ªÉn, Xanh ng·ªçc, V√†ng Gold */
            --primary: #0984e3;
            --secondary: #fdcb6e;
            --accent: #00b894;
            --correct: #00D26A;
            --wrong: #FF4757;
            --bg-card: #ffffff;
            --text-main: #2d3436;
        }

        * { box-sizing: border-box; font-family: 'Nunito', sans-serif; }

        body {
            margin: 0; padding: 0;
            background: linear-gradient(-45deg, #0984e3, #74b9ff, #00b894, #ffeaa7);
            background-size: 400% 400%;
            animation: gradientBG 15s ease infinite;
            color: var(--text-main);
            height: 100vh;
            overflow: hidden;
            display: flex;
            flex-direction: column;
        }

        @keyframes gradientBG {
            0% { background-position: 0% 50%; }
            50% { background-position: 100% 50%; }
            100% { background-position: 0% 50%; }
        }

        /* SVG Background Pattern ƒë·ªông - ƒê√£ ƒë·ªïi EMOJI theo ch·ªß ƒë·ªÅ L·ªÖ h·ªôi & C∆∞·ªõp bi·ªÉn */
        .pattern-overlay {
            position: fixed; top: 0; left: 0; width: 100%; height: 100%;
            pointer-events: none; z-index: 0;
            background-image: url('data:image/svg+xml;utf8,<svg xmlns="http://www.w3.org/2000/svg" width="400" height="400" viewBox="0 0 400 400"><text x="50" y="80" font-size="45" opacity="0.6">üè¥‚Äç‚ò†Ô∏è</text><text x="250" y="150" font-size="50" opacity="0.5">üéÜ</text><text x="100" y="300" font-size="40" opacity="0.7">ü¶É</text><text x="320" y="320" font-size="45" opacity="0.6">üåä</text></svg>');
            animation: floatPattern 35s linear infinite;
            mix-blend-mode: overlay;
        }

        @keyframes floatPattern {
            0% { background-position: 0 0; }
            100% { background-position: 400px 400px; }
        }

        /* Top Control Bar */
        .top-bar {
            height: 70px; background: rgba(255, 255, 255, 0.92);
            box-shadow: 0 4px 15px rgba(0,0,0,0.1);
            display: flex; justify-content: space-between; align-items: center;
            padding: 0 30px; z-index: 10;
            backdrop-filter: blur(10px);
        }

        .header-title { font-weight: 900; color: var(--primary); font-size: 24px; margin: 0; }
        .header-subtitle { font-size: 14px; color: #636e72; margin: 0; }

        .timer-container { display: flex; align-items: center; gap: 15px; }
        .timer-display { font-size: 28px; font-weight: 900; color: var(--text-main); min-width: 90px; text-align: center; }
        .btn-timer {
            padding: 10px 20px; font-size: 16px; font-weight: bold; cursor: pointer;
            border: none; border-radius: 15px; background: var(--accent); color: white;
            box-shadow: 0 5px 0 #009376; transition: all 0.1s;
        }
        .btn-timer:active { transform: translateY(5px); box-shadow: 0 0 0 #009376; }

        /* Split Screen Layout */
        .main-container {
            display: flex; flex: 1; overflow: hidden; position: relative; z-index: 1;
            padding: 20px; gap: 20px;
        }

        .pane {
            flex: 1; background: rgba(255, 255, 255, 0.95);
            border-radius: 20px; box-shadow: 0 10px 30px rgba(0,0,0,0.15);
            overflow-y: auto; padding: 30px;
            scroll-behavior: smooth;
        }
        
        .pane::-webkit-scrollbar { width: 10px; }
        .pane::-webkit-scrollbar-track { background: #f1f1f1; border-radius: 10px; }
        .pane::-webkit-scrollbar-thumb { background: var(--secondary); border-radius: 10px; }

        /* N·ªôi dung Reading */
        .passage { font-size: 18px; line-height: 1.8; margin-bottom: 20px; }
        .gap { display: inline-block; min-width: 40px; border-bottom: 2px solid var(--primary); text-align: center; font-weight: bold; color: var(--primary); }
        .highlight-text { background: #ffeaa7; padding: 2px 5px; border-radius: 5px; font-weight: bold; }
        
        .btn-translate {
            background: var(--primary); color: white; border: none; padding: 10px 20px;
            border-radius: 12px; font-weight: bold; cursor: pointer;
            box-shadow: 0 4px 0 #0765b0; margin-bottom: 10px; transition: 0.2s;
        }
        .btn-translate:hover { filter: brightness(1.1); }
        .btn-translate:active { transform: translateY(4px); box-shadow: none; }
        .translation-box {
            background: #f8f9fa; border-left: 5px solid var(--primary);
            padding: 15px; border-radius: 0 10px 10px 0; margin-bottom: 20px;
            display: none; font-style: italic; font-size: 16px; line-height: 1.6;
        }

        /* B·∫£ng Glossary */
        .glossary-table {
            width: 100%; border-collapse: collapse; margin-top: 15px; margin-bottom: 30px;
            background: white; border-radius: 10px; overflow: hidden;
            box-shadow: 0 4px 10px rgba(0,0,0,0.05);
        }
        .glossary-table th { background: var(--secondary); padding: 12px; text-align: left; color: #2d3436; }
        .glossary-table td { padding: 12px; border-bottom: 1px solid #eee; }
        .glossary-table tr:last-child td { border-bottom: none; }

        /* Khu v·ª±c b√†i t·∫≠p */
        .question-card {
            background: white; border: 2px solid #eee; border-radius: 15px;
            padding: 20px; margin-bottom: 20px; box-shadow: 0 5px 15px rgba(0,0,0,0.05);
        }
        .q-text { font-size: 18px; font-weight: bold; margin-bottom: 15px; }
        
        .options-grid { display: grid; grid-template-columns: 1fr 1fr; gap: 15px; }
        .option-btn {
            background: #f1f2f6; border: 2px solid transparent; padding: 15px;
            border-radius: 15px; font-size: 16px; font-weight: 600; cursor: pointer;
            text-align: left; transition: all 0.2s; position: relative;
            box-shadow: 0 4px 0 #dfe4ea; color: #2d3436;
        }
        .option-btn:hover { transform: scale(1.02); background: #eccc6833; }
        .option-btn:active { transform: scale(0.98) translateY(4px); box-shadow: none; }
        
        .option-btn.correct { background: var(--correct); color: white; box-shadow: 0 4px 0 #00a854; border-color: #00a854; }
        .option-btn.wrong { background: var(--wrong); color: white; box-shadow: 0 4px 0 #d63031; border-color: #d63031; animation: shake 0.4s; }
        
        @keyframes shake {
            0% { transform: translateX(0); }
            25% { transform: translateX(-5px); }
            50% { transform: translateX(5px); }
            75% { transform: translateX(-5px); }
            100% { transform: translateX(0); }
        }

        .explanation-box {
            margin-top: 15px; padding: 15px; background: #e3f2fd; border-radius: 12px;
            border-left: 5px solid var(--primary); font-size: 15px; display: none; line-height: 1.6;
        }
        .explanation-box.show { display: block; animation: fadeIn 0.5s; }

        @keyframes fadeIn { from { opacity: 0; transform: translateY(-10px); } to { opacity: 1; transform: translateY(0); } }

        /* Submit & Result */
        .btn-submit {
            display: block; width: 100%; padding: 20px; font-size: 22px; font-weight: 900;
            background: var(--primary); color: white; border: none; border-radius: 20px;
            cursor: pointer; box-shadow: 0 8px 0 #0765b0; margin-top: 30px; transition: 0.2s;
        }
        .btn-submit:active { transform: translateY(8px); box-shadow: none; }

        .modal {
            position: fixed; top: 0; left: 0; width: 100%; height: 100%;
            background: rgba(0,0,0,0.8); z-index: 100; display: none;
            justify-content: center; align-items: center; flex-direction: column;
        }
        .modal-content {
            background: white; padding: 40px; border-radius: 30px; text-align: center;
            max-width: 500px; width: 90%; box-shadow: 0 20px 50px rgba(0,0,0,0.5);
            animation: scaleUp 0.5s cubic-bezier(0.175, 0.885, 0.32, 1.275);
        }
        @keyframes scaleUp { from { transform: scale(0.5); opacity: 0; } to { transform: scale(1); opacity: 1; } }
        
        .score-circle {
            width: 150px; height: 150px; background: var(--secondary); border-radius: 50%;
            display: flex; justify-content: center; align-items: center; margin: 0 auto 20px;
            font-size: 40px; font-weight: 900; color: white; border: 10px solid #ffeaa7;
            text-shadow: 2px 2px 4px rgba(0,0,0,0.2);
        }

        /* Confetti */
        .confetti { position: fixed; width: 10px; height: 10px; z-index: 99; pointer-events: none; }
        
        /* Toast th√¥ng b√°o */
        #toast {
            position: fixed; top: 20px; left: 50%; transform: translateX(-50%);
            background: #FF4757; color: white; padding: 15px 30px; border-radius: 30px;
            font-weight: bold; z-index: 1000; display: none; box-shadow: 0 5px 15px rgba(0,0,0,0.2);
            text-align: center; max-width: 80%;
        }
    </style>
</head>
<body>

<div class="pattern-overlay"></div>
<div id="toast">ƒê√£ h·∫øt gi·ªù l√†m b√†i!</div>

<div class="top-bar">
    <div>
        <h1 class="header-title">English Test Gamified üè¥‚Äç‚ò†Ô∏è</h1>
        <p class="header-subtitle">Gi√°o vi√™n: Ms Mai An ULIS</p>
    </div>
    <div class="timer-container">
        <div class="timer-display" id="timer">10:00</div>
        <button class="btn-timer" id="btn-timer-control" onclick="toggleTimer()">B·∫ÆT ƒê·∫¶U T√çNH GI·ªú</button>
    </div>
</div>

<div class="main-container">
    <div class="pane left-pane">
        <h2>V. Choose the best option to complete the following sentences.</h2>
        <div class="passage">
            Two of the most important holidays in the United States are Independence Day and Thanksgiving Day. The fourth of July marks the American declaration of independence from Britain. Most towns, big or small, celebrate the fourth of July with parades and fireworks. Families <span class="gap">(1)</span> with barbecues or picnics. Thanksgiving Day is celebrated in Fall, on the fourth Thursday in November. It is a day <span class="gap">(2)</span> people give thanks to the harvest. Most families <span class="gap">(3)</span> a large dinner with roast turkey. <span class="gap">(4)</span> Independence Day and Thanksgiving are national <span class="gap">(5)</span> holidays.
        </div>
        
        <button class="btn-translate" onclick="toggleTranslation('trans1')">B·∫¢N D·ªäCH ƒê·∫¶Y ƒê·ª¶</button>
        <div id="trans1" class="translation-box">
            Hai trong s·ªë nh·ªØng ng√†y l·ªÖ quan tr·ªçng nh·∫•t ·ªü Hoa K·ª≥ l√† Ng√†y ƒê·ªôc L·∫≠p v√† Ng√†y L·ªÖ T·∫° ∆†n. Ng√†y m√πng 4 th√°ng 7 ƒë√°nh d·∫•u b·∫£n tuy√™n ng√¥n ƒë·ªôc l·∫≠p c·ªßa M·ªπ kh·ªèi n∆∞·ªõc Anh. H·∫ßu h·∫øt c√°c th·ªã tr·∫•n, d√π l·ªõn hay nh·ªè, ƒë·ªÅu ƒÉn m·ª´ng ng√†y m√πng 4 th√°ng 7 b·∫±ng nh·ªØng cu·ªôc di·ªÖu h√†nh v√† ph√°o hoa. C√°c gia ƒë√¨nh ƒÉn m·ª´ng b·∫±ng nh·ªØng b·ªØa ti·ªác n∆∞·ªõng ngo√†i tr·ªùi ho·∫∑c nh·ªØng chuy·∫øn d√£ ngo·∫°i. Ng√†y L·ªÖ T·∫° ∆†n ƒë∆∞·ª£c t·ªï ch·ª©c v√†o m√πa Thu, v√†o ng√†y th·ª© NƒÉm tu·∫ßn th·ª© t∆∞ c·ªßa th√°ng 11. ƒê√≥ l√† m·ªôt ng√†y m√† m·ªçi ng∆∞·ªùi g·ª≠i l·ªùi t·∫° ∆°n t·ªõi v·ª• m√πa thu ho·∫°ch. H·∫ßu h·∫øt c√°c gia ƒë√¨nh c√≥ m·ªôt b·ªØa t·ªëi th·ªãnh so·∫°n v·ªõi m√≥n g√† t√¢y quay. C·∫£ Ng√†y ƒê·ªôc L·∫≠p v√† L·ªÖ T·∫° ∆†n ƒë·ªÅu l√† nh·ªØng ng√†y l·ªÖ qu·ªëc gia.
        </div>

        <table class="glossary-table">
            <tr><th>T·ª´ v·ª±ng (B1-C2)</th><th>Lo·∫°i t·ª´</th><th>Nghƒ©a ti·∫øng Vi·ªát</th></tr>
            <tr><td>1. Independence</td><td>Noun</td><td>S·ª± ƒë·ªôc l·∫≠p</td></tr>
            <tr><td>2. Declaration</td><td>Noun</td><td>B·∫£n tuy√™n ng√¥n, s·ª± tuy√™n b·ªë</td></tr>
            <tr><td>3. Celebrate</td><td>Verb</td><td>K·ª∑ ni·ªám, ƒÉn m·ª´ng</td></tr>
            <tr><td>4. Parade</td><td>Noun</td><td>Cu·ªôc di·ªÖu h√†nh</td></tr>
            <tr><td>5. Firework</td><td>Noun</td><td>Ph√°o hoa</td></tr>
            <tr><td>6. Harvest</td><td>Noun</td><td>V·ª• m√πa thu ho·∫°ch</td></tr>
            <tr><td>7. Roast turkey</td><td>Noun Phrase</td><td>G√† t√¢y quay</td></tr>
            <tr><td>8. National</td><td>Adj</td><td>Thu·ªôc v·ªÅ qu·ªëc gia</td></tr>
            <tr><td>9. Picnic</td><td>Noun</td><td>Chuy·∫øn d√£ ngo·∫°i</td></tr>
            <tr><td>10. Barbecue</td><td>Noun</td><td>Ti·ªác n∆∞·ªõng ngo√†i tr·ªùi</td></tr>
        </table>

        <hr style="border:1px dashed #ccc; margin: 40px 0;">

        <h2>VI. Read the passage and choose the correct answer (A, B, C or D) to each question.</h2>
        <div class="passage">
            <span class="highlight-text">#The Silver Bore - Daniel Jones:</span> If you‚Äôve ever seen a pirate film in the past, you can save your money. This is one of the most predictable films I have seen this year. The plot is totally unbelievable and the script is something amateurish out of filmmaker college. There is some nice cinematography but the Hawaiian scenery is not enough to save this film. Great supporting acting from the Frenchman Thierry Montpasse as the evil Captain Scar.<br><br>
            <span class="highlight-text">#Pirates At the Speed Of Light - Angela Moore:</span> I just love this fast-moving pirate thriller. The story moves at dizzying speed from one terrifying battle scene to the next and you really feel as if you are on the ships with these evil thieves and smugglers. Chief pirate, British actor Colin Williams, is given all the best, wittiest lines and the film has its share of laughs as well as scary moments. The storm scene at the beginning leaves you both exhausted and terrified.
        </div>

        <button class="btn-translate" onclick="toggleTranslation('trans2')">B·∫¢N D·ªäCH ƒê·∫¶Y ƒê·ª¶</button>
        <div id="trans2" class="translation-box">
            <b>#The Silver Bore - Daniel Jones:</b> N·∫øu b·∫°n ƒë√£ t·ª´ng xem m·ªôt b·ªô phim c∆∞·ªõp bi·ªÉn trong qu√° kh·ª©, b·∫°n c√≥ th·ªÉ ti·∫øt ki·ªám ti·ªÅn c·ªßa m√¨nh (kh√¥ng c·∫ßn xem phim n√†y). ƒê√¢y l√† m·ªôt trong nh·ªØng b·ªô phim d·ªÖ ƒëo√°n nh·∫•t m√† t√¥i ƒë√£ xem trong nƒÉm nay. C·ªët truy·ªán ho√†n to√†n kh√¥ng ƒë√°ng tin v√† k·ªãch b·∫£n th√¨ c√≥ ph·∫ßn nghi·ªáp d∆∞ nh∆∞ ki·ªÉu sinh vi√™n tr∆∞·ªùng ƒë·∫°i h·ªçc l√†m phim vi·∫øt ra v·∫≠y. C√≥ m·ªôt v√†i g√≥c m√°y quay phim ƒë·∫πp nh∆∞ng phong c·∫£nh Hawaii c≈©ng kh√¥ng ƒë·ªß ƒë·ªÉ c·ª©u v·ªõt b·ªô phim n√†y. Di·ªÖn xu·∫•t ph·ª• tuy·ªát v·ªùi ƒë·∫øn t·ª´ nam di·ªÖn vi√™n ng∆∞·ªùi Ph√°p Thierry Montpasse trong vai Thuy·ªÅn tr∆∞·ªüng Scar ƒë·ªôc √°c.<br><br>
            <b>#Pirates At the Speed Of Light - Angela Moore:</b> T√¥i th·ª±c s·ª± y√™u th√≠ch b·ªô phim kinh d·ªã c∆∞·ªõp bi·ªÉn c√≥ nh·ªãp ƒë·ªô nhanh n√†y. C√¢u chuy·ªán di chuy·ªÉn v·ªõi t·ªëc ƒë·ªô ch√≥ng m·∫∑t t·ª´ c·∫£nh chi·∫øn ƒë·∫•u kinh ho√†ng n√†y sang c·∫£nh kh√°c v√† b·∫°n th·ª±c s·ª± c·∫£m th·∫•y nh∆∞ th·ªÉ m√¨nh ƒëang ·ªü tr√™n t√†u v·ªõi nh·ªØng t√™n tr·ªôm v√† b·ªçn bu√¥n l·∫≠u x·∫•u xa n√†y v·∫≠y. T√™n c∆∞·ªõp bi·ªÉn tr∆∞·ªüng, nam di·ªÖn vi√™n ng∆∞·ªùi Anh Colin Williams, ƒë∆∞·ª£c giao to√†n b·ªô nh·ªØng c√¢u tho·∫°i hay nh·∫•t, d√≠ d·ªèm nh·∫•t v√† b·ªô phim mang ƒë·∫øn cho ng∆∞·ªùi xem c·∫£ nh·ªØng tr√†ng c∆∞·ªùi c≈©ng nh∆∞ nh·ªØng kho·∫£nh kh·∫Øc ƒë√°ng s·ª£. C·∫£nh c∆°n b√£o ·ªü ƒë·∫ßu phim khi·∫øn b·∫°n v·ª´a ki·ªát s·ª©c v·ª´a kinh h√£i.
        </div>

        <table class="glossary-table">
            <tr><th>T·ª´ v·ª±ng (B1-C2)</th><th>Lo·∫°i t·ª´</th><th>Nghƒ©a ti·∫øng Vi·ªát</th></tr>
            <tr><td>1. Predictable</td><td>Adj</td><td>D·ªÖ ƒëo√°n</td></tr>
            <tr><td>2. Unbelievable</td><td>Adj</td><td>Kh√¥ng th·ªÉ tin ƒë∆∞·ª£c, phi l√Ω</td></tr>
            <tr><td>3. Script</td><td>Noun</td><td>K·ªãch b·∫£n</td></tr>
            <tr><td>4. Amateurish</td><td>Adj</td><td>Nghi·ªáp d∆∞, thi·∫øu chuy√™n nghi·ªáp</td></tr>
            <tr><td>5. Cinematography</td><td>Noun</td><td>Ngh·ªá thu·∫≠t quay phim</td></tr>
            <tr><td>6. Thriller</td><td>Noun</td><td>Phim/truy·ªán kinh d·ªã, gi·∫≠t g√¢n</td></tr>
            <tr><td>7. Smuggler</td><td>Noun</td><td>K·∫ª bu√¥n l·∫≠u</td></tr>
            <tr><td>8. Wittiest (Witty)</td><td>Adj</td><td>D√≠ d·ªèm, th√¥ng minh nh·∫•t</td></tr>
            <tr><td>9. Exhausted</td><td>Adj</td><td>Ki·ªát s·ª©c</td></tr>
            <tr><td>10. Terrified</td><td>Adj</td><td>Kinh h√£i, khi·∫øp s·ª£</td></tr>
        </table>
    </div>

    <div class="pane right-pane" id="exercise-pane">
        </div>
</div>

<div class="modal" id="result-modal">
    <div class="modal-content">
        <h2 style="color: var(--primary); font-size: 30px;">K·∫æT QU·∫¢ C·ª¶A B·∫†N</h2>
        <div class="score-circle" id="final-score">0/10</div>
        <h3 id="feedback-msg" style="color: #636e72;"></h3>
        <button class="btn-submit" style="margin-top: 20px; background: var(--accent);" onclick="location.reload()">L√ÄM L·∫†I B√ÄI</button>
    </div>
</div>

<script>
    // --- D·ªÆ LI·ªÜU C√ÇU H·ªéI ---
    const allQuestions = [
        // B√†i V
        {
            id: 'v1',
            text: "Question 1: Families (1) ______ with barbecues or picnics.",
            options: [
                { id: 'A', text: 'celebrating' },
                { id: 'B', text: 'celebration' },
                { id: 'C', text: 'celebrate', isCorrect: true },
                { id: 'D', text: 'celebrated' }
            ],
            explanation: "<b>Ms. Mai An gi·∫£i th√≠ch:</b><br>- <b>Ng·ªØ ph√°p:</b> C√¢u n√†y n√≥i v·ªÅ m·ªôt s·ª± th·∫≠t hi·ªÉn nhi√™n, m·ªôt th√≥i quen th∆∞·ªùng l·ªá trong ng√†y l·ªÖ n√™n ta d√πng th√¨ <b>Hi·ªán t·∫°i ƒë∆°n (Present Simple)</b>. Ch·ªß ng·ªØ l√† 'Families' (s·ªë nhi·ªÅu) n√™n ƒë·ªông t·ª´ gi·ªØ nguy√™n m·∫´u.<br>- <b>Lo·∫°i tr·ª´:</b> A l√† V-ing (sai th√¨), B l√† Danh t·ª´, D l√† Qu√° kh·ª©. Ch·ªçn C. celebrate (ƒÉn m·ª´ng)."
        },
        {
            id: 'v2',
            text: "Question 2: It is a day (2) ______ people give thanks to the harvest.",
            options: [
                { id: 'A', text: 'where' },
                { id: 'B', text: 'when', isCorrect: true },
                { id: 'C', text: 'which' },
                { id: 'D', text: 'what' }
            ],
            explanation: "<b>Ms. Mai An gi·∫£i th√≠ch:</b><br>- <b>Ki·∫øn th·ª©c:</b> ƒê·∫°i t·ª´ quan h·ªá / Tr·∫°ng t·ª´ quan h·ªá.<br>- T·ª´ c·∫ßn ƒëi·ªÅn b·ªï nghƒ©a cho danh t·ª´ ch·ªâ th·ªùi gian 'a day' (m·ªôt ng√†y). Tr·∫°ng t·ª´ quan h·ªá ch·ªâ th·ªùi gian thay th·∫ø cho 'on which / in which' ch√≠nh l√† <b>'when'</b> (khi m√†).<br>- D·ªãch: ƒê√≥ l√† m·ªôt ng√†y <b>khi m√†</b> m·ªçi ng∆∞·ªùi g·ª≠i l·ªùi t·∫° ∆°n..."
        },
        {
            id: 'v3',
            text: "Question 3: Most families (3) ______ a large dinner with roast turkey.",
            options: [
                { id: 'A', text: 'have', isCorrect: true },
                { id: 'B', text: 'buy' },
                { id: 'C', text: 'help' },
                { id: 'D', text: 'take' }
            ],
            explanation: "<b>Ms. Mai An gi·∫£i th√≠ch:</b><br>- <b>Collocation (C·ª•m t·ª´ c·ªë ƒë·ªãnh):</b> ƒê·ªÉ n√≥i 'c√≥ m·ªôt b·ªØa ƒÉn/ƒÉn t·ªëi', trong ti·∫øng Anh ch√∫ng ta d√πng c·ª•m <b>'have a dinner/have a meal'</b>.<br>- C√°c ƒë·ªông t·ª´ nh∆∞ buy (mua), help (gi√∫p ƒë·ª°), take (l·∫•y) kh√¥ng gh√©p t·ª± nhi√™n v·ªõi 'a dinner' trong ng·ªØ c·∫£nh c√πng nhau th∆∞·ªüng th·ª©c b·ªØa ƒÉn t·∫°i nh√†. Ch·ªçn A."
        },
        {
            id: 'v4',
            text: "Question 4: (4) ______ Independence Day and Thanksgiving are national holidays.",
            options: [
                { id: 'A', text: 'Besides' },
                { id: 'B', text: 'Both', isCorrect: true },
                { id: 'C', text: 'Either' },
                { id: 'D', text: 'Nor' }
            ],
            explanation: "<b>Ms. Mai An gi·∫£i th√≠ch:</b><br>- <b>C·∫•u tr√∫c t∆∞∆°ng quan:</b> ƒê·∫±ng sau ch·ªó tr·ªëng ta th·∫•y c√≥ t·ª´ 'and'. C·∫•u tr√∫c ƒëi theo c·∫∑p c·ªë ƒë·ªãnh l√†: <b>Both A and B</b> (C·∫£ A v√† B).<br>- Either ƒëi v·ªõi 'or'. Nor ƒëi v·ªõi 'Neither'. Besides nghƒ©a l√† 'ngo√†i ra' kh√¥ng ƒëi v·ªõi and nh∆∞ v·∫≠y. Ch·ªçn B."
        },
        {
            id: 'v5',
            text: "Question 5: ...are national (5) ______ holidays.",
            options: [
                { id: 'A', text: 'chances' },
                { id: 'B', text: 'months' },
                { id: 'C', text: 'holidays', isCorrect: true },
                { id: 'D', text: 'times' }
            ],
            explanation: "<b>Ms. Mai An gi·∫£i th√≠ch:</b><br>- <b>L∆∞u √Ω nh·ªè t·ª´ c√¥:</b> Trong ƒë·ªÅ b√†i g·ªëc t√°c gi·∫£ vi·∫øt 'are national (5) holidays', t·ª´ 'holidays' b·ªã l·∫∑p l·∫°i ·ªü c·∫£ ƒë√°p √°n v√† sau ch·ªó tr·ªëng (national holidays holidays), c√≥ th·ªÉ do l·ªói ƒë√°nh m√°y c·ªßa ng∆∞·ªùi ra ƒë·ªÅ.<br>- Tuy nhi√™n, x√©t v·ªÅ m·∫∑t ng·ªØ nghƒ©a, c·ª•m t·ª´ ƒë√∫ng ph·∫£i l√† <b>'national holidays'</b> (nh·ªØng ng√†y l·ªÖ qu·ªëc gia). Ta ch·ªçn C. holidays nh√©!"
        },
        // B√†i VI
        {
            id: 'vi1',
            text: "Question 6: What is the main purpose of the thread?",
            options: [
                { id: 'A', text: 'To explain the plots of the films.' },
                { id: 'B', text: 'To introduce the main characters of the films.' },
                { id: 'C', text: 'To give reviews of the films.', isCorrect: true },
                { id: 'D', text: 'To encourage people to see the films.' }
            ],
            explanation: "<b>Ms. Mai An gi·∫£i th√≠ch:</b><br>- <b>Ph√¢n t√≠ch:</b> C·∫£ hai ƒëo·∫°n vƒÉn l√† nh·∫≠n x√©t c√° nh√¢n c·ªßa 2 ng∆∞·ªùi (Daniel Jones ch√™ phim nh·∫°t nh·∫Ωo, Angela Moore khen phim k·ªãch t√≠nh).<br>- ƒê√¢y l√† h√¨nh th·ª©c vi·∫øt <b>Reviews (ƒë√°nh gi√°, b√¨nh duy·ªát phim)</b>. ƒê√°p √°n D sai v√¨ t√°c gi·∫£ ƒë·∫ßu ti√™n khuy√™n 'save your money' (ti·∫øt ki·ªám ti·ªÅn ƒëi/ƒë·ª´ng xem), t·ª©c l√† kh√¥ng h·ªÅ 'encourage' (khuy·∫øn kh√≠ch). Ch·ªçn C."
        },
        {
            id: 'vi2',
            text: "Question 7: Who are the target audiences of the thread?",
            options: [
                { id: 'A', text: 'Film-lovers' },
                { id: 'B', text: 'Movie critics' },
                { id: 'C', text: 'Pirate movie fans' },
                { id: 'D', text: 'All are correct.', isCorrect: true }
            ],
            explanation: "<b>Ms. Mai An gi·∫£i th√≠ch:</b><br>- <b>D·∫´n ch·ª©ng:</b> B√†i review phim h∆∞·ªõng t·ªõi nh·ªØng ng∆∞·ªùi y√™u phim n√≥i chung (Film-lovers), nh·ªØng ng∆∞·ªùi th√≠ch th·ªÉ lo·∫°i phim c∆∞·ªõp bi·ªÉn (Pirate movie fans - nh∆∞ nh·∫Øc ƒë·∫øn ·ªü ngay c√¢u ƒë·∫ßu), v√† c≈©ng d√†nh cho nh·ªØng nh√† ph√™ b√¨nh tham kh·∫£o (Movie critics).<br>- Do ƒë√≥, ƒë·ªëi t∆∞·ª£ng ƒë·ªôc gi·∫£ m·ª•c ti√™u c√≥ th·ªÉ bao tr√πm t·∫•t c·∫£ c√°c nh√≥m tr√™n. Ch·ªçn D."
        },
        {
            id: 'vi3',
            text: "Question 8: The word 'amateurish' in the second paragraph is OPPOSITE in meaning to ____.",
            options: [
                { id: 'A', text: 'successful' },
                { id: 'B', text: 'unskilled' },
                { id: 'C', text: 'professional', isCorrect: true },
                { id: 'D', text: 'impressive' }
            ],
            explanation: "<b>Ms. Mai An gi·∫£i th√≠ch:</b><br>- <b>T·ª´ v·ª±ng:</b> Ch√∫ √Ω ƒë·ªÅ b√†i h·ªèi t·ª´ <b>OPPOSITE</b> (Tr√°i nghƒ©a).<br>- 'Amateurish' (t·ª´ g·ªëc: amateur) mang nghƒ©a l√† <b>nghi·ªáp d∆∞, thi·∫øu k·ªπ nƒÉng, thi·∫øu chuy√™n m√¥n</b>. <br>- Tr√°i nghƒ©a v·ªõi 'nghi·ªáp d∆∞' ch√≠nh l√† <b>'chuy√™n nghi·ªáp' (professional)</b>. Ch·ªçn C."
        },
        {
            id: 'vi4',
            text: "Question 9: The word 'dizzying' in the passage is CLOSEST in meaning to ____.",
            options: [
                { id: 'A', text: 'fast-paced', isCorrect: true },
                { id: 'B', text: 'confusing' },
                { id: 'C', text: 'slow' },
                { id: 'D', text: 'amazing' }
            ],
            explanation: "<b>Ms. Mai An gi·∫£i th√≠ch:</b><br>- <b>Ng·ªØ c·∫£nh:</b> 'The story moves at dizzying speed...' (C√¢u chuy·ªán di chuy·ªÉn v·ªõi t·ªëc ƒë·ªô dizzying...). T·ª´ c√¢u tr∆∞·ªõc t√°c gi·∫£ ƒë√£ nh·∫Øc t·ªõi 'fast-moving' (di chuy·ªÉn nhanh).<br>- V·∫≠y 'dizzying' (ch√≥ng m·∫∑t) ·ªü ƒë√¢y ƒëang mi√™u t·∫£ m·ªôt nh·ªãp ƒë·ªô di·ªÖn bi·∫øn c·ª±c k·ª≥ nhanh ch·ªõp nho√°ng. ƒê·ªìng nghƒ©a g·∫ßn nh·∫•t l√† <b>'fast-paced'</b> (nh·ªãp ƒë·ªô nhanh). Ch·ªçn A."
        },
        {
            id: 'vi5',
            text: "Question 10: Angela Moore complimented Colin Williams for his ______.",
            options: [
                { id: 'A', text: 'acting skills' },
                { id: 'B', text: 'movie lines', isCorrect: true },
                { id: 'C', text: 'costumes' },
                { id: 'D', text: 'scary moments' }
            ],
            explanation: "<b>Ms. Mai An gi·∫£i th√≠ch:</b><br>- <b>D·∫´n ch·ª©ng trong b√†i:</b> 'Chief pirate, British actor Colin Williams, is given all the best, wittiest lines...' (Di·ªÖn vi√™n Colin Williams ƒë∆∞·ª£c giao cho to√†n b·ªô nh·ªØng <b>C√ÇU THO·∫†I</b> hay nh·∫•t, d√≠ d·ªèm nh·∫•t).<br>- T√°c gi·∫£ d√†nh l·ªùi khen ng·ª£i cho nh·ªØng c√¢u tho·∫°i (lines) c·ªßa di·ªÖn vi√™n n√†y. Ch·ªçn B."
        }
    ];

    // Tr·∫°ng th√°i b√†i l√†m
    let score = 0;
    const totalQuestions = allQuestions.length;
    let answeredQuestions = {};

    // --- WEB AUDIO API (T·∫°o √¢m thanh kh√¥ng c·∫ßn file) ---
    const AudioContext = window.AudioContext || window.webkitAudioContext;
    const audioCtx = new AudioContext();

    function playCorrectSound() {
        if(audioCtx.state === 'suspended') audioCtx.resume();
        const osc = audioCtx.createOscillator();
        const gainNode = audioCtx.createGain();
        osc.connect(gainNode);
        gainNode.connect(audioCtx.destination);
        osc.type = 'sine';
        osc.frequency.setValueAtTime(800, audioCtx.currentTime);
        osc.frequency.exponentialRampToValueAtTime(1200, audioCtx.currentTime + 0.1);
        gainNode.gain.setValueAtTime(0.3, audioCtx.currentTime);
        gainNode.gain.exponentialRampToValueAtTime(0.01, audioCtx.currentTime + 0.3);
        osc.start(); osc.stop(audioCtx.currentTime + 0.3);
    }

    function playWrongSound() {
        if(audioCtx.state === 'suspended') audioCtx.resume();
        const osc = audioCtx.createOscillator();
        const gainNode = audioCtx.createGain();
        osc.connect(gainNode);
        gainNode.connect(audioCtx.destination);
        osc.type = 'sawtooth';
        osc.frequency.setValueAtTime(300, audioCtx.currentTime);
        osc.frequency.exponentialRampToValueAtTime(100, audioCtx.currentTime + 0.3);
        gainNode.gain.setValueAtTime(0.3, audioCtx.currentTime);
        gainNode.gain.exponentialRampToValueAtTime(0.01, audioCtx.currentTime + 0.4);
        osc.start(); osc.stop(audioCtx.currentTime + 0.4);
    }

    // --- CONFETTI HI·ªÜU ·ª®NG ---
    function shootConfetti(x, y) {
        const colors = ['#00D26A', '#fdcb6e', '#0984e3', '#00b894', '#ff7675'];
        for(let i=0; i<30; i++) {
            const conf = document.createElement('div');
            conf.className = 'confetti';
            conf.style.left = x + 'px';
            conf.style.top = y + 'px';
            conf.style.backgroundColor = colors[Math.floor(Math.random() * colors.length)];
            // Thay ƒë·ªïi h√¨nh d·∫°ng cho vui nh·ªôn
            if(Math.random() > 0.5) conf.style.borderRadius = '50%';
            
            document.body.appendChild(conf);

            const angle = Math.random() * Math.PI * 2;
            const velocity = 5 + Math.random() * 10;
            let vx = Math.cos(angle) * velocity;
            let vy = Math.sin(angle) * velocity;

            let tick = 0;
            function animate() {
                tick++;
                vx *= 0.95; 
                vy += 0.5; 
                const currentLeft = parseFloat(conf.style.left);
                const currentTop = parseFloat(conf.style.top);
                conf.style.left = (currentLeft + vx) + 'px';
                conf.style.top = (currentTop + vy) + 'px';
                conf.style.transform = `rotate(${tick * 15}deg)`;
                
                if(tick < 50) requestAnimationFrame(animate);
                else conf.remove();
            }
            animate();
        }
    }

    // --- H√ÄM TI·ªÜN √çCH ---
    function shuffleArray(array) {
        for (let i = array.length - 1; i > 0; i--) {
            const j = Math.floor(Math.random() * (i + 1));
            [array[i], array[j]] = [array[j], array[i]];
        }
        return array;
    }

    function toggleTranslation(id) {
        const el = document.getElementById(id);
        el.style.display = el.style.display === 'block' ? 'none' : 'block';
    }

    // --- RENDER GIAO DI·ªÜN B√ÄI T·∫¨P ---
    const exercisePane = document.getElementById('exercise-pane');
    let htmlContent = `<h2 style="color: var(--primary);">B√ÄI T·∫¨P TR·∫ÆC NGHI·ªÜM T∆Ø∆†NG T√ÅC</h2>`;
    
    allQuestions.forEach((q, index) => {
        const shuffledOptions = shuffleArray([...q.options]);
        
        let optionsHtml = '';
        shuffledOptions.forEach(opt => {
            optionsHtml += `<button class="option-btn" onclick="checkMCQ('${q.id}', this, ${opt.isCorrect || false}, event)">
                ${opt.text}
            </button>`;
        });

        htmlContent += `
        <div class="question-card" id="card-${q.id}">
            <div class="q-text">${q.text}</div>
            <div class="options-grid">${optionsHtml}</div>
            <div class="explanation-box" id="exp-${q.id}">${q.explanation}</div>
        </div>`;
        
        // T·∫°o v√°ch ngƒÉn gi·ªØa 2 b√†i
        if(index === 4) {
            htmlContent += `<hr style="border:1px dashed #ccc; margin: 30px 0;">`;
        }
    });

    htmlContent += `<button class="btn-submit" onclick="submitExam()">N·ªòP B√ÄI NH·∫¨N ƒêI·ªÇM!</button>`;
    exercisePane.innerHTML = htmlContent;

    // --- LOGIC X·ª¨ L√ù ƒê√ÅP √ÅN ---
    function checkMCQ(qId, btnElement, isCorrect, event) {
        if(answeredQuestions[qId]) return; // ƒê√£ tr·∫£ l·ªùi r·ªìi th√¨ kho√°
        answeredQuestions[qId] = true;

        const parentGrid = btnElement.parentElement;
        const allBtns = parentGrid.querySelectorAll('.option-btn');
        const expBox = document.getElementById(`exp-${qId}`);

        if(isCorrect) {
            btnElement.classList.add('correct');
            playCorrectSound();
            shootConfetti(event.clientX, event.clientY);
            score++;
        } else {
            btnElement.classList.add('wrong');
            playWrongSound();
        }

        // Hi·ªán ƒë√°p √°n ƒë√∫ng ngay l·∫≠p t·ª©c
        const qData = allQuestions.find(x => x.id === qId);
        const correctText = qData.options.find(x => x.isCorrect).text;
        
        allBtns.forEach(btn => {
            btn.style.pointerEvents = 'none'; // Kho√° c√°c n√∫t
            if(btn.innerText.trim() === correctText) {
                btn.classList.add('correct'); // Highlight n√∫t ƒë√∫ng b·∫±ng m√†u xanh l√°
            }
        });
        
        expBox.classList.add('show');
    }

    // --- LOGIC TIMER ƒê·∫æM NG∆Ø·ª¢C ---
    let timerInterval;
    let timeRemaining = 10 * 60; // 10 ph√∫t
    let isTimerRunning = false;

    function formatTime(seconds) {
        const m = Math.floor(seconds / 60);
        const s = seconds % 60;
        return `${m < 10 ? '0':''}${m}:${s < 10 ? '0':''}${s}`;
    }

    function toggleTimer() {
        const btn = document.getElementById('btn-timer-control');
        const display = document.getElementById('timer');

        if(isTimerRunning) {
            clearInterval(timerInterval);
            btn.innerText = "TI·∫æP T·ª§C B√ÄI THI";
            btn.style.background = "var(--secondary)"; // V√†ng Gold
        } else {
            btn.innerText = "T·∫†M D·ª™NG";
            btn.style.background = "var(--wrong)"; // ƒê·ªè
            
            timerInterval = setInterval(() => {
                timeRemaining--;
                display.innerText = formatTime(timeRemaining);
                
                if(timeRemaining <= 0) {
                    clearInterval(timerInterval);
                    showToast();
                    btn.innerText = "H·∫æT GI·ªú";
                    btn.style.pointerEvents = 'none';
                    btn.style.background = "#636e72";
                }
            }, 1000);
        }
        isTimerRunning = !isTimerRunning;
    }

    function showToast() {
        const toast = document.getElementById('toast');
        toast.innerHTML = "ƒê√£ h·∫øt gi·ªù l√†m b√†i. B·∫°n v·∫´n c√≥ th·ªÉ ti·∫øp t·ª•c l√†m, nh∆∞ng nh·ªõ l√† trong ph√≤ng thi th·∫≠t, b·∫°n ch·ªâ n√™n l√†m m·ªôt b√†i nh∆∞ th·∫ø n√†y trong 10 ph√∫t th√¥i nha.";
        toast.style.display = 'block';
        playWrongSound();
        setTimeout(() => { toast.style.display = 'none'; }, 6000);
    }

    // --- LOGIC N·ªòP B√ÄI ---
    function submitExam() {
        const modal = document.getElementById('result-modal');
        const scoreDisplay = document.getElementById('final-score');
        const feedback = document.getElementById('feedback-msg');

        scoreDisplay.innerText = `${score}/${totalQuestions}`;

        let ratio = score / totalQuestions;
        if(ratio === 1) {
            feedback.innerText = "üéâ C√∫ ƒë√∫p ho√†n h·∫£o! Thuy·ªÅn tr∆∞·ªüng vƒ© ƒë·∫°i c·ªßa m√¥n Ti·∫øng Anh l√† ƒë√¢y! üè¥‚Äç‚ò†Ô∏è";
            shootConfetti(window.innerWidth/2, window.innerHeight/2);
            setTimeout(() => shootConfetti(window.innerWidth/3, window.innerHeight/3), 500);
            setTimeout(() => shootConfetti(window.innerWidth/1.5, window.innerHeight/1.5), 1000);
        } else if(ratio >= 0.8) {
            feedback.innerText = "üåü Qu√° xu·∫•t s·∫Øc! B·∫°n ƒë√£ thu th·∫≠p g·∫ßn ƒë·ªß kho b√°u ki·∫øn th·ª©c r·ªìi! üåü";
        } else if(ratio >= 0.5) {
            feedback.innerText = "üëç Kh√° l·∫Øm! Nh·ªõ ƒë·ªçc k·ªπ gi·∫£i th√≠ch c·ªßa Ms. Mai An ƒë·ªÉ v·ªØng tay ch√®o h∆°n nh√©!";
        } else {
            feedback.innerText = "üí™ S√≥ng to gi√≥ l·ªõn kh√¥ng l√†m n·∫£n l√≤ng thu·ª∑ th·ªß! ƒê·ªçc l·∫°i t·ª´ v·ª±ng v√† th·ª≠ l·∫°i nh√©!";
        }

        modal.style.display = 'flex';
        playCorrectSound();
    }
</script>

</body>
</html>


