<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>B√†i Ki·ªÉm Tra Ti·∫øng Anh - Ms Mai An ULIS</title>
    <link href="https://fonts.googleapis.com/css2?family=Nunito:wght@600;800;900&display=swap" rel="stylesheet">
    <style>
        :root {
            --primary: #8854C0;
            --secondary: #FDCB6E;
            --accent: #00C9A7;
            --correct: #00D26A;
            --correct-shadow: #00a051;
            --wrong: #FF4757;
            --wrong-shadow: #cc3945;
            --btn-bg: #ffffff;
            --btn-shadow: #d1d8e0;
            --text-dark: #2d3436;
        }

        body {
            margin: 0;
            padding: 0;
            font-family: 'Nunito', sans-serif;
            color: var(--text-dark);
            background: linear-gradient(45deg, #8854C0, #FDCB6E, #00C9A7, #ff9ff3);
            background-size: 400% 400%;
            animation: gradientBG 15s ease infinite;
            min-height: 100vh;
            overflow-x: hidden;
            position: relative;
        }

        /* Animated Floating Pattern */
        .pattern-overlay {
            position: fixed;
            top: 0; left: 0; width: 100%; height: 100%;
            pointer-events: none;
            z-index: 0;
            opacity: 0.15;
            background-image: url("data:image/svg+xml,%3Csvg width='60' height='60' viewBox='0 0 60 60' xmlns='http://www.w3.org/2000/svg'%3E%3Cpath d='M30 5l5.5 16.5h17.5l-14 10.5 5.5 16.5-14.5-11-14.5 11 5.5-16.5-14-10.5h17.5z' fill='%23ffffff' fill-rule='evenodd'/%3E%3C/svg%3E");
            animation: floatPattern 60s linear infinite;
        }

        @keyframes gradientBG {
            0% { background-position: 0% 50%; }
            50% { background-position: 100% 50%; }
            100% { background-position: 0% 50%; }
        }

        @keyframes floatPattern {
            0% { background-position: 0 0; }
            100% { background-position: 1000px 1000px; }
        }

        .container {
            position: relative;
            z-index: 1;
            max-width: 800px;
            margin: 0 auto;
            padding: 20px;
        }

        .header-title {
            text-align: center;
            color: white;
            text-shadow: 2px 2px 4px rgba(0,0,0,0.3);
            font-size: 1.5rem;
            margin-bottom: 30px;
            background: rgba(255, 255, 255, 0.2);
            display: inline-block;
            padding: 10px 20px;
            border-radius: 20px;
            backdrop-filter: blur(5px);
            left: 50%;
            transform: translateX(-50%);
            position: relative;
        }

        .card {
            background: white;
            border-radius: 20px;
            padding: 25px;
            margin-bottom: 25px;
            box-shadow: 0 10px 20px rgba(0,0,0,0.1);
            transition: transform 0.3s ease;
        }

        .card:hover {
            transform: translateY(-5px);
        }

        .question-text {
            font-size: 1.2rem;
            font-weight: 800;
            margin-bottom: 20px;
            line-height: 1.5;
        }

        .options-grid {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 15px;
        }

        @media(max-width: 600px) {
            .options-grid { grid-template-columns: 1fr; }
        }

        .btn-option {
            background: var(--btn-bg);
            border: 2px solid #ecf0f1;
            border-radius: 15px;
            padding: 15px;
            font-size: 1.1rem;
            font-family: 'Nunito', sans-serif;
            font-weight: 800;
            color: var(--text-dark);
            cursor: pointer;
            box-shadow: 0 6px 0 var(--btn-shadow);
            transition: all 0.1s ease;
            text-align: left;
            position: relative;
            word-wrap: break-word;
        }

        .btn-option:hover:not(:disabled) {
            transform: translateY(-2px);
            box-shadow: 0 8px 0 var(--btn-shadow);
        }

        .btn-option:active:not(:disabled) {
            transform: translateY(4px);
            box-shadow: 0 2px 0 var(--btn-shadow);
        }

        .btn-option.correct {
            background: var(--correct);
            color: white;
            border-color: var(--correct);
            box-shadow: 0 6px 0 var(--correct-shadow);
        }

        .btn-option.wrong {
            background: var(--wrong);
            color: white;
            border-color: var(--wrong);
            box-shadow: 0 6px 0 var(--wrong-shadow);
        }

        .btn-option:disabled { cursor: not-allowed; }

        .explanation {
            display: none;
            margin-top: 20px;
            background: #f1f2f6;
            border-left: 5px solid var(--accent);
            padding: 15px;
            border-radius: 10px;
            font-size: 1rem;
            line-height: 1.6;
            animation: slideDown 0.4s ease forwards;
        }

        @keyframes slideDown {
            from { opacity: 0; transform: translateY(-10px); }
            to { opacity: 1; transform: translateY(0); }
        }

        .explanation h4 {
            margin-top: 0;
            color: var(--primary);
        }

        .shake { animation: shake 0.4s cubic-bezier(.36,.07,.19,.97) both; }
        
        @keyframes shake {
            10%, 90% { transform: translate3d(-1px, 0, 0); }
            20%, 80% { transform: translate3d(2px, 0, 0); }
            30%, 50%, 70% { transform: translate3d(-4px, 0, 0); }
            40%, 60% { transform: translate3d(4px, 0, 0); }
        }

        /* Error Correction Styles */
        .error-word {
            cursor: pointer;
            text-decoration: underline;
            text-decoration-color: var(--primary);
            text-decoration-thickness: 3px;
            font-weight: 800;
            padding: 2px 5px;
            border-radius: 5px;
            transition: background 0.2s;
        }
        .error-word:hover { background: rgba(136, 84, 192, 0.2); }
        .correction-box { display: none; margin-top: 15px; display: flex; gap: 10px; }
        .input-text { flex: 1; padding: 10px 15px; border: 2px solid var(--primary); border-radius: 15px; font-family: 'Nunito', sans-serif; font-size: 1.1rem; }
        .btn-check { padding: 10px 20px; background: var(--accent); color: white; border: none; border-radius: 15px; font-weight: 800; font-size: 1.1rem; cursor: pointer; box-shadow: 0 4px 0 #00a085; }
        .btn-check:active { transform: translateY(2px); box-shadow: 0 2px 0 #00a085; }

        .submit-container { text-align: center; margin: 40px 0; }
        .btn-submit {
            background: linear-gradient(45deg, #FF9F43, #FF6B6B);
            color: white;
            font-size: 1.5rem;
            font-weight: 900;
            padding: 15px 40px;
            border: none;
            border-radius: 25px;
            cursor: pointer;
            box-shadow: 0 8px 0 #d9534f;
            transition: all 0.2s;
        }
        .btn-submit:active { transform: translateY(5px); box-shadow: 0 3px 0 #d9534f; }

        /* Confetti Canvas */
        #confetti-canvas { position: fixed; top: 0; left: 0; width: 100%; height: 100%; pointer-events: none; z-index: 9999; }
        
        .section-title { color: white; background: rgba(0,0,0,0.3); padding: 5px 15px; border-radius: 10px; display: inline-block; margin-bottom: 15px; font-size: 1.2rem;}
    </style>
</head>
<body>

    <div class="pattern-overlay"></div>
    <canvas id="confetti-canvas"></canvas>

    <div class="container">
        <div class="header-title">‚ú® Ms Mai An ULIS ‚ú®</div>
        <div id="quiz-container"></div>
        <div class="submit-container">
            <button class="btn-submit" onclick="finishQuiz()">N·ªòP B√ÄI!</button>
        </div>
    </div>

    <script>
        // WEB AUDIO API cho √¢m thanh Gamification (Kh√¥ng c·∫ßn file ngo√†i)
        const audioCtx = new (window.AudioContext || window.webkitAudioContext)();
        
        function playSound(type) {
            if (audioCtx.state === 'suspended') audioCtx.resume();
            const oscillator = audioCtx.createOscillator();
            const gainNode = audioCtx.createGain();
            
            oscillator.connect(gainNode);
            gainNode.connect(audioCtx.destination);
            
            if (type === 'correct') {
                // Ti·∫øng "Ding" vui tai
                oscillator.type = 'sine';
                oscillator.frequency.setValueAtTime(523.25, audioCtx.currentTime); // C5
                oscillator.frequency.exponentialRampToValueAtTime(880, audioCtx.currentTime + 0.1); // A5
                gainNode.gain.setValueAtTime(0.5, audioCtx.currentTime);
                gainNode.gain.exponentialRampToValueAtTime(0.01, audioCtx.currentTime + 0.5);
                oscillator.start();
                oscillator.stop(audioCtx.currentTime + 0.5);
            } else {
                // Ti·∫øng "Buzz" (T√©o t√®o t√®o)
                oscillator.type = 'sawtooth';
                oscillator.frequency.setValueAtTime(300, audioCtx.currentTime);
                oscillator.frequency.exponentialRampToValueAtTime(150, audioCtx.currentTime + 0.3);
                gainNode.gain.setValueAtTime(0.3, audioCtx.currentTime);
                gainNode.gain.exponentialRampToValueAtTime(0.01, audioCtx.currentTime + 0.3);
                oscillator.start();
                oscillator.stop(audioCtx.currentTime + 0.3);
            }
        }

        // D·ªÆ LI·ªÜU B√ÄI T·∫¨P & GI·∫¢I TH√çCH SI√äU CHI TI·∫æT
        const quizData = [
            {
                section: "Ex 6: Choose the best answer.",
                id: 37,
                question: "‚ÄúWhat is your favorite TV program?‚Äù - ‚Äú________.‚Äù",
                options: ["A. I like Chelsea best", "B. I like Doraemon best", "C. I like Portugal best", "D. I like The Voice best"],
                correctIndex: 3,
                explain: `<b>B∆∞·ªõc 1:</b> D·ªãch c√¢u h·ªèi: "Ch∆∞∆°ng tr√¨nh truy·ªÅn h√¨nh y√™u th√≠ch c·ªßa b·∫°n l√† g√¨?"<br>
                <b>B∆∞·ªõc 2:</b> D·ªãch ƒë√°p √°n:<br>
                - A. T√¥i th√≠ch ƒë·ªôi Chelsea nh·∫•t.<br>
                - B. T√¥i th√≠ch Doraemon nh·∫•t.<br>
                - C. T√¥i th√≠ch B·ªì ƒê√†o Nha nh·∫•t.<br>
                - D. T√¥i th√≠ch The Voice nh·∫•t.<br>
                <b>B∆∞·ªõc 3:</b> Ch·ªçn D v√¨ "The Voice" l√† t√™n m·ªôt ch∆∞∆°ng tr√¨nh truy·ªÅn h√¨nh th·ª±c t·∫ø √¢m nh·∫°c (TV program).<br>
                <b>B∆∞·ªõc 4:</b> Lo·∫°i A (Chelsea - ƒë·ªôi b√≥ng), C (Portugal - qu·ªëc gia), B (Doraemon - phim ho·∫°t h√¨nh/truy·ªán tranh, kh√¥ng ƒë·∫°i di·ªán s√°t nghƒ©a cho 'TV program' b·∫±ng m·ªôt show truy·ªÅn h√¨nh c·ª• th·ªÉ).`
            },
            {
                section: "",
                id: 38,
                question: "‚ÄúWhat sports are you best at?‚Äù - ‚Äú________.‚Äù",
                options: ["A. Volleyball, I think", "B. I love playing with my school team", "C. I play soccer 3 times a week", "D. I think MU is the best football team in the world."],
                correctIndex: 0,
                explain: `<b>B∆∞·ªõc 1:</b> D·ªãch c√¢u h·ªèi: "M√¥n th·ªÉ thao n√†o b·∫°n gi·ªèi nh·∫•t?" (H·ªèi v·ªÅ T√äN m√¥n th·ªÉ thao).<br>
                <b>B∆∞·ªõc 2:</b> D·ªãch ƒë√°p √°n:<br>
                - A. B√≥ng chuy·ªÅn, t√¥i nghƒ© v·∫≠y.<br>
                - B. T√¥i th√≠ch ch∆°i v·ªõi ƒë·ªôi tuy·ªÉn c·ªßa tr∆∞·ªùng.<br>
                - C. T√¥i ch∆°i b√≥ng ƒë√° 3 l·∫ßn 1 tu·∫ßn.<br>
                - D. T√¥i nghƒ© MU l√† ƒë·ªôi b√≥ng vƒ© ƒë·∫°i nh·∫•t th·∫ø gi·ªõi.<br>
                <b>B∆∞·ªõc 3:</b> Ch·ªçn A v√¨ c√¢u h·ªèi "What sports..." c·∫ßn c√¢u tr·∫£ l·ªùi tr·ª±c ti·∫øp l√† t√™n m·ªôt m√¥n th·ªÉ thao (Volleyball).<br>
                <b>B∆∞·ªõc 4:</b> B sai v√¨ tr·∫£ l·ªùi sai tr·ªçng t√¢m. C sai v√¨ tr·∫£ l·ªùi cho c√¢u h·ªèi "How often..." (T·∫ßn su·∫•t). D sai v√¨ tr·∫£ l·ªùi cho c√¢u h·ªèi quan ƒëi·ªÉm v·ªÅ ƒë·ªôi b√≥ng.`
            },
            {
                section: "",
                id: 39,
                question: "‚ÄúDid you visit any famous places?‚Äù - ‚Äú________.‚Äù",
                options: ["A. Yes, thanks. This holiday isn‚Äôt long enough!", "B. Yes, we visited the Natural History Museum. It‚Äôs the best museum in London!", "C. Yes, you‚Äôre right. It is a very beautiful city. I like it very much.", "D. I heard it is a very big city, isn‚Äôt it?"],
                correctIndex: 1,
                explain: `<b>B∆∞·ªõc 1:</b> D·ªãch c√¢u h·ªèi: "B·∫°n c√≥ ƒë·∫øn thƒÉm ƒë·ªãa ƒëi·ªÉm n·ªïi ti·∫øng n√†o kh√¥ng?" (C√¢u h·ªèi Yes/No ·ªü qu√° kh·ª©).<br>
                <b>B∆∞·ªõc 2:</b> D·ªãch ƒë√°p √°n:<br>
                - A. C√≥, c·∫£m ∆°n. K·ª≥ ngh·ªâ n√†y kh√¥ng ƒë·ªß d√†i!<br>
                - B. C√≥, ch√∫ng t√¥i ƒë√£ thƒÉm B·∫£o t√†ng L·ªãch s·ª≠ T·ª± nhi√™n. ƒê√≥ l√† b·∫£o t√†ng t·ªët nh·∫•t ·ªü London!<br>
                - C. V√¢ng, b·∫°n n√≥i ƒë√∫ng. N√≥ l√† m·ªôt th√†nh ph·ªë r·∫•t ƒë·∫πp...<br>
                - D. T√¥i nghe n√≥i ƒë√≥ l√† m·ªôt th√†nh ph·ªë r·∫•t l·ªõn, ph·∫£i kh√¥ng?<br>
                <b>B∆∞·ªõc 3:</b> Ch·ªçn B v√¨ tr·∫£ l·ªùi ƒë√∫ng tr·ªçng t√¢m c√¢u h·ªèi Yes/No v√† cung c·∫•p th√™m th√¥ng tin v·ªÅ ƒë·ªãa ƒëi·ªÉm ƒë√£ thƒÉm (Natural History Museum).<br>
                <b>B∆∞·ªõc 4:</b> A sai v√¨ "thanks" kh√¥ng h·ª£p ng·ªØ c·∫£nh. C sai v√¨ "you're right" d√πng ƒë·ªÉ ƒë·ªìng t√¨nh, kh√¥ng ph·∫£i tr·∫£ l·ªùi c√¢u h·ªèi "Did you...". D sai v√¨ l·∫°i ƒëi h·ªèi ng∆∞·ª£c l·∫°i ng∆∞·ªùi ta.`
            },
            {
                section: "V. FINDING ERRORS - Ex 7: Find and correct the mistakes.",
                type: "error_correction",
                id: 40,
                question: "People watch races or football matches <u>on</u> sport programs.",
                options: ["People", "watch", "on", "sport programs"],
                correctTarget: "on",
                correctAnswer: "in",
                explain: `<b>B∆∞·ªõc 1:</b> D·ªãch c√¢u: "M·ªçi ng∆∞·ªùi xem c√°c cu·ªôc ƒëua ho·∫∑c c√°c tr·∫≠n b√≥ng ƒë√° trong c√°c ch∆∞∆°ng tr√¨nh th·ªÉ thao."<br>
                <b>B∆∞·ªõc 2 & 3:</b> L·ªói sai ·ªü "on". Ta ph·∫£i d√πng gi·ªõi t·ª´ <b>in</b> cho c√°c ch∆∞∆°ng tr√¨nh/phim ·∫£nh (in a program/in a movie).<br>
                <b>B∆∞·ªõc 4:</b> C√°c t·ª´ c√≤n l·∫°i ho√†n to√†n ƒë√∫ng ng·ªØ ph√°p (People watch - s·ªë nhi·ªÅu; sport programs - danh t·ª´ ƒë·∫øm ƒë∆∞·ª£c s·ªë nhi·ªÅu).`
            },
            {
                section: "",
                type: "error_correction",
                id: 41,
                question: "<u>When</u> did she move to New York City? ‚Äì Because she studied Arts there.",
                options: ["When", "move", "to", "Because"],
                correctTarget: "When",
                correctAnswer: "Why",
                explain: `<b>B∆∞·ªõc 1:</b> D·ªãch c√¢u: "T·∫°i sao c√¥ ·∫•y l·∫°i chuy·ªÉn ƒë·∫øn th√†nh ph·ªë New York? - B·ªüi v√¨ c√¥ ·∫•y h·ªçc Ngh·ªá thu·∫≠t ·ªü ƒë√≥."<br>
                <b>B∆∞·ªõc 2 & 3:</b> L·ªói sai ·ªü "When" (Khi n√†o). V√¨ c√¢u tr·∫£ l·ªùi b·∫Øt ƒë·∫ßu b·∫±ng "Because" (B·ªüi v√¨ - ch·ªâ l√Ω do), n√™n t·ª´ ƒë·ªÉ h·ªèi ph·∫£i l√† <b>Why</b> (T·∫°i sao).<br>
                <b>B∆∞·ªõc 4:</b> C√°c th√†nh ph·∫ßn "move", "to", "Because" ƒë·ªÅu s·ª≠ d·ª•ng ch√≠nh x√°c c·∫•u tr√∫c ng·ªØ ph√°p.`
            },
            {
                section: "",
                type: "error_correction",
                id: 42,
                question: "Do you <u>play</u> yoga at home or in a club?",
                options: ["Do", "play", "at", "or"],
                correctTarget: "play",
                correctAnswer: "do",
                explain: `<b>B∆∞·ªõc 1:</b> D·ªãch c√¢u: "B·∫°n t·∫≠p yoga ·ªü nh√† hay ·ªü c√¢u l·∫°c b·ªô?"<br>
                <b>B∆∞·ªõc 2 & 3:</b> L·ªói sai ·ªü "play". Collocation (S·ª± k·∫øt h·ª£p t·ª´) b·∫Øt bu·ªôc v·ªõi Yoga l√† <b>do yoga</b> (t·∫≠p yoga), kh√¥ng d√πng "play". ("Play" th∆∞·ªùng d√πng cho c√°c m√¥n c√≥ b√≥ng v√† ƒë·ªëi kh√°ng).<br>
                <b>B∆∞·ªõc 4:</b> Tr·ª£ ƒë·ªông t·ª´ "Do you", gi·ªõi t·ª´ "at home", li√™n t·ª´ "or" ƒë·ªÅu chu·∫©n x√°c.`
            },
            {
                section: "",
                type: "error_correction",
                id: 43,
                question: "<u>Does</u> she take part in the marathon last Saturday?",
                options: ["Does", "take part", "in", "last Saturday"],
                correctTarget: "Does",
                correctAnswer: "Did",
                explain: `<b>B∆∞·ªõc 1:</b> D·ªãch c√¢u: "C√¥ ·∫•y c√≥ tham gia cu·ªôc ƒëua marathon v√†o th·ª© B·∫£y tu·∫ßn tr∆∞·ªõc kh√¥ng?"<br>
                <b>B∆∞·ªõc 2 & 3:</b> L·ªói sai ·ªü "Does". D·∫•u hi·ªáu nh·∫≠n bi·∫øt th√¨ Qu√° kh·ª© ƒë∆°n l√† "last Saturday" (th·ª© B·∫£y tu·∫ßn tr∆∞·ªõc), do ƒë√≥ m∆∞·ª£n tr·ª£ ƒë·ªông t·ª´ ph·∫£i l√† <b>Did</b>.<br>
                <b>B∆∞·ªõc 4:</b> "take part in" (tham gia) ·ªü d·∫°ng nguy√™n th·ªÉ do ƒë√£ m∆∞·ª£n tr·ª£ ƒë·ªông t·ª´ l√† ƒë√∫ng. D·∫•u hi·ªáu "last Saturday" l√† chu·∫©n.`
            },
            {
                section: "",
                type: "error_correction",
                id: 44,
                question: "<u>They</u> dog is so friendly. It never barks.",
                options: ["They", "is", "friendly", "never"],
                correctTarget: "They",
                correctAnswer: "Their",
                explain: `<b>B∆∞·ªõc 1:</b> D·ªãch c√¢u: "Con ch√≥ C·ª¶A H·ªå r·∫•t th√¢n thi·ªán. N√≥ kh√¥ng bao gi·ªù s·ªßa."<br>
                <b>B∆∞·ªõc 2 & 3:</b> L·ªói sai ·ªü "They". ·ªû ƒë√¢y ta c·∫ßn m·ªôt T√≠nh t·ª´ s·ªü h·ªØu ƒë·ª©ng tr∆∞·ªõc danh t·ª´ "dog", n√™n "They" (ch·ªß ng·ªØ) ph·∫£i ƒë·ªïi th√†nh <b>Their</b> (c·ªßa h·ªç).<br>
                <b>B∆∞·ªõc 4:</b> "is", "friendly", "never" ƒë·ªÅu ƒë√≥ng ƒë√∫ng vai tr√≤ ng·ªØ ph√°p trong c√¢u.`
            },
            {
                section: "",
                type: "error_correction",
                id: 45,
                question: "He loves cartoons. <u>Her</u> favorite cartoon is ‚ÄúSailor Moon‚Äù.",
                options: ["loves", "Her", "favorite", "is"],
                correctTarget: "Her",
                correctAnswer: "His",
                explain: `<b>B∆∞·ªõc 1:</b> D·ªãch c√¢u: "Anh ·∫•y y√™u phim ho·∫°t h√¨nh. Phim ho·∫°t h√¨nh y√™u th√≠ch C·ª¶A ANH ·∫§Y l√† Th·ªßy th·ªß M·∫∑t trƒÉng."<br>
                <b>B∆∞·ªõc 2 & 3:</b> L·ªói sai ·ªü "Her". Ch·ªß ng·ªØ ·ªü c√¢u tr∆∞·ªõc l√† "He" (Anh ·∫•y - con trai), n√™n t√≠nh t·ª´ s·ªü h·ªØu ·ªü c√¢u sau ph·∫£i l√† <b>His</b> (c·ªßa anh ·∫•y) thay v√¨ "Her" (c·ªßa c√¥ ·∫•y).<br>
                <b>B∆∞·ªõc 4:</b> ƒê·ªông t·ª´ "loves", t√≠nh t·ª´ "favorite", to be "is" chia ƒë√∫ng ng√¥i v√† th√¨.`
            },
            {
                section: "VI. WRITING - Ex 12: Write the second sentence.",
                type: "writing",
                id: 61,
                question: "What‚Äôs your favorite program? (Vi·∫øt l·∫°i d√πng t·ª´: <b>best</b>)",
                correctAnswer: "What program do you like best?",
                explain: `<b>B∆∞·ªõc 1:</b> D·ªãch c√¢u g·ªëc: "Ch∆∞∆°ng tr√¨nh y√™u th√≠ch c·ªßa b·∫°n l√† g√¨?"<br>
                <b>B∆∞·ªõc 2 & 3:</b> C·∫•u tr√∫c t∆∞∆°ng ƒë∆∞∆°ng: <b>What is your favorite + N? = What + N + do you like best?</b> (B·∫°n th√≠ch c√°i g√¨ nh·∫•t).<br>
                <b>B∆∞·ªõc 4:</b> ƒê√°p √°n chu·∫©n: What program do you like best?`
            },
            {
                section: "",
                type: "writing",
                id: 62,
                question: "Jim likes to watch Animal programs because he loves animals. (Vi·∫øt l·∫°i d√πng t·ª´: <b>so</b>)",
                correctAnswer: "Jim loves animals, so he likes to watch Animal programs.",
                explain: `<b>B∆∞·ªõc 1:</b> D·ªãch c√¢u g·ªëc: "Jim th√≠ch xem ch∆∞∆°ng tr√¨nh ƒê·ªông v·∫≠t v√¨ anh ·∫•y y√™u ƒë·ªông v·∫≠t."<br>
                <b>B∆∞·ªõc 2 & 3:</b> Chuy·ªÉn ƒë·ªïi t·ª´ "Because" (B·ªüi v√¨ - ch·ªâ nguy√™n nh√¢n) sang "So" (V√¨ v·∫≠y - ch·ªâ k·∫øt qu·∫£). ƒê·∫£o m·ªánh ƒë·ªÅ nguy√™n nh√¢n l√™n tr∆∞·ªõc: Jim loves animals, v√¨ v·∫≠y (so) anh ·∫•y th√≠ch xem ch∆∞∆°ng tr√¨nh ƒê·ªông v·∫≠t.<br>
                <b>B∆∞·ªõc 4:</b> ƒê√°p √°n: Jim loves animals, so he likes to watch Animal programs. (L∆∞u √Ω d·∫•u ph·∫©y tr∆∞·ªõc so).`
            },
            {
                section: "",
                type: "writing",
                id: 63,
                question: "Don‚Äôt forget to switch off the TV before you go to bed. (Vi·∫øt l·∫°i d√πng t·ª´: <b>remember</b>)",
                correctAnswer: "Remember to switch off the TV before you go to bed.",
                explain: `<b>B∆∞·ªõc 1:</b> D·ªãch c√¢u g·ªëc: "ƒê·ª´ng qu√™n t·∫Øt TV tr∆∞·ªõc khi ƒëi ng·ªß."<br>
                <b>B∆∞·ªõc 2 & 3:</b> C·∫•u tr√∫c ƒë·ªìng nghƒ©a: <b>Don't forget to V = Remember to V</b> (ƒê·ª´ng qu√™n l√†m g√¨ = H√£y nh·ªõ l√†m g√¨).<br>
                <b>B∆∞·ªõc 4:</b> Ch·ªâ c·∫ßn thay "Don't forget to" b·∫±ng "Remember to", gi·ªØ nguy√™n ph·∫ßn sau.`
            },
            {
                section: "",
                type: "writing",
                id: 64,
                question: "David Beckham plays football very well. (Vi·∫øt l·∫°i d√πng t·ª´: <b>player</b>)",
                correctAnswer: "David Beckham is a very good football player.",
                explain: `<b>B∆∞·ªõc 1:</b> D·ªãch c√¢u g·ªëc: "David Beckham ch∆°i b√≥ng ƒë√° r·∫•t gi·ªèi."<br>
                <b>B∆∞·ªõc 2 & 3:</b> Chuy·ªÉn t·ª´ c·ª•m ƒê·ªông t·ª´ + Tr·∫°ng t·ª´ (plays very well) sang c·ª•m T√≠nh t·ª´ + Danh t·ª´ ch·ªâ ng∆∞·ªùi (is a very good player).<br>
                <b>B∆∞·ªõc 4:</b> ƒê√°p √°n: David Beckham is a very good football player.`
            },
            {
                section: "",
                type: "writing",
                id: 65,
                question: "This TV program is boring. She still watches it every Sunday. (Vi·∫øt l·∫°i d√πng t·ª´: <b>but</b>)",
                correctAnswer: "This TV program is boring, but she still watches it every Sunday.",
                explain: `<b>B∆∞·ªõc 1:</b> D·ªãch c√¢u g·ªëc: "Ch∆∞∆°ng tr√¨nh TV n√†y ch√°n. C√¥ ·∫•y v·∫´n xem n√≥ m·ªói Ch·ªß nh·∫≠t."<br>
                <b>B∆∞·ªõc 2 & 3:</b> Hai m·ªánh ƒë·ªÅ mang √Ω nghƒ©a t∆∞∆°ng ph·∫£n. N·ªëi b·∫±ng li√™n t·ª´ <b>but</b> (nh∆∞ng) ƒë·∫∑t ·ªü gi·ªØa.<br>
                <b>B∆∞·ªõc 4:</b> ƒê√°p √°n: This TV program is boring, but she still watches it every Sunday.`
            },
            {
                section: "",
                type: "writing",
                id: 66,
                question: "That house is his house and this house is my house. (Vi·∫øt l·∫°i d√πng t·ª´: <b>mine</b>)",
                correctAnswer: "That house is his and this house is mine.",
                explain: `<b>B∆∞·ªõc 1:</b> D·ªãch c√¢u g·ªëc: "Ng√¥i nh√† kia l√† nh√† c·ªßa anh ·∫•y v√† ng√¥i nh√† n√†y l√† nh√† c·ªßa t√¥i."<br>
                <b>B∆∞·ªõc 2 & 3:</b> Tr√°nh l·∫∑p l·∫°i t·ª´ "house". D√πng ƒë·∫°i t·ª´ s·ªü h·ªØu: his house -> his (c·ªßa anh ·∫•y); my house -> mine (c·ªßa t√¥i).<br>
                <b>B∆∞·ªõc 4:</b> ƒê√°p √°n r√∫t g·ªçn chu·∫©n: That house is his and this house is mine.`
            },
            {
                section: "Ex 13: Choose the best answer.",
                id: 67,
                question: "My mum went to Sai Gon last month. His mum went to Sai Gon last month, too.",
                options: [
                    "A. My mum and his mum went to Sai Gon last month.",
                    "B. My mum, so his mum went to Sai Gon last month.",
                    "C. My mum or his mum went to Sai Gon last month.",
                    "D. My mum, but his mum went to Sai Gon last month."
                ],
                correctIndex: 0,
                explain: `<b>B∆∞·ªõc 1:</b> D·ªãch c√¢u g·ªëc: "M·∫π t√¥i ƒëi S√†i G√≤n th√°ng tr∆∞·ªõc. M·∫π anh ·∫•y c≈©ng ƒëi S√†i G√≤n th√°ng tr∆∞·ªõc."<br>
                <b>B∆∞·ªõc 2:</b> D·ªãch ƒë√°p √°n: A. M·∫π t√¥i V√Ä m·∫π anh ·∫•y ƒëi SG th√°ng tr∆∞·ªõc; B. M·∫π t√¥i V√å V·∫¨Y m·∫π anh ·∫•y...; C. M·∫π t√¥i HO·∫∂C m·∫π anh ·∫•y...; D. M·∫π t√¥i NH∆ØNG m·∫π anh ·∫•y...<br>
                <b>B∆∞·ªõc 3:</b> Ch·ªçn A v√¨ d√πng li√™n t·ª´ "and" (v√†) n·ªëi 2 ch·ªß ng·ªØ c√πng th·ª±c hi·ªán 1 h√†nh ƒë·ªông, ho√†n to√†n kh·ªõp nghƒ©a c√¢u g·ªëc.<br>
                <b>B∆∞·ªõc 4:</b> B, C, D sai nghƒ©a ho√†n to√†n do d√πng sai li√™n t·ª´ (so, or, but).`
            },
            {
                section: "",
                id: 68,
                question: "Who do you like most in Doraemon?",
                options: [
                    "A. Where character do you like best in Doraemon?",
                    "B. Which character do you like best in Doraemon?",
                    "C. When character do you like best in Doraemon?",
                    "D. Which character does you like best in Doraemon?"
                ],
                correctIndex: 1,
                explain: `<b>B∆∞·ªõc 1:</b> D·ªãch c√¢u g·ªëc: "B·∫°n th√≠ch ai nh·∫•t trong Doraemon?"<br>
                <b>B∆∞·ªõc 2 & 3:</b> C·∫•u tr√∫c t∆∞∆°ng ƒë∆∞∆°ng: Who (Ai) = Which character (Nh√¢n v·∫≠t n√†o). ƒêi v·ªõi ch·ªß ng·ªØ "you" ph·∫£i d√πng tr·ª£ ƒë·ªông t·ª´ "do". -> Ch·ªçn B.<br>
                <b>B∆∞·ªõc 4:</b> A sai (Where - ·ªü ƒë√¢u). C sai (When - khi n√†o). D sai v√¨ m∆∞·ª£n tr·ª£ ƒë·ªông t·ª´ "does" cho ch·ªß ng·ªØ "you".`
            },
            {
                section: "",
                id: 69,
                question: "It‚Äôs good to play some sports like soccer, baseball, basketball after school.",
                options: [
                    "A. You must play some sports like soccer, baseball, basketball after school.",
                    "B. You don‚Äôt need to play some sports like soccer, baseball, basketball after school.",
                    "C. You should plays some sports like soccer, baseball, basketball after school.",
                    "D. You should play some sports like soccer, baseball, basketball after school."
                ],
                correctIndex: 3,
                explain: `<b>B∆∞·ªõc 1:</b> D·ªãch: "Th·∫≠t t·ªët khi ch∆°i v√†i m√¥n th·ªÉ thao nh∆∞ b√≥ng ƒë√°... sau gi·ªù h·ªçc."<br>
                <b>B∆∞·ªõc 2 & 3:</b> C·∫•u tr√∫c khuy√™n b·∫£o: <b>It's good to V = You should V</b> (B·∫°n n√™n...). Sau "should" l√† ƒë·ªông t·ª´ nguy√™n th·ªÉ kh√¥ng chia. -> Ch·ªçn D.<br>
                <b>B∆∞·ªõc 4:</b> A sai (must = b·∫Øt bu·ªôc). B sai (don't need to = kh√¥ng c·∫ßn). C sai ng·ªØ ph√°p v√¨ sau should ƒë·ªông t·ª´ "plays" l·∫°i th√™m 's'.`
            },
            {
                section: "",
                id: 70,
                question: "Hung is putting his feet on the bench. You say ‚Äú_________________‚Äù",
                options: [
                    "A. Do put your feet on the bench.",
                    "B. Don‚Äôt put your feet on the bench.",
                    "C. Doesn‚Äôt put your feet on the bench.",
                    "D. Don‚Äôt to put your feet on the bench."
                ],
                correctIndex: 1,
                explain: `<b>B∆∞·ªõc 1:</b> D·ªãch ng·ªØ c·∫£nh: "H√πng ƒëang g√°c ch√¢n l√™n gh·∫ø ƒë√°. B·∫°n n√≥i..."<br>
                <b>B∆∞·ªõc 2 & 3:</b> C√¢u m·ªánh l·ªánh ph·ªß ƒë·ªãnh (y√™u c·∫ßu ai ƒë·ª´ng l√†m g√¨) c√≥ c·∫•u tr√∫c: <b>Don't + V(nguy√™n th·ªÉ)</b>. -> Ch·ªçn B: "ƒê·ª´ng g√°c ch√¢n l√™n gh·∫ø ƒë√°."<br>
                <b>B∆∞·ªõc 4:</b> A l√† m·ªánh l·ªánh kh·∫≥ng ƒë·ªãnh (h√£y g√°c ch√¢n). C sai v√¨ m·ªánh l·ªánh kh√¥ng d√πng "Doesn't". D sai v√¨ th·ª´a ch·ªØ "to" (Don't to put).`
            },
            {
                section: "",
                id: 71,
                question: "It/ not/ easy/ find/ your way/ a strange city.",
                options: [
                    "A. It not easy to find your way in a strange city.",
                    "B. It is not easy to find your way in a strange city.",
                    "C. Its is not easy to find your way in a strange city.",
                    "D. Its‚Äôs is not easy to find your way in a strange city."
                ],
                correctIndex: 1,
                explain: `<b>B∆∞·ªõc 1:</b> C·∫•u tr√∫c c·∫ßn nh·ªõ: <b>It is (not) + adj + to V</b> (Th·∫≠t (kh√¥ng) d·ªÖ/kh√≥ ƒë·ªÉ l√†m g√¨...).<br>
                <b>B∆∞·ªõc 2 & 3:</b> √Åp d·ª•ng c·∫•u tr√∫c: It is not easy to find... (Kh√¥ng d·ªÖ ƒë·ªÉ t√¨m ƒë∆∞·ªùng ·ªü m·ªôt th√†nh ph·ªë l·∫°). -> Ch·ªçn B.<br>
                <b>B∆∞·ªõc 4:</b> A thi·∫øu to be "is". C sai l·ªói ch√≠nh t·∫£ "Its is". D sai ho√†n to√†n "Its's is".`
            },
            {
                section: "",
                id: 72,
                question: "She/ get up/ early/ everyday/ she/ can/ not/ go/ school/ late",
                options: [
                    "A. She get up early every day, but she can‚Äôt go to school late.",
                    "B. She got up early every day, so she can‚Äôt go to school late.",
                    "C. She gets up early every day, or she can‚Äôt go to school late.",
                    "D. She gets up early every day, so she can‚Äôt go to school late."
                ],
                correctIndex: 3,
                explain: `<b>B∆∞·ªõc 1:</b> D·∫•u hi·ªáu "everyday" -> Th√¨ Hi·ªán t·∫°i ƒë∆°n. Ch·ªß ng·ªØ "She" -> ƒë·ªông t·ª´ "get" ph·∫£i th√™m "s" (gets).<br>
                <b>B∆∞·ªõc 2 & 3:</b> N·ªëi 2 v·∫ø b·∫±ng li√™n t·ª´ ch·ªâ k·∫øt qu·∫£ "so" (C√¥ ·∫•y d·∫≠y s·ªõm m·ªói ng√†y, V√å V·∫¨Y c√¥ ·∫•y kh√¥ng b·ªã ƒëi h·ªçc mu·ªôn). -> Ch·ªçn D.<br>
                <b>B∆∞·ªõc 4:</b> A sai v√¨ "get" kh√¥ng chia. B sai v√¨ "got" chia ·ªü qu√° kh·ª©. C sai v√¨ d√πng li√™n t·ª´ "or" (ho·∫∑c) kh√¥ng h·ª£p nghƒ©a.`
            }
        ];

        let score = 0;
        let answeredQuestions = 0;

        // Shuffle Options Function
        function shuffleOptions(options, correctIndex) {
            let arr = options.map((opt, i) => ({ text: opt, isCorrect: i === correctIndex }));
            for (let i = arr.length - 1; i > 0; i--) {
                const j = Math.floor(Math.random() * (i + 1));
                [arr[i], arr[j]] = [arr[j], arr[i]];
            }
            return arr;
        }

        function renderQuiz() {
            const container = document.getElementById("quiz-container");
            let html = "";
            
            quizData.forEach((q, index) => {
                if(q.section) {
                    html += `<div class="section-title">${q.section}</div>`;
                }

                html += `<div class="card" id="card-${index}">
                    <div class="question-text">C√¢u ${q.id}: ${q.question}</div>`;

                // Render Tr·∫Øc Nghi·ªám ABCD
                if (!q.type) {
                    const shuffled = shuffleOptions(q.options, q.correctIndex);
                    html += `<div class="options-grid">`;
                    shuffled.forEach(opt => {
                        html += `<button class="btn-option" onclick="checkMC(${index}, this, ${opt.isCorrect})">${opt.text}</button>`;
                    });
                    html += `</div>`;
                } 
                // Render T√¨m L·ªói Sai (Error Correction)
                else if (q.type === "error_correction") {
                    html += `<div>Nh·∫•p v√†o t·ª´ b·ªã sai d∆∞·ªõi ƒë√¢y ƒë·ªÉ s·ª≠a: <br><br>`;
                    q.options.forEach(word => {
                        let isTarget = (word === q.correctTarget);
                        html += `<span class="error-word" onclick="selectError(${index}, this, ${isTarget}, '${q.correctAnswer}')">${word}</span> `;
                    });
                    html += `</div>
                        <div class="correction-box" id="corr-box-${index}">
                            <input type="text" class="input-text" id="input-${index}" placeholder="S·ª≠a th√†nh g√¨ ta...?">
                            <button class="btn-check" onclick="checkErrorCorrection(${index}, '${q.correctAnswer}')">Ki·ªÉm Tra!</button>
                        </div>`;
                }
                // Render Vi·∫øt L·∫°i C√¢u (Writing)
                else if (q.type === "writing") {
                    html += `<div class="correction-box" style="display:flex;">
                            <input type="text" class="input-text" id="write-${index}" placeholder="G√µ c√¢u c·ªßa b·∫°n v√†o ƒë√¢y...">
                            <button class="btn-check" onclick="checkWriting(${index})">Ki·ªÉm Tra!</button>
                        </div>`;
                }

                html += `<div class="explanation" id="exp-${index}">
                            <h4>üåü C√¥ Mai An gi·∫£i th√≠ch n√®:</h4>
                            ${q.explain}
                        </div>
                </div>`;
            });
            container.innerHTML = html;
        }

        // Logic Ch·∫•m ƒêi·ªÉm Tr·∫Øc Nghi·ªám
        function checkMC(index, btn, isCorrect) {
            const card = document.getElementById(`card-${index}`);
            const buttons = card.querySelectorAll(".btn-option");
            
            buttons.forEach(b => b.disabled = true);
            
            if (isCorrect) {
                btn.classList.add("correct");
                playSound('correct');
                fireConfetti();
                score++;
            } else {
                btn.classList.add("wrong");
                card.classList.add("shake");
                playSound('wrong');
                // Highlight the correct one
                buttons.forEach(b => {
                    if (quizData[index].options[quizData[index].correctIndex] === b.innerText || b.getAttribute('onclick').includes('true')) {
                        b.style.border = "3px solid var(--correct)";
                    }
                });
            }
            
            document.getElementById(`exp-${index}`).style.display = "block";
            answeredQuestions++;
        }

        // Logic T√¨m L·ªói Sai
        function selectError(index, span, isTarget, correctAns) {
            const card = document.getElementById(`card-${index}`);
            if(card.classList.contains("done")) return;

            if(isTarget) {
                span.style.background = "var(--secondary)";
                document.getElementById(`corr-box-${index}`).style.display = "flex";
            } else {
                card.classList.remove("shake");
                void card.offsetWidth; // trigger reflow
                card.classList.add("shake");
                playSound('wrong');
                span.style.color = "var(--wrong)";
            }
        }

        function checkErrorCorrection(index, correctAns) {
            const input = document.getElementById(`input-${index}`);
            const card = document.getElementById(`card-${index}`);
            let userVal = input.value.trim().toLowerCase();
            
            if(userVal === correctAns.toLowerCase()) {
                input.style.borderColor = "var(--correct)";
                input.style.background = "#e8f8f5";
                playSound('correct');
                fireConfetti();
                score++;
            } else {
                input.style.borderColor = "var(--wrong)";
                input.style.background = "#ffeaea";
                playSound('wrong');
                card.classList.add("shake");
            }
            input.disabled = true;
            card.querySelector(".btn-check").disabled = true;
            card.classList.add("done");
            document.getElementById(`exp-${index}`).style.display = "block";
            answeredQuestions++;
        }

        // Logic Vi·∫øt L·∫°i C√¢u
        function checkWriting(index) {
            const input = document.getElementById(`write-${index}`);
            const card = document.getElementById(`card-${index}`);
            const correctAns = quizData[index].correctAnswer;
            
            // H√†m d·ªçn d·∫πp chu·ªói ƒë·ªÉ ch·∫•m (b·ªè kho·∫£ng tr·∫Øng th·ª´a, b·ªè d·∫•u c√¢u)
            let cleanUser = input.value.trim().toLowerCase().replace(/[.,]/g, "").replace(/\s+/g, " ");
            let cleanCorrect = correctAns.toLowerCase().replace(/[.,]/g, "").replace(/\s+/g, " ");

            if(cleanUser === cleanCorrect) {
                input.style.borderColor = "var(--correct)";
                input.style.background = "#e8f8f5";
                playSound('correct');
                fireConfetti();
                score++;
            } else {
                input.style.borderColor = "var(--wrong)";
                input.style.background = "#ffeaea";
                playSound('wrong');
                card.classList.add("shake");
            }
            input.disabled = true;
            card.querySelector(".btn-check").disabled = true;
            document.getElementById(`exp-${index}`).style.display = "block";
            answeredQuestions++;
        }

        function finishQuiz() {
            let total = quizData.length;
            let percent = Math.round((score / total) * 100);
            let praise = percent > 80 ? "XU·∫§T S·∫ÆC! üéâ Em l√† thi√™n t√†i ti·∫øng Anh!" : 
                         percent > 50 ? "KH√Å L·∫ÆM! üëç C·ªë g·∫Øng th√™m ch√∫t n·ªØa nh√©!" : 
                         "ƒê·ª™NG BU·ªíN! üí™ H·ªçc t√†i thi ph·∫≠n, h√£y xem k·ªπ ph·∫ßn gi·∫£i th√≠ch nh√©!";
            
            alert(`T·ªîNG K·∫æT ƒêI·ªÇM S·ªê\n\nüéØ S·ªë c√¢u ƒë√∫ng: ${score}/${total}\n‚ú® ƒê·∫°t: ${percent}%\n\nL·ªùi ph√™: ${praise}`);
        }

        // --- H·ªÜ TH·ªêNG PH√ÅO GI·∫§Y (CONFETTI) ---
        const canvas = document.getElementById('confetti-canvas');
        const ctx = canvas.getContext('2d');
        canvas.width = window.innerWidth;
        canvas.height = window.innerHeight;

        let confettis = [];
        const colors = ['#fce18a', '#ff726d', '#b48def', '#f4306d'];

        function fireConfetti() {
            for(let i=0; i<50; i++) {
                confettis.push({
                    x: Math.random() * canvas.width,
                    y: Math.random() * canvas.height/2 - canvas.height/2,
                    w: Math.random() * 10 + 5,
                    h: Math.random() * 10 + 5,
                    color: colors[Math.floor(Math.random() * colors.length)],
                    vy: Math.random() * 5 + 2,
                    vx: Math.random() * 4 - 2,
                    rot: Math.random() * 360,
                    rotSpeed: Math.random() * 10 - 5
                });
            }
        }

        function animateConfetti() {
            ctx.clearRect(0, 0, canvas.width, canvas.height);
            for(let i=0; i<confettis.length; i++) {
                let p = confettis[i];
                ctx.save();
                ctx.translate(p.x, p.y);
                ctx.rotate(p.rot * Math.PI / 180);
                ctx.fillStyle = p.color;
                ctx.fillRect(-p.w/2, -p.h/2, p.w, p.h);
                ctx.restore();
                
                p.y += p.vy;
                p.x += p.vx;
                p.rot += p.rotSpeed;
            }
            confettis = confettis.filter(p => p.y < canvas.height);
            requestAnimationFrame(animateConfetti);
        }

        window.addEventListener('resize', () => {
            canvas.width = window.innerWidth;
            canvas.height = window.innerHeight;
        });

        // Kh·ªüi ch·∫°y
        renderQuiz();
        animateConfetti();

    </script>
</body>
</html>

