<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Exercise 11: Present Simple vs Simple Future - Ms Mai An ULIS</title>
    <!-- Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>
    <!-- Google Fonts: Nunito -->
    <link href="https://fonts.googleapis.com/css2?family=Nunito:wght@400;600;700;800;900&display=swap" rel="stylesheet">
    <!-- Confetti Library -->
    <script src="https://cdn.jsdelivr.net/npm/canvas-confetti@1.6.0/dist/confetti.browser.min.js"></script>
    
    <style>
        body {
            font-family: 'Nunito', sans-serif;
            background-color: #f0fdfa; /* Teal-50 */
            background-image: radial-gradient(#ccfbf1 2px, transparent 2px);
            background-size: 30px 30px;
        }

        /* 3D Button Styles */
        .btn-3d {
            transition: all 0.1s;
            border-bottom-width: 6px;
            position: relative;
            top: 0px;
        }
        
        .btn-3d:active {
            border-bottom-width: 0px;
            top: 6px;
        }

        /* Colors for 3D buttons */
        .btn-default {
            background-color: white;
            color: #4b5563;
            border-color: #e5e7eb;
            border-bottom-color: #d1d5db;
        }
        .btn-default:hover {
            background-color: #f9fafb;
            transform: translateY(-2px);
            border-bottom-width: 8px;
            top: -2px;
        }
        .btn-default:active {
            transform: translateY(4px);
            border-bottom-width: 0px;
            top: 4px;
        }

        .btn-correct {
            background-color: #00D26A !important;
            color: white !important;
            border-color: #00b85c !important;
            border-bottom-color: #008f47 !important;
            pointer-events: none;
        }

        .btn-wrong {
            background-color: #FF4757 !important;
            color: white !important;
            border-color: #ff2e40 !important;
            border-bottom-color: #cc1e2e !important;
            animation: shake 0.5s cubic-bezier(.36,.07,.19,.97) both;
            pointer-events: none;
        }

        /* Animations */
        @keyframes shake {
            10%, 90% { transform: translate3d(-1px, 0, 0); }
            20%, 80% { transform: translate3d(2px, 0, 0); }
            30%, 50%, 70% { transform: translate3d(-4px, 0, 0); }
            40%, 60% { transform: translate3d(4px, 0, 0); }
        }

        .fade-in-up {
            animation: fadeInUp 0.5s ease-out forwards;
        }

        @keyframes fadeInUp {
            from {
                opacity: 0;
                transform: translateY(20px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        /* Custom Scrollbar for Explanation */
        .custom-scrollbar::-webkit-scrollbar {
            width: 8px;
        }
        .custom-scrollbar::-webkit-scrollbar-track {
            background: #f1f1f1; 
            border-radius: 4px;
        }
        .custom-scrollbar::-webkit-scrollbar-thumb {
            background: #c4b5fd; 
            border-radius: 4px;
        }
        .custom-scrollbar::-webkit-scrollbar-thumb:hover {
            background: #a78bfa; 
        }

        .primary-gradient-text {
            background: linear-gradient(to right, #8854C0, #00C9A7);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
        }
    </style>
</head>
<body class="min-h-screen flex flex-col items-center justify-center p-4">

    <!-- Header Branding -->
    <header class="w-full max-w-4xl flex justify-between items-center mb-6">
        <div class="flex items-center gap-3 bg-white px-4 py-2 rounded-2xl shadow-lg border-b-4 border-purple-200">
            <div class="w-10 h-10 bg-purple-600 rounded-full flex items-center justify-center text-white font-bold text-xl">M</div>
            <div>
                <h1 class="font-bold text-purple-700 leading-tight">Ms Mai An ULIS</h1>
                <p class="text-xs text-gray-500 font-semibold">Master English Teacher</p>
            </div>
        </div>
        <div class="flex items-center gap-2 bg-white px-4 py-2 rounded-2xl shadow-lg border-b-4 border-teal-200">
            <span class="text-2xl">üèÜ</span>
            <span class="font-bold text-teal-600 text-xl" id="score-display">0/0</span>
        </div>
    </header>

    <!-- Main Quiz Container -->
    <main id="quiz-container" class="w-full max-w-3xl relative perspective-1000">
        
        <!-- Progress Bar -->
        <div class="w-full bg-gray-200 rounded-full h-4 mb-6 border-2 border-white shadow-sm overflow-hidden">
            <div id="progress-bar" class="bg-gradient-to-r from-purple-500 to-teal-400 h-full rounded-full transition-all duration-500 ease-out" style="width: 0%"></div>
        </div>

        <!-- Question Card -->
        <div id="card-content" class="bg-white rounded-3xl shadow-2xl border-4 border-indigo-100 p-6 md:p-8 relative overflow-hidden min-h-[400px]">
            
            <!-- Question Header -->
            <div class="flex justify-between items-start mb-4">
                <span class="bg-purple-100 text-purple-700 px-3 py-1 rounded-lg font-bold text-sm uppercase tracking-wide">Question <span id="q-number">1</span>/20</span>
                <button onclick="toggleHint()" class="text-yellow-500 hover:text-yellow-600 transition-colors" title="Xem g·ª£i √Ω">
                    <svg xmlns="http://www.w3.org/2000/svg" class="h-8 w-8" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9.663 17h4.673M12 3v1m6.364 1.636l-.707.707M21 12h-1M4 12H3m3.343-5.657l-.707-.707m2.828 9.9a5 5 0 117.072 0l-.548.547A3.374 3.374 0 0014 18.469V19a2 2 0 11-4 0v-.531c0-.895-.356-1.754-.988-2.386l-.548-.547z" />
                    </svg>
                </button>
            </div>

            <!-- Question Text -->
            <h2 id="question-text" class="text-xl md:text-2xl font-extrabold text-gray-800 mb-8 leading-relaxed">
                Loading...
            </h2>

            <!-- Options Grid -->
            <div id="options-grid" class="grid grid-cols-1 md:grid-cols-2 gap-4 mb-6">
                <!-- Options will be injected here -->
            </div>

            <!-- Hint Box (Hidden) -->
            <div id="hint-box" class="hidden absolute top-16 right-6 bg-yellow-100 border-l-4 border-yellow-500 p-4 rounded-r shadow-lg max-w-xs z-20 fade-in-up">
                <p class="font-bold text-yellow-800 text-sm">üí° G·ª£i √Ω:</p>
                <p id="hint-text" class="text-yellow-900 text-sm mt-1">...</p>
            </div>

            <!-- Explanation Box (Hidden initially) -->
            <div id="explanation-box" class="hidden mt-6 bg-indigo-50 border-2 border-indigo-200 rounded-xl p-5 fade-in-up">
                <div class="flex items-center gap-2 mb-3">
                    <span class="text-2xl">üë©‚Äçüè´</span>
                    <h3 class="font-bold text-indigo-700 text-lg">C√¥ Mai An gi·∫£i th√≠ch chi ti·∫øt:</h3>
                </div>
                <div id="explanation-content" class="text-gray-700 text-base leading-relaxed whitespace-pre-line custom-scrollbar max-h-60 overflow-y-auto pr-2">
                    <!-- Content goes here -->
                </div>
            </div>

            <!-- Controls -->
            <div class="mt-8 flex justify-end">
                <button id="next-btn" onclick="nextQuestion()" class="hidden btn-3d bg-teal-500 hover:bg-teal-400 text-white font-bold py-3 px-8 rounded-xl text-lg shadow-lg border-b-4 border-teal-700 active:border-b-0 active:translate-y-1">
                    C√¢u ti·∫øp theo ‚ûú
                </button>
                <button id="finish-btn" onclick="finishQuiz()" class="hidden btn-3d bg-purple-600 hover:bg-purple-500 text-white font-bold py-3 px-8 rounded-xl text-lg shadow-lg border-b-4 border-purple-800 active:border-b-0 active:translate-y-1">
                    N·ªôp b√†i & Xem ƒëi·ªÉm üèÅ
                </button>
            </div>
        </div>
    </main>

    <!-- Result Modal -->
    <div id="result-modal" class="fixed inset-0 bg-black bg-opacity-50 z-50 hidden flex items-center justify-center p-4">
        <div class="bg-white rounded-3xl p-8 max-w-md w-full text-center shadow-2xl transform scale-100 animate-bounce-in relative overflow-hidden">
            <div class="absolute top-0 left-0 w-full h-4 bg-gradient-to-r from-purple-500 to-teal-400"></div>
            
            <div class="text-6xl mb-4">üéâ</div>
            <h2 class="text-3xl font-extrabold text-gray-800 mb-2">Ho√†n th√†nh!</h2>
            <p class="text-gray-500 mb-6">B·∫°n ƒë√£ l√†m r·∫•t t·ªët b√†i ki·ªÉm tra n√†y.</p>
            
            <div class="bg-gray-100 rounded-2xl p-6 mb-6">
                <p class="text-sm text-gray-500 uppercase font-bold tracking-wider">T·ªïng ƒëi·ªÉm</p>
                <p id="final-score" class="text-5xl font-black primary-gradient-text mt-2">0/20</p>
            </div>

            <p id="feedback-text" class="text-lg font-bold text-indigo-600 mb-8">Xu·∫•t s·∫Øc qu√° ƒëi! üåü</p>

            <button onclick="location.reload()" class="w-full btn-3d bg-purple-600 hover:bg-purple-500 text-white font-bold py-4 rounded-xl text-xl border-b-4 border-purple-800">
                L√†m l·∫°i b√†i n√†y üîÑ
            </button>
        </div>
    </div>

    <!-- Audio Elements (Generated via JS to avoid external links) -->
    <!-- We will use Web Audio API for cleaner implementation without external dependencies -->

    <script>
        // DATA SOURCE
        const quizData = {
  "questions": [
    {
      "questionNumber": 1,
      "question": "Our flight ______________ (arrive) at 9:30.",
      "answerOptions": [
        { "text": "arrives", "rationale": "‚úÖ Ch√≠nh x√°c!\n\n1. Ph√¢n t√≠ch:\n- arrives (Present Simple): ƒë·∫øn (l·ªãch tr√¨nh)\n- will arrive (Future Simple): s·∫Ω ƒë·∫øn\n\n2. Gi·∫£i th√≠ch: Gi·ªù m√°y bay h·∫° c√°nh (flight) l√† l·ªãch tr√¨nh c·ªë ƒë·ªãnh (timetable) -> D√πng Hi·ªán t·∫°i ƒë∆°n.\n\n3. D·ªãch c√¢u: Chuy·∫øn bay c·ªßa ch√∫ng t√¥i h·∫° c√°nh l√∫c 9:30.", "isCorrect": true },
        { "text": "will arrive", "rationale": "‚ùå Kh√¥ng d√πng 'will' cho l·ªãch tr√¨nh t√†u xe.", "isCorrect": false },
        { "text": "is arriving", "rationale": "‚ùå D√πng ti·∫øp di·ªÖn (ƒëang ƒë·∫øn/s·∫Øp ƒë·∫øn) c≈©ng c√≥ th·ªÉ ƒë√∫ng trong giao ti·∫øp nh∆∞ng v·ªõi gi·ªù gi·∫•c c·ª• th·ªÉ (9:30) trong b√†i t·∫≠p ng·ªØ ph√°p, Hi·ªán t·∫°i ƒë∆°n l√† ƒë√°p √°n chu·∫©n nh·∫•t.", "isCorrect": false },
        { "text": "arrived", "rationale": "‚ùå Qu√° kh·ª©.", "isCorrect": false }
      ],
      "hint": "L·ªãch tr√¨nh m√°y bay c·ªë ƒë·ªãnh."
    },
    {
      "questionNumber": 2,
      "question": "The fashion show ______________ (begin) at 7:30 p.m, so we ______________ (have) time for dinner first.",
      "answerOptions": [
        { "text": "begins / will have", "rationale": "‚úÖ Ch√≠nh x√°c!\n\n1. Ph√¢n t√≠ch:\n- V·∫ø 1: Show di·ªÖn th·ªùi trang c√≥ gi·ªù c·ªë ƒë·ªãnh -> Hi·ªán t·∫°i ƒë∆°n (begins).\n- V·∫ø 2: Suy lu·∫≠n/d·ª± ƒëo√°n k·∫øt qu·∫£ -> T∆∞∆°ng lai ƒë∆°n (will have).\n\n2. D·ªãch c√¢u: Bu·ªïi tr√¨nh di·ªÖn th·ªùi trang b·∫Øt ƒë·∫ßu l√∫c 7:30 t·ªëi, v√¨ v·∫≠y ch√∫ng ta s·∫Ω c√≥ th·ªùi gian ƒÉn t·ªëi tr∆∞·ªõc.", "isCorrect": true },
        { "text": "will begin / have", "rationale": "‚ùå Sai th√¨ v·∫ø 1 (l·ªãch tr√¨nh kh√¥ng d√πng will).", "isCorrect": false },
        { "text": "begins / have", "rationale": "‚ùå Sai th√¨ v·∫ø 2 (ƒë√¢y l√† k·∫øt qu·∫£ d·ª± ki·∫øn trong t∆∞∆°ng lai, d√πng will have hay h∆°n).", "isCorrect": false },
        { "text": "will begin / will have", "rationale": "‚ùå Sai th√¨ v·∫ø 1.", "isCorrect": false }
      ],
      "hint": "V·∫ø 1 l√† l·ªãch tr√¨nh. V·∫ø 2 l√† k·∫øt qu·∫£ trong t∆∞∆°ng lai."
    },
    {
      "questionNumber": 3,
      "question": "George says he ______________ (help) us with the decoration.",
      "answerOptions": [
        { "text": "will help", "rationale": "‚úÖ Ch√≠nh x√°c!\n\n1. Ph√¢n t√≠ch:\n- will help (Future Simple): s·∫Ω gi√∫p\n- helps (Present Simple): gi√∫p (th√≥i quen)\n\n2. Gi·∫£i th√≠ch: ƒê√¢y l√† m·ªôt l·ªùi h·ª©a ho·∫∑c th√¥ng b√°o v·ªÅ √Ω ƒë·ªãnh trong t∆∞∆°ng lai (George says...) -> D√πng T∆∞∆°ng lai ƒë∆°n.\n\n3. D·ªãch c√¢u: George n√≥i anh ·∫•y s·∫Ω gi√∫p ch√∫ng t√¥i ph·∫ßn trang tr√≠.", "isCorrect": true },
        { "text": "helps", "rationale": "‚ùå Sai. Kh√¥ng ph·∫£i th√≥i quen hay l·ªãch tr√¨nh.", "isCorrect": false },
        { "text": "is helping", "rationale": "‚ùå Hi·ªán t·∫°i ti·∫øp di·ªÖn (k·∫ø ho·∫°ch ƒë√£ ƒë·ªãnh s·∫µn) c≈©ng c√≥ th·ªÉ d√πng, nh∆∞ng T∆∞∆°ng lai ƒë∆°n ph·ªï bi·∫øn h∆°n v·ªõi ƒë·ªông t·ª´ 'say' ƒë·ªÉ t∆∞·ªùng thu·∫≠t √Ω ƒë·ªãnh.", "isCorrect": false },
        { "text": "help", "rationale": "‚ùå Sai chia ƒë·ªông t·ª´ (He s·ªë √≠t).", "isCorrect": false }
      ],
      "hint": "L·ªùi h·ª©a ho·∫∑c √Ω ƒë·ªãnh gi√∫p ƒë·ª°."
    },
    {
      "questionNumber": 4,
      "question": "The train ______________ (arrive) at 6:30 in the morning.",
      "answerOptions": [
        { "text": "arrives", "rationale": "‚úÖ Ch√≠nh x√°c!\n\n1. Ph√¢n t√≠ch:\n- arrives (Present Simple)\n- will arrive (Future Simple)\n\n2. Gi·∫£i th√≠ch: L·ªãch t√†u ch·∫°y (timetable) -> D√πng Hi·ªán t·∫°i ƒë∆°n.\n\n3. D·ªãch c√¢u: T√†u ƒë·∫øn l√∫c 6:30 s√°ng.", "isCorrect": true },
        { "text": "will arrive", "rationale": "‚ùå Sai quy t·∫Øc l·ªãch tr√¨nh.", "isCorrect": false },
        { "text": "arrive", "rationale": "‚ùå Sai chia ƒë·ªông t·ª´ (Train s·ªë √≠t).", "isCorrect": false },
        { "text": "arrived", "rationale": "‚ùå Qu√° kh·ª©.", "isCorrect": false }
      ],
      "hint": "L·ªãch t√†u xe c·ªë ƒë·ªãnh."
    },
    {
      "questionNumber": 5,
      "question": "If you are busy today, I ______________ (see) you tomorrow.",
      "answerOptions": [
        { "text": "will see", "rationale": "‚úÖ Ch√≠nh x√°c!\n\n1. Ph√¢n t√≠ch:\n- will see (Future Simple): s·∫Ω g·∫∑p\n- see (Present Simple): g·∫∑p\n\n2. Gi·∫£i th√≠ch: C√¢u ƒëi·ªÅu ki·ªán lo·∫°i 1 (If + Hi·ªán t·∫°i ƒë∆°n, S + Will + V). Di·ªÖn t·∫£ quy·∫øt ƒë·ªãnh ho·∫∑c kh·∫£ nƒÉng trong t∆∞∆°ng lai.\n\n3. D·ªãch c√¢u: N·∫øu h√¥m nay b·∫°n b·∫≠n, t√¥i s·∫Ω g·∫∑p b·∫°n v√†o ng√†y mai.", "isCorrect": true },
        { "text": "see", "rationale": "‚ùå Sai c·∫•u tr√∫c c√¢u ƒëi·ªÅu ki·ªán lo·∫°i 1.", "isCorrect": false },
        { "text": "am seeing", "rationale": "‚ùå √çt d√πng trong ng·ªØ c·∫£nh c√¢u ƒëi·ªÅu ki·ªán n√†y.", "isCorrect": false },
        { "text": "saw", "rationale": "‚ùå Qu√° kh·ª©.", "isCorrect": false }
      ],
      "hint": "C√¢u ƒëi·ªÅu ki·ªán lo·∫°i 1."
    },
    {
      "questionNumber": 6,
      "question": "What time _____________________ (the movie, start) tonight?",
      "answerOptions": [
        { "text": "does the movie start", "rationale": "‚úÖ Ch√≠nh x√°c!\n\n1. Ph√¢n t√≠ch:\n- Does ... start (Present Simple)\n- Will ... start (Future Simple)\n\n2. Gi·∫£i th√≠ch: H·ªèi gi·ªù chi·∫øu phim (l·ªãch tr√¨nh) -> D√πng Hi·ªán t·∫°i ƒë∆°n.\n\n3. D·ªãch c√¢u: B·ªô phim b·∫Øt ƒë·∫ßu l√∫c m·∫•y gi·ªù t·ªëi nay?", "isCorrect": true },
        { "text": "will the movie start", "rationale": "‚ùå Kh√¥ng d√πng will cho l·ªãch tr√¨nh.", "isCorrect": false },
        { "text": "the movie starts", "rationale": "‚ùå Sai c·∫•u tr√∫c c√¢u h·ªèi (thi·∫øu tr·ª£ t·ª´ ƒë·∫£o ng·ªØ).", "isCorrect": false },
        { "text": "is the movie starting", "rationale": "‚ùå Hi·ªán t·∫°i ti·∫øp di·ªÖn c≈©ng c√≥ th·ªÉ d√πng cho t∆∞∆°ng lai g·∫ßn, nh∆∞ng khi h·ªèi gi·ªù gi·∫•c c·ª• th·ªÉ (timetable), hi·ªán t·∫°i ƒë∆°n chu·∫©n x√°c h∆°n.", "isCorrect": false }
      ],
      "hint": "C√¢u h·ªèi v·ªÅ l·ªãch chi·∫øu phim."
    },
    {
      "questionNumber": 7,
      "question": "I think Vietnam ______________ (win) the AFF Cup again.",
      "answerOptions": [
        { "text": "will win", "rationale": "‚úÖ Ch√≠nh x√°c!\n\n1. Ph√¢n t√≠ch:\n- will win (Future Simple): s·∫Ω th·∫Øng\n- wins (Present Simple): th·∫Øng\n\n2. Gi·∫£i th√≠ch: \"I think\" (t√¥i nghƒ©) di·ªÖn t·∫£ d·ª± ƒëo√°n ch·ªß quan -> D√πng T∆∞∆°ng lai ƒë∆°n.\n\n3. D·ªãch c√¢u: T√¥i nghƒ© Vi·ªát Nam s·∫Ω l·∫°i v√¥ ƒë·ªãch AFF Cup.", "isCorrect": true },
        { "text": "wins", "rationale": "‚ùå Sai. Chi·∫øn th·∫Øng gi·∫£i ƒë·∫•u kh√¥ng ph·∫£i l√† l·ªãch tr√¨nh c·ªë ƒë·ªãnh.", "isCorrect": false },
        { "text": "is winning", "rationale": "‚ùå ƒêang th·∫Øng (t·∫°i th·ªùi ƒëi·ªÉm n√≥i), kh√¥ng d√πng cho d·ª± ƒëo√°n t·ªïng qu√°t t∆∞∆°ng lai.", "isCorrect": false },
        { "text": "won", "rationale": "‚ùå Qu√° kh·ª©.", "isCorrect": false }
      ],
      "hint": "D·ª± ƒëo√°n ch·ªß quan (I think)."
    },
    {
      "questionNumber": 8,
      "question": "The exhibition ______________ (open) at 8:00, so I ______________ (meet) you outside at about 7:45.",
      "answerOptions": [
        { "text": "opens / will meet", "rationale": "‚úÖ Ch√≠nh x√°c!\n\n1. Ph√¢n t√≠ch:\n- V·∫ø 1: Gi·ªù m·ªü c·ª≠a tri·ªÉn l√£m l√† l·ªãch tr√¨nh -> Hi·ªán t·∫°i ƒë∆°n (opens).\n- V·∫ø 2: Quy·∫øt ƒë·ªãnh h·∫πn g·∫∑p (ƒë∆∞a ra l·ªùi h·∫πn) -> T∆∞∆°ng lai ƒë∆°n (will meet).\n\n2. D·ªãch c√¢u: Tri·ªÉn l√£m m·ªü c·ª≠a l√∫c 8:00, v√¨ v·∫≠y t√¥i s·∫Ω g·∫∑p b·∫°n b√™n ngo√†i l√∫c kho·∫£ng 7:45.", "isCorrect": true },
        { "text": "will open / meet", "rationale": "‚ùå Sai v·∫ø 1 (l·ªãch tr√¨nh kh√¥ng d√πng will).", "isCorrect": false },
        { "text": "opens / meet", "rationale": "‚ùå Sai v·∫ø 2 (c·∫ßn √Ω nghƒ©a t∆∞∆°ng lai cho cu·ªôc h·∫πn).", "isCorrect": false },
        { "text": "will open / will meet", "rationale": "‚ùå Sai v·∫ø 1.", "isCorrect": false }
      ],
      "hint": "V·∫ø 1: L·ªãch tr√¨nh. V·∫ø 2: L·ªùi h·∫πn/Quy·∫øt ƒë·ªãnh."
    },
    {
      "questionNumber": 9,
      "question": "It ______________ (be) my birthday tomorrow.",
      "answerOptions": [
        { "text": "will be", "rationale": "‚úÖ Ch√≠nh x√°c!\n\n1. Ph√¢n t√≠ch:\n- will be (Future Simple): s·∫Ω l√†\n- is (Present Simple): l√†\n\n2. Gi·∫£i th√≠ch: Di·ªÖn t·∫£ m·ªôt s·ª± vi·ªác hi·ªÉn nhi√™n s·∫Ω x·∫£y ra trong t∆∞∆°ng lai (Future Fact) th∆∞·ªùng d√πng 'will be'.\n\n3. D·ªãch c√¢u: Ng√†y mai s·∫Ω l√† sinh nh·∫≠t t√¥i.", "isCorrect": true },
        { "text": "is", "rationale": "‚ö†Ô∏è Ch·∫•p nh·∫≠n ƒë∆∞·ª£c (coi nh∆∞ l·ªãch c·ªë ƒë·ªãnh), nh∆∞ng 'will be' nh·∫•n m·∫°nh t√≠nh ch·∫•t s·ª± ki·ªán t∆∞∆°ng lai t·ªët h∆°n.", "isCorrect": false },
        { "text": "was", "rationale": "‚ùå Qu√° kh·ª©.", "isCorrect": false },
        { "text": "be", "rationale": "‚ùå Sai ng·ªØ ph√°p.", "isCorrect": false }
      ],
      "hint": "S·ª± th·∫≠t trong t∆∞∆°ng lai."
    },
    {
      "questionNumber": 10,
      "question": "I'm sure you ______________ (enjoy) the film very much.",
      "answerOptions": [
        { "text": "will enjoy", "rationale": "‚úÖ Ch√≠nh x√°c!\n\n1. Ph√¢n t√≠ch:\n- will enjoy (Future Simple): s·∫Ω th√≠ch\n- enjoy (Present Simple): th√≠ch\n\n2. Gi·∫£i th√≠ch: \"I'm sure\" (t√¥i ch·∫Øc ch·∫Øn) l√† c·ª•m t·ª´ ch·ªâ d·ª± ƒëo√°n -> D√πng T∆∞∆°ng lai ƒë∆°n.\n\n3. D·ªãch c√¢u: T√¥i ch·∫Øc ch·∫Øn r·∫±ng b·∫°n s·∫Ω r·∫•t th√≠ch b·ªô phim n√†y.", "isCorrect": true },
        { "text": "enjoy", "rationale": "‚ùå Sai.", "isCorrect": false },
        { "text": "are enjoying", "rationale": "‚ùå Sai.", "isCorrect": false },
        { "text": "enjoyed", "rationale": "‚ùå Qu√° kh·ª©.", "isCorrect": false }
      ],
      "hint": "D·ª± ƒëo√°n (I'm sure)."
    },
    {
      "questionNumber": 11,
      "question": "The yoga course ______________ (begin) on 7th July.",
      "answerOptions": [
        { "text": "begins", "rationale": "‚úÖ Ch√≠nh x√°c!\n\n1. Ph√¢n t√≠ch:\n- begins (Present Simple)\n- will begin (Future Simple)\n\n2. Gi·∫£i th√≠ch: L·ªãch h·ªçc (course schedule) c·ªë ƒë·ªãnh -> D√πng Hi·ªán t·∫°i ƒë∆°n.\n\n3. D·ªãch c√¢u: Kh√≥a h·ªçc yoga b·∫Øt ƒë·∫ßu v√†o ng√†y 7 th√°ng 7.", "isCorrect": true },
        { "text": "will begin", "rationale": "‚ùå L·ªãch tr√¨nh c·ªë ƒë·ªãnh d√πng hi·ªán t·∫°i ƒë∆°n hay h∆°n.", "isCorrect": false },
        { "text": "begin", "rationale": "‚ùå Sai chia ƒë·ªông t·ª´ (Course s·ªë √≠t).", "isCorrect": false },
        { "text": "began", "rationale": "‚ùå Qu√° kh·ª©.", "isCorrect": false }
      ],
      "hint": "L·ªãch khai gi·∫£ng kh√≥a h·ªçc."
    },
    {
      "questionNumber": 12,
      "question": "I think she ______________ (visit) her grandparents tomorrow.",
      "answerOptions": [
        { "text": "will visit", "rationale": "‚úÖ Ch√≠nh x√°c!\n\n1. Ph√¢n t√≠ch:\n- will visit (Future Simple): s·∫Ω thƒÉm\n- visits (Present Simple): thƒÉm\n\n2. Gi·∫£i th√≠ch: \"I think\" (t√¥i nghƒ©) l√† d·ª± ƒëo√°n -> D√πng T∆∞∆°ng lai ƒë∆°n.\n\n3. D·ªãch c√¢u: T√¥i nghƒ© c√¥ ·∫•y s·∫Ω ƒëi thƒÉm √¥ng b√† v√†o ng√†y mai.", "isCorrect": true },
        { "text": "visits", "rationale": "‚ùå Sai. ƒê√¢y kh√¥ng ph·∫£i l·ªãch tr√¨nh c·ªë ƒë·ªãnh.", "isCorrect": false },
        { "text": "visiting", "rationale": "‚ùå Sai ng·ªØ ph√°p (thi·∫øu to be).", "isCorrect": false },
        { "text": "visit", "rationale": "‚ùå Sai ng·ªØ ph√°p.", "isCorrect": false }
      ],
      "hint": "D·ª± ƒëo√°n (I think)."
    },
    {
      "questionNumber": 13,
      "question": "The train ______________ (depart) from platform 5 at 11.30.",
      "answerOptions": [
        { "text": "departs", "rationale": "‚úÖ Ch√≠nh x√°c!\n\n1. Ph√¢n t√≠ch:\n- departs (Present Simple)\n- will depart (Future Simple)\n\n2. Gi·∫£i th√≠ch: L·ªãch t√†u ch·∫°y (timetable) -> D√πng Hi·ªán t·∫°i ƒë∆°n.\n\n3. D·ªãch c√¢u: T√†u kh·ªüi h√†nh t·ª´ s√¢n ga s·ªë 5 l√∫c 11:30.", "isCorrect": true },
        { "text": "will depart", "rationale": "‚ùå Sai quy t·∫Øc l·ªãch tr√¨nh.", "isCorrect": false },
        { "text": "depart", "rationale": "‚ùå Sai chia ƒë·ªông t·ª´ (Train s·ªë √≠t).", "isCorrect": false },
        { "text": "is departing", "rationale": "‚ùå √çt d√πng h∆°n so v·ªõi departs cho l·ªãch c·ªë ƒë·ªãnh.", "isCorrect": false }
      ],
      "hint": "L·ªãch t√†u ch·∫°y."
    },
    {
      "questionNumber": 14,
      "question": "When ______________ the art exhibition ______________? (end)",
      "answerOptions": [
        { "text": "does ... end", "rationale": "‚úÖ Ch√≠nh x√°c!\n\n1. Ph√¢n t√≠ch:\n- Does ... end (Present Simple)\n- Will ... end (Future Simple)\n\n2. Gi·∫£i th√≠ch: H·ªèi v·ªÅ gi·ªù k·∫øt th√∫c c·ªßa tri·ªÉn l√£m (l·ªãch tr√¨nh) -> D√πng Hi·ªán t·∫°i ƒë∆°n.\n\n3. D·ªãch c√¢u: Khi n√†o th√¨ tri·ªÉn l√£m ngh·ªá thu·∫≠t k·∫øt th√∫c?", "isCorrect": true },
        { "text": "will ... end", "rationale": "‚ùå Kh√¥ng d√πng will cho l·ªãch tr√¨nh.", "isCorrect": false },
        { "text": "is ... ending", "rationale": "‚ùå Kh√¥ng chu·∫©n b·∫±ng hi·ªán t·∫°i ƒë∆°n.", "isCorrect": false },
        { "text": "did ... end", "rationale": "‚ùå Qu√° kh·ª©.", "isCorrect": false }
      ],
      "hint": "C√¢u h·ªèi v·ªÅ l·ªãch tr√¨nh s·ª± ki·ªán."
    },
    {
      "questionNumber": 15,
      "question": "My daughter ______________ (be) fifteen next week.",
      "answerOptions": [
        { "text": "will be", "rationale": "‚úÖ Ch√≠nh x√°c!\n\n1. Ph√¢n t√≠ch:\n- will be (Future Simple): s·∫Ω (ch·ªâ tu·ªïi t√°c)\n- is (Present Simple): l√†\n\n2. Gi·∫£i th√≠ch: N√≥i v·ªÅ tu·ªïi t√°c trong t∆∞∆°ng lai (Future Fact) lu√¥n d√πng \"will be\".\n\n3. D·ªãch c√¢u: Con g√°i t√¥i s·∫Ω tr√≤n m∆∞·ªùi lƒÉm tu·ªïi v√†o tu·∫ßn t·ªõi.", "isCorrect": true },
        { "text": "is", "rationale": "‚ùå Sai. Tu·ªïi t√°c t∆∞∆°ng lai kh√¥ng d√πng hi·ªán t·∫°i ƒë∆°n.", "isCorrect": false },
        { "text": "is being", "rationale": "‚ùå Sai.", "isCorrect": false },
        { "text": "be", "rationale": "‚ùå Sai.",
        "isCorrect": false }
      ],
      "hint": "Tu·ªïi t√°c trong t∆∞∆°ng lai lu√¥n d√πng Will."
    },
    {
      "questionNumber": 16,
      "question": "______________ (the plane /take) off at l0 p.m. as usual?",
      "answerOptions": [
        { "text": "Does the plane take", "rationale": "‚úÖ Ch√≠nh x√°c!\n\n1. Ph√¢n t√≠ch:\n- Does ... take (Present Simple)\n- Will ... take (Future Simple)\n\n2. Gi·∫£i th√≠ch: C·ª•m t·ª´ \"as usual\" (nh∆∞ th∆∞·ªùng l·ªá) v√† l·ªãch tr√¨nh m√°y bay -> D√πng Hi·ªán t·∫°i ƒë∆°n.\n\n3. D·ªãch c√¢u: M√°y bay c√≥ c·∫•t c√°nh l√∫c 10 gi·ªù t·ªëi nh∆∞ th∆∞·ªùng l·ªá kh√¥ng?", "isCorrect": true },
        { "text": "Will the plane take", "rationale": "‚ùå Sai quy t·∫Øc l·ªãch tr√¨nh.", "isCorrect": false },
        { "text": "Is the plane taking", "rationale": "‚ùå Sai.", "isCorrect": false },
        { "text": "Did the plane take", "rationale": "‚ùå Qu√° kh·ª©.", "isCorrect": false }
      ],
      "hint": "L·ªãch tr√¨nh m√°y bay."
    },
    {
      "questionNumber": 17,
      "question": "______________ (you/ open) the door for me, please?",
      "answerOptions": [
        { "text": "Will you open", "rationale": "‚úÖ Ch√≠nh x√°c!\n\n1. Ph√¢n t√≠ch:\n- Will you open: B·∫°n s·∫Ω m·ªü... (C√¢u y√™u c·∫ßu/nh·ªù v·∫£)\n- Do you open: B·∫°n c√≥ m·ªü... (H·ªèi th√≥i quen)\n\n2. Gi·∫£i th√≠ch: D√πng \"Will you...\" ƒë·ªÉ ƒë∆∞a ra l·ªùi y√™u c·∫ßu ho·∫∑c nh·ªù v·∫£ l·ªãch s·ª±.\n\n3. D·ªãch c√¢u: B·∫°n vui l√≤ng m·ªü c·ª≠a gi√∫p t√¥i ƒë∆∞·ª£c kh√¥ng?", "isCorrect": true },
        { "text": "Do you open", "rationale": "‚ùå Sai. ƒê√¢y l√† h·ªèi th√≥i quen, kh√¥ng ph·∫£i l·ªùi nh·ªù v·∫£.", "isCorrect": false },
        { "text": "Are you opening", "rationale": "‚ùå Sai.", "isCorrect": false },
        { "text": "Did you open", "rationale": "‚ùå Qu√° kh·ª©.", "isCorrect": false }
      ],
      "hint": "C√¢u ƒë·ªÅ ngh·ªã/nh·ªù v·∫£ d√πng Will."
    },
    {
      "questionNumber": 18,
      "question": "I don't think the new shopping mall ______________ (open) tomorrow.",
      "answerOptions": [
        { "text": "will open", "rationale": "‚úÖ Ch√≠nh x√°c!\n\n1. Ph√¢n t√≠ch:\n- will open (Future Simple)\n- opens (Present Simple)\n\n2. Gi·∫£i th√≠ch: \"I don't think\" (T√¥i kh√¥ng nghƒ©) l√† d·ª± ƒëo√°n ch·ªß quan v·ªÅ vi·ªác x·∫£y ra s·ª± ki·ªán -> D√πng T∆∞∆°ng lai ƒë∆°n.\n\n3. D·ªãch c√¢u: T√¥i kh√¥ng nghƒ© trung t√¢m mua s·∫Øm m·ªõi s·∫Ω m·ªü c·ª≠a v√†o ng√†y mai.", "isCorrect": true },
        { "text": "opens", "rationale": "‚ö†Ô∏è N·∫øu coi ƒë√¢y l√† l·ªãch tr√¨nh ƒë√£ c√¥ng b·ªë th√¨ 'opens' ƒë√∫ng, nh∆∞ng v·ªõi c·ª•m 'I don't think' th√¨ ng∆∞·ªùi n√≥i ƒëang d·ª± ƒëo√°n v·ªÅ kh·∫£ nƒÉng x·∫£y ra h∆°n l√† n√≥i v·ªÅ l·ªãch tr√¨nh.", "isCorrect": false },
        { "text": "open", "rationale": "‚ùå Sai chia ƒë·ªông t·ª´ (Mall s·ªë √≠t).", "isCorrect": false },
        { "text": "opened", "rationale": "‚ùå Qu√° kh·ª©.", "isCorrect": false }
      ],
      "hint": "D·ª± ƒëo√°n (I don't think)."
    },
    {
      "questionNumber": 19,
      "question": "There's no need to hurry. The concert ______________ (begin) at 7 o'clock.",
      "answerOptions": [
        { "text": "begins", "rationale": "‚úÖ Ch√≠nh x√°c!\n\n1. Ph√¢n t√≠ch:\n- begins (Present Simple)\n- will begin (Future Simple)\n\n2. Gi·∫£i th√≠ch: Gi·ªù h√≤a nh·∫°c (Concert) l√† l·ªãch tr√¨nh c·ªë ƒë·ªãnh -> D√πng Hi·ªán t·∫°i ƒë∆°n.\n\n3. D·ªãch c√¢u: Kh√¥ng c·∫ßn ph·∫£i v·ªôi ƒë√¢u. Bu·ªïi h√≤a nh·∫°c b·∫Øt ƒë·∫ßu l√∫c 7 gi·ªù.", "isCorrect": true },
        { "text": "will begin", "rationale": "‚ùå Sai quy t·∫Øc l·ªãch tr√¨nh.", "isCorrect": false },
        { "text": "begin", "rationale": "‚ùå Sai chia ƒë·ªông t·ª´ (Concert s·ªë √≠t).", "isCorrect": false },
        { "text": "is beginning", "rationale": "‚ùå Sai.", "isCorrect": false }
      ],
      "hint": "L·ªãch bi·ªÉu di·ªÖn c·ªë ƒë·ªãnh."
    },
    {
      "questionNumber": 20,
      "question": "The train ______________ (not leave) at 10.15. It ______________ (arrive) at 10.15.",
      "answerOptions": [
        { "text": "doesn't leave / arrives", "rationale": "‚úÖ Ch√≠nh x√°c!\n\n1. Ph√¢n t√≠ch:\n- L·ªãch t√†u (timetable) -> D√πng Hi·ªán t·∫°i ƒë∆°n.\n- Ph·ªß ƒë·ªãnh s·ªë √≠t: doesn't leave.\n- Kh·∫≥ng ƒë·ªãnh s·ªë √≠t: arrives.\n\n2. Gi·∫£i th√≠ch: C·∫£ hai v·∫ø ƒë·ªÅu n√≥i v·ªÅ l·ªãch tr√¨nh t√†u ch·∫°y.\n\n3. D·ªãch c√¢u: T√†u kh√¥ng r·ªùi ƒëi l√∫c 10:15. N√≥ ƒë·∫øn l√∫c 10:15.", "isCorrect": true },
        { "text": "won't leave / will arrive", "rationale": "‚ùå Sai quy t·∫Øc l·ªãch tr√¨nh.", "isCorrect": false },
        { "text": "not leaves / arrives", "rationale": "‚ùå Sai ng·ªØ ph√°p ph·ªß ƒë·ªãnh (thi·∫øu tr·ª£ t·ª´ does).", "isCorrect": false },
        { "text": "don't leave / arrive", "rationale": "‚ùå Sai chia ƒë·ªông t·ª´ (Train s·ªë √≠t).", "isCorrect": false }
      ],
      "hint": "L·ªãch tr√¨nh t√†u xe d√πng Hi·ªán t·∫°i ƒë∆°n."
    }
  ]
};

        // APP LOGIC
        let currentQuestionIndex = 0;
        let score = 0;
        const totalQuestions = quizData.questions.length;
        let answered = false;

        // Sound Synthesis (No external files)
        const audioCtx = new (window.AudioContext || window.webkitAudioContext)();

        function playSound(type) {
            if (audioCtx.state === 'suspended') {
                audioCtx.resume();
            }
            const oscillator = audioCtx.createOscillator();
            const gainNode = audioCtx.createGain();

            oscillator.connect(gainNode);
            gainNode.connect(audioCtx.destination);

            if (type === 'correct') {
                // "Ding" sound - High pitch sine wave
                oscillator.type = 'sine';
                oscillator.frequency.setValueAtTime(500, audioCtx.currentTime);
                oscillator.frequency.exponentialRampToValueAtTime(1000, audioCtx.currentTime + 0.1);
                gainNode.gain.setValueAtTime(0.3, audioCtx.currentTime);
                gainNode.gain.exponentialRampToValueAtTime(0.01, audioCtx.currentTime + 0.5);
                oscillator.start();
                oscillator.stop(audioCtx.currentTime + 0.5);
            } else {
                // "Buzz/Funny Fail" sound - Sawtooth wave dropping pitch "T√©o t√®o t√®o"
                oscillator.type = 'sawtooth';
                oscillator.frequency.setValueAtTime(300, audioCtx.currentTime);
                oscillator.frequency.linearRampToValueAtTime(200, audioCtx.currentTime + 0.15);
                oscillator.frequency.linearRampToValueAtTime(150, audioCtx.currentTime + 0.3);
                
                gainNode.gain.setValueAtTime(0.2, audioCtx.currentTime);
                gainNode.gain.linearRampToValueAtTime(0.01, audioCtx.currentTime + 0.5);
                
                oscillator.start();
                oscillator.stop(audioCtx.currentTime + 0.5);
            }
        }

        // Render Question
        function renderQuestion(index) {
            answered = false;
            const q = quizData.questions[index];
            
            // Update Text
            document.getElementById('q-number').textContent = index + 1;
            document.getElementById('question-text').textContent = q.question;
            document.getElementById('hint-text').textContent = q.hint;
            document.getElementById('hint-box').classList.add('hidden');
            
            // Update Progress
            const progress = ((index) / totalQuestions) * 100;
            document.getElementById('progress-bar').style.width = `${progress}%`;

            // Reset UI
            document.getElementById('explanation-box').classList.add('hidden');
            document.getElementById('next-btn').classList.add('hidden');
            document.getElementById('finish-btn').classList.add('hidden');
            
            // Shuffle Options (Optional: Currently keeping original order for logic)
            const optionsDiv = document.getElementById('options-grid');
            optionsDiv.innerHTML = '';

            q.answerOptions.forEach((opt, idx) => {
                const btn = document.createElement('button');
                btn.className = `btn-3d btn-default w-full p-4 rounded-xl text-lg font-bold text-gray-700 flex items-center justify-between group`;
                btn.innerHTML = `
                    <div class="flex items-center gap-3">
                        <span class="w-8 h-8 rounded-full bg-indigo-100 text-indigo-600 flex items-center justify-center text-sm border-2 border-indigo-200 group-hover:bg-indigo-200 transition-colors">
                            ${String.fromCharCode(65 + idx)}
                        </span>
                        <span>${opt.text}</span>
                    </div>
                `;
                btn.onclick = () => checkAnswer(btn, opt, q);
                optionsDiv.appendChild(btn);
            });
        }

        // Check Answer
        function checkAnswer(btn, option, questionData) {
            if (answered) return;
            answered = true;

            // Find all buttons
            const allBtns = document.querySelectorAll('#options-grid button');

            if (option.isCorrect) {
                // CORRECT
                score++;
                document.getElementById('score-display').textContent = `${score}/${totalQuestions}`;
                btn.classList.remove('btn-default');
                btn.classList.add('btn-correct');
                playSound('correct');
                confetti({
                    particleCount: 100,
                    spread: 70,
                    origin: { y: 0.6 }
                });
            } else {
                // WRONG
                btn.classList.remove('btn-default');
                btn.classList.add('btn-wrong');
                playSound('wrong');
                
                // Highlight correct one
                questionData.answerOptions.forEach((opt, idx) => {
                    if (opt.isCorrect) {
                        allBtns[idx].classList.remove('btn-default');
                        allBtns[idx].classList.add('btn-correct');
                        allBtns[idx].style.opacity = "0.7"; // Dim the correct one slightly if user picked wrong, to focus on the error first
                    }
                });
            }

            // Disable all buttons
            allBtns.forEach(b => b.disabled = true);

            // Show Explanation immediately (Crucial Requirement)
            showExplanation(questionData.answerOptions.find(o => o.isCorrect).rationale);

            // Show Next/Finish button
            if (currentQuestionIndex < totalQuestions - 1) {
                document.getElementById('next-btn').classList.remove('hidden');
            } else {
                document.getElementById('finish-btn').classList.remove('hidden');
                document.getElementById('progress-bar').style.width = '100%';
            }
        }

        function showExplanation(rationaleText) {
            const expBox = document.getElementById('explanation-box');
            const expContent = document.getElementById('explanation-content');
            
            // Format existing rationale (add bolding to keywords)
            let formattedText = rationaleText
                .replace(/‚úÖ/g, '<span class="text-green-600 font-bold text-lg">‚úÖ</span>')
                .replace(/‚ùå/g, '<span class="text-red-500 font-bold">‚ùå</span>')
                .replace(/(\d+\. )/g, '<br><strong class="text-indigo-600">$1</strong>');
            
            // Add custom spacing for "D·ªãch c√¢u" if needed based on input format
            
            expContent.innerHTML = formattedText;
            expBox.classList.remove('hidden');
        }

        function toggleHint() {
            document.getElementById('hint-box').classList.toggle('hidden');
        }

        function nextQuestion() {
            currentQuestionIndex++;
            renderQuestion(currentQuestionIndex);
        }

        function finishQuiz() {
            const modal = document.getElementById('result-modal');
            const finalScoreEl = document.getElementById('final-score');
            const feedbackEl = document.getElementById('feedback-text');

            finalScoreEl.textContent = `${score}/${totalQuestions}`;
            
            const percentage = (score / totalQuestions) * 100;
            if (percentage === 100) {
                feedbackEl.textContent = "Tuy·ªát ƒë·ªânh! Kh√¥ng sai c√¢u n√†o! üåüüëΩ";
                confetti({ particleCount: 200, spread: 100, origin: { y: 0.6 } });
            } else if (percentage >= 80) {
                feedbackEl.textContent = "L√†m t·ªët l·∫Øm! Em r·∫•t th√¥ng minh! üöÄ";
            } else if (percentage >= 50) {
                feedbackEl.textContent = "C·ªë g·∫Øng th√™m ch√∫t n·ªØa nh√©! üí™";
            } else {
                feedbackEl.textContent = "H√£y √¥n t·∫≠p l·∫°i ng·ªØ ph√°p nh√©! üìö";
            }

            modal.classList.remove('hidden');
        }

        // Initialize
        renderQuestion(0);
        document.getElementById('score-display').textContent = `0/${totalQuestions}`;

    </script>
</body>
</html>
