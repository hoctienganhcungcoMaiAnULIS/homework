<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>English Grade 6 - Phonetics & Stress (Unit 7)</title>
    <link href="https://fonts.googleapis.com/css2?family=Nunito:wght@400;700;900&display=swap" rel="stylesheet">
    <script src="https://cdn.jsdelivr.net/npm/canvas-confetti@1.6.0/dist/confetti.browser.min.js"></script>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        :root {
            --primary: #8854C0;
            --secondary: #00C9A7;
            --correct: #00D26A;
            --incorrect: #FF4757;
            --bg-pattern: #f0f4f8;
        }

        body {
            font-family: 'Nunito', sans-serif;
            background-color: var(--bg-pattern);
            background-image: radial-gradient(#8854c033 1px, transparent 1px);
            background-size: 20px 20px;
            color: #2d3436;
            min-height: 100vh;
        }

        .header-small {
            font-size: 0.9rem;
            color: var(--primary);
            font-weight: 700;
            text-transform: uppercase;
            letter-spacing: 1px;
        }

        .quiz-container {
            max-width: 800px;
            margin: 20px auto;
            padding: 20px;
        }

        .card {
            background: white;
            border-radius: 25px;
            box-shadow: 0 10px 0 rgba(0,0,0,0.05);
            padding: 30px;
            margin-bottom: 30px;
            border: 3px solid #e0e0e0;
            transition: transform 0.3s;
        }

        .question-text {
            font-weight: 900;
            font-size: 1.4rem;
            margin-bottom: 20px;
            color: #4834d4;
        }

        .option-btn {
            display: block;
            width: 100%;
            padding: 15px 25px;
            margin-bottom: 12px;
            background: white;
            border: 3px solid #e0e0e0;
            border-radius: 18px;
            font-weight: 700;
            text-align: left;
            font-size: 1.1rem;
            cursor: pointer;
            box-shadow: 0 5px 0 #e0e0e0;
            transition: all 0.2s;
            position: relative;
        }

        .option-btn:hover {
            transform: scale(1.02);
            border-color: var(--primary);
            box-shadow: 0 5px 0 var(--primary);
        }

        .option-btn:active {
            transform: translateY(3px);
            box-shadow: 0 2px 0 var(--primary);
        }

        .option-btn.correct {
            background-color: var(--correct) !important;
            border-color: #00a352 !important;
            box-shadow: 0 5px 0 #00a352 !important;
            color: white;
        }

        .option-btn.incorrect {
            background-color: var(--incorrect) !important;
            border-color: #d63031 !important;
            box-shadow: 0 5px 0 #d63031 !important;
            color: white;
        }

        .explanation-box {
            display: none;
            background: #f1f2f6;
            border-left: 5px solid var(--primary);
            padding: 20px;
            border-radius: 15px;
            margin-top: 20px;
            animation: slideIn 0.4s ease-out;
        }

        @keyframes slideIn {
            from { opacity: 0; transform: translateY(10px); }
            to { opacity: 1; transform: translateY(0); }
        }

        .shake {
            animation: shake 0.5s cubic-bezier(.36,.07,.19,.97) both;
        }

        @keyframes shake {
            10%, 90% { transform: translate3d(-1px, 0, 0); }
            20%, 80% { transform: translate3d(2px, 0, 0); }
            30%, 50%, 70% { transform: translate3d(-4px, 0, 0); }
            40%, 60% { transform: translate3d(4px, 0, 0); }
        }

        .score-summary {
            display: none;
            position: fixed;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            background: white;
            padding: 40px;
            border-radius: 30px;
            box-shadow: 0 20px 50px rgba(0,0,0,0.2);
            z-index: 1000;
            text-align: center;
            width: 90%;
            max-width: 500px;
        }

        .overlay {
            display: none;
            position: fixed;
            top: 0; left: 0; right: 0; bottom: 0;
            background: rgba(0,0,0,0.6);
            z-index: 999;
        }

        .btn-submit {
            background: var(--secondary);
            color: white;
            font-weight: 900;
            padding: 20px 40px;
            border-radius: 20px;
            border: none;
            box-shadow: 0 8px 0 #00a88b;
            cursor: pointer;
            font-size: 1.5rem;
            margin: 40px auto;
            display: block;
        }

        .btn-submit:hover { transform: scale(1.05); }

        u { text-decoration-color: var(--primary); text-decoration-thickness: 2px; }
        
        .glossary-table {
            width: 100%;
            border-collapse: collapse;
            margin-top: 20px;
            border-radius: 15px;
            overflow: hidden;
            box-shadow: 0 5px 15px rgba(0,0,0,0.05);
        }
        
        .glossary-table th { background: var(--primary); color: white; padding: 12px; }
        .glossary-table td { background: white; padding: 10px; border: 1px solid #eee; }

    </style>
</head>
<body>

    <div class="quiz-container">
        <div class="text-center mb-10">
            <p class="header-small">Giáo viên tạo: Ms Mai An ULIS</p>
            <h1 class="text-4xl font-black text-[#8854C0] mt-2">BÀI THI TIẾNG ANH LỚP 6</h1>
            <p class="text-gray-500 font-bold uppercase tracking-widest mt-1">Topic: Television (Phonetics & Stress)</p>
        </div>

        <div id="quiz-content">
            <!-- Questions will be injected here -->
        </div>

        <button onclick="showFinalResult()" class="btn-submit">NỘP BÀI & XEM KẾT QUẢ</button>
    </div>

    <div class="overlay" id="overlay"></div>
    <div class="score-summary" id="score-summary">
        <h2 class="text-3xl font-black mb-4">KẾT QUẢ CỦA BẠN</h2>
        <div class="text-6xl font-black text-primary mb-4" id="final-score">0/20</div>
        <p class="text-xl italic text-gray-600 mb-6" id="encouragement"></p>
        <button onclick="location.reload()" class="bg-gray-200 px-6 py-2 rounded-xl font-bold">LÀM LẠI</button>
    </div>

    <!-- Audio Effects -->
    <audio id="sound-correct" src="https://assets.mixkit.co/active_storage/sfx/2000/2000-preview.mp3"></audio>
    <audio id="sound-incorrect" src="https://assets.mixkit.co/active_storage/sfx/2103/2103-preview.mp3"></audio>

    <script>
        const questions = [
            {
                id: 1,
                type: "abcd",
                q: "Mark the word whose underlined part differs from the other three (Focus: 'ch').",
                options: [
                    "<u>ch</u>annel", "wa<u>tch</u>", "<u>ch</u>ildren", "ma<u>ch</u>ine"
                ],
                correct: 3,
                explanation: {
                    dich: "Chọn từ có phần gạch chân phát âm khác (Âm 'ch').",
                    vocab: [
                        "channel (n): kênh truyền hình",
                        "watch (v): xem",
                        "children (n): trẻ em",
                        "machine (n): máy móc"
                    ],
                    reason: "Đáp án D đúng vì 'ch' trong 'machine' phát âm là /ʃ/ (âm s nặng), trong khi 3 từ còn lại phát âm là /tʃ/ (âm ch mạnh).",
                    whyOthers: "A, B, C đều có âm /tʃ/ phổ biến trong tiếng Anh."
                }
            },
            {
                id: 2,
                type: "abcd",
                q: "Mark the word whose underlined part differs from the other three (Focus: 'ea').",
                options: [
                    "w<u>ea</u>ther", "r<u>ea</u>d", "p<u>ea</u>ce", "t<u>ea</u>cher"
                ],
                correct: 0,
                explanation: {
                    dich: "Chọn từ có phần gạch chân phát âm khác (Âm 'ea').",
                    vocab: [
                        "weather (n): thời tiết",
                        "read (v): đọc",
                        "peace (n): hòa bình",
                        "teacher (n): giáo viên"
                    ],
                    reason: "Đáp án A đúng vì 'ea' phát âm là /e/ (âm e ngắn). Các từ còn lại phát âm là /iː/ (âm i dài).",
                    whyOthers: "B, C, D là các trường hợp 'ea' phổ biến đọc là i dài."
                }
            },
            {
                id: 3,
                type: "abcd",
                q: "Mark the word whose underlined part differs from the other three (Focus: 'th').",
                options: [
                    "<u>th</u>ink", "<u>th</u>ank", "<u>th</u>ey", "<u>th</u>irsty"
                ],
                correct: 2,
                explanation: {
                    dich: "Chọn từ có phần gạch chân phát âm khác (Âm 'th').",
                    vocab: [
                        "think (v): nghĩ",
                        "thank (v): cảm ơn",
                        "they (pronoun): họ",
                        "thirsty (adj): khát nước"
                    ],
                    reason: "Đáp án C đúng vì 'th' trong 'they' là âm hữu thanh /ð/ (rung cổ họng). Các từ còn lại là âm vô thanh /θ/.",
                    whyOthers: "A, B, D là âm /θ/ thường gặp ở đầu các từ nội dung."
                }
            },
            {
                id: 4,
                type: "abcd",
                q: "Mark the word whose underlined part differs from the other three (Focus: 'ow').",
                options: [
                    "sh<u>ow</u>", "kn<u>ow</u>", "h<u>ow</u>", "gr<u>ow</u>"
                ],
                correct: 2,
                explanation: {
                    dich: "Chọn từ có phần gạch chân phát âm khác (Âm 'ow').",
                    vocab: [
                        "show (v): trình diễn",
                        "know (v): biết",
                        "how (adv): như thế nào",
                        "grow (v): lớn lên"
                    ],
                    reason: "Đáp án C đúng vì 'ow' phát âm là /aʊ/ (âm ao). Các từ còn lại phát âm là /əʊ/ (âm âu).",
                    whyOthers: "A, B, D đều vần với nhau âm /əʊ/."
                }
            },
            {
                id: 5,
                type: "abcd",
                q: "Mark the word whose underlined part differs from the other three (Focus: 'o').",
                options: [
                    "vide<u>o</u>", "radi<u>o</u>", "studi<u>o</u>", "p<u>o</u>pular"
                ],
                correct: 3,
                explanation: {
                    dich: "Chọn từ có phần gạch chân phát âm khác (Âm 'o').",
                    vocab: [
                        "video (n): đoạn phim",
                        "radio (n): đài",
                        "studio (n): trường quay",
                        "popular (adj): phổ biến"
                    ],
                    reason: "Đáp án D đúng vì 'o' phát âm là /ɒ/ (âm o ngắn). Các từ còn lại 'o' ở cuối đều phát âm là /əʊ/.",
                    whyOthers: "A, B, C đều kết thúc bằng đuôi /iəʊ/."
                }
            },
            {
                id: 6,
                type: "abcd",
                q: "Mark the word whose underlined part differs from the other three (Focus: '-ed').",
                options: [
                    "watch<u>ed</u>", "help<u>ed</u>", "play<u>ed</u>", "wash<u>ed</u>"
                ],
                correct: 2,
                explanation: {
                    dich: "Chọn từ có phần gạch chân phát âm khác (Đuôi '-ed').",
                    vocab: [
                        "watched (v): đã xem",
                        "helped (v): đã giúp",
                        "played (v): đã chơi",
                        "washed (v): đã rửa"
                    ],
                    reason: "Đáp án C đúng vì 'ed' phát âm là /d/. Các từ còn lại tận cùng là âm vô thanh (ch, p, sh) nên 'ed' phát âm là /t/.",
                    whyOthers: "A, B, D tuân theo quy tắc phát âm 'ed' là /t/ sau các âm gió."
                }
            },
            {
                id: 7,
                type: "abcd",
                q: "Mark the word whose underlined part differs from the other three (Focus: 'qu').",
                options: [
                    "<u>con</u>quer", "<u>qu</u>iet", "<u>qu</u>ick", "<u>qu</u>een"
                ],
                correct: 0,
                explanation: {
                    dich: "Chọn từ có phần gạch chân phát âm khác (Âm 'qu').",
                    vocab: [
                        "conquer (v): chinh phục",
                        "quiet (adj): yên lặng",
                        "quick (adj): nhanh",
                        "queen (n): nữ hoàng"
                    ],
                    reason: "Đáp án A đúng vì 'qu' trong 'conquer' chỉ phát âm là /k/. Các từ còn lại phát âm là /kw/.",
                    whyOthers: "B, C, D có âm /w/ đệm sau âm /k/."
                }
            },
            {
                id: 8,
                type: "abcd",
                q: "Mark the word whose underlined part differs from the other three (Focus: 'x').",
                options: [
                    "e<u>x</u>citing", "e<u>x</u>ample", "e<u>x</u>tra", "e<u>x</u>it"
                ],
                correct: 1,
                explanation: {
                    dich: "Chọn từ có phần gạch chân phát âm khác (Âm 'x').",
                    vocab: [
                        "exciting (adj): thú vị",
                        "example (n): ví dụ",
                        "extra (adj): thêm",
                        "exit (n): lối ra"
                    ],
                    reason: "Đáp án B đúng vì 'x' phát âm là /ɡz/. Các từ còn lại thường phát âm là /ks/.",
                    whyOthers: "Quy tắc: 'x' nằm giữa nguyên âm và trọng âm rơi vào âm sau thường đọc là /gz/."
                }
            },
            {
                id: 9,
                type: "abcd",
                q: "Mark the word whose underlined part differs from the other three (Focus: 'u').",
                options: [
                    "m<u>u</u>sic", "f<u>u</u>n", "st<u>u</u>dy", "l<u>u</u>nch"
                ],
                correct: 0,
                explanation: {
                    dich: "Chọn từ có phần gạch chân phát âm khác (Âm 'u').",
                    vocab: [
                        "music (n): âm nhạc",
                        "fun (n): vui vẻ",
                        "study (v): học",
                        "lunch (n): bữa trưa"
                    ],
                    reason: "Đáp án A đúng vì 'u' phát âm là /juː/. Các từ còn lại phát âm là /ʌ/ (âm á).",
                    whyOthers: "B, C, D đều có âm /ʌ/ ngắn."
                }
            },
            {
                id: 10,
                type: "abcd",
                q: "Mark the word whose underlined part differs from the other three (Focus: 'c').",
                options: [
                    "<u>c</u>inema", "<u>c</u>artoon", "<u>c</u>ity", "<u>c</u>ycle"
                ],
                correct: 1,
                explanation: {
                    dich: "Chọn từ có phần gạch chân phát âm khác (Âm 'c').",
                    vocab: [
                        "cinema (n): rạp phim",
                        "cartoon (n): phim hoạt hình",
                        "city (n): thành phố",
                        "cycle (v): đạp xe"
                    ],
                    reason: "Đáp án B đúng vì 'c' phát âm là /k/. Các từ còn lại phát âm là /s/ do đứng trước 'i, y, e'.",
                    whyOthers: "Quy tắc: C + i/e/y -> /s/; C + a/o/u -> /k/."
                }
            },
            {
                id: 11,
                type: "abcd",
                q: "Mark the word that differs from the other three in the position of primary stress.",
                options: ["channel", "button", "program", "control"],
                correct: 3,
                explanation: {
                    dich: "Chọn từ có trọng âm khác các từ còn lại.",
                    vocab: ["channel: âm 1", "button: âm 1", "program: âm 1", "control: âm 2"],
                    reason: "Đáp án D nhấn âm 2, các từ còn lại nhấn âm 1.",
                    whyOthers: "A, B, C là danh từ 2 âm tiết thường nhấn âm 1."
                }
            },
            {
                id: 12,
                type: "abcd",
                q: "Mark the word that differs from the other three in the position of primary stress.",
                options: ["comedy", "character", "cinema", "entertain"],
                correct: 3,
                explanation: {
                    dich: "Chọn từ có trọng âm khác các từ còn lại.",
                    vocab: ["comedy: âm 1", "character: âm 1", "cinema: âm 1", "entertain: âm 3"],
                    reason: "Đáp án D nhấn âm cuối (âm 3), các từ còn lại nhấn âm 1.",
                    whyOthers: "A, B, C là từ 3 âm tiết nhấn âm 1."
                }
            },
            {
                id: 13,
                type: "abcd",
                q: "Mark the word that differs from the other three in the position of primary stress.",
                options: ["viewer", "actor", "report", "button"],
                correct: 2,
                explanation: {
                    dich: "Chọn từ có trọng âm khác các từ còn lại.",
                    vocab: ["viewer: âm 1", "actor: âm 1", "report (v): âm 2", "button: âm 1"],
                    reason: "Đáp án C nhấn âm 2, các từ còn lại nhấn âm 1.",
                    whyOthers: "A, B, D là danh từ 2 âm tiết nhấn âm 1."
                }
            },
            {
                id: 14,
                type: "abcd",
                q: "Mark the word that differs from the other three in the position of primary stress.",
                options: ["television", "information", "documentary", "electronic"],
                correct: 0,
                explanation: {
                    dich: "Chọn từ có trọng âm khác các từ còn lại.",
                    vocab: ["television: âm 1", "information: âm 3", "documentary: âm 3", "electronic: âm 3"],
                    reason: "Đáp án A nhấn âm 1, các từ còn lại nhấn âm 3.",
                    whyOthers: "B, D tuân theo quy tắc nhấn trước đuôi -tion và -ic."
                }
            },
            {
                id: 15,
                type: "abcd",
                q: "Mark the word that differs from the other three in the position of primary stress.",
                options: ["favorite", "exciting", "popular", "wonderful"],
                correct: 1,
                explanation: {
                    dich: "Chọn từ có trọng âm khác các từ còn lại.",
                    vocab: ["favorite: âm 1", "exciting: âm 2", "popular: âm 1", "wonderful: âm 1"],
                    reason: "Đáp án B nhấn âm 2, các từ còn lại nhấn âm 1.",
                    whyOthers: "A, C, D là tính từ 3 âm tiết nhấn âm 1."
                }
            },
            {
                id: 16,
                type: "abcd",
                q: "Mark the word that differs from the other three in the position of primary stress.",
                options: ["broadcast", "camera", "record (n.)", "remote"],
                correct: 3,
                explanation: {
                    dich: "Chọn từ có trọng âm khác các từ còn lại.",
                    vocab: ["broadcast: âm 1", "camera: âm 1", "record (n): âm 1", "remote: âm 2"],
                    reason: "Đáp án D nhấn âm 2, các từ còn lại nhấn âm 1.",
                    whyOthers: "A, B, C là danh từ/từ ghép nhấn âm đầu."
                }
            },
            {
                id: 17,
                type: "abcd",
                q: "Mark the word that differs from the other three in the position of primary stress.",
                options: ["reporter", "director", "studio", "presenter"],
                correct: 2,
                explanation: {
                    dich: "Chọn từ có trọng âm khác các từ còn lại.",
                    vocab: ["reporter: âm 2", "director: âm 2", "studio: âm 1", "presenter: âm 2"],
                    reason: "Đáp án C nhấn âm 1, các từ còn lại nhấn âm 2.",
                    whyOthers: "A, B, D đều nhấn âm 2."
                }
            },
            {
                id: 18,
                type: "abcd",
                q: "Mark the word that differs from the other three in the position of primary stress.",
                options: ["music", "funny", "movie", "repeat"],
                correct: 3,
                explanation: {
                    dich: "Chọn từ có trọng âm khác các từ còn lại.",
                    vocab: ["music: âm 1", "funny: âm 1", "movie: âm 1", "repeat: âm 2"],
                    reason: "Đáp án D nhấn âm 2, các từ còn lại nhấn âm 1.",
                    whyOthers: "A, B, C là từ 2 âm tiết nhấn âm đầu."
                }
            },
            {
                id: 19,
                type: "abcd",
                q: "Mark the word that differs from the other three in the position of primary stress.",
                options: ["interesting", "adventure", "romantic", "fantastic"],
                correct: 0,
                explanation: {
                    dich: "Chọn từ có trọng âm khác các từ còn lại.",
                    vocab: ["interesting: âm 1", "adventure: âm 2", "romantic: âm 2", "fantastic: âm 2"],
                    reason: "Đáp án A nhấn âm 1, các từ còn lại nhấn âm 2.",
                    whyOthers: "C, D nhấn âm 2 trước đuôi -ic."
                }
            },
            {
                id: 20,
                type: "abcd",
                q: "Mark the word that differs from the other three in the position of primary stress.",
                options: ["volume", "picture", "enjoy", "radio"],
                correct: 2,
                explanation: {
                    dich: "Chọn từ có trọng âm khác các từ còn lại.",
                    vocab: ["volume: âm 1", "picture: âm 1", "enjoy: âm 2", "radio: âm 1"],
                    reason: "Đáp án C nhấn âm 2 (động từ), các từ còn lại nhấn âm 1.",
                    whyOthers: "A, B, D là danh từ 2-3 âm tiết nhấn âm 1."
                }
            }
        ];

        let score = 0;
        let answeredQuestions = new Set();

        function renderQuiz() {
            const container = document.getElementById('quiz-content');
            questions.forEach((q, index) => {
                const card = document.createElement('div');
                card.className = 'card';
                card.id = `card-${index}`;
                
                let optionsHtml = '';
                const labels = ['A', 'B', 'C', 'D'];
                q.options.forEach((opt, i) => {
                    optionsHtml += `
                        <button class="option-btn" onclick="checkAnswer(${index}, ${i}, this)">
                            <span class="mr-2">${labels[i]}.</span> ${opt}
                        </button>
                    `;
                });

                card.innerHTML = `
                    <div class="question-text">Question ${index + 1}: ${q.q}</div>
                    <div class="options-container">${optionsHtml}</div>
                    <div class="explanation-box" id="exp-${index}">
                        <div class="font-bold text-lg mb-2 text-primary">Cô Mai An giải thích:</div>
                        <div class="mb-2"><strong>1. Dịch câu:</strong> ${q.explanation.dich}</div>
                        <div class="mb-2"><strong>2. Phân tích từ vựng:</strong>
                            <ul class="list-disc ml-5">
                                ${q.explanation.vocab.map(v => `<li>${v}</li>`).join('')}
                            </ul>
                        </div>
                        <div class="mb-2"><strong>3. Tại sao đúng:</strong> ${q.explanation.reason}</div>
                        <div><strong>4. Tại sao sai:</strong> ${q.explanation.whyOthers}</div>
                    </div>
                `;
                container.appendChild(card);
            });
        }

        function checkAnswer(qIdx, optIdx, btn) {
            if (answeredQuestions.has(qIdx)) return;
            
            const q = questions[qIdx];
            const isCorrect = optIdx === q.correct;
            const expBox = document.getElementById(`exp-${qIdx}`);
            const card = document.getElementById(`card-${qIdx}`);

            if (isCorrect) {
                score++;
                btn.classList.add('correct');
                playCorrect();
                triggerConfetti();
            } else {
                btn.classList.add('incorrect');
                card.classList.add('shake');
                playIncorrect();
                // Highlight the correct one
                const btns = card.querySelectorAll('.option-btn');
                btns[q.correct].classList.add('correct');
            }

            expBox.style.display = 'block';
            answeredQuestions.add(qIdx);
            
            // Disable all buttons in this card
            const allBtns = card.querySelectorAll('.option-btn');
            allBtns.forEach(b => b.style.cursor = 'default');
        }

        function triggerConfetti() {
            confetti({
                particleCount: 100,
                spread: 70,
                origin: { y: 0.6 },
                colors: ['#8854C0', '#00C9A7', '#00D26A']
            });
        }

        function playCorrect() {
            document.getElementById('sound-correct').currentTime = 0;
            document.getElementById('sound-correct').play().catch(()=>{});
        }

        function playIncorrect() {
            document.getElementById('sound-incorrect').currentTime = 0;
            document.getElementById('sound-incorrect').play().catch(()=>{});
        }

        function showFinalResult() {
            const total = questions.length;
            document.getElementById('final-score').innerText = `${score}/${total}`;
            const encouragement = document.getElementById('encouragement');
            
            if (score === total) encouragement.innerText = "Tuyệt vời quá! Em là một ngôi sao sáng của Ms Mai An!";
            else if (score >= total * 0.8) encouragement.innerText = "Rất tốt! Em chỉ cần cẩn thận một xíu nữa thôi!";
            else if (score >= total * 0.5) encouragement.innerText = "Cố gắng lên nào! Hãy đọc kỹ phần giải thích của cô nhé!";
            else encouragement.innerText = "Đừng buồn nhé, xem lại bài giảng và làm lại lần nữa cùng cô nào!";

            document.getElementById('overlay').style.display = 'block';
            document.getElementById('score-summary').style.display = 'block';
            triggerConfetti();
        }

        window.onload = renderQuiz;
    </script>
</body>
</html>
