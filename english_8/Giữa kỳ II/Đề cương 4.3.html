<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Gamified English Test - Ms Mai An ULIS</title>
    <link href="https://fonts.googleapis.com/css2?family=Quicksand:wght@500;700;900&display=swap" rel="stylesheet">
    <style>
        /* ================= COLOR PALETTE & THEME (DYNAMIC ALGORITHM) ================= */
        :root {
            --primary: #1CB0F6; /* Blooket/Duolingo Blue */
            --primary-shadow: #1480B3;
            --secondary: #58CC02; /* Duolingo Green */
            --secondary-shadow: #46A302;
            --danger: #FF4757;
            --danger-shadow: #C43642;
            --warning: #FFC800;
            --warning-shadow: #D1A300;
            --text-dark: #3C3C3C;
            --bg-light: #F0F8FF;
            --white: #FFFFFF;
            --gray-light: #E5E5E5;
        }

        /* SVG Emoji Background Base */
        body {
            margin: 0;
            padding: 0;
            font-family: 'Quicksand', sans-serif;
            color: var(--text-dark);
            height: 100vh;
            display: flex;
            flex-direction: column;
            overflow: hidden;
            /* Dynamic SVG Background: Mua s·∫Øm (üõí), Thi√™n nhi√™n/R·ª´ng (üå≥), Th·∫£m h·ªça/Sinh t·ªìn (üèïÔ∏è) */
            background: radial-gradient(circle at center, rgba(255, 255, 255, 0.9) 0%, rgba(230, 245, 255, 0.95) 100%), 
                        url('data:image/svg+xml;utf8,<svg width="150" height="150" xmlns="http://www.w3.org/2000/svg"><text x="20" y="40" font-size="24" opacity="0.3">üèïÔ∏è</text><text x="90" y="80" font-size="24" opacity="0.3">üå≥</text><text x="40" y="130" font-size="24" opacity="0.3">üõí</text><text x="110" y="20" font-size="24" opacity="0.3">‚ú®</text></svg>');
        }

        /* ================= TOP CONTROL BAR ================= */
        .top-bar {
            height: 70px;
            background-color: var(--white);
            box-shadow: 0 4px 10px rgba(0,0,0,0.05);
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 0 30px;
            z-index: 10;
            border-bottom: 2px solid var(--gray-light);
        }

        .teacher-title {
            font-size: 16px;
            font-weight: 900;
            color: var(--primary);
            text-transform: uppercase;
            letter-spacing: 1px;
        }

        .timer-container {
            display: flex;
            align-items: center;
            gap: 15px;
        }

        .timer-display {
            font-size: 28px;
            font-weight: 900;
            color: var(--text-dark);
            background: var(--bg-light);
            padding: 5px 20px;
            border-radius: 20px;
            border: 2px solid var(--gray-light);
            min-width: 100px;
            text-align: center;
        }

        .btn {
            padding: 12px 24px;
            font-size: 16px;
            font-weight: 700;
            font-family: 'Quicksand', sans-serif;
            border: none;
            border-radius: 16px;
            cursor: pointer;
            transition: all 0.2s ease;
            text-transform: uppercase;
        }

        .btn-primary {
            background-color: var(--primary);
            color: white;
            box-shadow: 0 5px 0 var(--primary-shadow);
        }
        .btn-primary:active {
            transform: translateY(5px);
            box-shadow: 0 0 0 var(--primary-shadow);
        }

        .btn-secondary {
            background-color: var(--warning);
            color: white;
            box-shadow: 0 5px 0 var(--warning-shadow);
        }
        .btn-secondary:active {
            transform: translateY(5px);
            box-shadow: 0 0 0 var(--warning-shadow);
        }

        /* ================= SPLIT SCREEN LAYOUT ================= */
        .main-container {
            display: flex;
            flex: 1;
            overflow: hidden;
            padding: 20px;
            gap: 20px;
        }

        .left-panel, .right-panel {
            flex: 1;
            background: rgba(255, 255, 255, 0.85);
            backdrop-filter: blur(10px);
            border-radius: 25px;
            border: 3px solid var(--gray-light);
            padding: 30px;
            overflow-y: auto;
            box-shadow: 0 10px 20px rgba(0,0,0,0.05);
        }

        /* T√πy ch·ªânh thanh cu·ªôn (Scrollbar) */
        ::-webkit-scrollbar { width: 10px; }
        ::-webkit-scrollbar-track { background: var(--bg-light); border-radius: 10px; }
        ::-webkit-scrollbar-thumb { background: #BBD2E1; border-radius: 10px; }
        ::-webkit-scrollbar-thumb:hover { background: var(--primary); }

        /* ================= LEFT PANEL: READING & GLOSSARY ================= */
        .passage-card {
            background: white;
            padding: 25px;
            border-radius: 20px;
            box-shadow: 0 6px 0 var(--gray-light);
            margin-bottom: 30px;
            border: 2px solid #E5E5E5;
        }

        .passage-title {
            font-size: 22px;
            font-weight: 900;
            color: var(--primary);
            margin-top: 0;
            border-bottom: 2px dashed var(--primary);
            padding-bottom: 10px;
        }

        .passage-content {
            font-size: 18px;
            line-height: 1.8;
            margin-bottom: 20px;
        }

        .translation-box {
            display: none;
            background: #FFFBEA;
            border-left: 5px solid var(--warning);
            padding: 15px;
            border-radius: 10px;
            margin-top: 15px;
            font-size: 16px;
            color: #555;
            line-height: 1.6;
        }

        .glossary-table {
            width: 100%;
            border-collapse: collapse;
            margin-top: 15px;
            background: white;
            border-radius: 10px;
            overflow: hidden;
            display: none;
        }
        .glossary-table th { background: var(--primary); color: white; padding: 10px; }
        .glossary-table td { padding: 10px; border-bottom: 1px solid #eee; }
        .glossary-table tr:last-child td { border-bottom: none; }

        /* ================= RIGHT PANEL: EXERCISES ================= */
        .question-card {
            background: white;
            padding: 25px;
            border-radius: 20px;
            box-shadow: 0 6px 0 var(--gray-light);
            margin-bottom: 25px;
            border: 2px solid #E5E5E5;
        }

        .question-text {
            font-size: 18px;
            font-weight: 700;
            margin-bottom: 20px;
        }

        .options-grid {
            display: grid;
            grid-template-columns: 1fr;
            gap: 15px;
        }

        .option-btn {
            background: white;
            border: 2px solid var(--gray-light);
            padding: 15px 20px;
            font-size: 16px;
            font-weight: 700;
            font-family: 'Quicksand', sans-serif;
            border-radius: 16px;
            text-align: left;
            cursor: pointer;
            box-shadow: 0 4px 0 var(--gray-light);
            transition: all 0.2s;
            color: var(--text-dark);
        }

        .option-btn:hover:not(:disabled) {
            transform: scale(1.02);
            border-color: var(--primary);
            background: #F2F9FF;
        }

        .option-btn.correct {
            background-color: var(--secondary);
            color: white;
            border-color: var(--secondary-shadow);
            box-shadow: 0 4px 0 var(--secondary-shadow);
        }

        .option-btn.wrong {
            background-color: var(--danger);
            color: white;
            border-color: var(--danger-shadow);
            box-shadow: 0 4px 0 var(--danger-shadow);
        }

        .option-btn:disabled {
            cursor: not-allowed;
            opacity: 0.7;
        }

        .explanation-box {
            display: none;
            background: #F2F9FF;
            border: 2px solid var(--primary);
            padding: 20px;
            border-radius: 15px;
            margin-top: 20px;
            font-size: 16px;
            line-height: 1.6;
            animation: fadeIn 0.5s ease-in-out;
        }
        .explanation-box h4 { margin-top: 0; color: var(--primary); }
        .vocab-list { margin-bottom: 10px; }
        .vocab-list b { color: #d35400; }

        /* ================= ANIMATIONS & EFFECTS ================= */
        @keyframes shake {
            0%, 100% { transform: translateX(0); }
            20%, 60% { transform: translateX(-5px); }
            40%, 80% { transform: translateX(5px); }
        }
        .shake { animation: shake 0.4s; }
        @keyframes fadeIn { from { opacity: 0; transform: translateY(-10px); } to { opacity: 1; transform: translateY(0); } }

        /* ================= MODAL RESULT ================= */
        .modal-overlay {
            position: fixed;
            top: 0; left: 0; width: 100%; height: 100%;
            background: rgba(0,0,0,0.6);
            display: none;
            justify-content: center;
            align-items: center;
            z-index: 1000;
            backdrop-filter: blur(5px);
        }
        .modal-content {
            background: white;
            padding: 40px;
            border-radius: 30px;
            text-align: center;
            max-width: 500px;
            box-shadow: 0 20px 0 rgba(0,0,0,0.1);
            animation: fadeIn 0.5s ease-out;
        }
        .modal-content h1 { font-size: 40px; margin: 0; color: var(--primary); }
        .modal-content .score { font-size: 60px; font-weight: 900; color: var(--secondary); margin: 20px 0; }
        .modal-content p { font-size: 20px; margin-bottom: 30px; }

        #confetti-canvas {
            position: fixed;
            top: 0; left: 0; width: 100%; height: 100%;
            pointer-events: none;
            z-index: 999;
        }
    </style>
</head>
<body>

    <div class="top-bar">
        <div class="teacher-title">üë®‚Äçüè´ Ms Mai An ULIS - Mastery Test</div>
        <div class="timer-container">
            <div class="timer-display" id="timer">10:00</div>
            <button class="btn btn-secondary" id="btn-timer" onclick="toggleTimer()">B·∫ÆT ƒê·∫¶U T√çNH GI·ªú</button>
            <button class="btn btn-primary" onclick="submitTest()">N·ªòP B√ÄI</button>
        </div>
    </div>

    <div class="main-container">
        
        <div class="left-panel">
            
            <div class="passage-card">
                <h3 class="passage-title">Exercise 1: WHAT TO DO DURING DISASTERS üå™Ô∏è</h3>
                <div class="passage-content">
                    - Listen to the news - Stay updated with radio, TV or phone alerts.<br>
                    - Follow evacuation orders - Listen to local news reports and leave (1) _ _ _ _ _ they tell you to leave.<br>
                    - Find a (2) _ _ _ _ _ place - Stay inside your house, in a strong building or an open area.<br>
                    - Have an (3) _ _ _ _ _ - Keep food, water, medicine, and a flashlight.<br>
                    - Stay calm and help - Do not panic and assist others if needed.<br>
                    - (4) _ _ _ _ _ danger - Stay away from flooded areas, weak buildings and power lines.<br>
                    - Ask for help - Call the emergency services if you are in (5) _ _ _ _ _
                </div>
                <button class="btn btn-secondary" onclick="toggleElement('trans1')">B·∫¢N D·ªäCH ƒê·∫¶Y ƒê·ª¶</button>
                <button class="btn btn-primary" onclick="toggleElement('glos1')">B·∫¢NG T·ª™ V·ª∞NG</button>
                
                <div id="trans1" class="translation-box">
                    <b>NH·ªÆNG VI·ªÜC C·∫¶N L√ÄM KHI X·∫¢Y RA TH·∫¢M H·ªåA</b><br>
                    - L·∫Øng nghe tin t·ª©c - C·∫≠p nh·∫≠t th√¥ng tin qua c·∫£nh b√°o tr√™n ƒë√†i ph√°t thanh, TV ho·∫∑c ƒëi·ªán tho·∫°i.<br>
                    - Tu√¢n th·ªß l·ªánh s∆° t√°n - L·∫Øng nghe c√°c b·∫£n tin ƒë·ªãa ph∆∞∆°ng v√† r·ªùi ƒëi <b>n·∫øu</b> h·ªç y√™u c·∫ßu b·∫°n r·ªùi ƒëi.<br>
                    - T√¨m m·ªôt n∆°i <b>an to√†n</b> - ·ªû y√™n trong nh√† b·∫°n, trong m·ªôt t√≤a nh√† ki√™n c·ªë ho·∫∑c m·ªôt khu v·ª±c tr·ªëng tr·∫£i.<br>
                    - Chu·∫©n b·ªã <b>b·ªô d·ª•ng c·ª• kh·∫©n c·∫•p</b> - D·ª± tr·ªØ th·ª©c ƒÉn, n∆∞·ªõc u·ªëng, thu·ªëc men v√† ƒë√®n pin.<br>
                    - Gi·ªØ b√¨nh tƒ©nh v√† gi√∫p ƒë·ª° - Kh√¥ng ho·∫£ng s·ª£ v√† h·ªó tr·ª£ ng∆∞·ªùi kh√°c n·∫øu c·∫ßn.<br>
                    - <b>Tr√°nh xa</b> m·ªëi nguy hi·ªÉm - Tr√°nh xa c√°c khu v·ª±c ng·∫≠p l·ª•t, c√°c t√≤a nh√† y·∫øu v√† ƒë∆∞·ªùng d√¢y ƒëi·ªán.<br>
                    - Y√™u c·∫ßu gi√∫p ƒë·ª° - G·ªçi cho c√°c d·ªãch v·ª• kh·∫©n c·∫•p n·∫øu b·∫°n ƒëang g·∫∑p <b>nguy hi·ªÉm</b>.
                </div>

                <table id="glos1" class="glossary-table">
                    <tr><th>T·ª´ v·ª±ng</th><th>Lo·∫°i t·ª´</th><th>Nghƒ©a ti·∫øng Vi·ªát (CEFR)</th></tr>
                    <tr><td>Disaster</td><td>n</td><td>Th·∫£m h·ªça (B2)</td></tr>
                    <tr><td>Update</td><td>v/n</td><td>C·∫≠p nh·∫≠t (B1)</td></tr>
                    <tr><td>Alert</td><td>n</td><td>C·∫£nh b√°o (B2)</td></tr>
                    <tr><td>Evacuation</td><td>n</td><td>S·ª± s∆° t√°n (C1)</td></tr>
                    <tr><td>Emergency</td><td>n</td><td>Tr∆∞·ªùng h·ª£p kh·∫©n c·∫•p (B1)</td></tr>
                    <tr><td>Kit</td><td>n</td><td>B·ªô d·ª•ng c·ª• (B1)</td></tr>
                    <tr><td>Panic</td><td>v/n</td><td>Ho·∫£ng lo·∫°n (B2)</td></tr>
                    <tr><td>Assist</td><td>v</td><td>H·ªó tr·ª£, gi√∫p ƒë·ª° (B2)</td></tr>
                    <tr><td>Flooded</td><td>adj</td><td>B·ªã ng·∫≠p l·ª•t (B1)</td></tr>
                    <tr><td>Power line</td><td>n</td><td>ƒê∆∞·ªùng d√¢y ƒëi·ªán (B2)</td></tr>
                </table>
            </div>

            <div class="passage-card">
                <h3 class="passage-title">Exercise 4: CUC PHUONG NATIONAL PARK üå≥</h3>
                <div class="passage-content">
                    Cuc Phuong, the first national park in Viet Nam, was officially opened (1) _ _ _ _ _ 1960. It (2) _ _ _ _ _ 160 km south west of Ha Noi spanning Ninh Binh, Hoa Binh and Thanh Hoa provinces. The 200 square kilometer park (3) _ _ _ _ _ tourists and scientists alike. In 2002, nearly 100, 000 visitors (4) _ _ _ _ _ their way to Cuc Phuong. Many come to see the work being done to protect (5) _ _ _ _ _ species. According to scientists, there are about 2, 000 different species of flora and 450 species of fauna.<br><br>
                    Cuc Phuong National Park has many caves. Quen Voi, also part of the park, is where Nguyen Hue's army was stationed (6) _ _ _ _ _ it made its surprise attack on Thang Long and (7) _ _ _ _ _ the Qing invaders in the spring of 1789.<br><br>
                    Cuc Phuong is also (8) _ _ _ _ _ to the Muong ethnic minority, who live mainly on beekeeping and farming.
                </div>
                <p style="font-size:12px; color:gray; font-style:italic;">*L∆∞u √Ω: Theo ƒë·ªÅ b√†i g·ªëc kh√¥ng cung c·∫•p ƒë√°p √°n cho v·ªã tr√≠ (4), ƒë·ªÉ ƒë·∫£m b·∫£o TO√ÄN V·∫∏N D·ªÆ LI·ªÜU, h·ªá th·ªëng gi·ªØ nguy√™n vƒÉn b·∫£n nh∆∞ng s·∫Ω kh√¥ng hi·ªán c√¢u h·ªèi s·ªë 4 b√™n b·∫£ng b√†i t·∫≠p.*</p>
                <button class="btn btn-secondary" onclick="toggleElement('trans4')">B·∫¢N D·ªäCH ƒê·∫¶Y ƒê·ª¶</button>
                <button class="btn btn-primary" onclick="toggleElement('glos4')">B·∫¢NG T·ª™ V·ª∞NG</button>
                
                <div id="trans4" class="translation-box">
                    C√∫c Ph∆∞∆°ng, c√¥ng vi√™n qu·ªëc gia ƒë·∫ßu ti√™n ·ªü Vi·ªát Nam, ƒë∆∞·ª£c ch√≠nh th·ª©c m·ªü c·ª≠a <b>v√†o</b> nƒÉm 1960. N√≥ <b>t·ªça l·∫°c</b> c√°ch H√† N·ªôi 160 km v·ªÅ ph√≠a T√¢y Nam, tr·∫£i d√†i qua c√°c t·ªânh Ninh B√¨nh, H√≤a B√¨nh v√† Thanh H√≥a. Khu b·∫£o t·ªìn r·ªông 200 km vu√¥ng n√†y <b>thu h√∫t</b> c·∫£ kh√°ch du l·ªãch l·∫´n c√°c nh√† khoa h·ªçc. V√†o nƒÉm 2002, g·∫ßn 100.000 du kh√°ch ƒë√£ t√¨m ƒë∆∞·ªùng ƒë·∫øn C√∫c Ph∆∞∆°ng. Nhi·ªÅu ng∆∞·ªùi ƒë·∫øn ƒë·ªÉ xem nh·ªØng c√¥ng vi·ªác ƒëang ƒë∆∞·ª£c th·ª±c hi·ªán nh·∫±m b·∫£o v·ªá c√°c lo√†i <b>c√≥ nguy c∆° tuy·ªát ch·ªßng</b>. Theo c√°c nh√† khoa h·ªçc, c√≥ kho·∫£ng 2.000 lo√†i th·ª±c v·∫≠t v√† 450 lo√†i ƒë·ªông v·∫≠t kh√°c nhau.<br><br>
                    V∆∞·ªùn qu·ªëc gia C√∫c Ph∆∞∆°ng c√≥ r·∫•t nhi·ªÅu hang ƒë·ªông. Qu√®n Voi, c≈©ng l√† m·ªôt ph·∫ßn c·ªßa khu b·∫£o t·ªìn, l√† n∆°i qu√¢n ƒë·ªôi c·ªßa Nguy·ªÖn Hu·ªá ƒë√≥ng qu√¢n <b>tr∆∞·ªõc khi</b> th·ª±c hi·ªán cu·ªôc t·∫•n c√¥ng b·∫•t ng·ªù v√†o ThƒÉng Long v√† <b>ƒë√°nh b·∫°i</b> qu√¢n x√¢m l∆∞·ª£c nh√† Thanh v√†o m√πa xu√¢n nƒÉm 1789.<br><br>
                    C√∫c Ph∆∞∆°ng c≈©ng l√† <b>nh√†/n∆°i c∆∞ ng·ª•</b> c·ªßa d√¢n t·ªôc thi·ªÉu s·ªë ng∆∞·ªùi M∆∞·ªùng, nh·ªØng ng∆∞·ªùi s·ªëng ch·ªß y·∫øu d·ª±a v√†o ngh·ªÅ nu√¥i ong v√† l√†m ru·ªông.
                </div>

                <table id="glos4" class="glossary-table">
                    <tr><th>T·ª´ v·ª±ng</th><th>Lo·∫°i t·ª´</th><th>Nghƒ©a ti·∫øng Vi·ªát (CEFR)</th></tr>
                    <tr><td>Officially</td><td>adv</td><td>M·ªôt c√°ch ch√≠nh th·ª©c (B2)</td></tr>
                    <tr><td>Locate</td><td>v</td><td>T·ªça l·∫°c, ƒë·ªãnh v·ªã (B2)</td></tr>
                    <tr><td>Span</td><td>v</td><td>Tr·∫£i d√†i, b·∫Øc ngang (C1)</td></tr>
                    <tr><td>Attract</td><td>v</td><td>Thu h√∫t (B1)</td></tr>
                    <tr><td>Endangered</td><td>adj</td><td>C√≥ nguy c∆° tuy·ªát ch·ªßng (B2)</td></tr>
                    <tr><td>Flora</td><td>n</td><td>H·ªá th·ª±c v·∫≠t (C1)</td></tr>
                    <tr><td>Fauna</td><td>n</td><td>H·ªá ƒë·ªông v·∫≠t (C1)</td></tr>
                    <tr><td>Station</td><td>v</td><td>ƒê√≥ng qu√¢n, ƒë·∫∑t v·ªã tr√≠ (C1)</td></tr>
                    <tr><td>Defeat</td><td>v</td><td>ƒê√°nh b·∫°i (B2)</td></tr>
                    <tr><td>Invader</td><td>n</td><td>K·∫ª x√¢m l∆∞·ª£c (C1)</td></tr>
                    <tr><td>Ethnic minority</td><td>n</td><td>D√¢n t·ªôc thi·ªÉu s·ªë (B2)</td></tr>
                </table>
            </div>

            <div class="passage-card">
                <h3 class="passage-title">Exercise 5: ONLINE SHOPPING üõí</h3>
                <div class="passage-content">
                    Nowadays, Vietnamese people are now in favor of buying goods from online stores due to their advantages. With Internet access, customers can easily find a wide range of products, including electronic devices, clothes, food and drink, etc. on these shopping platforms. They can spend a lot of time looking for products, comparing their prices among multiple online stores and reading customers' reviews to make a final decision on what they will buy. Online shopping offers many benefits, including lower prices. On special occasions, these online markets provide shoppers with lots of discount codes and items at cheaper prices. Moreover, e-commerce websites attract new customers every day due to its convenience with just a few mouse clicks at home. Customers can purchase anything, at any time, from anywhere without wasting time bargaining like in the traditional stores. This new method of shopping satisfies consumer demand.
                </div>
                <button class="btn btn-secondary" onclick="toggleElement('trans5')">B·∫¢N D·ªäCH ƒê·∫¶Y ƒê·ª¶</button>
                <button class="btn btn-primary" onclick="toggleElement('glos5')">B·∫¢NG T·ª™ V·ª∞NG</button>
                
                <div id="trans5" class="translation-box">
                    Ng√†y nay, ng∆∞·ªùi d√¢n Vi·ªát Nam ƒëang r·∫•t ∆∞a chu·ªông vi·ªác mua s·∫Øm h√†ng h√≥a t·ª´ c√°c c·ª≠a h√†ng tr·ª±c tuy·∫øn nh·ªù v√†o nh·ªØng ∆∞u ƒëi·ªÉm c·ªßa ch√∫ng. C√≥ k·∫øt n·ªëi Internet, kh√°ch h√†ng c√≥ th·ªÉ d·ªÖ d√†ng t√¨m th·∫•y ƒëa d·∫°ng c√°c lo·∫°i s·∫£n ph·∫©m, bao g·ªìm thi·∫øt b·ªã ƒëi·ªán t·ª≠, qu·∫ßn √°o, ƒë·ªì ƒÉn th·ª©c u·ªëng, v.v. tr√™n c√°c n·ªÅn t·∫£ng mua s·∫Øm n√†y. H·ªç c√≥ th·ªÉ d√†nh nhi·ªÅu th·ªùi gian ƒë·ªÉ t√¨m ki·∫øm s·∫£n ph·∫©m, so s√°nh gi√° c·∫£ gi·ªØa nhi·ªÅu c·ª≠a h√†ng tr·ª±c tuy·∫øn v√† ƒë·ªçc ƒë√°nh gi√° c·ªßa kh√°ch h√†ng ƒë·ªÉ ƒë∆∞a ra quy·∫øt ƒë·ªãnh cu·ªëi c√πng v·ªÅ nh·ªØng g√¨ h·ªç s·∫Ω mua. Mua s·∫Øm tr·ª±c tuy·∫øn mang l·∫°i nhi·ªÅu l·ª£i √≠ch, bao g·ªìm gi√° c·∫£ th·∫•p h∆°n. V√†o nh·ªØng d·ªãp ƒë·∫∑c bi·ªát, c√°c khu ch·ª£ tr·ª±c tuy·∫øn n√†y cung c·∫•p cho ng∆∞·ªùi mua s·∫Øm r·∫•t nhi·ªÅu m√£ gi·∫£m gi√° v√† c√°c m·∫∑t h√†ng v·ªõi gi√° r·∫ª h∆°n. H∆°n n·ªØa, c√°c trang web th∆∞∆°ng m·∫°i ƒëi·ªán t·ª≠ thu h√∫t kh√°ch h√†ng m·ªõi m·ªói ng√†y do s·ª± ti·ªán l·ª£i c·ªßa n√≥ ch·ªâ v·ªõi v√†i c√∫ click chu·ªôt t·∫°i nh√†. Kh√°ch h√†ng c√≥ th·ªÉ mua b·∫•t c·ª© th·ª© g√¨, v√†o b·∫•t c·ª© l√∫c n√†o, t·ª´ b·∫•t c·ª© ƒë√¢u m√† kh√¥ng l√£ng ph√≠ th·ªùi gian m·∫∑c c·∫£ nh∆∞ ·ªü c√°c c·ª≠a h√†ng truy·ªÅn th·ªëng. Ph∆∞∆°ng th·ª©c mua s·∫Øm m·ªõi n√†y ƒë√°p ·ª©ng nhu c·∫ßu c·ªßa ng∆∞·ªùi ti√™u d√πng.
                </div>

                <table id="glos5" class="glossary-table">
                    <tr><th>T·ª´ v·ª±ng</th><th>Lo·∫°i t·ª´</th><th>Nghƒ©a ti·∫øng Vi·ªát (CEFR)</th></tr>
                    <tr><td>In favor of</td><td>idiom</td><td>·ª¶ng h·ªô, ∆∞a chu·ªông (B2)</td></tr>
                    <tr><td>Platform</td><td>n</td><td>N·ªÅn t·∫£ng (B2)</td></tr>
                    <tr><td>Multiple</td><td>adj</td><td>Nhi·ªÅu, ph·ª©c h·ª£p (B2)</td></tr>
                    <tr><td>Occasion</td><td>n</td><td>D·ªãp, c∆° h·ªôi (B1)</td></tr>
                    <tr><td>Discount</td><td>n</td><td>Gi·∫£m gi√° (B1)</td></tr>
                    <tr><td>E-commerce</td><td>n</td><td>Th∆∞∆°ng m·∫°i ƒëi·ªán t·ª≠ (C1)</td></tr>
                    <tr><td>Purchase</td><td>v</td><td>Mua s·∫Øm (B2)</td></tr>
                    <tr><td>Bargain</td><td>v/n</td><td>M·∫∑c c·∫£, tr·∫£ gi√° (B2)</td></tr>
                    <tr><td>Satisfy</td><td>v</td><td>L√†m h√†i l√≤ng, ƒë√°p ·ª©ng (B2)</td></tr>
                    <tr><td>Consumer demand</td><td>n</td><td>Nhu c·∫ßu ng∆∞·ªùi ti√™u d√πng (C1)</td></tr>
                </table>
            </div>

        </div>

        <div class="right-panel" id="questions-container">
            </div>

    </div>

    <div class="modal-overlay" id="result-modal">
        <div class="modal-content">
            <h1>K·∫æT QU·∫¢ C·ª¶A B·∫†N</h1>
            <div class="score" id="score-display">0/19</div>
            <p id="feedback-message">Tuy·ªát v·ªùi!</p>
            <button class="btn btn-primary" onclick="location.reload()">L√ÄM L·∫†I B√ÄI</button>
        </div>
    </div>

    <canvas id="confetti-canvas"></canvas>

    <script>
        /* ================= DATA & CONTENT ================= */
        // D·ªØ li·ªáu ƒë∆∞·ª£c m√£ h√≥a chu·∫©n h√≥a t·ª´ y√™u c·∫ßu c·ªßa ng∆∞·ªùi d√πng. Bao g·ªìm c·∫£ gi·∫£i th√≠ch si√™u chi ti·∫øt.
        const quizData = [
            // EXERCISE 1
            {
                id: '1-1',
                text: "Exercise 1 - Question 1: Listen to local news reports and leave (1) _ _ _ _ _ they tell you to leave.",
                options: [
                    { text: "A. if", isCorrect: true },
                    { text: "B. unless", isCorrect: false },
                    { text: "C. before", isCorrect: false },
                    { text: "D. until", isCorrect: false }
                ],
                explanation: `<h4>GI·∫¢I TH√çCH CHI TI·∫æT:</h4>
                <div class='vocab-list'><b>1. Ph√¢n t√≠ch t·ª´ v·ª±ng:</b><br>A. if (li√™n t·ª´): n·∫øu<br>B. unless (li√™n t·ª´): tr·ª´ khi (= if not)<br>C. before (li√™n t·ª´/gi·ªõi t·ª´): tr∆∞·ªõc khi<br>D. until (li√™n t·ª´): cho ƒë·∫øn khi</div>
                <b>2. D·ªãch c√¢u:</b> "L·∫Øng nghe c√°c b·∫£n tin ƒë·ªãa ph∆∞∆°ng v√† r·ªùi ƒëi <b>n·∫øu</b> h·ªç y√™u c·∫ßu b·∫°n r·ªùi ƒëi."<br>
                <b>3. T·∫°i sao ch·ªçn A?</b> X√©t v·ªÅ m·∫∑t logic trong t√¨nh hu·ªëng th·∫£m h·ªça, vi·ªác s∆° t√°n (leave) l√† m·ªôt <i>h√†nh ƒë·ªông c√≥ ƒëi·ªÅu ki·ªán</i> ph·ª• thu·ªôc v√†o l·ªánh c·ªßa c∆° quan ch·ª©c nƒÉng. Nghƒ©a "n·∫øu" ho√†n to√†n kh·ªõp ng·ªØ c·∫£nh. Lo·∫°i B v√¨ sai nghƒ©a (r·ªùi ƒëi tr·ª´ khi h·ªç b·∫£o -> v√¥ l√Ω).`
            },
            {
                id: '1-2',
                text: "Exercise 1 - Question 2: Find a (2) _ _ _ _ _ place - Stay inside your house, in a strong building...",
                options: [
                    { text: "A. careful", isCorrect: false },
                    { text: "B. secret", isCorrect: false },
                    { text: "C. safe", isCorrect: true },
                    { text: "D. underground", isCorrect: false }
                ],
                explanation: `<h4>GI·∫¢I TH√çCH CHI TI·∫æT:</h4>
                <div class='vocab-list'><b>1. Ph√¢n t√≠ch t·ª´ v·ª±ng:</b><br>A. careful (adj): c·∫©n th·∫≠n<br>B. secret (adj): b√≠ m·∫≠t<br>C. safe (adj): an to√†n<br>D. underground (adj): d∆∞·ªõi l√≤ng ƒë·∫•t</div>
                <b>2. D·ªãch c√¢u:</b> "T√¨m m·ªôt n∆°i <b>an to√†n</b> - ·ªû y√™n trong nh√† b·∫°n, trong m·ªôt t√≤a nh√† ki√™n c·ªë..."<br>
                <b>3. T·∫°i sao ch·ªçn C?</b> D·∫´n ch·ª©ng ngay v·∫ø sau: "Stay inside your house, in a strong building" (·ªû trong nh√†, t√≤a nh√† ki√™n c·ªë) -> ƒê√¢y l√† nh·ªØng v√≠ d·ª• v·ªÅ m·ªôt n∆°i <b>an to√†n (safe)</b> khi c√≥ th·∫£m h·ªça. Kh√¥ng c·∫ßn thi·∫øt ph·∫£i l√† n∆°i b√≠ m·∫≠t (B) hay d∆∞·ªõi l√≤ng ƒë·∫•t (D).`
            },
            {
                id: '1-3',
                text: "Exercise 1 - Question 3: Have an (3) _ _ _ _ _ - Keep food, water, medicine, and a flashlight.",
                options: [
                    { text: "A. supplies", isCorrect: false },
                    { text: "B. emergency kit", isCorrect: true },
                    { text: "C. property", isCorrect: false },
                    { text: "D. damage", isCorrect: false }
                ],
                explanation: `<h4>GI·∫¢I TH√çCH CHI TI·∫æT:</h4>
                <div class='vocab-list'><b>1. Ph√¢n t√≠ch t·ª´ v·ª±ng:</b><br>A. supplies (n - s·ªë nhi·ªÅu): ngu·ªìn cung c·∫•p (Kh√¥ng ƒëi v·ªõi m·∫°o t·ª´ 'an')<br>B. emergency kit (n): b·ªô d·ª•ng c·ª• kh·∫©n c·∫•p<br>C. property (n): t√†i s·∫£n<br>D. damage (n): thi·ªát h·∫°i</div>
                <b>2. D·ªãch c√¢u:</b> "Chu·∫©n b·ªã m·ªôt <b>b·ªô d·ª•ng c·ª• kh·∫©n c·∫•p</b> - Gi·ªØ th·ª©c ƒÉn, n∆∞·ªõc, thu·ªëc men v√† ƒë√®n pin."<br>
                <b>3. T·∫°i sao ch·ªçn B?</b> V·ªÅ ng·ªØ ph√°p, m·∫°o t·ª´ "an" c·∫ßn ƒëi v·ªõi m·ªôt danh t·ª´/c·ª•m danh t·ª´ ƒë·∫øm ƒë∆∞·ª£c s·ªë √≠t b·∫Øt ƒë·∫ßu b·∫±ng nguy√™n √¢m -> "emergency kit" h·ª£p l√Ω. V·ªÅ ng·ªØ nghƒ©a, th·ª©c ƒÉn, n∆∞·ªõc, thu·ªëc, ƒë√®n pin ch√≠nh l√† nh·ªØng th√†nh ph·∫ßn c·∫•u t·∫°o n√™n "b·ªô d·ª•ng c·ª• kh·∫©n c·∫•p".`
            },
            {
                id: '1-4',
                text: "Exercise 1 - Question 4: (4) _ _ _ _ _ danger - Stay away from flooded areas, weak buildings...",
                options: [
                    { text: "A. Follow", isCorrect: false },
                    { text: "B. Avoid", isCorrect: true },
                    { text: "C. Have", isCorrect: false },
                    { text: "D. Wait", isCorrect: false }
                ],
                explanation: `<h4>GI·∫¢I TH√çCH CHI TI·∫æT:</h4>
                <div class='vocab-list'><b>1. Ph√¢n t√≠ch t·ª´ v·ª±ng:</b><br>A. Follow (v): ƒëi theo, tu√¢n theo<br>B. Avoid (v): tr√°nh xa<br>C. Have (v): c√≥<br>D. Wait (v): ch·ªù ƒë·ª£i</div>
                <b>2. D·ªãch c√¢u:</b> "<b>Tr√°nh xa</b> m·ªëi nguy hi·ªÉm - Tr√°nh xa c√°c khu v·ª±c ng·∫≠p l·ª•t, c√°c t√≤a nh√† y·∫øu..."<br>
                <b>3. T·∫°i sao ch·ªçn B?</b> Ch√∫ √Ω c·ª•m t·ª´ gi·∫£i th√≠ch ngay ph√≠a sau: "Stay away from..." (Tr√°nh xa kh·ªèi...). Do ƒë√≥ ƒë·ªông t·ª´ c·∫ßn ƒëi·ªÅn ·ªü ƒë·∫ßu c√¢u ph·∫£i ƒë·ªìng nghƒ©a v·ªõi c·ª•m n√†y -> "Avoid" (tr√°nh) l√† ch√≠nh x√°c tuy·ªát ƒë·ªëi.`
            },
            {
                id: '1-5',
                text: "Exercise 1 - Question 5: Ask for help - Call the emergency services if you are in (5) _ _ _ _ _",
                options: [
                    { text: "A. dangerous", isCorrect: false },
                    { text: "B. endangered", isCorrect: false },
                    { text: "C. dangerously", isCorrect: false },
                    { text: "D. danger", isCorrect: true }
                ],
                explanation: `<h4>GI·∫¢I TH√çCH CHI TI·∫æT:</h4>
                <div class='vocab-list'><b>1. Ph√¢n t√≠ch t·ª´ v·ª±ng (Word form):</b><br>A. dangerous (adj): nguy hi·ªÉm<br>B. endangered (adj): c√≥ nguy c∆° tuy·ªát ch·ªßng<br>C. dangerously (adv): m·ªôt c√°ch nguy hi·ªÉm<br>D. danger (n): m·ªëi nguy hi·ªÉm</div>
                <b>2. D·ªãch c√¢u:</b> "Y√™u c·∫ßu gi√∫p ƒë·ª° - G·ªçi cho c√°c d·ªãch v·ª• kh·∫©n c·∫•p n·∫øu b·∫°n ƒëang g·∫∑p <b>nguy hi·ªÉm</b>."<br>
                <b>3. T·∫°i sao ch·ªçn D?</b> C·∫•u tr√∫c ng·ªØ ph√°p "be in + Noun" -> <b>be in danger</b> (ƒëang ·ªü trong t√¨nh tr·∫°ng nguy hi·ªÉm). Kh√¥ng th·ªÉ d√πng t√≠nh t·ª´ (A) hay tr·∫°ng t·ª´ (C) sau gi·ªõi t·ª´ "in" trong tr∆∞·ªùng h·ª£p n√†y.`
            },
            
            // EXERCISE 4
            {
                id: '4-1',
                text: "Exercise 4 - Question 1: Cuc Phuong... was officially opened (1) _ _ _ _ _ 1960.",
                options: [
                    { text: "A. in", isCorrect: true },
                    { text: "B. on", isCorrect: false },
                    { text: "C. at", isCorrect: false },
                    { text: "D. from", isCorrect: false }
                ],
                explanation: `<h4>GI·∫¢I TH√çCH CHI TI·∫æT:</h4>
                <div class='vocab-list'><b>1. Ph√¢n t√≠ch gi·ªõi t·ª´:</b><br>A. in + th√°ng/nƒÉm/m√πa/th·∫ø k·ª∑<br>B. on + ng√†y/th·ª© trong tu·∫ßn<br>C. at + gi·ªù/th·ªùi ƒëi·ªÉm c·ª• th·ªÉ</div>
                <b>2. D·ªãch c√¢u:</b> "C√∫c Ph∆∞∆°ng... ƒë∆∞·ª£c ch√≠nh th·ª©c m·ªü c·ª≠a <b>v√†o</b> nƒÉm 1960."<br>
                <b>3. T·∫°i sao ch·ªçn A?</b> "1960" l√† nƒÉm. Quy t·∫Øc c∆° b·∫£n c·ªßa ti·∫øng Anh: D√πng gi·ªõi t·ª´ <b>IN</b> ƒë·ª©ng tr∆∞·ªõc nƒÉm.`
            },
            {
                id: '4-2',
                text: "Exercise 4 - Question 2: It (2) _ _ _ _ _ 160 km south west of Ha Noi...",
                options: [
                    { text: "A. is located", isCorrect: true },
                    { text: "B. located", isCorrect: false },
                    { text: "C. locating", isCorrect: false },
                    { text: "D. location", isCorrect: false }
                ],
                explanation: `<h4>GI·∫¢I TH√çCH CHI TI·∫æT:</h4>
                <div class='vocab-list'><b>1. Ph√¢n t√≠ch ng·ªØ ph√°p:</b><br>C·∫•u tr√∫c: Be located + preposition (in/on/at/kho·∫£ng c√°ch) = N·∫±m ·ªü v·ªã tr√≠ n√†o ƒë√≥.</div>
                <b>2. D·ªãch c√¢u:</b> "N√≥ <b>t·ªça l·∫°c / n·∫±m ·ªü v·ªã tr√≠</b> c√°ch H√† N·ªôi 160 km v·ªÅ ph√≠a T√¢y Nam..."<br>
                <b>3. T·∫°i sao ch·ªçn A?</b> "Locate" mang nghƒ©a ch·ªß ƒë·ªông l√† "t√¨m ra v·ªã tr√≠" ho·∫∑c "ƒë·∫∑t ·ªü". Khi n√≥i m·ªôt ƒë·ªãa ƒëi·ªÉm n·∫±m ·ªü ƒë√¢u, ta PH·∫¢I d√πng th·ªÉ b·ªã ƒë·ªông: <b>is located</b>. C√°c ƒë√°p √°n B, C, D sai ng·ªØ ph√°p.`
            },
            {
                id: '4-3',
                text: "Exercise 4 - Question 3: The 200 square kilometer park (3) _ _ _ _ _ tourists and scientists alike.",
                options: [
                    { text: "A. protects", isCorrect: false },
                    { text: "B. attracts", isCorrect: true },
                    { text: "C. harms", isCorrect: false },
                    { text: "D. invites", isCorrect: false }
                ],
                explanation: `<h4>GI·∫¢I TH√çCH CHI TI·∫æT:</h4>
                <div class='vocab-list'><b>1. Ph√¢n t√≠ch t·ª´ v·ª±ng:</b><br>A. protect (v): b·∫£o v·ªá<br>B. attract (v): thu h√∫t<br>C. harm (v): g√¢y h·∫°i<br>D. invite (v): m·ªùi m·ªçc</div>
                <b>2. D·ªãch c√¢u:</b> "Khu b·∫£o t·ªìn r·ªông 200 km vu√¥ng n√†y <b>thu h√∫t</b> c·∫£ kh√°ch du l·ªãch l·∫´n c√°c nh√† khoa h·ªçc."<br>
                <b>3. T·∫°i sao ch·ªçn B?</b> V∆∞·ªùn qu·ªëc gia c√≥ nhi·ªÅu c·∫£nh ƒë·∫πp v√† h·ªá sinh th√°i ƒëa d·∫°ng n√™n ch·ª©c nƒÉng t·ª± nhi√™n ƒë·ªëi v·ªõi con ng∆∞·ªùi l√† "thu h√∫t" (attract). "Protect" (B·∫£o v·ªá) th∆∞·ªùng d√πng cho ƒë·ªông th·ª±c v·∫≠t, kh√¥ng d√πng b·∫£o v·ªá du kh√°ch trong ng·ªØ c·∫£nh n√†y.`
            },
            {
                id: '4-5',
                text: "Exercise 4 - Question 5: Many come to see the work being done to protect (5) _ _ _ _ _ species.",
                options: [
                    { text: "A. dangerous", isCorrect: false },
                    { text: "B. danger", isCorrect: false },
                    { text: "C. endangered", isCorrect: true },
                    { text: "D. dangerously", isCorrect: false }
                ],
                explanation: `<h4>GI·∫¢I TH√çCH CHI TI·∫æT:</h4>
                <div class='vocab-list'><b>1. Ph√¢n t√≠ch t·ª´ v·ª±ng (Word Form):</b><br>Ta c·∫ßn m·ªôt t√≠nh t·ª´ ƒë·ª©ng tr∆∞·ªõc danh t·ª´ "species" (c√°c lo√†i).<br>A. dangerous (adj): nguy hi·ªÉm (g√¢y h·∫°i cho ng∆∞·ªùi kh√°c)<br>C. endangered (adj): b·ªã nguy hi·ªÉm, c√≥ nguy c∆° tuy·ªát ch·ªßng.</div>
                <b>2. D·ªãch c√¢u:</b> "Nhi·ªÅu ng∆∞·ªùi ƒë·∫øn ƒë·ªÉ xem nh·ªØng c√¥ng vi·ªác ƒëang ƒë∆∞·ª£c th·ª±c hi·ªán nh·∫±m b·∫£o v·ªá c√°c lo√†i <b>c√≥ nguy c∆° tuy·ªát ch·ªßng</b>."<br>
                <b>3. T·∫°i sao ch·ªçn C?</b> C·ª•m t·ª´ c·ªë ƒë·ªãnh trong ch·ªß ƒë·ªÅ m√¥i tr∆∞·ªùng: <b>Endangered species</b> (c√°c lo√†i c√≥ nguy c∆° tuy·ªát ch·ªßng). C√¥ng vi√™n qu·ªëc gia b·∫£o v·ªá c√°c lo√†i b·ªã ƒëe d·ªça ch·ª© kh√¥ng b·∫£o v·ªá c√°c lo√†i g√¢y nguy hi·ªÉm (dangerous).`
            },
            {
                id: '4-6',
                text: "Exercise 4 - Question 6: ...is where Nguyen Hue's army was stationed (6) _ _ _ _ _ it made its surprise attack...",
                options: [
                    { text: "A. since", isCorrect: false },
                    { text: "B. before", isCorrect: true },
                    { text: "C. during", isCorrect: false },
                    { text: "D. while", isCorrect: false }
                ],
                explanation: `<h4>GI·∫¢I TH√çCH CHI TI·∫æT:</h4>
                <div class='vocab-list'><b>1. Ph√¢n t√≠ch t·ª´ v·ª±ng:</b><br>A. since: k·ªÉ t·ª´ khi<br>B. before: tr∆∞·ªõc khi<br>C. during (+ Noun): trong su·ªët<br>D. while (+ Clause): trong khi</div>
                <b>2. D·ªãch c√¢u:</b> "...l√† n∆°i qu√¢n ƒë·ªôi c·ªßa Nguy·ªÖn Hu·ªá ƒë√≥ng qu√¢n <b>tr∆∞·ªõc khi</b> th·ª±c hi·ªán cu·ªôc t·∫•n c√¥ng b·∫•t ng·ªù..."<br>
                <b>3. T·∫°i sao ch·ªçn B?</b> X√©t v·ªÅ tr·∫≠t t·ª± th·ªùi gian v√† logic l·ªãch s·ª≠: Qu√¢n ƒë·ªôi ph·∫£i ƒë√≥ng qu√¢n, t·∫≠p h·ª£p l·ª±c l∆∞·ª£ng (h√†nh ƒë·ªông 1) <b>tr∆∞·ªõc khi (before)</b> t·∫•n c√¥ng (h√†nh ƒë·ªông 2).`
            },
            {
                id: '4-7',
                text: "Exercise 4 - Question 7: ...surprise attack on Thang Long and (7) _ _ _ _ _ the Qing invaders...",
                options: [
                    { text: "A. increased", isCorrect: false },
                    { text: "B. competed", isCorrect: false },
                    { text: "C. defeated", isCorrect: true },
                    { text: "D. finished", isCorrect: false }
                ],
                explanation: `<h4>GI·∫¢I TH√çCH CHI TI·∫æT:</h4>
                <div class='vocab-list'><b>1. Ph√¢n t√≠ch t·ª´ v·ª±ng:</b><br>A. increased: gia tƒÉng<br>B. competed: c·∫°nh tranh<br>C. defeated: ƒë√°nh b·∫°i<br>D. finished: ho√†n th√†nh</div>
                <b>2. D·ªãch c√¢u:</b> "...cu·ªôc t·∫•n c√¥ng b·∫•t ng·ªù v√†o ThƒÉng Long v√† <b>ƒë√°nh b·∫°i</b> qu√¢n x√¢m l∆∞·ª£c nh√† Thanh..."<br>
                <b>3. T·∫°i sao ch·ªçn C?</b> ƒê·ªëi t∆∞·ª£ng ph√≠a sau l√† "the Qing invaders" (qu√¢n x√¢m l∆∞·ª£c nh√† Thanh). ƒê·ªông t·ª´ ph√π h·ª£p nh·∫•t ƒëi v·ªõi k·∫ª th√π/qu√¢n x√¢m l∆∞·ª£c l√† "defeat" (ƒë√°nh b·∫°i).`
            },
            {
                id: '4-8',
                text: "Exercise 4 - Question 8: Cuc Phuong is also (8) _ _ _ _ _ to the Muong ethnic minority...",
                options: [
                    { text: "A. room", isCorrect: false },
                    { text: "B. flat", isCorrect: false },
                    { text: "C. home", isCorrect: true },
                    { text: "D. places", isCorrect: false }
                ],
                explanation: `<h4>GI·∫¢I TH√çCH CHI TI·∫æT:</h4>
                <div class='vocab-list'><b>1. Ph√¢n t√≠ch c·∫•u tr√∫c:</b><br>Th√†nh ng·ªØ/C·∫•u tr√∫c c·ªë ƒë·ªãnh: <b>be home to somebody/something</b> = l√† nh√† c·ªßa ai/c√°i g√¨ (n∆°i sinh s·ªëng, c∆∞ ng·ª• t·ª± nhi√™n).</div>
                <b>2. D·ªãch c√¢u:</b> "C√∫c Ph∆∞∆°ng c≈©ng l√† <b>n∆°i c∆∞ ng·ª• / nh√†</b> c·ªßa d√¢n t·ªôc thi·ªÉu s·ªë ng∆∞·ªùi M∆∞·ªùng..."<br>
                <b>3. T·∫°i sao ch·ªçn C?</b> ƒê√¢y l√† c·ª•m t·ª´ c·ªë ƒë·ªãnh trong ti·∫øng Anh. Ta kh√¥ng d√πng "room to", "flat to" hay "places to" trong ng·ªØ c·∫£nh ch·ªâ n∆°i sinh s·ªëng c·ªßa m·ªôt c·ªông ƒë·ªìng hay lo√†i v·∫≠t.`
            },

            // EXERCISE 5
            {
                id: '5-1',
                text: "Exercise 5 - Question 1: What is the passage mainly about?",
                options: [
                    { text: "A. Why buying online is popular in Viet Nam.", isCorrect: true },
                    { text: "B. What Vietnamese young shoppers do online.", isCorrect: false },
                    { text: "C. How Vietnamese people spend their time online.", isCorrect: false },
                    { text: "D. When Vietnamese shop-keepers sell things online.", isCorrect: false }
                ],
                explanation: `<h4>GI·∫¢I TH√çCH CHI TI·∫æT:</h4>
                <b>1. D·ªãch c√¢u h·ªèi:</b> ƒêo·∫°n vƒÉn ch·ªß y·∫øu n√≥i v·ªÅ ƒëi·ªÅu g√¨?<br>
                <b>2. T·∫°i sao ch·ªçn A?</b> Ngay c√¢u ƒë·∫ßu ti√™n (Topic sentence) ƒë√£ n√™u r√µ: "Vietnamese people are now in favor of buying goods from online stores <b>due to their advantages</b>." (Ng∆∞·ªùi VN ∆∞a chu·ªông mua h√†ng online <b>nh·ªù v√†o nh·ªØng l·ª£i √≠ch/∆∞u ƒëi·ªÉm c·ªßa n√≥</b>). C·∫£ ƒëo·∫°n vƒÉn sau ƒë√≥ li·ªát k√™ c√°c l·ª£i √≠ch n√†y (ti·∫øt ki·ªám th·ªùi gian, gi√° r·∫ª, m√£ gi·∫£m gi√°, ti·ªán l·ª£i). ƒêi·ªÅu n√†y gi·∫£i th√≠ch <b>L√Ω do t·∫°i sao (Why)</b> n√≥ l·∫°i ph·ªï bi·∫øn.`
            },
            {
                id: '5-2',
                text: "Exercise 5 - Question 2: Why do shoppers prefer discount codes?",
                options: [
                    { text: "A. Because they can buy expensive things.", isCorrect: false },
                    { text: "B. Because they don't have any money to buy brand-name items.", isCorrect: false },
                    { text: "C. Because they can use discount codes to buy items at lower prices.", isCorrect: true },
                    { text: "D. Because they can go shopping whenever they want.", isCorrect: false }
                ],
                explanation: `<h4>GI·∫¢I TH√çCH CHI TI·∫æT:</h4>
                <b>1. D·ªãch c√¢u h·ªèi:</b> T·∫°i sao ng∆∞·ªùi mua h√†ng l·∫°i th√≠ch m√£ gi·∫£m gi√°?<br>
                <b>2. T√¨m d·∫´n ch·ª©ng:</b> Trong b√†i c√≥ c√¢u: "On special occasions, these online markets provide shoppers with lots of discount codes and items at <b>cheaper prices</b>."<br>
                <b>3. T·∫°i sao ch·ªçn C?</b> M√£ gi·∫£m gi√° (discount codes) ƒëi li·ªÅn v·ªõi "cheaper prices" (gi√° r·∫ª h∆°n). T∆∞∆°ng ƒë∆∞∆°ng v·ªõi vi·ªác h·ªç c√≥ th·ªÉ mua ƒë·ªì v·ªõi "lower prices" (gi√° th·∫•p h∆°n).`
            },
            {
                id: '5-3',
                text: "Exercise 5 - Question 3: How convenient is online shopping?",
                options: [
                    { text: "A. Customers can bargain, and they can also buy things quickly.", isCorrect: false },
                    { text: "B. Customers can compare prices, read customers' reviews among different shops, and buy things at lower prices.", isCorrect: true },
                    { text: "C. Customers have to bring products themselves.", isCorrect: false },
                    { text: "D. Customers can't buy things with a lot of mouse clicks.", isCorrect: false }
                ],
                explanation: `<h4>GI·∫¢I TH√çCH CHI TI·∫æT:</h4>
                <b>1. D·ªãch c√¢u h·ªèi:</b> Mua s·∫Øm tr·ª±c tuy·∫øn ti·ªán l·ª£i nh∆∞ th·∫ø n√†o?<br>
                <b>2. Ph√¢n t√≠ch:</b> <br>
                - Lo·∫°i A v√¨ b√†i vi·∫øt ghi r√µ "without wasting time bargaining" (KH√îNG C·∫¶N m·∫∑c c·∫£).<br>
                - Lo·∫°i C v√¨ mua online l√† giao h√†ng t·∫≠n n∆°i, kh√¥ng c·∫ßn t·ª± x√°ch v·ªÅ.<br>
                <b>3. T·∫°i sao ch·ªçn B?</b> D·∫´n ch·ª©ng trong b√†i: "comparing their prices among multiple online stores and reading customers' reviews... Online shopping offers many benefits, including lower prices." ƒê√°p √°n B t√≥m t·∫Øt ch√≠nh x√°c 3 ti·ªán √≠ch n√†y.`
            },
            {
                id: '5-4',
                text: "Exercise 5 - Question 4: According to the passage, which of the following is NOT true?",
                options: [
                    { text: "A. Vietnamese people prefer shopping online because of its benefits.", isCorrect: false },
                    { text: "B. Customers can compare product prices and read reviews before buying.", isCorrect: false },
                    { text: "C. Online shopping is less convenient than traditional shopping.", isCorrect: true },
                    { text: "D. E-commerce websites attract new customers daily.", isCorrect: false }
                ],
                explanation: `<h4>GI·∫¢I TH√çCH CHI TI·∫æT:</h4>
                <b>1. D·ªãch c√¢u h·ªèi:</b> Theo ƒëo·∫°n vƒÉn, ƒëi·ªÅu n√†o sau ƒë√¢y l√† KH√îNG ƒê√öNG?<br>
                <b>2. T·∫°i sao ch·ªçn C?</b> ƒê√°p √°n C n√≥i: "Mua s·∫Øm online <b>√≠t ti·ªán l·ª£i h∆°n (less convenient)</b> so v·ªõi mua s·∫Øm truy·ªÅn th·ªëng". ƒêi·ªÅu n√†y ƒëi ng∆∞·ª£c ho√†n to√†n v·ªõi th√¥ng ƒëi·ªáp c·ªßa c·∫£ b√†i vƒÉn (b√†i vƒÉn ca ng·ª£i s·ª± ti·ªán l·ª£i c·ªßa mua s·∫Øm online v·ªõi 'just a few mouse clicks at home'). C√°c ƒë√°p √°n A, B, D ƒë·ªÅu c√≥ th√¥ng tin r√µ r√†ng trong b√†i.`
            },
            {
                id: '5-5',
                text: "Exercise 5 - Question 5: The word ‚Äútraditional‚Äù in the passage is OPPOSITE in meaning to -",
                options: [
                    { text: "A. modern", isCorrect: true },
                    { text: "B. online", isCorrect: false },
                    { text: "C. expensive", isCorrect: false },
                    { text: "D. convenient", isCorrect: false }
                ],
                explanation: `<h4>GI·∫¢I TH√çCH CHI TI·∫æT:</h4>
                <b>1. D·ªãch c√¢u h·ªèi:</b> T·ª´ "traditional" (truy·ªÅn th·ªëng) TR√ÅI NGHƒ®A v·ªõi t·ª´ n√†o?<br>
                <b>2. Ph√¢n t√≠ch t·ª´ v·ª±ng:</b><br>
                - traditional (adj): thu·ªôc v·ªÅ truy·ªÅn th·ªëng, c≈©.<br>
                - modern (adj): hi·ªán ƒë·∫°i.<br>
                - online: tr·ª±c tuy·∫øn.<br>
                <b>3. T·∫°i sao ch·ªçn A?</b> Tr√°i nghƒ©a tr·ª±c ti·∫øp c·ªßa "truy·ªÅn th·ªëng" trong ti·∫øng Anh lu√¥n l√† "hi·ªán ƒë·∫°i" (modern).`
            },
            {
                id: '5-6',
                text: "Exercise 5 - Question 6: The word ‚Äúconvenience‚Äù in the passage is CLOSEST in meaning to",
                options: [
                    { text: "A. comfort", isCorrect: true },
                    { text: "B. difficulty", isCorrect: false },
                    { text: "C. problem", isCorrect: false },
                    { text: "D. risk", isCorrect: false }
                ],
                explanation: `<h4>GI·∫¢I TH√çCH CHI TI·∫æT:</h4>
                <b>1. D·ªãch c√¢u h·ªèi:</b> T·ª´ "convenience" (s·ª± ti·ªán l·ª£i) ƒê·ªíNG NGHƒ®A/G·∫¶N NGHƒ®A NH·∫§T v·ªõi t·ª´ n√†o?<br>
                <b>2. Ph√¢n t√≠ch t·ª´ v·ª±ng:</b><br>
                - convenience (n): s·ª± ti·ªán l·ª£i, thu·∫≠n ti·ªán.<br>
                - comfort (n): s·ª± tho·∫£i m√°i, ti·ªán nghi (Mang t√≠nh t√≠ch c·ª±c, l√†m cho cu·ªôc s·ªëng d·ªÖ d√†ng h∆°n).<br>
                - difficulty (n): s·ª± kh√≥ khƒÉn.<br>
                - problem/risk (n): v·∫•n ƒë·ªÅ / r·ªßi ro.<br>
                <b>3. T·∫°i sao ch·ªçn A?</b> "Comfort" l√† t·ª´ duy nh·∫•t mang n√©t nghƒ©a t√≠ch c·ª±c, l√†m cho ng∆∞·ªùi d√πng c·∫£m th·∫•y d·ªÖ ch·ªãu, nh·∫π nh√†ng (gi·ªëng nh∆∞ "convenience").`
            },
            {
                id: '5-7',
                text: "Exercise 5 - Question 7: What can be inferred from the passage?",
                options: [
                    { text: "A. Online shopping helps people save time and money.", isCorrect: true },
                    { text: "B. Customers do not like reading reviews before buying online.", isCorrect: false },
                    { text: "C. Shopping online is more expensive than shopping in physical stores.", isCorrect: false },
                    { text: "D. People prefer bargaining in traditional stores rather than buying online.", isCorrect: false }
                ],
                explanation: `<h4>GI·∫¢I TH√çCH CHI TI·∫æT:</h4>
                <b>1. D·ªãch c√¢u h·ªèi:</b> C√≥ th·ªÉ suy ra ƒëi·ªÅu g√¨ t·ª´ b√†i ƒë·ªçc?<br>
                <b>2. T·∫°i sao ch·ªçn A?</b> D·ª±a v√†o c√°c chi ti·∫øt: "without wasting time" (ti·∫øt ki·ªám th·ªùi gian) v√† "lower prices / discount codes" (ti·∫øt ki·ªám ti·ªÅn). K·∫øt h·ª£p l·∫°i, ta ho√†n to√†n c√≥ th·ªÉ suy lu·∫≠n (infer) r·∫±ng Mua s·∫Øm tr·ª±c tuy·∫øn gi√∫p con ng∆∞·ªùi ti·∫øt ki·ªám Th·ªùi gian v√† Ti·ªÅn b·∫°c (Save time and money). C√°c ƒë√°p √°n kh√°c ƒë·ªÅu sai th·ª±c t·∫ø b√†i ƒë·ªçc.`
            }
        ];

        /* ================= GAME LOGIC & STATE ================= */
        let score = 0;
        let answeredQuestions = 0;
        let isTimerRunning = false;
        let timeLeft = 600; // 10 minutes = 600 seconds
        let timerInterval;

        // Shuffle Array (T·ª± ƒë·ªông x√°o tr·ªôn ƒë√°p √°n)
        function shuffleArray(array) {
            for (let i = array.length - 1; i > 0; i--) {
                const j = Math.floor(Math.random() * (i + 1));
                [array[i], array[j]] = [array[j], array[i]];
            }
        }

        /* ================= WEB AUDIO API FOR SOUNDS ================= */
        const AudioContext = window.AudioContext || window.webkitAudioContext;
        let audioCtx;

        function initAudio() {
            if (!audioCtx) audioCtx = new AudioContext();
        }

        // T·∫°o ti·∫øng Ding (ƒê√∫ng)
        function playCorrectSound() {
            initAudio();
            const osc = audioCtx.createOscillator();
            const gainNode = audioCtx.createGain();
            osc.type = 'sine';
            osc.frequency.setValueAtTime(800, audioCtx.currentTime);
            osc.frequency.exponentialRampToValueAtTime(1200, audioCtx.currentTime + 0.1);
            
            gainNode.gain.setValueAtTime(0.5, audioCtx.currentTime);
            gainNode.gain.exponentialRampToValueAtTime(0.01, audioCtx.currentTime + 0.5);
            
            osc.connect(gainNode);
            gainNode.connect(audioCtx.destination);
            
            osc.start();
            osc.stop(audioCtx.currentTime + 0.5);
        }

        // T·∫°o ti·∫øng T√©o t√®o t√®o (Sai)
        function playWrongSound() {
            initAudio();
            const osc = audioCtx.createOscillator();
            const gainNode = audioCtx.createGain();
            osc.type = 'sawtooth';
            
            osc.frequency.setValueAtTime(300, audioCtx.currentTime);
            osc.frequency.exponentialRampToValueAtTime(100, audioCtx.currentTime + 0.4);
            
            gainNode.gain.setValueAtTime(0.5, audioCtx.currentTime);
            gainNode.gain.exponentialRampToValueAtTime(0.01, audioCtx.currentTime + 0.4);
            
            osc.connect(gainNode);
            gainNode.connect(audioCtx.destination);
            
            osc.start();
            osc.stop(audioCtx.currentTime + 0.4);
        }

        /* ================= RENDER UI ================= */
        function renderQuestions() {
            const container = document.getElementById('questions-container');
            container.innerHTML = ''; // Clear

            quizData.forEach((q, index) => {
                // Shuffle options for each question
                let shuffledOptions = [...q.options];
                shuffleArray(shuffledOptions);

                let cardHTML = `
                    <div class="question-card" id="card-${q.id}">
                        <div class="question-text">${q.text}</div>
                        <div class="options-grid" id="options-${q.id}">
                `;

                shuffledOptions.forEach((opt, optIndex) => {
                    // M·∫πo l∆∞u tr·ªØ d·ªØ li·ªáu t√≠nh ƒë√∫ng/sai
                    let isCorrectStr = opt.isCorrect ? 'true' : 'false';
                    cardHTML += `
                        <button class="option-btn" 
                            onclick="checkAnswer('${q.id}', this, ${isCorrectStr})"
                            data-correct="${isCorrectStr}">
                            ${opt.text}
                        </button>
                    `;
                });

                cardHTML += `
                        </div>
                        <div class="explanation-box" id="exp-${q.id}">
                            ${q.explanation}
                        </div>
                    </div>
                `;
                container.innerHTML += cardHTML;
            });
        }

        /* ================= INTERACTION LOGIC ================= */
        function toggleElement(id) {
            const el = document.getElementById(id);
            if(el.style.display === "block") {
                el.style.display = "none";
            } else {
                el.style.display = "block";
            }
        }

        function checkAnswer(questionId, btnElement, isCorrect) {
            // Disable t·∫•t c·∫£ button trong c√¢u h·ªèi n√†y
            const optionsContainer = document.getElementById(`options-${questionId}`);
            const buttons = optionsContainer.querySelectorAll('.option-btn');
            buttons.forEach(b => b.disabled = true);

            if (isCorrect) {
                // ƒê√∫ng
                btnElement.classList.add('correct');
                playCorrectSound();
                shootConfetti(btnElement);
                score++;
            } else {
                // Sai
                btnElement.classList.add('wrong');
                btnElement.classList.add('shake');
                playWrongSound();
                
                // Hi·ªÉn th·ªã lu√¥n ƒë√°p √°n ƒë√∫ng (M√†u xanh)
                buttons.forEach(b => {
                    if(b.getAttribute('data-correct') === 'true') {
                        b.classList.add('correct');
                        b.style.boxShadow = "0 0 15px rgba(88, 204, 2, 0.7)"; // highlight
                    }
                });
            }

            // Hi·ªán gi·∫£i th√≠ch chi ti·∫øt
            const expBox = document.getElementById(`exp-${questionId}`);
            expBox.style.display = 'block';

            answeredQuestions++;
        }

        /* ================= TIMER ================= */
        function updateTimerDisplay() {
            const minutes = Math.floor(timeLeft / 60);
            const seconds = timeLeft % 60;
            document.getElementById('timer').innerText = 
                `${minutes.toString().padStart(2, '0')}:${seconds.toString().padStart(2, '0')}`;
        }

        function toggleTimer() {
            const btn = document.getElementById('btn-timer');
            if (isTimerRunning) {
                clearInterval(timerInterval);
                btn.innerText = "TI·∫æP T·ª§C B√ÄI";
                isTimerRunning = false;
            } else {
                btn.innerText = "T·∫†M D·ª™NG";
                isTimerRunning = true;
                timerInterval = setInterval(() => {
                    timeLeft--;
                    updateTimerDisplay();
                    if (timeLeft <= 0) {
                        clearInterval(timerInterval);
                        alert("ƒê√£ h·∫øt gi·ªù l√†m b√†i. B·∫°n v·∫´n c√≥ th·ªÉ ti·∫øp t·ª•c l√†m, nh∆∞ng nh·ªõ l√† trong ph√≤ng thi th·∫≠t, b·∫°n ch·ªâ n√™n l√†m m·ªôt b√†i nh∆∞ th·∫ø n√†y trong 10 ph√∫t th√¥i nha.");
                    }
                }, 1000);
            }
        }

        /* ================= SUBMIT & FEEDBACK ================= */
        function submitTest() {
            const modal = document.getElementById('result-modal');
            const scoreDisplay = document.getElementById('score-display');
            const feedback = document.getElementById('feedback-message');
            
            clearInterval(timerInterval);
            
            scoreDisplay.innerText = `${score} / ${quizData.length}`;
            
            let message = "";
            let ratio = score / quizData.length;
            if (ratio === 1) message = "üéâ THI√äN T√ÄI TI·∫æNG ANH L√Ä ƒê√ÇY! Xu·∫•t s·∫Øc 100%!";
            else if (ratio >= 0.8) message = "üåü L√†m t·ªët l·∫Øm! B·∫°n n·∫Øm b√†i r·∫•t v·ªØng ƒë·∫•y!";
            else if (ratio >= 0.5) message = "üëç C·ªë l√™n nh√©! H√£y ƒë·ªçc k·ªπ ph·∫ßn gi·∫£i th√≠ch chi ti·∫øt ƒë·ªÉ c·∫£i thi·ªán h∆°n.";
            else message = "üí™ ƒê·ª´ng n·∫£n ch√≠! H·ªçc t·ª´ v·ª±ng th·∫≠t k·ªπ v√† l√†m l·∫°i nh√©!";
            
            feedback.innerText = message;
            modal.style.display = 'flex';
        }

        /* ================= CONFETTI EFFECT (VANILLA JS) ================= */
        function shootConfetti() {
            const canvas = document.getElementById('confetti-canvas');
            const ctx = canvas.getContext('2d');
            canvas.width = window.innerWidth;
            canvas.height = window.innerHeight;

            let particles = [];
            const colors = ['#1CB0F6', '#58CC02', '#FFC800', '#FF4757', '#9146FF'];

            for (let i = 0; i < 100; i++) {
                particles.push({
                    x: canvas.width / 2,
                    y: canvas.height / 2,
                    r: Math.random() * 6 + 2,
                    dx: Math.random() * 10 - 5,
                    dy: Math.random() * -10 - 2,
                    color: colors[Math.floor(Math.random() * colors.length)],
                    tilt: Math.random() * 10
                });
            }

            function draw() {
                ctx.clearRect(0, 0, canvas.width, canvas.height);
                particles.forEach((p, i) => {
                    p.dy += 0.2; // Gravity
                    p.x += p.dx;
                    p.y += p.dy;
                    p.tilt += 0.1;
                    
                    ctx.beginPath();
                    ctx.arc(p.x, p.y, p.r, 0, Math.PI * 2, false);
                    ctx.fillStyle = p.color;
                    ctx.fill();

                    // Remove particles that fall out of bounds
                    if(p.y > canvas.height) particles.splice(i, 1);
                });

                if(particles.length > 0) {
                    requestAnimationFrame(draw);
                } else {
                    ctx.clearRect(0, 0, canvas.width, canvas.height);
                }
            }
            draw();
        }

        // Initialize App
        window.onload = () => {
            renderQuestions();
        };
    </script>
</body>
</html>