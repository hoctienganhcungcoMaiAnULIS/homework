<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>B√†i T·∫≠p Ti·∫øng Anh - Ms Mai An ULIS</title>
    <link href="https://fonts.googleapis.com/css2?family=Nunito:wght@400;600;700;800&family=Quicksand:wght@500;700&display=swap" rel="stylesheet">
    <script src="https://cdn.jsdelivr.net/npm/canvas-confetti@1.6.0/dist/confetti.browser.min.js"></script>
    <style>
        :root {
            --primary: #8854C0; /* T√≠m h·ªìng */
            --primary-dark: #6c429c;
            --secondary: #00C9A7; /* Xanh ng·ªçc */
            --secondary-dark: #00a186;
            --correct: #00D26A; /* Xanh l√° */
            --correct-dark: #00a855;
            --wrong: #FF4757; /* ƒê·ªè cam */
            --wrong-dark: #d6303e;
            --bg-color: #f0f3f8;
            --text-color: #2c3e50;
            --card-bg: #ffffff;
        }

        * {
            box-sizing: border-box;
            margin: 0;
            padding: 0;
        }

        body {
            font-family: 'Nunito', sans-serif;
            background-color: var(--bg-color);
            background-image: radial-gradient(var(--primary) 1.5px, transparent 1.5px), radial-gradient(var(--secondary) 1.5px, var(--bg-color) 1.5px);
            background-size: 30px 30px;
            background-position: 0 0, 15px 15px;
            color: var(--text-color);
            padding-bottom: 100px;
            overflow-x: hidden;
        }

        /* --- Header --- */
        header {
            background: #fff;
            padding: 15px 20px;
            box-shadow: 0 4px 15px rgba(0,0,0,0.05);
            position: sticky;
            top: 0;
            z-index: 100;
            display: flex;
            align-items: center;
            justify-content: space-between;
            border-bottom: 5px solid var(--secondary);
        }

        .teacher-badge {
            display: flex;
            align-items: center;
            gap: 10px;
            font-weight: 800;
            color: var(--primary);
            font-size: 1.1rem;
        }

        .teacher-avatar {
            width: 40px;
            height: 40px;
            background: var(--secondary);
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-size: 20px;
        }

        /* --- Layout --- */
        .container {
            max-width: 900px;
            margin: 30px auto;
            padding: 0 15px;
        }

        .card {
            background: var(--card-bg);
            border-radius: 20px;
            box-shadow: 0 8px 0 rgba(0,0,0,0.1);
            padding: 30px;
            margin-bottom: 40px;
            border: 2px solid #e0e0e0;
            transition: transform 0.3s ease;
        }

        .card h2 {
            color: var(--primary);
            font-family: 'Quicksand', sans-serif;
            margin-bottom: 20px;
            border-bottom: 2px dashed #ddd;
            padding-bottom: 10px;
        }

        /* --- Reading Passage Box --- */
        .reading-passage {
            background-color: #f9f9ff;
            border-left: 5px solid var(--primary);
            padding: 20px;
            border-radius: 10px;
            line-height: 1.8;
            font-size: 1.05rem;
            margin-bottom: 25px;
            color: #444;
            white-space: pre-line; /* Gi·ªØ ƒë·ªãnh d·∫°ng xu·ªëng d√≤ng */
        }
        
        .reading-passage strong {
            color: var(--primary);
        }

        /* --- Glossary Table --- */
        .glossary-box {
            margin: 20px 0;
            overflow-x: auto;
        }
        
        .glossary-table {
            width: 100%;
            border-collapse: collapse;
            font-size: 0.95rem;
            border-radius: 10px;
            overflow: hidden;
            box-shadow: 0 4px 6px rgba(0,0,0,0.05);
        }

        .glossary-table th {
            background-color: var(--secondary);
            color: white;
            padding: 12px;
            text-align: left;
        }

        .glossary-table td {
            background-color: #fff;
            border-bottom: 1px solid #eee;
            padding: 10px 12px;
            color: #555;
        }

        .glossary-table tr:last-child td {
            border-bottom: none;
        }
        
        .academic-tag {
            display: inline-block;
            background: #e1f5fe;
            color: #0288d1;
            padding: 2px 6px;
            border-radius: 4px;
            font-size: 0.75rem;
            font-weight: bold;
            margin-right: 5px;
        }

        /* --- Questions --- */
        .question-block {
            margin-bottom: 30px;
            padding-bottom: 20px;
            border-bottom: 1px solid #eee;
        }
        
        .question-text {
            font-weight: 700;
            font-size: 1.1rem;
            margin-bottom: 15px;
            color: #333;
        }

        .options-grid {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 15px;
        }

        @media (max-width: 600px) {
            .options-grid {
                grid-template-columns: 1fr;
            }
        }

        .option-btn {
            background: #fff;
            border: 2px solid #ddd;
            border-radius: 15px;
            padding: 15px;
            font-family: 'Nunito', sans-serif;
            font-size: 1rem;
            color: #555;
            cursor: pointer;
            text-align: left;
            position: relative;
            box-shadow: 0 4px 0 #ccc;
            transition: all 0.1s;
        }

        .option-btn:hover:not(:disabled) {
            transform: scale(1.02);
            border-color: var(--primary);
            background-color: #fcf6ff;
        }

        .option-btn:active:not(:disabled) {
            transform: translateY(4px);
            box-shadow: 0 0 0 #ccc;
        }

        .option-btn.selected {
            border-color: var(--primary);
            background-color: #ede7f6;
            box-shadow: 0 4px 0 var(--primary);
            color: var(--primary);
            font-weight: bold;
        }

        /* States after checking */
        .option-btn.correct {
            background-color: var(--correct) !important;
            color: white !important;
            border-color: var(--correct-dark) !important;
            box-shadow: 0 4px 0 var(--correct-dark) !important;
        }

        .option-btn.wrong {
            background-color: var(--wrong) !important;
            color: white !important;
            border-color: var(--wrong-dark) !important;
            box-shadow: 0 4px 0 var(--wrong-dark) !important;
            animation: shake 0.5s;
        }

        @keyframes shake {
            0% { transform: translateX(0); }
            25% { transform: translateX(-5px); }
            50% { transform: translateX(5px); }
            75% { transform: translateX(-5px); }
            100% { transform: translateX(0); }
        }

        /* --- Explanation Box --- */
        .explanation-box {
            display: none; /* Hidden by default */
            margin-top: 20px;
            background: #fff;
            border: 2px solid var(--secondary);
            border-radius: 15px;
            padding: 20px;
            animation: slideDown 0.4s ease-out;
        }

        @keyframes slideDown {
            from { opacity: 0; transform: translateY(-10px); }
            to { opacity: 1; transform: translateY(0); }
        }

        .exp-header {
            font-weight: 800;
            color: var(--secondary-dark);
            margin-bottom: 10px;
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .exp-content p {
            margin-bottom: 8px;
            line-height: 1.6;
        }

        .exp-label {
            font-weight: 700;
            color: var(--primary);
            text-decoration: underline;
        }

        .check-btn {
            margin-top: 15px;
            background: var(--secondary);
            color: white;
            border: none;
            padding: 10px 25px;
            font-size: 1rem;
            font-weight: 700;
            border-radius: 50px;
            box-shadow: 0 4px 0 var(--secondary-dark);
            cursor: pointer;
            transition: all 0.2s;
            display: inline-block;
        }

        .check-btn:hover {
            filter: brightness(1.1);
        }

        .check-btn:active {
            transform: translateY(4px);
            box-shadow: none;
        }

        .check-btn:disabled {
            background: #ccc;
            box-shadow: none;
            cursor: not-allowed;
            transform: none;
        }

        /* --- Footer --- */
        .sticky-footer {
            position: fixed;
            bottom: 0;
            left: 0;
            width: 100%;
            background: white;
            padding: 15px;
            box-shadow: 0 -4px 20px rgba(0,0,0,0.1);
            display: flex;
            justify-content: center;
            align-items: center;
            z-index: 1000;
        }

        .submit-all-btn {
            background: var(--primary);
            color: white;
            font-size: 1.2rem;
            font-weight: 800;
            padding: 12px 50px;
            border: none;
            border-radius: 50px;
            box-shadow: 0 6px 0 var(--primary-dark);
            cursor: pointer;
            transition: all 0.2s;
            text-transform: uppercase;
            letter-spacing: 1px;
        }

        .submit-all-btn:hover {
            transform: scale(1.05);
        }
        
        .submit-all-btn:active {
            transform: translateY(6px) scale(1.05);
            box-shadow: none;
        }

        /* --- Modal --- */
        .modal {
            display: none;
            position: fixed;
            z-index: 2000;
            left: 0;
            top: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0,0,0,0.6);
            align-items: center;
            justify-content: center;
            backdrop-filter: blur(5px);
        }

        .modal-content {
            background-color: #fff;
            padding: 40px;
            border-radius: 30px;
            text-align: center;
            max-width: 500px;
            width: 90%;
            box-shadow: 0 20px 50px rgba(0,0,0,0.3);
            border: 4px solid var(--primary);
            animation: pop 0.4s cubic-bezier(0.175, 0.885, 0.32, 1.275);
        }

        @keyframes pop {
            from { transform: scale(0.5); opacity: 0; }
            to { transform: scale(1); opacity: 1; }
        }

        .score-circle {
            width: 120px;
            height: 120px;
            background: var(--primary);
            color: white;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 2.5rem;
            font-weight: 900;
            margin: 0 auto 20px;
            border: 5px solid white;
            box-shadow: 0 0 0 5px var(--primary);
        }

        .modal h2 {
            color: var(--text-color);
            margin-bottom: 10px;
        }

        .modal p {
            color: #666;
            margin-bottom: 25px;
        }

        .close-modal {
            background: var(--secondary);
            color: white;
            padding: 10px 30px;
            border-radius: 50px;
            text-decoration: none;
            font-weight: bold;
            box-shadow: 0 4px 0 var(--secondary-dark);
            cursor: pointer;
            border: none;
        }

        /* Utility */
        .hidden { display: none; }
        u { text-decoration: underline; text-decoration-thickness: 2px; text-decoration-color: var(--primary); }
    </style>
</head>
<body>

    <header>
        <div class="teacher-badge">
            <div class="teacher-avatar">M</div>
            <span>Ms Mai An - ULIS</span>
        </div>
        <div style="font-weight: 700; color: #555;">B√†i Ki·ªÉm Tra ƒê·ªçc Hi·ªÉu</div>
    </header>

    <div class="container">
        
        <div class="card" id="passage1">
            <h2>Exercise 1 Part 1: Gap Fill - Factors Influencing Shopping</h2>
            
            <div class="reading-passage">
                ÔÇÅ The most important (1) ____________ that influences a person to go shopping is the needs or wants of the individual or people related (2) ____________ him/ her. For example, everyone goes to the mall to buy basic necessities like food, clothes, health supplies and others. Irrespective of the age being 16 or 60, the person will have to go to the shop or buy it only. They will shop less if they have less mouth to feed and shop more if the number of dependents is (3) ____________. Secondly, a person cannot purchase anything (4) ____________ he/ she has the monetary means to do so. This means that if one has more money, one will spend equally on luxury items and fundamental needs. On the other hand, a person with less (5) ____________ stability will focus more on vital merchandise.
            </div>

            <div class="glossary-box">
                <table class="glossary-table">
                    <thead>
                        <tr>
                            <th colspan="3">üåü T·ª´ v·ª±ng "X·ªãn" c·∫ßn nh·ªõ (Glossary)</th>
                        </tr>
                        <tr>
                            <th width="30%">Word</th>
                            <th width="15%">Type</th>
                            <th>Meaning & Context</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr>
                            <td><b>Necessity</b></td>
                            <td>(n)</td>
                            <td>Nhu y·∫øu ph·∫©m (Basic needs like food, water)</td>
                        </tr>
                        <tr>
                            <td><b>Irrespective of</b></td>
                            <td>(prep)</td>
                            <td><span class="academic-tag">C1</span>B·∫•t k·ªÉ (Regardless of)</td>
                        </tr>
                        <tr>
                            <td><b>Monetary means</b></td>
                            <td>(NP)</td>
                            <td><span class="academic-tag">C2</span>Ph∆∞∆°ng ti·ªán ti·ªÅn t·ªá (Ti·ªÅn b·∫°c/T√†i ch√≠nh)</td>
                        </tr>
                        <tr>
                            <td><b>Merchandise</b></td>
                            <td>(n)</td>
                            <td>H√†ng h√≥a (Goods for sale)</td>
                        </tr>
                    </tbody>
                </table>
            </div>

            <div id="questions-ex1-p1"></div>
        </div>

        <div class="card" id="passage2">
            <h2>Exercise 1 Part 2: Gap Fill - Shopping Apps</h2>
            
            <div class="reading-passage">
                ÔÇÇ If you have some favourite stores or online retailers, you may already have their shopping apps on your phone. Or, you might (1) _________an app to get a discount on your first purchase with a business, or early access to sales. Some shopping apps do several things. They might let you store a shopping list and will send you sale alerts, (2) _________codes, coupons, special promotions, or other rewards based on how much you (3) _________.
                <br><br>
                When you set up your profile or buy something with a shopping app for the first time, it will likely ask you to link or store your (4) _________information. Some apps charge your credit or debit card or your bank account each time you buy something. (5) _________ apps let you store value with the app and spend down the stored value every time you buy something. Before you install an app, check its description or user agreement to see if it tells you how the payment system works and what to do if there is a(n) billing problem.
            </div>

            <div class="glossary-box">
                <table class="glossary-table">
                    <thead>
                        <tr>
                            <th colspan="3">üåü T·ª´ v·ª±ng C√¥ng ngh·ªá & Mua s·∫Øm (Glossary)</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr>
                            <td><b>Retailer</b></td>
                            <td>(n)</td>
                            <td>Nh√† b√°n l·∫ª</td>
                        </tr>
                        <tr>
                            <td><b>Alert</b></td>
                            <td>(n)</td>
                            <td>Th√¥ng b√°o/C·∫£nh b√°o (Notification)</td>
                        </tr>
                        <tr>
                            <td><b>Debit card</b></td>
                            <td>(n)</td>
                            <td>Th·∫ª ghi n·ª£ (Ti·ªÅn trong t√†i kho·∫£n c√≥ bao nhi√™u d√πng b·∫•y nhi√™u)</td>
                        </tr>
                        <tr>
                            <td><b>Billing problem</b></td>
                            <td>(NP)</td>
                            <td>V·∫•n ƒë·ªÅ v·ªÅ thanh to√°n/h√≥a ƒë∆°n</td>
                        </tr>
                    </tbody>
                </table>
            </div>

            <div id="questions-ex1-p2"></div>
        </div>

        <div class="card" id="passage3">
            <h2>Exercise 2: Reading Comprehension - Black Friday</h2>
            
            <div class="reading-passage">
                ÔÇÅ Black Friday and Cyber Monday promote mindless consumption, excessive packaging and shipping waste, especially with the rise of online shopping. The sales produce massive waste not just from the unwanted single-use plastic and cardboard packaging, but also from the return of unwanted items. This mindset also ensures that the earth overshoot day keeps moving back.
                <br><br>
                This is especially true of the clothing industry, where much of the online returns are tossed into the landfill because the logistics and cost of putting the item back on the shelf are much too complicated. Britons throw away approximately 300,000 tonnes of clothes every year and many of them are only worn a handful of times.
                <br><br>
                The negative impact of Black Friday is also significant from non-recyclable, mostly plastic toys, to e-waste, to fast fashion that is only used for one season. In fact, in France, the government is considering banning Black Friday due to the impact on the planet and the promotion of unsustainable consumption habits.
            </div>

             <div class="glossary-box">
                <table class="glossary-table">
                    <thead>
                        <tr>
                            <th colspan="3">üåü T·ª´ v·ª±ng M√¥i tr∆∞·ªùng n√¢ng cao (Glossary)</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr>
                            <td><b>Mindless consumption</b></td>
                            <td>(NP)</td>
                            <td><span class="academic-tag">C2</span>Ti√™u d√πng thi·∫øu suy nghƒ©/v√¥ t·ªôi v·∫°</td>
                        </tr>
                        <tr>
                            <td><b>Logistics</b></td>
                            <td>(n)</td>
                            <td>H·∫≠u c·∫ßn (V·∫≠n chuy·ªÉn, kho b√£i)</td>
                        </tr>
                        <tr>
                            <td><b>Landfill</b></td>
                            <td>(n)</td>
                            <td>B√£i r√°c th·∫£i</td>
                        </tr>
                        <tr>
                            <td><b>Unsustainable</b></td>
                            <td>(adj)</td>
                            <td><span class="academic-tag">C1</span>Kh√¥ng b·ªÅn v·ªØng (G√¢y h·∫°i cho t∆∞∆°ng lai)</td>
                        </tr>
                    </tbody>
                </table>
            </div>

            <div id="questions-ex2"></div>
        </div>

    </div>

    <div class="sticky-footer">
        <button class="submit-all-btn" onclick="submitExam()">N·ªòP B√ÄI (SUBMIT)</button>
    </div>

    <div id="resultModal" class="modal">
        <div class="modal-content">
            <div class="score-circle" id="scoreDisplay">0</div>
            <h2 id="modalTitle">K·∫øt qu·∫£</h2>
            <p id="modalMessage">H√£y xem l·∫°i l·ªùi gi·∫£i chi ti·∫øt b√™n d∆∞·ªõi nh√©!</p>
            <button class="close-modal" onclick="closeModal()">Xem chi ti·∫øt gi·∫£i th√≠ch</button>
        </div>
    </div>

    <script>
        // Simple Audio Synthesizer for Ding and Buzz to keep file single
        const audioCtx = new (window.AudioContext || window.webkitAudioContext)();

        function playDing() {
            if(audioCtx.state === 'suspended') audioCtx.resume();
            const oscillator = audioCtx.createOscillator();
            const gainNode = audioCtx.createGain();
            oscillator.connect(gainNode);
            gainNode.connect(audioCtx.destination);
            oscillator.type = 'sine';
            oscillator.frequency.setValueAtTime(523.25, audioCtx.currentTime); // C5
            oscillator.frequency.exponentialRampToValueAtTime(1046.5, audioCtx.currentTime + 0.1); // C6
            gainNode.gain.setValueAtTime(0.5, audioCtx.currentTime);
            gainNode.gain.exponentialRampToValueAtTime(0.01, audioCtx.currentTime + 0.5);
            oscillator.start();
            oscillator.stop(audioCtx.currentTime + 0.5);
        }

        function playBuzz() {
            if(audioCtx.state === 'suspended') audioCtx.resume();
            const oscillator = audioCtx.createOscillator();
            const gainNode = audioCtx.createGain();
            oscillator.connect(gainNode);
            gainNode.connect(audioCtx.destination);
            oscillator.type = 'sawtooth';
            oscillator.frequency.setValueAtTime(150, audioCtx.currentTime);
            oscillator.frequency.linearRampToValueAtTime(100, audioCtx.currentTime + 0.3);
            gainNode.gain.setValueAtTime(0.5, audioCtx.currentTime);
            gainNode.gain.linearRampToValueAtTime(0.01, audioCtx.currentTime + 0.3);
            oscillator.start();
            oscillator.stop(audioCtx.currentTime + 0.3);
        }
    </script>

    <script>
        // DATA OBJECT
        const examData = {
            "ex1-p1": [
                {
                    id: "ex1-p1-q1",
                    qText: "1. The most important (1) ____________ that influences...",
                    options: [
                        {t: "A. effect", m: "T√°c ƒë·ªông/H·∫≠u qu·∫£"},
                        {t: "B. factor", m: "Nh√¢n t·ªë/Y·∫øu t·ªë"},
                        {t: "C. reaction", m: "Ph·∫£n ·ª©ng"},
                        {t: "D. person", m: "Ng∆∞·ªùi"}
                    ],
                    correct: 1, // Index 0-based
                    explanation: {
                        transQ: "D·ªãch: Y·∫øu t·ªë quan tr·ªçng nh·∫•t ·∫£nh h∆∞·ªüng ƒë·∫øn vi·ªác m·ªôt ng∆∞·ªùi ƒëi mua s·∫Øm...",
                        whyRight: "Collocation (C·ª•m t·ª´ c·ªë ƒë·ªãnh): <b>Important factor</b> (Y·∫øu t·ªë quan tr·ªçng). Ta c·∫ßn m·ªôt danh t·ª´ ch·ªâ nguy√™n nh√¢n g√¢y ·∫£nh h∆∞·ªüng.",
                        whyWrong: "<b>Effect</b> l√† k·∫øt qu·∫£/t√°c ƒë·ªông, kh√¥ng ph·∫£i nguy√™n nh√¢n. <b>Reaction</b> kh√¥ng h·ª£p nghƒ©a ng·ªØ c·∫£nh 'nguy√™n nh√¢n'. <b>Person</b> sai ng·ªØ ph√°p v√¨ c√¢u ƒëang n√≥i v·ªÅ v·∫≠t/ƒëi·ªÅu g√¨ ƒë√≥."
                    }
                },
                {
                    id: "ex1-p1-q2",
                    qText: "2. ...people related (2) ____________ him/ her.",
                    options: [
                        {t: "A. to", m: "ƒë·∫øn/v·ªõi"},
                        {t: "B. with", m: "c√πng"},
                        {t: "C. about", m: "v·ªÅ"},
                        {t: "D. within", m: "trong v√≤ng"}
                    ],
                    correct: 0,
                    explanation: {
                        transQ: "D·ªãch: ...nh·ªØng ng∆∞·ªùi c√≥ li√™n quan ƒë·∫øn anh ·∫•y/c√¥ ·∫•y.",
                        whyRight: "C·∫•u tr√∫c: <b>Related to somebody/something</b> (C√≥ li√™n quan ƒë·∫øn ai/c√°i g√¨).",
                        whyWrong: "C√°c gi·ªõi t·ª´ <b>with, about, within</b> kh√¥ng ƒëi k√®m v·ªõi t√≠nh t·ª´ 'related' trong ng·ªØ c·∫£nh n√†y."
                    }
                },
                {
                    id: "ex1-p1-q3",
                    qText: "3. ...shop less if they have less mouth to feed and shop more if the number of dependents is (3) ____________.",
                    options: [
                        {t: "A. least", m: "√≠t nh·∫•t"},
                        {t: "B. less", m: "√≠t h∆°n"},
                        {t: "C. many", m: "nhi·ªÅu"},
                        {t: "D. more", m: "nhi·ªÅu h∆°n"}
                    ],
                    correct: 3,
                    explanation: {
                        transQ: "D·ªãch: H·ªç s·∫Ω mua s·∫Øm √≠t h∆°n n·∫øu c√≥ √≠t mi·ªáng ƒÉn v√† mua nhi·ªÅu h∆°n n·∫øu s·ªë l∆∞·ª£ng ng∆∞·ªùi ph·ª• thu·ªôc nhi·ªÅu h∆°n.",
                        whyRight: "C·∫•u tr√∫c so s√°nh song song: V·∫ø tr∆∞·ªõc 'shop less... less mouth' (√≠t - √≠t), v·∫ø sau 'shop more... dependents is more' (nhi·ªÅu - nhi·ªÅu).",
                        whyWrong: "<b>Less/Least</b> mang nghƒ©a √≠t, ng∆∞·ª£c v·ªõi ng·ªØ c·∫£nh 'shop more'. <b>Many</b> l√† t√≠nh t·ª´ nguy√™n th·ªÉ, ·ªü ƒë√¢y c·∫ßn so s√°nh h∆°n ƒë·ªÉ ƒë·ªëi ·ª©ng v·ªõi 'less'."
                    }
                },
                {
                    id: "ex1-p1-q4",
                    qText: "4. ...a person cannot purchase anything (4) ____________ he/ she has the monetary means...",
                    options: [
                        {t: "A. when", m: "khi"},
                        {t: "B. if", m: "n·∫øu"},
                        {t: "C. unless", m: "tr·ª´ khi (n·∫øu kh√¥ng)"},
                        {t: "D. whether", m: "li·ªáu"}
                    ],
                    correct: 2,
                    explanation: {
                        transQ: "D·ªãch: M·ªôt ng∆∞·ªùi kh√¥ng th·ªÉ mua b·∫•t c·ª© th·ª© g√¨ TR·ª™ KHI h·ªç c√≥ ti·ªÅn ƒë·ªÉ l√†m ƒëi·ªÅu ƒë√≥.",
                        whyRight: "<b>Unless = If not</b>. C√¢u mang nghƒ©a ƒëi·ªÅu ki·ªán ph·ªß ƒë·ªãnh: Kh√¥ng c√≥ ti·ªÅn th√¨ kh√¥ng mua ƒë∆∞·ª£c.",
                        whyWrong: "N·∫øu d√πng <b>If</b>: Kh√¥ng th·ªÉ mua N·∫æU c√≥ ti·ªÅn -> Sai logic. <b>When</b> v√† <b>Whether</b> kh√¥ng t·∫°o th√†nh c√¢u ƒëi·ªÅu ki·ªán ph√π h·ª£p nghƒ©a."
                    }
                },
                {
                    id: "ex1-p1-q5",
                    qText: "5. ...a person with less (5) ____________ stability...",
                    options: [
                        {t: "A. finance", m: "t√†i ch√≠nh (danh t·ª´)"},
                        {t: "B. financial", m: "thu·ªôc v·ªÅ t√†i ch√≠nh (t√≠nh t·ª´)"},
                        {t: "C. financials", m: "b√°o c√°o t√†i ch√≠nh (danh t·ª´)"},
                        {t: "D. financially", m: "v·ªÅ m·∫∑t t√†i ch√≠nh (tr·∫°ng t·ª´)"}
                    ],
                    correct: 1,
                    explanation: {
                        transQ: "D·ªãch: ...m·ªôt ng∆∞·ªùi c√≥ s·ª± ·ªïn ƒë·ªãnh T√ÄI CH√çNH th·∫•p h∆°n...",
                        whyRight: "V·ªã tr√≠ tr∆∞·ªõc danh t·ª´ 'stability' (s·ª± ·ªïn ƒë·ªãnh) c·∫ßn m·ªôt <b>T√≠nh t·ª´</b> ƒë·ªÉ b·ªï nghƒ©a.",
                        whyWrong: "<b>Finance</b> l√† danh t·ª´. <b>Financially</b> l√† tr·∫°ng t·ª´. Ta c·∫ßn t√≠nh t·ª´ b·ªï nghƒ©a cho danh t·ª´."
                    }
                }
            ],
            "ex1-p2": [
                {
                    id: "ex1-p2-q1",
                    qText: "1. Or, you might (1) _________an app...",
                    options: [
                        {t: "A. upload", m: "t·∫£i l√™n"},
                        {t: "B. download", m: "t·∫£i xu·ªëng"},
                        {t: "C. report", m: "b√°o c√°o"},
                        {t: "D. uninstall", m: "g·ª° c√†i ƒë·∫∑t"}
                    ],
                    correct: 1,
                    explanation: {
                        transQ: "D·ªãch: Ho·∫∑c, b·∫°n c√≥ th·ªÉ t·∫£i xu·ªëng m·ªôt ·ª©ng d·ª•ng...",
                        whyRight: "H√†nh ƒë·ªông l·∫•y app v·ªÅ ƒëi·ªán tho·∫°i ƒë·ªÉ d√πng l√† <b>download</b>.",
                        whyWrong: "<b>Upload</b> l√† ƒë∆∞a l√™n. <b>Uninstall</b> l√† x√≥a ƒëi. Ng·ªØ c·∫£nh l√† b·∫Øt ƒë·∫ßu s·ª≠ d·ª•ng app ƒë·ªÉ l·∫•y m√£ gi·∫£m gi√°."
                    }
                },
                {
                    id: "ex1-p2-q2",
                    qText: "2. ...send you sale alerts, (2) _________codes...",
                    options: [
                        {t: "A. password", m: "m·∫≠t kh·∫©u"},
                        {t: "B. recovery", m: "kh√¥i ph·ª•c"},
                        {t: "C. account", m: "t√†i kho·∫£n"},
                        {t: "D. discount", m: "gi·∫£m gi√°"}
                    ],
                    correct: 3,
                    explanation: {
                        transQ: "D·ªãch: ...g·ª≠i cho b·∫°n th√¥ng b√°o gi·∫£m gi√°, m√£ gi·∫£m gi√° (discount codes)...",
                        whyRight: "Collocation: <b>Discount codes</b> (M√£ gi·∫£m gi√°/M√£ khuy·∫øn m√£i).",
                        whyWrong: "Password codes hay Account codes kh√¥ng h·ª£p l√Ω trong ng·ªØ c·∫£nh nh·∫≠n th∆∞·ªüng/khuy·∫øn m√£i."
                    }
                },
                {
                    id: "ex1-p2-q3",
                    qText: "3. ...rewards based on how much you (3) _________.",
                    options: [
                        {t: "A. buy", m: "mua"},
                        {t: "B. make", m: "l√†m"},
                        {t: "C. sell", m: "b√°n"},
                        {t: "D. take", m: "l·∫•y"}
                    ],
                    correct: 0,
                    explanation: {
                        transQ: "D·ªãch: ...ph·∫ßn th∆∞·ªüng d·ª±a tr√™n vi·ªác b·∫°n mua bao nhi√™u.",
                        whyRight: "App mua s·∫Øm th∆∞·ªüng cho kh√°ch h√†ng d·ª±a tr√™n l∆∞·ª£ng h√†ng h·ªç <b>mua (buy)</b>.",
                        whyWrong: "Kh√°ch h√†ng kh√¥ng 'b√°n' (sell) hay 'l√†m' (make) trong ng·ªØ c·∫£nh n√†y."
                    }
                },
                {
                    id: "ex1-p2-q4",
                    qText: "4. ...link or store your (4) _________information.",
                    options: [
                        {t: "A. paid", m: "ƒë√£ tr·∫£"},
                        {t: "B. payment", m: "thanh to√°n"},
                        {t: "C. paying", m: "ƒëang tr·∫£"},
                        {t: "D. payer", m: "ng∆∞·ªùi tr·∫£"}
                    ],
                    correct: 1,
                    explanation: {
                        transQ: "D·ªãch: ...y√™u c·∫ßu b·∫°n li√™n k·∫øt ho·∫∑c l∆∞u tr·ªØ th√¥ng tin thanh to√°n c·ªßa b·∫°n.",
                        whyRight: "Danh t·ª´ gh√©p: <b>Payment information</b> (Th√¥ng tin d√πng ƒë·ªÉ tr·∫£ ti·ªÅn: th·∫ª, t√†i kho·∫£n...).",
                        whyWrong: "<b>Paid</b> l√† qu√° kh·ª© ph√¢n t·ª´. <b>Payer</b> l√† ch·ªâ ng∆∞·ªùi. ·ªû ƒë√¢y c·∫ßn danh t·ª´ ch·ªâ h√†nh ƒë·ªông/ph∆∞∆°ng th·ª©c."
                    }
                },
                {
                    id: "ex1-p2-q5",
                    qText: "5. (5) _________ apps let you store value...",
                    options: [
                        {t: "A. Other", m: "Nh·ªØng c√°i kh√°c (ƒëi v·ªõi N s·ªë nhi·ªÅu)"},
                        {t: "B. Another", m: "M·ªôt c√°i kh√°c (ƒëi v·ªõi N s·ªë √≠t)"},
                        {t: "C. Others", m: "Nh·ªØng c√°i kh√°c (ƒë·ª©ng m·ªôt m√¨nh)"},
                        {t: "D. One another", m: "L·∫´n nhau"}
                    ],
                    correct: 0,
                    explanation: {
                        transQ: "D·ªãch: C√°c ·ª©ng d·ª•ng kh√°c cho ph√©p b·∫°n l∆∞u tr·ªØ gi√° tr·ªã...",
                        whyRight: "Sau ch·ªó tr·ªëng l√† danh t·ª´ s·ªë nhi·ªÅu 'apps'. <b>Other + N(s·ªë nhi·ªÅu)</b>.",
                        whyWrong: "<b>Another</b> + N(s·ªë √≠t). <b>Others</b> ƒë√≥ng vai tr√≤ ƒë·∫°i t·ª´, kh√¥ng ƒëi k√®m danh t·ª´ ph√≠a sau. <b>One another</b> ch·ªâ s·ª± t∆∞∆°ng t√°c l·∫´n nhau."
                    }
                }
            ],
            "ex2": [
                {
                    id: "ex2-q1",
                    qText: "1. The passage mainly _________.",
                    options: [
                        {t: "A. explains why Black Friday sales are bad for the environment", m: "gi·∫£i th√≠ch t·∫°i sao gi·∫£m gi√° Black Friday c√≥ h·∫°i cho m√¥i tr∆∞·ªùng"},
                        {t: "B. describes shopping activities on Black Friday", m: "m√¥ t·∫£ ho·∫°t ƒë·ªông mua s·∫Øm"},
                        {t: "C. criticizes the unwanted single-use plastic", m: "ph√™ ph√°n nh·ª±a d√πng m·ªôt l·∫ßn"},
                        {t: "D. concerns about the impact of non-recyclable products", m: "lo ng·∫°i v·ªÅ t√°c ƒë·ªông c·ªßa s·∫£n ph·∫©m kh√¥ng t√°i ch·∫ø"}
                    ],
                    correct: 0,
                    explanation: {
                        transQ: "D·ªãch: ƒêo·∫°n vƒÉn ch·ªß y·∫øu... gi·∫£i th√≠ch t·∫°i sao Black Friday c√≥ h·∫°i cho m√¥i tr∆∞·ªùng.",
                        whyRight: "B√†i ƒë·ªçc nh·∫Øc ƒë·∫øn 'shipping waste', 'plastic packaging', 'tossed into landfill', 'negative impact'. T·∫•t c·∫£ ƒë·ªÅu xoay quanh t√°c h·∫°i m√¥i tr∆∞·ªùng.",
                        whyWrong: "B, C, D ch·ªâ l√† c√°c √Ω nh·ªè chi ti·∫øt trong b√†i, kh√¥ng bao qu√°t to√†n b·ªô n·ªôi dung."
                    }
                },
                {
                    id: "ex2-q2",
                    qText: "2. The word ‚Äúrise‚Äù in the first paragraph can be best replaced by _________.",
                    options: [
                        {t: "A. drop", m: "s·ª•t gi·∫£m"},
                        {t: "B. improvement", m: "c·∫£i thi·ªán"},
                        {t: "C. increase", m: "s·ª± gia tƒÉng"},
                        {t: "D. fall", m: "r∆°i/gi·∫£m"}
                    ],
                    correct: 2,
                    explanation: {
                        transQ: "D·ªãch: T·ª´ 'rise' (s·ª± tr·ªói d·∫≠y/tƒÉng l√™n) c√≥ th·ªÉ thay th·∫ø b·∫±ng...",
                        whyRight: "<b>Rise = Increase</b>. Ng·ªØ c·∫£nh: 'rise of online shopping' (s·ª± gia tƒÉng c·ªßa mua s·∫Øm tr·ª±c tuy·∫øn).",
                        whyWrong: "<b>Drop</b> v√† <b>Fall</b> l√† gi·∫£m (tr√°i nghƒ©a). <b>Improvement</b> l√† c·∫£i thi·ªán, kh√¥ng s√°t nghƒ©a b·∫±ng tƒÉng v·ªÅ s·ªë l∆∞·ª£ng/quy m√¥."
                    }
                },
                {
                    id: "ex2-q3",
                    qText: "3. According to the second paragraph, what do people do with much of the online returns?",
                    options: [
                        {t: "A. People carefully put the online returns on the shelf.", m: "C·∫©n th·∫≠n ƒë·∫∑t l·∫°i l√™n k·ªá"},
                        {t: "B. People resend the online returns to the logistics agent.", m: "G·ª≠i l·∫°i cho b√™n v·∫≠n chuy·ªÉn"},
                        {t: "C. People have to pay more for the online returns.", m: "Ph·∫£i tr·∫£ th√™m ti·ªÅn"},
                        {t: "D. People throw the online returns to the landfill.", m: "V·ª©t ra b√£i r√°c"}
                    ],
                    correct: 3,
                    explanation: {
                        transQ: "D·ªãch: Theo ƒëo·∫°n 2, m·ªçi ng∆∞·ªùi l√†m g√¨ v·ªõi ph·∫ßn l·ªõn h√†ng tr·∫£ l·∫°i?",
                        whyRight: "D·∫´n ch·ª©ng: <i>'...much of the online returns are tossed into the landfill...'</i> (ph·∫ßn l·ªõn h√†ng tr·∫£ l·∫°i b·ªã n√©m v√†o b√£i r√°c).",
                        whyWrong: "B√†i ƒë·ªçc n√≥i vi·ªác ƒë∆∞a h√†ng l√™n k·ªá (A) l√† 'too complicated' (qu√° ph·ª©c t·∫°p) n√™n h·ªç m·ªõi v·ª©t ƒëi."
                    }
                },
                {
                    id: "ex2-q4",
                    qText: "4. The word ‚Äúbanning‚Äù in the third paragraph is closest in meaning to _____________.",
                    options: [
                        {t: "A. encouraging", m: "khuy·∫øn kh√≠ch"},
                        {t: "B. stopping", m: "d·ª´ng l·∫°i"},
                        {t: "C. allowing", m: "cho ph√©p"},
                        {t: "D. forbidding", m: "c·∫•m ƒëo√°n"}
                    ],
                    correct: 3,
                    explanation: {
                        transQ: "D·ªãch: T·ª´ 'banning' (c·∫•m) g·∫ßn nghƒ©a nh·∫•t v·ªõi...",
                        whyRight: "<b>Ban = Forbid</b> (C·∫•m ƒëo√°n v·ªÅ m·∫∑t lu·∫≠t ph√°p/quy ƒë·ªãnh).",
                        whyWrong: "<b>Encouraging</b> v√† <b>Allowing</b> l√† tr√°i nghƒ©a. <b>Stopping</b> (d·ª´ng) nh·∫π h∆°n v√† kh√¥ng mang t√≠nh ch·∫•t ph√°p l√Ω m·∫°nh nh∆∞ Forbidding."
                    }
                },
                {
                    id: "ex2-q5",
                    qText: "5. Which of the following statements is not true according to the passage?",
                    options: [
                        {t: "A. Cardboard packaging contributes to produce massive waste.", m: "Bao b√¨ b√¨a c·ª©ng g√≥p ph·∫ßn t·∫°o r√°c th·∫£i l·ªõn"},
                        {t: "B. Britons don‚Äôt throw away their clothes.", m: "Ng∆∞·ªùi Anh kh√¥ng v·ª©t qu·∫ßn √°o ƒëi"},
                        {t: "C. Returning online items is really complicated.", m: "Tr·∫£ h√†ng online r·∫•t ph·ª©c t·∫°p"},
                        {t: "D. The French government is considering banning Black Friday.", m: "Ch√≠nh ph·ªß Ph√°p c√¢n nh·∫Øc c·∫•m Black Friday"}
                    ],
                    correct: 1,
                    explanation: {
                        transQ: "D·ªãch: C√¢u n√†o KH√îNG ƒê√öNG?",
                        whyRight: "D·∫´n ch·ª©ng ng∆∞·ª£c: B√†i ƒë·ªçc n√≥i <i>'Britons throw away approximately 300,000 tonnes of clothes every year'</i> (Ng∆∞·ªùi Anh v·ª©t 300 ng√†n t·∫•n qu·∫ßn √°o). V·∫≠y c√¢u B n√≥i h·ªç 'kh√¥ng v·ª©t' l√† SAI.",
                        whyWrong: "C√°c c√¢u A, C, D ƒë·ªÅu c√≥ th√¥ng tin ƒë√∫ng trong b√†i ƒë·ªçc."
                    }
                }
            ]
        };

        // RENDER QUESTIONS
        function renderQuestions(containerId, dataKey) {
            const container = document.getElementById(containerId);
            const questions = examData[dataKey];

            questions.forEach((q, index) => {
                const qBlock = document.createElement('div');
                qBlock.className = 'question-block';
                qBlock.id = q.id;

                let html = `<div class="question-text">${q.qText}</div>`;
                html += `<div class="options-grid">`;
                
                q.options.forEach((opt, idx) => {
                    html += `<button class="option-btn" onclick="selectAnswer('${q.id}', ${idx})">${opt.t}<br><small style="color:#888; font-size:0.85em">(${opt.m})</small></button>`;
                });
                
                html += `</div>`;
                
                // N√∫t Check
                html += `<button class="check-btn" id="btn-${q.id}" onclick="checkAnswer('${q.id}', '${dataKey}', ${index})">Ch·ªët ƒë√°p √°n & Xem gi·∫£i th√≠ch</button>`;

                // Explanation Box
                html += `
                <div class="explanation-box" id="exp-${q.id}">
                    <div class="exp-header" id="header-${q.id}"></div>
                    <div class="exp-content">
                        <p>${q.explanation.transQ}</p>
                        <p><span class="exp-label">T·∫°i sao ƒë√∫ng?</span> ${q.explanation.whyRight}</p>
                        <p><span class="exp-label">T·∫°i sao sai?</span> ${q.explanation.whyWrong}</p>
                    </div>
                </div>`;

                qBlock.innerHTML = html;
                container.appendChild(qBlock);
            });
        }

        // Initialize
        renderQuestions('questions-ex1-p1', 'ex1-p1');
        renderQuestions('questions-ex1-p2', 'ex1-p2');
        renderQuestions('questions-ex2', 'ex2');

        // LOGIC
        let userAnswers = {}; // Store { questionId: selectedOptionIndex }
        let checkedQuestions = {}; // Store { questionId: true/false }

        function selectAnswer(qId, optionIdx) {
            if (checkedQuestions[qId]) return; // Prevent changing after checking

            // Save answer
            userAnswers[qId] = optionIdx;

            // UI Update
            const parent = document.getElementById(qId);
            const buttons = parent.querySelectorAll('.option-btn');
            buttons.forEach((btn, idx) => {
                if (idx === optionIdx) btn.classList.add('selected');
                else btn.classList.remove('selected');
            });
        }

        function checkAnswer(qId, dataKey, qIndex) {
            if (userAnswers[qId] === undefined) {
                alert("B·∫°n ch∆∞a ch·ªçn ƒë√°p √°n n√†o c·∫£!");
                return;
            }

            const qData = examData[dataKey][qIndex];
            const selectedIdx = userAnswers[qId];
            const correctIdx = qData.correct;
            const parent = document.getElementById(qId);
            const buttons = parent.querySelectorAll('.option-btn');
            const expBox = document.getElementById(`exp-${qId}`);
            const header = document.getElementById(`header-${qId}`);
            const checkBtn = document.getElementById(`btn-${qId}`);

            checkedQuestions[qId] = true;
            checkBtn.disabled = true;
            checkBtn.innerHTML = "ƒê√£ ki·ªÉm tra";

            // Remove selected class and apply right/wrong
            buttons[selectedIdx].classList.remove('selected');

            if (selectedIdx === correctIdx) {
                // Correct
                buttons[selectedIdx].classList.add('correct');
                header.innerHTML = `üéâ CH√çNH X√ÅC! (Correct)`;
                header.style.color = 'var(--correct)';
                playDing();
                triggerConfetti(checkBtn);
            } else {
                // Wrong
                buttons[selectedIdx].classList.add('wrong');
                buttons[correctIdx].classList.add('correct'); // Show right answer
                header.innerHTML = `‚ö†Ô∏è TI·∫æC QU√Å! (Incorrect)`;
                header.style.color = 'var(--wrong)';
                playBuzz();
            }

            expBox.style.display = 'block';
        }

        function triggerConfetti(element) {
            const rect = element.getBoundingClientRect();
            const x = (rect.left + rect.width / 2) / window.innerWidth;
            const y = (rect.top + rect.height / 2) / window.innerHeight;

            confetti({
                particleCount: 100,
                spread: 70,
                origin: { x: x, y: y },
                colors: ['#8854C0', '#00C9A7', '#00D26A', '#FF4757']
            });
        }

        function submitExam() {
            let totalQ = 0;
            let correctCount = 0;
            let unAnswered = 0;

            // Loop through all data
            for (let key in examData) {
                examData[key].forEach(q => {
                    totalQ++;
                    if (userAnswers[q.id] === q.correct) {
                        correctCount++;
                    }
                    if (!checkedQuestions[q.id]) {
                        // Mark unanswered/unchecked questions
                        const parent = document.getElementById(q.id);
                        if(userAnswers[q.id] !== undefined) {
                            // User selected but didn't click Check -> Check for them
                             // Find index in examData array
                             const idx = examData[key].findIndex(item => item.id === q.id);
                             checkAnswer(q.id, key, idx);
                             if (userAnswers[q.id] === q.correct) correctCount++; // Re-count if we just checked it and it was right (wait, logic overlap, simplification needed below)
                        } else {
                            unAnswered++;
                            // Highlight unanswered
                            parent.style.border = "2px solid #FFCC00";
                            const expBox = document.getElementById(`exp-${q.id}`);
                            expBox.style.display = 'block';
                            expBox.innerHTML = `<b style='color:#FF4757'>B·∫°n ch∆∞a l√†m c√¢u n√†y! ƒê√°p √°n ƒë√∫ng l√†: ${q.options[q.correct].t}</b>` + expBox.innerHTML;
                        }
                    }
                });
            }
            
            // Recalculate correct count based on the 'checked' state which is now fully updated or marked
            // Simplification: Count directly from userAnswers vs Correct
            correctCount = 0;
            for (let key in examData) {
                examData[key].forEach(q => {
                    if (userAnswers[q.id] === q.correct) correctCount++;
                });
            }

            const scoreDisplay = document.getElementById('scoreDisplay');
            const modalMessage = document.getElementById('modalMessage');
            
            scoreDisplay.innerText = `${correctCount}/${totalQ}`;
            
            if (correctCount === totalQ) {
                modalMessage.innerText = "Tuy·ªát v·ªùi! B·∫°n ƒë√£ l√†m ƒë√∫ng tuy·ªát ƒë·ªëi! Ms Mai An r·∫•t t·ª± h√†o!";
                confetti({ particleCount: 200, spread: 100, origin: { y: 0.6 } });
            } else if (correctCount > totalQ * 0.7) {
                modalMessage.innerText = "L√†m t·ªët l·∫Øm! H√£y xem l·∫°i c√°c l·ªói sai nh·ªè nh√©.";
            } else {
                modalMessage.innerText = "C·ªë g·∫Øng h∆°n l·∫ßn sau nh√©! H√£y ƒë·ªçc k·ªπ ph·∫ßn gi·∫£i th√≠ch b√™n d∆∞·ªõi.";
            }

            document.getElementById('resultModal').style.display = 'flex';
        }

        function closeModal() {
            document.getElementById('resultModal').style.display = 'none';
        }

        // Close modal when clicking outside
        window.onclick = function(event) {
            const modal = document.getElementById('resultModal');
            if (event.target == modal) {
                modal.style.display = "none";
            }
        }
    </script>
</body>
</html>