<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Relative Clauses Mastery - Ms. Mai An ULIS</title>
    <!-- Google Fonts: Quicksand for friendly feel -->
    <link href="https://fonts.googleapis.com/css2?family=Quicksand:wght@500;600;700&display=swap" rel="stylesheet">
    <!-- Font Awesome for Icons -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    
    <style>
        :root {
            --primary-purple: #8854C0;
            --primary-teal: #00C9A7;
            --correct-green: #00D26A;
            --wrong-red: #FF4757;
            --bg-pastel: #f0f4f8;
            --card-shadow: 0 10px 0 rgba(0,0,0,0.1);
        }

        body {
            font-family: 'Quicksand', sans-serif;
            background-color: #E0F7FA;
            background-image: 
                radial-gradient(#00C9A7 15%, transparent 16%),
                radial-gradient(#8854C0 15%, transparent 16%);
            background-size: 60px 60px;
            background-position: 0 0, 30px 30px;
            margin: 0;
            padding: 20px;
            display: flex;
            flex-direction: column;
            align-items: center;
            min-height: 100vh;
            color: #2c3e50;
        }

        /* Header Styles */
        header {
            background: white;
            padding: 15px 30px;
            border-radius: 50px;
            box-shadow: 0 8px 0 rgba(0,0,0,0.1);
            margin-bottom: 20px;
            border: 3px solid var(--primary-purple);
            text-align: center;
            z-index: 10;
        }

        h1 {
            margin: 0;
            color: var(--primary-purple);
            font-size: 1.5rem;
            text-transform: uppercase;
            letter-spacing: 1px;
        }

        .teacher-tag {
            font-size: 0.9rem;
            color: #666;
            font-weight: 600;
        }

        /* Container Styles */
        .quiz-container {
            max-width: 800px;
            width: 100%;
            background: white;
            border-radius: 20px;
            padding: 30px;
            box-shadow: 0 15px 30px rgba(0,0,0,0.15);
            position: relative;
            overflow: hidden;
            display: none; /* Hidden by default, shown via JS */
        }

        .active-screen {
            display: block;
            animation: fadeIn 0.5s ease-out;
        }

        /* Start Screen */
        #start-screen {
            text-align: center;
            padding: 40px;
        }

        /* Question Styles */
        .progress-bar-container {
            width: 100%;
            height: 15px;
            background: #e0e0e0;
            border-radius: 10px;
            margin-bottom: 20px;
            overflow: hidden;
        }

        .progress-bar {
            height: 100%;
            background: var(--primary-teal);
            width: 0%;
            transition: width 0.3s ease;
        }

        .question-box {
            background: #f8f9fa;
            border-left: 5px solid var(--primary-purple);
            padding: 20px;
            border-radius: 10px;
            font-size: 1.3rem;
            font-weight: 700;
            margin-bottom: 25px;
            line-height: 1.6;
        }

        /* Answer Buttons (3D Style) */
        .options-grid {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 15px;
        }

        @media (max-width: 600px) {
            .options-grid {
                grid-template-columns: 1fr;
            }
        }

        .option-btn {
            background: white;
            border: 2px solid #ddd;
            padding: 15px 20px;
            font-size: 1.1rem;
            font-family: 'Quicksand', sans-serif;
            font-weight: 600;
            border-radius: 15px;
            cursor: pointer;
            position: relative;
            transition: all 0.1s;
            box-shadow: 0 6px 0 #ccc;
            text-align: left;
            display: flex;
            align-items: center;
            color: #444;
        }

        .option-btn:active {
            transform: translateY(6px);
            box-shadow: 0 0 0 #ccc;
        }

        .option-btn:hover:not(:disabled) {
            transform: translateY(-2px);
            box-shadow: 0 8px 0 #ccc;
            border-color: var(--primary-purple);
        }

        .option-label {
            background: var(--primary-purple);
            color: white;
            width: 30px;
            height: 30px;
            border-radius: 50%;
            display: flex;
            justify-content: center;
            align-items: center;
            margin-right: 15px;
            font-size: 0.9rem;
            flex-shrink: 0;
        }

        /* Feedback States */
        .option-btn.correct {
            background-color: #d1fae5;
            border-color: var(--correct-green);
            color: #065f46;
            box-shadow: 0 6px 0 #059669;
        }
        .option-btn.correct .option-label { background: var(--correct-green); }

        .option-btn.wrong {
            background-color: #fee2e2;
            border-color: var(--wrong-red);
            color: #991b1b;
            box-shadow: 0 6px 0 #b91c1c;
            animation: shake 0.5s;
        }
        .option-btn.wrong .option-label { background: var(--wrong-red); }

        /* Explanation Box */
        .explanation-box {
            margin-top: 25px;
            background: #fff8e1;
            border: 2px dashed #fbbf24;
            border-radius: 15px;
            padding: 20px;
            display: none; /* Hidden initially */
            animation: slideDown 0.4s ease-out;
        }

        .explanation-header {
            font-weight: 700;
            color: #d97706;
            display: flex;
            align-items: center;
            margin-bottom: 10px;
            font-size: 1.1rem;
        }

        .explanation-content {
            font-size: 1rem;
            line-height: 1.6;
            white-space: pre-line; /* Respect new lines */
        }
        
        .explanation-content b {
            color: var(--primary-purple);
        }

        /* Control Buttons */
        .btn-primary {
            background: var(--primary-teal);
            color: white;
            border: none;
            padding: 15px 40px;
            font-size: 1.2rem;
            border-radius: 50px;
            box-shadow: 0 6px 0 #008f75;
            cursor: pointer;
            font-family: 'Quicksand', sans-serif;
            font-weight: 700;
            margin-top: 20px;
            transition: transform 0.1s;
            display: inline-block;
        }

        .btn-primary:active {
            transform: translateY(6px);
            box-shadow: none;
        }

        .next-btn-container {
            text-align: right;
            margin-top: 20px;
            display: none;
        }

        /* Animations */
        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(20px); }
            to { opacity: 1; transform: translateY(0); }
        }

        @keyframes slideDown {
            from { opacity: 0; transform: translateY(-10px); }
            to { opacity: 1; transform: translateY(0); }
        }

        @keyframes shake {
            0% { transform: translateX(0); }
            25% { transform: translateX(-10px); }
            50% { transform: translateX(10px); }
            75% { transform: translateX(-10px); }
            100% { transform: translateX(0); }
        }

        /* Result Screen */
        .result-score {
            font-size: 3rem;
            font-weight: 800;
            color: var(--primary-purple);
            margin: 20px 0;
        }
        
        /* Canvas for confetti */
        #confetti-canvas {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            pointer-events: none;
            z-index: 100;
        }

        /* Customizing text highlighting in questions */
        u {
            text-decoration: none;
            border-bottom: 3px solid var(--primary-purple);
            padding-bottom: 2px;
        }

    </style>
</head>
<body>

    <header>
        <h1>Relative Clauses Practice</h1>
        <div class="teacher-tag"><i class="fas fa-chalkboard-teacher"></i> Gi√°o vi√™n: Ms. Mai An ULIS</div>
    </header>

    <canvas id="confetti-canvas"></canvas>

    <!-- Start Screen -->
    <div id="start-screen" class="quiz-container active-screen">
        <h2 style="color: var(--primary-teal); font-size: 2rem;">S·∫µn s√†ng ch∆∞a n√†o c√°c em?</h2>
        <img src="https://cdn-icons-png.flaticon.com/512/2921/2921222.png" alt="Quiz Icon" style="width: 150px; margin: 20px 0;">
        <p style="font-size: 1.2rem;">B√†i t·∫≠p g·ªìm 22 c√¢u h·ªèi v·ªÅ M·ªánh ƒë·ªÅ quan h·ªá.</p>
        <p>Ch·ªçn ƒë√∫ng ƒë·ªÉ nh·∫≠n qu√† üéÅ, ch·ªçn sai th√¨... "T√©o t√®o t√®o"! üòÖ</p>
        <button class="btn-primary" onclick="startQuiz()">B·∫Øt ƒë·∫ßu l√†m b√†i <i class="fas fa-play"></i></button>
    </div>

    <!-- Quiz Screen -->
    <div id="quiz-screen" class="quiz-container">
        <div class="header-status" style="display: flex; justify-content: space-between; margin-bottom: 10px; font-weight: bold; color: #666;">
            <span id="question-count">C√¢u 1/22</span>
            <span id="score-display">ƒêi·ªÉm: 0</span>
        </div>
        
        <div class="progress-bar-container">
            <div id="progress-bar" class="progress-bar"></div>
        </div>

        <div id="question-text" class="question-box">
            <!-- Question inserted here -->
        </div>

        <div id="options-container" class="options-grid">
            <!-- Buttons inserted here -->
        </div>

        <!-- Super Detailed Explanation Box -->
        <div id="explanation-area" class="explanation-box">
            <div class="explanation-header">
                <i class="fas fa-lightbulb" style="margin-right: 10px;"></i> Gi·∫£i th√≠ch chi ti·∫øt c·ªßa C√¥ Mai An:
            </div>
            <div id="explanation-content" class="explanation-content">
                <!-- Detailed explanation inserted here -->
            </div>
        </div>

        <div class="next-btn-container" id="next-btn-area">
            <button class="btn-primary" onclick="nextQuestion()">C√¢u ti·∫øp theo <i class="fas fa-arrow-right"></i></button>
        </div>
    </div>

    <!-- Result Screen -->
    <div id="result-screen" class="quiz-container" style="text-align: center;">
        <h2 style="color: var(--primary-teal);">Ch√∫c m·ª´ng em ƒë√£ ho√†n th√†nh! üéâ</h2>
        <div class="result-score" id="final-score">0/22</div>
        <p id="feedback-message" style="font-size: 1.2rem; margin-bottom: 30px;">...</p>
        <button class="btn-primary" onclick="location.reload()">L√†m l·∫°i b√†i <i class="fas fa-redo"></i></button>
    </div>

    <!-- Audio Elements -->
    <audio id="sound-correct" src="https://assets.mixkit.co/active_storage/sfx/2000/2000-preview.mp3"></audio>
    <audio id="sound-wrong" src="https://assets.mixkit.co/active_storage/sfx/2018/2018-preview.mp3"></audio>
    <audio id="sound-finish" src="https://assets.mixkit.co/active_storage/sfx/1435/1435-preview.mp3"></audio>

    <script>
        // DATA SOURCE
        const quizData = [
            {
                "questionNumber": 1,
                "question": "Son Doong contains some of the tallest known stalagmites in the world, _______ are up to 70 metres tall.",
                "answerOptions": [
                    { "text": "which", "isCorrect": true },
                    { "text": "who", "isCorrect": false },
                    { "text": "whom", "isCorrect": false },
                    { "text": "whose", "isCorrect": false }
                ],
                "explanation": "<b>D·ªãch c√¢u h·ªèi:</b> S∆°n ƒêo√≤ng ch·ª©a m·ªôt s·ªë mƒÉng ƒë√° cao nh·∫•t th·∫ø gi·ªõi, nh·ªØng c√°i m√† cao t·ªõi 70 m√©t.<br><br><b>Ph√¢n t√≠ch ƒë√°p √°n:</b><br>A. which (ƒë·∫°i t·ª´ quan h·ªá): c√°i m√† (d√πng cho v·∫≠t/s·ª± vi·ªác)<br>B. who (ƒë·∫°i t·ª´ quan h·ªá): ng∆∞·ªùi m√† (d√πng cho ng∆∞·ªùi)<br>C. whom (ƒë·∫°i t·ª´ quan h·ªá): ng∆∞·ªùi m√† (t√¢n ng·ªØ ch·ªâ ng∆∞·ªùi)<br>D. whose (ƒë·∫°i t·ª´ quan h·ªá): c·ªßa... (ch·ªâ s·ªü h·ªØu)<br><br><b>T·∫°i sao ch·ªçn A (which)?</b><br>Danh t·ª´ ƒë·ª©ng tr∆∞·ªõc (antecedent) l√† 'stalagmites' (nh·ªØng mƒÉng ƒë√°) -> ƒë√¢y l√† danh t·ª´ ch·ªâ v·∫≠t. ƒê·ªông t·ª´ 'are' theo sau -> c·∫ßn m·ªôt ch·ªß ng·ªØ ch·ªâ v·∫≠t -> d√πng 'which' l√† ch√≠nh x√°c nh·∫•t.<br><br><b>T·∫°i sao c√°c ƒë√°p √°n kh√°c sai?</b><br>Who v√† Whom ch·ªâ d√πng cho ng∆∞·ªùi. Whose d√πng ƒë·ªÉ ch·ªâ s·ªü h·ªØu (c·ªßa ai/c√°i g√¨), ·ªü ƒë√¢y ta c·∫ßn ch·ªß ng·ªØ ch·ª© kh√¥ng ph·∫£i s·ªü h·ªØu."
            },
            {
                "questionNumber": 2,
                "question": "Who is the friend with _______ you love to travel to different places?",
                "answerOptions": [
                    { "text": "whom", "isCorrect": true },
                    { "text": "which", "isCorrect": false },
                    { "text": "who", "isCorrect": false },
                    { "text": "whose", "isCorrect": false }
                ],
                "explanation": "<b>D·ªãch c√¢u h·ªèi:</b> Ai l√† ng∆∞·ªùi b·∫°n m√† b·∫°n th√≠ch ƒëi du l·ªãch c√πng ƒë·∫øn nh·ªØng n∆°i kh√°c nhau?<br><br><b>Ph√¢n t√≠ch ƒë√°p √°n:</b><br>A. whom (ƒë·∫°i t·ª´): ng∆∞·ªùi m√† (t√¢n ng·ªØ sau gi·ªõi t·ª´)<br>B. which (ƒë·∫°i t·ª´): c√°i m√† (v·∫≠t)<br>C. who (ƒë·∫°i t·ª´): ng∆∞·ªùi m√† (ch·ªß ng·ªØ)<br>D. whose (ƒë·∫°i t·ª´): c·ªßa... (s·ªü h·ªØu)<br><br><b>T·∫°i sao ch·ªçn A (whom)?</b><br>Danh t·ª´ 'friend' ch·ªâ ng∆∞·ªùi. C√≥ gi·ªõi t·ª´ 'with' ƒë·ª©ng ngay tr∆∞·ªõc ch·ªó tr·ªëng. Theo quy t·∫Øc ng·ªØ ph√°p chu·∫©n: Gi·ªõi t·ª´ + Whom (cho ng∆∞·ªùi).<br><br><b>T·∫°i sao sai?</b><br>'Which' d√πng cho v·∫≠t. 'Who' kh√¥ng ƒë·ª©ng sau gi·ªõi t·ª´ trong vƒÉn vi·∫øt chu·∫©n (ph·∫£i l√† 'with whom'). 'Whose' ch·ªâ s·ªü h·ªØu."
            },
            {
                "questionNumber": 3,
                "question": "The tour guide _______ showed us around the village is the village chief‚Äôs son.",
                "answerOptions": [
                    { "text": "who", "isCorrect": true },
                    { "text": "whose", "isCorrect": false },
                    { "text": "whom", "isCorrect": false },
                    { "text": "which", "isCorrect": false }
                ],
                "explanation": "<b>D·ªãch c√¢u h·ªèi:</b> Ng∆∞·ªùi h∆∞·ªõng d·∫´n vi√™n du l·ªãch, ng∆∞·ªùi ƒë√£ d·∫´n ch√∫ng t√¥i ƒëi quanh ng√¥i l√†ng, l√† con trai c·ªßa tr∆∞·ªüng l√†ng.<br><br><b>Ph√¢n t√≠ch ƒë√°p √°n:</b><br>A. who (ƒë·∫°i t·ª´): ng∆∞·ªùi m√† (ch·ªß ng·ªØ)<br>B. whose (ƒë·∫°i t·ª´): c·ªßa... (s·ªü h·ªØu)<br>C. whom (ƒë·∫°i t·ª´): ng∆∞·ªùi m√† (t√¢n ng·ªØ)<br>D. which (ƒë·∫°i t·ª´): c√°i m√† (v·∫≠t)<br><br><b>T·∫°i sao ch·ªçn A (who)?</b><br>'Tour guide' l√† danh t·ª´ ch·ªâ ng∆∞·ªùi. ƒê·ªông t·ª´ 'showed' theo sau c·∫ßn m·ªôt ch·ªß ng·ªØ th·ª±c hi·ªán h√†nh ƒë·ªông -> D√πng 'who'.<br><br><b>T·∫°i sao sai?</b><br>'Whose' c·∫ßn danh t·ª´ theo sau. 'Whom' thay th·∫ø cho t√¢n ng·ªØ (kh√¥ng l√†m ch·ªß ng·ªØ). 'Which' d√πng cho v·∫≠t."
            },
            {
                "questionNumber": 4,
                "question": "The British are famous for the amount of fast food _______ they eat every day.",
                "answerOptions": [
                    { "text": "which", "isCorrect": true },
                    { "text": "whom", "isCorrect": false },
                    { "text": "who", "isCorrect": false },
                    { "text": "whose", "isCorrect": false }
                ],
                "explanation": "<b>D·ªãch c√¢u h·ªèi:</b> Ng∆∞·ªùi Anh n·ªïi ti·∫øng v·ªõi l∆∞·ª£ng ƒë·ªì ƒÉn nhanh m√† h·ªç ti√™u th·ª• m·ªói ng√†y.<br><br><b>Ph√¢n t√≠ch ƒë√°p √°n:</b><br>A. which (v·∫≠t)<br>B. whom (ng∆∞·ªùi - t√¢n ng·ªØ)<br>C. who (ng∆∞·ªùi - ch·ªß ng·ªØ)<br>D. whose (s·ªü h·ªØu)<br><br><b>T·∫°i sao ch·ªçn A (which)?</b><br>Danh t·ª´ c·∫ßn b·ªï nghƒ©a l√† 'fast food' (ƒë·ªì ƒÉn nhanh) -> ch·ªâ v·∫≠t -> D√πng 'which' (ho·∫∑c 'that').<br><br><b>T·∫°i sao sai?</b><br>C·∫£ 'whom' v√† 'who' ƒë·ªÅu d√πng cho ng∆∞·ªùi. 'Whose' ch·ªâ s·ªü h·ªØu."
            },
            {
                "questionNumber": 5,
                "question": "When I was in Japan, I stayed in a hotel _______ walls are made of paper.",
                "answerOptions": [
                    { "text": "whose", "isCorrect": true },
                    { "text": "which", "isCorrect": false },
                    { "text": "whom", "isCorrect": false },
                    { "text": "who", "isCorrect": false }
                ],
                "explanation": "<b>D·ªãch c√¢u h·ªèi:</b> Khi t√¥i ·ªü Nh·∫≠t B·∫£n, t√¥i ƒë√£ ·ªü trong m·ªôt kh√°ch s·∫°n m√† nh·ªØng b·ª©c t∆∞·ªùng c·ªßa n√≥ ƒë∆∞·ª£c l√†m b·∫±ng gi·∫•y.<br><br><b>Ph√¢n t√≠ch ƒë√°p √°n:</b><br>A. whose (s·ªü h·ªØu)<br>B. which (v·∫≠t)<br>C. whom (t√¢n ng·ªØ ng∆∞·ªùi)<br>D. who (ch·ªß ng·ªØ ng∆∞·ªùi)<br><br><b>T·∫°i sao ch·ªçn A (whose)?</b><br>Ta th·∫•y m·ªëi quan h·ªá gi·ªØa 'hotel' (kh√°ch s·∫°n) v√† 'walls' (nh·ªØng b·ª©c t∆∞·ªùng). T∆∞·ªùng l√† c·ªßa kh√°ch s·∫°n -> Quan h·ªá s·ªü h·ªØu -> D√πng 'whose'.<br><br><b>T·∫°i sao sai?</b><br>N·∫øu d√πng 'which', c√¢u s·∫Ω thi·∫øu t·ª´ ch·ªâ s·ªü h·ªØu (ph·∫£i l√† 'the walls of which'). Who/Whom d√πng cho ng∆∞·ªùi."
            },
            {
                "questionNumber": 6,
                "question": "Where did you put the plane ticket _______ I gave you on Monday?",
                "answerOptions": [
                    { "text": "which", "isCorrect": true },
                    { "text": "who", "isCorrect": false },
                    { "text": "whose", "isCorrect": false },
                    { "text": "whom", "isCorrect": false }
                ],
                "explanation": "<b>D·ªãch c√¢u h·ªèi:</b> B·∫°n ƒë√£ ƒë·ªÉ c√°i v√© m√°y bay m√† t√¥i ƒë∆∞a cho b·∫°n v√†o th·ª© Hai ·ªü ƒë√¢u r·ªìi?<br><br><b>Ph√¢n t√≠ch ƒë√°p √°n:</b><br>A. which (v·∫≠t)<br>B. who (ng∆∞·ªùi)<br>C. whose (s·ªü h·ªØu)<br>D. whom (t√¢n ng·ªØ ng∆∞·ªùi)<br><br><b>T·∫°i sao ch·ªçn A (which)?</b><br>'Plane ticket' (v√© m√°y bay) l√† danh t·ª´ ch·ªâ v·∫≠t -> D√πng 'which'.<br><br><b>T·∫°i sao sai?</b><br>Who/Whom d√πng cho ng∆∞·ªùi. Whose d√πng cho s·ªü h·ªØu."
            },
            {
                "questionNumber": 7,
                "question": "Phuket is an ideal destination for serious divers _______ enthusiastically submerge themselves in the Adaman Sea.",
                "answerOptions": [
                    { "text": "who", "isCorrect": true },
                    { "text": "whose", "isCorrect": false },
                    { "text": "which", "isCorrect": false },
                    { "text": "whom", "isCorrect": false }
                ],
                "explanation": "<b>D·ªãch c√¢u h·ªèi:</b> Phuket l√† ƒëi·ªÉm ƒë·∫øn l√Ω t∆∞·ªüng cho nh·ªØng th·ª£ l·∫∑n chuy√™n nghi·ªáp, nh·ªØng ng∆∞·ªùi nhi·ªát t√¨nh ƒë·∫Øm m√¨nh trong v√πng bi·ªÉn Andaman.<br><br><b>Ph√¢n t√≠ch ƒë√°p √°n:</b><br>A. who (ng∆∞·ªùi - ch·ªß ng·ªØ)<br>B. whose (s·ªü h·ªØu)<br>C. which (v·∫≠t)<br>D. whom (ng∆∞·ªùi - t√¢n ng·ªØ)<br><br><b>T·∫°i sao ch·ªçn A (who)?</b><br>'Divers' (th·ª£ l·∫∑n) l√† danh t·ª´ ch·ªâ ng∆∞·ªùi. C√¢u ƒëang thi·∫øu ch·ªß ng·ªØ cho ƒë·ªông t·ª´ 'submerge' (l·∫∑n/ƒë·∫Øm m√¨nh) -> D√πng 'who'.<br><br><b>T·∫°i sao sai?</b><br>'Whose' ph·∫£i ƒëi k√®m danh t·ª´ (enthusiastically l√† tr·∫°ng t·ª´). 'Which' d√πng cho v·∫≠t. 'Whom' l√† t√¢n ng·ªØ."
            },
            {
                "questionNumber": 8,
                "question": "My pen pal, _______ hometown is in Rome, will visit me this summer holiday.",
                "answerOptions": [
                    { "text": "whose", "isCorrect": true },
                    { "text": "which", "isCorrect": false },
                    { "text": "who", "isCorrect": false },
                    { "text": "that", "isCorrect": false }
                ],
                "explanation": "<b>D·ªãch c√¢u h·ªèi:</b> B·∫°n qua th∆∞ c·ªßa t√¥i, ng∆∞·ªùi m√† qu√™ ·ªü Rome, s·∫Ω ƒë·∫øn thƒÉm t√¥i v√†o k·ª≥ ngh·ªâ h√® n√†y.<br><br><b>Ph√¢n t√≠ch ƒë√°p √°n:</b><br>A. whose (s·ªü h·ªØu)<br>B. which (v·∫≠t)<br>C. who (ng∆∞·ªùi)<br>D. that (ng∆∞·ªùi/v·∫≠t)<br><br><b>T·∫°i sao ch·ªçn A (whose)?</b><br>Hai danh t·ª´: 'Pen pal' (b·∫°n qua th∆∞) v√† 'hometown' (qu√™ nh√†). M·ªëi quan h·ªá: qu√™ C·ª¶A b·∫°n t√¥i -> D√πng 'whose'.<br><br><b>T·∫°i sao sai?</b><br>'Pen pal' l√† ng∆∞·ªùi n√™n kh√¥ng d√πng 'which'. 'Who' sai ng·ªØ ph√°p v√¨ thi·∫øu s·ªü h·ªØu. 'That' kh√¥ng d√πng trong m·ªánh ƒë·ªÅ quan h·ªá c√≥ d·∫•u ph·∫©y."
            },
            {
                "questionNumber": 9,
                "question": "You should find someone _______ you can rely on to take care of your cat when you‚Äôre away.",
                "answerOptions": [
                    { "text": "who", "isCorrect": true },
                    { "text": "whose", "isCorrect": false },
                    { "text": "which", "isCorrect": false },
                    { "text": "where", "isCorrect": false }
                ],
                "explanation": "<b>D·ªãch c√¢u h·ªèi:</b> B·∫°n n√™n t√¨m m·ªôt ai ƒë√≥ m√† b·∫°n c√≥ th·ªÉ tin t∆∞·ªüng ƒë·ªÉ chƒÉm s√≥c con m√®o khi b·∫°n ƒëi v·∫Øng.<br><br><b>Ph√¢n t√≠ch ƒë√°p √°n:</b><br>A. who (ng∆∞·ªùi)<br>B. whose (s·ªü h·ªØu)<br>C. which (v·∫≠t)<br>D. where (n∆°i ch·ªën)<br><br><b>T·∫°i sao ch·ªçn A (who)?</b><br>'Someone' l√† ng∆∞·ªùi. ·ªû ƒë√¢y c·∫ßn m·ªôt ƒë·∫°i t·ª´ l√†m t√¢n ng·ªØ cho gi·ªõi t·ª´ 'on' (rely on someone). Khi gi·ªõi t·ª´ 'on' n·∫±m cu·ªëi m·ªánh ƒë·ªÅ, ta d√πng 'who' (ho·∫∑c 'that').<br><br><b>T·∫°i sao sai?</b><br>Which d√πng cho v·∫≠t. Whose c·∫ßn danh t·ª´ s·ªü h·ªØu. Where ch·ªâ n∆°i ch·ªën."
            },
            {
                "questionNumber": 10,
                "question": "For people _______ enjoy driving, a scenic drive along the Great Ocean Road can‚Äôt be missed.",
                "answerOptions": [
                    { "text": "who", "isCorrect": true },
                    { "text": "which", "isCorrect": false },
                    { "text": "whose", "isCorrect": false },
                    { "text": "whom", "isCorrect": false }
                ],
                "explanation": "<b>D·ªãch c√¢u h·ªèi:</b> ƒê·ªëi v·ªõi nh·ªØng ng∆∞·ªùi th√≠ch l√°i xe, m·ªôt chuy·∫øn ƒëi d·ªçc theo Con ƒë∆∞·ªùng ƒê·∫°i d∆∞∆°ng vƒ© ƒë·∫°i l√† kh√¥ng th·ªÉ b·ªè l·ª°.<br><br><b>Ph√¢n t√≠ch ƒë√°p √°n:</b><br>A. who (ch·ªß ng·ªØ ng∆∞·ªùi)<br>B. which (v·∫≠t)<br>C. whose (s·ªü h·ªØu)<br>D. whom (t√¢n ng·ªØ ng∆∞·ªùi)<br><br><b>T·∫°i sao ch·ªçn A (who)?</b><br>'People' l√† ng∆∞·ªùi. ƒê·ªông t·ª´ 'enjoy' ƒë·ª©ng sau -> C·∫ßn ch·ªß ng·ªØ ch·ªâ ng∆∞·ªùi -> D√πng 'who'.<br><br><b>T·∫°i sao sai?</b><br>Which d√πng cho v·∫≠t. Whose ch·ªâ s·ªü h·ªØu. Whom d√πng l√†m t√¢n ng·ªØ (kh√¥ng th·ªÉ l√†m ch·ªß ng·ªØ cho 'enjoy')."
            },
            {
                "questionNumber": 11,
                "question": "Italy has planned to heavily charge tourists _______ damage cultural sites.",
                "answerOptions": [
                    { "text": "who", "isCorrect": true },
                    { "text": "whom", "isCorrect": false },
                    { "text": "which", "isCorrect": false },
                    { "text": "whose", "isCorrect": false }
                ],
                "explanation": "<b>D·ªãch c√¢u h·ªèi:</b> √ù ƒë√£ l√™n k·∫ø ho·∫°ch ph·∫°t n·∫∑ng nh·ªØng du kh√°ch l√†m h∆∞ h·∫°i c√°c di t√≠ch vƒÉn h√≥a.<br><br><b>Ph√¢n t√≠ch ƒë√°p √°n:</b><br>A. who (ch·ªß ng·ªØ ng∆∞·ªùi)<br>B. whom (t√¢n ng·ªØ ng∆∞·ªùi)<br>C. which (v·∫≠t)<br>D. whose (s·ªü h·ªØu)<br><br><b>T·∫°i sao ch·ªçn A (who)?</b><br>'Tourists' l√† ng∆∞·ªùi. ƒê·ªông t·ª´ 'damage' (l√†m h·∫°i) theo sau -> C·∫ßn ch·ªß ng·ªØ -> D√πng 'who'.<br><br><b>T·∫°i sao sai?</b><br>T∆∞∆°ng t·ª± c√¢u tr√™n, Whom l√† t√¢n ng·ªØ, Which l√† v·∫≠t, Whose l√† s·ªü h·ªØu."
            },
            {
                "questionNumber": 12,
                "question": "He wore a mask _______ made him look like Mickey Mouse.",
                "answerOptions": [
                    { "text": "which", "isCorrect": true },
                    { "text": "who", "isCorrect": false },
                    { "text": "whom", "isCorrect": false },
                    { "text": "whose", "isCorrect": false }
                ],
                "explanation": "<b>D·ªãch c√¢u h·ªèi:</b> Anh ·∫•y ƒëeo m·ªôt chi·∫øc m·∫∑t n·∫° c√°i m√† l√†m anh ·∫•y tr√¥ng gi·ªëng chu·ªôt Mickey.<br><br><b>Ph√¢n t√≠ch ƒë√°p √°n:</b><br>A. which (v·∫≠t)<br>B. who (ng∆∞·ªùi)<br>C. whom (t√¢n ng·ªØ ng∆∞·ªùi)<br>D. whose (s·ªü h·ªØu)<br><br><b>T·∫°i sao ch·ªçn A (which)?</b><br>'Mask' (m·∫∑t n·∫°) l√† danh t·ª´ ch·ªâ v·∫≠t -> D√πng 'which'.<br><br><b>T·∫°i sao sai?</b><br>M·∫∑t n·∫° l√† v·∫≠t n√™n kh√¥ng d√πng Who/Whom."
            },
            {
                "questionNumber": 13,
                "question": "The student _______ father is a professor told us to register for this course.",
                "answerOptions": [
                    { "text": "whose", "isCorrect": true },
                    { "text": "who", "isCorrect": false },
                    { "text": "whom", "isCorrect": false },
                    { "text": "which", "isCorrect": false }
                ],
                "explanation": "<b>D·ªãch c√¢u h·ªèi:</b> C·∫≠u sinh vi√™n c√≥ b·ªë l√† gi√°o s∆∞ ƒë√£ b·∫£o ch√∫ng t√¥i ƒëƒÉng k√Ω kh√≥a h·ªçc n√†y.<br><br><b>Ph√¢n t√≠ch ƒë√°p √°n:</b><br>A. whose (s·ªü h·ªØu)<br>B. who (ng∆∞·ªùi)<br>C. whom (ng∆∞·ªùi)<br>D. which (v·∫≠t)<br><br><b>T·∫°i sao ch·ªçn A (whose)?</b><br>'Student' (sinh vi√™n) v√† 'father' (b·ªë). M·ªëi quan h·ªá: B·ªë C·ª¶A sinh vi√™n -> D√πng 'whose'.<br><br><b>T·∫°i sao sai?</b><br>'Who father' hay 'Whom father' ƒë·ªÅu sai ng·ªØ ph√°p v√¨ thi·∫øu t√≠nh t·ª´ s·ªü h·ªØu."
            },
            {
                "questionNumber": 14,
                "question": "I didn‚Äôt know exactly _______ I was working with on the project.",
                "answerOptions": [
                    { "text": "who", "isCorrect": true },
                    { "text": "which", "isCorrect": false },
                    { "text": "whose", "isCorrect": false },
                    { "text": "when", "isCorrect": false }
                ],
                "explanation": "<b>D·ªãch c√¢u h·ªèi:</b> T√¥i kh√¥ng bi·∫øt ch√≠nh x√°c ng∆∞·ªùi m√† t√¥i ƒëang l√†m vi·ªác c√πng trong d·ª± √°n l√† ai.<br><br><b>Ph√¢n t√≠ch ƒë√°p √°n:</b><br>A. who (ng∆∞·ªùi)<br>B. which (v·∫≠t)<br>C. whose (s·ªü h·ªØu)<br>D. when (th·ªùi gian)<br><br><b>T·∫°i sao ch·ªçn A (who)?</b><br>C√¢u h·ªèi gi√°n ti·∫øp: 'Work with someone'. Gi·ªõi t·ª´ 'with' ·ªü cu·ªëi c√¢u -> 'Who' l√† ƒë√°p √°n ph·ªï bi·∫øn v√† t·ª± nhi√™n nh·∫•t.<br><br><b>T·∫°i sao sai?</b><br>Working with 'someone' (ng∆∞·ªùi) ch·ª© kh√¥ng ph·∫£i v·∫≠t (Which) hay th·ªùi gian (When)."
            },
            {
                "questionNumber": 15,
                "question": "Enter the address of the person to _______ you want to forward the message.",
                "answerOptions": [
                    { "text": "whom", "isCorrect": true },
                    { "text": "who", "isCorrect": false },
                    { "text": "which", "isCorrect": false },
                    { "text": "that", "isCorrect": false }
                ],
                "explanation": "<b>D·ªãch c√¢u h·ªèi:</b> Nh·∫≠p ƒë·ªãa ch·ªâ c·ªßa ng∆∞·ªùi m√† b·∫°n mu·ªën chuy·ªÉn ti·∫øp tin nh·∫Øn ƒë·∫øn.<br><br><b>Ph√¢n t√≠ch ƒë√°p √°n:</b><br>A. whom (t√¢n ng·ªØ ng∆∞·ªùi)<br>B. who (ng∆∞·ªùi)<br>C. which (v·∫≠t)<br>D. that (ng∆∞·ªùi/v·∫≠t)<br><br><b>T·∫°i sao ch·ªçn A (whom)?</b><br>C√≥ gi·ªõi t·ª´ 'to' ƒë·ª©ng ngay tr∆∞·ªõc √¥ tr·ªëng. Quy t·∫Øc b·∫•t di b·∫•t d·ªãch: Gi·ªõi t·ª´ + Whom (cho ng∆∞·ªùi).<br><br><b>T·∫°i sao sai?</b><br>Kh√¥ng d√πng 'who' ho·∫∑c 'that' ngay sau gi·ªõi t·ª´."
            },
            {
                "questionNumber": 16,
                "question": "The children, _______ are shouting in the street, are not from our school.",
                "answerOptions": [
                    { "text": "who", "isCorrect": true },
                    { "text": "whom", "isCorrect": false },
                    { "text": "which", "isCorrect": false },
                    { "text": "whose", "isCorrect": false }
                ],
                "explanation": "<b>D·ªãch c√¢u h·ªèi:</b> Nh·ªØng ƒë·ª©a tr·∫ª, nh·ªØng ƒë·ª©a ƒëang la h√©t ngo√†i ƒë∆∞·ªùng, kh√¥ng ph·∫£i h·ªçc sinh tr∆∞·ªùng ch√∫ng t√¥i.<br><br><b>Ph√¢n t√≠ch ƒë√°p √°n:</b><br>A. who (ch·ªß ng·ªØ ng∆∞·ªùi)<br>B. whom (t√¢n ng·ªØ ng∆∞·ªùi)<br>C. which (v·∫≠t)<br>D. whose (s·ªü h·ªØu)<br><br><b>T·∫°i sao ch·ªçn A (who)?</b><br>'Children' l√† ng∆∞·ªùi. ƒê·ªông t·ª´ 'are shouting' theo sau -> C·∫ßn ch·ªß ng·ªØ -> D√πng 'who'.<br><br><b>T·∫°i sao sai?</b><br>Whom l√† t√¢n ng·ªØ. Which l√† v·∫≠t. Whose l√† s·ªü h·ªØu."
            },
            {
                "questionNumber": 17,
                "question": "The neighborhood _______ we visited yesterday is a somewhat dangerous area.",
                "answerOptions": [
                    { "text": "which", "isCorrect": true },
                    { "text": "who", "isCorrect": false },
                    { "text": "whom", "isCorrect": false },
                    { "text": "whose", "isCorrect": false }
                ],
                "explanation": "<b>D·ªãch c√¢u h·ªèi:</b> Khu ph·ªë m√† ch√∫ng t√¥i gh√© thƒÉm h√¥m qua l√† m·ªôt khu v·ª±c h∆°i nguy hi·ªÉm.<br><br><b>Ph√¢n t√≠ch ƒë√°p √°n:</b><br>A. which (v·∫≠t/n∆°i ch·ªën - t√¢n ng·ªØ)<br>B. who (ng∆∞·ªùi)<br>C. whom (ng∆∞·ªùi)<br>D. whose (s·ªü h·ªØu)<br><br><b>T·∫°i sao ch·ªçn A (which)?</b><br>'Neighborhood' l√† v·∫≠t/n∆°i ch·ªën. Tuy nhi√™n, ƒë·ªông t·ª´ 'visited' l√† ngo·∫°i ƒë·ªông t·ª´ (visit something), n√≥ t√°c ƒë·ªông tr·ª±c ti·∫øp l√™n t√¢n ng·ªØ, kh√¥ng c√≥ gi·ªõi t·ª´ 'in'. Do ƒë√≥ d√πng 'which' thay v√¨ 'where'.<br><br><b>T·∫°i sao sai?</b><br>Kh√¥ng d√πng 'where' v√¨ 'visit' kh√¥ng ƒëi v·ªõi 'in' trong ng·ªØ c·∫£nh n√†y. Neighborhood kh√¥ng ph·∫£i ng∆∞·ªùi n√™n kh√¥ng d√πng Who/Whom."
            },
            {
                "questionNumber": 18,
                "question": "Amanda introduces me to this restaurant _______ food and service are excellent.",
                "answerOptions": [
                    { "text": "whose", "isCorrect": true },
                    { "text": "which", "isCorrect": false },
                    { "text": "who", "isCorrect": false },
                    { "text": "that", "isCorrect": false }
                ],
                "explanation": "<b>D·ªãch c√¢u h·ªèi:</b> Amanda gi·ªõi thi·ªáu t√¥i ƒë·∫øn nh√† h√†ng n√†y, n∆°i m√† ƒë·ªì ƒÉn v√† d·ªãch v·ª• ƒë·ªÅu tuy·ªát v·ªùi.<br><br><b>Ph√¢n t√≠ch ƒë√°p √°n:</b><br>A. whose (s·ªü h·ªØu)<br>B. which (v·∫≠t)<br>C. who (ng∆∞·ªùi)<br>D. that (v·∫≠t)<br><br><b>T·∫°i sao ch·ªçn A (whose)?</b><br>'Restaurant' v√† 'food'. M·ªëi quan h·ªá: ƒê·ªì ƒÉn C·ª¶A nh√† h√†ng -> D√πng 'whose'.<br><br><b>T·∫°i sao sai?</b><br>C√°c ƒë√°p √°n kh√°c kh√¥ng th·ªÉ hi·ªán m·ªëi quan h·ªá s·ªü h·ªØu."
            },
            {
                "questionNumber": 19,
                "question": "Batu Caves have a rich history _______ has made it one of the tourist hotspots in Malaysia.",
                "answerOptions": [
                    { "text": "which", "isCorrect": true },
                    { "text": "who", "isCorrect": false },
                    { "text": "whom", "isCorrect": false },
                    { "text": "whose", "isCorrect": false }
                ],
                "explanation": "<b>D·ªãch c√¢u h·ªèi:</b> ƒê·ªông Batu c√≥ m·ªôt l·ªãch s·ª≠ phong ph√∫, ƒëi·ªÅu ƒë√£ khi·∫øn n√≥ tr·ªü th√†nh m·ªôt trong nh·ªØng ƒëi·ªÉm n√≥ng du l·ªãch ·ªü Malaysia.<br><br><b>Ph√¢n t√≠ch ƒë√°p √°n:</b><br>A. which (v·∫≠t)<br>B. who (ng∆∞·ªùi)<br>C. whom (ng∆∞·ªùi)<br>D. whose (s·ªü h·ªØu)<br><br><b>T·∫°i sao ch·ªçn A (which)?</b><br>'History' (l·ªãch s·ª≠) l√† v·∫≠t/kh√°i ni·ªám. ƒê·ªông t·ª´ 'has made' theo sau -> C·∫ßn ch·ªß ng·ªØ ch·ªâ v·∫≠t -> D√πng 'which'.<br><br><b>T·∫°i sao sai?</b><br>History kh√¥ng ph·∫£i ng∆∞·ªùi. Kh√¥ng c√≥ quan h·ªá s·ªü h·ªØu."
            },
            {
                "questionNumber": 20,
                "question": "The incident was caught on camera by a tourist _______ was filming at the time.",
                "answerOptions": [
                    { "text": "who", "isCorrect": true },
                    { "text": "which", "isCorrect": false },
                    { "text": "whose", "isCorrect": false },
                    { "text": "whom", "isCorrect": false }
                ],
                "explanation": "<b>D·ªãch c√¢u h·ªèi:</b> S·ª± c·ªë ƒë√£ ƒë∆∞·ª£c ghi l·∫°i tr√™n m√°y quay b·ªüi m·ªôt du kh√°ch, ng∆∞·ªùi ƒëang quay phim v√†o th·ªùi ƒëi·ªÉm ƒë√≥.<br><br><b>Ph√¢n t√≠ch ƒë√°p √°n:</b><br>A. who (ch·ªß ng·ªØ ng∆∞·ªùi)<br>B. which (v·∫≠t)<br>C. whose (s·ªü h·ªØu)<br>D. whom (t√¢n ng·ªØ ng∆∞·ªùi)<br><br><b>T·∫°i sao ch·ªçn A (who)?</b><br>'Tourist' (du kh√°ch) l√† ng∆∞·ªùi. ƒê·ªông t·ª´ 'was filming' theo sau -> C·∫ßn ch·ªß ng·ªØ -> D√πng 'who'.<br><br><b>T·∫°i sao sai?</b><br>Tourist l√† ng∆∞·ªùi n√™n kh√¥ng d√πng Which. C·∫ßn ch·ªß ng·ªØ n√™n kh√¥ng d√πng Whom."
            },
            {
                "questionNumber": 21,
                "question": "Brussels, _______ I‚Äôve visited several times recently, is a good place to spend a weekend.",
                "answerOptions": [
                    { "text": "which", "isCorrect": true },
                    { "text": "who", "isCorrect": false },
                    { "text": "where", "isCorrect": false },
                    { "text": "whose", "isCorrect": false }
                ],
                "explanation": "<b>D·ªãch c√¢u h·ªèi:</b> Brussels, n∆°i m√† t√¥i ƒë√£ gh√© thƒÉm v√†i l·∫ßn g·∫ßn ƒë√¢y, l√† m·ªôt ƒë·ªãa ƒëi·ªÉm t·ªët ƒë·ªÉ ngh·ªâ cu·ªëi tu·∫ßn.<br><br><b>Ph√¢n t√≠ch ƒë√°p √°n:</b><br>A. which (v·∫≠t - t√¢n ng·ªØ)<br>B. who (ng∆∞·ªùi)<br>C. where (n∆°i ch·ªën)<br>D. whose (s·ªü h·ªØu)<br><br><b>T·∫°i sao ch·ªçn A (which)?</b><br>'Brussels' l√† ƒë·ªãa ƒëi·ªÉm. Tuy nhi√™n, 'visit' l√† ngo·∫°i ƒë·ªông t·ª´ (visit something), n√≥ c·∫ßn t√¢n ng·ªØ tr·ª±c ti·∫øp. Ta n√≥i 'visit Brussels' -> Brussels l√† t√¢n ng·ªØ -> d√πng 'which'.<br><br><b>T·∫°i sao sai?</b><br>'Where' = 'in which', nh∆∞ng ta kh√¥ng n√≥i 'visit in Brussels' m√† n√≥i 'visit Brussels'. Do ƒë√≥ d√πng 'Where' l√† sai ng·ªØ ph√°p trong m·ªánh ƒë·ªÅ n√†y."
            },
            {
                "questionNumber": 22,
                "question": "7-Eleven is a convenience store chains _______ stores can be found all over Bangkok.",
                "answerOptions": [
                    { "text": "whose", "isCorrect": true },
                    { "text": "which", "isCorrect": false },
                    { "text": "who", "isCorrect": false },
                    { "text": "that", "isCorrect": false }
                ],
                "explanation": "<b>D·ªãch c√¢u h·ªèi:</b> 7-Eleven l√† m·ªôt chu·ªói c·ª≠a h√†ng ti·ªán l·ª£i m√† c√°c c·ª≠a h√†ng c·ªßa n√≥ c√≥ th·ªÉ ƒë∆∞·ª£c t√¨m th·∫•y kh·∫Øp Bangkok.<br><br><b>Ph√¢n t√≠ch ƒë√°p √°n:</b><br>A. whose (s·ªü h·ªØu)<br>B. which (v·∫≠t)<br>C. who (ng∆∞·ªùi)<br>D. that (v·∫≠t)<br><br><b>T·∫°i sao ch·ªçn A (whose)?</b><br>'Store chains' (chu·ªói c·ª≠a h√†ng) v√† 'stores' (c√°c c·ª≠a h√†ng con). M·ªëi quan h·ªá: C√°c c·ª≠a h√†ng C·ª¶A chu·ªói ƒë√≥ -> D√πng 'whose'.<br><br><b>T·∫°i sao sai?</b><br>Thi·∫øu t√≠nh s·ªü h·ªØu n·∫øu d√πng Which/That."
            }
        ];

        // LOGIC VARIABLES
        let shuffledQuestions = [];
        let currentQuestionIndex = 0;
        let score = 0;
        let confettiCanvas = document.getElementById('confetti-canvas');
        let soundCorrect = document.getElementById('sound-correct');
        let soundWrong = document.getElementById('sound-wrong');
        let soundFinish = document.getElementById('sound-finish');

        // INITIALIZE
        function startQuiz() {
            // Shuffle questions algorithm
            shuffledQuestions = [...quizData].sort(() => Math.random() - 0.5);
            currentQuestionIndex = 0;
            score = 0;
            
            document.getElementById('start-screen').classList.remove('active-screen');
            setTimeout(() => {
                document.getElementById('start-screen').style.display = 'none';
                document.getElementById('quiz-screen').style.display = 'block';
                document.getElementById('quiz-screen').classList.add('active-screen');
                loadQuestion();
            }, 300);
        }

        function loadQuestion() {
            const questionData = shuffledQuestions[currentQuestionIndex];
            
            // Update Progress UI
            document.getElementById('question-count').innerText = `C√¢u ${currentQuestionIndex + 1}/${quizData.length}`;
            document.getElementById('score-display').innerText = `ƒêi·ªÉm: ${score}`;
            document.getElementById('progress-bar').style.width = `${((currentQuestionIndex) / quizData.length) * 100}%`;
            
            // Reset UI
            document.getElementById('explanation-area').style.display = 'none';
            document.getElementById('next-btn-area').style.display = 'none';
            
            // Render Question
            document.getElementById('question-text').innerText = `${questionData.questionNumber}. ${questionData.question}`;

            // Render Options
            const optionsContainer = document.getElementById('options-container');
            optionsContainer.innerHTML = '';

            const optionLabels = ['A', 'B', 'C', 'D'];
            
            questionData.answerOptions.forEach((option, index) => {
                const btn = document.createElement('button');
                btn.className = 'option-btn';
                btn.onclick = () => checkAnswer(btn, option.isCorrect);
                btn.innerHTML = `<span class="option-label">${optionLabels[index]}</span> ${option.text}`;
                optionsContainer.appendChild(btn);
            });
        }

        function checkAnswer(selectedBtn, isCorrect) {
            // Disable all buttons
            const buttons = document.querySelectorAll('.option-btn');
            buttons.forEach(btn => btn.disabled = true);

            // Highlight Logic
            if (isCorrect) {
                selectedBtn.classList.add('correct');
                soundCorrect.currentTime = 0;
                soundCorrect.play();
                score++;
                triggerConfetti();
            } else {
                selectedBtn.classList.add('wrong');
                soundWrong.currentTime = 0;
                soundWrong.play();
                
                // Find and highlight correct answer
                const currentQ = shuffledQuestions[currentQuestionIndex];
                buttons.forEach(btn => {
                    if (btn.innerText.includes(currentQ.answerOptions.find(o => o.isCorrect).text)) {
                        btn.classList.add('correct');
                    }
                });
            }

            // Update Score Display
            document.getElementById('score-display').innerText = `ƒêi·ªÉm: ${score}`;

            // Show Explanation
            const explanationContent = document.getElementById('explanation-content');
            explanationContent.innerHTML = shuffledQuestions[currentQuestionIndex].explanation;
            document.getElementById('explanation-area').style.display = 'block';
            document.getElementById('next-btn-area').style.display = 'block';
        }

        function nextQuestion() {
            currentQuestionIndex++;
            if (currentQuestionIndex < quizData.length) {
                loadQuestion();
            } else {
                showResult();
            }
        }

        function showResult() {
            document.getElementById('quiz-screen').style.display = 'none';
            document.getElementById('result-screen').style.display = 'block';
            document.getElementById('result-screen').classList.add('active-screen');
            
            document.getElementById('final-score').innerText = `${score}/${quizData.length}`;
            soundFinish.play();
            triggerConfetti();

            let message = "";
            const percentage = (score / quizData.length) * 100;
            if (percentage === 100) message = "Xu·∫•t s·∫Øc! Em l√† thi√™n t√†i ng·ªØ ph√°p! üåü";
            else if (percentage >= 80) message = "L√†m r·∫•t t·ªët! C·ªë g·∫Øng th√™m ch√∫t n·ªØa l√† ho√†n h·∫£o! üí™";
            else if (percentage >= 50) message = "T·∫°m ·ªïn, nh∆∞ng c·∫ßn √¥n l·∫°i b√†i k·ªπ h∆°n nh√©! üìö";
            else message = "C·∫ßn c·ªë g·∫Øng nhi·ªÅu h∆°n n·ªØa nha! ƒê·ª´ng n·∫£n ch√≠! üî•";
            
            document.getElementById('feedback-message').innerText = message;
        }

        // CONFETTI LOGIC (Simple JS Implementation)
        function triggerConfetti() {
            const colors = ['#8854C0', '#00C9A7', '#FF4757', '#FFD700'];
            const ctx = confettiCanvas.getContext('2d');
            confettiCanvas.width = window.innerWidth;
            confettiCanvas.height = window.innerHeight;
            
            let particles = [];
            for(let i=0; i<100; i++) {
                particles.push({
                    x: Math.random() * confettiCanvas.width,
                    y: Math.random() * confettiCanvas.height - confettiCanvas.height,
                    color: colors[Math.floor(Math.random() * colors.length)],
                    size: Math.random() * 10 + 5,
                    speed: Math.random() * 5 + 2,
                    angle: Math.random() * 360
                });
            }

            let animationId;
            function draw() {
                ctx.clearRect(0, 0, confettiCanvas.width, confettiCanvas.height);
                particles.forEach((p, i) => {
                    p.y += p.speed;
                    p.x += Math.sin(p.angle) * 2;
                    ctx.fillStyle = p.color;
                    ctx.fillRect(p.x, p.y, p.size, p.size);
                    
                    if(p.y > confettiCanvas.height) particles.splice(i, 1);
                });

                if(particles.length > 0) {
                    animationId = requestAnimationFrame(draw);
                } else {
                    cancelAnimationFrame(animationId);
                }
            }
            draw();
        }

    </script>
</body>
</html>
