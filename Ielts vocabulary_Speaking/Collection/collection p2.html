<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>IELTS Speaking Part 2 - Interactive Worksheet</title>
    <link href="https://fonts.googleapis.com/css2?family=Quicksand:wght@500;700;900&display=swap" rel="stylesheet">
    <style>
        :root {
            --primary: #8854C0;
            --secondary: #FDCB6E;
            --accent: #00C9A7;
            --correct: #00D26A;
            --wrong: #FF4757;
            --white: #ffffff;
            --text-main: #333333;
            --bg-card: rgba(255, 255, 255, 0.95);
        }

        * {
            box-sizing: border-box;
            margin: 0;
            padding: 0;
            font-family: 'Quicksand', sans-serif;
        }

        body {
            height: 100vh;
            overflow: hidden;
            background: linear-gradient(-45deg, #8854C0, #FDCB6E, #00C9A7, #FF9A9E);
            background-size: 400% 400%;
            animation: gradientBG 15s ease infinite;
            color: var(--text-main);
            display: flex;
            flex-direction: column;
        }

        /* SVG Background Pattern */
        .bg-pattern {
            position: fixed;
            top: 0; left: 0; width: 100%; height: 100%;
            pointer-events: none; z-index: -1;
            background-image: url('data:image/svg+xml;utf8,<svg xmlns="http://www.w3.org/2000/svg" width="300" height="300" opacity="0.15"><text x="30" y="50" font-size="40">üé¨</text><text x="180" y="100" font-size="40">üíî</text><text x="80" y="200" font-size="40">üçø</text><text x="220" y="250" font-size="40">üåü</text></svg>');
            animation: floatPattern 30s linear infinite;
        }

        @keyframes gradientBG {
            0% { background-position: 0% 50%; }
            50% { background-position: 100% 50%; }
            100% { background-position: 0% 50%; }
        }

        @keyframes floatPattern {
            0% { background-position: 0 0; }
            100% { background-position: 300px 300px; }
        }

        /* Top Header */
        .header {
            height: 70px;
            background: rgba(255, 255, 255, 0.2);
            backdrop-filter: blur(10px);
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 0 30px;
            box-shadow: 0 4px 15px rgba(0,0,0,0.1);
            z-index: 10;
        }

        .author-title {
            font-weight: 900;
            font-size: 1.2rem;
            color: var(--white);
            text-shadow: 1px 1px 2px rgba(0,0,0,0.2);
        }

        .timer-container {
            display: flex;
            align-items: center;
            gap: 15px;
        }

        .btn-timer {
            background: var(--white);
            color: var(--primary);
            border: none;
            padding: 10px 20px;
            border-radius: 15px;
            font-weight: 700;
            cursor: pointer;
            box-shadow: 0 4px 0 rgba(0,0,0,0.1);
            transition: transform 0.1s, box-shadow 0.1s;
        }
        .btn-timer:active {
            transform: translateY(4px);
            box-shadow: 0 0 0 rgba(0,0,0,0.1);
        }

        .time-display {
            font-size: 1.5rem;
            font-weight: 900;
            color: var(--white);
            background: rgba(0,0,0,0.2);
            padding: 5px 15px;
            border-radius: 10px;
            letter-spacing: 2px;
        }

        /* Split Screen Container */
        .split-container {
            display: flex;
            height: calc(100vh - 70px);
            padding: 15px;
            gap: 15px;
        }

        .left-panel, .right-panel {
            flex: 1;
            background: var(--bg-card);
            border-radius: 20px;
            padding: 25px;
            overflow-y: auto;
            box-shadow: 0 10px 30px rgba(0,0,0,0.15);
            scroll-behavior: smooth;
        }

        /* Custom Scrollbar */
        ::-webkit-scrollbar { width: 8px; }
        ::-webkit-scrollbar-track { background: #f1f1f1; border-radius: 10px; }
        ::-webkit-scrollbar-thumb { background: var(--primary); border-radius: 10px; }

        /* Left Panel Content */
        .passage-title {
            font-size: 1.8rem;
            color: var(--primary);
            margin-bottom: 20px;
            text-align: center;
            font-weight: 900;
        }

        .para-block {
            margin-bottom: 25px;
            font-size: 1.2rem;
            line-height: 1.8;
        }

        .blank-span {
            display: inline-block;
            min-width: 60px;
            border-bottom: 3px dashed var(--primary);
            color: var(--primary);
            font-weight: 800;
            text-align: center;
            padding: 0 5px;
        }

        .btn-translate {
            display: block;
            margin-top: 10px;
            background: #f0f0f0;
            color: #555;
            border: 2px solid #ddd;
            padding: 8px 15px;
            border-radius: 12px;
            font-weight: 700;
            cursor: pointer;
            transition: all 0.3s;
        }
        .btn-translate:hover {
            background: var(--secondary);
            color: #fff;
            border-color: var(--secondary);
        }

        .translation-text {
            display: none;
            margin-top: 10px;
            padding: 15px;
            background: #fff8e1;
            border-left: 5px solid var(--secondary);
            border-radius: 0 10px 10px 0;
            font-size: 1.1rem;
            color: #555;
            font-style: italic;
        }

        /* Glossary Table */
        .glossary-table {
            width: 100%;
            border-collapse: collapse;
            margin-top: 30px;
            background: #fff;
            border-radius: 15px;
            overflow: hidden;
            box-shadow: 0 5px 15px rgba(0,0,0,0.05);
        }
        .glossary-table th, .glossary-table td {
            padding: 12px 15px;
            text-align: left;
            border-bottom: 1px solid #eee;
        }
        .glossary-table th {
            background: var(--primary);
            color: white;
            font-weight: 800;
        }
        .glossary-table tr:last-child td { border-bottom: none; }

        /* Right Panel - Questions */
        .question-card {
            background: #fff;
            border: 3px solid #eee;
            border-radius: 20px;
            padding: 20px;
            margin-bottom: 20px;
            transition: all 0.3s;
        }

        .q-title {
            font-size: 1.3rem;
            font-weight: 800;
            margin-bottom: 15px;
            color: var(--primary);
        }

        .options-grid {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 15px;
        }

        .option-btn {
            background: white;
            border: 2px solid #ddd;
            padding: 15px;
            border-radius: 15px;
            font-size: 1.1rem;
            font-weight: 700;
            color: #555;
            cursor: pointer;
            box-shadow: 0 6px 0 #ddd;
            transition: transform 0.1s, box-shadow 0.1s, background 0.2s;
            text-align: center;
        }
        .option-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 8px 0 #ddd;
        }
        .option-btn:active {
            transform: translateY(6px);
            box-shadow: 0 0 0 #ddd;
        }
        .option-btn.correct {
            background: var(--correct);
            border-color: var(--correct);
            color: white;
            box-shadow: 0 6px 0 #00ab55;
        }
        .option-btn.wrong {
            background: var(--wrong);
            border-color: var(--wrong);
            color: white;
            box-shadow: 0 6px 0 #d63031;
        }
        .option-btn:disabled { cursor: not-allowed; }

        /* Shake Animation */
        @keyframes shake {
            0%, 100% { transform: translateX(0); }
            20%, 60% { transform: translateX(-5px); }
            40%, 80% { transform: translateX(5px); }
        }
        .shake { animation: shake 0.4s; }

        /* Detailed Explanation Box */
        .explanation-box {
            display: none;
            margin-top: 15px;
            padding: 15px;
            background: #e3f2fd;
            border: 2px solid #bbdefb;
            border-radius: 15px;
            font-size: 1.05rem;
            line-height: 1.6;
            animation: fadeIn 0.5s;
        }
        @keyframes fadeIn { from { opacity: 0; transform: translateY(-10px); } to { opacity: 1; transform: translateY(0); } }
        
        .exp-section { margin-bottom: 10px; }
        .exp-title { font-weight: 800; color: #1565c0; margin-bottom: 5px; display: block; }
        .exp-vocab b { color: #d32f2f; }

        /* Submit Button */
        .btn-submit {
            display: block;
            width: 100%;
            background: var(--primary);
            color: white;
            font-size: 1.5rem;
            font-weight: 900;
            padding: 20px;
            border: none;
            border-radius: 20px;
            cursor: pointer;
            box-shadow: 0 8px 0 #5e35b1;
            margin-top: 30px;
            transition: transform 0.1s, box-shadow 0.1s;
        }
        .btn-submit:active {
            transform: translateY(8px);
            box-shadow: 0 0 0 #5e35b1;
        }

        /* Result Modal */
        .modal-overlay {
            position: fixed; top: 0; left: 0; width: 100%; height: 100%;
            background: rgba(0,0,0,0.8);
            display: none; justify-content: center; align-items: center; z-index: 100;
        }
        .result-card {
            background: white; width: 400px; padding: 40px;
            border-radius: 30px; text-align: center;
            box-shadow: 0 15px 50px rgba(0,0,0,0.3);
            transform: scale(0.8); transition: transform 0.3s cubic-bezier(0.175, 0.885, 0.32, 1.275);
        }
        .result-card.show { transform: scale(1); }
        .score-circle {
            width: 150px; height: 150px; border-radius: 50%;
            background: var(--secondary); margin: 0 auto 20px;
            display: flex; justify-content: center; align-items: center;
            font-size: 3rem; font-weight: 900; color: white;
            border: 10px solid #ffeaa7;
        }
        .result-msg { font-size: 1.5rem; font-weight: 800; color: var(--primary); margin-bottom: 20px; }
        .btn-close-modal {
            background: var(--accent); color: white; border: none; padding: 10px 30px;
            border-radius: 15px; font-size: 1.2rem; font-weight: 700; cursor: pointer;
            box-shadow: 0 5px 0 #00b894;
        }

        /* Confetti Canvas */
        #confetti-canvas {
            position: fixed; top: 0; left: 0; width: 100%; height: 100%;
            pointer-events: none; z-index: 999;
        }

        @media (max-width: 900px) {
            .split-container { flex-direction: column; overflow-y: auto; height: auto; }
            body { overflow: auto; }
            .left-panel, .right-panel { overflow-y: visible; }
            .options-grid { grid-template-columns: 1fr; }
        }
    </style>
</head>
<body>

    <div class="bg-pattern"></div>
    <canvas id="confetti-canvas"></canvas>

    <div class="header">
        <div class="author-title">Gi√°o vi√™n t·∫°o: Ms Mai An ULIS</div>
        <div class="timer-container">
            <button class="btn-timer" id="btn-timer" onclick="toggleTimer()">B·∫ÆT ƒê·∫¶U T√çNH GI·ªú L√ÄM B√ÄI</button>
            <div class="time-display" id="time-display">10:00</div>
        </div>
    </div>

    <div class="split-container">
        <div class="left-panel">
            <h1 class="passage-title">üé¨ IELTS SPEAKING PART 2 WORKSHEET</h1>
            <p><strong>Topic:</strong> Describe a dramatic movie that left a strong impression on you.</p>
            <hr style="margin: 15px 0; border: 1px dashed #ccc;">
            
            <div class="para-block">
                "I‚Äôd like to talk about a highly dramatic indie movie I watched recently. It started off as a sweet story about <span class="blank-span" id="blank-1">(1)</span> between two high school teenagers. The main character, a boy who decided to <span class="blank-span" id="blank-2">(2)</span> to look edgy and cool, seemed almost <span class="blank-span" id="blank-3">(3)</span> to the girl, like he could do no wrong.
                <button class="btn-translate" onclick="toggleTrans('trans1')">M·ªü d·ªãch ƒëo·∫°n n√†y üåü</button>
                <div class="translation-text" id="trans1">"T√¥i mu·ªën k·ªÉ v·ªÅ m·ªôt b·ªô phim ƒë·ªôc l·∫≠p ƒë·∫ßy k·ªãch t√≠nh m√† t√¥i m·ªõi xem g·∫ßn ƒë√¢y. N√≥ b·∫Øt ƒë·∫ßu nh∆∞ m·ªôt c√¢u chuy·ªán ng·ªçt ng√†o v·ªÅ t√¨nh y√™u g√† b√¥ng (t√¨nh y√™u tr·∫ª con) gi·ªØa hai thanh thi·∫øu ni√™n trung h·ªçc. Nh√¢n v·∫≠t ch√≠nh, m·ªôt c·∫≠u b√© quy·∫øt ƒë·ªãnh nong tai ƒë·ªÉ tr√¥ng c√° t√≠nh v√† ng·∫ßu, d∆∞·ªùng nh∆∞ g·∫ßn nh∆∞ l√† ng∆∞·ªùi si√™u ph√†m ƒë·ªëi v·ªõi c√¥ g√°i, ki·ªÉu nh∆∞ c·∫≠u ·∫•y kh√¥ng th·ªÉ l√†m g√¨ sai."</div>
            </div>

            <div class="para-block">
                However, the <span class="blank-span" id="blank-4">(4)</span> quickly changed. It turned out he was a serial <span class="blank-span" id="blank-5">(5)</span>. When he finally <span class="blank-span" id="blank-6">(6)</span> by her friends, he tried to claim there were <span class="blank-span" id="blank-7">(7)</span> for his actions, making up pathetic excuses. He tried to manipulate her and make her feel <span class="blank-span" id="blank-8">(8)</span>, but she proudly realized his behavior was completely <span class="blank-span" id="blank-9">(9)</span> her.
                <button class="btn-translate" onclick="toggleTrans('trans2')">M·ªü d·ªãch ƒëo·∫°n n√†y üåü</button>
                <div class="translation-text" id="trans2">"Tuy nhi√™n, t√¨nh th·∫ø ƒë√£ nhanh ch√≥ng thay ƒë·ªïi. H√≥a ra c·∫≠u ta l√† m·ªôt k·∫ª l·ª´a d·ªëi h√†ng lo·∫°t. Khi c·∫≠u ta cu·ªëi c√πng b·ªã b·∫Øt qu·∫£ tang b·ªüi b·∫°n b√® c·ªßa c√¥, c·∫≠u ta c·ªë g·∫Øng cho r·∫±ng c√≥ nh·ªØng t√¨nh ti·∫øt gi·∫£m nh·∫π cho h√†nh ƒë·ªông c·ªßa m√¨nh, b·ªãa ra nh·ªØng l·ªùi b√†o ch·ªØa th·∫£m h·∫°i. C·∫≠u ta c·ªë thao t√∫ng c√¥ v√† l√†m cho c√¥ c·∫£m th·∫•y nh·ªè b√© y·∫øu ·ªõt, nh∆∞ng c√¥ ƒë√£ t·ª± h√†o nh·∫≠n ra h√†nh vi c·ªßa c·∫≠u ta ho√†n to√†n kh√¥ng x·ª©ng t·∫ßm v·ªõi c√¥."</div>
            </div>

            <div class="para-block">
                She was furious and initially wanted to <span class="blank-span" id="blank-10">(10)</span> for breaking her heart. She managed to <span class="blank-span" id="blank-11">(11)</span> him in the school hallway, screaming, "<span class="blank-span" id="blank-12">(12)</span>, you're acting like a <span class="blank-span" id="blank-13">(13)</span> monster!" and ended her rant by yelling, "<span class="blank-span" id="blank-14">(14)</span>!". She saw him as nothing but a <span class="blank-span" id="blank-15">(15)</span> and a <span class="blank-span" id="blank-16">(16)</span> person.
                <button class="btn-translate" onclick="toggleTrans('trans3')">M·ªü d·ªãch ƒëo·∫°n n√†y üåü</button>
                <div class="translation-text" id="trans3">"C√¥ v√¥ c√πng t·ª©c gi·∫≠n v√† ban ƒë·∫ßu mu·ªën b·∫Øt anh ta ph·∫£i tr·∫£ gi√° v√¨ ƒë√£ l√†m tan n√°t tr√°i tim c√¥. C√¥ xoay s·ªü ƒë·ªÉ d·ªìn anh ta v√†o g√≥c ·ªü h√†nh lang tr∆∞·ªùng, h√©t l√™n: 'ƒê·ªì ng·ªëc!, anh ƒëang h√†nh x·ª≠ nh∆∞ m·ªôt con qu√°i v·∫≠t v√¥ nh√¢n t√≠nh!' v√† k·∫øt th√∫c b√†i ch·ª≠i r·ªßa c·ªßa m√¨nh b·∫±ng c√°ch h√©t l√™n, 'M·∫∑c x√°c anh!'. C√¥ coi anh ta kh√¥ng g√¨ kh√°c ngo√†i m·ªôt k·∫ª ph·∫£n b·ªôi v√† m·ªôt k·∫ª ƒë·∫ßy th√π h·∫±n h·∫πp h√≤i."</div>
            </div>

            <div class="para-block">
                Knowing his reputation in their small town was ruined, he looked like an absolute <span class="blank-span" id="blank-17">(17)</span>. Over the next few months, instead of apologizing, he just seemed to <span class="blank-span" id="blank-18">(18)</span> in his own self-pity. The <span class="blank-span" id="blank-19">(19)</span> between who he used to be and what he had become was huge.
                <button class="btn-translate" onclick="toggleTrans('trans4')">M·ªü d·ªãch ƒëo·∫°n n√†y üåü</button>
                <div class="translation-text" id="trans4">"Bi·∫øt r·∫±ng danh ti·∫øng c·ªßa m√¨nh ·ªü th·ªã tr·∫•n nh·ªè ƒë√£ b·ªã h·ªßy ho·∫°i, anh ta tr√¥ng gi·ªëng h·ªát m·ªôt k·∫ª h·∫øt th·ªùi (v√¥ ph∆∞∆°ng c·ª©u ch·ªØa). Trong v√†i th√°ng ti·∫øp theo, thay v√¨ xin l·ªói, anh ta d∆∞·ªùng nh∆∞ ch·ªâ ti·ªÅu t·ª•y h√©o m√≤n trong s·ª± th∆∞∆°ng h·∫°i b·∫£n th√¢n. H·ªë s√¢u ngƒÉn c√°ch gi·ªØa con ng∆∞·ªùi tr∆∞·ªõc ƒë√¢y c·ªßa anh ta v√† con ng∆∞·ªùi hi·ªán t·∫°i l√† r·∫•t l·ªõn."</div>
            </div>

            <div class="para-block">
                Eventually, the girl realized she was <span class="blank-span" id="blank-20">(20)</span> moving on rather than holding onto anger. She decided to completely <span class="blank-span" id="blank-21">(21)</span> the past, accepting that he would never truly <span class="blank-span" id="blank-22">(22)</span> with the same sincerity she gave him.
                <button class="btn-translate" onclick="toggleTrans('trans5')">M·ªü d·ªãch ƒëo·∫°n n√†y üåü</button>
                <div class="translation-text" id="trans5">"Cu·ªëi c√πng, c√¥ g√°i nh·∫≠n ra m√¨nh t·ªët h∆°n h·∫øt l√† b∆∞·ªõc ti·∫øp thay v√¨ gi·ªØ l·∫•y s·ª± t·ª©c gi·∫≠n. C√¥ quy·∫øt ƒë·ªãnh ho√†n to√†n bu√¥ng b·ªè qu√° kh·ª©, ch·∫•p nh·∫≠n r·∫±ng anh ta s·∫Ω kh√¥ng bao gi·ªù th·ª±c s·ª± th√≠ch l·∫°i c√¥ v·ªõi s·ª± ch√¢n th√†nh nh∆∞ c√¥ ƒë√£ d√†nh cho anh ta."</div>
            </div>

            <div class="para-block">
                In the final scene, set years later, we see her happily married. The director shows a heartwarming moment where her husband tries to <span class="blank-span" id="blank-23">(23)</span> her to make her laugh while they <span class="blank-span" id="blank-24">(24)</span> together. She looks genuinely at peace. The movie implies she will definitely <span class="blank-span" id="blank-25">(25)</span> the trauma of her youth. Even though her first relationship was a disaster, she realized those early painful lessons were <span class="blank-span" id="blank-26">(26)</span> because they taught her real self-worth."
                <button class="btn-translate" onclick="toggleTrans('trans6')">M·ªü d·ªãch ƒëo·∫°n n√†y üåü</button>
                <div class="translation-text" id="trans6">"Trong c·∫£nh cu·ªëi c√πng, l·∫•y b·ªëi c·∫£nh nhi·ªÅu nƒÉm sau, ch√∫ng ta th·∫•y c√¥ ·∫•y c√≥ m·ªôt cu·ªôc h√¥n nh√¢n h·∫°nh ph√∫c. ƒê·∫°o di·ªÖn kh·∫Øc h·ªça m·ªôt kho·∫£nh kh·∫Øc ·∫•m √°p khi ch·ªìng c√¥ c·ªë g·∫Øng c√π l√©c c√¥ ƒë·ªÉ l√†m c√¥ c∆∞·ªùi trong khi h·ªç c√πng nhau b·∫ø m·ªôt em b√©. C√¥ ·∫•y tr√¥ng th·ª±c s·ª± b√¨nh y√™n. B·ªô phim ng·ª• √Ω r·∫±ng c√¥ ·∫•y ch·∫Øc ch·∫Øn s·∫Ω s·ªëng l√¢u h∆°n (v∆∞·ª£t qua) n·ªói ƒëau th·ªùi tu·ªïi tr·∫ª. M·∫∑c d√π m·ªëi t√¨nh ƒë·∫ßu c·ªßa c√¥ l√† m·ªôt th·∫£m h·ªça, c√¥ nh·∫≠n ra nh·ªØng b√†i h·ªçc ƒëau ƒë·ªõn ban ƒë·∫ßu ƒë√≥ c√≤n h∆°n l√† kh√¥ng c√≥ g√¨ b·ªüi v√¨ ch√∫ng ƒë√£ d·∫°y cho c√¥ gi√° tr·ªã th·ª±c s·ª± c·ªßa b·∫£n th√¢n."</div>
            </div>

            <h3 style="margin-top: 30px; color: var(--primary);">üìö Glossary (B·∫£ng t·ª´ v·ª±ng kh√≥ B1-C2)</h3>
            <table class="glossary-table">
                <tr><th>Vocabulary</th><th>POS</th><th>Vietnamese Meaning</th></tr>
                <tr><td>1. Dramatic</td><td>adj</td><td>K·ªãch t√≠nh, g√¢y x√∫c ƒë·ªông m·∫°nh</td></tr>
                <tr><td>2. Impression</td><td>noun</td><td>·∫§n t∆∞·ª£ng s√¢u s·∫Øc</td></tr>
                <tr><td>3. Indie (Independent)</td><td>adj</td><td>(Phim/Nh·∫°c) ƒê·ªôc l·∫≠p, kh√¥ng thu·ªôc studio l·ªõn</td></tr>
                <tr><td>4. Manipulate</td><td>verb</td><td>Thao t√∫ng t√¢m l√Ω, ƒëi·ªÅu khi·ªÉn</td></tr>
                <tr><td>5. Extenuating</td><td>adj</td><td>L√†m gi·∫£m nh·∫π (t·ªôi l·ªói, l·ªói l·∫ßm)</td></tr>
                <tr><td>6. Rant</td><td>noun</td><td>B√†i ch·ª≠i r·ªßa, n√≥i ph·∫´n n·ªô k√©o d√†i</td></tr>
                <tr><td>7. Reputation</td><td>noun</td><td>Danh ti·∫øng, thanh danh</td></tr>
                <tr><td>8. Sincerity</td><td>noun</td><td>S·ª± ch√¢n th√†nh, th√†nh th·∫≠t</td></tr>
                <tr><td>9. Heartwarming</td><td>adj</td><td>·∫§m l√≤ng, c·∫£m ƒë·ªông</td></tr>
                <tr><td>10. Trauma</td><td>noun</td><td>Ch·∫•n th∆∞∆°ng t√¢m l√Ω, c√∫ s·ªëc</td></tr>
            </table>
        </div>

        <div class="right-panel" id="questions-container">
            <button class="btn-submit" onclick="submitTest()">N·ªòP B√ÄI T·ªîNG K·∫æT üöÄ</button>
        </div>
    </div>

    <div class="modal-overlay" id="result-modal">
        <div class="result-card" id="result-card">
            <div class="score-circle" id="score-display">0/26</div>
            <div class="result-msg" id="result-msg">Tuy·ªát v·ªùi!</div>
            <button class="btn-close-modal" onclick="closeModal()">Xem l·∫°i ƒë√°p √°n</button>
        </div>
    </div>

    <script>
        // --- DATA ARCHITECTURE ---
        const qaData = [
            { id: 1, ans: "puppy love", options: ["puppy love", "chasm", "state of things", "goner"], vi: "t√¨nh y√™u g√† b√¥ng", vA: "t√¨nh y√™u tu·ªïi m·ªõi l·ªõn", vB: "kho·∫£ng c√°ch s√¢u th·∫≥m", vC: "t√¨nh tr·∫°ng hi·ªán t·∫°i", vD: "k·∫ª h·∫øt th·ªùi", trans: "N√≥ b·∫Øt ƒë·∫ßu nh∆∞ m·ªôt c√¢u chuy·ªán ng·ªçt ng√†o v·ªÅ t√¨nh y√™u g√† b√¥ng gi·ªØa hai thanh thi·∫øu ni√™n trung h·ªçc.", reason: "C·ª•m 'sweet story' v√† 'high school teenagers' l√† d·∫•u hi·ªáu r√µ nh·∫•t ch·ªâ t√¨nh y√™u tu·ªïi h·ªçc tr√≤ trong s√°ng (puppy love)." },
            { id: 2, ans: "gauge his ears", options: ["gauge his ears", "make him pay", "outlive", "corner"], vi: "nong tai", vA: "nong l·ªó tai", vB: "b·∫Øt tr·∫£ gi√°", vC: "s·ªëng th·ªç h∆°n", vD: "d·ªìn v√†o g√≥c", trans: "M·ªôt c·∫≠u b√© quy·∫øt ƒë·ªãnh nong tai ƒë·ªÉ tr√¥ng c√° t√≠nh v√† ng·∫ßu.", reason: "'to look edgy and cool' l√† m·ª•c ƒë√≠ch c·ªßa vi·ªác l√†m thay ƒë·ªïi ngo·∫°i h√¨nh, 'gauge his ears' (nong tai) l√† h√†nh ƒë·ªông duy nh·∫•t ph√π h·ª£p." },
            { id: 3, ans: "superhuman", options: ["superhuman", "puny", "subhuman", "spiteful"], vi: "si√™u ph√†m", vA: "si√™u ph√†m", vB: "nh·ªè b√©/y·∫øu ·ªõt", vC: "v√¥ nh√¢n t√≠nh", vD: "h·∫±n h·ªçc", trans: "D∆∞·ªùng nh∆∞ g·∫ßn nh∆∞ l√† ng∆∞·ªùi si√™u ph√†m ƒë·ªëi v·ªõi c√¥ g√°i, ki·ªÉu nh∆∞ c·∫≠u ·∫•y kh√¥ng th·ªÉ l√†m g√¨ sai.", reason: "'could do no wrong' (kh√¥ng th·ªÉ l√†m g√¨ sai) mang √Ω nghƒ©a t√¥n s√πng, ph√π h·ª£p v·ªõi 'superhuman'." },
            { id: 4, ans: "state of things", options: ["state of things", "puppy love", "extenuating circumstances", "traitor"], vi: "t√¨nh th·∫ø", vA: "t√¨nh tr·∫°ng hi·ªán t·∫°i", vB: "t√¨nh y√™u g√† b√¥ng", vC: "t√¨nh ti·∫øt gi·∫£m nh·∫π", vD: "k·∫ª ph·∫£n b·ªôi", trans: "Tuy nhi√™n, t√¨nh th·∫ø ƒë√£ nhanh ch√≥ng thay ƒë·ªïi.", reason: "'quickly changed' c·∫ßn m·ªôt danh t·ª´ ch·ªâ ho√†n c·∫£nh chung. 'State of things' nghƒ©a l√† c·ª•c di·ªán/t√¨nh th·∫ø." },
            { id: 5, ans: "cheater", options: ["cheater", "traitor", "goner", "moron"], vi: "k·∫ª l·ª´a d·ªëi", vA: "k·∫ª ngo·∫°i t√¨nh/l·ª´a d·ªëi", vB: "k·∫ª ph·∫£n b·ªôi", vC: "k·∫ª h·∫øt th·ªùi", vD: "ƒë·ªì ng·ªëc", trans: "H√≥a ra c·∫≠u ta l√† m·ªôt k·∫ª l·ª´a d·ªëi h√†ng lo·∫°t (b·∫Øt c√° nhi·ªÅu tay).", reason: "Ph√π h·ª£p ng·ªØ c·∫£nh t√¨nh c·∫£m b·ªã l·ª´a d·ªëi, 'serial cheater' l√† c·ª•m t·ª´ ph·ªï bi·∫øn." },
            { id: 6, ans: "got busted", options: ["got busted", "waste away", "let go of", "outlive"], vi: "b·ªã b·∫Øt qu·∫£ tang", vA: "b·ªã b·∫Øt qu·∫£ tang", vB: "ti·ªÅu t·ª•y", vC: "bu√¥ng b·ªè", vD: "s·ªëng l√¢u h∆°n", trans: "Khi c·∫≠u ta cu·ªëi c√πng b·ªã b·∫Øt qu·∫£ tang b·ªüi b·∫°n b√® c·ªßa c√¥...", reason: "Ch·ªß ng·ªØ l√† 'he', v·∫ø sau l√† 'by her friends', c·∫ßn m·ªôt ƒë·ªông t·ª´ b·ªã ƒë·ªông. 'Got busted' (b·ªã b·∫Øt t·∫°i tr·∫≠n) r·∫•t h·ª£p l√Ω." },
            { id: 7, ans: "extenuating circumstances", options: ["extenuating circumstances", "puppy love", "chasm", "state of things"], vi: "t√¨nh ti·∫øt gi·∫£m nh·∫π", vA: "t√¨nh ti·∫øt gi·∫£m nh·∫π", vB: "t√¨nh y√™u tr·∫ª con", vC: "h·ªë s√¢u", vD: "c·ª•c di·ªán", trans: "C·∫≠u ta c·ªë g·∫Øng cho r·∫±ng c√≥ nh·ªØng t√¨nh ti·∫øt gi·∫£m nh·∫π cho h√†nh ƒë·ªông c·ªßa m√¨nh...", reason: "'claim there were...' v√† 'excuses' (l·ªùi b√†o ch·ªØa) ƒëi li·ªÅn v·ªõi c·ª•m t·ª´ ph√°p l√Ω/trang tr·ªçng 'extenuating circumstances'." },
            { id: 8, ans: "puny", options: ["puny", "superhuman", "spiteful", "better off"], vi: "nh·ªè b√©, y·∫øu ·ªõt", vA: "nh·ªè b√©/y·∫øu ƒëu·ªëi", vB: "si√™u ph√†m", vC: "h·∫±n h·ªçc", vD: "t·ªët h∆°n", trans: "C·∫≠u ta c·ªë thao t√∫ng c√¥ v√† l√†m cho c√¥ c·∫£m th·∫•y nh·ªè b√© y·∫øu ·ªõt.", reason: "'manipulate' (thao t√∫ng) th∆∞·ªùng ƒëi k√®m v·ªõi vi·ªác l√†m n·∫°n nh√¢n c·∫£m th·∫•y v√¥ gi√° tr·ªã/nh·ªè b√© (puny)." },
            { id: 9, ans: "beneath", options: ["beneath", "better than nothing", "subhuman", "spiteful"], vi: "kh√¥ng x·ª©ng t·∫ßm, th·∫•p k√©m h∆°n", vA: "th·∫•p k√©m h∆°n", vB: "c√≥ c√≤n h∆°n kh√¥ng", vC: "v√¥ nh√¢n t√≠nh", vD: "h·∫±n h·ªçc", trans: "C√¥ t·ª± h√†o nh·∫≠n ra h√†nh vi c·ªßa c·∫≠u ta ho√†n to√†n kh√¥ng x·ª©ng t·∫ßm v·ªõi c√¥.", reason: "'completely beneath her' l√† m·ªôt idiom ch·ªâ vi·ªác ai/ƒëi·ªÅu g√¨ ƒë√≥ qu√° t·ªìi t·ªá, kh√¥ng ƒë√°ng ƒë·ªÉ m√¨nh b·∫≠n t√¢m." },
            { id: 10, ans: "make him pay", options: ["make him pay", "tickle", "hold a baby", "corner"], vi: "b·∫Øt tr·∫£ gi√°", vA: "b·∫Øt h·∫Øn tr·∫£ gi√°", vB: "c√π l√©c", vC: "b·∫ø em b√©", vD: "d·ªìn v√†o g√≥c", trans: "C√¥ v√¥ c√πng t·ª©c gi·∫≠n v√† ban ƒë·∫ßu mu·ªën b·∫Øt anh ta ph·∫£i tr·∫£ gi√° v√¨ ƒë√£ l√†m tan n√°t tr√°i tim c√¥.", reason: "'furious' (t·ª©c gi·∫≠n) d·∫´n ƒë·∫øn h√†nh ƒë·ªông mu·ªën tr·∫£ th√π (make him pay)." },
            { id: 11, ans: "corner", options: ["corner", "waste away", "let go of", "outlive"], vi: "d·ªìn v√†o g√≥c", vA: "d·ªìn √©p/ch·∫∑n ƒë∆∞·ªùng", vB: "ti·ªÅu t·ª•y", vC: "bu√¥ng b·ªè", vD: "s·ªëng th·ªç h∆°n", trans: "C√¥ xoay s·ªü ƒë·ªÉ d·ªìn anh ta v√†o g√≥c ·ªü h√†nh lang tr∆∞·ªùng...", reason: "'in the school hallway' (h√†nh lang) l√† ƒë·ªãa ƒëi·ªÉm l√Ω t∆∞·ªüng ƒë·ªÉ ch·∫∑n ƒë∆∞·ªùng/d·ªìn ai ƒë√≥ (corner)." },
            { id: 12, ans: "You moron!", options: ["You moron!", "Screw you", "better off", "goner"], vi: "ƒê·ªì ng·ªëc", vA: "ƒê·ªì ngu ng·ªëc!", vB: "M·∫∑c k·ªá m√†y", vC: "T·ªët h∆°n", vD: "K·∫ª h·∫øt th·ªùi", trans: "h√©t l√™n: 'ƒê·ªì ng·ªëc!, anh ƒëang h√†nh x·ª≠ nh∆∞ m·ªôt con qu√°i v·∫≠t...'", reason: "ƒê·ª©ng ƒë·∫ßu c√¢u c·∫£m th√°n g·ªçi t√™n ng∆∞·ªùi ƒë·ªëi di·ªán, mang t√≠nh x√∫c ph·∫°m nh·∫π." },
            { id: 13, ans: "subhuman", options: ["subhuman", "superhuman", "puny", "spiteful"], vi: "v√¥ nh√¢n t√≠nh", vA: "d∆∞·ªõi m·ª©c con ng∆∞·ªùi/th√∫ t√≠nh", vB: "si√™u ph√†m", vC: "nh·ªè b√©", vD: "th√π h·∫±n", trans: "...h√†nh x·ª≠ nh∆∞ m·ªôt con qu√°i v·∫≠t v√¥ nh√¢n t√≠nh!", reason: "B·ªï nghƒ©a cho 'monster', 'subhuman' (th·∫•p h∆°n c·∫£ con ng∆∞·ªùi) c·ª±c k·ª≥ ph√π h·ª£p." },
            { id: 14, ans: "Screw you", options: ["Screw you", "You moron!", "better than nothing", "beneath"], vi: "M·∫∑c x√°c anh", vA: "M·∫∑c x√°c m√†y/C√∫t ƒëi", vB: "ƒê·ªì ng·ªëc", vC: "C√≥ c√≤n h∆°n kh√¥ng", vD: "Th·∫•p k√©m", trans: "k·∫øt th√∫c b√†i ch·ª≠i r·ªßa c·ªßa m√¨nh b·∫±ng c√°ch h√©t l√™n, 'M·∫∑c x√°c anh!'.", reason: "C√¢u ch·ªët h·∫° c·ªßa s·ª± ph·∫´n n·ªô, c·∫Øt ƒë·ª©t quan h·ªá." },
            { id: 15, ans: "traitor", options: ["traitor", "cheater", "goner", "chasm"], vi: "k·∫ª ph·∫£n b·ªôi", vA: "k·∫ª ph·∫£n b·ªôi", vB: "k·∫ª l·ª´a d·ªëi", vC: "k·∫ª h·∫øt th·ªùi", vD: "h·ªë s√¢u", trans: "C√¥ coi anh ta kh√¥ng g√¨ kh√°c ngo√†i m·ªôt k·∫ª ph·∫£n b·ªôi...", reason: "Gh√©p v·ªõi 'and a ... person', traitor l√† danh t·ª´ ch·ªâ ng∆∞·ªùi." },
            { id: 16, ans: "spiteful", options: ["spiteful", "puny", "superhuman", "better off"], vi: "ƒë·∫ßy th√π h·∫±n", vA: "h·∫±n h·ªçc/ch∆°i x·∫•u", vB: "y·∫øu ·ªõt", vC: "si√™u ph√†m", vD: "t·ªët h∆°n", trans: "...v√† m·ªôt k·∫ª ƒë·∫ßy th√π h·∫±n h·∫πp h√≤i.", reason: "C·∫ßn m·ªôt t√≠nh t·ª´ (tr∆∞·ªõc 'person') mang √Ω nghƒ©a ti√™u c·ª±c." },
            { id: 17, ans: "goner", options: ["goner", "traitor", "cheater", "moron"], vi: "k·∫ª h·∫øt th·ªùi/v√¥ ph∆∞∆°ng c·ª©u ch·ªØa", vA: "k·∫ª h·∫øt th·ªùi", vB: "k·∫ª ph·∫£n b·ªôi", vC: "k·∫ª l·ª´a d·ªëi", vD: "ƒë·ªì ng·ªëc", trans: "Bi·∫øt r·∫±ng danh ti·∫øng b·ªã h·ªßy ho·∫°i, anh ta tr√¥ng gi·ªëng h·ªát m·ªôt k·∫ª h·∫øt th·ªùi.", reason: "'ruined reputation' -> kh√¥ng th·ªÉ c·ª©u v√£n -> a goner." },
            { id: 18, ans: "waste away", options: ["waste away", "tickle", "outlive", "like her back"], vi: "ti·ªÅu t·ª•y, h√©o m√≤n", vA: "h√©o m√≤n/ti·ªÅu t·ª•y", vB: "c√π l√©c", vC: "s·ªëng l√¢u h∆°n", vD: "th√≠ch l·∫°i", trans: "anh ta d∆∞·ªùng nh∆∞ ch·ªâ ti·ªÅu t·ª•y h√©o m√≤n trong s·ª± th∆∞∆°ng h·∫°i b·∫£n th√¢n.", reason: "'in his own self-pity' k·∫øt h·ª£p v·ªõi vi·ªác suy s·ª•p th·ªÉ ch·∫•t/tinh th·∫ßn -> waste away." },
            { id: 19, ans: "chasm", options: ["chasm", "state of things", "puppy love", "extenuating circumstances"], vi: "h·ªë s√¢u", vA: "h·ªë s√¢u ngƒÉn c√°ch", vB: "c·ª•c di·ªán", vC: "t√¨nh y√™u", vD: "t√¨nh ti·∫øt gi·∫£m nh·∫π", trans: "H·ªë s√¢u ngƒÉn c√°ch gi·ªØa con ng∆∞·ªùi tr∆∞·ªõc ƒë√¢y c·ªßa anh ta v√† con ng∆∞·ªùi hi·ªán t·∫°i l√† r·∫•t l·ªõn.", reason: "So s√°nh 2 th√°i c·ª±c kh√°c bi·ªát, d√πng 'chasm' (v·ª±c th·∫≥m) mang t√≠nh ·∫©n d·ª• s√¢u s·∫Øc." },
            { id: 20, ans: "better off", options: ["better off", "puny", "beneath", "spiteful"], vi: "t·ªët h∆°n h·∫øt", vA: "t·ªët h∆°n/·ªïn h∆°n", vB: "nh·ªè b√©", vC: "th·∫•p k√©m", vD: "h·∫±n h·ªçc", trans: "C√¥ g√°i nh·∫≠n ra m√¨nh t·ªët h∆°n h·∫øt l√† b∆∞·ªõc ti·∫øp...", reason: "'was better off + V-ing' l√† c·∫•u tr√∫c c·ªë ƒë·ªãnh nghƒ©a l√† s·∫Ω c√≥ t√¨nh tr·∫°ng t·ªët h∆°n n·∫øu l√†m vi·ªác ƒë√≥." },
            { id: 21, ans: "let go of", options: ["let go of", "corner", "make him pay", "waste away"], vi: "bu√¥ng b·ªè", vA: "bu√¥ng b·ªè", vB: "d·ªìn g√≥c", vC: "tr·∫£ gi√°", vD: "ti·ªÅu t·ª•y", trans: "C√¥ quy·∫øt ƒë·ªãnh ho√†n to√†n bu√¥ng b·ªè qu√° kh·ª©...", reason: "ƒêi v·ªõi 'the past', ƒë·ªông t·ª´ h·ª£p l√Ω nh·∫•t ƒë·ªÉ tha th·ª©/b∆∞·ªõc ti·∫øp l√† 'let go of'." },
            { id: 22, ans: "like her back", options: ["like her back", "tickle", "hold a baby", "outlive"], vi: "th√≠ch l·∫°i c√¥", vA: "th√≠ch l·∫°i c√¥ ·∫•y", vB: "c√π l√©c", vC: "b·∫ø em b√©", vD: "s·ªëng th·ªç h∆°n", trans: "...ch·∫•p nh·∫≠n r·∫±ng anh ta s·∫Ω kh√¥ng bao gi·ªù th·ª±c s·ª± th√≠ch l·∫°i c√¥ v·ªõi s·ª± ch√¢n th√†nh...", reason: "H√†nh ƒë·ªông ƒë√°p l·∫°i t√¨nh c·∫£m (with sincerity) l√† 'like someone back'." },
            { id: 23, ans: "tickle", options: ["tickle", "make him pay", "gauge his ears", "corner"], vi: "c√π l√©c", vA: "c√π l√©c", vB: "tr·∫£ gi√°", vC: "nong tai", vD: "d·ªìn g√≥c", trans: "ch·ªìng c√¥ c·ªë g·∫Øng c√π l√©c c√¥ ƒë·ªÉ l√†m c√¥ c∆∞·ªùi...", reason: "M·ª•c ƒë√≠ch l√† 'make her laugh', h√†nh ƒë·ªông th·ªÉ ch·∫•t vui v·∫ª l√† 'tickle'." },
            { id: 24, ans: "hold a baby", options: ["hold a baby", "waste away", "let go of", "outlive"], vi: "b·∫ø em b√©", vA: "b·∫ø em b√©", vB: "ti·ªÅu t·ª•y", vC: "bu√¥ng b·ªè", vD: "s·ªëng l√¢u h∆°n", trans: "...trong khi h·ªç c√πng nhau b·∫ø m·ªôt em b√©.", reason: "C·∫£nh gia ƒë√¨nh h·∫°nh ph√∫c, 'together' ƒëi v·ªõi h√†nh ƒë·ªông chƒÉm s√≥c 'hold a baby'." },
            { id: 25, ans: "outlive", options: ["outlive", "tickle", "corner", "like her back"], vi: "s·ªëng l√¢u h∆°n/v∆∞·ª£t qua", vA: "s·ªëng l√¢u h∆°n/t·ªìn t·∫°i qua", vB: "c√π l√©c", vC: "d·ªìn g√≥c", vD: "th√≠ch l·∫°i", trans: "B·ªô phim ng·ª• √Ω r·∫±ng c√¥ ·∫•y ch·∫Øc ch·∫Øn s·∫Ω s·ªëng l√¢u h∆°n (v∆∞·ª£t qua) n·ªói ƒëau th·ªùi tu·ªïi tr·∫ª.", reason: "Outlive a trauma = ti·∫øp t·ª•c s·ªëng t·ªët sau khi tr·∫£i qua ch·∫•n th∆∞∆°ng t√¢m l√Ω." },
            { id: 26, ans: "better than nothing", options: ["better than nothing", "beneath", "better off", "spiteful"], vi: "c√≥ c√≤n h∆°n kh√¥ng", vA: "c√≤n h∆°n kh√¥ng c√≥", vB: "th·∫•p k√©m", vC: "t·ªët h∆°n", vD: "h·∫±n h·ªçc", trans: "c√¥ nh·∫≠n ra nh·ªØng b√†i h·ªçc ƒëau ƒë·ªõn ban ƒë·∫ßu ƒë√≥ c√≤n h∆°n l√† kh√¥ng c√≥ g√¨ b·ªüi v√¨ ch√∫ng ƒë√£ d·∫°y cho c√¥ gi√° tr·ªã th·ª±c s·ª± c·ªßa b·∫£n th√¢n.", reason: "Tuy painful nh∆∞ng mang l·∫°i gi√° tr·ªã l·ªõn -> c√≥ ƒëau ƒë·ªõn v·∫´n t·ªët h∆°n l√† kh√¥ng h·ªçc ƒë∆∞·ª£c g√¨." }
        ];

        // --- AUDIO ENGINE (Web Audio API) ---
        const audioCtx = new (window.AudioContext || window.webkitAudioContext)();
        function playSound(type) {
            if (audioCtx.state === 'suspended') audioCtx.resume();
            if (type === 'correct') {
                const osc = audioCtx.createOscillator();
                const gain = audioCtx.createGain();
                osc.connect(gain); gain.connect(audioCtx.destination);
                osc.type = 'sine'; 
                osc.frequency.setValueAtTime(523.25, audioCtx.currentTime); // C5
                osc.frequency.exponentialRampToValueAtTime(1046.50, audioCtx.currentTime + 0.1); // C6
                gain.gain.setValueAtTime(0.5, audioCtx.currentTime);
                gain.gain.exponentialRampToValueAtTime(0.01, audioCtx.currentTime + 0.4);
                osc.start(); osc.stop(audioCtx.currentTime + 0.4);
            } else {
                // T√©o t√®o t√®o
                const notes = [300, 250, 200];
                let time = audioCtx.currentTime;
                notes.forEach((freq) => {
                    const osc = audioCtx.createOscillator();
                    const gain = audioCtx.createGain();
                    osc.connect(gain); gain.connect(audioCtx.destination);
                    osc.type = 'sawtooth';
                    osc.frequency.setValueAtTime(freq, time);
                    gain.gain.setValueAtTime(0.3, time);
                    gain.gain.exponentialRampToValueAtTime(0.01, time + 0.2);
                    osc.start(time); osc.stop(time + 0.2);
                    time += 0.2;
                });
            }
        }

        // --- CONFETTI ENGINE ---
        const canvas = document.getElementById('confetti-canvas');
        const ctx = canvas.getContext('2d');
        canvas.width = window.innerWidth; canvas.height = window.innerHeight;
        let particles = [];
        const colors = ['#8854C0', '#FDCB6E', '#00C9A7', '#FF9A9E', '#00D26A', '#FF4757'];

        function fireConfetti() {
            for (let i = 0; i < 100; i++) {
                particles.push({
                    x: canvas.width / 2, y: canvas.height / 2,
                    r: Math.random() * 6 + 2,
                    dx: Math.random() * 20 - 10, dy: Math.random() * -20 - 5,
                    color: colors[Math.floor(Math.random() * colors.length)],
                    tilt: Math.floor(Math.random() * 10) - 10,
                    tiltAngleInc: (Math.random() * 0.07) + 0.05,
                    tiltAngle: 0
                });
            }
        }

        function drawConfetti() {
            ctx.clearRect(0, 0, canvas.width, canvas.height);
            particles.forEach((p, index) => {
                p.tiltAngle += p.tiltAngleInc;
                p.y += (Math.cos(p.tiltAngle) + 1 + p.r / 2) / 2;
                p.x += Math.sin(p.tiltAngle) * 2;
                p.dy += 0.5; // gravity
                p.y += p.dy;
                p.x += p.dx;
                
                ctx.beginPath();
                ctx.lineWidth = p.r;
                ctx.strokeStyle = p.color;
                ctx.moveTo(p.x + p.tilt + p.r, p.y);
                ctx.lineTo(p.x + p.tilt, p.y + p.tilt + p.r);
                ctx.stroke();

                if (p.y > canvas.height) particles.splice(index, 1);
            });
            requestAnimationFrame(drawConfetti);
        }
        drawConfetti();
        window.addEventListener('resize', () => { canvas.width = window.innerWidth; canvas.height = window.innerHeight; });

        // --- TIMER LOGIC ---
        let timerInterval;
        let timeLeft = 600; // 10 mins
        let isTimerRunning = false;

        function toggleTimer() {
            const btn = document.getElementById('btn-timer');
            if (!isTimerRunning) {
                isTimerRunning = true;
                btn.innerText = "T·∫†M D·ª™NG";
                timerInterval = setInterval(() => {
                    timeLeft--;
                    let m = Math.floor(timeLeft / 60);
                    let s = timeLeft % 60;
                    document.getElementById('time-display').innerText = `${m < 10 ? '0'+m : m}:${s < 10 ? '0'+s : s}`;
                    if (timeLeft <= 0) {
                        clearInterval(timerInterval);
                        alert("ƒê√£ h·∫øt gi·ªù l√†m b√†i. B·∫°n v·∫´n c√≥ th·ªÉ ti·∫øp t·ª•c l√†m, nh∆∞ng nh·ªõ l√† trong ph√≤ng thi th·∫≠t, b·∫°n ch·ªâ n√™n l√†m m·ªôt b√†i nh∆∞ th·∫ø n√†y trong 10 ph√∫t th√¥i nha.");
                        btn.innerText = "H·∫æT GI·ªú";
                        btn.disabled = true;
                    }
                }, 1000);
            } else {
                isTimerRunning = false;
                btn.innerText = "TI·∫æP T·ª§C L√ÄM B√ÄI";
                clearInterval(timerInterval);
            }
        }

        function toggleTrans(id) {
            const el = document.getElementById(id);
            el.style.display = (el.style.display === 'block') ? 'none' : 'block';
        }

        // --- QUESTION GENERATOR & LOGIC ---
        let score = 0;
        let answeredArr = new Array(26).fill(false);

        function shuffleArray(array) {
            for (let i = array.length - 1; i > 0; i--) {
                const j = Math.floor(Math.random() * (i + 1));
                [array[i], array[j]] = [array[j], array[i]];
            }
            return array;
        }

        function renderQuestions() {
            const container = document.getElementById('questions-container');
            let html = '';
            qaData.forEach((q, index) => {
                let opts = [...q.options];
                opts = shuffleArray(opts);
                let letters = ['A', 'B', 'C', 'D'];
                
                html += `
                <div class="question-card" id="q-card-${q.id}">
                    <div class="q-title">Question ${q.id}: Choose the correct word for blank (${q.id})</div>
                    <div class="options-grid" id="grid-${q.id}">
                        ${opts.map((opt, i) => `
                            <button class="option-btn" onclick="checkAnswer(${q.id}, '${opt}', this)">
                                ${letters[i]}. ${opt}
                            </button>
                        `).join('')}
                    </div>
                    
                    <div class="explanation-box" id="exp-${q.id}">
                        <div class="exp-section">
                            <span class="exp-title">1. Ph√¢n t√≠ch t·ª´ v·ª±ng:</span>
                            <div class="exp-vocab">A. ${opts[0]} (${getVi(q, opts[0])})<br>B. ${opts[1]} (${getVi(q, opts[1])})<br>C. ${opts[2]} (${getVi(q, opts[2])})<br>D. ${opts[3]} (${getVi(q, opts[3])})</div>
                        </div>
                        <div class="exp-section">
                            <span class="exp-title">2. D·ªãch nghƒ©a ng·ªØ c·∫£nh:</span>
                            <div>${q.trans}</div>
                        </div>
                        <div class="exp-section">
                            <span class="exp-title">3. T·∫°i sao ch·ªçn "${q.ans}"?</span>
                            <div>${q.reason}</div>
                        </div>
                    </div>
                </div>`;
            });
            // Insert before the submit button
            container.insertAdjacentHTML('afterbegin', html);
        }

        function getVi(qObj, word) {
            if(word === qObj.options[0]) return qObj.vA;
            if(word === qObj.options[1]) return qObj.vB;
            if(word === qObj.options[2]) return qObj.vC;
            if(word === qObj.options[3]) return qObj.vD;
            return "Nghƒ©a ti·∫øng Vi·ªát";
        }

        function checkAnswer(qId, selectedWord, btn) {
            if (answeredArr[qId - 1]) return; 
            
            const q = qaData.find(x => x.id === qId);
            const grid = document.getElementById(`grid-${qId}`);
            const buttons = grid.querySelectorAll('.option-btn');
            
            answeredArr[qId - 1] = true;
            buttons.forEach(b => b.disabled = true); // Disable all

            if (selectedWord === q.ans) {
                // Correct
                btn.classList.add('correct');
                playSound('correct');
                fireConfetti();
                score++;
                document.getElementById(`blank-${qId}`).innerText = q.ans;
                document.getElementById(`blank-${qId}`).style.color = "var(--correct)";
                document.getElementById(`blank-${qId}`).style.borderColor = "var(--correct)";
            } else {
                // Wrong
                btn.classList.add('wrong');
                btn.classList.add('shake');
                playSound('wrong');
                setTimeout(() => btn.classList.remove('shake'), 400);
                
                // Highlight correct one
                buttons.forEach(b => {
                    if(b.innerText.includes(q.ans)) b.classList.add('correct');
                });
                document.getElementById(`blank-${qId}`).innerText = q.ans;
                document.getElementById(`blank-${qId}`).style.color = "var(--wrong)";
                document.getElementById(`blank-${qId}`).style.borderColor = "var(--wrong)";
            }

            // Show explanation
            document.getElementById(`exp-${qId}`).style.display = 'block';
            
            // Auto scroll to next question slightly
            setTimeout(() => {
                const nextCard = document.getElementById(`q-card-${qId + 1}`);
                if (nextCard) nextCard.scrollIntoView({ behavior: 'smooth', block: 'center' });
            }, 1500);
        }

        function submitTest() {
            clearInterval(timerInterval);
            const modal = document.getElementById('result-modal');
            const scoreDisplay = document.getElementById('score-display');
            const msg = document.getElementById('result-msg');
            
            scoreDisplay.innerText = `${score}/26`;
            
            if(score === 26) msg.innerText = "Thi√™n t√†i ngo·∫°i ng·ªØ l√† ƒë√¢y! üèÜ";
            else if(score >= 20) msg.innerText = "L√†m t·ªët l·∫Øm! G·∫ßn ho√†n h·∫£o r·ªìi! üåü";
            else if(score >= 13) msg.innerText = "C·ªë l√™n nh√©! B·∫°n ƒë√£ ƒëi ƒë∆∞·ª£c n·ª≠a ch·∫∑ng ƒë∆∞·ªùng! üëç";
            else msg.innerText = "ƒê·ª´ng n·∫£n ch√≠! H√£y ƒë·ªçc k·ªπ gi·∫£i th√≠ch v√† l√†m l·∫°i nha! üí™";
            
            modal.style.display = 'flex';
            setTimeout(() => { document.getElementById('result-card').classList.add('show'); }, 50);
            
            if(score >= 20) fireConfetti();
        }

        function closeModal() {
            document.getElementById('result-card').classList.remove('show');
            setTimeout(() => { document.getElementById('result-modal').style.display = 'none'; }, 300);
        }

        // Init
        window.onload = () => {
            renderQuestions();
        };
    </script>
</body>
</html>