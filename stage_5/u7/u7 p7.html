<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Th·ª≠ Th√°ch Gi·ªõi T·ª´ Part 2 - Ms Mai An</title>
    <link href="https://fonts.googleapis.com/css2?family=Nunito:wght@400;600;700;800&family=Quicksand:wght@500;700&display=swap" rel="stylesheet">
    <style>
        :root {
            --primary: #6c5ce7; /* T√≠m ƒë·∫≠m h∆°n ch√∫t */
            --secondary: #00cec9; /* Xanh ng·ªçc s√°ng */
            --correct: #00b894; /* Xanh mint ƒë·∫≠m */
            --wrong: #ff7675; /* ƒê·ªè h·ªìng */
            --bg-pattern: #dfe6e9;
            --text-main: #2d3436;
        }

        * { box-sizing: border-box; margin: 0; padding: 0; }

        body {
            font-family: 'Nunito', sans-serif;
            background-color: #ffeaa7; /* N·ªÅn v√†ng nh·∫°t ·∫•m √°p */
            background-image: radial-gradient(#6c5ce7 15%, transparent 16%), radial-gradient(#00cec9 15%, transparent 16%);
            background-size: 24px 24px;
            background-position: 0 0, 12px 12px;
            color: var(--text-main);
            padding-bottom: 50px;
        }

        /* Header */
        .teacher-header {
            background: #fff;
            color: var(--primary);
            padding: 8px 20px;
            font-size: 0.95rem;
            font-weight: 800;
            border-bottom: 4px solid #fab1a0;
            position: fixed;
            top: 0;
            width: 100%;
            z-index: 1000;
            display: flex;
            justify-content: space-between;
            align-items: center;
            box-shadow: 0 4px 15px rgba(0,0,0,0.1);
        }

        .container { max-width: 800px; margin: 70px auto 0; padding: 20px; }

        h1 {
            text-align: center;
            color: #d63031;
            font-family: 'Quicksand', sans-serif;
            font-size: 2.2rem;
            margin-bottom: 25px;
            text-shadow: 3px 3px 0px #fff;
            background: rgba(255,255,255,0.8);
            padding: 15px;
            border-radius: 15px;
            border: 2px dashed #d63031;
        }

        /* Quiz Cards */
        .quiz-card {
            background: white;
            border-radius: 25px;
            padding: 30px;
            margin-bottom: 30px;
            box-shadow: 0 10px 0 #b2bec3; /* B√≥ng ƒë·ªï d√†y h∆°n */
            transition: transform 0.3s;
            position: relative;
            border: 3px solid #fff;
        }

        .quiz-card:hover { transform: translateY(-5px); border-color: var(--secondary); }

        .question-number {
            background: var(--primary);
            color: white;
            padding: 8px 18px;
            border-radius: 50px;
            font-weight: 800;
            display: inline-block;
            margin-bottom: 15px;
            font-size: 1rem;
            box-shadow: 0 4px 0 rgba(0,0,0,0.2);
        }

        .question-text {
            font-size: 1.4rem;
            font-weight: 700;
            margin-bottom: 25px;
            color: #2d3436;
            line-height: 1.4;
        }

        .options-grid {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 20px;
        }

        @media (max-width: 600px) { .options-grid { grid-template-columns: 1fr; } }

        .option-btn {
            background: #fff;
            border: 2px solid #b2bec3;
            border-bottom: 6px solid #b2bec3;
            padding: 18px;
            border-radius: 18px;
            font-family: 'Nunito', sans-serif;
            font-size: 1.15rem;
            font-weight: 700;
            cursor: pointer;
            text-align: left;
            transition: all 0.1s;
            color: #636e72;
        }

        .option-btn:active { transform: translateY(4px); border-bottom: 2px solid #b2bec3; }
        .option-btn:hover:not(.disabled) { background-color: #f1f2f6; color: var(--primary); }

        .option-btn.correct {
            background-color: var(--correct);
            color: white;
            border-color: #00947e;
            border-bottom-color: #007560;
        }

        .option-btn.wrong {
            background-color: var(--wrong);
            color: white;
            border-color: #d63031;
            border-bottom-color: #c0392b;
            animation: shake 0.5s;
        }

        /* Gi·∫£i th√≠ch */
        .explanation {
            display: none;
            margin-top: 25px;
            padding: 25px;
            background: #e3fcf7;
            border-left: 5px solid var(--secondary);
            border-radius: 10px;
            font-size: 1.05rem;
            line-height: 1.7;
            color: #2d3436;
        }
        
        .explanation.visible { display: block; animation: slideDown 0.4s ease-out; }
        .explanation b { color: var(--primary); }
        .explanation u { text-decoration: none; border-bottom: 2px solid #fab1a0; }

        /* Submit Button */
        .submit-section { text-align: center; margin: 50px 0; }
        .submit-btn {
            background: #fd79a8;
            color: white;
            border: none;
            border-bottom: 8px solid #e84393;
            padding: 20px 60px;
            font-size: 1.6rem;
            border-radius: 60px;
            cursor: pointer;
            font-weight: 900;
            font-family: 'Quicksand', sans-serif;
            transition: all 0.2s;
            text-transform: uppercase;
            box-shadow: 0 10px 20px rgba(253, 121, 168, 0.3);
        }
        .submit-btn:active { transform: translateY(6px); border-bottom-width: 2px; }

        /* Animations */
        @keyframes shake {
            0%, 100% { transform: translateX(0); }
            25% { transform: translateX(-8px); }
            75% { transform: translateX(8px); }
        }
        @keyframes slideDown { from { opacity: 0; transform: translateY(-15px); } to { opacity: 1; transform: translateY(0); } }
        @keyframes popIn { 0% { opacity: 0; transform: scale(0.8); } 100% { opacity: 1; transform: scale(1); } }

        /* Modal */
        .modal-overlay {
            position: fixed; top: 0; left: 0; width: 100%; height: 100%;
            background: rgba(45, 52, 54, 0.9);
            display: none; justify-content: center; align-items: center; z-index: 2000;
        }
        .modal-content {
            background: white; padding: 40px; border-radius: 30px; text-align: center;
            max-width: 500px; width: 90%; animation: popIn 0.4s; border: 5px solid var(--primary);
        }
        .score-display { font-size: 4.5rem; font-weight: 900; color: var(--primary); margin: 20px 0; }
        
        /* Canvas */
        #confetti-canvas { position: fixed; top: 0; left: 0; width: 100%; height: 100%; pointer-events: none; z-index: 9999; }

    </style>
</head>
<body>

    <div class="teacher-header">
        <span><i class="fas fa-star"></i> Ms Mai An ULIS - English Class</span>
        <span>LEVEL 2: CONTEXT MASTER</span>
    </div>

    <canvas id="confetti-canvas"></canvas>

    <div class="container">
        <h1>PREPOSITIONS (PART 2)<br><span style="font-size: 0.6em; color: #636e72;">Tech, Events & Advanced Locations</span></h1>

        <div id="quiz-container">
            </div>

        <div class="submit-section">
            <button class="submit-btn" onclick="submitQuiz()">N·ªôp B√†i</button>
        </div>
    </div>

    <div class="modal-overlay" id="result-modal">
        <div class="modal-content">
            <h2 style="color: var(--text-main)">K·∫øt Qu·∫£ B√†i L√†m</h2>
            <div class="score-display" id="final-score">0/30</div>
            <p id="feedback-msg" style="font-size: 1.2rem; color: #636e72; margin-bottom: 20px;">...</p>
            <button class="submit-btn" style="font-size: 1rem; padding: 12px 30px;" onclick="closeModal()">Xem l·∫°i ƒë√°p √°n</button>
        </div>
    </div>

    <script>
        // --- DATA B·ªò C√ÇU H·ªéI M·ªöI (30 C√¢u - ƒê·ªïi ng·ªØ c·∫£nh) ---
        const questions = [
            // GROUP 1: TECHNOLOGY & MEDIA (ON)
            {
                id: 1,
                text: "I found this interesting information _______ the Internet.",
                options: ["in", "at", "on", "to"],
                answer: 2, // on
                explain: "<b>1. Ph√¢n t√≠ch:</b><br>The Internet (n): M·∫°ng Internet (Kh√¥ng gian s·ªë/B·ªÅ m·∫∑t ·∫£o).<br><b>2. D·ªãch nghƒ©a:</b> T√¥i t√¨m th·∫•y th√¥ng tin th√∫ v·ªã n√†y tr√™n Internet.<br><b>3. T·∫°i sao ch·ªçn ON?</b> Quy t·∫Øc 'Digital Surfaces': V·ªõi Internet, Website, Facebook, Youtube, TV, Radio -> Lu√¥n d√πng 'ON'.<br><b>4. T·∫°i sao sai?</b> Ta kh√¥ng th·ªÉ chui v√†o 'trong' (in) d√¢y m·∫°ng, c≈©ng kh√¥ng ƒë·ª©ng 't·∫°i' (at) ƒëi·ªÉm Internet."
            },
            {
                id: 2,
                text: "Don't spend too much time _______ the computer screen.",
                options: ["at", "on", "in", "by"],
                answer: 1, // on
                explain: "<b>1. Ph√¢n t√≠ch:</b><br>Screen (n): M√†n h√¨nh (B·ªÅ m·∫∑t ph·∫≥ng hi·ªÉn th·ªã).<br><b>2. D·ªãch nghƒ©a:</b> ƒê·ª´ng d√†nh qu√° nhi·ªÅu th·ªùi gian tr√™n m√†n h√¨nh m√°y t√≠nh.<br><b>3. T·∫°i sao ch·ªçn ON?</b> H√¨nh ·∫£nh hi·ªÉn th·ªã 'tr√™n' b·ªÅ m·∫∑t m√†n h√¨nh -> D√πng 'on the screen'.<br><b>4. T·∫°i sao sai?</b> N·∫øu n√≥i 'at the computer' (ng·ªìi t·∫°i v·ªã tr√≠ ƒë·∫∑t m√°y t√≠nh) th√¨ ƒë√∫ng, nh∆∞ng ƒë√¢y l√† 'screen' (m√†n h√¨nh) n√™n ph·∫£i l√† 'on'."
            },
            {
                id: 3,
                text: "I heard the news _______ the radio this morning.",
                options: ["in", "on", "at", "from"],
                answer: 1, // on
                explain: "<b>1. Ph√¢n t√≠ch:</b><br>Radio (n): ƒê√†i ph√°t thanh (Thi·∫øt b·ªã truy·ªÅn th√¥ng).<br><b>2. D·ªãch nghƒ©a:</b> T√¥i ƒë√£ nghe tin t·ª©c tr√™n ƒë√†i s√°ng nay.<br><b>3. T·∫°i sao ch·ªçn ON?</b> Quy t·∫Øc truy·ªÅn th√¥ng: On TV, On the radio, On the phone.<br><b>4. T·∫°i sao sai?</b> 'In the radio' nghƒ©a l√† linh ki·ªán n·∫±m b√™n trong c√°i v·ªè m√°y ƒë√†i."
            },
            {
                id: 4,
                text: "Please visit our website _______ the link below.",
                options: ["in", "to", "at", "on"],
                answer: 2, // at
                explain: "<b>1. Ph√¢n t√≠ch:</b><br>Link/Website address: M·ªôt ƒë·ªãa ch·ªâ ·∫£o c·ª• th·ªÉ.<br><b>2. D·ªãch nghƒ©a:</b> Vui l√≤ng gh√© thƒÉm website c·ªßa ch√∫ng t√¥i t·∫°i ƒë∆∞·ªùng d·∫´n b√™n d∆∞·ªõi.<br><b>3. T·∫°i sao ch·ªçn AT?</b> Khi ch·ªâ m·ªôt ƒë·ªãa ch·ªâ (URL) c·ª• th·ªÉ, ta d√πng 'at'. (L∆∞u √Ω: On the website, nh∆∞ng At the link/address).<br><b>4. T·∫°i sao sai?</b> 'On' d√πng cho b·ªÅ m·∫∑t trang web, nh∆∞ng v·ªõi 'link' (ƒëi·ªÉm k·∫øt n·ªëi) th√¨ 'at' ch√≠nh x√°c h∆°n trong ng·ªØ c·∫£nh ch·ªâ d·∫´n."
            },

            // GROUP 2: EVENTS & ACTIVITIES (AT)
            {
                id: 5,
                text: "We met _______ a wedding last year.",
                options: ["in", "on", "at", "to"],
                answer: 2, // at
                explain: "<b>1. Ph√¢n t√≠ch:</b><br>Wedding (n): ƒê√°m c∆∞·ªõi (S·ª± ki·ªán x√£ h·ªôi).<br><b>2. D·ªãch nghƒ©a:</b> Ch√∫ng t√¥i ƒë√£ g·∫∑p nhau t·∫°i m·ªôt ƒë√°m c∆∞·ªõi nƒÉm ngo√°i.<br><b>3. T·∫°i sao ch·ªçn AT?</b> Quy t·∫Øc s·ª± ki·ªán: D√πng 'at' cho c√°c ho·∫°t ƒë·ªông t·ª• t·∫≠p ƒë√¥ng ng∆∞·ªùi (at a party, at a concert, at a conference, at a wedding).<br><b>4. T·∫°i sao sai?</b> Kh√¥ng d√πng 'in' v√¨ kh√¥ng nh·∫•n m·∫°nh kh√¥ng gian k√≠n."
            },
            {
                id: 6,
                text: "My mom is _______ the supermarket buying food.",
                options: ["on", "in", "at", "from"],
                answer: 2, // at
                explain: "<b>1. Ph√¢n t√≠ch:</b><br>Supermarket (n): Si√™u th·ªã (ƒê·ªãa ƒëi·ªÉm c√¥ng c·ªông/Ch·ª©c nƒÉng ƒëi mua s·∫Øm).<br><b>2. D·ªãch nghƒ©a:</b> M·∫π t√¥i ƒëang ·ªü si√™u th·ªã mua ƒë·ªì ƒÉn.<br><b>3. T·∫°i sao ch·ªçn AT?</b> Khi n√≥i v·ªÅ ƒë·ªãa ƒëi·ªÉm v·ªõi m·ª•c ƒë√≠ch th·ª±c hi·ªán ch·ª©c nƒÉng c·ªßa n√≥ (mua s·∫Øm), ta d√πng 'at'.<br><b>4. T·∫°i sao sai?</b> D√πng 'in' khi mu·ªën nh·∫•n m·∫°nh ng∆∞·ªùi ƒë√≥ ƒëang ·ªü b√™n trong t√≤a nh√† (V√≠ d·ª•: Tr·ªùi m∆∞a, t√¥i ƒëang tr·ªën *trong* si√™u th·ªã)."
            },
            {
                id: 7,
                text: "Turn left _______ the traffic lights.",
                options: ["in", "on", "at", "by"],
                answer: 2, // at
                explain: "<b>1. Ph√¢n t√≠ch:</b><br>Traffic lights (n): ƒê√®n giao th√¥ng (M·ªôt ƒëi·ªÉm m·ªëc tr√™n ƒë∆∞·ªùng).<br><b>2. D·ªãch nghƒ©a:</b> R·∫Ω tr√°i t·∫°i ch·ªó ƒë√®n giao th√¥ng.<br><b>3. T·∫°i sao ch·ªçn AT?</b> D√πng 'at' ƒë·ªÉ ch·ªâ m·ªôt v·ªã tr√≠/c·ªôt m·ªëc c·ª• th·ªÉ tr√™n h√†nh tr√¨nh (at the bridge, at the roundabout, at the traffic lights).<br><b>4. T·∫°i sao sai?</b> ƒê√®n giao th√¥ng l√† c√°i c·ªôt, kh√¥ng ƒë·ª©ng 'tr√™n' (on) hay 'trong' (in) n√≥ ƒë∆∞·ª£c."
            },

            // GROUP 3: HOUSEHOLD & DAILY OBJECTS
            {
                id: 8,
                text: "There is some milk _______ the fridge.",
                options: ["at", "on", "in", "into"],
                answer: 2, // in
                explain: "<b>1. Ph√¢n t√≠ch:</b><br>Fridge (n): T·ªß l·∫°nh (V·∫≠t ch·ª©a/H·ªôp k√≠n).<br><b>2. D·ªãch nghƒ©a:</b> C√≥ √≠t s·ªØa ·ªü trong t·ªß l·∫°nh.<br><b>3. T·∫°i sao ch·ªçn IN?</b> T·ªß l·∫°nh l√† kh√¥ng gian k√≠n ch·ª©a ƒë·ªì -> D√πng 'in'.<br><b>4. T·∫°i sao sai?</b> 'On the fridge' l√† ƒë·ªÉ ƒë·ªì tr√™n n√≥c t·ªß l·∫°nh."
            },
            {
                id: 9,
                text: "Look at your face _______ the mirror!",
                options: ["on", "at", "in", "to"],
                answer: 2, // in
                explain: "<b>1. Ph√¢n t√≠ch:</b><br>Mirror (n): C√°i g∆∞∆°ng.<br><b>2. D·ªãch nghƒ©a:</b> H√£y nh√¨n m·∫∑t b·∫°n trong g∆∞∆°ng ƒëi!<br><b>3. T·∫°i sao ch·ªçn IN?</b> ƒê√¢y l√† tr∆∞·ªùng h·ª£p th√∫ v·ªã. ·∫¢nh ph·∫£n chi·∫øu n·∫±m 'b√™n trong' th·∫ø gi·ªõi c·ªßa c√°i g∆∞∆°ng -> D√πng 'in the mirror'.<br><b>4. T·∫°i sao sai?</b> 'On the mirror' nghƒ©a l√† c√≥ v·∫øt b·∫©n/con ru·ªìi ƒë·∫≠u tr√™n b·ªÅ m·∫∑t k√≠nh."
            },
            {
                id: 10,
                text: "I keep my keys _______ my pocket.",
                options: ["on", "at", "in", "of"],
                answer: 2, // in
                explain: "<b>1. Ph√¢n t√≠ch:</b><br>Pocket (n): T√∫i qu·∫ßn/√°o (V·∫≠t ch·ª©a).<br><b>2. D·ªãch nghƒ©a:</b> T√¥i gi·ªØ ch√¨a kh√≥a trong t√∫i qu·∫ßn.<br><b>3. T·∫°i sao ch·ªçn IN?</b> T√∫i l√† kh√¥ng gian r·ªóng ƒë·ªÉ ch·ª©a ƒë·ªì -> D√πng 'in'.<br><b>4. T·∫°i sao sai?</b> Kh√¥ng d√πng 'at' hay 'on' v·ªõi t√∫i."
            },
            {
                id: 11,
                text: "Dinner is served _______ the table.",
                options: ["in", "at", "on", "above"],
                answer: 2, // on
                explain: "<b>1. Ph√¢n t√≠ch:</b><br>Table (n): C√°i b√†n (B·ªÅ m·∫∑t ph·∫≥ng).<br><b>2. D·ªãch nghƒ©a:</b> B·ªØa t·ªëi ƒë√£ ƒë∆∞·ª£c b√†y tr√™n b√†n.<br><b>3. T·∫°i sao ch·ªçn ON?</b> ƒê·ªì ƒÉn ƒë·∫∑t tr√™n m·∫∑t b√†n -> D√πng 'on'.<br><b>4. T·∫°i sao sai?</b> L∆∞u √Ω: 'Sit at the table' (Ng·ªìi t·∫°i b√†n ƒë·ªÉ ƒÉn) kh√°c v·ªõi 'Food on the table' (ƒê·ªì ƒÉn tr√™n b√†n)."
            },

            // GROUP 4: TEXT & PRINTED MATTER
            {
                id: 12,
                text: "Can you see the boat _______ the picture?",
                options: ["on", "at", "in", "to"],
                answer: 2, // in
                explain: "<b>1. Ph√¢n t√≠ch:</b><br>Picture/Photo (n): B·ª©c tranh/·∫£nh (Kh√¥ng gian h√¨nh ·∫£nh).<br><b>2. D·ªãch nghƒ©a:</b> B·∫°n c√≥ th·∫•y chi·∫øc thuy·ªÅn trong b·ª©c tranh kh√¥ng?<br><b>3. T·∫°i sao ch·ªçn IN?</b> C√°c v·∫≠t th·ªÉ n·∫±m trong khung c·∫£nh c·ªßa b·ª©c tranh -> D√πng 'in the picture'.<br><b>4. T·∫°i sao sai?</b> 'On the picture' nghƒ©a l√† v·∫øt m·ª±c ho·∫∑c b·ª•i b√°m tr√™n b·ªÅ m·∫∑t t·ªù gi·∫•y ·∫£nh."
            },
            {
                id: 13,
                text: "The answer is _______ the bottom of the page.",
                options: ["in", "on", "at", "under"],
                answer: 2, // at
                explain: "<b>1. Ph√¢n t√≠ch:</b><br>Bottom (n): Ph·∫ßn d∆∞·ªõi c√πng.<br><b>2. D·ªãch nghƒ©a:</b> ƒê√°p √°n n·∫±m ·ªü cu·ªëi trang.<br><b>3. T·∫°i sao ch·ªçn AT?</b> C·ª•m c·ªë ƒë·ªãnh: At the top (·ªü tr√™n c√πng), At the bottom (·ªü d∆∞·ªõi c√πng).<br><b>4. T·∫°i sao sai?</b> D√πng 'on' cho s·ªë trang (On page 5), nh∆∞ng d√πng 'at' cho v·ªã tr√≠ top/bottom c·ªßa trang ƒë√≥."
            },
            {
                id: 14,
                text: "There are many mountains _______ the world.",
                options: ["on", "at", "in", "from"],
                answer: 2, // in
                explain: "<b>1. Ph√¢n t√≠ch:</b><br>The world (n): Th·∫ø gi·ªõi (Kh√¥ng gian r·ªông l·ªõn nh·∫•t).<br><b>2. D·ªãch nghƒ©a:</b> C√≥ r·∫•t nhi·ªÅu ng·ªçn n√∫i tr√™n th·∫ø gi·ªõi.<br><b>3. T·∫°i sao ch·ªçn IN?</b> Ti·∫øng Vi·ªát n√≥i 'tr√™n th·∫ø gi·ªõi' nh∆∞ng Ti·∫øng Anh t∆∞ duy th·∫ø gi·ªõi l√† kh√¥ng gian bao tr√πm -> D√πng 'in the world'.<br><b>4. T·∫°i sao sai?</b> 'On the earth' (tr√™n tr√°i ƒë·∫•t - b·ªÅ m·∫∑t h√†nh tinh) th√¨ d√πng On, nh∆∞ng 'World' (x√£ h·ªôi/kh√¥ng gian s·ªëng) d√πng In."
            },

            // GROUP 5: GEOGRAPHY & TRAVEL
            {
                id: 15,
                text: "Tokyo is _______ Japan.",
                options: ["at", "on", "in", "to"],
                answer: 2, // in
                explain: "<b>1. Ph√¢n t√≠ch:</b><br>Japan (n): Nh·∫≠t B·∫£n (Qu·ªëc gia).<br><b>2. D·ªãch nghƒ©a:</b> Tokyo ·ªü Nh·∫≠t B·∫£n.<br><b>3. T·∫°i sao ch·ªçn IN?</b> Quy t·∫Øc c∆° b·∫£n: In + Country/City.<br><b>4. T·∫°i sao sai?</b> Kh√¥ng d√πng At/On cho qu·ªëc gia."
            },
            {
                id: 16,
                text: "I am standing _______ the queue waiting for tickets.",
                options: ["on", "at", "in", "to"],
                answer: 2, // in
                explain: "<b>1. Ph√¢n t√≠ch:</b><br>Queue (Anh-Anh) / Line (Anh-M·ªπ): H√†ng ng∆∞·ªùi.<br><b>2. D·ªãch nghƒ©a:</b> T√¥i ƒëang ƒë·ª©ng trong h√†ng ƒë·ª£i mua v√©.<br><b>3. T·∫°i sao ch·ªçn IN?</b> B·∫°n l√† m·ªôt ph·∫ßn c·ªßa h√†ng ng∆∞·ªùi ƒë√≥, b·∫°n ƒë·ª©ng 'trong' ƒë·ªôi h√¨nh -> D√πng 'in a queue' / 'in a line'.<br><b>4. T·∫°i sao sai?</b> 'At the line' (·ªü v·∫°ch k·∫ª ƒë∆∞·ªùng)."
            },
            {
                id: 17,
                text: "Let's meet _______ the entrance of the cinema.",
                options: ["on", "in", "at", "into"],
                answer: 2, // at
                explain: "<b>1. Ph√¢n t√≠ch:</b><br>Entrance (n): L·ªëi v√†o (ƒêi·ªÉm m·ªëc).<br><b>2. D·ªãch nghƒ©a:</b> G·∫∑p nhau ·ªü l·ªëi v√†o r·∫°p phim nh√©.<br><b>3. T·∫°i sao ch·ªçn AT?</b> L·ªëi v√†o, c·ªïng (gate), c·ª≠a (door) l√† c√°c ƒëi·ªÉm ti·∫øp c·∫≠n c·ª• th·ªÉ -> D√πng 'at'.<br><b>4. T·∫°i sao sai?</b> 'In the entrance' (ƒë·ª©ng ch·∫Øn ngay gi·ªØa l·ªëi ƒëi v√†o) - √≠t d√πng trong ng·ªØ c·∫£nh h·∫πn g·∫∑p."
            },
            {
                id: 18,
                text: "The man is sitting _______ the grass.",
                options: ["in", "at", "on", "under"],
                answer: 2, // on
                explain: "<b>1. Ph√¢n t√≠ch:</b><br>Grass (n): B√£i c·ªè (B·ªÅ m·∫∑t).<br><b>2. D·ªãch nghƒ©a:</b> Ng∆∞·ªùi ƒë√†n √¥ng ƒëang ng·ªìi tr√™n b√£i c·ªè.<br><b>3. T·∫°i sao ch·ªçn ON?</b> C·ªè t·∫°o th√†nh m·ªôt b·ªÅ m·∫∑t ƒë·ªÉ ng·ªìi l√™n -> D√πng 'on the grass'.<br><b>4. T·∫°i sao sai?</b> 'In the grass' th∆∞·ªùng d√πng cho c√¥n tr√πng ho·∫∑c ƒë·ªông v·∫≠t nh·ªè ·∫©n n·∫•p b√™n trong b·ª•i c·ªè cao."
            },

            // GROUP 6: TRICKY ONES (DIRECTION & POSITION)
            {
                id: 19,
                text: "My office is _______ the left side of the building.",
                options: ["in", "at", "on", "to"],
                answer: 2, // on
                explain: "<b>1. Ph√¢n t√≠ch:</b><br>The left/right (n): B√™n tr√°i/ph·∫£i.<br><b>2. D·ªãch nghƒ©a:</b> VƒÉn ph√≤ng t√¥i ·ªü ph√≠a b√™n tr√°i t√≤a nh√†.<br><b>3. T·∫°i sao ch·ªçn ON?</b> Quy t·∫Øc ph∆∞∆°ng h∆∞·ªõng: On the left, On the right.<br><b>4. T·∫°i sao sai?</b> Kh√¥ng d√πng 'in/at' cho ph√≠a tr√°i ph·∫£i."
            },
            {
                id: 20,
                text: "Write your name _______ the top of your paper.",
                options: ["in", "at", "on", "above"],
                answer: 1, // at
                explain: "<b>1. Ph√¢n t√≠ch:</b><br>Top (n): ƒê·ªânh/Ph·∫ßn tr√™n c√πng.<br><b>2. D·ªãch nghƒ©a:</b> Vi·∫øt t√™n em v√†o ph·∫ßn tr√™n c√πng c·ªßa t·ªù gi·∫•y.<br><b>3. T·∫°i sao ch·ªçn AT?</b> C·ª•m c·ªë ƒë·ªãnh: 'At the top'.<br><b>4. T·∫°i sao sai?</b> 'On the top' th∆∞·ªùng d√πng cho v·∫≠t th·ªÉ ƒë·∫∑t tr√™n ƒë·ªânh v·∫≠t kh√°c (On top of the box), nh∆∞ng v·ªõi trang gi·∫•y/b·∫£ng, ta d√πng 'At the top of the page'."
            },
            {
                id: 21,
                text: "She lives _______ the second floor.",
                options: ["at", "in", "on", "to"],
                answer: 2, // on
                explain: "<b>1. Ph√¢n t√≠ch:</b><br>Floor (n): T·∫ßng (c·ªßa t√≤a nh√†).<br><b>2. D·ªãch nghƒ©a:</b> C√¥ ·∫•y s·ªëng ·ªü t·∫ßng 2.<br><b>3. T·∫°i sao ch·ªçn ON?</b> S·ªë t·∫ßng lu√¥n d√πng 'On' (On the first floor, on the ground floor).<br><b>4. T·∫°i sao sai?</b> 'In the floor' l√† n·∫±m trong l·ªõp b√™ t√¥ng s√†n nh√†."
            },
            {
                id: 22,
                text: "The bank is _______ the end of the street.",
                options: ["in", "on", "at", "by"],
                answer: 2, // at
                explain: "<b>1. Ph√¢n t√≠ch:</b><br>The end (n): ƒêi·ªÉm cu·ªëi.<br><b>2. D·ªãch nghƒ©a:</b> Ng√¢n h√†ng n·∫±m ·ªü cu·ªëi ƒë∆∞·ªùng.<br><b>3. T·∫°i sao ch·ªçn AT?</b> C·ª•m c·ªë ƒë·ªãnh: At the end of... (T·∫°i ƒëi·ªÉm k·∫øt th√∫c).<br><b>4. T·∫°i sao sai?</b> 'In the end' nghƒ©a l√† 'Cu·ªëi c√πng th√¨/K·∫øt c·ª•c l√†' (ch·ªâ th·ªùi gian/k·∫øt qu·∫£), kh√¥ng ch·ªâ ƒë·ªãa ƒëi·ªÉm."
            },
            {
                id: 23,
                text: "There is a spider _______ the corner of the room.",
                options: ["at", "in", "on", "to"],
                answer: 1, // in
                explain: "<b>1. Ph√¢n t√≠ch:</b><br>Corner (n): G√≥c. Room: Ph√≤ng (H·ªôp k√≠n).<br><b>2. D·ªãch nghƒ©a:</b> C√≥ con nh·ªán ·ªü trong g√≥c ph√≤ng.<br><b>3. T·∫°i sao ch·ªçn IN?</b> G√≥c *trong* nh√† (g√≥c l√µm) d√πng 'In the corner'.<br><b>4. T·∫°i sao sai?</b> G√≥c *ngo√†i* ƒë∆∞·ªùng (g√≥c l·ªìi ng√£ r·∫Ω) d√πng 'At the corner of the street'. ƒê√¢y l√† g√≥c ph√≤ng n√™n d√πng IN."
            },
            {
                id: 24,
                text: "I'll meet you _______ the corner of the street.",
                options: ["in", "on", "at", "into"],
                answer: 2, // at
                explain: "<b>1. Ph√¢n t√≠ch:</b><br>Corner of the street: G√≥c ph·ªë (ƒêi·ªÉm giao nhau).<br><b>2. D·ªãch nghƒ©a:</b> T·ªõ s·∫Ω g·∫∑p c·∫≠u ·ªü g√≥c ph·ªë nh√©.<br><b>3. T·∫°i sao ch·ªçn AT?</b> Nh∆∞ ƒë√£ gi·∫£i th√≠ch ·ªü c√¢u 23, g√≥c ƒë∆∞·ªùng (v·ªã tr√≠ ƒë·ª©ng ch·ªù) d√πng 'At the corner'.<br><b>4. T·∫°i sao sai?</b> D√πng 'In' l√† sai ng·ªØ c·∫£nh (tr·ª´ khi ƒë·ª©ng l·ªçt th·ªèm trong h·ªëc t∆∞·ªùng)."
            },

            // GROUP 7: MIXED & ADVANCED
            {
                id: 25,
                text: "He has a scar _______ his cheek.",
                options: ["in", "at", "on", "inside"],
                answer: 2, // on
                explain: "<b>1. Ph√¢n t√≠ch:</b><br>Cheek (n): M√° (B·ªô ph·∫≠n c∆° th·ªÉ/B·ªÅ m·∫∑t da).<br><b>2. D·ªãch nghƒ©a:</b> Anh ·∫•y c√≥ m·ªôt v·∫øt s·∫πo tr√™n m√°.<br><b>3. T·∫°i sao ch·ªçn ON?</b> V·∫øt s·∫πo, n·ªët ru·ªìi, v·∫øt b·∫©n n·∫±m 'tr√™n' b·ªÅ m·∫∑t da -> D√πng 'on'.<br><b>4. T·∫°i sao sai?</b> 'In' d√πng cho b·ªô ph·∫≠n b√™n trong (In his stomach)."
            },
            {
                id: 26,
                text: "They are dancing _______ the street.",
                options: ["in", "at", "on", "above"],
                answer: 0, // in (L∆∞u √Ω: On the street c≈©ng d√πng ƒë∆∞·ª£c, nh∆∞ng In the street ph·ªï bi·∫øn trong Anh-Anh ho·∫∑c nghƒ©a 'gi·ªØa l√≤ng ƒë∆∞·ªùng')
                explain: "<b>1. Ph√¢n t√≠ch:</b><br>The street (n): ƒê∆∞·ªùng ph·ªë.<br><b>2. D·ªãch nghƒ©a:</b> H·ªç ƒëang nh·∫£y m√∫a d∆∞·ªõi l√≤ng ƒë∆∞·ªùng.<br><b>3. T·∫°i sao ch·ªçn IN?</b> C·ª•m 'In the street' th∆∞·ªùng d√πng ƒë·ªÉ ch·ªâ vi·ªác ƒë·ª©ng ·ªü l√≤ng ƒë∆∞·ªùng, kh√¥ng gian ƒë∆∞·ªùng ph·ªë. (Anh M·ªπ hay d√πng On the street). Tuy nhi√™n, trong b√†i tr·∫Øc nghi·ªám n√†y, n·∫øu n√≥i v·ªÅ kh√¥ng gian bao quanh, 'In' l√† l·ª±a ch·ªçn an to√†n cho nghƒ©a 'gi·ªØa ƒë∆∞·ªùng'.<br><b>4. L∆∞u √Ω:</b> C·∫£ In v√† On ƒë·ªÅu ch·∫•p nh·∫≠n ƒë∆∞·ª£c t√πy v√πng mi·ªÅn, nh∆∞ng h√£y nh·ªõ 'Children playing IN the street' (ch∆°i d∆∞·ªõi l√≤ng ƒë∆∞·ªùng - nguy hi·ªÉm)."
            },
            {
                id: 27,
                text: "We arrived _______ London at 6 p.m.",
                options: ["at", "on", "in", "to"],
                answer: 2, // in
                explain: "<b>1. Ph√¢n t√≠ch:</b><br>London (n): Th·ªß ƒë√¥ n∆∞·ªõc Anh (Th√†nh ph·ªë l·ªõn).<br><b>2. D·ªãch nghƒ©a:</b> Ch√∫ng t√¥i ƒë·∫øn London l√∫c 6 gi·ªù t·ªëi.<br><b>3. T·∫°i sao ch·ªçn IN?</b> Nh·∫Øc l·∫°i: Arrive IN + Th√†nh ph·ªë/Qu·ªëc gia.<br><b>4. T·∫°i sao sai?</b> Arrive AT + S√¢n bay/Nh√† ga."
            },
            {
                id: 28,
                text: "The instructions are _______ the back of the box.",
                options: ["in", "at", "on", "to"],
                answer: 2, // on
                explain: "<b>1. Ph√¢n t√≠ch:</b><br>Back (n): M·∫∑t sau.<br><b>2. D·ªãch nghƒ©a:</b> H∆∞·ªõng d·∫´n s·ª≠ d·ª•ng n·∫±m ·ªü m·∫∑t sau c√°i h·ªôp.<br><b>3. T·∫°i sao ch·ªçn ON?</b> V√¨ n√≥ l√† b·ªÅ m·∫∑t ph√≠a sau, ch·ªØ ƒë∆∞·ª£c in 'tr√™n' ƒë√≥ -> D√πng 'On the back'.<br><b>4. T·∫°i sao sai?</b> 'At the back' th∆∞·ªùng d√πng cho v·ªã tr√≠ trong kh√¥ng gian (ng·ªìi ·ªü ph√≠a cu·ªëi l·ªõp - Sit at the back of the class)."
            },
            {
                id: 29,
                text: "She is currently studying _______ university.",
                options: ["on", "in", "at", "to"],
                answer: 2, // at
                explain: "<b>1. Ph√¢n t√≠ch:</b><br>University (n): Tr∆∞·ªùng ƒë·∫°i h·ªçc (T·ªï ch·ª©c/N∆°i ch·ªën).<br><b>2. D·ªãch nghƒ©a:</b> C√¥ ·∫•y hi·ªán ƒëang h·ªçc ƒë·∫°i h·ªçc.<br><b>3. T·∫°i sao ch·ªçn AT?</b> D√πng 'at university' (ho·∫∑c at college) ƒë·ªÉ ch·ªâ giai ƒëo·∫°n ƒëang theo h·ªçc t·∫°i ƒë√≥.<br><b>4. T·∫°i sao sai?</b> 'In university' c≈©ng ƒë∆∞·ª£c d√πng (Anh-M·ªπ) nh∆∞ng 'At' ph·ªï bi·∫øn h∆°n trong nghƒ©a ƒëang l√† sinh vi√™n."
            },
            {
                id: 30,
                text: "The sun is shining _______ the sky.",
                options: ["on", "at", "in", "above"],
                answer: 2, // in
                explain: "<b>1. Ph√¢n t√≠ch:</b><br>Sky (n): B·∫ßu tr·ªùi.<br><b>2. D·ªãch nghƒ©a:</b> M·∫∑t tr·ªùi ƒëang t·ªèa n·∫Øng tr√™n b·∫ßu tr·ªùi.<br><b>3. T·∫°i sao ch·ªçn IN?</b> B·∫ßu tr·ªùi l√† kh√¥ng gian 3 chi·ªÅu bao la -> D√πng 'In the sky'.<br><b>4. T·∫°i sao sai?</b> Tuy·ªát ƒë·ªëi kh√¥ng d√πng 'On the sky'."
            }
        ];

        // --- SOUNDS & LOGIC (GI·ªÆ NGUY√äN T·ª™ PART 1) ---
        const audioCtx = new (window.AudioContext || window.webkitAudioContext)();
        function playSound(type) {
            if (audioCtx.state === 'suspended') audioCtx.resume();
            const osc = audioCtx.createOscillator();
            const gainNode = audioCtx.createGain();
            osc.connect(gainNode);
            gainNode.connect(audioCtx.destination);
            if (type === 'correct') {
                osc.type = 'triangle'; 
                osc.frequency.setValueAtTime(600, audioCtx.currentTime);
                osc.frequency.linearRampToValueAtTime(1000, audioCtx.currentTime + 0.1);
                gainNode.gain.setValueAtTime(0.3, audioCtx.currentTime);
                gainNode.gain.linearRampToValueAtTime(0.01, audioCtx.currentTime + 0.5);
                osc.start(); osc.stop(audioCtx.currentTime + 0.5);
            } else {
                osc.type = 'sawtooth';
                osc.frequency.setValueAtTime(100, audioCtx.currentTime);
                osc.frequency.linearRampToValueAtTime(80, audioCtx.currentTime + 0.3);
                gainNode.gain.setValueAtTime(0.3, audioCtx.currentTime);
                gainNode.gain.linearRampToValueAtTime(0.01, audioCtx.currentTime + 0.3);
                osc.start(); osc.stop(audioCtx.currentTime + 0.3);
            }
        }

        // Shuffle
        function shuffle(array) {
            let currentIndex = array.length, randomIndex;
            while (currentIndex != 0) {
                randomIndex = Math.floor(Math.random() * currentIndex);
                currentIndex--;
                [array[currentIndex], array[randomIndex]] = [array[randomIndex], array[currentIndex]];
            }
            return array;
        }

        let currentScore = 0;

        function renderQuiz() {
            const container = document.getElementById('quiz-container');
            const shuffled = shuffle([...questions]);
            
            shuffled.forEach((q, index) => {
                const card = document.createElement('div');
                card.className = 'quiz-card';
                card.innerHTML = `
                    <span class="question-number">Question ${index + 1}</span>
                    <div class="question-text">${q.text}</div>
                    <div class="options-grid">
                        ${q.options.map((opt, i) => `
                            <button class="option-btn" onclick="checkAnswer(this, ${q.id}, ${i})">${String.fromCharCode(65+i)}. ${opt}</button>
                        `).join('')}
                    </div>
                    <div id="exp-${q.id}" class="explanation">
                        ${q.explain}
                    </div>
                `;
                container.appendChild(card);
            });
        }

        function checkAnswer(btn, qId, selectedIndex) {
            const card = btn.closest('.quiz-card');
            if (card.classList.contains('answered')) return;
            card.classList.add('answered');

            const q = questions.find(i => i.id === qId);
            const explanation = document.getElementById(`exp-${qId}`);
            const allBtns = card.querySelectorAll('.option-btn');

            if (selectedIndex === q.answer) {
                btn.classList.add('correct');
                playSound('correct');
                fireConfetti();
                currentScore++;
            } else {
                btn.classList.add('wrong');
                allBtns[q.answer].classList.add('correct');
                playSound('wrong');
            }
            
            allBtns.forEach(b => b.classList.add('disabled'));
            explanation.classList.add('visible');
        }

        function submitQuiz() {
            document.getElementById('final-score').innerText = `${currentScore}/30`;
            const msg = currentScore > 25 ? "Qu√° ƒë·ªânh! B·∫°n l√† tr√πm gi·ªõi t·ª´! üéâ" : 
                        currentScore > 15 ? "L√†m t·ªët l·∫Øm! C·ªë g·∫Øng th√™m ch√∫t n·ªØa nh√©! üî•" : "ƒê·ª´ng bu·ªìn, h√£y xem k·ªπ l·∫°i ph·∫ßn gi·∫£i th√≠ch nha! üçÄ";
            document.getElementById('feedback-msg').innerText = msg;
            document.getElementById('result-modal').style.display = 'flex';
            fireConfetti();
        }

        function closeModal() { document.getElementById('result-modal').style.display = 'none'; }
        
        // Confetti
        function fireConfetti() {
            const canvas = document.getElementById('confetti-canvas');
            const ctx = canvas.getContext('2d');
            canvas.width = window.innerWidth; canvas.height = window.innerHeight;
            const p = [];
            for(let i=0; i<80; i++) p.push({x: Math.random()*canvas.width, y: Math.random()*canvas.height-canvas.height, c: ['#6c5ce7','#00cec9','#fd79a8'][Math.floor(Math.random()*3)], s: Math.random()*8+4, v: Math.random()*5+2});
            function anim() {
                ctx.clearRect(0,0,canvas.width,canvas.height);
                let a = false;
                p.forEach(k => { k.y+=k.v; if(k.y<canvas.height) a=true; ctx.fillStyle=k.c; ctx.fillRect(k.x,k.y,k.s,k.s); });
                if(a) requestAnimationFrame(anim);
            }
            anim();
        }

        window.onload = renderQuiz;
    </script>
</body>
</html>