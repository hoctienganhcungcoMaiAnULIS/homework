<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Ms Mai An ULIS - Sentence Rearrangement Practice</title>
    <!-- Google Fonts -->
    <link href="https://fonts.googleapis.com/css2?family=Nunito:wght@400;600;700;800&family=Quicksand:wght@500;700&display=swap" rel="stylesheet">
    <!-- FontAwesome -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <!-- Canvas Confetti -->
    <script src="https://cdn.jsdelivr.net/npm/canvas-confetti@1.6.0/dist/confetti.browser.min.js"></script>

    <style>
        :root {
            --primary: #8854C0; /* T√≠m Pastel */
            --secondary: #00C9A7; /* Xanh ng·ªçc */
            --accent: #FF9F43; /* Cam */
            --correct: #00D26A; /* Xanh l√° */
            --wrong: #FF4757; /* ƒê·ªè */
            --bg-pattern: #F0F4F8;
            --text-main: #2F3542;
            --card-bg: #ffffff;
        }

        * {
            box-sizing: border-box;
            user-select: none; /* NgƒÉn ch·ªçn text ƒë·ªÉ t·∫≠p trung click */
        }

        body {
            font-family: 'Nunito', sans-serif;
            background-color: var(--bg-pattern);
            background-image: radial-gradient(#dfe4ea 15%, transparent 16%), radial-gradient(#dfe4ea 15%, transparent 16%);
            background-size: 60px 60px;
            background-position: 0 0, 30px 30px;
            margin: 0;
            padding: 20px;
            min-height: 100vh;
            display: flex;
            flex-direction: column;
            align-items: center;
        }

        /* --- HEADER --- */
        .header {
            text-align: center;
            margin-bottom: 20px;
            background: white;
            padding: 15px 30px;
            border-radius: 50px;
            box-shadow: 0 8px 0 rgba(0,0,0,0.1);
            border: 2px solid var(--primary);
            animation: float 3s ease-in-out infinite;
        }

        .header h1 {
            margin: 0;
            color: var(--primary);
            font-size: 1.5rem;
            font-weight: 800;
        }

        .header span {
            color: var(--secondary);
            font-size: 0.9rem;
            font-weight: 700;
        }

        /* --- QUIZ CARD --- */
        .quiz-container {
            background: var(--card-bg);
            width: 100%;
            max-width: 800px;
            border-radius: 25px;
            padding: 30px;
            box-shadow: 0 15px 30px rgba(0,0,0,0.1);
            position: relative;
            overflow: hidden;
            border-bottom: 8px solid #E1E1E1;
        }

        /* Progress Bar */
        .progress-container {
            width: 100%;
            background-color: #f1f2f6;
            border-radius: 20px;
            margin-bottom: 25px;
            height: 15px;
            overflow: hidden;
        }

        .progress-bar {
            height: 100%;
            background: linear-gradient(90deg, var(--secondary), var(--primary));
            width: 0%;
            transition: width 0.5s ease;
            border-radius: 20px;
        }

        /* Question Area */
        .question-box {
            margin-bottom: 25px;
        }

        .q-tag {
            display: inline-block;
            background: var(--accent);
            color: white;
            padding: 5px 15px;
            border-radius: 15px;
            font-weight: bold;
            font-size: 0.9rem;
            margin-bottom: 10px;
            box-shadow: 0 4px 0 rgba(0,0,0,0.1);
        }

        .question-text {
            font-size: 1.2rem;
            color: var(--text-main);
            font-weight: 700;
            line-height: 1.6;
            white-space: pre-line; /* Gi·ªØ ƒë·ªãnh d·∫°ng xu·ªëng d√≤ng c·ªßa ƒë·ªÅ b√†i */
        }

        .hint-text {
            color: #747d8c;
            font-style: italic;
            font-size: 0.95rem;
            margin-top: 10px;
            background: #f1f2f6;
            padding: 10px;
            border-radius: 10px;
            border-left: 4px solid var(--accent);
        }

        /* Options Area */
        .options-grid {
            display: grid;
            grid-template-columns: 1fr;
            gap: 15px;
        }

        .option-btn {
            background: white;
            border: 2px solid #e1e1e1;
            padding: 15px 20px;
            border-radius: 15px;
            font-family: 'Nunito', sans-serif;
            font-size: 1.1rem;
            font-weight: 600;
            color: var(--text-main);
            cursor: pointer;
            transition: all 0.2s;
            text-align: left;
            position: relative;
            box-shadow: 0 6px 0 #dfe4ea;
            display: flex;
            align-items: center;
        }

        .option-btn .opt-label {
            background: #dfe4ea;
            color: #57606f;
            width: 30px;
            height: 30px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            margin-right: 15px;
            font-weight: 800;
            flex-shrink: 0;
        }

        .option-btn:hover:not(:disabled) {
            transform: translateY(-2px);
            border-color: var(--secondary);
            box-shadow: 0 8px 0 #dfe4ea;
        }

        .option-btn:active:not(:disabled) {
            transform: translateY(4px);
            box-shadow: 0 2px 0 #dfe4ea;
        }

        /* State Classes */
        .option-btn.correct {
            background: #d1f7c4;
            border-color: var(--correct);
            box-shadow: 0 6px 0 #20bf6b !important;
            color: #009432;
        }
        .option-btn.correct .opt-label {
            background: var(--correct);
            color: white;
        }

        .option-btn.wrong {
            background: #ffcccc;
            border-color: var(--wrong);
            box-shadow: 0 6px 0 #eb3b5a !important;
            color: #c0392b;
            animation: shake 0.5s;
        }
        .option-btn.wrong .opt-label {
            background: var(--wrong);
            color: white;
        }

        /* --- EXPLANATION BOX (The Soul of the Immersive) --- */
        .explanation-box {
            margin-top: 25px;
            background: #f8f9fa;
            border: 2px solid var(--primary);
            border-radius: 15px;
            padding: 20px;
            display: none; /* Hidden by default */
            animation: slideDown 0.5s ease;
        }

        .exp-header {
            display: flex;
            align-items: center;
            margin-bottom: 15px;
            color: var(--primary);
            font-weight: 800;
            font-size: 1.1rem;
            border-bottom: 1px dashed #ccc;
            padding-bottom: 10px;
        }

        .exp-header i { margin-right: 10px; font-size: 1.3rem; }

        .exp-content {
            font-size: 1rem;
            line-height: 1.6;
            color: #2f3542;
        }

        .exp-section {
            margin-bottom: 10px;
        }
        
        .exp-section strong {
            color: var(--primary);
        }

        .vocab-item {
            display: inline-block;
            background: #fff;
            border: 1px solid #ddd;
            padding: 2px 8px;
            border-radius: 5px;
            margin: 2px;
            font-size: 0.9rem;
        }

        /* --- CONTROLS --- */
        .controls {
            margin-top: 25px;
            text-align: right;
        }

        .next-btn {
            background: var(--primary);
            color: white;
            border: none;
            padding: 12px 30px;
            border-radius: 50px;
            font-size: 1.1rem;
            font-weight: 700;
            cursor: pointer;
            box-shadow: 0 6px 0 #5f27cd;
            transition: all 0.2s;
            display: none; /* Hidden initially */
        }

        .next-btn:hover { transform: translateY(-2px); box-shadow: 0 8px 0 #5f27cd; }
        .next-btn:active { transform: translateY(4px); box-shadow: 0 2px 0 #5f27cd; }

        /* --- RESULT SCREEN --- */
        .result-screen {
            text-align: center;
            display: none;
        }
        .score-circle {
            width: 150px;
            height: 150px;
            background: var(--secondary);
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            margin: 0 auto 20px;
            font-size: 3rem;
            font-weight: 800;
            color: white;
            border: 8px solid white;
            box-shadow: 0 0 0 5px var(--secondary);
        }
        .feedback-text {
            font-size: 1.5rem;
            color: var(--primary);
            font-weight: 700;
            margin-bottom: 20px;
        }

        /* Animations */
        @keyframes float {
            0%, 100% { transform: translateY(0); }
            50% { transform: translateY(-10px); }
        }

        @keyframes shake {
            0% { transform: translateX(0); }
            25% { transform: translateX(-10px); }
            50% { transform: translateX(10px); }
            75% { transform: translateX(-10px); }
            100% { transform: translateX(0); }
        }

        @keyframes slideDown {
            from { opacity: 0; transform: translateY(-20px); }
            to { opacity: 1; transform: translateY(0); }
        }

        /* Responsive */
        @media (max-width: 600px) {
            .quiz-container { padding: 20px; }
            .header h1 { font-size: 1.2rem; }
            .option-btn { font-size: 1rem; padding: 12px; }
        }
    </style>
</head>
<body>

    <!-- Header -->
    <div class="header">
        <h1>Ms Mai An ULIS</h1>
        <span><i class="fas fa-star"></i> Sentence Rearrangement Master <i class="fas fa-star"></i></span>
    </div>

    <!-- Quiz Container -->
    <div class="quiz-container" id="quiz-box">
        <!-- Progress -->
        <div class="progress-container">
            <div class="progress-bar" id="progress"></div>
        </div>

        <!-- Question -->
        <div class="question-box">
            <div class="q-tag">Question <span id="q-number">1</span></div>
            <div class="question-text" id="q-text">Loading question...</div>
            <div class="hint-text" id="q-hint"></div>
        </div>

        <!-- Options -->
        <div class="options-grid" id="options-area">
            <!-- Options generated by JS -->
        </div>

        <!-- Explanation (The most important part) -->
        <div class="explanation-box" id="explanation">
            <div class="exp-header">
                <i class="fas fa-chalkboard-teacher"></i>
                C√¥ Mai An gi·∫£i th√≠ch chi ti·∫øt:
            </div>
            <div class="exp-content" id="exp-content">
                <!-- Content goes here -->
            </div>
        </div>

        <!-- Controls -->
        <div class="controls">
            <button class="next-btn" id="next-btn" onclick="nextQuestion()">Ti·∫øp theo <i class="fas fa-arrow-right"></i></button>
        </div>
    </div>

    <!-- Result Screen -->
    <div class="quiz-container result-screen" id="result-box">
        <div class="score-circle">
            <span id="final-score">0/0</span>
        </div>
        <div class="feedback-text" id="final-feedback">Tuy·ªát v·ªùi!</div>
        <p>B·∫°n ƒë√£ ho√†n th√†nh b√†i luy·ªán t·∫≠p S·∫Øp x·∫øp c√¢u.</p>
        <button class="next-btn" style="display:inline-block;" onclick="location.reload()">L√†m l·∫°i b√†i <i class="fas fa-redo"></i></button>
    </div>

    <!-- AUDIO FILES (Base64 for Single File Requirement) -->
    <script>
        // Short beep for correct (Ding)
        const sndCorrect = new Audio("data:audio/wav;base64,UklGRi4AAABXQVZFZm10IBAAAAABAAEAQB8AAEAfAAABAAgAZGF0YQAAAAA="); // Placeholder, will use generated beeps in JS logic for reliability if external links fail, but let's use a real trick with AudioContext for pure JS sounds to avoid large base64 strings.
        
        // Actually, let's use Web Audio API for synthesized sounds (Ding / Buzz) to ensure 0 external dependency and keep file size small.
        const audioCtx = new (window.AudioContext || window.webkitAudioContext)();

        function playDing() {
            if (audioCtx.state === 'suspended') audioCtx.resume();
            const osc = audioCtx.createOscillator();
            const gain = audioCtx.createGain();
            osc.connect(gain);
            gain.connect(audioCtx.destination);
            
            osc.type = 'sine';
            osc.frequency.setValueAtTime(523.25, audioCtx.currentTime); // C5
            osc.frequency.exponentialRampToValueAtTime(1046.5, audioCtx.currentTime + 0.1); // C6
            
            gain.gain.setValueAtTime(0.3, audioCtx.currentTime);
            gain.gain.exponentialRampToValueAtTime(0.01, audioCtx.currentTime + 0.5);
            
            osc.start();
            osc.stop(audioCtx.currentTime + 0.5);
        }

        function playBuzz() {
            if (audioCtx.state === 'suspended') audioCtx.resume();
            const osc = audioCtx.createOscillator();
            const gain = audioCtx.createGain();
            osc.connect(gain);
            gain.connect(audioCtx.destination);
            
            osc.type = 'sawtooth';
            osc.frequency.setValueAtTime(150, audioCtx.currentTime); 
            osc.frequency.linearRampToValueAtTime(100, audioCtx.currentTime + 0.3);
            
            gain.gain.setValueAtTime(0.3, audioCtx.currentTime);
            gain.gain.linearRampToValueAtTime(0.01, audioCtx.currentTime + 0.3);
            
            osc.start();
            osc.stop(audioCtx.currentTime + 0.3);
        }
    </script>

    <!-- Main Logic -->
    <script>
        // --- 1. DATA SOURCE (100% from user input) ---
        const quizData = [
    {
      "questionNumber": 1,
      "question": "Rearrange the sentences to make a complete letter:\n\na. We visited many famous places like the Eiffel Tower and the Louvre Museum, which were absolutely beautiful.\nb. Dear Anna, I hope you're doing well! I'm having a wonderful time in Paris with my family.\nc. The local food is delicious, especially the croissants and cheese that we have for breakfast every morning.\nd. Tomorrow we're going to Disneyland Paris, which I've been excited about since we planned this trip.\ne. I bought you a small souvenir from a shop near our hotel. See you soon! Love, Emily",
      "hint": "T√¨m c√¢u ch√†o m·ªü ƒë·∫ßu (Greeting) v√† c√¢u ch√†o k·∫øt th√∫c (Closing) tr∆∞·ªõc. Sau ƒë√≥ s·∫Øp x·∫øp th√¢n b√†i theo tr√¨nh t·ª±: Ho·∫°t ƒë·ªông ƒë√£ l√†m -> ƒê·ªì ƒÉn -> K·∫ø ho·∫°ch t∆∞∆°ng lai.",
      "answerOptions": [
        {
          "text": "b ‚Äì a ‚Äì c ‚Äì d ‚Äì e",
          "rationale": "Ch√≠nh x√°c! Tr√¨nh t·ª± h·ª£p l√Ω c·ªßa m·ªôt l√° th∆∞:<br>1. <b>(b) M·ªü ƒë·∫ßu:</b> Ch√†o h·ªèi v√† n√™u l√Ω do vi·∫øt (ƒêang ·ªü Paris).<br>2. <b>(a) Qu√° kh·ª©:</b> K·ªÉ v·ªÅ n∆°i ƒë√£ ƒëi (Eiffel, Louvre).<br>3. <b>(c) Hi·ªán t·∫°i/Chi ti·∫øt:</b> K·ªÉ v·ªÅ ƒë·ªì ƒÉn (Croissants).<br>4. <b>(d) T∆∞∆°ng lai:</b> K·∫ø ho·∫°ch ng√†y mai (Disneyland).<br>5. <b>(e) K·∫øt th∆∞:</b> Nh·∫Øc ƒë·∫øn qu√† v√† ch√†o t·∫°m bi·ªát.<br><br><b>D·ªãch chi ti·∫øt:</b><br>* <b>b (Greeting):</b> <i>Dear Anna...</i> (Anna th√¢n m·∫øn, t·ªõ hy v·ªçng c·∫≠u v·∫´n kh·ªèe! T·ªõ ƒëang c√≥ kho·∫£ng th·ªùi gian tuy·ªát v·ªùi ·ªü Paris c√πng gia ƒë√¨nh.)<br>* <b>a (Activity):</b> <i>We visited (verb)...</i> (Ch√∫ng t·ªõ ƒë√£ thƒÉm nhi·ªÅu ƒë·ªãa ƒëi·ªÉm n·ªïi ti·∫øng nh∆∞ Th√°p Eiffel v√† B·∫£o t√†ng Louvre, nh·ªØng n∆°i c·ª±c k·ª≥ xinh ƒë·∫πp.)<br>* <b>c (Food):</b> <i>The local food (noun)...</i> (ƒê·ªì ƒÉn ƒë·ªãa ph∆∞∆°ng r·∫•t ngon, ƒë·∫∑c bi·ªát l√† b√°nh s·ª´ng b√≤ v√† ph√¥ mai m√† ch√∫ng t·ªõ ƒÉn s√°ng m·ªói ng√†y.)<br>* <b>d (Plan):</b> <i>Tomorrow (adv)...</i> (Ng√†y mai ch√∫ng t·ªõ s·∫Ω ƒëi Disneyland Paris, n∆°i m√† t·ªõ ƒë√£ r·∫•t h√°o h·ª©c k·ªÉ t·ª´ khi l√™n k·∫ø ho·∫°ch chuy·∫øn ƒëi n√†y.)<br>* <b>e (Closing):</b> <i>I bought (verb)...</i> (T·ªõ ƒë√£ mua cho c·∫≠u m·ªôt m√≥n qu√† l∆∞u ni·ªám nh·ªè t·ª´ m·ªôt c·ª≠a h√†ng g·∫ßn kh√°ch s·∫°n. H·∫πn s·ªõm g·∫∑p l·∫°i! Th√¢n √°i, Emily.)",
          "isCorrect": true
        },
        {
          "text": "a ‚Äì b ‚Äì c ‚Äì d ‚Äì e",
          "rationale": "Sai. C√¢u (a) k·ªÉ l·ªÉ chi ti·∫øt kh√¥ng th·ªÉ ƒë·ª©ng tr∆∞·ªõc c√¢u ch√†o h·ªèi (b).",
          "isCorrect": false
        },
        {
          "text": "b ‚Äì c ‚Äì a ‚Äì d ‚Äì e",
          "rationale": "Sai. Th∆∞·ªùng ng∆∞·ªùi ta k·ªÉ v·ªÅ ƒë·ªãa ƒëi·ªÉm tham quan ch√≠nh (a) tr∆∞·ªõc khi ƒëi v√†o chi ti·∫øt ƒë·ªì ƒÉn (c), ho·∫∑c √≠t nh·∫•t (a) mang t√≠nh bao qu√°t h∆°n.",
          "isCorrect": false
        },
        {
          "text": "e ‚Äì b ‚Äì a ‚Äì c ‚Äì d",
          "rationale": "Sai. C√¢u (e) l√† c√¢u k·∫øt th∆∞, kh√¥ng th·ªÉ ƒë·ª©ng ƒë·∫ßu.",
          "isCorrect": false
        }
      ]
    },
    {
      "questionNumber": 2,
      "question": "Rearrange the sentences to make a logical paragraph about Phu Quoc Island:\n\na. The beach, which is famous for its white sand and clear water, attracts millions of visitors every year.\nb. Local restaurants serve fresh seafood that fishermen catch early in the morning.\nc. Phu Quoc Island is one of the most popular tourist destinations in Vietnam.\nd. Hotels and resorts along the coast offer various activities like snorkeling, diving, and island hopping tours.\ne. The best time to visit is from November to March when the weather is dry and sunny.",
      "answerOptions": [
        {
          "text": "c ‚Äì a ‚Äì b ‚Äì d ‚Äì e",
          "rationale": "Ch√≠nh x√°c! C·∫•u tr√∫c ƒëo·∫°n vƒÉn mi√™u t·∫£ ƒë·ªãa ƒëi·ªÉm:<br>1. <b>(c) C√¢u ch·ªß ƒë·ªÅ:</b> Gi·ªõi thi·ªáu chung v·ªÅ Ph√∫ Qu·ªëc.<br>2. <b>(a) ƒê·∫∑c ƒëi·ªÉm n·ªïi b·∫≠t:</b> B√£i bi·ªÉn (l√Ω do ch√≠nh h√∫t kh√°ch).<br>3. <b>(b) ·∫®m th·ª±c:</b> Nh√† h√†ng v√† h·∫£i s·∫£n.<br>4. <b>(d) Ho·∫°t ƒë·ªông:</b> Kh√°ch s·∫°n v√† c√°c tour gi·∫£i tr√≠.<br>5. <b>(e) L·ªùi khuy√™n:</b> Th·ªùi ƒëi·ªÉm ƒëi t·ªët nh·∫•t (k·∫øt ƒëo·∫°n).<br><br><b>D·ªãch chi ti·∫øt:</b><br>* <b>c (Intro):</b> <i>Phu Quoc Island (noun)</i> (ƒê·∫£o Ph√∫ Qu·ªëc l√† m·ªôt trong nh·ªØng ƒëi·ªÉm ƒë·∫øn du l·ªãch ph·ªï bi·∫øn nh·∫•t t·∫°i Vi·ªát Nam.)<br>* <b>a (Landscape):</b> <i>The beach (noun)...</i> (B√£i bi·ªÉn, n∆°i n·ªïi ti·∫øng v·ªõi c√°t tr·∫Øng v√† n∆∞·ªõc trong xanh, thu h√∫t h√†ng tri·ªáu du kh√°ch m·ªói nƒÉm.)<br>* <b>b (Food):</b> <i>Local restaurants (noun)...</i> (C√°c nh√† h√†ng ƒë·ªãa ph∆∞∆°ng ph·ª•c v·ª• h·∫£i s·∫£n t∆∞∆°i s·ªëng m√† ng∆∞ d√¢n ƒë√°nh b·∫Øt v√†o s√°ng s·ªõm.)<br>* <b>d (Activities):</b> <i>Hotels and resorts (noun)...</i> (C√°c kh√°ch s·∫°n v√† khu ngh·ªâ d∆∞·ª°ng d·ªçc b·ªù bi·ªÉn cung c·∫•p nhi·ªÅu ho·∫°t ƒë·ªông nh∆∞ l·∫∑n ·ªëng th·ªü, l·∫∑n b√¨nh kh√≠ v√† tour tham quan c√°c ƒë·∫£o.)<br>* <b>e (Advice):</b> <i>The best time (noun)...</i> (Th·ªùi ƒëi·ªÉm t·ªët nh·∫•t ƒë·ªÉ gh√© thƒÉm l√† t·ª´ th√°ng 11 ƒë·∫øn th√°ng 3 khi th·ªùi ti·∫øt kh√¥ r√°o v√† c√≥ n·∫Øng.)",
          "isCorrect": true
        },
        {
          "text": "a ‚Äì c ‚Äì b ‚Äì d ‚Äì e",
          "rationale": "Sai. C√¢u (a) n√≥i v·ªÅ b√£i bi·ªÉn l√† chi ti·∫øt c·ª• th·ªÉ, c·∫ßn c√¢u (c) gi·ªõi thi·ªáu t·ªïng quan \"Ph√∫ Qu·ªëc\" tr∆∞·ªõc.",
          "isCorrect": false
        },
        {
          "text": "c ‚Äì b ‚Äì a ‚Äì d ‚Äì e",
          "rationale": "Sai. C√¢u (a) n√≥i v·ªÅ b√£i bi·ªÉn (c·∫£nh quan ch√≠nh) n√™n ƒëi ngay sau c√¢u gi·ªõi thi·ªáu tr∆∞·ªõc khi n√≥i ƒë·∫øn ƒë·ªì ƒÉn (b). Tuy nhi√™n, tr·∫≠t t·ª± n√†y c≈©ng kh√° logic nh∆∞ng ƒë√°p √°n A ph·ªï bi·∫øn h∆°n trong vƒÉn m√¥ t·∫£ du l·ªãch.",
          "isCorrect": false
        },
        {
          "text": "e ‚Äì c ‚Äì a ‚Äì b ‚Äì d",
          "rationale": "Sai. L·ªùi khuy√™n v·ªÅ th·ªùi gian (e) th∆∞·ªùng n·∫±m cu·ªëi ƒëo·∫°n vƒÉn.",
          "isCorrect": false
        }
      ]
    },
    {
      "questionNumber": 3,
      "question": "Exercise 20 - Q1: Put the sentences (a-c) in the correct order to fill in the blank.\n\nContext: \"Our family trip to Hoi An Ancient Town was truly memorable. The local guide who showed us around was very knowledgeable about the town's history. ____________.\"\n\na. Later, she asked whether we wanted to visit the Japanese Covered Bridge, which was built in the 1590s.\nb. She first wondered if we knew that Hoi An used to be an important trading port in Southeast Asia.\nc. At the old houses, she questioned whether we had noticed the unique architecture that combines Vietnamese, Chinese, and Japanese styles.",
      "hint": "Ch√∫ √Ω c√°c t·ª´ ch·ªâ tr√¨nh t·ª± th·ªùi gian: 'First' (ƒê·∫ßu ti√™n), 'Later' (Sau ƒë√≥).",
      "answerOptions": [
        {
          "text": "b - c - a",
          "rationale": "Ch√≠nh x√°c! Tr√¨nh t·ª± t∆∞·ªùng thu·∫≠t:<br>1. <b>(b):</b> <i>She first wondered...</i> (ƒê·∫ßu ti√™n c√¥ ·∫•y t·ª± h·ªèi li·ªáu ch√∫ng t√¥i c√≥ bi·∫øt... -> Gi·ªõi thi·ªáu l·ªãch s·ª≠ chung).<br>2. <b>(c):</b> <i>At the old houses...</i> (T·∫°i nh·ªØng ng√¥i nh√† c·ªï... -> ƒêi v√†o chi ti·∫øt ki·∫øn tr√∫c).<br>3. <b>(a):</b> <i>Later...</i> (Sau ƒë√≥... -> Chuy·ªÉn sang ƒë·ªãa ƒëi·ªÉm kh√°c l√† Ch√πa C·∫ßu).<br><br><b>D·ªãch chi ti·∫øt:</b><br>* <b>b:</b> C√¥ ·∫•y <b>ƒë·∫ßu ti√™n (first - adv)</b> t·ª± h·ªèi li·ªáu ch√∫ng t√¥i c√≥ bi·∫øt H·ªôi An t·ª´ng l√† m·ªôt th∆∞∆°ng c·∫£ng quan tr·ªçng ·ªü ƒê√¥ng Nam √Å kh√¥ng.<br>* <b>c:</b> T·∫°i c√°c ng√¥i nh√† c·ªï, c√¥ ·∫•y h·ªèi li·ªáu ch√∫ng t√¥i c√≥ ƒë·ªÉ √Ω th·∫•y ki·∫øn tr√∫c <b>ƒë·ªôc ƒë√°o (unique - adj)</b> k·∫øt h·ª£p phong c√°ch Vi·ªát, Hoa v√† Nh·∫≠t kh√¥ng.<br>* <b>a:</b> <b>Sau ƒë√≥ (Later - adv)</b>, c√¥ ·∫•y h·ªèi li·ªáu ch√∫ng t√¥i c√≥ mu·ªën thƒÉm Ch√πa C·∫ßu Nh·∫≠t B·∫£n, n∆°i ƒë∆∞·ª£c x√¢y d·ª±ng v√†o nh·ªØng nƒÉm 1590 kh√¥ng.",
          "isCorrect": true
        },
        {
          "text": "a - b - c",
          "rationale": "Sai. 'Later' (Sau ƒë√≥) kh√¥ng th·ªÉ ƒë·ª©ng ƒë·∫ßu chu·ªói h√†nh ƒë·ªông.",
          "isCorrect": false
        },
        {
          "text": "c - a - b",
          "rationale": "Sai. 'First' (b) ph·∫£i ƒë·ª©ng tr∆∞·ªõc.",
          "isCorrect": false
        },
        {
          "text": "b - a - c",
          "rationale": "Sai. V·ªÅ m·∫∑t logic tham quan, th∆∞·ªùng ƒëi xem nh√† c·ªï (c) r·ªìi m·ªõi di chuy·ªÉn sang Ch√πa C·∫ßu (a - Later).",
          "isCorrect": false
        }
      ]
    },
    {
      "questionNumber": 4,
      "question": "Exercise 20 - Q2: Choose the sentence that can END the text in Question 3 most appropriately.",
      "hint": "C√¢u k·∫øt ƒëo·∫°n (Concluding sentence) th∆∞·ªùng t√≥m t·∫Øt c·∫£m x√∫c ho·∫∑c n√™u d·ª± ƒë·ªãnh t∆∞∆°ng lai, kh√¥ng ƒë∆∞a ra th√¥ng tin th·ª±c t·∫ø ƒë∆°n thu·∫ßn.",
      "answerOptions": [
        {
          "text": "Hoi An is located in central Vietnam.",
          "rationale": "Sai. ƒê√¢y l√† c√¢u gi·ªõi thi·ªáu v·ªã tr√≠ ƒë·ªãa l√Ω, n√™n n·∫±m ·ªü m·ªü b√†i.",
          "isCorrect": false
        },
        {
          "text": "We left Hoi An with wonderful memories and hundreds of photos, planning to return next year.",
          "rationale": "Ch√≠nh x√°c! ƒê√¢y l√† c√¢u k·∫øt ho√†n h·∫£o, t√≥m t·∫Øt c·∫£m x√∫c (memories) v√† h√†nh ƒë·ªông k·∫øt th√∫c chuy·∫øn ƒëi.<br><br><b>D·ªãch chi ti·∫øt:</b><br>Ch√∫ng t√¥i r·ªùi H·ªôi An v·ªõi nh·ªØng <b>k·ª∑ ni·ªám (memories - noun)</b> tuy·ªát v·ªùi v√† h√†ng trƒÉm b·ª©c ·∫£nh, l√™n k·∫ø ho·∫°ch quay l·∫°i v√†o nƒÉm sau.",
          "isCorrect": true
        },
        {
          "text": "The weather in Hoi An is usually hot and humid.",
          "rationale": "Sai. ƒê√¢y l√† th√¥ng tin v·ªÅ th·ªùi ti·∫øt, kh√¥ng ph√π h·ª£p ƒë·ªÉ k·∫øt th√∫c b√†i vƒÉn k·ªÉ v·ªÅ tr·∫£i nghi·ªám.",
          "isCorrect": false
        },
        {
          "text": "Tourists need to buy tickets to enter the old town.",
          "rationale": "Sai. ƒê√¢y l√† th√¥ng tin quy ƒë·ªãnh, kh√¥ng mang t√≠nh t·ªïng k·∫øt c·∫£m x√∫c.",
          "isCorrect": false
        }
      ]
    },
    {
      "questionNumber": 5,
      "question": "Exercise 9 - Q1: Arrange the conversation between Sarah and Tom about booking a hotel.\n\na. Tom: That's not too expensive. I'll book it online tonight.\nb. Sarah: Have you found a good hotel for our trip to Da Nang?\nc. Tom: How much is it per night?\nd. Sarah: Yes, I found a nice beach resort with great reviews.\ne. Sarah: It's about $50 for a double room with breakfast included.",
      "hint": "B·∫Øt ƒë·∫ßu b·∫±ng c√¢u h·ªèi m·ªü ƒë·∫ßu ch·ªß ƒë·ªÅ (Have you found...?).",
      "answerOptions": [
        {
          "text": "b - d - c - e - a",
          "rationale": "Ch√≠nh x√°c! Logic h·ªôi tho·∫°i:<br>1. <b>(b) H·ªèi:</b> ƒê√£ t√¨m ƒë∆∞·ª£c kh√°ch s·∫°n ch∆∞a?<br>2. <b>(d) Tr·∫£ l·ªùi:</b> R·ªìi, t√¨m ƒë∆∞·ª£c resort ƒë·∫πp.<br>3. <b>(c) H·ªèi gi√°:</b> Bao nhi√™u m·ªôt ƒë√™m?<br>4. <b>(e) B√°o gi√°:</b> 50 ƒë√¥.<br>5. <b>(a) Ch·ªët:</b> Kh√¥ng ƒë·∫Øt, s·∫Ω ƒë·∫∑t lu√¥n.<br><br><b>D·ªãch chi ti·∫øt:</b><br>* <b>b:</b> C·∫≠u ƒë√£ t√¨m ƒë∆∞·ª£c kh√°ch s·∫°n t·ªët cho chuy·∫øn ƒëi ƒê√† N·∫µng ch∆∞a?<br>* <b>d:</b> R·ªìi, t·ªõ t√¨m th·∫•y m·ªôt khu ngh·ªâ d∆∞·ª°ng bi·ªÉn ƒë·∫πp v·ªõi nhi·ªÅu ƒë√°nh gi√° t·ªët.<br>* <b>c:</b> Gi√° bao nhi√™u m·ªôt ƒë√™m?<br>* <b>e:</b> Kho·∫£ng 50 ƒë√¥ cho ph√≤ng ƒë√¥i bao g·ªìm ƒÉn s√°ng.<br>* <b>a:</b> Th·∫ø th√¨ kh√¥ng qu√° <b>ƒë·∫Øt (expensive - adj)</b>. T·ªõ s·∫Ω <b>ƒë·∫∑t (book - verb)</b> online t·ªëi nay.",
          "isCorrect": true
        },
        {
          "text": "d - b - c - e - a",
          "rationale": "Sai. Kh√¥ng th·ªÉ tr·∫£ l·ªùi 'Yes' (d) tr∆∞·ªõc khi c√≥ ng∆∞·ªùi h·ªèi (b).",
          "isCorrect": false
        },
        {
          "text": "b - c - d - e - a",
          "rationale": "Sai. H·ªèi gi√° (c) ngay sau khi h·ªèi t√¨m ƒë∆∞·ª£c ch∆∞a (b) l√† h∆°i v·ªôi, c·∫ßn b∆∞·ªõc x√°c nh·∫≠n ƒë√£ t√¨m ƒë∆∞·ª£c (d) tr∆∞·ªõc.",
          "isCorrect": false
        },
        {
          "text": "a - b - d - c - e",
          "rationale": "Sai. C√¢u ch·ªët (a) kh√¥ng th·ªÉ ƒë·ª©ng ƒë·∫ßu.",
          "isCorrect": false
        }
      ]
    },
    {
      "questionNumber": 6,
      "question": "Exercise 9 - Q2: Arrange the conversation between a Guide and a Tourist.\n\na. Guide: First, we'll visit the ancient temples in the morning.\nb. Tourist: What's the plan for tomorrow's city tour?\nc. Guide: Then we'll have lunch at a traditional restaurant.\nd. Tourist: Sounds great! What time should we meet?\ne. Guide: Please be at the hotel lobby at 8 AM sharp.\nf. Tourist: Perfect! Should I bring anything special?",
      "hint": "Kh√°ch h·ªèi k·∫ø ho·∫°ch -> H∆∞·ªõng d·∫´n vi√™n tr√¨nh b√†y (First... Then...) -> Kh√°ch h·ªèi gi·ªù -> H∆∞·ªõng d·∫´n vi√™n ch·ªët gi·ªù.",
      "answerOptions": [
        {
          "text": "b - c - a - d - e - f",
          "rationale": "Sai. 'Then' (c) kh√¥ng th·ªÉ ƒë·ª©ng tr∆∞·ªõc 'First' (a).",
          "isCorrect": false
        },
        {
          "text": "b - a - c - d - e - f",
          "rationale": "Ch√≠nh x√°c! Logic h·ªôi tho·∫°i:<br>1. <b>(b) H·ªèi k·∫ø ho·∫°ch:</b> Mai ƒëi ƒë√¢u?<br>2. <b>(a) Tr√¨nh b√†y 1:</b> S√°ng thƒÉm ƒë·ªÅn (First).<br>3. <b>(c) Tr√¨nh b√†y 2:</b> Sau ƒë√≥ ƒÉn tr∆∞a (Then).<br>4. <b>(d) H∆∞·ªüng ·ª©ng & H·ªèi gi·ªù:</b> Nghe tuy·ªát ƒë·∫•y! M·∫•y gi·ªù g·∫∑p?<br>5. <b>(e) Ch·ªët gi·ªù:</b> 8 gi·ªù ƒë√∫ng.<br>6. <b>(f) H·ªèi th√™m:</b> Tuy·ªát! C·∫ßn mang g√¨ kh√¥ng?<br><br><b>D·ªãch chi ti·∫øt:</b><br>* <b>b:</b> K·∫ø ho·∫°ch cho city tour ng√†y mai l√† g√¨?<br>* <b>a:</b> <b>ƒê·∫ßu ti√™n (First - adv)</b>, ch√∫ng ta s·∫Ω thƒÉm c√°c ng√¥i ƒë·ªÅn c·ªï v√†o bu·ªïi s√°ng.<br>* <b>c:</b> <b>Sau ƒë√≥ (Then - adv)</b> ch√∫ng ta s·∫Ω ƒÉn tr∆∞a t·∫°i m·ªôt nh√† h√†ng truy·ªÅn th·ªëng.<br>* <b>d:</b> Nghe tuy·ªát ƒë·∫•y! M·∫•y gi·ªù ch√∫ng ta n√™n g·∫∑p nhau?<br>* <b>e:</b> Vui l√≤ng c√≥ m·∫∑t t·∫°i <b>s·∫£nh kh√°ch s·∫°n (hotel lobby - noun)</b> l√∫c 8 gi·ªù ƒë√∫ng.<br>* <b>f:</b> Ho√†n h·∫£o! T√¥i c√≥ n√™n mang theo th·ª© g√¨ <b>ƒë·∫∑c bi·ªát (special - adj)</b> kh√¥ng?",
          "isCorrect": true
        },
        {
          "text": "a - b - c - d - e - f",
          "rationale": "Sai. H∆∞·ªõng d·∫´n vi√™n t·ª± nhi√™n tr√¨nh b√†y (a) m√† kh√¥ng c√≥ kh√°ch h·ªèi (b) tr∆∞·ªõc l√† k√©m t·ª± nhi√™n.",
          "isCorrect": false
        },
        {
          "text": "d - e - f - b - a - c",
          "rationale": "Sai. H·ªèi gi·ªù (d) khi ch∆∞a bi·∫øt ƒëi ƒë√¢u l√† kh√¥ng h·ª£p l√Ω.",
          "isCorrect": false
        }
      ]
    },
    {
      "questionNumber": 7,
      "question": "Exercise 9 - Q3: Arrange the conversation between Mark and Lisa about a trip.\n\na. Lisa: The local people were so friendly and helpful!\nb. Mark: How was your backpacking trip to Vietnam?\nc. Lisa: They always smiled and tried to help even with the language barrier.\nd. Mark: That's wonderful! Did you have any problems with the language?\ne. Lisa: It was amazing! The best trip I've ever had.\nf. Lisa: Not really. I used a translation app and body language.",
      "hint": "H·ªèi t·ªïng quan -> Khen hay -> Khen ng∆∞·ªùi d√¢n -> H·ªèi kh√≥ khƒÉn ng√¥n ng·ªØ -> Gi·∫£i th√≠ch c√°ch kh·∫Øc ph·ª•c.",
      "answerOptions": [
        {
          "text": "b - e - a - c - d - f",
          "rationale": "Ch√≠nh x√°c! Logic h·ªôi tho·∫°i:<br>1. <b>(b) H·ªèi thƒÉm:</b> Chuy·∫øn ƒëi th·∫ø n√†o?<br>2. <b>(e) C·∫£m nh·∫≠n chung:</b> Tuy·ªát v·ªùi nh·∫•t t·ª´ng ƒëi.<br>3. <b>(a) Chi ti·∫øt:</b> Ng∆∞·ªùi d√¢n th√¢n thi·ªán.<br>4. <b>(c) Chi ti·∫øt h∆°n:</b> H·ªç hay c∆∞·ªùi v√† gi√∫p ƒë·ª°.<br>5. <b>(d) H·ªèi s√¢u:</b> C√≥ g·∫∑p r·∫Øc r·ªëi ng√¥n ng·ªØ kh√¥ng? (Li√™n k·∫øt v·ªõi √Ω 'language barrier' ·ªü c√¢u c).<br>6. <b>(f) Tr·∫£ l·ªùi:</b> Kh√¥ng h·∫≥n, d√πng app d·ªãch.<br><br><b>D·ªãch chi ti·∫øt:</b><br>* <b>b:</b> Chuy·∫øn du l·ªãch b·ª•i ƒë·∫øn Vi·ªát Nam c·ªßa c·∫≠u th·∫ø n√†o?<br>* <b>e:</b> N√≥ th·∫≠t <b>tuy·ªát v·ªùi (amazing - adj)</b>! Chuy·∫øn ƒëi tuy·ªát nh·∫•t t·ªõ t·ª´ng c√≥.<br>* <b>a:</b> Ng∆∞·ªùi d√¢n ƒë·ªãa ph∆∞∆°ng r·∫•t <b>th√¢n thi·ªán (friendly - adj)</b> v√† hay gi√∫p ƒë·ª°!<br>* <b>c:</b> H·ªç lu√¥n m·ªâm c∆∞·ªùi v√† c·ªë g·∫Øng gi√∫p ngay c·∫£ khi c√≥ <b>r√†o c·∫£n ng√¥n ng·ªØ (language barrier - noun)</b>.<br>* <b>d:</b> Tuy·ªát qu√°! C·∫≠u c√≥ g·∫∑p v·∫•n ƒë·ªÅ g√¨ v·ªõi ng√¥n ng·ªØ kh√¥ng?<br>* <b>f:</b> Kh√¥ng h·∫≥n. T·ªõ ƒë√£ d√πng ·ª©ng d·ª•ng d·ªãch thu·∫≠t v√† <b>ng√¥n ng·ªØ c∆° th·ªÉ (body language - noun)</b>.",
          "isCorrect": true
        },
        {
          "text": "a - c - b - e - d - f",
          "rationale": "Sai. Kh√¥ng th·ªÉ b·∫Øt ƒë·∫ßu b·∫±ng vi·ªác khen ng∆∞·ªùi d√¢n (a) khi ch∆∞a ƒë∆∞·ª£c h·ªèi v·ªÅ chuy·∫øn ƒëi (b).",
          "isCorrect": false
        },
        {
          "text": "d - f - b - e - a - c",
          "rationale": "Sai. H·ªèi v·ªÅ ng√¥n ng·ªØ (d) l√† chi ti·∫øt ph·ª•, kh√¥ng th·ªÉ ƒë·ª©ng ƒë·∫ßu h·ªôi tho·∫°i.",
          "isCorrect": false
        },
        {
          "text": "b - e - d - f - a - c",
          "rationale": "Kh√° h·ª£p l√Ω, nh∆∞ng tr·∫≠t t·ª± chu·∫©n th∆∞·ªùng l√† n√≥i v·ªÅ tr·∫£i nghi·ªám t·ªët (ng∆∞·ªùi d√¢n a, c) d·∫´n d·∫Øt ƒë·∫øn v·∫•n ƒë·ªÅ ng√¥n ng·ªØ (barrier) r·ªìi m·ªõi h·ªèi v·ªÅ r·∫Øc r·ªëi ng√¥n ng·ªØ (d). ƒê√°p √°n A m·∫°ch l·∫°c h∆°n.",
          "isCorrect": false
        }
      ]
    }
  ];

        // --- 2. GAME STATE ---
        let currentQuestionIndex = 0;
        let score = 0;
        let shuffledQuestions = [];

        // --- 3. UTILITIES ---
        function shuffleArray(array) {
            for (let i = array.length - 1; i > 0; i--) {
                const j = Math.floor(Math.random() * (i + 1));
                [array[i], array[j]] = [array[j], array[i]];
            }
            return array;
        }

        // --- 4. GAME LOGIC ---
        function initGame() {
            // Shuffle questions but keep Q1, Q2 etc logical if needed. 
            // For now, let's shuffle options within questions, but maybe keep question order fixed 
            // OR shuffle questions too. Let's shuffle questions for variety.
            shuffledQuestions = [...quizData]; 
            // Actually, usually teachers want questions 1-7 in order for context.
            // Let's keep question order FIXED, but shuffle OPTIONS.
            
            shuffledQuestions.forEach(q => {
                q.shuffledOptions = shuffleArray([...q.answerOptions]);
            });

            currentQuestionIndex = 0;
            score = 0;
            document.getElementById("quiz-box").style.display = "block";
            document.getElementById("result-box").style.display = "none";
            loadQuestion();
        }

        function loadQuestion() {
            const data = shuffledQuestions[currentQuestionIndex];
            const qNum = currentQuestionIndex + 1;
            const total = shuffledQuestions.length;

            // Update Progress
            const progressPercent = ((currentQuestionIndex) / total) * 100;
            document.getElementById("progress").style.width = `${progressPercent}%`;

            // Render Text
            document.getElementById("q-number").innerText = `${qNum} / ${total}`;
            document.getElementById("q-text").innerText = data.question;
            
            // Handle Hint
            const hintBox = document.getElementById("q-hint");
            if(data.hint) {
                hintBox.innerHTML = `<i class="fas fa-lightbulb" style="color:#f1c40f"></i> <b>G·ª£i √Ω:</b> ${data.hint}`;
                hintBox.style.display = "block";
            } else {
                hintBox.style.display = "none";
            }

            // Hide previous explanation and next button
            document.getElementById("explanation").style.display = "none";
            document.getElementById("next-btn").style.display = "none";

            // Render Options
            const optionsArea = document.getElementById("options-area");
            optionsArea.innerHTML = "";
            const labels = ['A', 'B', 'C', 'D'];

            data.shuffledOptions.forEach((opt, index) => {
                const btn = document.createElement("div");
                btn.className = "option-btn";
                // Only use labels if index < 4
                const label = index < 4 ? labels[index] : "?"; 
                btn.innerHTML = `<span class="opt-label">${label}</span> ${opt.text}`;
                btn.onclick = () => checkAnswer(btn, opt, data);
                optionsArea.appendChild(btn);
            });
        }

        function checkAnswer(selectedBtn, optionData, questionData) {
            // Disable all buttons
            const buttons = document.querySelectorAll(".option-btn");
            buttons.forEach(btn => {
                btn.style.pointerEvents = "none"; // Disable clicks
                btn.style.opacity = "0.7";
            });
            selectedBtn.style.opacity = "1";

            const expContent = document.getElementById("exp-content");
            const expBox = document.getElementById("explanation");
            const nextBtn = document.getElementById("next-btn");

            // Logic Correct/Wrong
            if (optionData.isCorrect) {
                selectedBtn.classList.add("correct");
                playDing();
                confetti({
                    particleCount: 100,
                    spread: 70,
                    origin: { y: 0.6 }
                });
                score++;
            } else {
                selectedBtn.classList.add("wrong");
                playBuzz();
                // Highlight the correct one
                // Use a loop to find the button that contains the correct text
                buttons.forEach((btn, idx) => {
                     // logic match by finding the correct option object in the shuffled array
                     if(questionData.shuffledOptions[idx].isCorrect) {
                         btn.classList.add("correct");
                         btn.style.opacity = "1";
                     }
                });
            }

            // Show Explanation logic
            // Build the explanation HTML based on the "Detailed Analysis" requirement
            let html = ``;
            
            // 1. Ph√¢n t√≠ch 4 ƒë√°p √°n (Analysis of all options from Rationale)
            // Since the user JSON only provides rationale per option, we construct it from there.
            // But we must prioritize the Rationale of the CORRECT answer as it contains the full breakdown.
            
            // Find correct option rationale
            const correctOpt = questionData.answerOptions.find(o => o.isCorrect);
            
            html += `<div class="exp-section">`;
            html += `<strong><i class="fas fa-check-circle"></i> Ph√¢n t√≠ch chi ti·∫øt:</strong><br>`;
            html += `${correctOpt.rationale}`; // This field in JSON already contains the detailed breakdown & translation
            html += `</div>`;

            // Add Specific Wrong reasons if selected wrong
            if (!optionData.isCorrect) {
                html += `<div class="exp-section" style="margin-top:15px; border-top:1px dashed #ccc; padding-top:10px;">`;
                html += `<strong style="color:var(--wrong)"><i class="fas fa-times-circle"></i> T·∫°i sao ƒë√°p √°n b·∫°n ch·ªçn l·∫°i sai?</strong><br>`;
                html += `${optionData.rationale}`;
                html += `</div>`;
            }

            expContent.innerHTML = html;
            expBox.style.display = "block";
            nextBtn.style.display = "inline-block";
        }

        function nextQuestion() {
            currentQuestionIndex++;
            if (currentQuestionIndex < shuffledQuestions.length) {
                loadQuestion();
            } else {
                showResult();
            }
        }

        function showResult() {
            document.getElementById("quiz-box").style.display = "none";
            document.getElementById("result-box").style.display = "block";
            document.getElementById("final-score").innerText = `${score}/${shuffledQuestions.length}`;
            
            const percentage = (score / shuffledQuestions.length) * 100;
            let feedback = "";
            if (percentage === 100) feedback = "Xu·∫•t s·∫Øc! B·∫°n l√† thi√™n t√†i s·∫Øp x·∫øp c√¢u! üåü";
            else if (percentage >= 80) feedback = "R·∫•t t·ªët! B·∫°n n·∫Øm r·∫•t v·ªØng c·∫•u tr√∫c! üî•";
            else if (percentage >= 50) feedback = "Kh√° l·∫Øm! C·ªë g·∫Øng th√™m ch√∫t n·ªØa nh√©! üí™";
            else feedback = "ƒê·ª´ng n·∫£n ch√≠! H√£y xem l·∫°i ph·∫ßn gi·∫£i th√≠ch v√† th·ª≠ l·∫°i nh√©! üçÄ";
            
            document.getElementById("final-feedback").innerText = feedback;
            
            if (percentage >= 80) {
                confetti({
                    particleCount: 200,
                    spread: 100,
                    origin: { y: 0.6 }
                });
            }
        }

        // Start Game
        window.onload = initGame;

    </script>
</body>
</html>
