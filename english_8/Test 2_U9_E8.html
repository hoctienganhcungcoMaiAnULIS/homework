<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>UNIT 9 ‚Äì NATURAL DISASTER | TEST 02</title>
    <style>
        :root {
            --primary-color: #0056b3;
            --success-color: #28a745;
            --error-color: #dc3545;
            --warning-color: #ffc107;
            --light-bg: #f8f9fa;
            --card-shadow: 0 4px 6px rgba(0,0,0,0.1);
            --font-main: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        }

        body {
            font-family: var(--font-main);
            background-color: #e9ecef;
            color: #333;
            line-height: 1.6;
            margin: 0;
            padding: 0;
        }

        /* Header */
        header {
            background-color: var(--primary-color);
            color: white;
            padding: 1rem 0;
            text-align: center;
            box-shadow: 0 2px 4px rgba(0,0,0,0.2);
            position: sticky;
            top: 0;
            z-index: 1000;
        }

        header h1 {
            margin: 0;
            font-size: 1.5rem;
            font-weight: 700;
        }

        header h2 {
            margin: 5px 0 0;
            font-size: 1rem;
            font-weight: 400;
            opacity: 0.9;
        }

        .container {
            max-width: 800px;
            margin: 20px auto;
            padding: 0 15px;
            padding-bottom: 80px; /* Space for footer */
        }

        /* Card Styles */
        .card {
            background: white;
            border-radius: 8px;
            box-shadow: var(--card-shadow);
            margin-bottom: 20px;
            padding: 20px;
            transition: transform 0.2s;
            border-left: 5px solid var(--primary-color);
        }

        .card:hover {
            transform: translateY(-2px);
        }

        .question-number {
            font-weight: bold;
            color: var(--primary-color);
            margin-bottom: 10px;
            display: block;
        }

        .question-text {
            font-size: 1.1rem;
            margin-bottom: 15px;
        }

        /* Data Box for Reading Passages */
        .data-box {
            background-color: #e3f2fd;
            border: 1px solid #90caf9;
            border-radius: 8px;
            padding: 15px;
            margin-bottom: 20px;
            font-family: Georgia, serif; /* Reading font */
            line-height: 1.8;
        }

        .data-box h3 {
            margin-top: 0;
            color: var(--primary-color);
            font-size: 1rem;
            text-transform: uppercase;
        }

        /* Options */
        .options-group {
            display: flex;
            flex-direction: column;
            gap: 10px;
        }

        .option-label {
            display: flex;
            align-items: flex-start; /* Align top for long text */
            cursor: pointer;
            padding: 10px;
            border: 1px solid #ddd;
            border-radius: 5px;
            transition: background-color 0.2s;
        }

        .option-label:hover {
            background-color: var(--light-bg);
        }

        .option-label input {
            margin-right: 10px;
            margin-top: 5px;
        }

        /* Gap Fill Specifics */
        .gap-fill-options {
            background: #fff3cd;
            padding: 10px;
            border-radius: 5px;
            margin-bottom: 10px;
            font-weight: bold;
        }

        /* Sign & Notice Simulation */
        .sign-container {
            display: flex;
            justify-content: center;
            margin: 15px 0;
        }

        .sign-img {
            width: 150px;
            height: 200px;
            background-color: #cc0000;
            border-radius: 10px;
            border: 4px solid white;
            box-shadow: 0 0 0 2px #cc0000;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            color: white;
            font-weight: bold;
            text-align: center;
            position: relative;
        }

        .sign-icon-circle {
            width: 80px;
            height: 80px;
            background: white;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            margin-bottom: 10px;
            position: relative;
        }
        
        .sign-icon-circle::after {
            content: "";
            position: absolute;
            width: 90%;
            height: 8px;
            background-color: #cc0000;
            transform: rotate(-45deg);
        }

        .sign-text {
            font-family: Impact, sans-serif;
            font-size: 1.2rem;
            line-height: 1.1;
            text-transform: uppercase;
        }

        .notice-box {
            border: 2px solid #0056b3;
            padding: 15px;
            color: #cc0000;
            font-weight: bold;
            text-align: center;
            background: white;
            max-width: 400px;
            margin: 0 auto;
        }

        /* Action Buttons */
        .btn-check {
            margin-top: 15px;
            background-color: var(--primary-color);
            color: white;
            border: none;
            padding: 8px 16px;
            border-radius: 4px;
            cursor: pointer;
            font-size: 0.9rem;
        }

        .btn-check:hover {
            background-color: #004494;
        }

        /* Explanation Area */
        .explanation {
            margin-top: 15px;
            padding: 15px;
            border-radius: 5px;
            background-color: #e8f5e9;
            border-left: 4px solid var(--success-color);
            display: none; /* Hidden by default */
            font-size: 0.95rem;
        }

        .explanation strong {
            color: var(--success-color);
        }
        
        .explanation .wrong-note {
             color: var(--error-color);
             display: block;
             margin-top: 5px;
             font-style: italic;
        }

        /* Footer Submit */
        .sticky-footer {
            position: fixed;
            bottom: 0;
            left: 0;
            width: 100%;
            background: white;
            box-shadow: 0 -2px 10px rgba(0,0,0,0.1);
            padding: 15px 0;
            text-align: center;
            z-index: 1000;
        }

        .btn-submit {
            background-color: var(--success-color);
            color: white;
            border: none;
            padding: 12px 30px;
            border-radius: 30px;
            font-size: 1.1rem;
            font-weight: bold;
            cursor: pointer;
            box-shadow: 0 4px 6px rgba(40, 167, 69, 0.3);
            transition: all 0.3s;
        }

        .btn-submit:hover {
            background-color: #218838;
            transform: scale(1.05);
        }

        /* Review Mode Styles */
        .correct-answer {
            background-color: #d4edda !important;
            border-color: #c3e6cb !important;
        }

        .wrong-answer {
            background-color: #f8d7da !important;
            border-color: #f5c6cb !important;
        }
        
        .unanswered-warning {
            border-left-color: var(--warning-color) !important;
        }

        /* Popup */
        .overlay {
            position: fixed;
            top: 0; left: 0; width: 100%; height: 100%;
            background: rgba(0,0,0,0.5);
            display: none;
            justify-content: center;
            align-items: center;
            z-index: 2000;
        }

        .popup {
            background: white;
            padding: 30px;
            border-radius: 10px;
            text-align: center;
            max-width: 400px;
            width: 90%;
            box-shadow: 0 5px 15px rgba(0,0,0,0.3);
        }

        .score-circle {
            width: 100px;
            height: 100px;
            border-radius: 50%;
            background: var(--primary-color);
            color: white;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 2rem;
            font-weight: bold;
            margin: 0 auto 20px;
        }
        
        u {
            text-decoration: underline;
            text-underline-offset: 3px;
            font-weight: bold;
        }

    </style>
</head>
<body>

<header>
    <h1>UNIT 9 ‚Äì NATURAL DISASTER</h1>
    <h2>TEST 02 - Teacher: Ms Mai An ULIS</h2>
</header>

<div class="container" id="quiz-container">
    </div>

<div class="sticky-footer">
    <button class="btn-submit" onclick="submitAll()">N·ªòP B√ÄI & XEM K·∫æT QU·∫¢</button>
</div>

<div class="overlay" id="resultOverlay">
    <div class="popup">
        <div class="score-circle" id="scoreDisplay">0/40</div>
        <h3>K·∫øt qu·∫£ c·ªßa b·∫°n</h3>
        <p id="scoreMessage">H√£y xem l·∫°i chi ti·∫øt l·ªùi gi·∫£i b√™n d∆∞·ªõi nh√©!</p>
        <button class="btn-check" onclick="closePopup()">Xem chi ti·∫øt</button>
    </div>
</div>

<script>
    const questions = [
        // --- PRONUNCIATION ---
        {
            id: 1,
            type: "pronunciation",
            text: "Mark the letter A, B, C or D to indicate the word whose underlined part differs from the other three in pronunciation.",
            options: [
                { text: "w<u>a</u>ve", value: "A" },
                { text: "l<u>a</u>ndslide", value: "B" },
                { text: "d<u>a</u>mage", value: "C" },
                { text: "n<u>a</u>tural", value: "D" }
            ],
            correct: "A",
            explanation: `
                <strong>ƒê√°p √°n A ƒë√∫ng.</strong><br>
                <ul>
                    <li>A. w<u>a</u>ve /we…™v/ (√¢m /e…™/)</li>
                    <li>B. l<u>a</u>ndslide /Ààl√¶nd.sla…™d/ (√¢m /√¶/)</li>
                    <li>C. d<u>a</u>mage /Ààd√¶m.…™d í/ (√¢m /√¶/)</li>
                    <li>D. n<u>a</u>tural /Ààn√¶t É.…ôr.…ôl/ (√¢m /√¶/)</li>
                </ul>
                T·ª´ "wave" c√≥ √¢m 'a' ph√°t √¢m l√† diphthong /e…™/, trong khi c√°c t·ª´ c√≤n l·∫°i l√† √¢m /√¶/.
            `
        },
        {
            id: 2,
            type: "pronunciation",
            text: "Mark the letter A, B, C or D to indicate the word whose underlined part differs from the other three in pronunciation.",
            options: [
                { text: "r<u>e</u>scue", value: "A" },
                { text: "eff<u>e</u>ct", value: "B" }, // Assuming the 2nd e or the 1st
                { text: "marv<u>e</u>lous", value: "C" },
                { text: "tr<u>e</u>mble", value: "D" }
            ],
            correct: "C",
            explanation: `
                <strong>ƒê√°p √°n C ƒë√∫ng.</strong><br>
                Ch√∫ng ta x√©t ph·∫ßn g·∫°ch ch√¢n l√† nguy√™n √¢m 'e' trong c√°c t·ª´:
                <ul>
                    <li>A. r<u>e</u>scue /Ààres.kjuÀê/ (√¢m /e/)</li>
                    <li>B. eff<u>e</u>ct /…™Ààfekt/ (√¢m /e/ ·ªü tr·ªçng √¢m 2) ho·∫∑c n·∫øu x√©t e ƒë·∫ßu /…™/. Tuy nhi√™n, x√©t s·ª± t∆∞∆°ng ƒë·ªìng A v√† D ƒë·ªÅu l√† /e/ r√µ, th√¨ C l√† kh√°c bi·ªát nh·∫•t.</li>
                    <li>C. marv<u>e</u>lous /Ààm…ëÀê.v…ôl.…ôs/ (√¢m /…ô/ - √¢m schwa, √¢m y·∫øu)</li>
                    <li>D. tr<u>e</u>mble /Ààtrem.b…ôl/ (√¢m /e/)</li>
                </ul>
                T·ª´ "marvelous" c√≥ √¢m 'e' l√† √¢m l∆∞·ªõt /…ô/, c√°c t·ª´ c√≤n l·∫°i ph√°t √¢m r√µ l√† /e/.
            `
        },
        // --- STRESS ---
        {
            id: 3,
            type: "stress",
            text: "Mark the letter A, B, C or D to indicate the word that differs from the other three in the position of primary stress.",
            options: [
                { text: "donate", value: "A" },
                { text: "pacific", value: "B" },
                { text: "tornado", value: "C" },
                { text: "fortunate", value: "D" }
            ],
            correct: "D",
            explanation: `
                <strong>ƒê√°p √°n D ƒë√∫ng.</strong><br>
                <ul>
                    <li>A. donate /d…ô äÀàne…™t/ (Tr·ªçng √¢m 2)</li>
                    <li>B. pacific /p…ôÀàs…™f.…™k/ (Tr·ªçng √¢m 2)</li>
                    <li>C. tornado /t…îÀêÀàne…™.d…ô ä/ (Tr·ªçng √¢m 2)</li>
                    <li>D. fortunate /Ààf…îÀê.t É…ôn.…ôt/ (Tr·ªçng √¢m 1)</li>
                </ul>
                "Fortunate" nh·∫•n √¢m 1, c√°c t·ª´ c√≤n l·∫°i nh·∫•n √¢m 2.
            `
        },
        {
            id: 4,
            type: "stress",
            text: "Mark the letter A, B, C or D to indicate the word that differs from the other three in the position of primary stress.",
            options: [
                { text: "destruction", value: "A" },
                { text: "emergency", value: "B" },
                { text: "government", value: "C" },
                { text: "disaster", value: "D" }
            ],
            correct: "C",
            explanation: `
                <strong>ƒê√°p √°n C ƒë√∫ng.</strong><br>
                <ul>
                    <li>A. destruction /d…™Ààstr åk. É…ôn/ (Tr·ªçng √¢m 2)</li>
                    <li>B. emergency /…™Ààm…úÀê.d í…ôn.si/ (Tr·ªçng √¢m 2)</li>
                    <li>C. government /Àà…° åv.…ôn.m…ônt/ (Tr·ªçng √¢m 1)</li>
                    <li>D. disaster /d…™Ààz…ëÀê.st…ôr/ (Tr·ªçng √¢m 2)</li>
                </ul>
                "Government" nh·∫•n √¢m 1, c√°c t·ª´ c√≤n l·∫°i nh·∫•n √¢m 2.
            `
        },
        // --- GRAMMAR & VOCAB ---
        {
            id: 5,
            text: "Despite all the modern technology available to us, we‚Äôre still helpless ____ natural disasters.",
            options: [
                { text: "Against", value: "A" },
                { text: "to", value: "B" },
                { text: "with", value: "C" },
                { text: "for", value: "D" }
            ],
            correct: "A",
            explanation: `
                <strong>ƒê√°p √°n A: Against.</strong><br>
                C·∫•u tr√∫c: <em>helpless against something</em> (b·∫•t l·ª±c tr∆∞·ªõc c√°i g√¨).<br>
                D·ªãch: M·∫∑c d√π c√≥ t·∫•t c·∫£ c√¥ng ngh·ªá hi·ªán ƒë·∫°i, ch√∫ng ta v·∫´n b·∫•t l·ª±c tr∆∞·ªõc th·∫£m h·ªça thi√™n nhi√™n.
            `
        },
        {
            id: 6,
            text: "Many villagers were ____ to public shelters to avoid the volcanic eruption.",
            options: [
                { text: "Evacuated", value: "A" },
                { text: "given", value: "B" },
                { text: "brought", value: "C" },
                { text: "provided", value: "D" }
            ],
            correct: "A",
            explanation: `
                <strong>ƒê√°p √°n A: Evacuated.</strong><br>
                T·ª´ v·ª±ng: <em>evacuate (v)</em>: s∆° t√°n.<br>
                D·ªãch: Nhi·ªÅu d√¢n l√†ng ƒë√£ ƒë∆∞·ª£c s∆° t√°n ƒë·∫øn c√°c n∆°i tr√∫ ·∫©n c√¥ng c·ªông ƒë·ªÉ tr√°nh v·ª• phun tr√†o n√∫i l·ª≠a.<br>
                C√°c t·ª´ kh√°c kh√¥ng ph√π h·ª£p ng·ªØ c·∫£nh th·∫£m h·ªça: given (ƒë∆∞·ª£c cho), brought (ƒë∆∞·ª£c mang ƒë·∫øn - chung chung), provided (ƒë∆∞·ª£c cung c·∫•p).
            `
        },
        {
            id: 7,
            text: "Last year, a terrible storm ______ the rural area of Son La Province.",
            options: [
                { text: "Struck", value: "A" },
                { text: "did", value: "B" },
                { text: "made", value: "C" },
                { text: "deployed", value: "D" }
            ],
            correct: "A",
            explanation: `
                <strong>ƒê√°p √°n A: Struck.</strong><br>
                Collocation: <em>A storm strikes (past: struck)</em>: B√£o ƒë·ªï b·ªô/t·∫•n c√¥ng.<br>
                D·ªãch: NƒÉm ngo√°i, m·ªôt c∆°n b√£o kh·ªßng khi·∫øp ƒë√£ ƒë·ªï b·ªô v√†o v√πng n√¥ng th√¥n t·ªânh S∆°n La.
            `
        },
        {
            id: 8,
            text: "He ________his homework before he went to bed last night.",
            options: [
                { text: "Was", value: "A" },
                { text: "am", value: "B" },
                { text: "had done", value: "C" },
                { text: "have been", value: "D" }
            ],
            correct: "C",
            explanation: `
                <strong>ƒê√°p √°n C: had done.</strong><br>
                Ng·ªØ ph√°p: Qu√° kh·ª© ho√†n th√†nh (Past Perfect).<br>
                D√πng ƒë·ªÉ di·ªÖn t·∫£ m·ªôt h√†nh ƒë·ªông x·∫£y ra tr∆∞·ªõc m·ªôt h√†nh ƒë·ªông kh√°c trong qu√° kh·ª©.<br>
                H√†nh ƒë·ªông l√†m b√†i t·∫≠p (tr∆∞·ªõc) -> had done. H√†nh ƒë·ªông ƒëi ng·ªß (sau) -> went.<br>
                C·∫•u tr√∫c: S + had + V3/ed + before + S + V(past simple).
            `
        },
        {
            id: 9,
            text: "By the time I started primary school, I _______ how to ride a bike.",
            options: [
                { text: "Finish", value: "A" },
                { text: "finished", value: "B" },
                { text: "had finished", value: "C" },
                { text: "was finished", value: "D" }
            ],
            correct: "C",
            explanation: `
                <strong>ƒê√°p √°n C: had finished.</strong><br>
                C·∫•u tr√∫c: <em>By the time + S + V(past simple), S + V(past perfect)</em>.<br>
                Di·ªÖn t·∫£ h√†nh ƒë·ªông ho√†n t·∫•t tr∆∞·ªõc m·ªôt th·ªùi ƒëi·ªÉm trong qu√° kh·ª©.<br>
                D·ªãch: V√†o l√∫c t√¥i b·∫Øt ƒë·∫ßu h·ªçc ti·ªÉu h·ªçc, t√¥i ƒë√£ h·ªçc xong c√°ch ƒëi xe ƒë·∫°p.
            `
        },
        {
            id: 10,
            text: "When there is a plane crash, a lot of ____ is left.",
            options: [
                { text: "Dust", value: "A" },
                { text: "debris", value: "B" },
                { text: "waste", value: "C" },
                { text: "piece", value: "D" }
            ],
            correct: "B",
            explanation: `
                <strong>ƒê√°p √°n B: debris.</strong><br>
                T·ª´ v·ª±ng: <em>debris (n)</em>: m·∫£nh v·ª°, ƒë·ªëng ƒë·ªï n√°t (th∆∞·ªùng d√πng cho tai n·∫°n, ch√°y n·ªï).<br>
                D·ªãch: Khi c√≥ tai n·∫°n m√°y bay, r·∫•t nhi·ªÅu m·∫£nh v·ª° c√≤n s√≥t l·∫°i.<br>
                Waste (r√°c th·∫£i), Dust (b·ª•i), Piece (m·∫£nh - s·ªë √≠t, sai ng·ªØ ph√°p v√¨ a lot of + N ƒë·∫øm ƒë∆∞·ª£c s·ªë nhi·ªÅu ho·∫∑c kh√¥ng ƒë·∫øm ƒë∆∞·ª£c, 'piece' ph·∫£i l√† 'pieces').
            `
        },
        {
            id: 11,
            text: "After the flood, many people in that village were _____ homeless.",
            options: [
                { text: "Put", value: "A" },
                { text: "felt", value: "B" },
                { text: "given", value: "C" },
                { text: "left", value: "D" }
            ],
            correct: "D",
            explanation: `
                <strong>ƒê√°p √°n D: left.</strong><br>
                C·∫•u tr√∫c: <em>be left homeless</em>: b·ªã r∆°i v√†o c·∫£nh m√†n tr·ªùi chi·∫øu ƒë·∫•t/v√¥ gia c∆∞.<br>
                D·ªãch: Sau tr·∫≠n l·ª•t, nhi·ªÅu ng∆∞·ªùi trong l√†ng ƒë√£ b·ªã m·∫•t nh√† c·ª≠a.
            `
        },
        {
            id: 12,
            text: "Bin: ‚Äò How about collecting more waste for recycling?‚Äù ‚Äì Lena: ‚Äú _____‚Äù",
            options: [
                { text: "That sounds terrible", value: "A" },
                { text: "I can agree with you more", value: "B" },
                { text: "Yeah, I beg in you", value: "C" },
                { text: "That‚Äôs a good idea.", value: "D" }
            ],
            correct: "D",
            explanation: `
                <strong>ƒê√°p √°n D: That‚Äôs a good idea.</strong><br>
                C√¢u h·ªèi l√† m·ªôt l·ªùi g·ª£i √Ω (Suggestion) "How about...".<br>
                ƒê√°p l·∫°i ƒë·ªìng √Ω l·ªãch s·ª± nh·∫•t l√† "That's a good idea".<br>
                L∆∞u √Ω: C√¢u B sai ng·ªØ ph√°p, ƒë√∫ng ph·∫£i l√† "I <strong>couldn't</strong> agree with you more" (T√¥i ho√†n to√†n ƒë·ªìng √Ω).
            `
        },
        // --- GAP FILL 13-16 ---
        {
            id: 13,
            isGapFill: true,
            context: `
                <div class="data-box">
                    <h3>ANNOUNCEMENT: SUPPORT WORKER</h3>
                    <p>Do you have the ability to care for others? Can you understand how older people feel? Are you good (13) ____ communication? Do you have good listening skills?</p>
                    <p>If you have answered YES to (14) _____ questions above, we would like to hear from you:</p>
                    <ul>
                        <li>Starting rate of $ 8 per hour</li>
                        <li>Free uniform</li>
                        <li>Excellent training</li>
                    </ul>
                    <p>For further (15) _____, you can contact:</p>
                    <p>Email: supportworker@gmail.com<br>
                    Phone manager (16) ____ 01234567789</p>
                </div>
            `,
            text: "Question 13:",
            options: [
                { text: "for", value: "A" },
                { text: "with", value: "B" },
                { text: "in", value: "C" },
                { text: "at", value: "D" }
            ],
            correct: "D",
            explanation: `<strong>ƒê√°p √°n D: at.</strong><br>C·∫•u tr√∫c: <em>Good at something</em> (Gi·ªèi v·ªÅ c√°i g√¨).`
        },
        {
            id: 14,
            isGapFill: false, // Same context already shown usually, but for single file layout, I'll repeat context or just show question if simple. I'll group context visually. 
            // Better strategy: Just show context once? No, user needs to see it. I will keep it simple: Show Question.
            text: "Question 14 (Refer to announcement above):",
            options: [
                { text: "the", value: "A" },
                { text: "a", value: "B" },
                { text: "an", value: "C" },
                { text: "X", value: "D" }
            ],
            correct: "A",
            explanation: `<strong>ƒê√°p √°n A: the.</strong><br>"the questions above" x√°c ƒë·ªãnh c·ª• th·ªÉ l√† nh·ªØng c√¢u h·ªèi ƒë√£ li·ªát k√™ ph√≠a tr√™n.`
        },
        {
            id: 15,
            text: "Question 15 (Refer to announcement above):",
            options: [
                { text: "inform", value: "A" },
                { text: "information", value: "B" },
                { text: "informative", value: "C" },
                { text: "informatively", value: "D" }
            ],
            correct: "B",
            explanation: `<strong>ƒê√°p √°n B: information.</strong><br>Sau "For further" c·∫ßn m·ªôt Danh t·ª´. "Further information" (Th√™m th√¥ng tin).`
        },
        {
            id: 16,
            text: "Question 16 (Refer to announcement above):",
            options: [
                { text: "on", value: "A" },
                { text: "in", value: "B" },
                { text: "at", value: "C" },
                { text: "from", value: "D" }
            ],
            correct: "C",
            explanation: `<strong>ƒê√°p √°n C: at.</strong> (ho·∫∑c A: on).<br>Trong ti·∫øng Anh th∆∞∆°ng m·∫°i, "Contact someone AT [phone number]" ho·∫∑c "ON [phone number]" ƒë·ªÅu d√πng ƒë∆∞·ª£c. Tuy nhi√™n, "at" ph·ªï bi·∫øn khi ch·ªâ ƒë·ªãa ch·ªâ li√™n l·∫°c c·ª• th·ªÉ.`
        },
        // --- SENTENCE ARRANGEMENT ---
        {
            id: 17,
            text: "Mark the letter A, B, C or D to indicate the correct arrangement of the sentences to make a meaningful letter/paragraph.",
            context: `
                <div class="data-box">
                    <p>a. Finally, enjoy special discounts and early access to new products as a VIP member</p>
                    <p>b. Hi, John! Thank you for being a VIP member of our tech store.</p>
                    <p>c. We are grateful for your support and loyalty to our brand.</p>
                    <p>d. As a VIP, you will get special offers and invites to special events</p>
                    <p>e. We look forward to helping you and giving you the best tech experiences.</p>
                </div>
            `,
            options: [
                { text: "b-c-d-e-a", value: "A" },
                { text: "b-d-c-e-a", value: "B" },
                { text: "b-c-d-a-e", value: "C" },
                { text: "b-e-d-a-c", value: "D" }
            ],
            correct: "C",
            explanation: `
                <strong>ƒê√°p √°n C: b-c-d-a-e.</strong><br>
                Logic:
                1. (b) Ch√†o h·ªèi v√† c·∫£m ∆°n.
                2. (c) B√†y t·ªè l√≤ng bi·∫øt ∆°n (n·ªëi ti·∫øp b).
                3. (d) Gi·ªõi thi·ªáu quy·ªÅn l·ª£i chung.
                4. (a) Gi·ªõi thi·ªáu quy·ªÅn l·ª£i cu·ªëi c√πng ("Finally").
                5. (e) K·∫øt th∆∞ ("We look forward...").
            `
        },
        {
            id: 18,
            text: "Mark the letter A, B, C or D to indicate the correct arrangement.",
            context: `
                <div class="data-box">
                    <p>a. Next, look at different jobs and see which one fits your skills and interests.</p>
                    <p>b. Finally, make sure to learn about the job market to find out if there are many opportunites.</p>
                    <p>c. Choosing a job is very important and can change your life</p>
                    <p>d. First, think about what you like to do and what you are good at.</p>
                </div>
            `,
            options: [
                { text: "d-c-a-b", value: "A" },
                { text: "c-d-a-b", value: "B" },
                { text: "c-d-b-a", value: "C" },
                { text: "d-c-b-a", value: "D" }
            ],
            correct: "B",
            explanation: `
                <strong>ƒê√°p √°n B: c-d-a-b.</strong><br>
                Logic:
                1. (c) C√¢u ch·ªß ƒë·ªÅ (Topic sentence): Ch·ªçn ngh·ªÅ r·∫•t quan tr·ªçng.
                2. (d) B∆∞·ªõc 1 ("First").
                3. (a) B∆∞·ªõc 2 ("Next").
                4. (b) B∆∞·ªõc cu·ªëi ("Finally").
            `
        },
        // --- CLOZE TEXT (TORNADOES) ---
        {
            id: 19,
            isGapFill: true,
            context: `
                <div class="data-box">
                    <h3>TORNADOES</h3>
                    <p>Tornadoes are storms with very (19) _____ turning winds and dark clouds. These winds are perhaps the strongest on (20) _____. They reach speeds of 300 miles per hour. The dark clouds are shaped like a funnel ‚Äì wide at the top and narrow at the bottom. The winds are strongest in (21) _____centre of the tunnel. Tornadoes are especially common in the US, but only in certain parts. They occur mainly in the (22) ____ states.</p>
                    <p>A hot afternoon in the spring is the most likely time for a tornado. (23) ____ become dark. There is thunder, lightning and rain. A cloud forms a funnel and begins to twist. The funnel moves faster and faster. The faster the winds, the louder the noise. Tornadoes always move in a northeastern (24) _____. They never last longer than eight hours.</p>
                </div>
            `,
            text: "Question 19:",
            options: [
                { text: "angry", value: "A" },
                { text: "weak", value: "B" },
                { text: "cruel", value: "C" },
                { text: "strong", value: "D" }
            ],
            correct: "D",
            explanation: `<strong>ƒê√°p √°n D: strong.</strong><br>Gi√≥ l·ªëc xo√°y r·∫•t m·∫°nh (strong winds).`
        },
        {
            id: 20,
            text: "Question 20:",
            options: [
                { text: "space", value: "A" },
                { text: "earth", value: "B" },
                { text: "ground", value: "C" },
                { text: "planet", value: "D" }
            ],
            correct: "B",
            explanation: `<strong>ƒê√°p √°n B: earth.</strong><br>C·ª•m t·ª´ "on earth" (tr√™n tr√°i ƒë·∫•t).`
        },
        {
            id: 21,
            text: "Question 21:",
            options: [
                { text: "the", value: "A" },
                { text: "that", value: "B" },
                { text: "this", value: "C" },
                { text: "a", value: "D" }
            ],
            correct: "A",
            explanation: `<strong>ƒê√°p √°n A: the.</strong><br>"In the centre" (·ªû trung t√¢m) - x√°c ƒë·ªãnh duy nh·∫•t.`
        },
        {
            id: 22,
            text: "Question 22:",
            options: [
                { text: "unknown", value: "A" },
                { text: "central", value: "B" },
                { text: "foreign", value: "C" },
                { text: "farther", value: "D" }
            ],
            correct: "B",
            explanation: `<strong>ƒê√°p √°n B: central.</strong><br>L·ªëc xo√°y x·∫£y ra ch·ªß y·∫øu ·ªü c√°c bang mi·ªÅn Trung n∆∞·ªõc M·ªπ (Central states - Tornado Alley).`
        },
        {
            id: 23,
            text: "Question 23:",
            options: [
                { text: "sun", value: "A" },
                { text: "sky", value: "B" },
                { text: "clouds", value: "C" },
                { text: "winds", value: "D" }
            ],
            correct: "C",
            explanation: `<strong>ƒê√°p √°n C: clouds.</strong><br>M√¢y tr·ªü n√™n ƒëen k·ªãt (Clouds become dark). Ng·ªØ c·∫£nh m√¥ t·∫£ b·∫ßu tr·ªùi tr∆∞·ªõc b√£o.`
        },
        {
            id: 24,
            text: "Question 24:",
            options: [
                { text: "direct", value: "A" },
                { text: "direction", value: "B" },
                { text: "directly", value: "C" },
                { text: "directing", value: "D" }
            ],
            correct: "B",
            explanation: `<strong>ƒê√°p √°n B: direction.</strong><br>C·∫ßn danh t·ª´ sau t√≠nh t·ª´ "northeastern". Di chuy·ªÉn theo h∆∞·ªõng ƒë√¥ng b·∫Øc.`
        },
        // --- CLOSEST MEANING SENTENCE ---
        {
            id: 25,
            text: "Question 25: At 8 pm yesterday, I was drawing pictures in my room and Lan was watching her films.",
            options: [
                { text: "When I was drawing pictures in my room, Lan watched her films at 8 pm yesterday", value: "A" },
                { text: "While I was drawing pictures in my room, Lan was watching her films at 8 pm yesterday", value: "B" },
                { text: "At 8 pm yesterday, I drew pictures in my room and Lan watched her films", value: "C" },
                { text: "I drew pictures in my room while Lan was watching her films at 8 pm yesterday.", value: "D" }
            ],
            correct: "B",
            explanation: `
                <strong>ƒê√°p √°n B ƒë√∫ng.</strong><br>
                C√¢u g·ªëc d√πng th√¨ Qu√° kh·ª© ti·∫øp di·ªÖn cho 2 h√†nh ƒë·ªông x·∫£y ra song song: "I was drawing... and Lan was watching...".<br>
                C·∫•u tr√∫c t∆∞∆°ng ƒë∆∞∆°ng: <em>While S + was/were Ving, S + was/were Ving.</em>
            `
        },
        {
            id: 26,
            text: "Question 26: Last night, I was sleeping. I heard a strange noise from the kitchen.",
            options: [
                { text: "Last night, I was sleeping, I was hearing a strange noise from the kitchen.", value: "A" },
                { text: "Last night, while I was sleeping, I hear a strange noise from the kitchen", value: "B" },
                { text: "Last night, when I was slept, I heard a strange noise from the kitchen", value: "C" },
                { text: "Last night, while I was sleeping, I heard a strange noise from the kitchen.", value: "D" }
            ],
            correct: "D",
            explanation: `
                <strong>ƒê√°p √°n D ƒë√∫ng.</strong><br>
                H√†nh ƒë·ªông ƒëang x·∫£y ra (sleeping - QKTD) th√¨ h√†nh ƒë·ªông kh√°c chen v√†o (heard - QKƒê).<br>
                C·∫•u tr√∫c: <em>While + QKTD, + QKƒê.</em>
            `
        },
        // --- SENTENCE BUILDING ---
        {
            id: 27,
            text: "Question 27: All / natural disaster / cause / damage / and destruction / humans.",
            options: [
                { text: "All natural disasters cause damage and destruction for humans.", value: "A" },
                { text: "All natural disaster cause damage and destruction to humans.", value: "B" },
                { text: "All natural disasters cause damage and destruction to humans.", value: "C" },
                { text: "All natural disasters cause damage and destruction with humans.", value: "D" }
            ],
            correct: "C",
            explanation: `
                <strong>ƒê√°p √°n C ƒë√∫ng.</strong><br>
                - "All natural disasters" (s·ªë nhi·ªÅu).<br>
                - C·ª•m t·ª´ "damage to sb/sth" (g√¢y thi·ªát h·∫°i cho ai/c√°i g√¨).<br>
                - C√¢u B sai "disaster" s·ªë √≠t m√† ƒë·ªông t·ª´ "cause" nguy√™n th·ªÉ.
            `
        },
        {
            id: 28,
            text: "Question 28: most / common type / natural disasters / the world / are / floods and storms.",
            options: [
                { text: "The most common types of natural disasters in the world are floods and storms.", value: "A" },
                { text: "The most common type of natural disasters in the world are floods and storms.", value: "B" },
                { text: "The most common types of natural disasters on the world are floods and storms.", value: "C" },
                { text: "The most common type of natural disasters of the world are floods and storms.", value: "D" }
            ],
            correct: "A",
            explanation: `
                <strong>ƒê√°p √°n A ƒë√∫ng.</strong><br>
                - ƒê·ªông t·ª´ l√† "are" n√™n ch·ªß ng·ªØ ph·∫£i s·ªë nhi·ªÅu "types". (Lo·∫°i B, D).<br>
                - Gi·ªõi t·ª´ "in the world" (tr√™n th·∫ø gi·ªõi). (Lo·∫°i C d√πng "on").
            `
        },
        // --- SIGNS ---
        {
            id: 29,
            text: "Question 29. What does the sign mean?",
            context: `
                <div class="sign-container">
                    <div class="sign-img">
                        <div class="sign-icon-circle">
                            <span style="color:black; font-size: 2rem;">üçîü•§</span>
                        </div>
                        <div class="sign-text">NO FOOD<br>OR<br>DRINK</div>
                    </div>
                </div>
            `,
            options: [
                { text: "You are allowed to eat and drink here without any restrictions.", value: "A" },
                { text: "Eating and drinking are not permitted in this area at all times.", value: "B" },
                { text: "You can bring drinks but not food into this area.", value: "C" },
                { text: "Food is permitted but drinks are not allowed in this area.", value: "D" }
            ],
            correct: "B",
            explanation: `<strong>ƒê√°p √°n B.</strong><br>Bi·ªÉn b√°o "NO FOOD OR DRINK" c√≥ nghƒ©a l√† kh√¥ng ƒë∆∞·ª£c ph√©p ƒÉn v√† u·ªëng.`
        },
        {
            id: 30,
            text: "Question 30. What does the notice say?",
            context: `
                <div class="notice-box">
                    The library will be closed on Sunday for cleaning. It will open again on Monday morning.
                </div>
            `,
            options: [
                { text: "The library will be open on Sunday for cleaning", value: "A" },
                { text: "The library will be closed on Sunday and open again on Monday.", value: "B" },
                { text: "The library will close early on Sunday for cleaning.", value: "C" },
                { text: "The library will be closed all weekend.", value: "D" }
            ],
            correct: "B",
            explanation: `
                <strong>ƒê√°p √°n B ƒë√∫ng.</strong><br>
                Th√¥ng b√°o n√≥i: Th∆∞ vi·ªán ƒë√≥ng c·ª≠a Ch·ªß Nh·∫≠t ƒë·ªÉ d·ªçn d·∫πp v√† m·ªü l·∫°i v√†o s√°ng Th·ª© Hai.
            `
        },
        // --- READING COMPREHENSION (KATRINA) ---
        {
            id: 31,
            isGapFill: true, // Using this style for reading passage layout
            context: `
                <div class="data-box">
                    <h3>HURRICANE KATRINA</h3>
                    <p>At the top of the list of the costliest natural disasters in the history of the United States is Hurricane Katrina. Hurricane Katrina was the third strongest hurricane ever to hit the U. S. It affected 90,000 square miles in Louisiana, Mississippi, Florida, and Alabama. The hurricane formed over the Bahamas and turned into a Category 1 hurricane by the time it hit the southeastern tip of Florida. It got stronger as it traveled across the Gulf of Mexico. It made its second landfall off the coast of southeast Louisiana on Monday, August 29, 2005. It had become a category 4 hurricane by then. The storm surge that followed caused destruction from central Florida to Texas. New Orleans, Louisiana, experienced even more damage because its levees were breeched, letting water flood a large portion of the city. The National Weather Service warned people of the tropical monster that was heading towards the southern coast. Residents were told to expect power outages. They were told they might lose their rooftops and to expect water shortages. The National Hurricane Director was very concerned. He personally called the governors of Louisiana and Mississippi. He even called President Bush at his ranch in Texas. He spoke directly with New Orleans mayor Ray Nagin. Nagin issued an evacuation order for his city. Most people left. About eighty percent of the population evacuated. The estimate was that around 100,000 people remained in the metro area. Some were stranded tourists; others did not own a car and had no way out. Those who were not able to leave were instructed to go to the New Orleans Convention Center and the Superdome.</p>
                </div>
            `,
            text: "Question 31. What is the passage mainly about?",
            options: [
                { text: "The history of the United Sates hurricanes", value: "A" },
                { text: "A hurricane in the history of the United States", value: "B" },
                { text: "Hurricanes in the world, especially in the United States.", value: "C" },
                { text: "What the United States does to prevent hurricanes", value: "D" }
            ],
            correct: "B",
            explanation: `<strong>ƒê√°p √°n B.</strong><br>B√†i ƒë·ªçc t·∫≠p trung k·ªÉ v·ªÅ c∆°n b√£o c·ª• th·ªÉ l√† Katrina trong l·ªãch s·ª≠ M·ªπ, kh√¥ng ph·∫£i l·ªãch s·ª≠ t·∫•t c·∫£ c√°c c∆°n b√£o.`
        },
        {
            id: 32,
            text: "Question 32: According to the passage, what is NOT TRUE about hurricance Katrina?",
            options: [
                { text: "It is the costliest natural disaster in the history of the US", value: "A" },
                { text: "It is the third strongest hurricane ever to hit the US", value: "B" },
                { text: "It affected 90,000 square miles in Louisiana, Mississippu Florida, Alabama.", value: "C" },
                { text: "It formed over the Bahamas", value: "D" }
            ],
            correct: "C",
            explanation: `
                <strong>ƒê√°p √°n C.</strong><br>
                M·∫∑c d√π th√¥ng tin v·ªÅ di·ªán t√≠ch 90,000 d·∫∑m vu√¥ng l√† ƒë√∫ng, nh∆∞ng trong ƒë√°p √°n C c√≥ l·ªói ch√≠nh t·∫£ ƒë·ªãa danh ("Mississippu") v√† li·ªát k√™ thi·∫øu li√™n t·ª´ so v·ªõi vƒÉn b·∫£n g·ªëc. ƒê√¢y th∆∞·ªùng l√† d·∫•u hi·ªáu c·ªßa ƒë√°p √°n "Not True" trong c√°c b√†i thi tr·∫Øc nghi·ªám khi c√°c ph∆∞∆°ng √°n kh√°c ƒë·ªÅu tr√≠ch d·∫´n ch√≠nh x√°c t·ª´ng t·ª´ trong b√†i.
            `
        },
        {
            id: 33,
            text: "Question 33: What can be true from the passage about Hurricane Katrina when it hit the southeastern tip of Florida?",
            options: [
                { text: "It was very weak", value: "A" },
                { text: "It was very strong", value: "B" },
                { text: "It was not as weak as it started", value: "C" },
                { text: "It was not as strong as it started", value: "D" }
            ],
            correct: "A",
            explanation: `
                <strong>ƒê√°p √°n A: It was very weak.</strong><br>
                Gi·∫£i th√≠ch: B√†i ƒë·ªçc n√≥i "turned into a Category 1 hurricane... It got stronger as it traveled... become a category 4".<br>
                Khi ·ªü Florida (Category 1) n√≥ y·∫øu h∆°n r·∫•t nhi·ªÅu so v·ªõi khi ƒë·ªï b·ªô l·∫ßn 2 (Category 4 - "tropical monster"). Trong thang b√£o, C·∫•p 1 l√† c·∫•p th·∫•p nh·∫•t. ƒê√°p √°n A h·ª£p l√Ω nh·∫•t trong ng·ªØ c·∫£nh so s√°nh s·ª± ph√°t tri·ªÉn s·ª©c m·∫°nh c·ªßa b√£o.
            `
        },
        {
            id: 34,
            text: "Question 34: What is NOT TRUE about the National Hurricane Director?",
            options: [
                { text: "He called the governor of Mississppi.", value: "A" },
                { text: "He called President Bush at his ranch in Texas", value: "B" },
                { text: "He spoke directly with the New Orleans mayor.", value: "C" },
                { text: "He was very unconcerned.", value: "D" }
            ],
            correct: "D",
            explanation: `
                <strong>ƒê√°p √°n D.</strong><br>
                B√†i ƒë·ªçc ghi r√µ: "The National Hurricane Director was very <strong>concerned</strong>" (√îng ·∫•y r·∫•t lo l·∫Øng). ƒê√°p √°n D n√≥i "unconcerned" (v√¥ t√¢m/kh√¥ng lo l·∫Øng) l√† sai.
            `
        },
        {
            id: 35,
            text: "Question 35: Which word has the closest meaning to 'evacuated' as used in the passage?",
            options: [
                { text: "Stayed", value: "A" },
                { text: "left", value: "B" },
                { text: "returned", value: "C" },
                { text: "arrived", value: "D" }
            ],
            correct: "B",
            explanation: `
                <strong>ƒê√°p √°n B: left.</strong><br>
                Evacuated (s∆° t√°n) ƒë·ªìng nghƒ©a v·ªõi Left (r·ªùi ƒëi) kh·ªèi khu v·ª±c nguy hi·ªÉm.
            `
        },
        {
            id: 36,
            text: "Question 36: Which word is the opposite of 'strongest' as used in the passage?",
            options: [
                { text: "Weakest", value: "A" },
                { text: "Fastest", value: "B" },
                { text: "Tallest", value: "C" },
                { text: "Smallest", value: "D" }
            ],
            correct: "A",
            explanation: `
                <strong>ƒê√°p √°n A: Weakest.</strong><br>
                Tr√°i nghƒ©a v·ªõi Strongest (M·∫°nh nh·∫•t) l√† Weakest (Y·∫øu nh·∫•t).
            `
        },
        // --- GAP FILL SENTENCES (37-40) ---
        {
            id: 37,
            isGapFill: true,
            context: `
                <div class="data-box">
                    <h3>STORMS IN VIET NAM</h3>
                    <div class="gap-fill-options">
                        A - and the storm season lasts from June to November<br>
                        B - people usually do not leave their homes right away<br>
                        C - They also prepare some food and drinks in case they cannot go out.<br>
                        D - They also stay away from broken power lines.
                    </div>
                    <p>A storm is a natural disaster that often happens in Viet Nam. It happens every year, (37) ______. Before a storm, people usually strengthen their homes and bring in outdoor things like flowerpots or rubbish bins. (38) ______. After the storm, (39)______. They listen to important instructions from local authorities to know which parts of their area are dangerous and should be avoided. (40)_______.</p>
                </div>
            `,
            text: "Question 37",
            options: [
                { text: "A", value: "A" },
                { text: "B", value: "B" },
                { text: "C", value: "C" },
                { text: "D", value: "D" }
            ],
            correct: "A",
            explanation: `
                <strong>ƒê√°p √°n A.</strong><br>
                C√¢u tr∆∞·ªõc n√≥i "It happens every year" (N√≥ x·∫£y ra h√†ng nƒÉm), v·∫ø sau b·ªï sung th√¥ng tin v·ªÅ th·ªùi gian: "and the storm season lasts from June to November" (v√† m√πa b√£o k√©o d√†i t·ª´ th√°ng 6 ƒë·∫øn th√°ng 11).
            `
        },
        {
            id: 38,
            text: "Question 38",
            options: [
                { text: "A", value: "A" },
                { text: "B", value: "B" },
                { text: "C", value: "C" },
                { text: "D", value: "D" }
            ],
            correct: "C",
            explanation: `
                <strong>ƒê√°p √°n C.</strong><br>
                ƒêo·∫°n vƒÉn ƒëang n√≥i v·ªÅ vi·ªác chu·∫©n b·ªã tr∆∞·ªõc b√£o ("Before a storm"). C√¢u C "They also prepare some food..." (H·ªç c≈©ng chu·∫©n b·ªã th·ª©c ƒÉn...) ph√π h·ª£p v·ªõi ng·ªØ c·∫£nh chu·∫©n b·ªã.
            `
        },
        {
            id: 39,
            text: "Question 39",
            options: [
                { text: "A", value: "A" },
                { text: "B", value: "B" },
                { text: "C", value: "C" },
                { text: "D", value: "D" }
            ],
            correct: "B",
            explanation: `
                <strong>ƒê√°p √°n B.</strong><br>
                C√¢u n√†y n√≥i v·ªÅ "After the storm" (Sau b√£o). C√¢u B "people usually do not leave their homes right away" (m·ªçi ng∆∞·ªùi th∆∞·ªùng kh√¥ng r·ªùi nh√† ngay l·∫≠p t·ª©c) l√† l·ªùi khuy√™n an to√†n h·ª£p l√Ω ngay sau b√£o.
            `
        },
        {
            id: 40,
            text: "Question 40",
            options: [
                { text: "A", value: "A" },
                { text: "B", value: "B" },
                { text: "C", value: "C" },
                { text: "D", value: "D" }
            ],
            correct: "D",
            explanation: `
                <strong>ƒê√°p √°n D.</strong><br>
                C√¢u tr∆∞·ªõc n√≥i v·ªÅ c√°c khu v·ª±c nguy hi·ªÉm. C√¢u D "They also stay away from broken power lines" (H·ªç c≈©ng tr√°nh xa ƒë∆∞·ªùng d√¢y ƒëi·ªán b·ªã ƒë·ª©t) l√† m·ªôt v√≠ d·ª• c·ª• th·ªÉ v·ªÅ m·ªëi nguy hi·ªÉm c·∫ßn tr√°nh.
            `
        }
    ];

    function renderQuiz() {
        const container = document.getElementById('quiz-container');
        
        questions.forEach((q, index) => {
            const card = document.createElement('div');
            card.className = 'card';
            card.id = `card-${index}`;

            let html = '';
            
            // Add Context (Reading text) if it exists
            if (q.context) {
                html += q.context;
            }

            // Question Text
            html += `<span class="question-number">Question ${q.id}</span>`;
            html += `<div class="question-text">${q.text}</div>`;

            // Options
            html += `<div class="options-group">`;
            q.options.forEach(opt => {
                html += `
                    <label class="option-label" id="label-${index}-${opt.value}">
                        <input type="radio" name="q${index}" value="${opt.value}" onchange="resetExplanation(${index})">
                        <span><strong>${opt.value}.</strong> ${opt.text}</span>
                    </label>
                `;
            });
            html += `</div>`;

            // Check Button
            html += `<button class="btn-check" onclick="checkAnswer(${index})">Ki·ªÉm tra ƒë√°p √°n</button>`;

            // Explanation Div
            html += `<div class="explanation" id="exp-${index}">
                        ${q.explanation}
                     </div>`;

            card.innerHTML = html;
            container.appendChild(card);
        });
    }

    function resetExplanation(index) {
        // Hide explanation if user changes answer before checking (optional UI choice)
        // document.getElementById(`exp-${index}`).style.display = 'none';
        // Reset colors
        const labels = document.querySelectorAll(`#card-${index} .option-label`);
        labels.forEach(l => {
            l.classList.remove('correct-answer', 'wrong-answer');
        });
    }

    function checkAnswer(index) {
        const q = questions[index];
        const selected = document.querySelector(`input[name="q${index}"]:checked`);
        const expDiv = document.getElementById(`exp-${index}`);
        
        if (!selected) {
            alert("Vui l√≤ng ch·ªçn m·ªôt ƒë√°p √°n tr∆∞·ªõc!");
            return;
        }

        const userVal = selected.value;
        const labels = document.querySelectorAll(`#card-${index} .option-label`);
        
        // Reset styles
        labels.forEach(l => l.classList.remove('correct-answer', 'wrong-answer'));

        // Highlight selected
        const selectedLabel = document.getElementById(`label-${index}-${userVal}`);
        
        if (userVal === q.correct) {
            selectedLabel.classList.add('correct-answer');
        } else {
            selectedLabel.classList.add('wrong-answer');
            // Show correct one
            document.getElementById(`label-${index}-${q.correct}`).classList.add('correct-answer');
        }

        // Show Explanation
        expDiv.style.display = 'block';
    }

    function submitAll() {
        let score = 0;
        let unanswered = 0;

        questions.forEach((q, index) => {
            const selected = document.querySelector(`input[name="q${index}"]:checked`);
            const card = document.getElementById(`card-${index}`);
            
            // Trigger check for visual feedback
            if (selected) {
                checkAnswer(index);
                if (selected.value === q.correct) {
                    score++;
                }
            } else {
                unanswered++;
                card.classList.add('unanswered-warning');
                // Auto show explanation for unanswered
                document.getElementById(`label-${index}-${q.correct}`).classList.add('correct-answer');
                document.getElementById(`exp-${index}`).style.display = 'block';
            }
        });

        // Show Popup
        const overlay = document.getElementById('resultOverlay');
        const scoreDisplay = document.getElementById('scoreDisplay');
        const scoreMessage = document.getElementById('scoreMessage');
        
        scoreDisplay.innerText = `${score}/${questions.length}`;
        
        if (score === questions.length) {
            scoreMessage.innerText = "Tuy·ªát v·ªùi! B·∫°n ƒë√£ l√†m ƒë√∫ng t·∫•t c·∫£!";
        } else if (score > questions.length * 0.8) {
            scoreMessage.innerText = "L√†m t·ªët l·∫Øm! B·∫°n n·∫Øm r·∫•t ch·∫Øc ki·∫øn th·ª©c.";
        } else {
            scoreMessage.innerText = `B·∫°n c√≤n ${unanswered > 0 ? unanswered + ' c√¢u ch∆∞a l√†m v√† ' : ''} m·ªôt s·ªë l·ªói sai. H√£y xem l·∫°i l·ªùi gi·∫£i chi ti·∫øt nh√©!`;
        }

        overlay.style.display = 'flex';
    }

    function closePopup() {
        document.getElementById('resultOverlay').style.display = 'none';
        // Scroll to top
        window.scrollTo({ top: 0, behavior: 'smooth' });
    }

    // Initialize
    renderQuiz();

</script>

</body>
</html>