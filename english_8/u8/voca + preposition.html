<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>B√†i T·∫≠p T·ª´ V·ª±ng & Gi·ªõi T·ª´ - Ms Mai An ULIS</title>
    <!-- Google Fonts: Nunito & Quicksand -->
    <link href="https://fonts.googleapis.com/css2?family=Nunito:wght@400;600;700;800&family=Quicksand:wght@500;700&display=swap" rel="stylesheet">
    <!-- Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>
    <!-- Confetti JS -->
    <script src="https://cdn.jsdelivr.net/npm/canvas-confetti@1.6.0/dist/confetti.browser.min.js"></script>
    
    <script>
        tailwind.config = {
            theme: {
                extend: {
                    fontFamily: {
                        sans: ['Nunito', 'sans-serif'],
                        display: ['Quicksand', 'sans-serif'],
                    },
                    colors: {
                        primary: '#8854C0',    /* T√≠m Pastel */
                        secondary: '#00C9A7',  /* Xanh Ng·ªçc */
                        accent: '#FFD700',     /* V√†ng */
                        correct: '#00D26A',    /* Xanh l√° Blooket */
                        wrong: '#FF4757',      /* ƒê·ªè cam Blooket */
                        bgPattern: '#F0F3F9',
                    },
                    boxShadow: {
                        '3d': '0 6px 0px rgba(0,0,0,0.2)',
                        '3d-hover': '0 4px 0px rgba(0,0,0,0.2)',
                        '3d-active': '0 0px 0px rgba(0,0,0,0.2)',
                        'card': '0 10px 25px -5px rgba(0, 0, 0, 0.1), 0 8px 10px -6px rgba(0, 0, 0, 0.1)',
                    }
                }
            }
        }
    </script>

    <style>
        body {
            background-color: #8854C0;
            background-image: radial-gradient(#9B6FD8 2px, transparent 2px), radial-gradient(#9B6FD8 2px, transparent 2px);
            background-size: 40px 40px;
            background-position: 0 0, 20px 20px;
            font-family: 'Nunito', sans-serif;
            overflow-x: hidden;
        }

        .card-container {
            background: rgba(255, 255, 255, 0.95);
            backdrop-filter: blur(10px);
            border-radius: 24px;
            border: 4px solid #fff;
        }

        /* 3D Button Styles */
        .btn-option {
            transition: all 0.1s ease;
            position: relative;
            top: 0;
            cursor: pointer;
            border-bottom: 6px solid rgba(0,0,0,0.15);
        }

        .btn-option:hover:not(:disabled) {
            transform: translateY(-2px);
            filter: brightness(105%);
        }

        .btn-option:active:not(:disabled) {
            transform: translateY(4px);
            border-bottom-width: 0px;
            box-shadow: none;
        }

        /* Status Styles */
        .status-correct {
            background-color: #00D26A !important;
            color: white !important;
            border-color: #00B25A !important;
            border-bottom-color: #008f48 !important;
        }

        .status-wrong {
            background-color: #FF4757 !important;
            color: white !important;
            border-color: #FF2E40 !important;
            border-bottom-color: #d6303e !important;
        }

        .status-disabled {
            opacity: 0.6;
            cursor: not-allowed !important;
        }

        /* Animation */
        @keyframes shake {
            0% { transform: translateX(0); }
            25% { transform: translateX(-5px) rotate(-5deg); }
            50% { transform: translateX(5px) rotate(5deg); }
            75% { transform: translateX(-5px) rotate(-5deg); }
            100% { transform: translateX(0); }
        }

        .shake-element {
            animation: shake 0.4s ease-in-out;
        }

        .explanation-box {
            display: none;
            animation: slideDown 0.5s ease-out forwards;
        }

        @keyframes slideDown {
            from { opacity: 0; transform: translateY(-20px); }
            to { opacity: 1; transform: translateY(0); }
        }

        /* Custom Scrollbar */
        ::-webkit-scrollbar {
            width: 10px;
        }
        ::-webkit-scrollbar-track {
            background: #f1f1f1;
            border-radius: 10px;
        }
        ::-webkit-scrollbar-thumb {
            background: #8854C0;
            border-radius: 10px;
        }
        ::-webkit-scrollbar-thumb:hover {
            background: #6c429c;
        }
    </style>
</head>
<body class="min-h-screen py-10 px-4 flex flex-col items-center">

    <!-- Header -->
    <header class="text-center mb-10 relative z-10 w-full max-w-4xl">
        <div class="bg-white rounded-3xl p-4 shadow-card border-b-8 border-purple-200 inline-block">
            <h1 class="text-2xl md:text-4xl font-extrabold text-primary font-display uppercase tracking-wider">
                B√†i T·∫≠p T·ª´ V·ª±ng & Gi·ªõi T·ª´
            </h1>
            <p class="text-gray-500 font-bold mt-2 text-lg">Gi√°o vi√™n: Ms Mai An ULIS üë©‚Äçüè´</p>
        </div>
    </header>

    <!-- Progress Bar -->
    <div class="w-full max-w-4xl mb-6 bg-purple-900/30 rounded-full h-6 p-1 relative overflow-hidden">
        <div id="progress-bar" class="bg-secondary h-full rounded-full transition-all duration-500 ease-out w-0 relative">
            <div class="absolute inset-0 bg-white/20 animate-pulse"></div>
        </div>
        <p id="progress-text" class="absolute top-0 w-full text-center text-white text-xs font-bold leading-6 drop-shadow-md">0/20 C√¢u</p>
    </div>

    <!-- Main Quiz Container -->
    <main id="quiz-container" class="w-full max-w-4xl flex flex-col gap-8">
        <!-- Content injected via JS -->
    </main>

    <!-- Summary Modal (Hidden by default) -->
    <div id="summary-modal" class="fixed inset-0 z-50 flex items-center justify-center bg-black/60 hidden backdrop-blur-sm">
        <div class="bg-white rounded-[30px] p-8 max-w-lg w-full text-center border-b-8 border-gray-200 shadow-2xl transform transition-all scale-100 relative overflow-hidden">
            <!-- Decorative header -->
            <div class="absolute top-0 left-0 w-full h-24 bg-primary opacity-10 rounded-t-[30px]"></div>
            
            <div class="relative z-10">
                <div class="w-24 h-24 bg-yellow-400 rounded-full mx-auto mb-6 flex items-center justify-center text-5xl shadow-lg border-4 border-white">
                    üèÜ
                </div>
                <h2 class="text-4xl font-extrabold text-primary mb-2 font-display">HO√ÄN TH√ÄNH!</h2>
                <p class="text-gray-500 font-bold text-lg mb-8">B·∫°n ƒë√£ l√†m r·∫•t t·ªët!</p>
                
                <div class="grid grid-cols-2 gap-4 mb-8">
                    <div class="bg-green-100 p-4 rounded-2xl border-b-4 border-green-200">
                        <p class="text-green-600 font-bold text-sm uppercase">ƒê√∫ng</p>
                        <p id="final-score" class="text-4xl font-black text-green-500">0</p>
                    </div>
                    <div class="bg-red-100 p-4 rounded-2xl border-b-4 border-red-200">
                        <p class="text-red-600 font-bold text-sm uppercase">Sai</p>
                        <p id="final-wrong" class="text-4xl font-black text-red-500">0</p>
                    </div>
                </div>

                <div id="feedback-message" class="text-xl font-bold text-purple-600 mb-8 italic"></div>

                <button onclick="location.reload()" class="w-full bg-secondary text-white font-extrabold text-xl py-4 rounded-2xl shadow-3d hover:translate-y-[-2px] active:translate-y-[4px] active:shadow-none transition-all uppercase tracking-wide">
                    L√†m L·∫°i B√†i
                </button>
            </div>
        </div>
    </div>

    <!-- Footer -->
    <footer class="mt-12 text-center text-white/80 font-bold text-sm">
        <p>Designed with ‚ù§Ô∏è by Ms Mai An</p>
    </footer>

    <!-- Audio Scripts (Web Audio API for simple sounds) -->
    <script>
        const audioCtx = new (window.AudioContext || window.webkitAudioContext)();

        function playCorrectSound() {
            const oscillator = audioCtx.createOscillator();
            const gainNode = audioCtx.createGain();
            oscillator.connect(gainNode);
            gainNode.connect(audioCtx.destination);
            
            oscillator.type = 'sine';
            oscillator.frequency.setValueAtTime(500, audioCtx.currentTime);
            oscillator.frequency.exponentialRampToValueAtTime(1000, audioCtx.currentTime + 0.1);
            
            gainNode.gain.setValueAtTime(0.3, audioCtx.currentTime);
            gainNode.gain.exponentialRampToValueAtTime(0.01, audioCtx.currentTime + 0.5);
            
            oscillator.start();
            oscillator.stop(audioCtx.currentTime + 0.5);
        }

        function playWrongSound() {
            const oscillator = audioCtx.createOscillator();
            const gainNode = audioCtx.createGain();
            oscillator.connect(gainNode);
            gainNode.connect(audioCtx.destination);
            
            oscillator.type = 'sawtooth';
            oscillator.frequency.setValueAtTime(150, audioCtx.currentTime);
            oscillator.frequency.linearRampToValueAtTime(100, audioCtx.currentTime + 0.3);
            
            gainNode.gain.setValueAtTime(0.3, audioCtx.currentTime);
            gainNode.gain.exponentialRampToValueAtTime(0.01, audioCtx.currentTime + 0.4);
            
            oscillator.start();
            oscillator.stop(audioCtx.currentTime + 0.4);
        }
    </script>

    <!-- Main Logic -->
    <script>
        // Data from User
        const quizData = {
          "questions": [
            {
              "questionNumber": 1,
              "question": "I ______________ the start of the class because my bus was late.",
              "answerOptions": [
                { "text": "lost", "rationale": "‚ùå Sai. 'Lose' d√πng cho m·∫•t ƒë·ªì v·∫≠t ho·∫∑c thua cu·ªôc.", "isCorrect": false },
                { "text": "missed", "rationale": "‚úÖ Ch√≠nh x√°c!\n\n1. Ph√¢n t√≠ch t·ª´ v·ª±ng:\n- A. lost (v): l√†m m·∫•t/thua\n- B. missed (v): b·ªè l·ª°/l·ª° (xe, bu·ªïi h·ªçc...)\n- C. passed (v): v∆∞·ª£t qua\n- D. failed (v): tr∆∞·ª£t/th·∫•t b·∫°i\n\n2. Gi·∫£i th√≠ch: D√πng 'miss' khi n√≥i v·ªÅ vi·ªác l·ª° m·ªôt s·ª± ki·ªán, ph∆∞∆°ng ti·ªán giao th√¥ng ho·∫∑c c∆° h·ªôi.\n\n3. D·ªãch c√¢u: T√¥i ƒë√£ b·ªè l·ª° ph·∫ßn ƒë·∫ßu c·ªßa bu·ªïi h·ªçc v√¨ xe bu√Ωt c·ªßa t√¥i ƒë·∫øn tr·ªÖ.", "isCorrect": true },
                { "text": "passed", "rationale": "‚ùå Sai nghƒ©a.", "isCorrect": false },
                { "text": "failed", "rationale": "‚ùå Sai nghƒ©a.", "isCorrect": false }
              ],
              "hint": "ƒê·ªông t·ª´ n√†y nghƒ©a l√† 'b·ªè l·ª°'."
            },
            {
              "questionNumber": 2,
              "question": "The company is ______________ with growers over the price of coffee.",
              "answerOptions": [
                { "text": "bargaining", "rationale": "‚úÖ Ch√≠nh x√°c!\n\n1. Ph√¢n t√≠ch t·ª´ v·ª±ng:\n- A. bargaining (v): m·∫∑c c·∫£/th∆∞∆°ng l∆∞·ª£ng\n- B. discussing (v): th·∫£o lu·∫≠n (th∆∞·ªùng kh√¥ng ƒëi v·ªõi 'with... over price' theo nghƒ©a gay g·∫Øt m·∫∑c c·∫£)\n- C. selling (v): b√°n\n- D. buying (v): mua\n\n2. Gi·∫£i th√≠ch: 'Bargain with someone over/for something' l√† c·∫•u tr√∫c th∆∞∆°ng l∆∞·ª£ng gi√° c·∫£.\n\n3. D·ªãch c√¢u: C√¥ng ty ƒëang th∆∞∆°ng l∆∞·ª£ng/m·∫∑c c·∫£ v·ªõi nh·ªØng ng∆∞·ªùi tr·ªìng tr·ªçt v·ªÅ gi√° c√† ph√™.", "isCorrect": true },
                { "text": "discussing", "rationale": "‚ùå 'Discuss' l√† ngo·∫°i ƒë·ªông t·ª´, th∆∞·ªùng n√≥i 'discuss something', √≠t khi d√πng 'discuss with' trong ng·ªØ c·∫£nh gi√° c·∫£ cƒÉng th·∫≥ng n√†y.", "isCorrect": false },
                { "text": "selling", "rationale": "‚ùå Sai ng·ªØ c·∫£nh.", "isCorrect": false },
                { "text": "buying", "rationale": "‚ùå Sai ng·ªØ c·∫£nh.", "isCorrect": false }
              ],
              "hint": "H√†nh ƒë·ªông th∆∞∆°ng l∆∞·ª£ng ƒë·ªÉ c√≥ gi√° t·ªët h∆°n."
            },
            {
              "questionNumber": 3,
              "question": "______________ a shopping list to prevent buying unnecessary things.",
              "answerOptions": [
                { "text": "Do", "rationale": "‚ùå Sai collocation (c·ª•m t·ª´ c·ªë ƒë·ªãnh).", "isCorrect": false },
                { "text": "Create", "rationale": "‚ùå Kh√¥ng sai v·ªÅ nghƒ©a nh∆∞ng trong b√†i t·∫≠p ƒëi·ªÅn t·ª´ n√†y, 'Make' l√† t·ª´ ph·ªï bi·∫øn nh·∫•t ƒëi v·ªõi 'list'.", "isCorrect": false },
                { "text": "Make", "rationale": "‚úÖ Ch√≠nh x√°c!\n\n1. Ph√¢n t√≠ch t·ª´ v·ª±ng:\n- A. Do (v): l√†m (h√†nh ƒë·ªông chung)\n- B. Create (v): t·∫°o ra\n- C. Make (v): l√†m/t·∫°o ra\n- D. Write (v): vi·∫øt\n\n2. Gi·∫£i th√≠ch: C·ª•m t·ª´ c·ªë ƒë·ªãnh 'Make a list' (L·∫≠p danh s√°ch).\n\n3. D·ªãch c√¢u: H√£y l·∫≠p m·ªôt danh s√°ch mua s·∫Øm ƒë·ªÉ tr√°nh mua nh·ªØng th·ª© kh√¥ng c·∫ßn thi·∫øt.", "isCorrect": true },
                { "text": "Write", "rationale": "‚ùå √çt ph·ªï bi·∫øn h∆°n 'Make a list'.", "isCorrect": false }
              ],
              "hint": "C·ª•m t·ª´ c·ªë ƒë·ªãnh: ... a list."
            },
            {
              "questionNumber": 4,
              "question": "The trip allows you plenty of time for ______________ around the shops.",
              "answerOptions": [
                { "text": "browsing", "rationale": "‚úÖ Ch√≠nh x√°c!\n\n1. Ph√¢n t√≠ch t·ª´ v·ª±ng:\n- A. browsing (v): xem qua/l∆∞·ªõt xem (h√†ng h√≥a)\n- B. watching (v): xem (phim/tr·∫≠n ƒë·∫•u)\n- C. seeing (v): nh√¨n th·∫•y\n- D. looking (v): nh√¨n (ph·∫£i c√≥ 'at')\n\n2. Gi·∫£i th√≠ch: 'Browse around the shops' nghƒ©a l√† ƒëi xem h√†ng nh∆∞ng ch∆∞a ch·∫Øc ƒë√£ mua (window shopping).\n\n3. D·ªãch c√¢u: Chuy·∫øn ƒëi cho ph√©p b·∫°n c√≥ nhi·ªÅu th·ªùi gian ƒë·ªÉ ƒëi xem/l∆∞·ªõt qua c√°c c·ª≠a h√†ng.", "isCorrect": true },
                { "text": "watching", "rationale": "‚ùå Kh√¥ng d√πng 'watch shops'.", "isCorrect": false },
                { "text": "seeing", "rationale": "‚ùå Sai nghƒ©a.", "isCorrect": false },
                { "text": "looking", "rationale": "‚ùå Thi·∫øu gi·ªõi t·ª´ (looking at/for).", "isCorrect": false }
              ],
              "hint": "ƒêi xem h√†ng h√≥a m·ªôt c√°ch thong th·∫£."
            },
            {
              "questionNumber": 5,
              "question": "Some people ______________ their goods on stalls, while others had just put them out on the pavement.",
              "answerOptions": [
                { "text": "displayed", "rationale": "‚úÖ Ch√≠nh x√°c!\n\n1. Ph√¢n t√≠ch t·ª´ v·ª±ng:\n- A. displayed (v): tr∆∞ng b√†y\n- B. appeared (v): xu·∫•t hi·ªán\n- C. hid (v): gi·∫•u\n- D. stored (v): l∆∞u tr·ªØ\n\n2. Gi·∫£i th√≠ch: ƒê·ªÉ b√°n h√†ng th√¨ ng∆∞·ªùi ta ph·∫£i 'tr∆∞ng b√†y' (display) h√†ng h√≥a tr√™n c√°c s·∫°p (stalls).\n\n3. D·ªãch c√¢u: M·ªôt s·ªë ng∆∞·ªùi tr∆∞ng b√†y h√†ng h√≥a c·ªßa h·ªç tr√™n c√°c s·∫°p, trong khi nh·ªØng ng∆∞·ªùi kh√°c ch·ªâ ƒë·∫∑t ch√∫ng ngay tr√™n v·ªâa h√®.", "isCorrect": true },
                { "text": "appeared", "rationale": "‚ùå Sai nghƒ©a.", "isCorrect": false },
                { "text": "hid", "rationale": "‚ùå Sai nghƒ©a (b√°n h√†ng th√¨ kh√¥ng gi·∫•u ƒëi).", "isCorrect": false },
                { "text": "stored", "rationale": "‚ùå Sai nghƒ©a (c·∫•t v√†o kho).", "isCorrect": false }
              ],
              "hint": "S·∫Øp x·∫øp h√†ng h√≥a ra ƒë·ªÉ ng∆∞·ªùi mua nh√¨n th·∫•y."
            },
            {
              "questionNumber": 6,
              "question": "______________ the shoes to see if they fit.",
              "answerOptions": [
                { "text": "Wear", "rationale": "‚ùå 'Wear' l√† tr·∫°ng th√°i ƒëang m·∫∑c tr√™n ng∆∞·ªùi, kh√¥ng ph·∫£i h√†nh ƒë·ªông th·ª≠.", "isCorrect": false },
                { "text": "Try on", "rationale": "‚úÖ Ch√≠nh x√°c!\n\n1. Ph√¢n t√≠ch t·ª´ v·ª±ng:\n- A. Wear (v): m·∫∑c/ƒëeo\n- B. Try on (v phrase): th·ª≠ ƒë·ªì\n- C. Put on (v phrase): m·∫∑c v√†o (nh∆∞ng ch∆∞a mang nghƒ©a ki·ªÉm tra xem v·ª´a kh√¥ng)\n- D. Dress up (v phrase): ƒÉn di·ªán\n\n2. Gi·∫£i th√≠ch: ƒê·ªÉ ki·ªÉm tra xem c√≥ v·ª´a (fit) hay kh√¥ng, ta ph·∫£i 'th·ª≠' (try on).\n\n3. D·ªãch c√¢u: H√£y th·ª≠ ƒë√¥i gi√†y xem ch√∫ng c√≥ v·ª´a kh√¥ng.", "isCorrect": true },
                { "text": "Put on", "rationale": "‚ùå Ch∆∞a s√°t nghƒ©a b·∫±ng 'Try on' (th·ª≠ ƒë·ªÉ ki·ªÉm tra).", "isCorrect": false },
                { "text": "Dress up", "rationale": "‚ùå Sai nghƒ©a (h√≥a trang/ƒÉn di·ªán).", "isCorrect": false }
              ],
              "hint": "H√†nh ƒë·ªông m·∫∑c th·ª≠ qu·∫ßn √°o/gi√†y d√©p."
            },
            {
              "questionNumber": 7,
              "question": "Haven't you got anything better to do than ______________ with friends at the shopping centre?",
              "answerOptions": [
                { "text": "play", "rationale": "‚ùå 'Play with friends' th∆∞·ªùng d√πng cho tr·∫ª em ch∆°i ƒë√πa.", "isCorrect": false },
                { "text": "go", "rationale": "‚ùå Sai ng·ªØ ph√°p/ng·ªØ nghƒ©a.", "isCorrect": false },
                { "text": "hang out", "rationale": "‚úÖ Ch√≠nh x√°c!\n\n1. Ph√¢n t√≠ch t·ª´ v·ª±ng:\n- A. play (v): ch∆°i\n- B. go (v): ƒëi\n- C. hang out (v phrase): t·ª• t·∫≠p/la c√†\n- D. stay (v): ·ªü l·∫°i\n\n2. Gi·∫£i th√≠ch: 'Hang out with friends' l√† c·ª•m t·ª´ r·∫•t ph·ªï bi·∫øn nghƒ©a l√† ƒëi ch∆°i/t·ª• t·∫≠p b·∫°n b√®.\n\n3. D·ªãch c√¢u: B·∫°n kh√¥ng c√≥ vi·ªác g√¨ t·ªët h∆°n ƒë·ªÉ l√†m ngo√†i vi·ªác t·ª• t·∫≠p v·ªõi b·∫°n b√® ·ªü trung t√¢m mua s·∫Øm sao?", "isCorrect": true },
                { "text": "stay", "rationale": "‚ùå Sai ng·ªØ c·∫£nh.", "isCorrect": false }
              ],
              "hint": "C·ª•m t·ª´ l√≥ng: t·ª• t·∫≠p, ƒëi ch∆°i."
            },
            {
              "questionNumber": 8,
              "question": "We spent the morning ______________ around the old part of the city.",
              "answerOptions": [
                { "text": "wandering", "rationale": "‚úÖ Ch√≠nh x√°c!\n\n1. Ph√¢n t√≠ch t·ª´ v·ª±ng:\n- A. wandering (v): ƒëi lang thang/t·∫£n b·ªô (kh√¥ng m·ª•c ƒë√≠ch c·ª• th·ªÉ)\n- B. running (v): ch·∫°y\n- C. climbing (v): leo tr√®o\n- D. waiting (v): ch·ªù ƒë·ª£i\n\n2. Gi·∫£i th√≠ch: 'Wandering around' ph√π h·ª£p nh·∫•t ƒë·ªÉ m√¥ t·∫£ vi·ªác ƒëi d·∫°o tham quan khu ph·ªë c·ªï.\n\n3. D·ªãch c√¢u: Ch√∫ng t√¥i ƒë√£ d√†nh c·∫£ bu·ªïi s√°ng ƒë·ªÉ ƒëi d·∫°o quanh khu ph·ªë c·ªï c·ªßa th√†nh ph·ªë.", "isCorrect": true },
                { "text": "running", "rationale": "‚ùå Kh√¥ng h·ª£p l√Ω khi tham quan ph·ªë c·ªï.", "isCorrect": false },
                { "text": "climbing", "rationale": "‚ùå Sai nghƒ©a.", "isCorrect": false },
                { "text": "waiting", "rationale": "‚ùå Sai nghƒ©a.", "isCorrect": false }
              ],
              "hint": "ƒêi d·∫°o loanh quanh kh√¥ng c√≥ ƒë√≠ch ƒë·∫øn c·ª• th·ªÉ."
            },
            {
              "questionNumber": 9,
              "question": "The new TV broke so they ______________ it to the shop.",
              "answerOptions": [
                { "text": "returned", "rationale": "‚úÖ Ch√≠nh x√°c!\n\n1. Ph√¢n t√≠ch t·ª´ v·ª±ng:\n- A. returned (v): tr·∫£ l·∫°i\n- B. bought (v): mua\n- C. sold (v): b√°n\n- D. took (v): c·∫ßm/l·∫•y\n\n2. Gi·∫£i th√≠ch: Khi h√†ng h√≥a b·ªã h·ªèng (broke), kh√°ch h√†ng s·∫Ω mang 'tr·∫£ l·∫°i' (return) c·ª≠a h√†ng.\n\n3. D·ªãch c√¢u: Chi·∫øc TV m·ªõi b·ªã h·ªèng n√™n h·ªç ƒë√£ tr·∫£ n√≥ l·∫°i cho c·ª≠a h√†ng.", "isCorrect": true },
                { "text": "bought", "rationale": "‚ùå Sai. ƒê√£ mua r·ªìi m·ªõi h·ªèng.", "isCorrect": false },
                { "text": "sold", "rationale": "‚ùå Sai ng·ªØ c·∫£nh.", "isCorrect": false },
                { "text": "took", "rationale": "‚ùå 'Took it to the shop' (mang ƒë·∫øn) c≈©ng c√≥ l√Ω, nh∆∞ng trong ng·ªØ c·∫£nh b√†i t·∫≠p t·ª´ v·ª±ng n√†y, 'returned' (tr·∫£ h√†ng) ch√≠nh x√°c h∆°n v·ªÅ m·∫∑t th∆∞∆°ng m·∫°i.", "isCorrect": false }
              ],
              "hint": "Mang h√†ng b·ªã l·ªói tr·∫£ l·∫°i n∆°i b√°n."
            },
            {
              "questionNumber": 10,
              "question": "The villagers ______________ coffee and maize to sell in the market.",
              "answerOptions": [
                { "text": "grow", "rationale": "‚úÖ Ch√≠nh x√°c!\n\n1. Ph√¢n t√≠ch t·ª´ v·ª±ng:\n- A. grow (v): tr·ªìng (c√¢y c·ªëi)\n- B. make (v): l√†m/ch·∫ø t·∫°o\n- C. build (v): x√¢y d·ª±ng\n- D. breed (v): chƒÉn nu√¥i\n\n2. Gi·∫£i th√≠ch: V·ªõi c√† ph√™ (coffee) v√† ng√¥ (maize), ƒë·ªông t·ª´ ph√π h·ª£p l√† 'tr·ªìng' (grow).\n\n3. D·ªãch c√¢u: D√¢n l√†ng tr·ªìng c√† ph√™ v√† ng√¥ ƒë·ªÉ b√°n ·ªü ch·ª£.", "isCorrect": true },
                { "text": "make", "rationale": "‚ùå Kh√¥ng d√πng 'make' cho c√¢y tr·ªìng.", "isCorrect": false },
                { "text": "build", "rationale": "‚ùå Sai nghƒ©a.", "isCorrect": false },
                { "text": "breed", "rationale": "‚ùå 'Breed' d√πng cho ƒë·ªông v·∫≠t.", "isCorrect": false }
              ],
              "hint": "ƒê·ªông t·ª´ d√πng cho vi·ªác canh t√°c c√¢y c·ªëi."
            },
            {
              "questionNumber": 11,
              "question": "Exercise 5: When we bought this house, there were many homes ______________ sale.",
              "answerOptions": [
                { "text": "for", "rationale": "‚úÖ Ch√≠nh x√°c!\n\n1. Ph√¢n t√≠ch t·ª´ v·ª±ng:\n- A. for (prep): cho\n- B. on (prep): tr√™n\n- C. in (prep): trong\n- D. at (prep): t·∫°i\n\n2. Gi·∫£i th√≠ch: \n- 'For sale': ƒê∆∞·ª£c rao b√°n (nh√† c·ª≠a, xe c·ªô, ƒë·ªì c≈© c·ªßa c√° nh√¢n...).\n- 'On sale': ƒêang gi·∫£m gi√° (trong c·ª≠a h√†ng).\n·ªû ƒë√¢y n√≥i v·ªÅ mua b√°n nh√† ƒë·∫•t -> for sale.\n\n3. D·ªãch c√¢u: Khi ch√∫ng t√¥i mua ng√¥i nh√† n√†y, c√≥ r·∫•t nhi·ªÅu ng√¥i nh√† ƒëang ƒë∆∞·ª£c rao b√°n.", "isCorrect": true },
                { "text": "on", "rationale": "‚ùå 'On sale' th∆∞·ªùng nghƒ©a l√† gi·∫£m gi√° (h√†ng h√≥a). V·ªõi nh√† ƒë·∫•t, ng∆∞·ªùi ta d√πng 'for sale'.", "isCorrect": false },
                { "text": "in", "rationale": "‚ùå Sai gi·ªõi t·ª´.", "isCorrect": false },
                { "text": "at", "rationale": "‚ùå Sai gi·ªõi t·ª´.", "isCorrect": false }
              ],
              "hint": "C·ª•m t·ª´ ch·ªâ v·∫≠t ƒëang ƒë∆∞·ª£c rao b√°n (ƒë·∫∑c bi·ªát l√† nh√† ƒë·∫•t)."
            },
            {
              "questionNumber": 12,
              "question": "Everything goes ______________ sale as soon as the doors open. Today is Black Friday.",
              "answerOptions": [
                { "text": "on", "rationale": "‚úÖ Ch√≠nh x√°c!\n\n1. Ph√¢n t√≠ch t·ª´ v·ª±ng:\n- A. on (prep): tr√™n\n- B. for (prep): cho\n- C. in (prep): trong\n- D. at (prep): t·∫°i\n\n2. Gi·∫£i th√≠ch: Ng·ªØ c·∫£nh 'Black Friday' (gi·∫£m gi√°), n√™n d√πng 'go on sale' (ƒë∆∞·ª£c b√°n gi·∫£m gi√°/ƒë∆∞·ª£c tung ra b√°n).\n\n3. D·ªãch c√¢u: M·ªçi th·ª© ƒë∆∞·ª£c gi·∫£m gi√° ngay khi c·ª≠a m·ªü. H√¥m nay l√† Black Friday.", "isCorrect": true },
                { "text": "for", "rationale": "‚ùå 'Go for sale' kh√¥ng ph·∫£i l√† c·ª•m t·ª´ th√¥ng d·ª•ng trong ng·ªØ c·∫£nh n√†y.", "isCorrect": false },
                { "text": "in", "rationale": "‚ùå Sai gi·ªõi t·ª´.", "isCorrect": false },
                { "text": "at", "rationale": "‚ùå Sai gi·ªõi t·ª´.", "isCorrect": false }
              ],
              "hint": "C·ª•m t·ª´ ch·ªâ vi·ªác h√†ng h√≥a ƒë∆∞·ª£c gi·∫£m gi√°."
            },
            {
              "questionNumber": 13,
              "question": "He spent a lot of time listening to DVDs and just hanging out ______________ friends.",
              "answerOptions": [
                { "text": "with", "rationale": "‚úÖ Ch√≠nh x√°c!\n\n1. Ph√¢n t√≠ch t·ª´ v·ª±ng:\n- A. with (prep): v·ªõi\n- B. to (prep): t·ªõi\n- C. for (prep): cho\n- D. about (prep): v·ªÅ\n\n2. Gi·∫£i th√≠ch: C·ª•m 'hang out with someone' (t·ª• t·∫≠p v·ªõi ai).\n\n3. D·ªãch c√¢u: Anh ·∫•y d√†nh nhi·ªÅu th·ªùi gian nghe ƒëƒ©a DVD v√† ch·ªâ t·ª• t·∫≠p v·ªõi b·∫°n b√®.", "isCorrect": true },
                { "text": "to", "rationale": "‚ùå Sai gi·ªõi t·ª´.", "isCorrect": false },
                { "text": "for", "rationale": "‚ùå Sai gi·ªõi t·ª´.", "isCorrect": false },
                { "text": "about", "rationale": "‚ùå Sai gi·ªõi t·ª´.", "isCorrect": false }
              ],
              "hint": "ƒêi ch∆°i V·ªöI ai ƒë√≥."
            },
            {
              "questionNumber": 14,
              "question": "Would you prefer to pay ______________ cash, cheque or credit card?",
              "answerOptions": [
                { "text": "in", "rationale": "‚úÖ Ch√≠nh x√°c!\n\n1. Ph√¢n t√≠ch t·ª´ v·ª±ng:\n- A. in (prep): trong\n- B. on (prep): tr√™n\n- C. at (prep): t·∫°i\n- D. for (prep): cho\n\n2. Gi·∫£i th√≠ch: \n- Pay IN cash (tr·∫£ b·∫±ng ti·ªÅn m·∫∑t).\n- Pay BY cheque/credit card (tr·∫£ b·∫±ng s√©c/th·∫ª).\nL∆∞u √Ω: M·ªôt s·ªë t√†i li·ªáu c≈© d√πng 'by cash' nh∆∞ng chu·∫©n ng·ªØ ph√°p l√† 'in cash'.\n\n3. D·ªãch c√¢u: B·∫°n mu·ªën tr·∫£ b·∫±ng ti·ªÅn m·∫∑t, s√©c hay th·∫ª t√≠n d·ª•ng?", "isCorrect": true },
                { "text": "on", "rationale": "‚ùå Sai gi·ªõi t·ª´.", "isCorrect": false },
                { "text": "at", "rationale": "‚ùå Sai gi·ªõi t·ª´.", "isCorrect": false },
                { "text": "for", "rationale": "‚ùå 'Pay for' l√† tr·∫£ ti·ªÅn cho m√≥n h√†ng, kh√¥ng ph·∫£i ph∆∞∆°ng th·ª©c thanh to√°n.", "isCorrect": false }
              ],
              "hint": "C·ª•m t·ª´: pay ... cash (tr·∫£ b·∫±ng ti·ªÅn m·∫∑t)."
            },
            {
              "questionNumber": 15,
              "question": "He chose a shirt ______________ the many in the shop.",
              "answerOptions": [
                { "text": "from", "rationale": "‚úÖ Ch√≠nh x√°c!\n\n1. Ph√¢n t√≠ch t·ª´ v·ª±ng:\n- A. from (prep): t·ª´\n- B. of (prep): c·ªßa\n- C. in (prep): trong\n- D. on (prep): tr√™n\n\n2. Gi·∫£i th√≠ch: 'Choose from' (l·ª±a ch·ªçn t·ª´ trong s·ªë...).\n\n3. D·ªãch c√¢u: Anh ·∫•y ƒë√£ ch·ªçn m·ªôt chi·∫øc √°o s∆° mi t·ª´ r·∫•t nhi·ªÅu chi·∫øc trong c·ª≠a h√†ng.", "isCorrect": true },
                { "text": "of", "rationale": "‚ùå Sai gi·ªõi t·ª´.", "isCorrect": false },
                { "text": "in", "rationale": "‚ùå Sai gi·ªõi t·ª´.", "isCorrect": false },
                { "text": "on", "rationale": "‚ùå Sai gi·ªõi t·ª´.", "isCorrect": false }
              ],
              "hint": "Ch·ªçn m·ªôt c√°i T·ª™ trong s·ªë nhi·ªÅu c√°i."
            },
            {
              "questionNumber": 16,
              "question": "I tried ______________ six pairs of trousers before I found a pair that fitted.",
              "answerOptions": [
                { "text": "on", "rationale": "‚úÖ Ch√≠nh x√°c!\n\n1. Ph√¢n t√≠ch t·ª´ v·ª±ng:\n- A. on (prep): tr√™n\n- B. in (prep): trong\n- C. at (prep): t·∫°i\n- D. out (prep): ngo√†i\n\n2. Gi·∫£i th√≠ch: C·ª•m ƒë·ªông t·ª´ 'try on' (m·∫∑c th·ª≠).\n\n3. D·ªãch c√¢u: T√¥i ƒë√£ th·ª≠ s√°u chi·∫øc qu·∫ßn d√†i tr∆∞·ªõc khi t√¨m ƒë∆∞·ª£c m·ªôt chi·∫øc v·ª´a v·∫∑n.", "isCorrect": true },
                { "text": "in", "rationale": "‚ùå Sai.", "isCorrect": false },
                { "text": "at", "rationale": "‚ùå Sai.", "isCorrect": false },
                { "text": "out", "rationale": "‚ùå 'Try out' nghƒ©a l√† th·ª≠ nghi·ªám m√°y m√≥c/ph∆∞∆°ng ph√°p, kh√¥ng d√πng cho qu·∫ßn √°o.", "isCorrect": false }
              ],
              "hint": "C·ª•m ƒë·ªông t·ª´: Try ... (th·ª≠ ƒë·ªì)."
            },
            {
              "questionNumber": 17,
              "question": "Everything went according ______________ the schedule.",
              "answerOptions": [
                { "text": "to", "rationale": "‚úÖ Ch√≠nh x√°c!\n\n1. Ph√¢n t√≠ch t·ª´ v·ª±ng:\n- A. to (prep): t·ªõi\n- B. with (prep): v·ªõi\n- C. by (prep): b·ªüi\n- D. of (prep): c·ªßa\n\n2. Gi·∫£i th√≠ch: C·ª•m t·ª´ c·ªë ƒë·ªãnh 'according to' (theo nh∆∞).\n\n3. D·ªãch c√¢u: M·ªçi th·ª© ƒë√£ di·ªÖn ra theo ƒë√∫ng l·ªãch tr√¨nh.", "isCorrect": true },
                { "text": "with", "rationale": "‚ùå Sai.", "isCorrect": false },
                { "text": "by", "rationale": "‚ùå Sai.", "isCorrect": false },
                { "text": "of", "rationale": "‚ùå Sai.", "isCorrect": false }
              ],
              "hint": "C·ª•m t·ª´: According ... (theo nh∆∞)."
            },
            {
              "questionNumber": 18,
              "question": "______________ reasons of security, the door is always kept locked.",
              "answerOptions": [
                { "text": "For", "rationale": "‚úÖ Ch√≠nh x√°c!\n\n1. Ph√¢n t√≠ch t·ª´ v·ª±ng:\n- A. For (prep): Cho/V√¨\n- B. From (prep): T·ª´\n- C. With (prep): V·ªõi\n- D. Because (conj): B·ªüi v√¨\n\n2. Gi·∫£i th√≠ch: 'For reasons of...' (V√¨ l√Ω do...). L∆∞u √Ω 'Because' ph·∫£i c·ªông v·ªõi m·ªánh ƒë·ªÅ, ·ªü ƒë√¢y l√† c·ª•m danh t·ª´ n√™n d√πng gi·ªõi t·ª´ 'For'.\n\n3. D·ªãch c√¢u: V√¨ l√Ω do an ninh, c·ª≠a lu√¥n ƒë∆∞·ª£c kh√≥a.", "isCorrect": true },
                { "text": "From", "rationale": "‚ùå Sai.", "isCorrect": false },
                { "text": "With", "rationale": "‚ùå Sai.", "isCorrect": false },
                { "text": "Because", "rationale": "‚ùå Sai ng·ªØ ph√°p. 'Because' kh√¥ng ƒëi tr·ª±c ti·∫øp v·ªõi danh t·ª´ n·∫øu kh√¥ng c√≥ 'of'. (Ph·∫£i l√† 'Because of').", "isCorrect": false }
              ],
              "hint": "Gi·ªõi t·ª´ ch·ªâ m·ª•c ƒë√≠ch/nguy√™n nh√¢n: ... reasons of."
            },
            {
              "questionNumber": 19,
              "question": "The restaurant charges high prices ______________ its food.",
              "answerOptions": [
                { "text": "for", "rationale": "‚úÖ Ch√≠nh x√°c!\n\n1. Ph√¢n t√≠ch t·ª´ v·ª±ng:\n- A. for (prep): cho\n- B. to (prep): t·ªõi\n- C. on (prep): tr√™n\n- D. with (prep): v·ªõi\n\n2. Gi·∫£i th√≠ch: 'Charge a price FOR something' (T√≠nh gi√° cho c√°i g√¨).\n\n3. D·ªãch c√¢u: Nh√† h√†ng t√≠nh gi√° cao cho c√°c m√≥n ƒÉn c·ªßa m√¨nh.", "isCorrect": true },
                { "text": "to", "rationale": "‚ùå Sai.", "isCorrect": false },
                { "text": "on", "rationale": "‚ùå Sai.", "isCorrect": false },
                { "text": "with", "rationale": "‚ùå Sai.", "isCorrect": false }
              ],
              "hint": "T√≠nh ti·ªÅn CHO c√°i g√¨."
            },
            {
              "questionNumber": 20,
              "question": "We wandered ______________ the beautifully decorated rooms of the Palace.",
              "answerOptions": [
                { "text": "through", "rationale": "‚úÖ Ch√≠nh x√°c!\n\n1. Ph√¢n t√≠ch t·ª´ v·ª±ng:\n- A. through (prep): xuy√™n qua/ƒëi qua\n- B. on (prep): tr√™n\n- C. at (prep): t·∫°i\n- D. with (prep): v·ªõi\n\n2. Gi·∫£i th√≠ch: 'Wander through' (ƒëi lang thang qua/kh·∫Øp) c√°c cƒÉn ph√≤ng.\n\n3. D·ªãch c√¢u: Ch√∫ng t√¥i ƒëi d·∫°o qua nh·ªØng cƒÉn ph√≤ng ƒë∆∞·ª£c trang tr√≠ l·ªông l·∫´y c·ªßa Cung ƒëi·ªán.", "isCorrect": true },
                { "text": "on", "rationale": "‚ùå Sai.", "isCorrect": false },
                { "text": "at", "rationale": "‚ùå Sai.", "isCorrect": false },
                { "text": "with", "rationale": "‚ùå Sai.", "isCorrect": false }
              ],
              "hint": "Gi·ªõi t·ª´ ch·ªâ s·ª± chuy·ªÉn ƒë·ªông qua kh√¥ng gian k√≠n."
            }
          ]
        };

        const container = document.getElementById('quiz-container');
        const progressBar = document.getElementById('progress-bar');
        const progressText = document.getElementById('progress-text');
        
        let correctCount = 0;
        let wrongCount = 0;
        let answeredCount = 0;
        const totalQuestions = quizData.questions.length;

        // Render Questions
        function renderQuiz() {
            quizData.questions.forEach((q, index) => {
                const card = document.createElement('div');
                card.className = "card-container p-6 md:p-8 flex flex-col gap-6 relative shadow-card transition-all duration-300";
                card.id = `card-${index}`;

                // Question Header
                const headerHtml = `
                    <div class="flex justify-between items-start">
                        <span class="bg-gray-200 text-gray-700 px-3 py-1 rounded-full text-sm font-bold shadow-sm">
                            C√¢u ${q.questionNumber}
                        </span>
                        <div class="text-xs font-semibold text-gray-400 cursor-help" title="G·ª£i √Ω">üí° Hint</div>
                    </div>
                    <h3 class="text-xl md:text-2xl font-bold text-gray-800 leading-snug">
                        ${q.question}
                    </h3>
                `;

                // Options Grid
                let optionsHtml = '<div class="grid grid-cols-1 md:grid-cols-2 gap-4">';
                q.answerOptions.forEach((opt, optIndex) => {
                    optionsHtml += `
                        <button 
                            onclick="checkAnswer(${index}, ${optIndex}, ${opt.isCorrect})" 
                            class="btn-option bg-white border-2 border-gray-200 text-gray-700 text-lg font-bold py-4 px-6 rounded-2xl w-full text-left"
                            id="btn-${index}-${optIndex}">
                            ${String.fromCharCode(65 + optIndex)}. ${opt.text}
                        </button>
                    `;
                });
                optionsHtml += '</div>';

                // Explanation Box (Hidden)
                // Note: Formatting rationale text to be HTML safe and styled
                const explanationText = q.answerOptions.find(o => o.isCorrect).rationale
                    .replace(/\n/g, '<br>')
                    .replace(/‚úÖ/g, '<span class="text-green-500 text-xl mr-2">‚úÖ</span>')
                    .replace(/‚ùå/g, '<span class="text-red-500 text-xl mr-2">‚ùå</span>');

                const explanationHtml = `
                    <div id="explanation-${index}" class="explanation-box mt-4 bg-purple-50 rounded-2xl p-6 border-l-8 border-purple-400 shadow-inner">
                        <div class="flex items-center gap-2 mb-3">
                            <span class="bg-purple-500 text-white rounded-full p-1">
                                <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5" viewBox="0 0 20 20" fill="currentColor">
                                  <path fill-rule="evenodd" d="M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-7-4a1 1 0 11-2 0 1 1 0 012 0zM9 9a1 1 0 000 2v3a1 1 0 001 1h1a1 1 0 100-2v-3a1 1 0 00-1-1H9z" clip-rule="evenodd" />
                                </svg>
                            </span>
                            <h4 class="font-bold text-purple-700 uppercase tracking-wide">Gi·∫£i th√≠ch chi ti·∫øt (Ms Mai An)</h4>
                        </div>
                        <div class="text-gray-700 leading-relaxed text-sm md:text-base font-medium">
                            ${explanationText}
                        </div>
                    </div>
                `;

                card.innerHTML = headerHtml + optionsHtml + explanationHtml;
                container.appendChild(card);
            });

            // Add Final Submit Button area (though interaction is immediate, this triggers the modal)
            const finishBtnArea = document.createElement('div');
            finishBtnArea.className = "text-center mt-8 pb-12";
            finishBtnArea.innerHTML = `
                <button onclick="showSummary()" class="bg-secondary text-white font-extrabold text-2xl py-4 px-12 rounded-full shadow-3d hover:-translate-y-1 active:translate-y-1 active:shadow-none transition-all uppercase tracking-widest border-4 border-white">
                    N·ªôp B√†i & Xem ƒêi·ªÉm
                </button>
            `;
            container.appendChild(finishBtnArea);
        }

        // Check Answer Logic
        window.checkAnswer = function(questionIndex, optionIndex, isCorrect) {
            const currentCard = document.getElementById(`card-${questionIndex}`);
            
            // Prevent re-answering
            if(currentCard.getAttribute('data-answered') === 'true') return;
            currentCard.setAttribute('data-answered', 'true');

            answeredCount++;
            updateProgress();

            const selectedBtn = document.getElementById(`btn-${questionIndex}-${optionIndex}`);
            const allBtns = currentCard.querySelectorAll('button');

            // Disable all buttons in this card
            allBtns.forEach(btn => {
                btn.classList.add('status-disabled');
                btn.disabled = true;
            });

            // Show explanation
            document.getElementById(`explanation-${questionIndex}`).style.display = 'block';

            if (isCorrect) {
                // Correct styling
                selectedBtn.classList.remove('bg-white', 'text-gray-700', 'border-gray-200');
                selectedBtn.classList.add('status-correct');
                selectedBtn.classList.remove('status-disabled'); // Keep opacity full for selected
                
                playCorrectSound();
                triggerConfetti(selectedBtn);
                correctCount++;
            } else {
                // Wrong styling
                selectedBtn.classList.remove('bg-white', 'text-gray-700', 'border-gray-200');
                selectedBtn.classList.add('status-wrong');
                selectedBtn.classList.add('shake-element');
                selectedBtn.classList.remove('status-disabled');

                // Highlight correct answer automatically
                const data = quizData.questions[questionIndex];
                const correctOptIndex = data.answerOptions.findIndex(o => o.isCorrect);
                const correctBtn = document.getElementById(`btn-${questionIndex}-${correctOptIndex}`);
                correctBtn.classList.remove('bg-white', 'text-gray-700', 'border-gray-200');
                correctBtn.classList.add('status-correct');
                
                playWrongSound();
                wrongCount++;
            }
        };

        function updateProgress() {
            const percent = (answeredCount / totalQuestions) * 100;
            progressBar.style.width = `${percent}%`;
            progressText.innerText = `${answeredCount}/${totalQuestions} C√¢u`;
        }

        // Confetti Effect
        function triggerConfetti(element) {
            const rect = element.getBoundingClientRect();
            // Normalized coordinates (0 to 1)
            const x = (rect.left + rect.width / 2) / window.innerWidth;
            const y = (rect.top + rect.height / 2) / window.innerHeight;

            confetti({
                particleCount: 100,
                spread: 70,
                origin: { x: x, y: y },
                colors: ['#00C9A7', '#8854C0', '#FFD700', '#FF4757'],
                disableForReducedMotion: true
            });
        }

        // Summary Modal
        window.showSummary = function() {
            if (answeredCount < totalQuestions) {
                if(!confirm(`B·∫°n m·ªõi l√†m ${answeredCount}/${totalQuestions} c√¢u. B·∫°n c√≥ ch·∫Øc mu·ªën n·ªôp b√†i kh√¥ng?`)) return;
            }

            document.getElementById('final-score').innerText = correctCount;
            document.getElementById('final-wrong').innerText = wrongCount;
            
            const percentage = (correctCount / totalQuestions) * 100;
            let message = "";
            if (percentage === 100) message = "Tuy·ªát v·ªùi! Em l√† thi√™n t√†i ng·ªØ ph√°p! üåü";
            else if (percentage >= 80) message = "L√†m t·ªët l·∫Øm! Em r·∫•t n·∫Øm ch·∫Øc ki·∫øn th·ª©c! üëè";
            else if (percentage >= 50) message = "C·ªë g·∫Øng l√™n! Em ƒëang ti·∫øn b·ªô t·ª´ng ng√†y! üí™";
            else message = "ƒê·ª´ng n·∫£n ch√≠! H√£y xem k·ªπ ph·∫ßn gi·∫£i th√≠ch nh√©! üìö";

            document.getElementById('feedback-message').innerText = message;
            document.getElementById('summary-modal').classList.remove('hidden');
            
            // Big Confetti
            if (percentage >= 50) {
                const duration = 3000;
                const end = Date.now() + duration;

                (function frame() {
                confetti({
                    particleCount: 3,
                    angle: 60,
                    spread: 55,
                    origin: { x: 0 },
                    colors: ['#00C9A7', '#8854C0']
                });
                confetti({
                    particleCount: 3,
                    angle: 120,
                    spread: 55,
                    origin: { x: 1 },
                    colors: ['#00C9A7', '#8854C0']
                });

                if (Date.now() < end) {
                    requestAnimationFrame(frame);
                }
                }());
            }
        };

        // Initialize
        renderQuiz();

    </script>
</body>
</html>
