<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Bài Tập Từ Vựng & Ngữ Pháp: Energy & Environment - Ms Mai An ULIS</title>
    <!-- Fonts -->
    <link href="https://fonts.googleapis.com/css2?family=Nunito:wght@400;600;700;800&family=Quicksand:wght@500;700&display=swap" rel="stylesheet">
    <!-- FontAwesome -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <!-- Confetti JS -->
    <script src="https://cdn.jsdelivr.net/npm/canvas-confetti@1.6.0/dist/confetti.browser.min.js"></script>
    
    <style>
        :root {
            --primary-color: #8854C0; /* Tím hồng */
            --secondary-color: #00C9A7; /* Xanh ngọc */
            --correct-color: #00D26A; /* Xanh lá */
            --wrong-color: #FF4757; /* Đỏ cam */
            --bg-color: #f0f4f8;
            --card-bg: #ffffff;
            --text-color: #2d3436;
        }

        body {
            font-family: 'Nunito', sans-serif;
            background-color: var(--bg-color);
            background-image: radial-gradient(#dbeaf9 15%, transparent 16%), radial-gradient(#dbeaf9 15%, transparent 16%);
            background-size: 60px 60px;
            background-position: 0 0, 30px 30px;
            margin: 0;
            padding: 0;
            color: var(--text-color);
            min-height: 100vh;
        }

        /* Header Styles */
        header {
            background: linear-gradient(135deg, var(--primary-color), #a29bfe);
            color: white;
            padding: 20px;
            text-align: center;
            box-shadow: 0 4px 15px rgba(136, 84, 192, 0.3);
            border-bottom-left-radius: 30px;
            border-bottom-right-radius: 30px;
            margin-bottom: 30px;
            position: relative;
            z-index: 10;
        }

        h1 {
            font-family: 'Quicksand', sans-serif;
            margin: 0;
            font-size: 1.8rem;
            font-weight: 800;
            text-shadow: 2px 2px 0px rgba(0,0,0,0.1);
        }

        .teacher-name {
            font-size: 1rem;
            opacity: 0.9;
            margin-top: 5px;
            font-weight: 600;
        }

        /* Container */
        .container {
            max-width: 800px;
            margin: 0 auto;
            padding: 0 20px 80px 20px;
        }

        /* Question Card */
        .quiz-card {
            background: var(--card-bg);
            border-radius: 20px;
            padding: 25px;
            margin-bottom: 30px;
            box-shadow: 0 10px 0 #e0e0e0, 0 10px 20px rgba(0,0,0,0.1);
            border: 2px solid #f1f1f1;
            transition: transform 0.3s ease;
            position: relative;
            overflow: hidden;
        }

        .question-number {
            display: inline-block;
            background: var(--secondary-color);
            color: white;
            padding: 5px 15px;
            border-radius: 20px;
            font-weight: 800;
            font-size: 0.9rem;
            margin-bottom: 15px;
            box-shadow: 0 3px 0 #009e82;
        }

        .question-text {
            font-size: 1.3rem;
            font-weight: 700;
            margin-bottom: 25px;
            line-height: 1.5;
            color: #2d3436;
        }

        /* Options Grid */
        .options-grid {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 15px;
        }

        @media (max-width: 600px) {
            .options-grid {
                grid-template-columns: 1fr;
            }
        }

        /* 3D Button Styles */
        .option-btn {
            background: white;
            border: 2px solid #e0e0e0;
            border-radius: 15px;
            padding: 15px 20px;
            font-family: 'Nunito', sans-serif;
            font-size: 1.1rem;
            font-weight: 700;
            color: var(--text-color);
            cursor: pointer;
            transition: all 0.1s ease;
            box-shadow: 0 5px 0 #dcdcdc;
            text-align: left;
            position: relative;
            display: flex;
            align-items: center;
        }

        .option-btn:hover:not(:disabled) {
            transform: translateY(-2px);
            border-color: var(--primary-color);
        }

        .option-btn:active:not(:disabled) {
            transform: translateY(5px);
            box-shadow: 0 0 0 #dcdcdc;
        }

        .option-label {
            display: inline-flex;
            justify-content: center;
            align-items: center;
            width: 30px;
            height: 30px;
            background: #f1f2f6;
            border-radius: 50%;
            margin-right: 12px;
            font-size: 0.9rem;
            color: #747d8c;
            font-weight: 800;
            flex-shrink: 0;
        }

        /* States */
        .option-btn.correct {
            background-color: var(--correct-color);
            color: white;
            border-color: #00b85c;
            box-shadow: 0 5px 0 #009e4f !important;
            transform: translateY(0);
        }

        .option-btn.correct .option-label {
            background: rgba(255,255,255,0.3);
            color: white;
        }

        .option-btn.wrong {
            background-color: var(--wrong-color);
            color: white;
            border-color: #e84118;
            box-shadow: 0 5px 0 #c23616 !important;
            animation: shake 0.5s;
        }

        .option-btn.wrong .option-label {
            background: rgba(255,255,255,0.3);
            color: white;
        }

        .option-btn:disabled {
            cursor: default;
            opacity: 0.7;
        }

        /* Explanation Box */
        .explanation-box {
            margin-top: 25px;
            background: #fff0f6; /* Hồng rất nhạt */
            border: 2px dashed var(--primary-color);
            border-radius: 15px;
            padding: 20px;
            display: none; /* Hidden by default */
            animation: slideDown 0.4s ease-out;
        }

        .teacher-avatar {
            font-size: 2rem;
            float: left;
            margin-right: 15px;
        }

        .explanation-title {
            color: var(--primary-color);
            font-weight: 800;
            font-size: 1.1rem;
            margin-bottom: 10px;
            text-transform: uppercase;
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .explanation-content {
            font-size: 1rem;
            line-height: 1.6;
            color: #4b4b4b;
            white-space: pre-line; /* Preserve line breaks from JSON */
        }

        /* Animations */
        @keyframes shake {
            0% { transform: translateX(0); }
            25% { transform: translateX(-10px) rotate(-5deg); }
            50% { transform: translateX(10px) rotate(5deg); }
            75% { transform: translateX(-10px) rotate(-5deg); }
            100% { transform: translateX(0); }
        }

        @keyframes slideDown {
            from { opacity: 0; transform: translateY(-10px); }
            to { opacity: 1; transform: translateY(0); }
        }

        /* Submit Button */
        .submit-section {
            text-align: center;
            margin-top: 40px;
        }

        .finish-btn {
            background: var(--primary-color);
            color: white;
            border: none;
            padding: 15px 40px;
            font-size: 1.5rem;
            font-family: 'Quicksand', sans-serif;
            font-weight: 700;
            border-radius: 50px;
            cursor: pointer;
            box-shadow: 0 8px 0 #5f368c;
            transition: all 0.2s;
        }

        .finish-btn:active {
            transform: translateY(8px);
            box-shadow: 0 0 0 #5f368c;
        }

        /* Modal */
        .modal {
            display: none;
            position: fixed;
            z-index: 100;
            left: 0;
            top: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0,0,0,0.6);
            align-items: center;
            justify-content: center;
            backdrop-filter: blur(5px);
        }

        .modal-content {
            background-color: white;
            padding: 40px;
            border-radius: 30px;
            text-align: center;
            max-width: 400px;
            width: 90%;
            position: relative;
            box-shadow: 0 20px 50px rgba(0,0,0,0.3);
            border: 5px solid var(--secondary-color);
        }

        .score-display {
            font-size: 4rem;
            font-weight: 800;
            color: var(--primary-color);
            margin: 20px 0;
        }

        .message {
            font-size: 1.5rem;
            font-weight: 700;
            margin-bottom: 30px;
            color: #2d3436;
        }

        .close-btn {
            background: var(--secondary-color);
            color: white;
            border: none;
            padding: 10px 30px;
            font-size: 1.2rem;
            font-weight: 700;
            border-radius: 20px;
            cursor: pointer;
            box-shadow: 0 5px 0 #008c73;
        }
        
        .close-btn:active {
            transform: translateY(5px);
            box-shadow: none;
        }
        
        /* Utility for underlined text in phonetics */
        u {
            text-decoration-color: var(--primary-color);
            text-decoration-thickness: 3px;
            text-underline-offset: 3px;
        }

    </style>
</head>
<body>

    <header>
        <h1><i class="fas fa-bolt" style="color: #ffeaa7;"></i> Energy & Environment <i class="fas fa-leaf" style="color: #55efc4;"></i></h1>
        <div class="teacher-name">Giáo viên: Ms Mai An ULIS</div>
    </header>

    <div class="container" id="quiz-container">
        <!-- Quiz Cards will be injected here via JavaScript -->
    </div>

    <div class="submit-section">
        <button class="finish-btn" onclick="showSummary()">
            <i class="fas fa-flag-checkered"></i> Nộp Bài & Xem Điểm
        </button>
    </div>

    <!-- Result Modal -->
    <div id="resultModal" class="modal">
        <div class="modal-content">
            <h2 style="color: var(--secondary-color); margin: 0;">Tổng Kết</h2>
            <div class="score-display" id="final-score">0/0</div>
            <div class="message" id="final-message">Làm tốt lắm!</div>
            <button class="close-btn" onclick="closeModal()">Xem lại bài làm</button>
        </div>
    </div>

    <!-- Audio Elements -->
    <audio id="sound-ding" src="https://assets.mixkit.co/sfx/preview/mixkit-correct-answer-tone-2870.mp3" preload="auto"></audio>
    <audio id="sound-buzz" src="https://assets.mixkit.co/sfx/preview/mixkit-wrong-answer-fail-notification-946.mp3" preload="auto"></audio>
    <audio id="sound-cheer" src="https://assets.mixkit.co/sfx/preview/mixkit-winning-chimes-2015.mp3" preload="auto"></audio>

    <script>
        // --- DATA SOURCE ---
        const quizData = {
            "questions": [
            {
            "questionNumber": 1,
            "question": "N____________ energy resources include coal, oil, natural gas and uranium.",
            "answerOptions": [
                { "text": "Non-renewable", "isCorrect": true },
                { "text": "Natural", "isCorrect": false },
                { "text": "Nuclear", "isCorrect": false },
                { "text": "New", "isCorrect": false }
            ],
            "rationale": "1. Phân tích ngữ cảnh:\n- Các ví dụ đưa ra: coal (than), oil (dầu), natural gas (khí đốt), uranium (urani).\n- Đây là các nguồn năng lượng không thể tái tạo.\n\n2. Từ cần điền:\n- Bắt đầu bằng chữ 'N'.\n- \"Non-renewable energy\" (Năng lượng không tái tạo).\n\n3. Dịch nghĩa: \"Các nguồn năng lượng không tái tạo bao gồm than đá, dầu mỏ, khí tự nhiên và urani.\"\n\n4. Tại sao sai?\n- Natural: Không chính xác về mặt thuật ngữ phân loại.\n- Nuclear: Coal, oil không phải năng lượng hạt nhân.\n- New: Sai nghĩa."
            },
            {
            "questionNumber": 2,
            "question": "S____________ energy creates clean, renewable power from the sun.",
            "answerOptions": [
                { "text": "Solar", "isCorrect": true },
                { "text": "Sun", "isCorrect": false },
                { "text": "Safe", "isCorrect": false },
                { "text": "Sustainable", "isCorrect": false }
            ],
            "rationale": "1. Phân tích ngữ cảnh:\n- Nguồn: \"from the sun\" (từ mặt trời).\n- Đặc điểm: \"clean, renewable\" (sạch, tái tạo).\n\n2. Từ cần điền:\n- Bắt đầu bằng chữ 'S'.\n- \"Solar energy\" (Năng lượng mặt trời).\n\n3. Dịch nghĩa: \"Năng lượng mặt trời tạo ra nguồn điện sạch, tái tạo từ mặt trời.\"\n\n4. Tại sao sai?\n- Sun: Sai loại từ (cần tính từ).\n- Safe/Sustainable: Đúng nhưng không cụ thể bằng Solar."
            },
            {
            "questionNumber": 3,
            "question": "Low energy light b____________ use less than 20% of the energy of an incandescent one.",
            "answerOptions": [
                { "text": "bulbs", "isCorrect": true },
                { "text": "beams", "isCorrect": false },
                { "text": "batteries", "isCorrect": false },
                { "text": "blocks", "isCorrect": false }
            ],
            "rationale": "1. Phân tích ngữ cảnh:\n- Chủ ngữ liên quan đến ánh sáng (light).\n- So sánh với \"incandescent one\" (bóng đèn sợi đốt).\n\n2. Đáp án đúng:\n- \"Light bulbs\" (Bóng đèn).\n\n3. Dịch nghĩa: \"Bóng đèn tiết kiệm năng lượng sử dụng ít hơn 20% năng lượng so với bóng đèn sợi đốt.\"\n\n4. Tại sao sai?\n- Beams/Batteries/Blocks: Không tạo thành cụm từ hợp lý."
            },
            {
            "questionNumber": 4,
            "question": "Coal is a f____________ fuel that was formed millions of years ago.",
            "answerOptions": [
                { "text": "fossil", "isCorrect": true },
                { "text": "finite", "isCorrect": false },
                { "text": "famous", "isCorrect": false },
                { "text": "fast", "isCorrect": false }
            ],
            "rationale": "1. Phân tích ngữ cảnh:\n- Coal (than đá) hình thành triệu năm trước.\n\n2. Đáp án đúng:\n- \"Fossil fuel\" (Nhiên liệu hóa thạch).\n\n3. Dịch nghĩa: \"Than đá là một loại nhiên liệu hóa thạch được hình thành từ hàng triệu năm trước.\""
            },
            {
            "questionNumber": 5,
            "question": "R____________ energy sources will never run out because they are easily replenished.",
            "answerOptions": [
                { "text": "Renewable", "isCorrect": true },
                { "text": "Rare", "isCorrect": false },
                { "text": "Real", "isCorrect": false },
                { "text": "Rich", "isCorrect": false }
            ],
            "rationale": "1. Phân tích ngữ cảnh:\n- \"Never run out\" (không bao giờ cạn) -> Có thể tái tạo.\n\n2. Đáp án đúng:\n- \"Renewable energy\" (Năng lượng tái tạo).\n\n3. Dịch nghĩa: \"Các nguồn năng lượng tái tạo sẽ không bao giờ cạn kiệt vì chúng dễ dàng được tái tạo.\""
            },
            {
            "questionNumber": 6,
            "question": "Burning fossil fuels emits a lot of pollutants that are h____________ to the environment.",
            "answerOptions": [
                { "text": "harmful", "isCorrect": true },
                { "text": "hard", "isCorrect": false },
                { "text": "helpful", "isCorrect": false },
                { "text": "huge", "isCorrect": false }
            ],
            "rationale": "1. Phân tích:\n- Pollutants (chất ô nhiễm) -> Gây hại.\n- Cấu trúc: Harmful to (có hại cho).\n\n2. Dịch nghĩa: \"Đốt nhiên liệu hóa thạch thải ra nhiều chất ô nhiễm có hại cho môi trường.\""
            },
            {
            "questionNumber": 7,
            "question": "Solar p____________ are fitted to a building and turn the sun's rays into energy.",
            "answerOptions": [
                { "text": "panels", "isCorrect": true },
                { "text": "power", "isCorrect": false },
                { "text": "plants", "isCorrect": false },
                { "text": "parts", "isCorrect": false }
            ],
            "rationale": "1. Phân tích:\n- Thiết bị lắp vào nhà, chuyển nắng thành điện -> Solar panels.\n\n2. Dịch nghĩa: \"Các tấm pin mặt trời được lắp vào tòa nhà và chuyển đổi tia nắng mặt trời thành năng lượng.\""
            },
            {
            "questionNumber": 8,
            "question": "You should switch the light off when leaving the room to save e____________.",
            "answerOptions": [
                { "text": "energy", "isCorrect": true },
                { "text": "electricity", "isCorrect": true },
                { "text": "environment", "isCorrect": false },
                { "text": "economy", "isCorrect": false }
            ],
            "rationale": "1. Phân tích:\n- Tắt đèn -> Tiết kiệm năng lượng/điện.\n- Từ chủ đề bài học là \"Energy\".\n\n2. Dịch nghĩa: \"Bạn nên tắt đèn khi rời khỏi phòng để tiết kiệm năng lượng.\""
            },
            {
            "questionNumber": 9,
            "question": "Once non-renewable energy sources are used ____________, they are gone forever.",
            "answerOptions": [
                { "text": "up", "isCorrect": true },
                { "text": "out", "isCorrect": false },
                { "text": "for", "isCorrect": false },
                { "text": "off", "isCorrect": false }
            ],
            "rationale": "1. Cụm động từ:\n- Use up: Dùng hết sạch, cạn kiệt.\n\n2. Dịch nghĩa: \"Một khi các nguồn năng lượng không tái tạo bị dùng hết, chúng sẽ biến mất mãi mãi.\""
            },
            {
            "questionNumber": 10,
            "question": "Many chemicals have a damaging effect ____________ the environment.",
            "answerOptions": [
                { "text": "on", "isCorrect": true },
                { "text": "in", "isCorrect": false },
                { "text": "to", "isCorrect": false },
                { "text": "for", "isCorrect": false }
            ],
            "rationale": "1. Cấu trúc:\n- Have an effect ON something (Có tác động lên cái gì).\n\n2. Dịch nghĩa: \"Nhiều hóa chất có tác động gây hại lên môi trường.\""
            },
            {
            "questionNumber": 11,
            "question": "Renewable energy is also called \"____________ energy\" because it doesn't pollute the air.",
            "answerOptions": [
                { "text": "clean", "isCorrect": true },
                { "text": "inexhaustible", "isCorrect": false },
                { "text": "available", "isCorrect": false },
                { "text": "dangerous", "isCorrect": false }
            ],
            "rationale": "1. Phân tích:\n- Không gây ô nhiễm = Clean (Sạch).\n\n2. Dịch nghĩa: \"Năng lượng tái tạo còn được gọi là 'năng lượng sạch' vì nó không làm ô nhiễm không khí.\""
            },
            {
            "questionNumber": 12,
            "question": "____________ coal causes air pollution, it still plays an important role in the production of electricity around the world.",
            "answerOptions": [
                { "text": "Even though", "isCorrect": true },
                { "text": "Due to", "isCorrect": false },
                { "text": "Because", "isCorrect": false },
                { "text": "However", "isCorrect": false }
            ],
            "rationale": "1. Ngữ pháp:\n- Hai vế đối lập: Gây ô nhiễm <-> Quan trọng.\n- Cần từ chỉ sự nhượng bộ + Mệnh đề -> Even though.\n\n2. Dịch nghĩa: \"Mặc dù than đá gây ô nhiễm không khí, nó vẫn đóng vai trò quan trọng trong sản xuất điện.\""
            },
            {
            "questionNumber": 13,
            "question": "What ____________ if carbon dioxide levels continue to increase?",
            "answerOptions": [
                { "text": "will happen", "isCorrect": true },
                { "text": "happen", "isCorrect": false },
                { "text": "happened", "isCorrect": false },
                { "text": "is happening", "isCorrect": false }
            ],
            "rationale": "1. Ngữ pháp:\n- Câu điều kiện loại 1 (If + Hiện tại đơn, Will + V).\n\n2. Dịch nghĩa: \"Điều gì sẽ xảy ra nếu mức CO2 tiếp tục tăng?\""
            },
            {
            "questionNumber": 14,
            "question": "The use of wind energy is growing rapidly because it is widely available and ____________.",
            "answerOptions": [
                { "text": "environmentally friendly", "isCorrect": true },
                { "text": "environmental friendly", "isCorrect": false },
                { "text": "environment friendly", "isCorrect": false },
                { "text": "friendly environmental", "isCorrect": false }
            ],
            "rationale": "1. Ngữ pháp:\n- Cấu trúc: Adv + Adj (Trạng từ bổ nghĩa cho tính từ).\n- Environmentally friendly: Thân thiện với môi trường.\n\n2. Dịch nghĩa: \"Sử dụng năng lượng gió đang tăng nhanh vì nó có sẵn và thân thiện với môi trường.\""
            },
            {
            "questionNumber": 15,
            "question": "Using solar panels at home can help ____________ your electric bill and your carbon footprint.",
            "answerOptions": [
                { "text": "reduce", "isCorrect": true },
                { "text": "increase", "isCorrect": false },
                { "text": "provide", "isCorrect": false },
                { "text": "convert", "isCorrect": false }
            ],
            "rationale": "1. Phân tích nghĩa:\n- Dùng năng lượng mặt trời -> Giảm tiền điện.\n- Reduce (v): Giảm.\n\n2. Dịch nghĩa: \"Sử dụng tấm pin mặt trời tại nhà có thể giúp giảm hóa đơn tiền điện và dấu chân carbon của bạn.\""
            },
            {
            "questionNumber": 16,
            "question": "Wind power is the most promising ____________ source of energy.",
            "answerOptions": [
                { "text": "alternative", "isCorrect": true },
                { "text": "non-renewable", "isCorrect": false },
                { "text": "natural", "isCorrect": false },
                { "text": "limited", "isCorrect": false }
            ],
            "rationale": "1. Phân tích:\n- Alternative energy source: Nguồn năng lượng thay thế (cho năng lượng hóa thạch).\n\n2. Dịch nghĩa: \"Điện gió là nguồn năng lượng thay thế hứa hẹn nhất.\""
            },
            {
            "questionNumber": 17,
            "question": "You can save much water by ____________.",
            "answerOptions": [
                { "text": "taking showers instead of baths", "isCorrect": true },
                { "text": "using energy saving light bulbs", "isCorrect": false },
                { "text": "using biogas for cooking", "isCorrect": false },
                { "text": "walking or riding a bike to school", "isCorrect": false }
            ],
            "rationale": "1. Logic:\n- Save water (Tiết kiệm nước) -> Chọn hành động liên quan đến nước.\n- Shower (vòi sen) tốn ít nước hơn Bath (bồn tắm).\n\n2. Dịch nghĩa: \"Bạn có thể tiết kiệm nhiều nước bằng cách tắm vòi sen thay vì tắm bồn.\""
            },
            {
            "questionNumber": 18,
            "question": "'Is it difficult to reduce our carbon footprints?' '____________'",
            "answerOptions": [
                { "text": "Not at all. Just practicing the 3R's.", "isCorrect": true },
                { "text": "It depends on the way you think.", "isCorrect": false },
                { "text": "It's not if we still rely on fossil fuels.", "isCorrect": false },
                { "text": "I'm not sure. What will happen?", "isCorrect": false }
            ],
            "rationale": "1. Hội thoại:\n- Hỏi: Có khó không? (Is it difficult?).\n- Trả lời: Not at all (Không hề) + Giải pháp (3R: Reduce, Reuse, Recycle).\n\n2. Dịch nghĩa: \"'Giảm dấu chân carbon có khó không?' - 'Không hề. Chỉ cần thực hành 3R thôi.'\""
            },
            {
            "questionNumber": 19,
            "question": "Most non-renewable energy sources (be) ____________ fossil fuels: coal, petroleum, and natural gas.",
            "answerOptions": [
                { "text": "are", "isCorrect": true },
                { "text": "is", "isCorrect": false },
                { "text": "were", "isCorrect": false },
                { "text": "be", "isCorrect": false }
            ],
            "rationale": "1. Ngữ pháp:\n- Chủ ngữ số nhiều (sources).\n- Thì hiện tại đơn (sự thật hiển nhiên).\n-> Chia \"are\".\n\n2. Dịch nghĩa: \"Hầu hết các nguồn năng lượng không tái tạo là nhiên liệu hóa thạch...\""
            },
            {
            "questionNumber": 20,
            "question": "I think alternative energy sources (not replace) ____________ coal, oil, and gas soon.",
            "answerOptions": [
                { "text": "will not replace", "isCorrect": true },
                { "text": "not replace", "isCorrect": false },
                { "text": "don't replace", "isCorrect": false },
                { "text": "are not replacing", "isCorrect": false }
            ],
            "rationale": "1. Ngữ pháp:\n- \"I think\" + \"soon\" -> Dự đoán tương lai.\n- Tương lai đơn (Future Simple): will not replace.\n\n2. Dịch nghĩa: \"Tôi nghĩ các nguồn năng lượng thay thế sẽ không sớm thay thế được than, dầu và khí đốt.\""
            },
            {
            "questionNumber": 21,
            "question": "At present, global demand for energy (increase) ____________ rapidly.",
            "answerOptions": [
                { "text": "is increasing", "isCorrect": true },
                { "text": "increases", "isCorrect": false },
                { "text": "are increasing", "isCorrect": false },
                { "text": "increase", "isCorrect": false }
            ],
            "rationale": "1. Ngữ pháp:\n- \"At present\" (Hiện tại) -> Hiện tại tiếp diễn.\n- Chủ ngữ \"Global demand\" (số ít).\n-> Chia \"is increasing\".\n\n2. Dịch nghĩa: \"Hiện tại, nhu cầu năng lượng toàn cầu đang tăng nhanh chóng.\""
            },
            {
            "questionNumber": 22,
            "question": "Three years ago, we (install) ____________ a solar water heating system on our roof.",
            "answerOptions": [
                { "text": "installed", "isCorrect": true },
                { "text": "install", "isCorrect": false },
                { "text": "have installed", "isCorrect": false },
                { "text": "was installing", "isCorrect": false }
            ],
            "rationale": "1. Ngữ pháp:\n- \"Three years ago\" (3 năm trước) -> Quá khứ đơn.\n-> Chia \"installed\".\n\n2. Dịch nghĩa: \"Ba năm trước, chúng tôi đã lắp đặt hệ thống nước nóng năng lượng mặt trời trên mái nhà.\""
            },
            {
            "questionNumber": 23,
            "question": "If we (reduce) ____________ the energy we use, we (save) ____________ money.",
            "answerOptions": [
                { "text": "reduce - will save", "isCorrect": true },
                { "text": "reduce - save", "isCorrect": false },
                { "text": "reduced - would save", "isCorrect": false },
                { "text": "will reduce - save", "isCorrect": false }
            ],
            "rationale": "1. Ngữ pháp:\n- Câu điều kiện loại 1 (If + HTĐ, Tương lai đơn).\n\n2. Dịch nghĩa: \"Nếu chúng ta giảm lượng năng lượng sử dụng, chúng ta sẽ tiết kiệm được tiền.\""
            },
            {
            "questionNumber": 24,
            "question": "Wind power (not generate) ____________ carbon emissions.",
            "answerOptions": [
                { "text": "doesn't generate", "isCorrect": true },
                { "text": "don't generate", "isCorrect": false },
                { "text": "won't generate", "isCorrect": false },
                { "text": "not generating", "isCorrect": false }
            ],
            "rationale": "1. Ngữ pháp:\n- Sự thật hiển nhiên -> Hiện tại đơn.\n- Chủ ngữ số ít (Wind power) -> doesn't generate.\n\n2. Dịch nghĩa: \"Năng lượng gió không tạo ra khí thải carbon.\""
            },
            {
            "questionNumber": 25,
            "question": "(you/ do) ____________ a project on energy sources at the moment?",
            "answerOptions": [
                { "text": "Are you doing", "isCorrect": true },
                { "text": "Do you do", "isCorrect": false },
                { "text": "Did you do", "isCorrect": false },
                { "text": "Have you done", "isCorrect": false }
            ],
            "rationale": "1. Ngữ pháp:\n- \"at the moment\" (ngay lúc này) -> Hiện tại tiếp diễn.\n- Câu hỏi với You -> Are you doing...?\n\n2. Dịch nghĩa: \"Bạn đang làm dự án về các nguồn năng lượng lúc này phải không?\""
            },
            {
            "questionNumber": 26,
            "question": "Burning fossil fuels (emit) ____________ gases that are harmful to the environment.",
            "answerOptions": [
                { "text": "emits", "isCorrect": true },
                { "text": "emit", "isCorrect": false },
                { "text": "emitting", "isCorrect": false },
                { "text": "are emitting", "isCorrect": false }
            ],
            "rationale": "1. Ngữ pháp:\n- Chủ ngữ là danh động từ \"Burning\" -> Động từ chia số ít (emits).\n- Lưu ý: Không chia theo \"fuels\".\n\n2. Dịch nghĩa: \"Việc đốt nhiên liệu hóa thạch thải ra các khí có hại cho môi trường.\""
            },
            {
            "questionNumber": 27,
            "question": "We decided (invest) ____________ our time and effort on this new research project.",
            "answerOptions": [
                { "text": "to invest", "isCorrect": true },
                { "text": "investing", "isCorrect": false },
                { "text": "invest", "isCorrect": false },
                { "text": "invested", "isCorrect": false }
            ],
            "rationale": "1. Cấu trúc:\n- Decide + to V (Quyết định làm gì).\n\n2. Dịch nghĩa: \"Chúng tôi đã quyết định đầu tư thời gian và công sức vào dự án nghiên cứu mới này.\""
            },
            {
            "questionNumber": 28,
            "question": "You should avoid (use) ____________ cars or motorbikes for short trips.",
            "answerOptions": [
                { "text": "using", "isCorrect": true },
                { "text": "to use", "isCorrect": false },
                { "text": "use", "isCorrect": false },
                { "text": "used", "isCorrect": false }
            ],
            "rationale": "1. Cấu trúc:\n- Avoid + V-ing (Tránh làm gì).\n\n2. Dịch nghĩa: \"Bạn nên tránh sử dụng ô tô hoặc xe máy cho những quãng đường ngắn.\""
            }
            ]
        };

        // --- GAME LOGIC ---

        const container = document.getElementById('quiz-container');
        let correctCount = 0;
        let answeredCount = 0;
        const totalQuestions = quizData.questions.length;

        function renderQuiz() {
            quizData.questions.forEach((q, index) => {
                const card = document.createElement('div');
                card.className = 'quiz-card';
                card.id = `q-card-${index}`;

                // Question Header
                const qNum = document.createElement('div');
                qNum.className = 'question-number';
                qNum.innerText = `Câu ${q.questionNumber}`;
                card.appendChild(qNum);

                // Question Text
                const qText = document.createElement('div');
                qText.className = 'question-text';
                qText.innerHTML = q.question; // Support HTML formatting if needed
                card.appendChild(qText);

                // Options Container
                const optionsDiv = document.createElement('div');
                optionsDiv.className = 'options-grid';

                q.answerOptions.forEach((opt, optIndex) => {
                    const btn = document.createElement('button');
                    btn.className = 'option-btn';
                    btn.id = `btn-${index}-${optIndex}`;
                    
                    const label = String.fromCharCode(65 + optIndex); // A, B, C, D
                    
                    btn.innerHTML = `<span class="option-label">${label}</span> ${opt.text}`;
                    
                    btn.onclick = () => checkAnswer(index, optIndex, opt.isCorrect);
                    
                    optionsDiv.appendChild(btn);
                });
                card.appendChild(optionsDiv);

                // Explanation Box (Hidden initially)
                const explainDiv = document.createElement('div');
                explainDiv.className = 'explanation-box';
                explainDiv.id = `explain-${index}`;
                
                const explainTitle = document.createElement('div');
                explainTitle.className = 'explanation-title';
                explainTitle.innerHTML = `<i class="fas fa-chalkboard-teacher teacher-avatar"></i> Cô Mai An giải thích:`;
                
                const explainContent = document.createElement('div');
                explainContent.className = 'explanation-content';
                explainContent.innerText = q.rationale;

                explainDiv.appendChild(explainTitle);
                explainDiv.appendChild(explainContent);
                card.appendChild(explainDiv);

                container.appendChild(card);
            });
        }

        function checkAnswer(qIndex, optIndex, isCorrect) {
            const card = document.getElementById(`q-card-${qIndex}`);
            const btns = card.querySelectorAll('.option-btn');
            const explainBox = document.getElementById(`explain-${qIndex}`);
            
            // Prevent re-answering
            if (card.getAttribute('data-answered') === 'true') return;
            card.setAttribute('data-answered', 'true');
            answeredCount++;

            // Highlight Logic
            btns.forEach((btn, idx) => {
                btn.disabled = true; // Disable all buttons
                if (idx === optIndex) {
                    if (isCorrect) {
                        btn.classList.add('correct');
                        playAudio('sound-ding');
                        fireConfetti(btn);
                        correctCount++;
                    } else {
                        btn.classList.add('wrong');
                        playAudio('sound-buzz');
                    }
                }
                
                // Always show the correct answer if wrong was selected
                const questionData = quizData.questions[qIndex];
                if (questionData.answerOptions[idx].isCorrect) {
                     btn.classList.add('correct');
                     // If user chose wrong, this highlight shows them the right one
                }
            });

            // Show explanation
            explainBox.style.display = 'block';
        }

        function fireConfetti(element) {
            const rect = element.getBoundingClientRect();
            // Normalized coordinates for confetti
            const x = (rect.left + rect.width / 2) / window.innerWidth;
            const y = (rect.top + rect.height / 2) / window.innerHeight;

            confetti({
                particleCount: 60,
                spread: 70,
                origin: { x: x, y: y },
                colors: ['#8854C0', '#00C9A7', '#ff7675', '#ffeaa7']
            });
        }

        function playAudio(id) {
            const audio = document.getElementById(id);
            if (audio) {
                audio.currentTime = 0;
                audio.play().catch(e => console.log("Audio play blocked by browser policy"));
            }
        }

        function showSummary() {
            const modal = document.getElementById('resultModal');
            const scoreDisplay = document.getElementById('final-score');
            const msgDisplay = document.getElementById('final-message');
            const cheerAudio = document.getElementById('sound-cheer');

            scoreDisplay.innerText = `${correctCount}/${totalQuestions}`;
            
            const percentage = (correctCount / totalQuestions) * 100;
            if (percentage === 100) {
                msgDisplay.innerText = "Tuyệt đối! Em là thiên tài!";
                confetti({ particleCount: 200, spread: 100, origin: { y: 0.6 } });
                playAudio('sound-cheer');
            } else if (percentage >= 80) {
                msgDisplay.innerText = "Giỏi lắm! Cố gắng phát huy nhé!";
                playAudio('sound-cheer');
            } else if (percentage >= 50) {
                msgDisplay.innerText = "Khá tốt, nhưng cần ôn lại bài chút nha.";
            } else {
                msgDisplay.innerText = "Đừng buồn, hãy xem kỹ lại giải thích nhé!";
            }

            modal.style.display = 'flex';
        }

        function closeModal() {
            document.getElementById('resultModal').style.display = 'none';
        }

        // Initialize
        renderQuiz();

    </script>
</body>
</html>
