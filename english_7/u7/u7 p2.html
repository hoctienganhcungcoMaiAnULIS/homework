<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Ms Mai An ULIS - Traffic Rules Reading Test</title>
    <link href="https://fonts.googleapis.com/css2?family=Nunito:wght@400;600;800;900&family=Quicksand:wght@500;700&display=swap" rel="stylesheet">
    <style>
        :root {
            --primary: #3498db; /* Blue */
            --secondary: #f1c40f; /* Yellow */
            --correct: #00D26A;
            --correct-shadow: #00a854;
            --incorrect: #FF4757;
            --incorrect-shadow: #cc3945;
            --bg-color: #f0f8ff;
            --text: #2d3436;
            --card-bg: rgba(255, 255, 255, 0.95);
        }

        body, html {
            margin: 0;
            padding: 0;
            font-family: 'Nunito', sans-serif;
            height: 100vh;
            color: var(--text);
            overflow: hidden;
            background-color: var(--bg-color);
            /* DYNAMIC SVG BACKGROUND: Ch·ªß ƒë·ªÅ Giao th√¥ng */
            background-image: url('data:image/svg+xml;utf8,<svg xmlns="http://www.w3.org/2000/svg" width="400" height="400" viewBox="0 0 400 400"><text x="50" y="50" font-size="30" opacity="0.15">üöó</text><text x="250" y="150" font-size="40" opacity="0.15">üö¶</text><text x="100" y="300" font-size="35" opacity="0.15">üõ£Ô∏è</text><text x="350" y="350" font-size="30" opacity="0.15">üõë</text></svg>'), radial-gradient(circle at top left, #e0f2fe, #bae6fd);
        }

        /* HEADER NH·ªé */
        .teacher-header {
            position: fixed;
            top: 10px;
            left: 20px;
            background: var(--secondary);
            color: #333;
            padding: 5px 15px;
            border-radius: 20px;
            font-weight: 800;
            font-family: 'Quicksand', sans-serif;
            z-index: 1000;
            box-shadow: 0 4px 0 #d4ac0d;
            font-size: 14px;
        }

        /* TIMER BAR */
        .top-bar {
            position: fixed;
            top: 0;
            left: 50%;
            transform: translateX(-50%);
            z-index: 1000;
            background: white;
            padding: 10px 30px;
            border-radius: 0 0 20px 20px;
            box-shadow: 0 5px 15px rgba(0,0,0,0.1);
            display: flex;
            align-items: center;
            gap: 15px;
        }

        .timer-display {
            font-size: 24px;
            font-weight: 900;
            font-family: 'Quicksand', sans-serif;
            color: var(--primary);
            min-width: 80px;
            text-align: center;
        }

        .btn-timer {
            background: var(--primary);
            color: white;
            border: none;
            padding: 8px 20px;
            border-radius: 15px;
            font-weight: bold;
            font-family: 'Nunito', sans-serif;
            cursor: pointer;
            box-shadow: 0 4px 0 #2980b9;
            transition: all 0.1s;
        }
        .btn-timer:active {
            transform: translateY(4px);
            box-shadow: 0 0 0 #2980b9;
        }

        /* SPLIT SCREEN LAYOUT */
        .container {
            display: flex;
            width: 100vw;
            height: 100vh;
            padding-top: 60px; /* Space for top bar */
            box-sizing: border-box;
        }

        .left-panel, .right-panel {
            flex: 1;
            height: 100%;
            overflow-y: auto;
            padding: 20px;
            box-sizing: border-box;
        }

        .left-panel {
            border-right: 3px dashed #b2bec3;
        }

        /* SCROLLBAR STYLING */
        ::-webkit-scrollbar { width: 8px; }
        ::-webkit-scrollbar-track { background: transparent; }
        ::-webkit-scrollbar-thumb { background: #b2bec3; border-radius: 10px; }
        ::-webkit-scrollbar-thumb:hover { background: #636e72; }

        /* READING PASSAGE STYLING */
        .passage-card {
            background: var(--card-bg);
            padding: 30px;
            border-radius: 20px;
            box-shadow: 0 10px 30px rgba(0,0,0,0.05);
            margin-bottom: 30px;
            line-height: 1.8;
            font-size: 16px;
        }
        .passage-title {
            color: var(--primary);
            font-family: 'Quicksand', sans-serif;
            font-weight: 800;
            font-size: 22px;
            text-align: center;
            margin-bottom: 20px;
        }
        .paragraph { margin-bottom: 15px; text-align: justify; }

        /* TRANSLATE BUTTON */
        .btn-translate {
            background: #e17055;
            color: white;
            border: none;
            padding: 8px 15px;
            border-radius: 10px;
            font-family: 'Nunito', sans-serif;
            font-weight: bold;
            cursor: pointer;
            box-shadow: 0 4px 0 #d63031;
            margin-top: 10px;
            display: inline-flex;
            align-items: center;
            gap: 5px;
        }
        .btn-translate:active {
            transform: translateY(4px);
            box-shadow: 0 0 0 #d63031;
        }
        .translation-content {
            display: none;
            background: #ffeaa7;
            padding: 15px;
            border-radius: 10px;
            margin-top: 15px;
            color: #d35400;
            font-style: italic;
            border-left: 4px solid #e17055;
        }

        /* GLOSSARY TABLE */
        .glossary {
            width: 100%;
            border-collapse: separate;
            border-spacing: 0;
            margin-top: 20px;
            border-radius: 15px;
            overflow: hidden;
            box-shadow: 0 5px 15px rgba(0,0,0,0.05);
        }
        .glossary th {
            background: var(--primary);
            color: white;
            padding: 12px;
            font-family: 'Quicksand', sans-serif;
        }
        .glossary td {
            background: white;
            padding: 10px 12px;
            border-bottom: 1px solid #eee;
        }
        .glossary tr:last-child td { border-bottom: none; }
        .word-en { font-weight: bold; color: var(--primary); }
        .word-type { color: #e17055; font-size: 0.9em; }

        /* EXERCISE CARD (Gamified) */
        .question-card {
            background: var(--card-bg);
            padding: 25px;
            border-radius: 20px;
            box-shadow: 0 8px 25px rgba(0,0,0,0.08);
            margin-bottom: 25px;
        }
        .question-text {
            font-weight: 800;
            font-size: 18px;
            margin-bottom: 20px;
            font-family: 'Quicksand', sans-serif;
        }
        .options-grid {
            display: grid;
            grid-template-columns: 1fr;
            gap: 12px;
        }
        .option-btn {
            background: white;
            border: 2px solid #dfe6e9;
            padding: 15px 20px;
            border-radius: 15px;
            font-family: 'Nunito', sans-serif;
            font-size: 16px;
            font-weight: 600;
            text-align: left;
            cursor: pointer;
            box-shadow: 0 5px 0 #dfe6e9;
            transition: transform 0.1s, box-shadow 0.1s;
            display: flex;
            align-items: center;
        }
        .option-btn span {
            display: inline-block;
            width: 30px;
            height: 30px;
            background: #f1f2f6;
            border-radius: 50%;
            text-align: center;
            line-height: 30px;
            margin-right: 15px;
            font-weight: bold;
            color: #57606f;
        }
        .option-btn:hover:not(:disabled) {
            transform: scale(1.02);
            border-color: var(--primary);
        }
        .option-btn:active:not(:disabled) {
            transform: translateY(5px);
            box-shadow: 0 0 0 #dfe6e9;
        }
        
        /* Tr·∫°ng th√°i ƒë√∫ng / sai */
        .option-btn.correct {
            background: var(--correct);
            color: white;
            border-color: var(--correct);
            box-shadow: 0 5px 0 var(--correct-shadow);
        }
        .option-btn.correct span { background: rgba(255,255,255,0.2); color: white; }
        
        .option-btn.incorrect {
            background: var(--incorrect);
            color: white;
            border-color: var(--incorrect);
            box-shadow: 0 5px 0 var(--incorrect-shadow);
            animation: shake 0.4s cubic-bezier(.36,.07,.19,.97) both;
        }
        .option-btn.incorrect span { background: rgba(255,255,255,0.2); color: white; }

        @keyframes shake {
            10%, 90% { transform: translate3d(-2px, 0, 0); }
            20%, 80% { transform: translate3d(4px, 0, 0); }
            30%, 50%, 70% { transform: translate3d(-6px, 0, 0); }
            40%, 60% { transform: translate3d(6px, 0, 0); }
        }

        /* EXPLANATION BOX */
        .explanation-box {
            display: none;
            margin-top: 20px;
            background: #f8f9fa;
            border: 2px solid var(--primary);
            border-radius: 15px;
            padding: 20px;
            animation: fadeIn 0.5s ease-in;
        }
        @keyframes fadeIn { from { opacity: 0; transform: translateY(-10px); } to { opacity: 1; transform: translateY(0); } }
        
        .exp-title {
            color: var(--primary);
            font-weight: 900;
            font-family: 'Quicksand', sans-serif;
            margin-bottom: 10px;
            display: flex;
            align-items: center;
            gap: 10px;
        }
        .exp-content { font-size: 15px; line-height: 1.6; }
        .exp-content strong { color: #d63031; }
        .exp-quote {
            background: #e1f5fe;
            padding: 10px;
            border-left: 4px solid var(--primary);
            margin: 10px 0;
            font-style: italic;
        }

        /* SUBMIT BUTTON & MODAL */
        .submit-container { text-align: center; margin: 40px 0; }
        .btn-submit {
            background: linear-gradient(135deg, #a29bfe, #6c5ce7);
            color: white;
            font-size: 22px;
            font-weight: 900;
            padding: 15px 50px;
            border: none;
            border-radius: 30px;
            cursor: pointer;
            box-shadow: 0 8px 0 #4a3f9e;
            font-family: 'Quicksand', sans-serif;
            transition: all 0.2s;
        }
        .btn-submit:active { transform: translateY(8px); box-shadow: 0 0 0 #4a3f9e; }

        .modal-overlay {
            position: fixed;
            top: 0; left: 0; width: 100vw; height: 100vh;
            background: rgba(0,0,0,0.6);
            display: none;
            justify-content: center;
            align-items: center;
            z-index: 2000;
        }
        .result-modal {
            background: white;
            padding: 40px;
            border-radius: 30px;
            text-align: center;
            width: 400px;
            max-width: 90%;
            box-shadow: 0 20px 50px rgba(0,0,0,0.3);
            transform: scale(0.8);
            transition: transform 0.3s cubic-bezier(0.175, 0.885, 0.32, 1.275);
        }
        .result-modal.show { transform: scale(1); }
        .score-circle {
            width: 150px; height: 150px;
            border-radius: 50%;
            background: var(--secondary);
            margin: 0 auto 20px;
            display: flex;
            justify-content: center;
            align-items: center;
            font-size: 40px;
            font-weight: 900;
            color: #333;
            border: 8px solid white;
            box-shadow: 0 0 0 8px var(--secondary);
        }
        .feedback-text { font-size: 24px; font-weight: 800; color: var(--primary); margin-bottom: 10px; }
        .feedback-subtext { color: #636e72; margin-bottom: 20px; }
        
        /* CONFETTI CANVAS */
        #confetti { position: fixed; top: 0; left: 0; width: 100%; height: 100%; pointer-events: none; z-index: 1500; }
        
        /* TOAST ALERT */
        .toast {
            position: fixed; top: 20px; right: -300px;
            background: #ff7675; color: white; padding: 15px 25px;
            border-radius: 10px; font-weight: bold; box-shadow: 0 5px 15px rgba(0,0,0,0.2);
            transition: right 0.5s cubic-bezier(0.68, -0.55, 0.265, 1.55);
            z-index: 3000; max-width: 300px;
        }
        .toast.show { right: 20px; }

        /* RESPONSIVE */
        @media (max-width: 900px) {
            .container { flex-direction: column; height: auto; padding-top: 80px; }
            .left-panel, .right-panel { height: auto; overflow: visible; }
            .left-panel { border-right: none; border-bottom: 3px dashed #b2bec3; }
        }
    </style>
</head>
<body>

    <div class="teacher-header">üë©‚Äçüè´ Ms Mai An ULIS</div>

    <div class="top-bar">
        <div class="timer-display" id="timer">10:00</div>
        <button class="btn-timer" id="btn-timer-control" onclick="toggleTimer()">B·∫ÆT ƒê·∫¶U T√çNH GI·ªú</button>
    </div>

    <canvas id="confetti"></canvas>
    <div id="toast" class="toast"></div>

    <div class="container">
        <div class="left-panel">
            
            <div class="passage-card">
                <div class="passage-title">PASSAGE 1</div>
                <div class="paragraph">
                    <strong>Read the following passage and mark the letter A, B, C or D on your answer sheet to indicate the correct answer to each of the following questions from 31 to 36.</strong>
                </div>
                <div class="paragraph">
                    <strong>Key Points to Remember on Traffic Rules in England</strong><br>
                    Below are some key points you need to remember when you travel in England.
                </div>
                <div class="paragraph">
                    <strong>The general rule of keeping left:</strong> When you are driving on a road which is a two-way road, you need to allow the traffic from the opposite direction to pass from your right side. Similarly, all the vehicles in your lane also need to be given the right side to overtake.
                </div>
                <div class="paragraph">
                    <strong>When you turn:</strong> When you are taking a turn, always keep to your turning side, meaning when turning right, get to the right side of the road and do the same when turning to the left.
                </div>
                <div class="paragraph">
                    <strong>Do not park:</strong> Surely, you want to park your vehicle as fast as you can, but that doesn't mean you leave your car on the side of the road. Find the parking near your building and park it there. If parking is not available, make sure you are not parking near the bus stand, school, or hospital entrance.
                </div>
                <div class="paragraph">
                    <strong>Do not drive:</strong> When you are going on a one-way road, you cannot reverse your vehicle.
                </div>
                <div class="paragraph">
                    <strong>Use indicators:</strong> When you are changing lanes, overtaking the other can or taking a turn always use turn signals or indicators to make the following drivers know about your man.
                </div>
                <div class="paragraph">
                    <strong>Do not cross the stop lines:</strong> As the traffic signal, when you get to stop your vehicle due to a red signal, make sure you are not keeping your car on the stop line or on the pedestrian crossing.
                </div>

                <button class="btn-translate" onclick="toggleTranslation('trans1')">üëÅÔ∏è XEM B·∫¢N D·ªäCH ƒê·∫¶Y ƒê·ª¶</button>
                <div class="translation-content" id="trans1">
                    <strong>Nh·ªØng ƒëi·ªÉm ch√≠nh c·∫ßn nh·ªõ v·ªÅ Lu·∫≠t giao th√¥ng ·ªü Anh</strong><br>
                    D∆∞·ªõi ƒë√¢y l√† m·ªôt s·ªë ƒëi·ªÉm ch√≠nh b·∫°n c·∫ßn nh·ªõ khi ƒëi du l·ªãch ·ªü Anh.<br><br>
                    <strong>Quy t·∫Øc chung v·ªÅ vi·ªác ƒëi b√™n tr√°i:</strong> Khi b·∫°n ƒëang l√°i xe tr√™n ƒë∆∞·ªùng hai chi·ªÅu, b·∫°n c·∫ßn ƒë·ªÉ c√°c ph∆∞∆°ng ti·ªán ƒëi ng∆∞·ª£c chi·ªÅu v∆∞·ª£t qua t·ª´ ph√≠a b√™n ph·∫£i c·ªßa b·∫°n. T∆∞∆°ng t·ª±, t·∫•t c·∫£ c√°c ph∆∞∆°ng ti·ªán trong l√†n ƒë∆∞·ªùng c·ªßa b·∫°n c≈©ng c·∫ßn ƒë∆∞·ª£c nh∆∞·ªùng kho·∫£ng tr·ªëng b√™n ph·∫£i ƒë·ªÉ v∆∞·ª£t.<br><br>
                    <strong>Khi b·∫°n r·∫Ω:</strong> Khi b·∫°n r·∫Ω, h√£y lu√¥n ƒëi s√°t v·ªÅ ph√≠a b·∫°n mu·ªën r·∫Ω, nghƒ©a l√† khi r·∫Ω ph·∫£i, h√£y ƒëi sang m√©p ƒë∆∞·ªùng b√™n ph·∫£i v√† l√†m t∆∞∆°ng t·ª± khi r·∫Ω tr√°i.<br><br>
                    <strong>Kh√¥ng ƒë·ªó xe b·ª´a b√£i:</strong> Ch·∫Øc ch·∫Øn l√† b·∫°n mu·ªën ƒë·ªó xe c√†ng nhanh c√†ng t·ªët, nh∆∞ng ƒëi·ªÅu ƒë√≥ kh√¥ng c√≥ nghƒ©a l√† b·∫°n ƒë·ªÉ xe ngay b√™n v·ªá ƒë∆∞·ªùng. H√£y t√¨m b√£i ƒë·ªó xe g·∫ßn t√≤a nh√† c·ªßa b·∫°n v√† ƒë·ªó ·ªü ƒë√≥. N·∫øu kh√¥ng c√≥ b√£i ƒë·ªó xe, h√£y ƒë·∫£m b·∫£o r·∫±ng b·∫°n kh√¥ng ƒë·ªó xe g·∫ßn tr·∫°m xe bu√Ωt, tr∆∞·ªùng h·ªçc ho·∫∑c c·ªïng b·ªánh vi·ªán.<br><br>
                    <strong>Kh√¥ng l√°i xe:</strong> Khi b·∫°n ƒëang ƒëi tr√™n ƒë∆∞·ªùng m·ªôt chi·ªÅu, b·∫°n kh√¥ng ƒë∆∞·ª£c ph√©p l√πi xe.<br><br>
                    <strong>S·ª≠ d·ª•ng ƒë√®n xi-nhan:</strong> Khi b·∫°n chuy·ªÉn l√†n, v∆∞·ª£t xe kh√°c ho·∫∑c r·∫Ω, h√£y lu√¥n s·ª≠ d·ª•ng t√≠n hi·ªáu r·∫Ω ho·∫∑c ƒë√®n xi-nhan ƒë·ªÉ cho nh·ªØng t√†i x·∫ø ƒëi ph√≠a sau bi·∫øt v·ªÅ √Ω ƒë·ªãnh c·ªßa b·∫°n.<br><br>
                    <strong>Kh√¥ng v∆∞·ª£t v·∫°ch d·ª´ng:</strong> Theo t√≠n hi·ªáu giao th√¥ng, khi b·∫°n ph·∫£i d·ª´ng xe v√¨ ƒë√®n ƒë·ªè, h√£y ƒë·∫£m b·∫£o r·∫±ng b·∫°n kh√¥ng ƒë·ªó xe ƒë√® l√™n v·∫°ch d·ª´ng ho·∫∑c tr√™n v·∫°ch k·∫ª ƒë∆∞·ªùng d√†nh cho ng∆∞·ªùi ƒëi b·ªô.
                </div>

                <table class="glossary">
                    <tr><th>T·ª´ v·ª±ng (Vocabulary)</th><th>Lo·∫°i t·ª´ (POS)</th><th>Nghƒ©a ti·∫øng Vi·ªát (Meaning)</th></tr>
                    <tr><td class="word-en">Opposite</td><td class="word-type">adj</td><td>ƒê·ªëi di·ªán, ng∆∞·ª£c chi·ªÅu</td></tr>
                    <tr><td class="word-en">Overtake</td><td class="word-type">v</td><td>V∆∞·ª£t (xe kh√°c)</td></tr>
                    <tr><td class="word-en">Vehicle</td><td class="word-type">n</td><td>Ph∆∞∆°ng ti·ªán giao th√¥ng</td></tr>
                    <tr><td class="word-en">Available</td><td class="word-type">adj</td><td>C√≥ s·∫µn, tr·ªëng (ch·ªó ƒë·ªó xe)</td></tr>
                    <tr><td class="word-en">Entrance</td><td class="word-type">n</td><td>C·ªïng v√†o, l·ªëi v√†o</td></tr>
                    <tr><td class="word-en">Reverse</td><td class="word-type">v</td><td>L√πi (xe), ƒë·∫£o ng∆∞·ª£c</td></tr>
                    <tr><td class="word-en">Indicator</td><td class="word-type">n</td><td>ƒê√®n b√°o r·∫Ω (ƒë√®n xi-nhan)</td></tr>
                    <tr><td class="word-en">Pedestrian</td><td class="word-type">n</td><td>Ng∆∞·ªùi ƒëi b·ªô</td></tr>
                    <tr><td class="word-en">Intersection</td><td class="word-type">n</td><td>Ng√£ t∆∞, giao l·ªô (t·ª´ m·ªü r·ªông)</td></tr>
                    <tr><td class="word-en">Accessible</td><td class="word-type">adj</td><td>C√≥ th·ªÉ ti·∫øp c·∫≠n ƒë∆∞·ª£c</td></tr>
                </table>
            </div>

            <div class="passage-card">
                <div class="passage-title">PASSAGE 2</div>
                <div class="paragraph">
                    <strong>Four phrases/ sentences have been removed from the text below. For each question, mark the letter A, B, C or D on your answer sheet to indicate the correct option that best fits each of the numbered blanks from 37 to 40.</strong>
                </div>
                <div class="paragraph">
                    Traffic congestion is when vehicles travel slower because there is too much traffic on roads. This makes trip times longer and increases queueing. <strong>(37) _____</strong>. Congestion may result from a decrease in capacity, for example accidents on the road or roads being closed. <strong>(38) _______</strong>. Increased traffic, for example, by many cars leaving a sports stadium at the same time, can also cause congestion.
                </div>
                <div class="paragraph">
                    Where congestion is common, <strong>(39) _____</strong>. Cars may be banned in certain districts or certain times, or made to carry passengers or pay a fee, or people may use public transport, <strong>(40) _____</strong>.
                </div>
                <div class="paragraph" style="background: #f1f2f6; padding: 15px; border-radius: 10px; font-weight: bold;">
                    A. Which travel independently of car traffic and are not affected by traffic jams.<br>
                    B. This is also known as a traffic jam.<br>
                    C. Bad road layouts can also restrict capacity.<br>
                    D. Several methods are used to relieve it.
                </div>

                <button class="btn-translate" onclick="toggleTranslation('trans2')">üëÅÔ∏è XEM B·∫¢N D·ªäCH ƒê·∫¶Y ƒê·ª¶</button>
                <div class="translation-content" id="trans2">
                    T·∫Øc ngh·∫Ωn giao th√¥ng l√† khi c√°c ph∆∞∆°ng ti·ªán di chuy·ªÉn ch·∫≠m h∆°n v√¨ c√≥ qu√° nhi·ªÅu xe c·ªô tr√™n ƒë∆∞·ªùng. ƒêi·ªÅu n√†y l√†m cho th·ªùi gian di chuy·ªÉn d√†i h∆°n v√† tƒÉng t√¨nh tr·∫°ng x·∫øp h√†ng ch·ªù ƒë·ª£i. <strong>(37) ƒêi·ªÅu n√†y c√≤n ƒë∆∞·ª£c g·ªçi l√† k·∫πt xe (traffic jam)</strong>. T·∫Øc ngh·∫Ωn c√≥ th·ªÉ b·∫Øt ngu·ªìn t·ª´ vi·ªác gi·∫£m s·ª©c ch·ª©a c·ªßa ƒë∆∞·ªùng, v√≠ d·ª• nh∆∞ tai n·∫°n tr√™n ƒë∆∞·ªùng ho·∫∑c ƒë∆∞·ªùng b·ªã phong t·ªèa. <strong>(38) Vi·ªác b·ªë tr√≠ ƒë∆∞·ªùng s√° t·ªìi t·ªá c≈©ng c√≥ th·ªÉ h·∫°n ch·∫ø s·ª©c ch·ª©a</strong>. L∆∞u l∆∞·ª£ng giao th√¥ng tƒÉng l√™n, v√≠ d·ª•, do nhi·ªÅu √¥ t√¥ r·ªùi kh·ªèi m·ªôt s√¢n v·∫≠n ƒë·ªông th·ªÉ thao c√πng l√∫c, c≈©ng c√≥ th·ªÉ g√¢y ra t·∫Øc ngh·∫Ωn.<br><br>
                    ·ªû nh·ªØng n∆°i t·∫Øc ngh·∫Ωn ph·ªï bi·∫øn, <strong>(39) m·ªôt s·ªë ph∆∞∆°ng ph√°p ƒë∆∞·ª£c s·ª≠ d·ª•ng ƒë·ªÉ gi·∫£m b·ªõt n√≥</strong>. √î t√¥ c√≥ th·ªÉ b·ªã c·∫•m ·ªü m·ªôt s·ªë qu·∫≠n nh·∫•t ƒë·ªãnh ho·∫∑c v√†o nh·ªØng th·ªùi ƒëi·ªÉm nh·∫•t ƒë·ªãnh, ho·∫∑c b·ªã b·∫Øt bu·ªôc ph·∫£i ch·ªü th√™m h√†nh kh√°ch ho·∫∑c tr·∫£ ph√≠, ho·∫∑c ng∆∞·ªùi d√¢n c√≥ th·ªÉ s·ª≠ d·ª•ng ph∆∞∆°ng ti·ªán giao th√¥ng c√¥ng c·ªông, <strong>(40) nh·ªØng ph∆∞∆°ng ti·ªán di chuy·ªÉn ƒë·ªôc l·∫≠p v·ªõi giao th√¥ng √¥ t√¥ v√† kh√¥ng b·ªã ·∫£nh h∆∞·ªüng b·ªüi k·∫πt xe</strong>.
                </div>

                <table class="glossary">
                    <tr><th>T·ª´ v·ª±ng (Vocabulary)</th><th>Lo·∫°i t·ª´ (POS)</th><th>Nghƒ©a ti·∫øng Vi·ªát (Meaning)</th></tr>
                    <tr><td class="word-en">Congestion</td><td class="word-type">n</td><td>S·ª± t·∫Øc ngh·∫Ωn, k·∫πt xe</td></tr>
                    <tr><td class="word-en">Queueing</td><td class="word-type">n</td><td>S·ª± x·∫øp h√†ng, n·ªëi ƒëu√¥i nhau</td></tr>
                    <tr><td class="word-en">Decrease</td><td class="word-type">n/v</td><td>S·ª± suy gi·∫£m / L√†m gi·∫£m</td></tr>
                    <tr><td class="word-en">Capacity</td><td class="word-type">n</td><td>S·ª©c ch·ª©a, c√¥ng su·∫•t</td></tr>
                    <tr><td class="word-en">Restrict</td><td class="word-type">v</td><td>H·∫°n ch·∫ø, thu h·∫πp</td></tr>
                    <tr><td class="word-en">Relieve</td><td class="word-type">v</td><td>L√†m d·ªãu, gi·∫£m b·ªõt (cƒÉng th·∫≥ng/t·∫Øc ngh·∫Ωn)</td></tr>
                    <tr><td class="word-en">Ban</td><td class="word-type">v</td><td>C·∫•m</td></tr>
                    <tr><td class="word-en">District</td><td class="word-type">n</td><td>Qu·∫≠n, khu v·ª±c</td></tr>
                    <tr><td class="word-en">Independently</td><td class="word-type">adv</td><td>M·ªôt c√°ch ƒë·ªôc l·∫≠p, kh√¥ng ph·ª• thu·ªôc</td></tr>
                    <tr><td class="word-en">Layout</td><td class="word-type">n</td><td>C√°ch b·ªë tr√≠, s∆° ƒë·ªì (ƒë∆∞·ªùng s√°)</td></tr>
                </table>
            </div>

        </div> <div class="right-panel">
            
            <div id="quiz-container">
                </div>

            <div class="submit-container">
                <button class="btn-submit" onclick="submitQuiz()">üéâ N·ªòP B√ÄI üéâ</button>
            </div>

        </div> </div>

    <div class="modal-overlay" id="result-modal">
        <div class="result-modal" id="result-content">
            <div class="score-circle" id="score-display">0/10</div>
            <div class="feedback-text" id="feedback-text">Tuy·ªát v·ªùi!</div>
            <div class="feedback-subtext" id="feedback-subtext">B·∫°n l√† m·ªôt chuy√™n gia giao th√¥ng th·ª±c th·ª•!</div>
            <button class="btn-timer" onclick="closeModal()">Xem L·∫°i B√†i L√†m</button>
        </div>
    </div>

    <script>
        // ==========================================
        // 1. D·ªÆ LI·ªÜU C√ÇU H·ªéI V√Ä GI·∫¢I TH√çCH CHI TI·∫æT
        // ==========================================
        const quizData = [
            {
                id: 31,
                text: "Question 31. What is the main idea of the passage?",
                options: [
                    "A. Parking rules in England",
                    "B. Key traffic rules to follow in England.",
                    "C. The importance of using turn signals",
                    "D. Rules for overtaking on English roads"
                ],
                correct: 1, // Index 1 is B
                explanation: `
                    <strong>D·ªãch c√¢u h·ªèi:</strong> √ù ch√≠nh c·ªßa ƒëo·∫°n vƒÉn l√† g√¨?<br>
                    <strong>Ph√¢n t√≠ch ƒë√°p √°n:</strong><br>
                    - A. Quy t·∫Øc ƒë·ªó xe ·ªü Anh (Ch·ªâ n·∫±m ·ªü 1 ƒëo·∫°n nh·ªè "Do not park" -> √ù qu√° h·∫πp).<br>
                    - <strong>B. Nh·ªØng lu·∫≠t giao th√¥ng ch√≠nh c·∫ßn tu√¢n th·ªß ·ªü Anh (Ch√≠nh x√°c).</strong> Ngay t·ª´ ti√™u ƒë·ªÅ v√† c√¢u m·ªü ƒë·∫ßu: "Key Points to Remember on Traffic Rules in England" ƒë√£ bao tr√πm to√†n b·ªô b√†i ƒë·ªçc.<br>
                    - C. T·∫ßm quan tr·ªçng c·ªßa vi·ªác d√πng ƒë√®n xi-nhan (Ch·ªâ n·∫±m ·ªü ƒëo·∫°n "Use indicators" -> √ù qu√° h·∫πp).<br>
                    - D. Lu·∫≠t v∆∞·ª£t xe tr√™n ƒë∆∞·ªùng ·ªü Anh (Ch·ªâ l√† m·ªôt chi ti·∫øt nh·ªè).<br>
                    <div class="exp-quote"><strong>D·∫´n ch·ª©ng:</strong> Ti√™u ƒë·ªÅ b√†i ƒë·ªçc: "Key Points to Remember on Traffic Rules in England".</div>
                `
            },
            {
                id: 32,
                text: "Question 32. Which word in passage has the same meaning as ‚Äúchanging direction‚Äù",
                options: [
                    "A. Overtaking",
                    "B. Turning",
                    "C. Parking",
                    "D. Crossing"
                ],
                correct: 1,
                explanation: `
                    <strong>D·ªãch c√¢u h·ªèi:</strong> T·ª´ n√†o trong ƒëo·∫°n vƒÉn c√≥ c√πng nghƒ©a v·ªõi "thay ƒë·ªïi h∆∞·ªõng ƒëi" (changing direction)?<br>
                    <strong>Ph√¢n t√≠ch t·ª´ v·ª±ng:</strong><br>
                    - A. Overtaking (v): v∆∞·ª£t xe kh√°c (ƒëi nhanh h∆°n v√† qua m·∫∑t).<br>
                    - <strong>B. Turning (v): r·∫Ω, quay h∆∞·ªõng. B·∫±ng nghƒ©a v·ªõi "changing direction".</strong><br>
                    - C. Parking (v): ƒë·ªó xe.<br>
                    - D. Crossing (v): bƒÉng qua (ƒë∆∞·ªùng).<br>
                    <div class="exp-quote">V√¨ v·∫≠y ch·ªçn B l√† ƒë√°p √°n ch√≠nh x√°c nh·∫•t v·ªÅ m·∫∑t ng·ªØ nghƒ©a.</div>
                `
            },
            {
                id: 33,
                text: "Question 33. Which word in the passage is the OPPOSITE of ‚Äústop‚Äù",
                options: [
                    "A. Reverse",
                    "B. Turn",
                    "C. Go",
                    "D. Park"
                ],
                correct: 2,
                explanation: `
                    <strong>D·ªãch c√¢u h·ªèi:</strong> T·ª´ n√†o trong ƒëo·∫°n vƒÉn TR√ÅI NGHƒ®A v·ªõi "stop" (d·ª´ng l·∫°i)?<br>
                    <strong>Ph√¢n t√≠ch t·ª´ v·ª±ng:</strong><br>
                    - A. Reverse (v): l√πi l·∫°i.<br>
                    - B. Turn (v): r·∫Ω.<br>
                    - <strong>C. Go (v): ƒëi, di chuy·ªÉn. Tr√°i nghƒ©a ho√†n to√†n v·ªõi "stop" (d·ª´ng).</strong><br>
                    - D. Park (v): ƒë·ªó xe (c≈©ng mang t√≠nh ch·∫•t d·ª´ng l·∫°i).<br>
                    <div class="exp-quote">R·∫•t d·ªÖ d√†ng nh·∫≠n ra "Go" (ƒëi) l√† tr√°i nghƒ©a c·ªßa "Stop" (d·ª´ng). Ch·ªçn C.</div>
                `
            },
            {
                id: 34,
                text: "Question 34. Which of the following is NOT TRUE according to the passage?",
                options: [
                    "A. You must park your vehicle in a proper parking area",
                    "B. You should use indicators when changing lanes or overtaking.",
                    "C. It is allowed to reverse on a one-way road if necessary.",
                    "D. You must not cross the stop line at a red signal."
                ],
                correct: 2,
                explanation: `
                    <strong>D·ªãch c√¢u h·ªèi:</strong> ƒêi·ªÅu n√†o sau ƒë√¢y KH√îNG ƒê√öNG theo ƒëo·∫°n vƒÉn?<br>
                    <strong>Ph√¢n t√≠ch:</strong><br>
                    - A. Ph·∫£i ƒë·ªó xe ·ªü khu v·ª±c ƒë·ªó xe h·ª£p l√Ω. (ƒê√∫ng theo b√†i: "Find the parking near your building...")<br>
                    - B. N√™n d√πng ƒë√®n xi nhan khi chuy·ªÉn l√†n/v∆∞·ª£t. (ƒê√∫ng theo b√†i: "...always use turn signals or indicators...")<br>
                    - <strong>C. ƒê∆∞·ª£c ph√©p l√πi xe tr√™n ƒë∆∞·ªùng 1 chi·ªÅu n·∫øu c·∫ßn thi·∫øt. (SAI th√¥ng tin).</strong> B√†i ƒë·ªçc ghi r√µ tuy·ªát ƒë·ªëi KH√îNG ƒë∆∞·ª£c l√πi.<br>
                    - D. Kh√¥ng ƒë∆∞·ª£c v∆∞·ª£t v·∫°ch d·ª´ng khi ƒë√®n ƒë·ªè. (ƒê√∫ng theo b√†i: "...not keeping your car on the stop line...")<br>
                    <div class="exp-quote"><strong>D·∫´n ch·ª©ng ƒëo·∫°n "Do not drive":</strong> "When you are going on a one-way road, you <strong>cannot reverse</strong> your vehicle."</div>
                `
            },
            {
                id: 35,
                text: "Question 35. According to the passage, what should you do when driving on a two-way road?",
                options: [
                    "A. Keep to the right side of the road.",
                    "B. Allow traffic from the opposite direction to pass on your right.",
                    "C. Drive in the middle of the road to avoid accidents.",
                    "D. Park your car on the side of the road if needed."
                ],
                correct: 1,
                explanation: `
                    <strong>D·ªãch c√¢u h·ªèi:</strong> Theo ƒëo·∫°n vƒÉn, b·∫°n n√™n l√†m g√¨ khi l√°i xe tr√™n ƒë∆∞·ªùng hai chi·ªÅu?<br>
                    <strong>Ph√¢n t√≠ch:</strong><br>
                    - A. ƒêi b√™n ph·∫£i ƒë∆∞·ªùng (Sai, ·ªü Anh lu·∫≠t chung l√† ƒëi b√™n tr√°i "keeping left").<br>
                    - <strong>B. Cho ph√©p ph∆∞∆°ng ti·ªán ng∆∞·ª£c chi·ªÅu ƒëi qua ·ªü ph√≠a b√™n ph·∫£i c·ªßa b·∫°n. (Ch√≠nh x√°c).</strong><br>
                    - C. L√°i xe ·ªü gi·ªØa ƒë∆∞·ªùng... (Sai, r·∫•t nguy hi·ªÉm v√† kh√¥ng c√≥ trong b√†i).<br>
                    - D. ƒê·ªó xe b√™n v·ªá ƒë∆∞·ªùng... (Sai, b√†i ƒë·ªçc c·∫•m "leave your car on the side of the road").<br>
                    <div class="exp-quote"><strong>D·∫´n ch·ª©ng ƒëo·∫°n "keeping left":</strong> "...you need to <strong>allow the traffic from the opposite direction to pass from your right side</strong>."</div>
                `
            },
            {
                id: 36,
                text: "Question 36. Why is it important to avoid parking near a school, hospital, or bus stand?",
                options: [
                    "A. Because there are no parking spots available.",
                    "B. To ensure that important areas remain accessible.",
                    "C. It is a rule only in England.",
                    "D. Parking in those areas is not safe for the car."
                ],
                correct: 1,
                explanation: `
                    <strong>D·ªãch c√¢u h·ªèi:</strong> T·∫°i sao vi·ªác tr√°nh ƒë·ªó xe g·∫ßn tr∆∞·ªùng h·ªçc, b·ªánh vi·ªán ho·∫∑c tr·∫°m xe bu√Ωt l·∫°i quan tr·ªçng?<br>
                    <strong>Ph√¢n t√≠ch:</strong> ƒê√¢y l√† m·ªôt c√¢u h·ªèi suy lu·∫≠n (Inference).<br>
                    - A. V√¨ kh√¥ng c√≥ ch·ªó tr·ªëng (Sai logic).<br>
                    - <strong>B. ƒê·ªÉ ƒë·∫£m b·∫£o nh·ªØng khu v·ª±c quan tr·ªçng n√†y v·∫´n lu√¥n c√≥ th·ªÉ ti·∫øp c·∫≠n ƒë∆∞·ª£c (kh√¥ng b·ªã t·∫Øc ngh·∫Ωn). (ƒê√∫ng).</strong> Xe bu√Ωt c·∫ßn ƒë√≥n kh√°ch, b·ªánh vi·ªán c·∫ßn ch·ªó cho xe c·ª©u th∆∞∆°ng, tr∆∞·ªùng h·ªçc c·∫ßn an to√†n cho h·ªçc sinh.<br>
                    - C. ƒê√¢y ch·ªâ l√† lu·∫≠t ·ªü Anh (Sai, ƒë√¢y l√† lu·∫≠t ph·ªï bi·∫øn).<br>
                    - D. ƒê·ªó ·ªü ƒë√≥ kh√¥ng an to√†n cho xe √¥ t√¥ (Kh√¥ng ph·∫£i l√Ω do ch√≠nh y·∫øu).<br>
                    <div class="exp-quote">D√π b√†i ƒë·ªçc kh√¥ng vi·∫øt tr·ª±c ti·∫øp ch·ªØ "accessible", nh∆∞ng ng·ªØ c·∫£nh "make sure you are not parking near the bus stand, school, or hospital entrance" y√™u c·∫ßu ng∆∞·ªùi l√°i xe kh√¥ng c·∫£n tr·ªü l·ªëi ra v√†o (entrance) c·ªßa c√°c c∆° s·ªü tr·ªçng y·∫øu n√†y.</div>
                `
            },
            {
                id: 37,
                text: "Question 37. Choose the sentence that best fits the blank (37).<br><em>Traffic congestion is when vehicles travel slower... This makes trip times longer and increases queueing. (37) _____.</em>",
                options: [
                    "A. Which travel independently of car traffic and are not affected by traffic jams.",
                    "B. This is also known as a traffic jam.",
                    "C. Bad road layouts can also restrict capacity.",
                    "D. Several methods are used to relieve it."
                ],
                correct: 1,
                explanation: `
                    <strong>Ph√¢n t√≠ch ch·ªó tr·ªëng (37):</strong><br>
                    ƒêo·∫°n tr∆∞·ªõc ƒë√≥ ƒëang ƒë·ªãnh nghƒ©a "Traffic congestion" (T·∫Øc ngh·∫Ωn giao th√¥ng) l√† g√¨ v√† h·∫≠u qu·∫£ c·ªßa n√≥ (ƒëi ch·∫≠m, x·∫øp h√†ng). Ch·ªó tr·ªëng n√†y c·∫ßn m·ªôt c√¢u ti·∫øp t·ª•c b·ªï sung √Ω nghƒ©a ƒë·ªãnh danh cho hi·ªán t∆∞·ª£ng n√†y.<br>
                    - <strong>Ch·ªçn B: "ƒêi·ªÅu n√†y c√≤n ƒë∆∞·ª£c bi·∫øt ƒë·∫øn v·ªõi t√™n g·ªçi l√† k·∫πt xe (traffic jam)."</strong> R·∫•t ph√π h·ª£p v·ªÅ m·∫∑t logic ƒë·ªãnh nghƒ©a.<br>
                    - Lo·∫°i A (ƒë·∫°i t·ª´ quan h·ªá Which kh√¥ng c√≥ danh t·ª´ ph√π h·ª£p ph√≠a tr∆∞·ªõc).<br>
                    - Lo·∫°i C (N√≥i v·ªÅ b·ªë c·ª•c ƒë∆∞·ªùng s√°, ch∆∞a h·ª£p r∆° v·ªõi ƒëo·∫°n ƒë·ªãnh nghƒ©a).<br>
                    - Lo·∫°i D (N√≥i v·ªÅ gi·∫£i ph√°p, trong khi ƒëo·∫°n n√†y ƒëang n√≥i v·ªÅ nguy√™n nh√¢n/ƒë·ªãnh nghƒ©a).
                `
            },
            {
                id: 38,
                text: "Question 38. Choose the sentence that best fits the blank (38).<br><em>Congestion may result from a decrease in capacity, for example accidents... (38) _______.</em>",
                options: [
                    "A. Which travel independently of car traffic and are not affected by traffic jams.",
                    "B. This is also known as a traffic jam.",
                    "C. Bad road layouts can also restrict capacity.",
                    "D. Several methods are used to relieve it."
                ],
                correct: 2,
                explanation: `
                    <strong>Ph√¢n t√≠ch ch·ªó tr·ªëng (38):</strong><br>
                    C√¢u tr∆∞·ªõc ƒë√≥: "Congestion may result from a decrease in capacity..." (T·∫Øc ngh·∫Ωn c√≥ th·ªÉ do vi·ªác gi·∫£m s·ª©c ch·ª©a c·ªßa ƒë∆∞·ªùng, v√≠ d·ª• nh∆∞ tai n·∫°n).<br>
                    Do ƒë√≥, c√¢u ti·∫øp theo ph·∫£i b·ªï sung th√™m m·ªôt l√Ω do kh√°c g√¢y ra vi·ªác "gi·∫£m s·ª©c ch·ª©a" (capacity).<br>
                    - <strong>Ch·ªçn C: "Bad road layouts can also restrict capacity." (B·ªë c·ª•c ƒë∆∞·ªùng s√° t·ªìi t·ªá c≈©ng c√≥ th·ªÉ h·∫°n ch·∫ø s·ª©c ch·ª©a).</strong> T·ª´ kh√≥a "capacity" l·∫∑p l·∫°i, t·∫°o s·ª± li√™n k·∫øt m·∫°ch l·∫°c (Cohesion) tuy·ªát v·ªùi.<br>
                `
            },
            {
                id: 39,
                text: "Question 39. Choose the sentence that best fits the blank (39).<br><em>Where congestion is common, (39) _____. Cars may be banned in certain districts...</em>",
                options: [
                    "A. Which travel independently of car traffic and are not affected by traffic jams.",
                    "B. This is also known as a traffic jam.",
                    "C. Bad road layouts can also restrict capacity.",
                    "D. Several methods are used to relieve it."
                ],
                correct: 3,
                explanation: `
                    <strong>Ph√¢n t√≠ch ch·ªó tr·ªëng (39):</strong><br>
                    C√¢u ph√≠a sau li·ªÅn k·ªÅ ƒë∆∞a ra c√°c v√≠ d·ª•: "Cars may be banned... pay a fee... use public transport" (C·∫•m √¥ t√¥, tr·∫£ ph√≠, d√πng ph∆∞∆°ng ti·ªán c√¥ng c·ªông). ƒê√¢y ch√≠nh l√† c√°c <strong>ph∆∞∆°ng ph√°p/gi·∫£i ph√°p</strong>.<br>
                    V√¨ v·∫≠y, c√¢u ƒëi·ªÅn v√†o (39) ph·∫£i l√† m·ªôt c√¢u gi·ªõi thi·ªáu (topic sentence) cho c√°c ph∆∞∆°ng ph√°p n√†y.<br>
                    - <strong>Ch·ªçn D: "Several methods are used to relieve it." (Nhi·ªÅu ph∆∞∆°ng ph√°p ƒë∆∞·ª£c s·ª≠ d·ª•ng ƒë·ªÉ gi·∫£m b·ªõt n√≥).</strong> "it" ·ªü ƒë√¢y thay th·∫ø cho "congestion" (t·∫Øc ngh·∫Ωn). Ho√†n to√†n h·ª£p l√Ω!<br>
                `
            },
            {
                id: 40,
                text: "Question 40. Choose the sentence that best fits the blank (40).<br><em>...or people may use public transport, (40) _____.</em>",
                options: [
                    "A. Which travel independently of car traffic and are not affected by traffic jams.",
                    "B. This is also known as a traffic jam.",
                    "C. Bad road layouts can also restrict capacity.",
                    "D. Several methods are used to relieve it."
                ],
                correct: 0,
                explanation: `
                    <strong>Ph√¢n t√≠ch ch·ªó tr·ªëng (40):</strong><br>
                    Ch·ªó tr·ªëng ƒë·ª©ng sau d·∫•u ph·∫©y v√† c·ª•m t·ª´ "public transport" (ph∆∞∆°ng ti·ªán giao th√¥ng c√¥ng c·ªông). Ta c·∫ßn m·ªôt m·ªánh ƒë·ªÅ quan h·ªá ƒë·ªÉ b·ªï nghƒ©a cho danh t·ª´ n√†y.<br>
                    - <strong>Ch·ªçn A: "Which travel independently of car traffic and are not affected by traffic jams." (Nh·ªØng ph∆∞∆°ng ti·ªán n√†y di chuy·ªÉn ƒë·ªôc l·∫≠p v√† kh√¥ng b·ªã ·∫£nh h∆∞·ªüng b·ªüi k·∫πt xe).</strong> ƒê·∫°i t·ª´ "Which" thay th·∫ø ho√†n h·∫£o cho "public transport". (V√≠ d·ª•: t√†u ƒëi·ªán ng·∫ßm, t√†u tr√™n cao).<br>
                `
            }
        ];

        // ==========================================
        // 2. LOGIC RENDER C√ÇU H·ªéI V√Ä T∆Ø∆†NG T√ÅC
        // ==========================================
        const quizContainer = document.getElementById('quiz-container');
        let userAnswers = new Array(quizData.length).fill(null);
        let audioCtx;

        // Kh·ªüi t·∫°o Audio Context khi ng∆∞·ªùi d√πng t∆∞∆°ng t√°c l·∫ßn ƒë·∫ßu
        function initAudio() {
            if (!audioCtx) {
                audioCtx = new (window.AudioContext || window.webkitAudioContext)();
            }
        }

        function playDing() {
            if (!audioCtx) return;
            const osc = audioCtx.createOscillator();
            const gainNode = audioCtx.createGain();
            osc.type = 'sine';
            osc.frequency.setValueAtTime(800, audioCtx.currentTime);
            osc.frequency.exponentialRampToValueAtTime(1200, audioCtx.currentTime + 0.1);
            gainNode.gain.setValueAtTime(0.5, audioCtx.currentTime);
            gainNode.gain.exponentialRampToValueAtTime(0.01, audioCtx.currentTime + 0.5);
            osc.connect(gainNode);
            gainNode.connect(audioCtx.destination);
            osc.start();
            osc.stop(audioCtx.currentTime + 0.5);
        }

        function playBuzzer() {
            if (!audioCtx) return;
            const osc = audioCtx.createOscillator();
            const gainNode = audioCtx.createGain();
            osc.type = 'sawtooth';
            osc.frequency.setValueAtTime(150, audioCtx.currentTime);
            osc.frequency.linearRampToValueAtTime(100, audioCtx.currentTime + 0.3);
            gainNode.gain.setValueAtTime(0.5, audioCtx.currentTime);
            gainNode.gain.exponentialRampToValueAtTime(0.01, audioCtx.currentTime + 0.4);
            osc.connect(gainNode);
            gainNode.connect(audioCtx.destination);
            osc.start();
            osc.stop(audioCtx.currentTime + 0.4);
        }

        function renderQuiz() {
            let html = '';
            quizData.forEach((q, qIndex) => {
                html += `
                <div class="question-card" id="q-card-${qIndex}">
                    <div class="question-text">${q.text}</div>
                    <div class="options-grid">
                `;
                
                const labels = ['A', 'B', 'C', 'D'];
                q.options.forEach((opt, optIndex) => {
                    // Extract letter and content
                    const optText = opt.substring(3);
                    html += `
                        <button class="option-btn" id="btn-${qIndex}-${optIndex}" onclick="selectAnswer(${qIndex}, ${optIndex})">
                            <span>${labels[optIndex]}</span> ${optText}
                        </button>
                    `;
                });

                html += `
                    </div>
                    <div class="explanation-box" id="exp-${qIndex}">
                        <div class="exp-title">üí° GI·∫¢I TH√çCH CHI TI·∫æT C·ª¶A C√î MAI AN</div>
                        <div class="exp-content">${q.explanation}</div>
                    </div>
                </div>
                `;
            });
            quizContainer.innerHTML = html;
        }

        function selectAnswer(qIndex, optIndex) {
            initAudio();
            if (userAnswers[qIndex] !== null) return; // ƒê√£ tr·∫£ l·ªùi th√¨ kh√≥a

            userAnswers[qIndex] = optIndex;
            const correctIndex = quizData[qIndex].correct;
            
            // L·∫•y t·∫•t c·∫£ c√°c n√∫t c·ªßa c√¢u n√†y
            const buttons = document.querySelectorAll(`#q-card-${qIndex} .option-btn`);
            
            // Disable t·∫•t c·∫£ c√°c n√∫t
            buttons.forEach(btn => btn.disabled = true);

            // Ki·ªÉm tra ƒê√∫ng/Sai
            if (optIndex === correctIndex) {
                // ƒê√öNG
                document.getElementById(`btn-${qIndex}-${optIndex}`).classList.add('correct');
                playDing();
                fireConfettiSmall();
            } else {
                // SAI
                document.getElementById(`btn-${qIndex}-${optIndex}`).classList.add('incorrect');
                // Hi·ªán lu√¥n ƒë√°p √°n ƒë√∫ng
                document.getElementById(`btn-${qIndex}-${correctIndex}`).classList.add('correct');
                playBuzzer();
            }

            // Hi·ªán gi·∫£i th√≠ch chi ti·∫øt
            document.getElementById(`exp-${qIndex}`).style.display = 'block';
        }

        // ==========================================
        // 3. LOGIC TIMER (ƒê·∫æM NG∆Ø·ª¢C)
        // ==========================================
        let timeLeft = 600; // 10 ph√∫t = 600 gi√¢y
        let timerInterval;
        let isTimerRunning = false;
        const timerDisplay = document.getElementById('timer');
        const btnTimer = document.getElementById('btn-timer-control');

        function updateTimerDisplay() {
            const m = Math.floor(timeLeft / 60);
            const s = timeLeft % 60;
            timerDisplay.textContent = `${m.toString().padStart(2, '0')}:${s.toString().padStart(2, '0')}`;
        }

        function showToast(msg) {
            const toast = document.getElementById('toast');
            toast.textContent = msg;
            toast.classList.add('show');
            setTimeout(() => toast.classList.remove('show'), 5000);
        }

        function toggleTimer() {
            initAudio(); // Initialize audio on first click
            if (isTimerRunning) {
                clearInterval(timerInterval);
                btnTimer.textContent = 'TI·∫æP T·ª§C L√ÄM B√ÄI';
                btnTimer.style.background = '#e67e22'; // Orange
                isTimerRunning = false;
            } else {
                btnTimer.textContent = '‚è∏ T·∫†M D·ª™NG';
                btnTimer.style.background = '#e74c3c'; // Red
                isTimerRunning = true;
                timerInterval = setInterval(() => {
                    timeLeft--;
                    updateTimerDisplay();
                    if (timeLeft <= 0) {
                        clearInterval(timerInterval);
                        isTimerRunning = false;
                        btnTimer.textContent = 'H·∫æT GI·ªú';
                        btnTimer.disabled = true;
                        btnTimer.style.background = '#95a5a6';
                        showToast("‚è∞ ƒê√£ h·∫øt gi·ªù l√†m b√†i. B·∫°n v·∫´n c√≥ th·ªÉ ti·∫øp t·ª•c l√†m, nh∆∞ng nh·ªõ l√† trong ph√≤ng thi th·∫≠t, b·∫°n ch·ªâ n√™n l√†m m·ªôt b√†i nh∆∞ th·∫ø n√†y trong 10 ph√∫t th√¥i nha.");
                        playBuzzer();
                    }
                }, 1000);
            }
        }

        function toggleTranslation(id) {
            const el = document.getElementById(id);
            if (el.style.display === 'block') {
                el.style.display = 'none';
            } else {
                el.style.display = 'block';
            }
        }

        // ==========================================
        // 4. HI·ªÜU ·ª®NG PH√ÅO GI·∫§Y (CONFETTI)
        // ==========================================
        const canvas = document.getElementById('confetti');
        const ctx = canvas.getContext('2d');
        canvas.width = window.innerWidth;
        canvas.height = window.innerHeight;
        let particles = [];

        function random(min, max) { return Math.random() * (max - min) + min; }

        function createParticles(x, y, amount) {
            const colors = ['#3498db', '#e74c3c', '#2ecc71', '#f1c40f', '#9b59b6'];
            for (let i = 0; i < amount; i++) {
                particles.push({
                    x: x || canvas.width / 2,
                    y: y || canvas.height / 2,
                    r: random(5, 15),
                    dx: random(-10, 10),
                    dy: random(-15, 5),
                    color: colors[Math.floor(Math.random() * colors.length)],
                    tilt: Math.floor(Math.random() * 10) - 10,
                    tiltAngle: 0,
                    tiltAngleInc: (Math.random() * 0.07) + 0.05
                });
            }
        }

        function animateConfetti() {
            requestAnimationFrame(animateConfetti);
            ctx.clearRect(0, 0, canvas.width, canvas.height);
            particles.forEach((p, index) => {
                p.tiltAngle += p.tiltAngleInc;
                p.y += (Math.cos(p.tiltAngle) + 3 + p.r / 2) / 2;
                p.x += Math.sin(p.tiltAngle) * 2;
                
                ctx.beginPath();
                ctx.lineWidth = p.r;
                ctx.strokeStyle = p.color;
                ctx.moveTo(p.x + p.tilt + p.r, p.y);
                ctx.lineTo(p.x + p.tilt, p.y + p.tilt + p.r);
                ctx.stroke();

                if (p.y > canvas.height) particles.splice(index, 1);
            });
        }
        animateConfetti();

        function fireConfettiSmall() { createParticles(window.innerWidth / 1.5, window.innerHeight / 2, 30); }
        function fireConfettiBig() { createParticles(window.innerWidth / 2, 100, 150); }

        window.addEventListener('resize', () => {
            canvas.width = window.innerWidth;
            canvas.height = window.innerHeight;
        });

        // ==========================================
        // 5. N·ªòP B√ÄI V√Ä CH·∫§M ƒêI·ªÇM
        // ==========================================
        function submitQuiz() {
            clearInterval(timerInterval);
            let score = 0;
            let unAnswered = 0;

            userAnswers.forEach((ans, index) => {
                if (ans === null) unAnswered++;
                else if (ans === quizData[index].correct) score++;
            });

            if (unAnswered > 0) {
                const confirmSubmit = confirm(`B·∫°n c√≤n ${unAnswered} c√¢u ch∆∞a l√†m. B·∫°n c√≥ ch·∫Øc ch·∫Øn mu·ªën n·ªôp b√†i kh√¥ng?`);
                if (!confirmSubmit) {
                    // N·∫øu ng∆∞·ªùi d√πng ch·ªçn Cancel, kh√¥i ph·ª•c l·∫°i ƒë·ªìng h·ªì n·∫øu tr∆∞·ªõc ƒë√≥ ƒëang ch·∫°y
                    if(timeLeft > 0 && btnTimer.textContent === '‚è∏ T·∫†M D·ª™NG') toggleTimer(); 
                    return; 
                }
            }

            // T√≠nh to√°n feedback
            const percent = score / quizData.length;
            let title = "", subtext = "";
            if (percent === 1) {
                title = "üèÜ THI√äN T√ÄI!"; subtext = "B·∫°n ƒë·∫°t ƒëi·ªÉm TUY·ªÜT ƒê·ªêI! Th·∫≠t ƒë√°ng kinh ng·∫°c!";
                fireConfettiBig(); playDing(); setTimeout(playDing, 200);
            } else if (percent >= 0.8) {
                title = "üåü XU·∫§T S·∫ÆC!"; subtext = "B·∫°n ƒë√£ l√†m r·∫•t t·ªët! Ch·ªâ m·ªôt ch√∫t x√≠u n·ªØa l√† ho√†n h·∫£o.";
                fireConfettiBig(); playDing();
            } else if (percent >= 0.5) {
                title = "üëç KH√Å L·∫ÆM!"; subtext = "N·ªÅn t·∫£ng c·ªßa b·∫°n r·∫•t ·ªïn. C√πng xem l·∫°i c√°c c√¢u sai ·ªü ph·∫ßn gi·∫£i th√≠ch nh√©!";
            } else {
                title = "üí™ C·ªê L√äN NH√â!"; subtext = "ƒê·ª´ng n·∫£n ch√≠! H√£y ƒë·ªçc k·ªπ l·∫°i ph·∫ßn d·ªãch nghƒ©a v√† gi·∫£i th√≠ch c·ªßa c√¥ An ƒë·ªÉ r√∫t kinh nghi·ªám nha.";
            }

            document.getElementById('score-display').textContent = `${score}/${quizData.length}`;
            document.getElementById('feedback-text').textContent = title;
            document.getElementById('feedback-subtext').textContent = subtext;
            
            document.getElementById('result-modal').style.display = 'flex';
            setTimeout(() => document.getElementById('result-content').classList.add('show'), 10);
        }

        function closeModal() {
            document.getElementById('result-content').classList.remove('show');
            setTimeout(() => document.getElementById('result-modal').style.display = 'none', 300);
        }

        // Init
        renderQuiz();

    </script>
</body>
</html>