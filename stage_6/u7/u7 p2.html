<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Ms Mai An ULIS - Time Conjunctions Master</title>
    <link href="https://fonts.googleapis.com/css2?family=Nunito:wght@400;600;700;800&family=Quicksand:wght@500;700&display=swap" rel="stylesheet">
    
    <style>
        :root {
            --primary-pink: #8854C0;
            --primary-teal: #00C9A7;
            --correct-green: #00D26A;
            --wrong-red: #FF4757;
            --bg-pattern: radial-gradient(#e5e5f7 1px, transparent 1px);
        }

        * {
            box-sizing: border-box;
            margin: 0;
            padding: 0;
        }

        body {
            font-family: 'Nunito', sans-serif;
            background-color: #f0f4f8;
            background-image: var(--bg-pattern);
            background-size: 20px 20px;
            color: #333;
            min-height: 100vh;
            display: flex;
            flex-direction: column;
            align-items: center;
            padding: 20px;
        }

        h1 {
            font-family: 'Quicksand', sans-serif;
            color: var(--primary-pink);
            font-size: 1.5rem;
            margin-bottom: 20px;
            text-align: center;
            background: white;
            padding: 10px 20px;
            border-radius: 50px;
            box-shadow: 0 4px 15px rgba(0,0,0,0.1);
            border: 2px solid var(--primary-teal);
        }

        /* Progress Bar */
        .progress-container {
            width: 100%;
            max-width: 700px;
            background-color: #e0e0e0;
            border-radius: 20px;
            margin-bottom: 20px;
            height: 15px;
            overflow: hidden;
            border: 2px solid #fff;
        }

        .progress-bar {
            height: 100%;
            background-color: var(--primary-teal);
            width: 0%;
            transition: width 0.3s ease;
        }

        /* Card Style */
        .quiz-card {
            background: white;
            width: 100%;
            max-width: 700px;
            border-radius: 25px;
            padding: 30px;
            box-shadow: 0 10px 30px rgba(136, 84, 192, 0.2);
            position: relative;
            animation: slideIn 0.5s ease;
        }

        @keyframes slideIn {
            from { transform: translateY(20px); opacity: 0; }
            to { transform: translateY(0); opacity: 1; }
        }

        .question-text {
            font-size: 1.3rem;
            font-weight: 700;
            color: #2c3e50;
            margin-bottom: 25px;
            line-height: 1.5;
        }

        /* Options Grid */
        .options-grid {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 15px;
        }

        @media (max-width: 600px) {
            .options-grid {
                grid-template-columns: 1fr;
            }
        }

        .option-btn {
            background: white;
            border: 2px solid #e0e0e0;
            border-radius: 15px;
            padding: 15px 20px;
            font-size: 1.1rem;
            font-weight: 600;
            font-family: 'Nunito', sans-serif;
            color: #555;
            cursor: pointer;
            transition: all 0.2s;
            box-shadow: 0 4px 0 #e0e0e0;
            text-align: left;
            position: relative;
            overflow: hidden;
        }

        .option-btn:hover:not(.disabled) {
            transform: scale(1.02);
            border-color: var(--primary-pink);
            color: var(--primary-pink);
        }

        .option-btn:active:not(.disabled) {
            transform: translateY(4px);
            box-shadow: none;
        }

        /* States */
        .option-btn.correct {
            background-color: var(--correct-green);
            color: white;
            border-color: #00b85c;
            box-shadow: 0 4px 0 #00b85c;
        }

        .option-btn.wrong {
            background-color: var(--wrong-red);
            color: white;
            border-color: #d63030;
            box-shadow: 0 4px 0 #d63030;
            animation: shake 0.5s;
        }

        @keyframes shake {
            0% { transform: translateX(0); }
            25% { transform: translateX(-5px); }
            50% { transform: translateX(5px); }
            75% { transform: translateX(-5px); }
            100% { transform: translateX(0); }
        }

        .disabled {
            pointer-events: none;
        }

        /* Explanation Section */
        .explanation-container {
            margin-top: 25px;
            padding: 20px;
            background-color: #f8f9fa;
            border-left: 5px solid var(--primary-pink);
            border-radius: 10px;
            display: none; /* Hidden by default */
            animation: fadeIn 0.5s;
        }

        @keyframes fadeIn {
            from { opacity: 0; }
            to { opacity: 1; }
        }

        .exp-header {
            font-weight: 800;
            color: var(--primary-pink);
            margin-bottom: 10px;
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .exp-content p {
            margin-bottom: 8px;
            line-height: 1.6;
            font-size: 1rem;
        }

        .exp-label {
            font-weight: 700;
            color: #444;
            text-decoration: underline;
        }

        .vocab-list {
            background: #fff;
            padding: 10px;
            border-radius: 8px;
            border: 1px dashed #ccc;
            margin-bottom: 10px;
        }

        .vocab-item {
            display: block;
            margin-bottom: 4px;
        }

        /* Navigation */
        .nav-btn {
            margin-top: 20px;
            background-color: var(--primary-pink);
            color: white;
            border: none;
            padding: 12px 30px;
            border-radius: 50px;
            font-size: 1.1rem;
            font-weight: 700;
            cursor: pointer;
            box-shadow: 0 5px 15px rgba(136, 84, 192, 0.4);
            display: none; /* Hidden until answer selected */
            float: right;
            transition: transform 0.2s;
        }

        .nav-btn:hover {
            transform: scale(1.05);
            background-color: #7044a0;
        }

        /* Popup Score */
        .modal-overlay {
            position: fixed;
            top: 0; left: 0; width: 100%; height: 100%;
            background: rgba(0,0,0,0.6);
            display: none;
            justify-content: center;
            align-items: center;
            z-index: 1000;
        }

        .modal-content {
            background: white;
            padding: 40px;
            border-radius: 30px;
            text-align: center;
            max-width: 400px;
            width: 90%;
            animation: popUp 0.4s cubic-bezier(0.175, 0.885, 0.32, 1.275);
            border: 4px solid var(--primary-teal);
        }

        @keyframes popUp {
            from { transform: scale(0.5); opacity: 0; }
            to { transform: scale(1); opacity: 1; }
        }

        .score-display {
            font-size: 3rem;
            font-weight: 800;
            color: var(--primary-pink);
            margin: 20px 0;
        }

        .feedback-msg {
            font-size: 1.2rem;
            color: #555;
            margin-bottom: 20px;
        }

        .restart-btn {
            background: var(--primary-teal);
            color: white;
            border: none;
            padding: 15px 40px;
            border-radius: 50px;
            font-size: 1.2rem;
            font-weight: 700;
            cursor: pointer;
            box-shadow: 0 4px 0 #009e82;
        }
        
        /* Confetti Canvas */
        #confetti-canvas {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            pointer-events: none;
            z-index: 999;
        }

        /* Mobile specific adjustments */
        @media (max-width: 480px) {
            h1 { font-size: 1.2rem; }
            .quiz-card { padding: 20px; }
            .question-text { font-size: 1.1rem; }
        }

    </style>
</head>
<body>

    <canvas id="confetti-canvas"></canvas>

    <h1>Ms Mai An ULIS - Time Conjunctions Challenge</h1>

    <div class="progress-container">
        <div class="progress-bar" id="progress-bar"></div>
    </div>

    <div class="quiz-card" id="quiz-container">
        <div id="question-area">
            <div class="question-text" id="question-text">
                Loading question...
            </div>
            <div class="options-grid" id="options-area">
                </div>
        </div>

        <div class="explanation-container" id="explanation-area">
            <div class="exp-header">
                <span>üë©‚Äçüè´</span> C√¥ Mai An gi·∫£i th√≠ch chi ti·∫øt:
            </div>
            <div class="exp-content" id="exp-text">
                </div>
        </div>

        <button class="nav-btn" id="next-btn" onclick="nextQuestion()">C√¢u ti·∫øp theo ‚ûú</button>
    </div>

    <div class="modal-overlay" id="result-modal">
        <div class="modal-content">
            <h2>üéâ HO√ÄN TH√ÄNH! üéâ</h2>
            <div class="score-display" id="final-score">0/30</div>
            <p class="feedback-msg" id="final-feedback">B·∫°n l√†m r·∫•t t·ªët!</p>
            <button class="restart-btn" onclick="restartQuiz()">L√†m l·∫°i b√†i thi</button>
        </div>
    </div>

    <script>
        /* =========================================
           DATA SOURCE (30 QUESTIONS - SHUFFLED)
           ========================================= */
        const rawQuestions = [
            {
                q: "________ the earthquake is happening, don't move from where you are.",
                options: ["While", "Until", "Before", "After"],
                correct: 0,
                exp: {
                    vocab: "A. While (Trong khi); B. Until (Cho t·ªõi khi); C. Before (Tr∆∞·ªõc khi); D. After (Sau khi).",
                    trans: "Trong khi tr·∫≠n ƒë·ªông ƒë·∫•t ƒëang x·∫£y ra, ƒë·ª´ng di chuy·ªÉn kh·ªèi ch·ªó c·ªßa b·∫°n.",
                    correct: "A. While. Ta th·∫•y ƒë·ªông t·ª´ 'is happening' (ti·∫øp di·ªÖn) -> di·ªÖn t·∫£ h√†nh ƒë·ªông ƒëang x·∫£y ra. Quy t·∫Øc: D√πng 'While' ƒë·ªÉ n√≥i v·ªÅ hai h√†nh ƒë·ªông x·∫£y ra song song ho·∫∑c m·ªôt h√†nh ƒë·ªông ƒëang di·ªÖn ra.",
                    wrong: "Lo·∫°i B, C, D v√¨ sai ng·ªØ c·∫£nh. Ta kh√¥ng th·ªÉ ƒë·ª£i 'cho t·ªõi khi' hay 'sau khi' ƒë·ªông ƒë·∫•t x·∫£y ra m·ªõi 'kh√¥ng di chuy·ªÉn', m√† ph·∫£i l√†m ngay trong l√∫c n√≥ ƒëang di·ªÖn ra."
                }
            },
            {
                q: "________ the shaking starts, get down on your hands and knees immediately.",
                options: ["As soon as", "While", "Until", "Before"],
                correct: 0,
                exp: {
                    vocab: "A. As soon as (Ngay khi); B. While (Trong khi); C. Until (Cho t·ªõi khi); D. Before (Tr∆∞·ªõc khi).",
                    trans: "Ngay khi s·ª± rung l·∫Øc b·∫Øt ƒë·∫ßu, h√£y qu·ª≥ xu·ªëng b·∫±ng tay v√† ƒë·∫ßu g·ªëi ngay l·∫≠p t·ª©c.",
                    correct: "A. As soon as. C·ª•m t·ª´ 'immediately' (ngay l·∫≠p t·ª©c) ·ªü cu·ªëi c√¢u l√† d·∫•u hi·ªáu nh·∫≠n bi·∫øt h√†nh ƒë·ªông ph·∫£n x·∫° nhanh -> D√πng 'As soon as' (V·ª´a m·ªõi... th√¨...).",
                    wrong: "B sai v√¨ 'While' d√πng cho h√†nh ƒë·ªông k√©o d√†i. C sai v√¨ kh√¥ng ai ƒë·ª£i ƒë·∫øn khi h·∫øt rung m·ªõi qu·ª≥. D sai v√¨ ta kh√¥ng bi·∫øt tr∆∞·ªõc l√∫c n√†o rung l·∫Øc ƒë·ªÉ qu·ª≥ tr∆∞·ªõc."
                }
            },
            {
                q: "Stay inside ________ the shaking stops. Do not run outside!",
                options: ["until", "while", "as soon as", "before"],
                correct: 0,
                exp: {
                    vocab: "A. until (cho ƒë·∫øn khi); B. while (trong khi); C. as soon as (ngay khi); D. before (tr∆∞·ªõc khi).",
                    trans: "H√£y ·ªü y√™n trong nh√† cho ƒë·∫øn khi s·ª± rung l·∫Øc d·ª´ng l·∫°i. ƒê·ª´ng ch·∫°y ra ngo√†i!",
                    correct: "A. until. C√¢u m·ªánh l·ªánh 'Stay inside' (·ªü y√™n) y√™u c·∫ßu duy tr√¨ h√†nh ƒë·ªông ƒë√≥ t·ªõi m·ªôt gi·ªõi h·∫°n th·ªùi gian c·ª• th·ªÉ (khi rung l·∫Øc d·ª´ng) -> D√πng 'Until' ƒë·ªÉ ch·ªâ ƒëi·ªÉm d·ª´ng.",
                    wrong: "B sai v√¨ n·∫øu d√πng 'while' nghƒ©a l√† ch·ªâ ·ªü trong nh√† l√∫c rung l·∫Øc, nh∆∞ng s·∫Øc th√°i 'Until' nh·∫•n m·∫°nh gi·ªõi h·∫°n th·ªùi gian t·ªët h∆°n. C, D sai ng·ªØ nghƒ©a ho√†n to√†n."
                }
            },
            {
                q: "Make sure you know what to do ________ an earthquake happens.",
                options: ["before", "while", "until", "as soon as"],
                correct: 0,
                exp: {
                    vocab: "A. before (tr∆∞·ªõc khi); B. while (trong khi); C. until (cho ƒë·∫øn khi); D. as soon as (ngay khi).",
                    trans: "H√£y ch·∫Øc ch·∫Øn b·∫°n bi·∫øt ph·∫£i l√†m g√¨ tr∆∞·ªõc khi m·ªôt tr·∫≠n ƒë·ªông ƒë·∫•t x·∫£y ra.",
                    correct: "A. before. Vi·ªác 'chu·∫©n b·ªã ki·∫øn th·ª©c' ph·∫£i ƒë∆∞·ª£c th·ª±c hi·ªán tr∆∞·ªõc s·ª± ki·ªán -> D√πng 'Before' ƒë·ªÉ ch·ªâ th·ª© t·ª± ∆∞u ti√™n.",
                    wrong: "B, C, D kh√¥ng h·ª£p l√Ω. Kh√¥ng ai ƒë·ª£i ƒë·ªông ƒë·∫•t ƒëang x·∫£y ra (while) ho·∫∑c xong r·ªìi (after) m·ªõi ƒëi h·ªçc c√°ch ph√≤ng tr√°nh."
                }
            },
            {
                q: "________ an earthquake happens, there is usually a lot of damage.",
                options: ["After", "Before", "While", "Until"],
                correct: 0,
                exp: {
                    vocab: "A. After (Sau khi); B. Before (Tr∆∞·ªõc khi); C. While (Trong khi); D. Until (Cho ƒë·∫øn khi).",
                    trans: "Sau khi tr·∫≠n ƒë·ªông ƒë·∫•t x·∫£y ra, th∆∞·ªùng c√≥ r·∫•t nhi·ªÅu thi·ªát h·∫°i.",
                    correct: "A. After. 'Thi·ªát h·∫°i' (damage) l√† h·∫≠u qu·∫£, n√™n n√≥ ph·∫£i xu·∫•t hi·ªán sau s·ª± ki·ªán -> D√πng 'After'.",
                    wrong: "B sai v√¨ ch∆∞a ƒë·ªông ƒë·∫•t th√¨ ch∆∞a c√≥ thi·ªát h·∫°i. C sai v√¨ 'While' d√πng khi ƒëang di·ªÖn ra, l√∫c ƒë√≥ ch∆∞a th·ªëng k√™ ƒë∆∞·ª£c thi·ªát h·∫°i."
                }
            },
            {
                q: "You can go outside ________ the storm stops.",
                options: ["as soon as", "while", "until", "during"],
                correct: 0,
                exp: {
                    vocab: "A. as soon as (ngay khi); B. while (trong khi); C. until (cho ƒë·∫øn khi); D. during (trong su·ªët).",
                    trans: "B·∫°n c√≥ th·ªÉ ra ngo√†i ngay khi b√£o tan.",
                    correct: "A. As soon as. Di·ªÖn t·∫£ h√†nh ƒë·ªông ƒë∆∞·ª£c ph√©p l√†m ngay l·∫≠p t·ª©c sau khi h√†nh ƒë·ªông kia k·∫øt th√∫c.",
                    wrong: "B sai v√¨ b√£o ƒëang tan th√¨ kh√¥ng n√™n ra. C sai nghƒ©a (b·∫°n c√≥ th·ªÉ ra ngo√†i cho t·ªõi khi b√£o tan -> nghƒ©a l√† b√£o tan th√¨ ph·∫£i v√†o nh√†? Sai logic)."
                }
            },
            {
                q: "Ch·ªçn c√¢u vi·∫øt ƒê√öNG ch√≠nh t·∫£ (d·∫•u c√¢u):",
                options: ["As soon as the shaking stops you can leave.", "As soon as, the shaking stops you can leave.", "As soon as the shaking stops, you can leave.", "As soon as the shaking stops; you can leave."],
                correct: 2,
                exp: {
                    vocab: "Ki·ªÉm tra quy t·∫Øc d·∫•u ph·∫©y (Comma).",
                    trans: "Ngay khi s·ª± rung l·∫Øc d·ª´ng l·∫°i, b·∫°n c√≥ th·ªÉ r·ªùi ƒëi.",
                    correct: "C. As soon as the shaking stops, you can leave. Quy t·∫Øc: Khi t·ª´ n·ªëi (As soon as) ƒë·ª©ng ƒê·∫¶U c√¢u, b·∫Øt bu·ªôc ph·∫£i c√≥ d·∫•u ph·∫©y (,) ngƒÉn c√°ch hai v·∫ø c√¢u.",
                    wrong: "A thi·∫øu d·∫•u ph·∫©y. B ƒë·∫∑t d·∫•u ph·∫©y sai v·ªã tr√≠ (sau t·ª´ n·ªëi). D d√πng d·∫•u ch·∫•m ph·∫©y (;) l√† sai."
                }
            },
            {
                q: "Ch·ªçn c√¢u vi·∫øt ƒê√öNG ch√≠nh t·∫£ (d·∫•u c√¢u):",
                options: ["You can leave, as soon as the shaking stops.", "You can leave as soon as the shaking stops.", "You, can leave as soon as the shaking stops.", "You can leave as soon as, the shaking stops."],
                correct: 1,
                exp: {
                    vocab: "Ki·ªÉm tra quy t·∫Øc d·∫•u ph·∫©y (Comma).",
                    trans: "B·∫°n c√≥ th·ªÉ r·ªùi ƒëi ngay khi s·ª± rung l·∫Øc d·ª´ng l·∫°i.",
                    correct: "B. You can leave as soon as the shaking stops. Quy t·∫Øc: Khi t·ª´ n·ªëi (as soon as) ƒë·ª©ng GI·ªÆA c√¢u, KH√îNG d√πng d·∫•u ph·∫©y.",
                    wrong: "A th·ª´a d·∫•u ph·∫©y tr∆∞·ªõc t·ª´ n·ªëi. C, D ƒë·∫∑t d·∫•u ph·∫©y sai ch·ªó."
                }
            },
            {
                q: "I was cooking dinner ________ the phone rang.",
                options: ["while", "until", "as soon as", "when"],
                correct: 3,
                exp: {
                    vocab: "A. while; B. until; C. as soon as; D. when.",
                    trans: "T√¥i ƒëang n·∫•u b·ªØa t·ªëi th√¨ ƒëi·ªán tho·∫°i reo.",
                    correct: "D. when. (L∆∞u √Ω n√¢ng cao: M·∫∑c d√π b√†i h·ªçc t·∫≠p trung v√†o While, nh∆∞ng ·ªü ƒë√¢y h√†nh ƒë·ªông 'n·∫•u ƒÉn' ƒëang x·∫£y ra (was cooking) th√¨ h√†nh ƒë·ªông 'ƒëi·ªán tho·∫°i reo' c·∫Øt ngang -> D√πng When. Tuy nhi√™n, n·∫øu b·∫Øt bu·ªôc ch·ªçn trong nh√≥m t·ª´ n·ªëi ƒë√£ h·ªçc, ta x√©t ng·ªØ c·∫£nh). *·ªû c√¢u n√†y ƒë√°p √°n ƒë√∫ng nh·∫•t theo ng·ªØ ph√°p kinh ƒëi·ªÉn l√† When, nh∆∞ng trong b√†i n√†y ta ch·ªçn ƒë√°p √°n ph√π h·ª£p nh·∫•t n·∫øu kh√¥ng c√≥ When* -> Nh∆∞ng ƒë·ªÅ b√†i cho D l√† When n√™n ch·ªçn D.",
                    wrong: "A. While th∆∞·ªùng ƒëi v·ªõi V-ing (While I was cooking...). N·∫øu ƒëi·ªÅn While v√†o ƒë√¢y: 'I was cooking While the phone rang' (T√¥i ƒëang n·∫•u trong khi ƒëi·ªán tho·∫°i reo) -> Nghe h∆°i g∆∞·ª£ng v√¨ 'rang' l√† h√†nh ƒë·ªông ng·∫Øn."
                }
            },
            {
                q: "________ it is raining, we should stay inside.",
                options: ["While", "Until", "Before", "After"],
                correct: 0,
                exp: {
                    vocab: "A. While (Trong khi); B. Until (Cho t·ªõi khi); C. Before (Tr∆∞·ªõc khi); D. After (Sau khi).",
                    trans: "Trong khi tr·ªùi ƒëang m∆∞a, ch√∫ng ta n√™n ·ªü trong nh√†.",
                    correct: "A. While. Di·ªÖn t·∫£ b·ªëi c·∫£nh ƒëang di·ªÖn ra (is raining).",
                    wrong: "B. 'Cho t·ªõi khi tr·ªùi ƒëang m∆∞a' -> Sai ng·ªØ ph√°p/ng·ªØ nghƒ©a. C. 'Tr∆∞·ªõc khi tr·ªùi ƒëang m∆∞a' -> Sai th√¨ ti·∫øp di·ªÖn. D. 'Sau khi tr·ªùi ƒëang m∆∞a' -> Sai th√¨."
                }
            },
            {
                q: "Don't open the door ________ the train stops completely.",
                options: ["until", "while", "as soon as", "during"],
                correct: 0,
                exp: {
                    vocab: "A. until (cho ƒë·∫øn khi); B. while (trong khi); C. as soon as (ngay khi); D. during (trong su·ªët).",
                    trans: "ƒê·ª´ng m·ªü c·ª≠a cho ƒë·∫øn khi t√†u d·ª´ng h·∫≥n.",
                    correct: "A. until. Di·ªÖn t·∫£ gi·ªõi h·∫°n c·ªßa h√†nh ƒë·ªông 'Don't open' (Kh√¥ng m·ªü). Ch·ªù ƒë·∫øn ƒëi·ªÉm m·ªëc 't√†u d·ª´ng' m·ªõi ƒë∆∞·ª£c m·ªü.",
                    wrong: "B sai v√¨ kh√¥ng ƒë∆∞·ª£c m·ªü 'trong khi' t√†u d·ª´ng (qu√° tr√¨nh d·ª´ng ch∆∞a xong). C sai logic (ƒê·ª´ng m·ªü ngay khi t√†u d·ª´ng -> V·∫≠y bao gi·ªù m·ªõi m·ªü?)."
                }
            },
            {
                q: "Please wash your hands ________ you eat dinner.",
                options: ["before", "after", "while", "until"],
                correct: 0,
                exp: {
                    vocab: "A. before (tr∆∞·ªõc khi); B. after (sau khi); C. while (trong khi); D. until (cho t·ªõi khi).",
                    trans: "L√†m ∆°n r·ª≠a tay tr∆∞·ªõc khi b·∫°n ƒÉn t·ªëi.",
                    correct: "A. before. Quy t·∫Øc v·ªá sinh v√† th·ª© t·ª± h√†nh ƒë·ªông: R·ª≠a tay -> ƒÇn.",
                    wrong: "B. ƒÇn xong m·ªõi r·ª≠a tay th√¨ kh√¥ng v·ªá sinh. C. V·ª´a ƒÉn v·ª´a r·ª≠a tay? Kh√¥ng th·ªÉ. D. R·ª≠a tay cho t·ªõi khi ƒÉn -> R·ª≠a qu√° l√¢u!"
                }
            },
            {
                q: "________ I finished my homework, I watched TV.",
                options: ["After", "While", "Until", "During"],
                correct: 0,
                exp: {
                    vocab: "A. After (Sau khi); B. While (Trong khi); C. Until (Cho t·ªõi khi); D. During (Trong su·ªët).",
                    trans: "Sau khi t√¥i l√†m xong b√†i t·∫≠p, t√¥i ƒë√£ xem TV.",
                    correct: "A. After. Di·ªÖn t·∫£ tr√¨nh t·ª±: Xong vi·ªác A r·ªìi m·ªõi l√†m vi·ªác B.",
                    wrong: "B. 'Trong khi t√¥i xong b√†i t·∫≠p' -> 'Finished' l√† h√†nh ƒë·ªông ch·∫•m d·ª©t, kh√¥ng k√©o d√†i n√™n kh√¥ng d√πng While. C. Sai nghƒ©a. D. During + Danh t·ª´, kh√¥ng ƒëi v·ªõi m·ªánh ƒë·ªÅ."
                }
            },
            {
                q: "My dad reads the newspaper ________ he is drinking coffee.",
                options: ["while", "until", "before", "after"],
                correct: 0,
                exp: {
                    vocab: "A. while (trong khi); B. until (cho t·ªõi khi); C. before (tr∆∞·ªõc khi); D. after (sau khi).",
                    trans: "B·ªë t√¥i ƒë·ªçc b√°o trong khi √¥ng ·∫•y ƒëang u·ªëng c√† ph√™.",
                    correct: "A. while. Hai h√†nh ƒë·ªông 'ƒë·ªçc b√°o' v√† 'u·ªëng c√† ph√™' di·ªÖn ra song song c√πng l√∫c (At the same time).",
                    wrong: "B, C, D kh√¥ng di·ªÖn t·∫£ ƒë∆∞·ª£c √Ω nghƒ©a 'song song' c·ªßa hai h√†nh ƒë·ªông n√†y."
                }
            },
            {
                q: "We waited at the station ________ the bus arrived.",
                options: ["until", "while", "as soon as", "before"],
                correct: 0,
                exp: {
                    vocab: "A. until (cho t·ªõi khi); B. while (trong khi); C. as soon as (ngay khi); D. before (tr∆∞·ªõc khi).",
                    trans: "Ch√∫ng t√¥i ƒë√£ ƒë·ª£i ·ªü nh√† ga cho ƒë·∫øn khi xe bu√Ωt ƒë·∫øn.",
                    correct: "A. until. H√†nh ƒë·ªông 'waited' (ƒë·ª£i) k√©o d√†i v√† k·∫øt th√∫c t·∫°i th·ªùi ƒëi·ªÉm 'bus arrived'.",
                    wrong: "B. Trong khi xe bu√Ωt ƒë·∫øn (ch·ªâ 1 kho·∫£nh kh·∫Øc). C. Ngay khi xe bu√Ωt ƒë·∫øn (kh√¥ng h·ª£p v·ªõi ƒë·ªông t·ª´ wait). D. ƒê·ª£i tr∆∞·ªõc khi xe ƒë·∫øn (Hi·ªÉn nhi√™n, nh∆∞ng Until r√µ nghƒ©a gi·ªõi h·∫°n th·ªùi gian h∆°n)."
                }
            },
            {
                q: "She brushed her teeth ________ she went to bed.",
                options: ["before", "after", "while", "until"],
                correct: 0,
                exp: {
                    vocab: "A. before (tr∆∞·ªõc khi); B. after (sau khi); C. while (trong khi); D. until (cho t·ªõi khi).",
                    trans: "C√¥ ·∫•y ƒë√°nh rƒÉng tr∆∞·ªõc khi ƒëi ng·ªß.",
                    correct: "A. before. Tr√¨nh t·ª± logic th√¥ng th∆∞·ªùng: ƒê√°nh rƒÉng -> ƒêi ng·ªß.",
                    wrong: "B. ƒêi ng·ªß r·ªìi m·ªõi ƒë√°nh rƒÉng? C. V·ª´a ng·ªß v·ª´a ƒë√°nh rƒÉng? D. ƒê√°nh rƒÉng cho t·ªõi khi ng·ªß (nghe r·∫•t m·ªát!)."
                }
            },
            {
                q: "________ the teacher walked in, everyone stood up.",
                options: ["As soon as", "While", "Until", "During"],
                correct: 0,
                exp: {
                    vocab: "A. As soon as (Ngay khi); B. While (Trong khi); C. Until (Cho t·ªõi khi); D. During (Trong su·ªët).",
                    trans: "Ngay khi gi√°o vi√™n b∆∞·ªõc v√†o, m·ªçi ng∆∞·ªùi ƒë·ªÅu ƒë·ª©ng d·∫≠y.",
                    correct: "A. As soon as. Di·ªÖn t·∫£ ph·∫£n x·∫° t·ª©c th√¨, h√†nh ƒë·ªông n·ªëi ti·∫øp nhau r·∫•t nhanh.",
                    wrong: "B. 'Trong khi gi√°o vi√™n b∆∞·ªõc v√†o' (k√©o d√†i) -> m·ªçi ng∆∞·ªùi ƒë·ª©ng d·∫≠y (ng·∫Øn). Th∆∞·ªùng d√πng When ho·∫∑c As soon as h·ª£p h∆°n. C. Sai nghƒ©a."
                }
            },
            {
                q: "Do not touch the oven ________ it cools down.",
                options: ["until", "while", "as soon as", "during"],
                correct: 0,
                exp: {
                    vocab: "A. until (cho ƒë·∫øn khi); B. while (trong khi); C. as soon as (ngay khi); D. during (trong su·ªët).",
                    trans: "ƒê·ª´ng ch·∫°m v√†o l√≤ n∆∞·ªõng cho ƒë·∫øn khi n√≥ ngu·ªôi ƒëi.",
                    correct: "A. until. ƒê·∫∑t gi·ªõi h·∫°n an to√†n: N√≥ng -> Kh√¥ng ch·∫°m. Ngu·ªôi (ƒëi·ªÉm d·ª´ng) -> ƒê∆∞·ª£c ch·∫°m.",
                    wrong: "B. Kh√¥ng ch·∫°m trong khi n√≥ ngu·ªôi (nghƒ©a l√† ngu·ªôi r·ªìi ch·∫°m ƒë∆∞·ª£c ch∆∞a? Ch∆∞a r√µ). C. ƒê·ª´ng ch·∫°m ngay khi n√≥ ngu·ªôi (Sai, ngu·ªôi r·ªìi th√¨ ch·∫°m ƒë∆∞·ª£c)."
                }
            },
            {
                q: "I will call you ________ I arrive at the airport.",
                options: ["as soon as", "while", "until", "during"],
                correct: 0,
                exp: {
                    vocab: "A. as soon as (ngay khi); B. while (trong khi); C. until (cho t·ªõi khi); D. during (trong su·ªët).",
                    trans: "T√¥i s·∫Ω g·ªçi cho b·∫°n ngay khi t√¥i ƒë·∫øn s√¢n bay.",
                    correct: "A. as soon as. Di·ªÖn t·∫£ h√†nh ƒë·ªông s·∫Ω l√†m ngay l·∫≠p t·ª©c khi ƒë·∫øn n∆°i.",
                    wrong: "B. V·ª´a ƒë·∫øn v·ª´a g·ªçi (kh√≥ x·∫£y ra, th∆∞·ªùng l√† ƒë·∫øn xong m·ªõi g·ªçi). C. G·ªçi cho t·ªõi khi ƒë·∫øn (g·ªçi su·ªët ƒë∆∞·ªùng ƒëi?)."
                }
            },
            {
                q: "Please clean your room ________ you go out with friends.",
                options: ["before", "after", "while", "until"],
                correct: 0,
                exp: {
                    vocab: "A. before (tr∆∞·ªõc khi); B. after (sau khi); C. while (trong khi); D. until (cho t·ªõi khi).",
                    trans: "L√†m ∆°n d·ªçn ph√≤ng tr∆∞·ªõc khi ƒëi ch∆°i v·ªõi b·∫°n.",
                    correct: "A. before. ƒêi·ªÅu ki·ªán ti√™n quy·∫øt: D·ªçn ph√≤ng xong -> M·ªõi ƒë∆∞·ª£c ƒëi.",
                    wrong: "B. ƒêi ch∆°i v·ªÅ m·ªõi d·ªçn (th∆∞·ªùng b·ªë m·∫π kh√¥ng th√≠ch ƒëi·ªÅu n√†y!). C. V·ª´a ƒëi ch∆°i v·ª´a d·ªçn? D. D·ªçn cho t·ªõi khi ƒëi ch∆°i."
                }
            },
            {
                q: "________ he was running, he dropped his wallet.",
                options: ["While", "Until", "After", "As soon as"],
                correct: 0,
                exp: {
                    vocab: "A. While (Trong khi); B. Until (Cho t·ªõi khi); C. After (Sau khi); D. As soon as (Ngay khi).",
                    trans: "Trong khi anh ·∫•y ƒëang ch·∫°y, anh ·∫•y ƒë√£ l√†m r∆°i v√≠.",
                    correct: "A. While. M·ªánh ƒë·ªÅ 'was running' l√† qu√° kh·ª© ti·∫øp di·ªÖn -> B·ªëi c·∫£nh n·ªÅn. H√†nh ƒë·ªông 'dropped' chen ngang.",
                    wrong: "B. Cho t·ªõi khi ch·∫°y... l√†m r∆°i (Sai nghƒ©a). C. Sau khi ch·∫°y... (C√≥ th·ªÉ, nh∆∞ng c·∫•u tr√∫c was running th∆∞·ªùng ƒëi v·ªõi While). D. Ngay khi ƒëang ch·∫°y... (√çt d√πng)."
                }
            },
            {
                q: "We stayed in the tent ________ the rain stopped.",
                options: ["until", "while", "as soon as", "before"],
                correct: 0,
                exp: {
                    vocab: "A. until (cho ƒë·∫øn khi); B. while (trong khi); C. as soon as (ngay khi); D. before (tr∆∞·ªõc khi).",
                    trans: "Ch√∫ng t√¥i ·ªü trong l·ªÅu cho ƒë·∫øn khi m∆∞a t·∫°nh.",
                    correct: "A. until. H√†nh ƒë·ªông 'stayed' k√©o d√†i t·ªõi m·ªëc th·ªùi gian 'rain stopped'.",
                    wrong: "B. Trong khi m∆∞a t·∫°nh (M∆∞a t·∫°nh l√† kho·∫£nh kh·∫Øc, kh√¥ng k√©o d√†i). C. Ngay khi m∆∞a t·∫°nh (ch√∫ng t√¥i ·ªü trong l·ªÅu? Sai, t·∫°nh r·ªìi ph·∫£i ra ch·ª©)."
                }
            },
            {
                q: "You must fasten your seatbelt ________ the plane takes off.",
                options: ["before", "after", "while", "until"],
                correct: 0,
                exp: {
                    vocab: "A. before (tr∆∞·ªõc khi); B. after (sau khi); C. while (trong khi); D. until (cho t·ªõi khi).",
                    trans: "B·∫°n ph·∫£i th·∫Øt d√¢y an to√†n tr∆∞·ªõc khi m√°y bay c·∫•t c√°nh.",
                    correct: "A. before. Quy t·∫Øc an to√†n h√†ng kh√¥ng: Th·∫Øt d√¢y -> M√°y bay bay.",
                    wrong: "B. Bay xong m·ªõi th·∫Øt (Qu√° mu·ªôn). C. V·ª´a bay v·ª´a th·∫Øt (Nguy hi·ªÉm). D. Th·∫Øt cho t·ªõi khi c·∫•t c√°nh (C·∫•t c√°nh xong th√°o ra lu√¥n? Sai quy t·∫Øc)."
                }
            },
            {
                q: "________ I saw the accident, I called the police.",
                options: ["As soon as", "While", "Until", "Before"],
                correct: 0,
                exp: {
                    vocab: "A. As soon as (Ngay khi); B. While (Trong khi); C. Until (Cho t·ªõi khi); D. Before (Tr∆∞·ªõc khi).",
                    trans: "Ngay khi t√¥i nh√¨n th·∫•y tai n·∫°n, t√¥i ƒë√£ g·ªçi c·∫£nh s√°t.",
                    correct: "A. As soon as. H√†nh ƒë·ªông ph·∫£n ·ª©ng kh·∫©n c·∫•p.",
                    wrong: "B. Trong khi nh√¨n th·∫•y (ƒëang nh√¨n th√¨ g·ªçi). C. Cho t·ªõi khi nh√¨n th·∫•y. D. Tr∆∞·ªõc khi nh√¨n th·∫•y (Ti√™n tri?)."
                }
            },
            {
                q: "Keep stirring the soup ________ it boils.",
                options: ["until", "while", "as soon as", "before"],
                correct: 0,
                exp: {
                    vocab: "A. until (cho ƒë·∫øn khi); B. while (trong khi); C. as soon as (ngay khi); D. before (tr∆∞·ªõc khi).",
                    trans: "H√£y ti·∫øp t·ª•c khu·∫•y s√∫p cho ƒë·∫øn khi n√≥ s√¥i.",
                    correct: "A. until. H√†nh ƒë·ªông 'stirring' (khu·∫•y) li√™n t·ª•c t·ªõi ƒëi·ªÉm d·ª´ng 'boils' (s√¥i).",
                    wrong: "B. Trong khi n√≥ s√¥i (n√≥ s√¥i r·ªìi th√¨ khu·∫•y l√†m g√¨ n·ªØa ho·∫∑c kh√≥ khu·∫•y). C. Ngay khi n√≥ s√¥i. D. Tr∆∞·ªõc khi n√≥ s√¥i (ƒê√∫ng, nh∆∞ng Until r√µ nghƒ©a gi·ªõi h·∫°n h∆°n)."
                }
            },
            {
                q: "________ she finished reading, she closed the book.",
                options: ["As soon as", "While", "Until", "Before"],
                correct: 0,
                exp: {
                    vocab: "A. As soon as (Ngay khi); B. While (Trong khi); C. Until (Cho t·ªõi khi); D. Before (Tr∆∞·ªõc khi).",
                    trans: "Ngay khi c√¥ ·∫•y ƒë·ªçc xong, c√¥ ·∫•y g·∫•p s√°ch l·∫°i.",
                    correct: "A. As soon as. Hai h√†nh ƒë·ªông n·ªëi ti·∫øp nhau.",
                    wrong: "B. Trong khi c√¥ ·∫•y xong (Sai ng·ªØ ph√°p v√¨ finish l√† ƒë·ªông t·ª´ d·ª©t ƒëi·ªÉm). C. Cho t·ªõi khi xong... g·∫•p s√°ch (C·∫•u tr√∫c l·∫°). D. Tr∆∞·ªõc khi xong... g·∫•p s√°ch (V√¥ l√Ω)."
                }
            },
            {
                q: "My mother always checks the doors ________ going to bed.",
                options: ["before", "after", "while", "until"],
                correct: 0,
                exp: {
                    vocab: "A. before (tr∆∞·ªõc khi); B. after (sau khi); C. while (trong khi); D. until (cho t·ªõi khi).",
                    trans: "M·∫π t√¥i lu√¥n ki·ªÉm tra c·ª≠a tr∆∞·ªõc khi ƒëi ng·ªß.",
                    correct: "A. before. (L∆∞u √Ω: before + V-ing). Ki·ªÉm tra an to√†n tr∆∞·ªõc.",
                    wrong: "B. Ng·ªß xong m·ªõi ki·ªÉm tra? C. V·ª´a ng·ªß v·ª´a ki·ªÉm tra? D. Ki·ªÉm tra cho t·ªõi khi ng·ªß."
                }
            },
            {
                q: "Check spelling check: While I was studying, my brother was playing games.",
                options: ["Correct", "Incorrect (Missing comma)", "Incorrect (Wrong word)", "Incorrect (No comma needed)"],
                correct: 0,
                exp: {
                    vocab: "A. ƒê√∫ng; B. Sai (Thi·∫øu d·∫•u ph·∫©y); C. Sai (Sai t·ª´); D. Sai (Kh√¥ng c·∫ßn d·∫•u ph·∫©y).",
                    trans: "Trong khi t√¥i ƒëang h·ªçc, em trai t√¥i ƒëang ch∆°i game.",
                    correct: "A. Correct. C·∫•u tr√∫c: While + S + V, S + V. V√¨ 'While' ƒë·ª©ng ƒë·∫ßu c√¢u n√™n C·∫¶N d·∫•u ph·∫©y ·ªü gi·ªØa.",
                    wrong: "C√¢u n√†y vi·∫øt ho√†n to√†n ƒë√∫ng ch√≠nh t·∫£ v√† ng·ªØ ph√°p."
                }
            },
            {
                q: "Check spelling check: My brother was playing games while I was studying.",
                options: ["Correct", "Incorrect (Needs comma)", "Incorrect (Wrong order)", "Incorrect (Spelling error)"],
                correct: 0,
                exp: {
                    vocab: "A. ƒê√∫ng; B. Sai (C·∫ßn d·∫•u ph·∫©y); C. Sai (Sai tr·∫≠t t·ª±); D. Sai (L·ªói ch√≠nh t·∫£).",
                    trans: "Em trai t√¥i ƒëang ch∆°i game trong khi t√¥i ƒëang h·ªçc.",
                    correct: "A. Correct. C·∫•u tr√∫c: S + V + While + S + V. V√¨ 'While' ƒë·ª©ng GI·ªÆA c√¢u n√™n KH√îNG C·∫¶N d·∫•u ph·∫©y.",
                    wrong: "B sai v√¨ gi·ªØa c√¢u kh√¥ng c·∫ßn ph·∫©y."
                }
            },
            {
                q: "________ the fire alarm rings, leave the building immediately.",
                options: ["If/As soon as", "While", "Until", "Before"],
                correct: 0,
                exp: {
                    vocab: "A. If/As soon as (N·∫øu/Ngay khi); B. While (Trong khi); C. Until (Cho t·ªõi khi); D. Before (Tr∆∞·ªõc khi).",
                    trans: "Ngay khi chu√¥ng b√°o ch√°y reo, h√£y r·ªùi t√≤a nh√† ngay l·∫≠p t·ª©c.",
                    correct: "A. As soon as. T√¨nh hu·ªëng kh·∫©n c·∫•p, c·∫ßn h√†nh ƒë·ªông ngay.",
                    wrong: "B. Trong khi chu√¥ng reo (c·ª© thong th·∫£?). C. Cho t·ªõi khi chu√¥ng reo (m·ªõi r·ªùi ƒëi? - Nghe c√≥ v·∫ª ƒë√∫ng nh∆∞ng As soon as mang t√≠nh m·ªánh l·ªánh kh·∫©n c·∫•p h∆°n). D. Tr∆∞·ªõc khi chu√¥ng reo (Kh√¥ng ai bi·∫øt tr∆∞·ªõc)."
                }
            }
        ];

        /* =========================================
           LOGIC & FUNCTIONS
           ========================================= */
        
        // Sound Effects (Synthesized to keep single file small & reliable)
        const audioCtx = new (window.AudioContext || window.webkitAudioContext)();

        function playSound(type) {
            if (audioCtx.state === 'suspended') {
                audioCtx.resume();
            }
            const osc = audioCtx.createOscillator();
            const gainNode = audioCtx.createGain();
            osc.connect(gainNode);
            gainNode.connect(audioCtx.destination);

            if (type === 'correct') {
                // Ding sound (High pitch sine wave fade out)
                osc.type = 'sine';
                osc.frequency.setValueAtTime(600, audioCtx.currentTime);
                osc.frequency.exponentialRampToValueAtTime(1200, audioCtx.currentTime + 0.1);
                gainNode.gain.setValueAtTime(0.5, audioCtx.currentTime);
                gainNode.gain.exponentialRampToValueAtTime(0.01, audioCtx.currentTime + 0.5);
                osc.start();
                osc.stop(audioCtx.currentTime + 0.5);
            } else if (type === 'wrong') {
                // Buzz sound (Low pitch sawtooth wobbly)
                osc.type = 'sawtooth';
                osc.frequency.setValueAtTime(150, audioCtx.currentTime);
                osc.frequency.linearRampToValueAtTime(100, audioCtx.currentTime + 0.3);
                gainNode.gain.setValueAtTime(0.5, audioCtx.currentTime);
                gainNode.gain.exponentialRampToValueAtTime(0.01, audioCtx.currentTime + 0.4);
                osc.start();
                osc.stop(audioCtx.currentTime + 0.4);
            }
        }

        // Shuffle function
        function shuffleArray(array) {
            for (let i = array.length - 1; i > 0; i--) {
                const j = Math.floor(Math.random() * (i + 1));
                [array[i], array[j]] = [array[j], array[i]];
            }
            return array;
        }

        // Confetti Logic
        const canvas = document.getElementById('confetti-canvas');
        const ctx = canvas.getContext('2d');
        canvas.width = window.innerWidth;
        canvas.height = window.innerHeight;
        let confetti = [];

        function fireConfetti() {
            confetti = [];
            for (let i = 0; i < 100; i++) {
                confetti.push({
                    x: window.innerWidth / 2,
                    y: window.innerHeight / 2,
                    w: Math.random() * 10 + 5,
                    h: Math.random() * 10 + 5,
                    vx: Math.random() * 20 - 10,
                    vy: Math.random() * 20 - 10,
                    c: `hsl(${Math.random() * 360}, 100%, 50%)`
                });
            }
            animateConfetti();
        }

        function animateConfetti() {
            ctx.clearRect(0, 0, canvas.width, canvas.height);
            confetti.forEach((p, i) => {
                p.x += p.vx;
                p.y += p.vy;
                p.vy += 0.5; // Gravity
                ctx.fillStyle = p.c;
                ctx.fillRect(p.x, p.y, p.w, p.h);
            });
            confetti = confetti.filter(p => p.y < window.innerHeight);
            if (confetti.length > 0) requestAnimationFrame(animateConfetti);
        }

        // Quiz State
        let currentQuestions = [];
        let currentIndex = 0;
        let score = 0;
        let isAnswered = false;

        function initQuiz() {
            // Clone and shuffle
            currentQuestions = JSON.parse(JSON.stringify(rawQuestions));
            shuffleArray(currentQuestions);
            currentIndex = 0;
            score = 0;
            scoreDisplay = 0;
            document.getElementById('result-modal').style.display = 'none';
            renderQuestion();
            updateProgress();
        }

        function updateProgress() {
            const percent = ((currentIndex) / currentQuestions.length) * 100;
            document.getElementById('progress-bar').style.width = `${percent}%`;
        }

        function renderQuestion() {
            isAnswered = false;
            const q = currentQuestions[currentIndex];
            
            // Render Text
            document.getElementById('question-text').innerText = `C√¢u ${currentIndex + 1}/${currentQuestions.length}: ${q.q}`;
            
            // Render Options
            const optionsHtml = q.options.map((opt, index) => 
                `<button class="option-btn" onclick="checkAnswer(${index})">${String.fromCharCode(65 + index)}. ${opt}</button>`
            ).join('');
            document.getElementById('options-area').innerHTML = optionsHtml;

            // Reset UI
            document.getElementById('explanation-area').style.display = 'none';
            document.getElementById('next-btn').style.display = 'none';
            
            // Scroll to top
            window.scrollTo(0, 0);
        }

        function checkAnswer(selectedIndex) {
            if (isAnswered) return;
            isAnswered = true;

            const q = currentQuestions[currentIndex];
            const buttons = document.querySelectorAll('.option-btn');
            
            // Visual Feedback
            if (selectedIndex === q.correct) {
                buttons[selectedIndex].classList.add('correct');
                playSound('correct');
                fireConfetti();
                score++;
            } else {
                buttons[selectedIndex].classList.add('wrong');
                buttons[q.correct].classList.add('correct'); // Show correct answer
                playSound('wrong');
            }

            // Disable all buttons
            buttons.forEach(btn => btn.classList.add('disabled'));

            // Show Explanation
            showExplanation(q);

            // Show Next Button
            const nextBtn = document.getElementById('next-btn');
            nextBtn.style.display = 'block';
            
            if (currentIndex === currentQuestions.length - 1) {
                nextBtn.innerText = "N·ªôp b√†i & Xem ƒëi·ªÉm üèÅ";
            } else {
                nextBtn.innerText = "C√¢u ti·∫øp theo ‚ûú";
            }
        }

        function showExplanation(q) {
            const expDiv = document.getElementById('explanation-area');
            const expText = document.getElementById('exp-text');
            
            let html = `
                <div class="vocab-list">
                    <span class="vocab-item">üìö <b>T·ª´ v·ª±ng:</b> ${q.exp.vocab}</span>
                </div>
                <p><span class="exp-label">D·ªãch c√¢u:</span> "${q.exp.trans}"</p>
                <hr style="margin: 10px 0; border: 0; border-top: 1px dashed #ccc;">
                <p style="color: var(--correct-green);"><span class="exp-label">T·∫°i sao ƒê√öNG?</span> ${q.exp.correct}</p>
                <p style="color: var(--wrong-red);"><span class="exp-label">T·∫°i sao SAI?</span> ${q.exp.wrong}</p>
            `;
            
            expText.innerHTML = html;
            expDiv.style.display = 'block';
            
            // Auto scroll to explanation
            expDiv.scrollIntoView({ behavior: 'smooth', block: 'start' });
        }

        function nextQuestion() {
            if (currentIndex < currentQuestions.length - 1) {
                currentIndex++;
                updateProgress();
                renderQuestion();
            } else {
                showResult();
            }
        }

        function showResult() {
            document.getElementById('result-modal').style.display = 'flex';
            document.getElementById('final-score').innerText = `${score}/${currentQuestions.length}`;
            
            const msg = document.getElementById('final-feedback');
            const percentage = (score / currentQuestions.length) * 100;
            
            if (percentage === 100) msg.innerText = "Xu·∫•t s·∫Øc! B·∫°n l√† thi√™n t√†i Time Conjunctions! üåü";
            else if (percentage >= 80) msg.innerText = "Gi·ªèi l·∫Øm! Ch·ªâ sai m·ªôt ch√∫t th√¥i! üí™";
            else if (percentage >= 50) msg.innerText = "C·ªë g·∫Øng l√™n! B·∫°n ƒë√£ n·∫Øm ƒë∆∞·ª£c c∆° b·∫£n r·ªìi. üëç";
            else msg.innerText = "ƒê·ª´ng bu·ªìn! H√£y xem l·∫°i gi·∫£i th√≠ch v√† th·ª≠ l·∫°i nh√©! ‚ù§Ô∏è";
            
            fireConfetti();
        }

        function restartQuiz() {
            initQuiz();
        }

        // Start
        initQuiz();

    </script>
</body>
</html>