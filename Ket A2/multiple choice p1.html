<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Reading Test - Ms Mai An ULIS</title>
    <link href="https://fonts.googleapis.com/css2?family=Nunito:wght@400;600;700;800;900&display=swap" rel="stylesheet">
    <style>
        :root {
            --primary: #FF9A9E; /* Pink pastel */
            --secondary: #FECFEF; /* Light purple pastel */
            --tertiary: #a18cd1;
            --success: #00D26A;
            --danger: #FF4757;
            --text-main: #2d3436;
            --bg-card: rgba(255, 255, 255, 0.92);
        }

        * {
            box-sizing: border-box;
            margin: 0;
            padding: 0;
            font-family: 'Nunito', sans-serif;
        }

        @keyframes gradientMove {
            0% { background-position: 0% 50%; }
            50% { background-position: 100% 50%; }
            100% { background-position: 0% 50%; }
        }

        @keyframes floatBg {
            0% { background-position: 0 0; }
            100% { background-position: 100px 100px; }
        }

        body {
            height: 100vh;
            overflow: hidden;
            background: linear-gradient(-45deg, var(--primary), var(--secondary), var(--tertiary), #fbc2eb);
            background-size: 400% 400%;
            animation: gradientMove 15s ease infinite;
            position: relative;
            color: var(--text-main);
        }

        /* Auto-generated SVG Pattern */
        body::before {
            content: "";
            position: absolute;
            top: 0; left: 0; right: 0; bottom: 0;
            background-image: url("data:image/svg+xml;utf8,<svg xmlns='http://www.w3.org/2000/svg' width='120' height='120'><text x='15' y='35' font-size='24' opacity='0.4'>üíÉ</text><text x='75' y='85' font-size='24' opacity='0.4'>üï∫</text><text x='80' y='30' font-size='20' opacity='0.5'>‚ú®</text><text x='20' y='90' font-size='20' opacity='0.5'>üéµ</text></svg>");
            background-size: 150px;
            animation: floatBg 20s linear infinite;
            z-index: 0;
            pointer-events: none;
        }

        .header {
            position: relative;
            z-index: 10;
            height: 70px;
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 0 30px;
            background: rgba(255, 255, 255, 0.4);
            backdrop-filter: blur(10px);
            box-shadow: 0 4px 15px rgba(0,0,0,0.05);
        }

        .header h1 {
            font-size: 1.2rem;
            color: #6c5ce7;
            font-weight: 900;
            text-transform: uppercase;
            letter-spacing: 1px;
        }

        .timer-container {
            display: flex;
            align-items: center;
            gap: 15px;
        }

        .btn-timer {
            padding: 10px 20px;
            border: none;
            border-radius: 15px;
            background: #6c5ce7;
            color: white;
            font-weight: bold;
            font-size: 1rem;
            cursor: pointer;
            box-shadow: 0 5px 0 #4834d4;
            transition: transform 0.1s, box-shadow 0.1s;
        }

        .btn-timer:active {
            transform: translateY(5px);
            box-shadow: 0 0 0 #4834d4;
        }

        .timer-display {
            font-size: 1.5rem;
            font-weight: 900;
            color: #d63031;
            background: white;
            padding: 5px 15px;
            border-radius: 10px;
            box-shadow: inset 0 3px 5px rgba(0,0,0,0.1);
        }

        .main-container {
            display: flex;
            height: calc(100vh - 70px);
            position: relative;
            z-index: 10;
        }

        .panel {
            flex: 1;
            padding: 20px;
            overflow-y: auto;
            scrollbar-width: thin;
            scrollbar-color: #a18cd1 transparent;
        }

        .panel::-webkit-scrollbar {
            width: 8px;
        }
        .panel::-webkit-scrollbar-thumb {
            background-color: #a18cd1;
            border-radius: 10px;
        }

        .card {
            background: var(--bg-card);
            border-radius: 20px;
            padding: 30px;
            box-shadow: 0 10px 30px rgba(0,0,0,0.1);
            margin-bottom: 20px;
            border: 3px solid rgba(255,255,255,0.5);
        }

        /* Reading Passage Styles */
        .passage-title {
            font-size: 1.8rem;
            color: #6c5ce7;
            margin-bottom: 10px;
            text-align: center;
            font-weight: 800;
        }

        .author {
            text-align: center;
            color: #636e72;
            margin-bottom: 20px;
            font-style: italic;
        }

        .paragraph-box {
            margin-bottom: 20px;
            line-height: 1.8;
            font-size: 1.1rem;
        }

        .btn-translate {
            background: #ffeaa7;
            color: #d35400;
            border: none;
            padding: 5px 15px;
            border-radius: 10px;
            font-weight: bold;
            cursor: pointer;
            box-shadow: 0 4px 0 #fdcb6e;
            margin-top: 10px;
            font-size: 0.9rem;
            transition: all 0.2s;
        }

        .btn-translate:hover { filter: brightness(1.05); }
        .btn-translate:active { transform: translateY(4px); box-shadow: 0 0 0 #fdcb6e; }

        .translation-text {
            display: none;
            margin-top: 10px;
            padding: 15px;
            background: #fff3e0;
            border-left: 5px solid #ff9f43;
            border-radius: 5px 10px 10px 5px;
            font-style: italic;
            color: #57606f;
        }

        /* Glossary Table */
        .glossary-title {
            color: #e84393;
            font-size: 1.4rem;
            margin-top: 30px;
            margin-bottom: 15px;
            text-align: center;
        }

        table {
            width: 100%;
            border-collapse: collapse;
            background: white;
            border-radius: 15px;
            overflow: hidden;
            box-shadow: 0 5px 15px rgba(0,0,0,0.05);
        }

        th, td {
            padding: 12px 15px;
            text-align: left;
            border-bottom: 1px solid #f1f2f6;
        }

        th { background: #fdcb6e; color: #2d3436; font-weight: 800; }
        td:first-child { font-weight: bold; color: #0984e3; }
        tr:last-child td { border-bottom: none; }

        /* Exercise Styles */
        .question-box {
            margin-bottom: 30px;
            border-bottom: 2px dashed #dfe6e9;
            padding-bottom: 20px;
        }

        .question-text {
            font-size: 1.2rem;
            font-weight: 800;
            margin-bottom: 15px;
            color: #2d3436;
        }

        .options-grid {
            display: flex;
            flex-direction: column;
            gap: 12px;
        }

        .option-btn {
            background: white;
            border: 2px solid #dfe6e9;
            padding: 15px 20px;
            border-radius: 15px;
            font-size: 1.1rem;
            text-align: left;
            cursor: pointer;
            box-shadow: 0 5px 0 #dfe6e9;
            transition: all 0.2s;
            font-weight: 600;
            color: #2d3436;
            display: flex;
            align-items: center;
        }

        .option-btn:hover:not(:disabled) {
            transform: scale(1.02) translateY(-2px);
            box-shadow: 0 7px 0 #b2bec3;
            border-color: #b2bec3;
        }

        .option-btn:active:not(:disabled) {
            transform: scale(1) translateY(5px);
            box-shadow: 0 0 0 #dfe6e9;
        }

        .option-btn.correct {
            background: var(--success);
            color: white;
            border-color: #00b894;
            box-shadow: 0 5px 0 #00b894;
        }

        .option-btn.wrong {
            background: var(--danger);
            color: white;
            border-color: #d63031;
            box-shadow: 0 5px 0 #d63031;
            animation: shake 0.4s cubic-bezier(.36,.07,.19,.97) both;
        }

        .option-btn:disabled { cursor: not-allowed; opacity: 0.8; }

        .explanation-box {
            display: none;
            margin-top: 15px;
            background: #f1f2f6;
            padding: 20px;
            border-radius: 15px;
            border-left: 5px solid #0984e3;
            animation: fadeIn 0.5s ease;
        }

        .explanation-box h4 { color: #0984e3; margin-bottom: 10px; }
        .explanation-box ul { margin-left: 20px; margin-bottom: 10px; }
        .explanation-box li { margin-bottom: 8px; }

        .submit-btn {
            width: 100%;
            background: #0984e3;
            color: white;
            border: none;
            padding: 18px;
            border-radius: 20px;
            font-size: 1.4rem;
            font-weight: 900;
            cursor: pointer;
            box-shadow: 0 8px 0 #0764ab;
            margin-top: 20px;
            transition: all 0.2s;
        }

        .submit-btn:active {
            transform: translateY(8px);
            box-shadow: 0 0 0 #0764ab;
        }

        /* Modal / Popup */
        .modal-overlay {
            position: fixed;
            top: 0; left: 0; right: 0; bottom: 0;
            background: rgba(0,0,0,0.6);
            backdrop-filter: blur(5px);
            display: none;
            justify-content: center;
            align-items: center;
            z-index: 100;
            opacity: 0;
            transition: opacity 0.3s ease;
        }

        .modal-content {
            background: white;
            padding: 40px;
            border-radius: 25px;
            text-align: center;
            max-width: 500px;
            width: 90%;
            transform: scale(0.8);
            transition: transform 0.3s cubic-bezier(0.175, 0.885, 0.32, 1.275);
            box-shadow: 0 20px 50px rgba(0,0,0,0.2);
        }

        .modal-overlay.active { display: flex; opacity: 1; }
        .modal-overlay.active .modal-content { transform: scale(1); }

        .modal-score { font-size: 4rem; font-weight: 900; color: #e84393; margin: 20px 0; }
        .modal-msg { font-size: 1.5rem; color: #2d3436; margin-bottom: 20px; font-weight: bold; }
        .close-modal {
            background: #00cec9; padding: 12px 30px; border-radius: 15px;
            color: white; border: none; font-size: 1.2rem; font-weight: bold;
            cursor: pointer; box-shadow: 0 5px 0 #00b894;
        }

        @keyframes shake {
            10%, 90% { transform: translate3d(-2px, 0, 0); }
            20%, 80% { transform: translate3d(4px, 0, 0); }
            30%, 50%, 70% { transform: translate3d(-6px, 0, 0); }
            40%, 60% { transform: translate3d(6px, 0, 0); }
        }
        @keyframes fadeIn { from { opacity: 0; transform: translateY(-10px); } to { opacity: 1; transform: translateY(0); } }

        /* Confetti Elements */
        .confetti {
            position: fixed;
            width: 10px;
            height: 10px;
            background-color: #f00;
            z-index: 9999;
            pointer-events: none;
        }
    </style>
</head>
<body>

    <header class="header">
        <h1>Gi√°o vi√™n: Ms Mai An ULIS</h1>
        <div class="timer-container">
            <button class="btn-timer" id="btn-timer" onclick="toggleTimer()">B·∫ÆT ƒê·∫¶U T√çNH GI·ªú</button>
            <div class="timer-display" id="timer-display">10:00</div>
        </div>
    </header>

    <div class="main-container">
        <div class="panel" id="left-panel">
            <div class="card">
                <h2 class="passage-title">Joining a ballroom dancing club</h2>
                <div class="author">By Pippa Cartwright</div>

                <div class="paragraph-box">
                    <p>When I started college, I wanted to find a club to join. One of the first ones I looked at was ballroom dancing ‚Äì a type of dance you do with a partner. The people there seemed to be having a great time, and it didn‚Äôt cost much, so I decided to join.</p>
                    <button class="btn-translate" onclick="toggleTranslation(this)">B·∫¢N D·ªäCH ƒê·∫¶Y ƒê·ª¶</button>
                    <div class="translation-text">Khi t√¥i b·∫Øt ƒë·∫ßu v√†o ƒë·∫°i h·ªçc, t√¥i mu·ªën t√¨m m·ªôt c√¢u l·∫°c b·ªô ƒë·ªÉ tham gia. M·ªôt trong nh·ªØng c√¢u l·∫°c b·ªô ƒë·∫ßu ti√™n t√¥i t√¨m hi·ªÉu l√† c√¢u l·∫°c b·ªô khi√™u v≈© giao ti·∫øp - m·ªôt lo·∫°i h√¨nh khi√™u v≈© m√† b·∫°n nh·∫£y c√πng m·ªôt b·∫°n nh·∫£y. Nh·ªØng ng∆∞·ªùi ·ªü ƒë√≥ c√≥ v·∫ª nh∆∞ ƒëang c√≥ m·ªôt kho·∫£ng th·ªùi gian tuy·ªát v·ªùi, v√† n√≥ c≈©ng kh√¥ng t·ªën nhi·ªÅu ti·ªÅn, v√¨ v·∫≠y t√¥i quy·∫øt ƒë·ªãnh tham gia.</div>
                </div>

                <div class="paragraph-box">
                    <p>The first week I went, I was really worried because the teacher told us that there were nineteen different dances we had to learn. But it‚Äôs been fine. When there‚Äôs a new thing to learn, he shows it to us lots of times and makes sure we‚Äôre all good at it before we do the next thing.</p>
                    <button class="btn-translate" onclick="toggleTranslation(this)">B·∫¢N D·ªäCH ƒê·∫¶Y ƒê·ª¶</button>
                    <div class="translation-text">Tu·∫ßn ƒë·∫ßu ti√™n t√¥i ƒë·∫øn, t√¥i ƒë√£ r·∫•t lo l·∫Øng v√¨ th·∫ßy gi√°o n√≥i v·ªõi ch√∫ng t√¥i r·∫±ng c√≥ m∆∞·ªùi ch√≠n ƒëi·ªáu nh·∫£y kh√°c nhau m√† ch√∫ng t√¥i ph·∫£i h·ªçc. Nh∆∞ng m·ªçi chuy·ªán ƒë·ªÅu ·ªïn. Khi c√≥ m·ªôt ƒëi·ªÅu m·ªõi c·∫ßn h·ªçc, th·∫ßy ·∫•y l√†m m·∫´u cho ch√∫ng t√¥i r·∫•t nhi·ªÅu l·∫ßn v√† ƒë·∫£m b·∫£o r·∫±ng t·∫•t c·∫£ ch√∫ng t√¥i ƒë·ªÅu l√†m t·ªët tr∆∞·ªõc khi chuy·ªÉn sang ƒë·ªông t√°c ti·∫øp theo.</div>
                </div>

                <div class="paragraph-box">
                    <p>When I joined, I didn‚Äôt know any of the other people in the club because we all study different subjects. But it‚Äôs been a great way to meet people, and I‚Äôve made some of my best friends in the club.</p>
                    <button class="btn-translate" onclick="toggleTranslation(this)">B·∫¢N D·ªäCH ƒê·∫¶Y ƒê·ª¶</button>
                    <div class="translation-text">Khi t√¥i tham gia, t√¥i kh√¥ng bi·∫øt b·∫•t k·ª≥ ai kh√°c trong c√¢u l·∫°c b·ªô v√¨ t·∫•t c·∫£ ch√∫ng t√¥i ƒë·ªÅu h·ªçc c√°c m√¥n kh√°c nhau. Nh∆∞ng ƒë√≥ l√† m·ªôt c√°ch tuy·ªát v·ªùi ƒë·ªÉ g·∫∑p g·ª° m·ªçi ng∆∞·ªùi, v√† t√¥i ƒë√£ k·∫øt b·∫°n ƒë∆∞·ª£c v·ªõi m·ªôt s·ªë ng∆∞·ªùi b·∫°n th√¢n nh·∫•t c·ªßa m√¨nh t·∫°i ƒë√¢y.</div>
                </div>

                <div class="paragraph-box">
                    <p>One of the reasons we learn the dances is to enter competitions. I couldn‚Äôt wait to do my first one. Before we started, I was a bit worried. But during the competition, my partner and I remembered everything about our dances. We were great. We didn‚Äôt win any prizes, but it didn‚Äôt matter ‚Äì we loved it!</p>
                    <button class="btn-translate" onclick="toggleTranslation(this)">B·∫¢N D·ªäCH ƒê·∫¶Y ƒê·ª¶</button>
                    <div class="translation-text">M·ªôt trong nh·ªØng l√Ω do ch√∫ng t√¥i h·ªçc khi√™u v≈© l√† ƒë·ªÉ tham gia c√°c cu·ªôc thi. T√¥i v√¥ c√πng h√°o h·ª©c n√≥ng l√≤ng mu·ªën tham gia cu·ªôc thi ƒë·∫ßu ti√™n c·ªßa m√¨nh. Tr∆∞·ªõc khi b·∫Øt ƒë·∫ßu, t√¥i c√≥ h∆°i lo l·∫Øng. Nh∆∞ng trong su·ªët cu·ªôc thi, t√¥i v√† b·∫°n nh·∫£y ƒë√£ nh·ªõ m·ªçi th·ª© v·ªÅ c√°c ƒëi·ªáu nh·∫£y c·ªßa m√¨nh. Ch√∫ng t√¥i ƒë√£ bi·ªÉu di·ªÖn r·∫•t tuy·ªát. Ch√∫ng t√¥i kh√¥ng gi√†nh ƒë∆∞·ª£c gi·∫£i th∆∞·ªüng n√†o, nh∆∞ng ƒëi·ªÅu ƒë√≥ kh√¥ng quan tr·ªçng ‚Äì ch√∫ng t√¥i th·ª±c s·ª± y√™u th√≠ch n√≥!</div>
                </div>

                <div class="paragraph-box">
                    <p>Joining the ballroom dancing club has been fantastic. In the past, I always did the same sports and activities, year after year, but ballroom dancing has taught me there‚Äôs nothing scary about doing something you‚Äôve never tried before. I still do lots of sports, but now I can add ballroom dancing to my list of hobbies.</p>
                    <button class="btn-translate" onclick="toggleTranslation(this)">B·∫¢N D·ªäCH ƒê·∫¶Y ƒê·ª¶</button>
                    <div class="translation-text">Vi·ªác tham gia c√¢u l·∫°c b·ªô khi√™u v≈© giao ti·∫øp th·∫≠t l√† m·ªôt tr·∫£i nghi·ªám tuy·ªát v·ªùi. Tr∆∞·ªõc ƒë√¢y, t√¥i lu√¥n ch∆°i c√πng nh·ªØng m√¥n th·ªÉ thao v√† tham gia c√°c ho·∫°t ƒë·ªông gi·ªëng nhau, l·∫∑p ƒëi l·∫∑p l·∫°i nƒÉm n√†y qua nƒÉm kh√°c, nh∆∞ng khi√™u v≈© giao ti·∫øp ƒë√£ d·∫°y t√¥i r·∫±ng kh√¥ng c√≥ g√¨ ƒë√°ng s·ª£ khi th·ª≠ l√†m m·ªôt vi·ªác m√† m√¨nh ch∆∞a t·ª´ng l√†m tr∆∞·ªõc ƒë√¢y. T√¥i v·∫´n ch∆°i nhi·ªÅu m√¥n th·ªÉ thao, nh∆∞ng b√¢y gi·ªù t√¥i c√≥ th·ªÉ t·ª± tin th√™m khi√™u v≈© giao ti·∫øp v√†o danh s√°ch s·ªü th√≠ch c·ªßa m√¨nh.</div>
                </div>

                <h3 class="glossary-title">üìö B·∫£ng t·ª´ v·ª±ng si√™u c·∫•p (Glossary)</h3>
                <table>
                    <tr><th>T·ª´ v·ª±ng</th><th>Lo·∫°i t·ª´</th><th>Nghƒ©a Ti·∫øng Vi·ªát</th></tr>
                    <tr><td>Ballroom dancing</td><td>Noun (Danh t·ª´)</td><td>Khi√™u v≈© giao ti·∫øp / khi√™u v≈© trong ph√≤ng</td></tr>
                    <tr><td>Partner</td><td>Noun (Danh t·ª´)</td><td>B·∫°n nh·∫£y, ƒë·ªëi t√°c</td></tr>
                    <tr><td>Worried</td><td>Adjective (T√≠nh t·ª´)</td><td>Lo l·∫Øng, b·ªìn ch·ªìn</td></tr>
                    <tr><td>Make sure</td><td>Verb Phrase (C·ª•m ƒêT)</td><td>ƒê·∫£m b·∫£o, ch·∫Øc ch·∫Øn r·∫±ng</td></tr>
                    <tr><td>Subject</td><td>Noun (Danh t·ª´)</td><td>M√¥n h·ªçc, ch·ªß ƒë·ªÅ</td></tr>
                    <tr><td>Competition</td><td>Noun (Danh t·ª´)</td><td>Cu·ªôc thi, s·ª± c·∫°nh tranh</td></tr>
                    <tr><td>Enter</td><td>Verb (ƒê·ªông t·ª´)</td><td>Tham gia, b∆∞·ªõc v√†o</td></tr>
                    <tr><td>Prize</td><td>Noun (Danh t·ª´)</td><td>Gi·∫£i th∆∞·ªüng</td></tr>
                    <tr><td>Fantastic</td><td>Adjective (T√≠nh t·ª´)</td><td>Tuy·ªát v·ªùi, v√¥ c√πng t·ªët</td></tr>
                    <tr><td>Scary</td><td>Adjective (T√≠nh t·ª´)</td><td>ƒê√°ng s·ª£</td></tr>
                </table>
            </div>
        </div>

        <div class="panel" id="right-panel">
            <div class="card" id="quiz-container">
                </div>
            <button class="submit-btn" onclick="submitQuiz()">N·ªòP B√ÄI üéâ</button>
        </div>
    </div>

    <div class="modal-overlay" id="result-modal">
        <div class="modal-content">
            <h2>K·∫æT QU·∫¢ C·ª¶A B·∫†N</h2>
            <div class="modal-score" id="score-text">0/5</div>
            <div class="modal-msg" id="score-msg">B·∫°n l√†m r·∫•t t·ªët!</div>
            <button class="close-modal" onclick="closeModal()">ƒê√≥ng & Xem l·∫°i b√†i</button>
        </div>
    </div>

    <script>
        // Web Audio API Setup for dynamic sounds
        const audioCtx = new (window.AudioContext || window.webkitAudioContext)();
        
        function playDing() {
            if (audioCtx.state === 'suspended') audioCtx.resume();
            const osc = audioCtx.createOscillator();
            const gainNode = audioCtx.createGain();
            osc.type = 'sine';
            osc.frequency.setValueAtTime(800, audioCtx.currentTime);
            osc.frequency.exponentialRampToValueAtTime(1200, audioCtx.currentTime + 0.1);
            gainNode.gain.setValueAtTime(0.5, audioCtx.currentTime);
            gainNode.gain.exponentialRampToValueAtTime(0.01, audioCtx.currentTime + 0.5);
            osc.connect(gainNode);
            gainNode.connect(audioCtx.destination);
            osc.start();
            osc.stop(audioCtx.currentTime + 0.5);
        }

        function playWrong() {
            if (audioCtx.state === 'suspended') audioCtx.resume();
            const osc = audioCtx.createOscillator();
            const gainNode = audioCtx.createGain();
            osc.type = 'sawtooth';
            osc.frequency.setValueAtTime(300, audioCtx.currentTime);
            osc.frequency.exponentialRampToValueAtTime(100, audioCtx.currentTime + 0.4);
            gainNode.gain.setValueAtTime(0.5, audioCtx.currentTime);
            gainNode.gain.exponentialRampToValueAtTime(0.01, audioCtx.currentTime + 0.4);
            osc.connect(gainNode);
            gainNode.connect(audioCtx.destination);
            osc.start();
            osc.stop(audioCtx.currentTime + 0.4);
        }

        // Confetti Effect
        function createConfetti() {
            const colors = ['#00D26A', '#FF9A9E', '#fdcb6e', '#0984e3', '#e84393'];
            for (let i = 0; i < 50; i++) {
                const conf = document.createElement('div');
                conf.className = 'confetti';
                conf.style.backgroundColor = colors[Math.floor(Math.random() * colors.length)];
                conf.style.left = Math.random() * 100 + 'vw';
                conf.style.top = '-10px';
                conf.style.transform = `rotate(${Math.random() * 360}deg)`;
                document.body.appendChild(conf);

                const duration = Math.random() * 2 + 1;
                conf.animate([
                    { transform: `translate3d(0,0,0) rotate(0deg)`, opacity: 1 },
                    { transform: `translate3d(${Math.random()*200 - 100}px, ${window.innerHeight}px, 0) rotate(${Math.random()*720}deg)`, opacity: 0 }
                ], { duration: duration * 1000, easing: 'cubic-bezier(.37,0,.63,1)' });

                setTimeout(() => conf.remove(), duration * 1000);
            }
        }

        // Timer Logic
        let timeRemaining = 600; // 10 minutes
        let timerInterval = null;
        let isTimerRunning = false;

        function updateTimerDisplay() {
            const m = Math.floor(timeRemaining / 60);
            const s = timeRemaining % 60;
            document.getElementById('timer-display').innerText = `${m.toString().padStart(2, '0')}:${s.toString().padStart(2, '0')}`;
        }

        function toggleTimer() {
            const btn = document.getElementById('btn-timer');
            if (isTimerRunning) {
                clearInterval(timerInterval);
                btn.innerText = "TI·∫æP T·ª§C T√çNH GI·ªú";
                btn.style.background = "#e17055";
                btn.style.boxShadow = "0 5px 0 #d63031";
            } else {
                btn.innerText = "T·∫†M D·ª™NG";
                btn.style.background = "#00b894";
                btn.style.boxShadow = "0 5px 0 #00cec9";
                timerInterval = setInterval(() => {
                    if (timeRemaining > 0) {
                        timeRemaining--;
                        updateTimerDisplay();
                    } else {
                        clearInterval(timerInterval);
                        alert("ƒê√£ h·∫øt gi·ªù l√†m b√†i. B·∫°n v·∫´n c√≥ th·ªÉ ti·∫øp t·ª•c l√†m, nh∆∞ng nh·ªõ l√† trong ph√≤ng thi th·∫≠t, b·∫°n ch·ªâ n√™n l√†m m·ªôt b√†i nh∆∞ th·∫ø n√†y trong 10 ph√∫t th√¥i nha.");
                    }
                }, 1000);
            }
            isTimerRunning = !isTimerRunning;
        }

        // Translation toggle
        function toggleTranslation(btn) {
            const textDiv = btn.nextElementSibling;
            if (textDiv.style.display === 'block') {
                textDiv.style.display = 'none';
                btn.innerText = 'B·∫¢N D·ªäCH ƒê·∫¶Y ƒê·ª¶';
            } else {
                textDiv.style.display = 'block';
                btn.innerText = '·∫®N B·∫¢N D·ªäCH';
            }
        }

        // Quiz Data
        const quizData = [
            {
                qText: "1. Why did Pippa join the dance club?",
                options: [
                    { text: "She thought it looked fun.", isCorrect: true, original: 'A' },
                    { text: "She didn‚Äôt have to pay for it.", isCorrect: false, original: 'B' },
                    { text: "She didn‚Äôt like any of the other clubs.", isCorrect: false, original: 'C' }
                ],
                explanation: `
                    <h4>üë©‚Äçüè´ Ms Mai An gi·∫£i th√≠ch:</h4>
                    <p><b>D·ªãch c√¢u h·ªèi:</b> T·∫°i sao Pippa l·∫°i tham gia c√¢u l·∫°c b·ªô khi√™u v≈©?</p>
                    <ul>
                        <li><b>A ƒë√∫ng:</b> V√¨ c√¥ ·∫•y nghƒ© n√≥ c√≥ v·∫ª vui. D·∫´n ch·ª©ng trong b√†i: <i>'The people there seemed to be having a great time'</i> (Nh·ªØng ng∆∞·ªùi ·ªü ƒë√≥ c√≥ v·∫ª nh∆∞ ƒëang c√≥ m·ªôt kho·∫£ng th·ªùi gian tuy·ªát v·ªùi).</li>
                        <li><b>Lo·∫°i B:</b> B√†i vi·∫øt n√≥i <i>'it didn‚Äôt cost much'</i> (n√≥ kh√¥ng t·ªën NHI·ªÄU ti·ªÅn), nghƒ©a l√† v·∫´n ph·∫£i tr·∫£ ti·ªÅn (ch·ªâ l√† gi√° r·∫ª), ch·ª© kh√¥ng ph·∫£i mi·ªÖn ph√≠ (didn't have to pay).</li>
                        <li><b>Lo·∫°i C:</b> B√†i vi·∫øt kh√¥ng ƒë·ªÅ c·∫≠p ƒë·∫øn vi·ªác c√¥ ·∫•y gh√©t c√°c CLB kh√°c. C√¥ ·∫•y ch·ªâ n√≥i ƒë√¢y l√† m·ªôt trong nh·ªØng CLB ƒê·∫¶U TI√äN c√¥ ·∫•y t√¨m hi·ªÉu.</li>
                    </ul>`
            },
            {
                qText: "2. What does Pippa say about the dance teacher?",
                options: [
                    { text: "He teaches them a new dance every week.", isCorrect: false, original: 'A' },
                    { text: "He often tells new members how good they are.", isCorrect: false, original: 'B' },
                    { text: "He repeats new things until everyone can do them.", isCorrect: true, original: 'C' }
                ],
                explanation: `
                    <h4>üë©‚Äçüè´ Ms Mai An gi·∫£i th√≠ch:</h4>
                    <p><b>D·ªãch c√¢u h·ªèi:</b> Pippa n√≥i g√¨ v·ªÅ th·∫ßy gi√°o d·∫°y khi√™u v≈©?</p>
                    <ul>
                        <li><b>C ƒë√∫ng:</b> Th·∫ßy gi√°o l·∫∑p l·∫°i c√°c b√†i m·ªõi cho ƒë·∫øn khi m·ªçi ng∆∞·ªùi ƒë·ªÅu c√≥ th·ªÉ l√†m ƒë∆∞·ª£c. D·∫´n ch·ª©ng: <i>'he shows it to us lots of times and makes sure we‚Äôre all good at it before we do the next thing'</i> (th·∫ßy l√†m m·∫´u r·∫•t nhi·ªÅu l·∫ßn v√† ƒë·∫£m b·∫£o t·∫•t c·∫£ ƒë·ªÅu l√†m t·ªët tr∆∞·ªõc khi h·ªçc c√°i ti·∫øp theo).</li>
                        <li><b>Lo·∫°i A:</b> C√¥ ·∫•y n√≥i c√≥ 19 ƒëi·ªáu nh·∫£y ph·∫£i h·ªçc, nh∆∞ng kh√¥ng h·ªÅ n√≥i "m·ªói tu·∫ßn h·ªçc 1 ƒëi·ªáu m·ªõi" (every week).</li>
                        <li><b>Lo·∫°i B:</b> Th·∫ßy gi√°o kh√¥ng n√≥i v·ªõi h·ªçc vi√™n m·ªõi r·∫±ng h·ªç nh·∫£y gi·ªèi c·ª° n√†o, th·∫ßy ch·ªâ "quan s√°t v√† ƒë·∫£m b·∫£o h·ªç nh·∫£y ƒë√∫ng" th√¥i.</li>
                    </ul>`
            },
            {
                qText: "3. What does Pippa say about the other club members?",
                options: [
                    { text: "She has become close to some of them.", isCorrect: true, original: 'A' },
                    { text: "She is on the same course as some of them.", isCorrect: false, original: 'B' },
                    { text: "She was friends with some of them before joining.", isCorrect: false, original: 'C' }
                ],
                explanation: `
                    <h4>üë©‚Äçüè´ Ms Mai An gi·∫£i th√≠ch:</h4>
                    <p><b>D·ªãch c√¢u h·ªèi:</b> Pippa n√≥i g√¨ v·ªÅ c√°c th√†nh vi√™n kh√°c trong c√¢u l·∫°c b·ªô?</p>
                    <ul>
                        <li><b>A ƒë√∫ng:</b> C√¥ ·∫•y ƒë√£ tr·ªü n√™n th√¢n thi·∫øt v·ªõi m·ªôt v√†i ng∆∞·ªùi. D·∫´n ch·ª©ng: <i>'I‚Äôve made some of my best friends in the club'</i> (T√¥i ƒë√£ k·∫øt b·∫°n v·ªõi m·ªôt s·ªë ng∆∞·ªùi b·∫°n th√¢n nh·∫•t c·ªßa m√¨nh trong CLB). 'Close to someone' = th√¢n thi·∫øt.</li>
                        <li><b>Lo·∫°i B:</b> C√¥ ·∫•y kh√¥ng h·ªçc c√πng ng√†nh v·ªõi h·ªç v√¨ b√†i n√≥i <i>'we all study different subjects'</i> (t·∫•t c·∫£ ch√∫ng t√¥i ƒë·ªÅu h·ªçc c√°c m√¥n kh√°c nhau).</li>
                        <li><b>Lo·∫°i C:</b> Tr∆∞·ªõc khi tham gia, c√¥ ·∫•y <i>'didn‚Äôt know any of the other people'</i> (kh√¥ng bi·∫øt b·∫•t k·ª≥ ai), n√™n kh√¥ng th·ªÉ l√† b·∫°n t·ª´ tr∆∞·ªõc ƒë∆∞·ª£c.</li>
                    </ul>`
            },
            {
                qText: "4. How did Pippa feel about her first dance competition?",
                options: [
                    { text: "happy to win first prize", isCorrect: false, original: 'A' },
                    { text: "upset that she forgot the dances", isCorrect: false, original: 'B' },
                    { text: "excited to take part", isCorrect: true, original: 'C' }
                ],
                explanation: `
                    <h4>üë©‚Äçüè´ Ms Mai An gi·∫£i th√≠ch:</h4>
                    <p><b>D·ªãch c√¢u h·ªèi:</b> Pippa c·∫£m th·∫•y th·∫ø n√†o v·ªÅ cu·ªôc thi khi√™u v≈© ƒë·∫ßu ti√™n c·ªßa c√¥ ·∫•y?</p>
                    <ul>
                        <li><b>C ƒë√∫ng:</b> R·∫•t h√†o h·ª©ng ƒë∆∞·ª£c tham gia. D·∫´n ch·ª©ng: <i>'I couldn‚Äôt wait to do my first one'</i> (T√¥i kh√¥ng th·ªÉ ch·ªù ƒë·ª£i th√™m ƒë·ªÉ tham gia cu·ªôc thi ƒë·∫ßu ti√™n) - Th·ªÉ hi·ªán s·ª± h√°o h·ª©c (excited).</li>
                        <li><b>Lo·∫°i A:</b> B√†i ƒë·ªçc n√≥i r√µ <i>'We didn‚Äôt win any prizes'</i> (Ch√∫ng t√¥i kh√¥ng gi√†nh ƒë∆∞·ª£c gi·∫£i n√†o).</li>
                        <li><b>Lo·∫°i B:</b> C√¥ ·∫•y kh√¥ng h·ªÅ qu√™n b√†i nh·∫£y. D·∫´n ch·ª©ng: <i>'my partner and I remembered everything'</i> (t√¥i v√† b·∫°n nh·∫£y ƒë√£ nh·ªõ M·ªåI TH·ª®).</li>
                    </ul>`
            },
            {
                qText: "5. In the final paragraph, Pippa says",
                options: [
                    { text: "ballroom dancing is her favourite hobby.", isCorrect: false, original: 'A' },
                    { text: "she‚Äôs learned not to be afraid to do new things.", isCorrect: true, original: 'B' },
                    { text: "she isn‚Äôt sure which activity to try next.", isCorrect: false, original: 'C' }
                ],
                explanation: `
                    <h4>üë©‚Äçüè´ Ms Mai An gi·∫£i th√≠ch:</h4>
                    <p><b>D·ªãch c√¢u h·ªèi:</b> Trong ƒëo·∫°n cu·ªëi, Pippa n√≥i r·∫±ng...</p>
                    <ul>
                        <li><b>B ƒë√∫ng:</b> C√¥ ·∫•y ƒë√£ h·ªçc ƒë∆∞·ª£c c√°ch kh√¥ng s·ª£ h√£i khi l√†m nh·ªØng ƒëi·ªÅu m·ªõi. D·∫´n ch·ª©ng: <i>'ballroom dancing has taught me there‚Äôs nothing scary about doing something you‚Äôve never tried before'</i> (khi√™u v≈© ƒë√£ d·∫°y t√¥i r·∫±ng kh√¥ng c√≥ g√¨ ƒë√°ng s·ª£ khi th·ª≠ l√†m vi·ªác m√† m√¨nh ch∆∞a t·ª´ng l√†m).</li>
                        <li><b>Lo·∫°i A:</b> C√¥ ·∫•y ch·ªâ th√™m khi√™u v≈© v√†o "danh s√°ch s·ªü th√≠ch" (add to my list of hobbies) ch·ª© kh√¥ng h·ªÅ n√≥i ƒë√≥ l√† s·ªü th√≠ch "y√™u th√≠ch nh·∫•t" (favourite).</li>
                        <li><b>Lo·∫°i C:</b> Kh√¥ng c√≥ th√¥ng tin n√†o n√≥i v·ªÅ vi·ªác c√¥ ·∫•y ph√¢n v√¢n kh√¥ng bi·∫øt n√™n th·ª≠ ho·∫°t ƒë·ªông g√¨ ti·∫øp theo.</li>
                    </ul>`
            }
        ];

        let score = 0;
        let answeredQuestions = 0;

        // Shuffle function (Fisher-Yates)
        function shuffleArray(array) {
            for (let i = array.length - 1; i > 0; i--) {
                const j = Math.floor(Math.random() * (i + 1));
                [array[i], array[j]] = [array[j], array[i]];
            }
            return array;
        }

        // Render Quiz
        const quizContainer = document.getElementById('quiz-container');

        quizData.forEach((q, index) => {
            const qBox = document.createElement('div');
            qBox.className = 'question-box';
            
            const qTitle = document.createElement('div');
            qTitle.className = 'question-text';
            qTitle.innerText = q.qText;
            qBox.appendChild(qTitle);

            const optionsGrid = document.createElement('div');
            optionsGrid.className = 'options-grid';
            
            // Clone and Shuffle options
            let shuffledOptions = shuffleArray([...q.options]);

            shuffledOptions.forEach((opt) => {
                const btn = document.createElement('button');
                btn.className = 'option-btn';
                btn.innerHTML = `<b>${opt.original}.</b>&nbsp;&nbsp; ${opt.text}`;
                
                btn.onclick = function() {
                    // Disable all buttons in this question
                    const allBtns = optionsGrid.querySelectorAll('.option-btn');
                    allBtns.forEach(b => b.disabled = true);
                    
                    answeredQuestions++;

                    const expBox = qBox.querySelector('.explanation-box');
                    expBox.style.display = 'block'; // Always show explanation immediately

                    if (opt.isCorrect) {
                        btn.classList.add('correct');
                        playDing();
                        createConfetti();
                        score++;
                    } else {
                        btn.classList.add('wrong');
                        playWrong();
                        // Find and highlight correct answer
                        allBtns.forEach(b => {
                            if (b.dataset.correct === 'true') {
                                b.classList.add('correct');
                            }
                        });
                    }
                };
                
                btn.dataset.correct = opt.isCorrect;
                optionsGrid.appendChild(btn);
            });

            qBox.appendChild(optionsGrid);

            const expBox = document.createElement('div');
            expBox.className = 'explanation-box';
            expBox.innerHTML = q.explanation;
            qBox.appendChild(expBox);

            quizContainer.appendChild(qBox);
        });

        // Submit logic
        function submitQuiz() {
            if (answeredQuestions < quizData.length) {
                alert("B·∫°n vui l√≤ng ch·ªçn ƒë√°p √°n cho t·∫•t c·∫£ c√°c c√¢u h·ªèi nh√©!");
                return;
            }

            const modal = document.getElementById('result-modal');
            const scoreText = document.getElementById('score-text');
            const scoreMsg = document.getElementById('score-msg');

            scoreText.innerText = `${score}/${quizData.length}`;
            
            if (score === quizData.length) {
                scoreMsg.innerText = "üèÜ THI√äN T√ÄI! B·∫°n ƒë√£ l√†m ƒë√∫ng tuy·ªát ƒë·ªëi!";
                createConfetti();
                setTimeout(createConfetti, 500);
                setTimeout(createConfetti, 1000);
            } else if (score >= 3) {
                scoreMsg.innerText = "üåü L√ÄM T·ªêT L·∫ÆM! B·∫°n hi·ªÉu b√†i r·∫•t v·ªØng ƒë·∫•y!";
                createConfetti();
            } else {
                scoreMsg.innerText = "üí™ C·ªê L√äN NH√â! H√£y ƒë·ªçc k·ªπ l·∫°i l·ªùi gi·∫£i th√≠ch b√™n d∆∞·ªõi, b·∫°n s·∫Ω ti·∫øn b·ªô nhanh th√¥i!";
            }

            modal.classList.add('active');
        }

        function closeModal() {
            document.getElementById('result-modal').classList.remove('active');
        }
    </script>
</body>
</html>