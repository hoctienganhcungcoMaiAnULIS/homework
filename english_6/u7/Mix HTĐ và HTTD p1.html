<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>H·ªçc Ti·∫øng Anh c√πng Ms Mai An ULIS</title>
    <link href="https://fonts.googleapis.com/css2?family=Nunito:wght@400;600;700;800&display=swap" rel="stylesheet">
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdn.jsdelivr.net/npm/canvas-confetti@1.6.0/dist/confetti.browser.min.js"></script>
    <style>
        :root {
            --primary-purple: #8854C0;
            --primary-teal: #00C9A7;
            --correct-green: #00D26A;
            --wrong-red: #FF4757;
            --bg-pastel: #F0F4F8;
        }

        body {
            font-family: 'Nunito', sans-serif;
            background-color: var(--bg-pastel);
            background-image: radial-gradient(#8854c033 1px, transparent 1px);
            background-size: 20px 20px;
            color: #2D3436;
            min-height: 100vh;
            overflow-x: hidden;
        }

        .gamified-card {
            background: white;
            border-radius: 24px;
            box-shadow: 0 10px 0 #dfe6e9;
            transition: transform 0.2s ease;
        }

        .answer-btn {
            position: relative;
            background: white;
            border: 2px solid #e2e8f0;
            border-radius: 18px;
            box-shadow: 0 6px 0 #e2e8f0;
            transition: all 0.15s active;
            cursor: pointer;
            text-align: left;
            padding: 16px 20px;
            font-weight: 700;
            font-size: 1.1rem;
        }

        .answer-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 8px 0 #cbd5e1;
            background-color: #f8fafc;
            border-color: var(--primary-purple);
        }

        .answer-btn:active {
            transform: translateY(4px);
            box-shadow: 0 2px 0 #cbd5e1;
        }

        .answer-btn.correct {
            background-color: var(--correct-green) !important;
            color: white !important;
            border-color: #00b35a !important;
            box-shadow: 0 6px 0 #00994d !important;
        }

        .answer-btn.wrong {
            background-color: var(--wrong-red) !important;
            color: white !important;
            border-color: #e63946 !important;
            box-shadow: 0 6px 0 #d63031 !important;
        }

        .explanation-box {
            display: none;
            animation: slideUp 0.4s ease-out forwards;
            border-left: 6px solid var(--primary-purple);
            background: #fdfaff;
        }

        @keyframes slideUp {
            from { opacity: 0; transform: translateY(20px); }
            to { opacity: 1; transform: translateY(0); }
        }

        @keyframes shake {
            0% { transform: translateX(0); }
            25% { transform: translateX(-8px); }
            50% { transform: translateX(8px); }
            75% { transform: translateX(-8px); }
            100% { transform: translateX(0); }
        }

        .shake { animation: shake 0.3s ease-in-out; }

        /* Custom UI for Q29, Q30 */
        .sale-sign {
            background: #ff7675;
            color: white;
            padding: 10px;
            border: 4px dashed white;
            transform: rotate(-2deg);
            display: inline-block;
            font-weight: 800;
            margin: 10px 0;
        }

        .phone-msg {
            background: #e1ffc7;
            border-radius: 15px;
            padding: 12px;
            max-width: 80%;
            position: relative;
            margin: 10px 0;
            box-shadow: 2px 2px 5px rgba(0,0,0,0.1);
        }

        .glossary-table th {
            background: var(--primary-purple);
            color: white;
        }

        .progress-bar {
            height: 12px;
            background: #e2e8f0;
            border-radius: 10px;
            overflow: hidden;
        }
        .progress-fill {
            height: 100%;
            background: linear-gradient(90deg, var(--primary-purple), var(--primary-teal));
            transition: width 0.3s ease;
        }
    </style>
</head>
<body class="p-4 md:p-8">

    <!-- Header -->
    <header class="text-center mb-6">
        <p class="text-sm font-bold text-purple-600 uppercase tracking-widest">Gi√°o vi√™n t·∫°o: Ms Mai An ULIS</p>
        <h1 class="text-3xl md:text-4xl font-extrabold mt-2" style="color: var(--primary-purple);">
            Th·ª≠ Th√°ch: Hi·ªán T·∫°i ƒê∆°n vs Ti·∫øp Di·ªÖn üöÄ
        </h1>
    </header>

    <div class="max-w-4xl mx-auto">
        <!-- Progress bar -->
        <div class="mb-8">
            <div class="flex justify-between items-end mb-2">
                <span class="font-bold text-gray-500" id="progress-text">C√¢u h·ªèi 1/30</span>
                <span class="font-bold text-emerald-500" id="score-text">ƒêi·ªÉm: 0</span>
            </div>
            <div class="progress-bar">
                <div class="progress-fill" id="progress-fill" style="width: 3.33%;"></div>
            </div>
        </div>

        <!-- Quiz Container -->
        <div id="quiz-content">
            <!-- Question Card -->
            <div class="gamified-card p-6 md:p-10 mb-6">
                <div id="question-area">
                    <h2 class="text-xl md:text-2xl font-bold mb-6 leading-relaxed" id="question-text">
                        Listen! Someone ______ at the door.
                    </h2>
                    
                    <div id="special-ui-placeholder"></div>

                    <div class="grid grid-cols-1 md:grid-cols-2 gap-4" id="options-grid">
                        <!-- Options will be injected here -->
                    </div>
                </div>

                <!-- Explanation -->
                <div id="explanation-container" class="explanation-box mt-8 p-6 rounded-xl">
                    <h3 class="font-black text-purple-700 mb-3 text-lg">üí° C√¥ Mai An gi·∫£i th√≠ch:</h3>
                    <div id="explanation-content" class="space-y-4 text-gray-700">
                        <!-- Explanation steps will be injected here -->
                    </div>
                    <button onclick="nextQuestion()" class="mt-6 w-full py-4 bg-teal-500 hover:bg-teal-600 text-white font-black rounded-2xl shadow-lg transition-all transform hover:scale-105" style="box-shadow: 0 6px 0 #00a88b;">
                        TI·∫æP T·ª§C C√ÇU TI·∫æP THEO ‚û°
                    </button>
                </div>
            </div>
        </div>

        <!-- Glossary (Show for relevant context) -->
        <div class="gamified-card p-6 mt-10">
            <h3 class="text-xl font-black mb-4 flex items-center">
                <span class="mr-2">üìö</span> Glossary (B·∫£ng t·ª´ v·ª±ng x·ªãn x√≤)
            </h3>
            <div class="overflow-x-auto">
                <table class="w-full glossary-table rounded-xl overflow-hidden text-sm md:text-base">
                    <thead>
                        <tr>
                            <th class="p-3 text-left">T·ª´ v·ª±ng (Word)</th>
                            <th class="p-3 text-left">Lo·∫°i t·ª´</th>
                            <th class="p-3 text-left">Nghƒ©a ti·∫øng Vi·ªát</th>
                        </tr>
                    </thead>
                    <tbody class="bg-white">
                        <tr class="border-b">
                            <td class="p-3 font-bold">At the moment</td>
                            <td class="p-3 italic">Phrase</td>
                            <td class="p-3">Ngay l√∫c n√†y (D·∫•u hi·ªáu ti·∫øp di·ªÖn)</td>
                        </tr>
                        <tr class="border-b">
                            <td class="p-3 font-bold">Stative verb</td>
                            <td class="p-3 italic">Noun</td>
                            <td class="p-3">ƒê·ªông t·ª´ ch·ªâ tr·∫°ng th√°i (kh√¥ng chia V-ing)</td>
                        </tr>
                        <tr class="border-b">
                            <td class="p-3 font-bold">Frequency</td>
                            <td class="p-3 italic">Noun</td>
                            <td class="p-3">T·∫ßn su·∫•t (Usually, Often...)</td>
                        </tr>
                        <tr class="border-b">
                            <td class="p-3 font-bold">Habitual</td>
                            <td class="p-3 italic">Adj</td>
                            <td class="p-3">Thu·ªôc v·ªÅ th√≥i quen</td>
                        </tr>
                        <tr class="border-b">
                            <td class="p-3 font-bold">Scientific fact</td>
                            <td class="p-3 italic">Noun</td>
                            <td class="p-3">S·ª± th·∫≠t khoa h·ªçc hi·ªÉn nhi√™n</td>
                        </tr>
                    </tbody>
                </table>
            </div>
        </div>
    </div>

    <!-- End Game Modal -->
    <div id="finish-modal" class="fixed inset-0 bg-black bg-opacity-70 hidden flex items-center justify-center z-50 p-4">
        <div class="bg-white rounded-3xl p-8 max-w-sm w-full text-center transform scale-90 opacity-0 transition-all duration-300" id="modal-card">
            <div class="text-6xl mb-4">üèÜ</div>
            <h2 class="text-3xl font-black mb-2 text-purple-700">Tuy·ªát v·ªùi!</h2>
            <p class="text-lg text-gray-600 mb-6" id="final-result-text">B·∫°n ƒë√£ ho√†n th√†nh b√†i thi v·ªõi k·∫øt qu·∫£ xu·∫•t s·∫Øc.</p>
            <div class="bg-gray-100 rounded-2xl p-4 mb-6">
                <p class="text-4xl font-black text-teal-500" id="final-score">28/30</p>
                <p class="text-sm text-gray-400 font-bold uppercase tracking-widest mt-1">S·ªë c√¢u ƒë√∫ng</p>
            </div>
            <p class="italic text-purple-500 font-bold mb-8" id="motivation-text">"S·ª± n·ªó l·ª±c c·ªßa em ch√≠nh l√† ch√¨a kh√≥a th√†nh c√¥ng!"</p>
            <button onclick="location.reload()" class="w-full py-4 bg-purple-600 text-white font-black rounded-2xl shadow-xl hover:bg-purple-700">
                L√ÄM L·∫†I B√ÄI THI
            </button>
        </div>
    </div>

    <!-- Audio Elements -->
    <audio id="sound-correct" src="https://assets.mixkit.co/active_storage/sfx/2000/2000-preview.mp3"></audio>
    <audio id="sound-wrong" src="https://assets.mixkit.co/active_storage/sfx/2019/2019-preview.mp3"></audio>

    <script>
        const quizData = [
            {
                q: "Listen! Someone ______ at the door.",
                options: ["knocks", "is knocking", "knock", "are knocking"],
                correct: 1,
                hints: {
                    analysis: ["knocks (v): g√µ c·ª≠a (chia Hi·ªán t·∫°i ƒë∆°n)", "is knocking (v): ƒëang g√µ c·ª≠a (Hi·ªán t·∫°i ti·∫øp di·ªÖn)", "knock (v): g√µ c·ª≠a (nguy√™n m·∫´u)", "are knocking (v): ƒëang g√µ c·ª≠a (s·ªë nhi·ªÅu)"],
                    translation: "Nghe k√¨a! C√≥ ai ƒë√≥ ƒëang g√µ c·ª≠a.",
                    whyCorrect: "D·ª±a v√†o 'Listen!' (Nghe k√¨a!) - ƒë√¢y l√† c√¢u m·ªánh l·ªánh d√πng ƒë·ªÉ thu h√∫t s·ª± ch√∫ √Ω v√†o m·ªôt s·ª± vi·ªác ƒêANG di·ªÖn ra ngay l√∫c n√≥i -> Chia Hi·ªán t·∫°i ti·∫øp di·ªÖn. 'Someone' l√† ƒë·∫°i t·ª´ b·∫•t ƒë·ªãnh s·ªë √≠t n√™n d√πng 'is'.",
                    whyWrong: "A v√† C sai th√¨ (Hi·ªán t·∫°i ƒë∆°n d√πng cho th√≥i quen). D sai v√¨ 'Someone' kh√¥ng ƒëi v·ªõi 'are'."
                }
            },
            {
                q: "My father ______ coffee every morning.",
                options: ["drink", "is drinking", "drinks", "drinking"],
                correct: 2,
                hints: {
                    analysis: ["drink (v): u·ªëng (nguy√™n m·∫´u)", "is drinking (v): ƒëang u·ªëng", "drinks (v): u·ªëng (s·ªë √≠t)", "drinking (v-ing): vi·ªác u·ªëng"],
                    translation: "B·ªë t√¥i u·ªëng c√† ph√™ m·ªói bu·ªïi s√°ng.",
                    whyCorrect: "D·ª±a v√†o c·ª•m t·ª´ 'every morning' (m·ªói s√°ng) -> ƒë√¢y l√† th√≥i quen l·∫∑p ƒëi l·∫∑p l·∫°i ·ªü hi·ªán t·∫°i -> Chia th√¨ Hi·ªán t·∫°i ƒë∆°n. Ch·ªß ng·ªØ 'My father' l√† s·ªë √≠t n√™n th√™m 's' v√†o ƒë·ªông t·ª´.",
                    whyWrong: "A sai v√¨ thi·∫øu 's'. B sai th√¨ (ti·∫øp di·ªÖn ch·ªâ h√†nh ƒë·ªông ƒëang x·∫£y ra). D sai c·∫•u tr√∫c ng·ªØ ph√°p."
                }
            },
            {
                q: "Where is Nam? - He ______ in his room.",
                options: ["reads", "is reading", "read", "are reading"],
                correct: 1,
                hints: {
                    analysis: ["reads (v): ƒë·ªçc (s·ªë √≠t)", "is reading (v): ƒëang ƒë·ªçc", "read (v): ƒë·ªçc (nguy√™n m·∫´u)", "are reading (v): ƒëang ƒë·ªçc (s·ªë nhi·ªÅu)"],
                    translation: "Nam ƒë√¢u r·ªìi? - C·∫≠u ·∫•y ƒëang ƒë·ªçc s√°ch trong ph√≤ng.",
                    whyCorrect: "Ng·ªØ c·∫£nh h·ªèi 'Where is Nam?' ng·ª• √Ω h√†nh ƒë·ªông ƒëang di·ªÖn ra t·∫°i th·ªùi ƒëi·ªÉm n√≥i -> Chia th√¨ Hi·ªán t·∫°i ti·∫øp di·ªÖn.",
                    whyWrong: "A, C sai th√¨. D sai v√¨ ch·ªß ng·ªØ 'He' ph·∫£i ƒëi v·ªõi 'is'."
                }
            },
            {
                q: "They usually ______ to school by bus.",
                options: ["go", "are going", "goes", "is going"],
                correct: 0,
                hints: {
                    analysis: ["go (v): ƒëi (nguy√™n m·∫´u)", "are going (v): ƒëang ƒëi", "goes (v): ƒëi (s·ªë √≠t)", "is going (v): ƒëang ƒëi (s·ªë √≠t)"],
                    translation: "H·ªç th∆∞·ªùng ƒëi h·ªçc b·∫±ng xe bu√Ωt.",
                    whyCorrect: "D·ª±a v√†o tr·∫°ng t·ª´ t·∫ßn su·∫•t 'usually' (th∆∞·ªùng xuy√™n) -> Di·ªÖn t·∫£ th√≥i quen -> Chia Hi·ªán t·∫°i ƒë∆°n. Ch·ªß ng·ªØ 'They' (s·ªë nhi·ªÅu) gi·ªØ nguy√™n ƒë·ªông t·ª´.",
                    whyWrong: "B, D sai th√¨. C sai v√¨ 'They' kh√¥ng ƒëi v·ªõi ƒë·ªông t·ª´ th√™m 'es'."
                }
            },
            {
                q: "Look! The bird ______.",
                options: ["fly", "flies", "is flying", "are flying"],
                correct: 2,
                hints: {
                    analysis: ["fly (v): bay (s·ªë nhi·ªÅu)", "flies (v): bay (s·ªë √≠t)", "is flying (v): ƒëang bay (s·ªë √≠t)", "are flying (v): ƒëang bay (s·ªë nhi·ªÅu)"],
                    translation: "Nh√¨n k√¨a! Con chim ƒëang bay.",
                    whyCorrect: "D·∫•u hi·ªáu 'Look!' (Nh√¨n k√¨a!) d√πng ƒë·ªÉ ch·ªâ h√†nh ƒë·ªông ƒëang di·ªÖn ra tr∆∞·ªõc m·∫Øt -> Chia Hi·ªán t·∫°i ti·∫øp di·ªÖn. 'The bird' l√† danh t·ª´ s·ªë √≠t.",
                    whyWrong: "A, B sai th√¨. D sai v√¨ ch·ªß ng·ªØ s·ªë √≠t kh√¥ng d√πng 'are'."
                }
            },
            {
                q: "We ______ English at the moment.",
                options: ["don't learn", "aren't learning", "doesn't learn", "isn't learning"],
                correct: 1,
                hints: {
                    analysis: ["don't learn: kh√¥ng h·ªçc (Hi·ªán t·∫°i ƒë∆°n)", "aren't learning: ƒëang kh√¥ng h·ªçc (Hi·ªán t·∫°i ti·∫øp di·ªÖn s·ªë nhi·ªÅu)", "doesn't learn: kh√¥ng h·ªçc (s·ªë √≠t)", "isn't learning: ƒëang kh√¥ng h·ªçc (s·ªë √≠t)"],
                    translation: "Hi·ªán t·∫°i ch√∫ng t√¥i ƒëang kh√¥ng h·ªçc ti·∫øng Anh.",
                    whyCorrect: "D·∫•u hi·ªáu 'at the moment' (ngay b√¢y gi·ªù) -> Chia Hi·ªán t·∫°i ti·∫øp di·ªÖn. Ch·ªß ng·ªØ 'We' ƒëi v·ªõi 'are'.",
                    whyWrong: "A, C sai th√¨. D sai v√¨ 'We' kh√¥ng ƒëi v·ªõi 'is'."
                }
            },
            {
                q: "My sister often ______ her face twice a day.",
                options: ["washes", "is washing", "wash", "washing"],
                correct: 0,
                hints: {
                    analysis: ["washes (v): r·ª≠a (s·ªë √≠t)", "is washing (v): ƒëang r·ª≠a", "wash (v): r·ª≠a (nguy√™n m·∫´u)", "washing (v-ing): vi·ªác r·ª≠a"],
                    translation: "Em g√°i t√¥i th∆∞·ªùng r·ª≠a m·∫∑t 2 l·∫ßn m·ªói ng√†y.",
                    whyCorrect: "D·∫•u hi·ªáu 'often' (th∆∞·ªùng) v√† 'twice a day' (2 l·∫ßn 1 ng√†y) ch·ªâ t·∫ßn su·∫•t th√≥i quen -> Hi·ªán t·∫°i ƒë∆°n. 'My sister' l√† s·ªë √≠t n√™n wash + es = washes.",
                    whyWrong: "B sai th√¨. C thi·∫øu 'es'. D sai c·∫•u tr√∫c."
                }
            },
            {
                q: "Be quiet! The baby ______.",
                options: ["sleeps", "is sleeping", "are sleeping", "sleep"],
                correct: 1,
                hints: {
                    analysis: ["sleeps (v): ng·ªß (s·ªë √≠t)", "is sleeping (v): ƒëang ng·ªß (s·ªë √≠t)", "are sleeping (v): ƒëang ng·ªß (s·ªë nhi·ªÅu)", "sleep (v): ng·ªß (nguy√™n m·∫´u)"],
                    translation: "Tr·∫≠t t·ª± n√†o! Em b√© ƒëang ng·ªß.",
                    whyCorrect: "D·∫•u hi·ªáu 'Be quiet!' (H√£y im l·∫∑ng) b√°o hi·ªáu h√†nh ƒë·ªông ƒëang di·ªÖn ra c·∫ßn s·ª± y√™n tƒ©nh -> Hi·ªán t·∫°i ti·∫øp di·ªÖn. 'The baby' l√† s·ªë √≠t.",
                    whyWrong: "A, D sai th√¨. C sai v√¨ ch·ªß ng·ªØ s·ªë √≠t."
                }
            },
            {
                q: "______ you ______ spicy food?",
                options: ["Do / like", "Are / liking", "Does / like", "Do / likes"],
                correct: 0,
                hints: {
                    analysis: ["Do / like: th√≠ch (Hi·ªán t·∫°i ƒë∆°n)", "Are / liking: ƒëang th√≠ch", "Does / like: th√≠ch (s·ªë √≠t)", "Do / likes: sai ng·ªØ ph√°p"],
                    translation: "B·∫°n c√≥ th√≠ch ƒë·ªì ƒÉn cay kh√¥ng?",
                    whyCorrect: "ƒê·ªông t·ª´ 'LIKE' l√† ƒë·ªông t·ª´ tr·∫°ng th√°i (stative verb), kh√¥ng ƒë∆∞·ª£c chia ·ªü th√¨ ti·∫øp di·ªÖn. V√¨ v·∫≠y ta d√πng Hi·ªán t·∫°i ƒë∆°n ƒë·ªÉ h·ªèi v·ªÅ s·ªü th√≠ch.",
                    whyWrong: "B sai v√¨ like kh√¥ng chia V-ing. C sai ng√¥i. D sai v√¨ sau Do + S + V nguy√™n m·∫´u."
                }
            },
            {
                q: "He ______ judo every Tuesday.",
                options: ["is doing", "does", "do", "doing"],
                correct: 1,
                hints: {
                    analysis: ["is doing (v): ƒëang t·∫≠p", "does (v): t·∫≠p (s·ªë √≠t)", "do (v): t·∫≠p (nguy√™n m·∫´u)", "doing (v-ing): vi·ªác t·∫≠p"],
                    translation: "Anh ·∫•y t·∫≠p v√µ judo v√†o m·ªói th·ª© Ba.",
                    whyCorrect: "D·∫•u hi·ªáu 'every Tuesday' (m·ªói th·ª© Ba) ch·ªâ th√≥i quen/l·ªãch tr√¨nh -> Hi·ªán t·∫°i ƒë∆°n. 'He' s·ªë √≠t d√πng 'does'.",
                    whyWrong: "A sai th√¨. C sai ng√¥i. D thi·∫øu tr·ª£ ƒë·ªông t·ª´/tobe."
                }
            },
            {
                q: "Right now, I ______ TV with my family.",
                options: ["watch", "am watching", "watches", "am watch"],
                correct: 1,
                hints: {
                    analysis: ["watch (v): xem", "am watching (v): ƒëang xem", "watches (v): xem (s·ªë √≠t)", "am watch: sai c·∫•u tr√∫c"],
                    translation: "Ngay l√∫c n√†y, t√¥i ƒëang xem TV c√πng gia ƒë√¨nh.",
                    whyCorrect: "D·∫•u hi·ªáu 'Right now' (Ngay b√¢y gi·ªù) -> Hi·ªán t·∫°i ti·∫øp di·ªÖn. Ch·ªß ng·ªØ 'I' ƒëi v·ªõi 'am'.",
                    whyWrong: "A, C sai th√¨. D thi·∫øu 'ing'."
                }
            },
            {
                q: "The sun ______ in the East.",
                options: ["rise", "is rising", "rises", "rising"],
                correct: 2,
                hints: {
                    analysis: ["rise (v): m·ªçc", "is rising (v): ƒëang m·ªçc", "rises (v): m·ªçc (s·ªë √≠t)", "rising (v-ing): vi·ªác m·ªçc"],
                    translation: "M·∫∑t tr·ªùi m·ªçc ·ªü h∆∞·ªõng ƒê√¥ng.",
                    whyCorrect: "ƒê√¢y l√† m·ªôt s·ª± th·∫≠t hi·ªÉn nhi√™n (scientific fact) -> Lu√¥n chia ·ªü th√¨ Hi·ªán t·∫°i ƒë∆°n. 'The sun' l√† duy nh·∫•t (s·ªë √≠t) n√™n ƒë·ªông t·ª´ th√™m 's'.",
                    whyWrong: "A sai ng√¥i. B sai th√¨ (kh√¥ng ph·∫£i ch·ªâ ƒëang m·ªçc l√∫c n√†y m√† l√† quy lu·∫≠t). D sai c·∫•u tr√∫c."
                }
            },
            {
                q: "Keep silent! The teacher ______.",
                options: ["is speaking", "speaks", "speak", "are speaking"],
                correct: 0,
                hints: {
                    analysis: ["is speaking (v): ƒëang n√≥i", "speaks (v): n√≥i (s·ªë √≠t)", "speak (v): n√≥i", "are speaking (v): ƒëang n√≥i (s·ªë nhi·ªÅu)"],
                    translation: "Gi·ªØ im l·∫∑ng n√†o! C√¥ gi√°o ƒëang n√≥i ƒë·∫•y.",
                    whyCorrect: "C·ª•m 'Keep silent!' b√°o hi·ªáu h√†nh ƒë·ªông ƒëang x·∫£y ra -> Hi·ªán t·∫°i ti·∫øp di·ªÖn.",
                    whyWrong: "B, C sai th√¨. D sai ng√¥i."
                }
            },
            {
                q: "______ Mai ______ to music now?",
                options: ["Does / listen", "Is / listening", "Do / listen", "Are / listening"],
                correct: 1,
                hints: {
                    analysis: ["Does / listen: nghe (Hi·ªán t·∫°i ƒë∆°n)", "Is / listening: ƒëang nghe", "Do / listen: sai ng√¥i", "Are / listening: sai ng√¥i"],
                    translation: "B√¢y gi·ªù Mai ƒëang nghe nh·∫°c ph·∫£i kh√¥ng?",
                    whyCorrect: "D·∫•u hi·ªáu 'now' (b√¢y gi·ªù) -> Hi·ªán t·∫°i ti·∫øp di·ªÖn. 'Mai' l√† s·ªë √≠t n√™n m∆∞·ª£n 'Is' ƒë∆∞a ra tr∆∞·ªõc.",
                    whyWrong: "A, C sai th√¨. D sai v√¨ Mai s·ªë √≠t."
                }
            },
            {
                q: "My father ______ a doctor. He works in a hospital.",
                options: ["is", "are", "am", "being"],
                correct: 0,
                hints: {
                    analysis: ["is: l√† (s·ªë √≠t)", "are: l√† (s·ªë nhi·ªÅu)", "am: l√† (ƒëi v·ªõi I)", "being: ƒëang l√†"],
                    translation: "B·ªë t√¥i l√† m·ªôt b√°c sƒ©. √îng ·∫•y l√†m vi·ªác trong b·ªánh vi·ªán.",
                    whyCorrect: "Di·ªÖn t·∫£ ngh·ªÅ nghi·ªáp, tr·∫°ng th√°i c·ªë ƒë·ªãnh c·ªßa m·ªôt ng∆∞·ªùi -> Hi·ªán t·∫°i ƒë∆°n v·ªõi ƒë·ªông t·ª´ To-be.",
                    whyWrong: "B, C sai ng√¥i. D kh√¥ng d√πng trong ng·ªØ c·∫£nh n√†y."
                }
            },
            {
                q: "Look at the sky! It ______.",
                options: ["rains", "is raining", "rain", "are raining"],
                correct: 1,
                hints: {
                    analysis: ["rains (v): m∆∞a", "is raining (v): ƒëang m∆∞a", "rain (v): m∆∞a", "are raining (v): ƒëang m∆∞a"],
                    translation: "Nh√¨n l√™n b·∫ßu tr·ªùi k√¨a! Tr·ªùi ƒëang m∆∞a ƒë√≥.",
                    whyCorrect: "D·∫•u hi·ªáu 'Look at...!' y√™u c·∫ßu nh√¨n v√†o s·ª± vi·ªác ƒëang x·∫£y ra -> Hi·ªán t·∫°i ti·∫øp di·ªÖn.",
                    whyWrong: "A, C sai th√¨. D sai ng√¥i (It ƒëi v·ªõi is)."
                }
            },
            {
                q: "We ______ our grandparents every Sunday.",
                options: ["are visiting", "visit", "visits", "visiting"],
                correct: 1,
                hints: {
                    analysis: ["are visiting (v): ƒëang thƒÉm", "visit (v): thƒÉm", "visits (v): thƒÉm (s·ªë √≠t)", "visiting (v-ing): vi·ªác thƒÉm"],
                    translation: "Ch√∫ng t√¥i thƒÉm √¥ng b√† v√†o m·ªói Ch·ªß nh·∫≠t.",
                    whyCorrect: "D·∫•u hi·ªáu 'every Sunday' ch·ªâ th√≥i quen -> Hi·ªán t·∫°i ƒë∆°n. 'We' s·ªë nhi·ªÅu n√™n ƒë·ªông t·ª´ gi·ªØ nguy√™n.",
                    whyWrong: "A sai th√¨. C sai ng√¥i. D thi·∫øu tobe."
                }
            },
            {
                q: "Sorry, I can't help you. I ______ my homework.",
                options: ["do", "am doing", "does", "doing"],
                correct: 1,
                hints: {
                    analysis: ["do (v): l√†m", "am doing (v): ƒëang l√†m", "does (v): l√†m (s·ªë √≠t)", "doing (v-ing): vi·ªác l√†m"],
                    translation: "Xin l·ªói, t·ªõ kh√¥ng gi√∫p c·∫≠u ƒë∆∞·ª£c. T·ªõ ƒëang l√†m b√†i t·∫≠p v·ªÅ nh√†.",
                    whyCorrect: "Ng·ªØ c·∫£nh t·ª´ ch·ªëi v√¨ ƒëang b·∫≠n l√†m vi·ªác g√¨ ƒë√≥ ngay l√∫c n√†y -> Hi·ªán t·∫°i ti·∫øp di·ªÖn.",
                    whyWrong: "A, C sai th√¨. D thi·∫øu tobe."
                }
            },
            {
                q: "______ your brother ______ football on weekends?",
                options: ["Does / play", "Is / playing", "Do / play", "Does / playing"],
                correct: 0,
                hints: {
                    analysis: ["Does / play: ch∆°i (Hi·ªán t·∫°i ƒë∆°n)", "Is / playing: ƒëang ch∆°i", "Do / play: sai ng√¥i", "Does / playing: sai c·∫•u tr√∫c"],
                    translation: "Anh trai b·∫°n c√≥ ch∆°i b√≥ng ƒë√° v√†o cu·ªëi tu·∫ßn kh√¥ng?",
                    whyCorrect: "D·∫•u hi·ªáu 'on weekends' (v√†o nh·ªØng ng√†y cu·ªëi tu·∫ßn) ch·ªâ th√≥i quen -> Hi·ªán t·∫°i ƒë∆°n. 'Your brother' l√† s·ªë √≠t n√™n d√πng tr·ª£ ƒë·ªông t·ª´ Does.",
                    whyWrong: "B sai th√¨. C sai ng√¥i. D sai c·∫•u tr√∫c (sau tr·ª£ ƒë·ªông t·ª´ d√πng V nguy√™n m·∫´u)."
                }
            },
            {
                q: "Please be careful! The bus ______.",
                options: ["comes", "is coming", "coming", "are coming"],
                correct: 1,
                hints: {
                    analysis: ["comes (v): ƒë·∫øn", "is coming (v): ƒëang ƒë·∫øn (s·ªë √≠t)", "coming (v-ing): ƒëang ƒë·∫øn", "are coming (v): ƒëang ƒë·∫øn (s·ªë nhi·ªÅu)"],
                    translation: "L√†m ∆°n c·∫©n th·∫≠n! Xe bu√Ωt ƒëang lao t·ªõi k√¨a.",
                    whyCorrect: "C√¢u c·∫£nh b√°o 'Please be careful!' d√πng cho s·ª± vi·ªác ƒëang x·∫£y ra ƒëe d·ªça ngay l√∫c ƒë√≥ -> Hi·ªán t·∫°i ti·∫øp di·ªÖn.",
                    whyWrong: "A sai th√¨. C thi·∫øu tobe. D sai ng√¥i."
                }
            },
            {
                q: "She never ______ up late.",
                options: ["get", "gets", "is getting", "getting"],
                correct: 1,
                hints: {
                    analysis: ["get (v): th·ª©c d·∫≠y", "gets (v): th·ª©c d·∫≠y (s·ªë √≠t)", "is getting (v): ƒëang d·∫≠y", "getting (v-ing): vi·ªác d·∫≠y"],
                    translation: "C√¥ ·∫•y kh√¥ng bao gi·ªù th·ª©c d·∫≠y mu·ªôn.",
                    whyCorrect: "D·∫•u hi·ªáu 'never' (kh√¥ng bao gi·ªù) l√† tr·∫°ng t·ª´ t·∫ßn su·∫•t ch·ªâ th√≥i quen -> Hi·ªán t·∫°i ƒë∆°n. 'She' s·ªë √≠t n√™n ƒë·ªông t·ª´ th√™m 's'.",
                    whyWrong: "A sai ng√¥i. C sai th√¨. D thi·∫øu tobe."
                }
            },
            {
                q: "They ______ lunch in the canteen at present.",
                options: ["have", "are having", "having", "are haveing"],
                correct: 1,
                hints: {
                    analysis: ["have (v): ƒÉn", "are having (v): ƒëang ƒÉn", "having: ƒëang ƒÉn", "are haveing: sai ch√≠nh t·∫£"],
                    translation: "Hi·ªán t·∫°i h·ªç ƒëang ƒÉn tr∆∞a ·ªü cƒÉng tin.",
                    whyCorrect: "D·∫•u hi·ªáu 'at present' = 'now' (hi·ªán t·∫°i) -> Hi·ªán t·∫°i ti·∫øp di·ªÖn. 'They' ƒëi v·ªõi 'are'.",
                    whyWrong: "A sai th√¨. C thi·∫øu tobe. D vi·∫øt sai ch√≠nh t·∫£ ƒë·ªông t·ª´ 'having' (b·ªè e th√™m ing)."
                }
            },
            {
                q: "I ______ how to speak English.",
                options: ["know", "am knowing", "knows", "knowing"],
                correct: 0,
                hints: {
                    analysis: ["know (v): bi·∫øt", "am knowing (v): ƒëang bi·∫øt", "knows (v): bi·∫øt (s·ªë √≠t)", "knowing (v-ing): ƒëang bi·∫øt"],
                    translation: "T√¥i bi·∫øt c√°ch n√≥i ti·∫øng Anh.",
                    whyCorrect: "ƒê·ªông t·ª´ 'KNOW' l√† ƒë·ªông t·ª´ nh·∫≠n th·ª©c/tr·∫°ng th√°i (stative verb), kh√¥ng bao gi·ªù d√πng ·ªü d·∫°ng ti·∫øp di·ªÖn. Do ƒë√≥ ch·ªâ d√πng Hi·ªán t·∫°i ƒë∆°n.",
                    whyWrong: "B v√† D sai v√¨ know kh√¥ng d√πng ing. C sai ng√¥i 'I'."
                }
            },
            {
                q: "Don't make noise! My mother ______.",
                options: ["works", "is working", "working", "are working"],
                correct: 1,
                hints: {
                    analysis: ["works (v): l√†m vi·ªác", "is working (v): ƒëang l√†m vi·ªác", "working (v-ing): ƒëang l√†m", "are working (v): ƒëang l√†m (s·ªë nhi·ªÅu)"],
                    translation: "ƒê·ª´ng l√†m ·ªìn! M·∫π t·ªõ ƒëang l√†m vi·ªác.",
                    whyCorrect: "D·∫•u hi·ªáu 'Don't make noise!' (ƒê·ª´ng l√†m ·ªìn) b√°o hi·ªáu h√†nh ƒë·ªông ƒëang c·∫ßn kh√¥ng gian y√™n tƒ©nh -> Hi·ªán t·∫°i ti·∫øp di·ªÖn.",
                    whyWrong: "A sai th√¨. C thi·∫øu tobe. D sai ng√¥i."
                }
            },
            {
                q: "What ______ you ______? - I'm a student.",
                options: ["do / do", "are / doing", "does / do", "do / doing"],
                correct: 0,
                hints: {
                    analysis: ["do / do: l√†m ngh·ªÅ g√¨", "are / doing: ƒëang l√†m g√¨", "does / do: sai ng√¥i", "do / doing: sai c·∫•u tr√∫c"],
                    translation: "B·∫°n l√†m ngh·ªÅ g√¨? - T√¥i l√† h·ªçc sinh.",
                    whyCorrect: "C√¢u tr·∫£ l·ªùi 'I'm a student' cho th·∫•y ƒë√¢y l√† c√¢u h·ªèi v·ªÅ ngh·ªÅ nghi·ªáp, v·ªã tr√≠ c·ªë ƒë·ªãnh -> Hi·ªán t·∫°i ƒë∆°n: What + do + you + do?",
                    whyWrong: "B l√† h·ªèi v·ªÅ h√†nh ƒë·ªông ƒëang l√†m. C sai ng√¥i. D sai ng·ªØ ph√°p."
                }
            },
            {
                q: "They ______ to the library twice a week.",
                options: ["goes", "go", "are going", "going"],
                correct: 1,
                hints: {
                    analysis: ["goes (v): ƒëi (s·ªë √≠t)", "go (v): ƒëi", "are going (v): ƒëang ƒëi", "going (v-ing): vi·ªác ƒëi"],
                    translation: "H·ªç ƒë·∫øn th∆∞ vi·ªán 2 l·∫ßn m·ªôt tu·∫ßn.",
                    whyCorrect: "D·∫•u hi·ªáu 'twice a week' (2 l·∫ßn m·ªôt tu·∫ßn) ch·ªâ t·∫ßn su·∫•t th√≥i quen -> Hi·ªán t·∫°i ƒë∆°n. 'They' ƒëi v·ªõi ƒë·ªông t·ª´ nguy√™n m·∫´u.",
                    whyWrong: "A sai ng√¥i. C sai th√¨. D thi·∫øu tobe."
                }
            },
            {
                q: "______ Lan ______ her homework now?",
                options: ["Is / doing", "Does / do", "Is / do", "Are / doing"],
                correct: 0,
                hints: {
                    analysis: ["Is / doing: ƒëang l√†m", "Does / do: c√≥ l√†m kh√¥ng", "Is / do: sai c·∫•u tr√∫c", "Are / doing: sai ng√¥i"],
                    translation: "Lan ƒëang l√†m b√†i t·∫≠p v·ªÅ nh√† b√¢y gi·ªù ph·∫£i kh√¥ng?",
                    whyCorrect: "D·∫•u hi·ªáu 'now' (b√¢y gi·ªù) -> Hi·ªán t·∫°i ti·∫øp di·ªÖn. Lan s·ªë √≠t d√πng 'Is'.",
                    whyWrong: "B sai th√¨. C thi·∫øu 'ing'. D sai ng√¥i."
                }
            },
            {
                q: "Water ______ at 100 degrees Celsius.",
                options: ["boil", "boils", "is boiling", "boiling"],
                correct: 1,
                hints: {
                    analysis: ["boil (v): s√¥i", "boils (v): s√¥i (s·ªë √≠t)", "is boiling (v): ƒëang s√¥i", "boiling (v-ing): vi·ªác s√¥i"],
                    translation: "N∆∞·ªõc s√¥i ·ªü nhi·ªát ƒë·ªô 100 ƒë·ªô C.",
                    whyCorrect: "ƒê√¢y l√† s·ª± th·∫≠t hi·ªÉn nhi√™n/ch√¢n l√Ω khoa h·ªçc -> Lu√¥n d√πng Hi·ªán t·∫°i ƒë∆°n. Danh t·ª´ kh√¥ng ƒë·∫øm ƒë∆∞·ª£c 'Water' ƒë∆∞·ª£c coi l√† s·ªë √≠t n√™n ƒë·ªông t·ª´ th√™m 's'.",
                    whyWrong: "A thi·∫øu 's'. C ch·ªâ h√†nh ƒë·ªông ƒëang x·∫£y ra (v√≠ d·ª•: nh√¨n ·∫•m n∆∞·ªõc ƒëang s√¥i). D thi·∫øu tobe."
                }
            },
            {
                q: "Look! The boys ______ football in the rain.",
                options: ["play", "are playing", "is playing", "plays"],
                correct: 1,
                hints: {
                    analysis: ["play (v): ch∆°i", "are playing (v): ƒëang ch∆°i (s·ªë nhi·ªÅu)", "is playing (v): ƒëang ch∆°i (s·ªë √≠t)", "plays (v): ch∆°i (s·ªë √≠t)"],
                    translation: "Nh√¨n k√¨a! Nh·ªØng c·∫≠u b√© ƒëang ƒë√° b√≥ng d∆∞·ªõi tr·ªùi m∆∞a.",
                    whyCorrect: "D·∫•u hi·ªáu 'Look!' -> Hi·ªán t·∫°i ti·∫øp di·ªÖn. 'The boys' l√† danh t·ª´ s·ªë nhi·ªÅu n√™n d√πng 'are playing'.",
                    whyWrong: "A, D sai th√¨. C sai ng√¥i (s·ªë nhi·ªÅu ƒëi v·ªõi are)."
                }
            },
            {
                q: "We usually have breakfast at home, but today we ______ out.",
                options: ["eat", "are eating", "eating", "eats"],
                correct: 1,
                hints: {
                    analysis: ["eat (v): ƒÉn", "are eating (v): ƒëang ƒÉn", "eating (v-ing): vi·ªác ƒÉn", "eats (v): ƒÉn (s·ªë √≠t)"],
                    translation: "Ch√∫ng t√¥i th∆∞·ªùng ƒÉn s√°ng ·ªü nh√†, nh∆∞ng h√¥m nay ch√∫ng t√¥i ƒëang ƒÉn ·ªü ngo√†i.",
                    whyCorrect: "D·∫•u hi·ªáu 'but today' (nh∆∞ng h√¥m nay) ch·ªâ m·ªôt s·ª± thay ƒë·ªïi t·∫°m th·ªùi, kh√°c v·ªõi th√≥i quen h·∫±ng ng√†y -> Hi·ªán t·∫°i ti·∫øp di·ªÖn.",
                    whyWrong: "A, D l√† th√≥i quen. C thi·∫øu tobe."
                }
            }
        ];

        let currentQuestion = 0;
        let score = 0;
        let canAnswer = true;

        const questionText = document.getElementById('question-text');
        const optionsGrid = document.getElementById('options-grid');
        const explanationContainer = document.getElementById('explanation-container');
        const explanationContent = document.getElementById('explanation-content');
        const progressFill = document.getElementById('progress-fill');
        const progressText = document.getElementById('progress-text');
        const scoreText = document.getElementById('score-text');
        const specialUI = document.getElementById('special-ui-placeholder');

        const correctSound = document.getElementById('sound-correct');
        const wrongSound = document.getElementById('sound-wrong');

        function initQuiz() {
            showQuestion();
        }

        function showQuestion() {
            canAnswer = true;
            const data = quizData[currentQuestion];
            
            // Update progress
            const progress = ((currentQuestion + 1) / quizData.length) * 100;
            progressFill.style.width = `${progress}%`;
            progressText.innerText = `C√¢u h·ªèi ${currentQuestion + 1}/${quizData.length}`;
            
            // Reset UI
            explanationContainer.style.display = 'none';
            optionsGrid.innerHTML = '';
            specialUI.innerHTML = '';
            
            // Render Special UI for Q29, Q30
            if (currentQuestion === 28) { // Q29
                specialUI.innerHTML = `<div class="text-center mb-4"><div class="sale-sign">‚öΩ RAIN MATCH! ‚öΩ</div></div>`;
            } else if (currentQuestion === 29) { // Q30
                specialUI.innerHTML = `<div class="flex justify-center mb-4"><div class="phone-msg">Mom: We are at the restaurant now! Come here!</div></div>`;
            }

            questionText.innerText = data.q;

            data.options.forEach((opt, index) => {
                const btn = document.createElement('button');
                btn.className = 'answer-btn';
                btn.innerHTML = `
                    <div class="flex items-center">
                        <span class="w-8 h-8 rounded-full border-2 border-gray-200 flex items-center justify-center mr-3 text-sm font-black text-gray-400 uppercase">${String.fromCharCode(65 + index)}</span>
                        <span>${opt}</span>
                    </div>
                `;
                btn.onclick = () => checkAnswer(index, btn);
                optionsGrid.appendChild(btn);
            });
        }

        function checkAnswer(selectedIndex, btn) {
            if (!canAnswer) return;
            canAnswer = false;

            const data = quizData[currentQuestion];
            const isCorrect = selectedIndex === data.correct;

            // Visual feedback
            const allBtns = optionsGrid.querySelectorAll('button');
            
            if (isCorrect) {
                score++;
                scoreText.innerText = `ƒêi·ªÉm: ${score}`;
                btn.classList.add('correct');
                correctSound.play().catch(() => {});
                confetti({
                    particleCount: 100,
                    spread: 70,
                    origin: { y: 0.6 },
                    colors: ['#8854C0', '#00C9A7', '#00D26A']
                });
            } else {
                btn.classList.add('wrong');
                btn.classList.add('shake');
                allBtns[data.correct].classList.add('correct');
                wrongSound.play().catch(() => {});
            }

            showExplanation(data);
        }

        function showExplanation(data) {
            explanationContent.innerHTML = `
                <div>
                    <p class="font-bold text-gray-800">1. Ph√¢n t√≠ch 4 ƒë√°p √°n:</p>
                    <ul class="list-disc ml-5 mt-1">
                        ${data.hints.analysis.map(a => `<li>${a}</li>`).join('')}
                    </ul>
                </div>
                <div>
                    <p class="font-bold text-gray-800">2. D·ªãch nghƒ©a to√†n c√¢u:</p>
                    <p class="italic text-gray-600 bg-gray-50 p-2 rounded-lg border-l-4 border-gray-300">"${data.hints.translation}"</p>
                </div>
                <div>
                    <p class="font-bold text-emerald-600">3. T·∫°i sao ch·ªçn ƒë√°p √°n n√†y?</p>
                    <p>${data.hints.whyCorrect}</p>
                </div>
                <div>
                    <p class="font-bold text-red-500">4. T·∫°i sao c√°c ƒë√°p √°n kia sai?</p>
                    <p>${data.hints.whyWrong}</p>
                </div>
                <div class="pt-2 text-sm font-bold text-purple-600 uppercase">
                    ‚≠ê ƒê√°p √°n ƒë√∫ng: ${String.fromCharCode(65 + data.correct)}
                </div>
            `;
            explanationContainer.style.display = 'block';
            
            // Smooth scroll to explanation
            setTimeout(() => {
                explanationContainer.scrollIntoView({ behavior: 'smooth', block: 'nearest' });
            }, 100);
        }

        function nextQuestion() {
            currentQuestion++;
            if (currentQuestion < quizData.length) {
                showQuestion();
                window.scrollTo({ top: 0, behavior: 'smooth' });
            } else {
                showFinishModal();
            }
        }

        function showFinishModal() {
            const modal = document.getElementById('finish-modal');
            const card = document.getElementById('modal-card');
            const finalScore = document.getElementById('final-score');
            const motivation = document.getElementById('motivation-text');

            finalScore.innerText = `${score}/${quizData.length}`;
            
            // dynamic feedback
            if (score === quizData.length) {
                motivation.innerText = "Tuy·ªát ƒë·ªânh c√¥ng phu! Em l√† thi√™n t√†i ng·ªØ ph√°p!";
            } else if (score >= 24) {
                motivation.innerText = "R·∫•t gi·ªèi! Ch·ªâ c·∫ßn c·∫©n th·∫≠n h∆°n m·ªôt ch√∫t l√† ho√†n h·∫£o!";
            } else if (score >= 15) {
                motivation.innerText = "Kh√° l·∫Øm! H√£y √¥n t·∫≠p l·∫°i c√°c d·∫•u hi·ªáu nh·∫≠n bi·∫øt nh√©!";
            } else {
                motivation.innerText = "ƒê·ª´ng n·∫£n ch√≠! 'Practice makes perfect', c·ªë g·∫Øng l√™n em!";
            }

            modal.classList.remove('hidden');
            setTimeout(() => {
                card.classList.remove('scale-90', 'opacity-0');
                card.classList.add('scale-100', 'opacity-100');
            }, 10);
            
            confetti({
                particleCount: 200,
                spread: 160,
                origin: { y: 0.6 }
            });
        }

        // Run when loaded
        window.onload = initQuiz;
    </script>
</body>
</html>
