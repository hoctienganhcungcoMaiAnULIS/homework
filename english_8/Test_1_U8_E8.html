<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>IELTS 8.0 Interactive Test: Unit 8 Shopping</title>
    <style>
        :root {
            --primary: #2563eb;
            --primary-dark: #1e40af;
            --success: #16a34a;
            --success-bg: #dcfce7;
            --danger: #dc2626;
            --danger-bg: #fee2e2;
            --bg: #f1f5f9;
            --card: #ffffff;
            --text: #334155;
            --border: #e2e8f0;
        }

        body {
            font-family: 'Segoe UI', Roboto, Helvetica, Arial, sans-serif;
            background-color: var(--bg);
            color: var(--text);
            line-height: 1.6;
            margin: 0;
            padding: 20px;
            padding-bottom: 100px;
        }

        .container {
            max-width: 900px;
            margin: 0 auto;
        }

        /* HEADER */
        header {
            background: linear-gradient(135deg, var(--primary), var(--primary-dark));
            color: white;
            padding: 30px;
            border-radius: 16px;
            text-align: center;
            margin-bottom: 30px;
            box-shadow: 0 10px 25px -5px rgba(37, 99, 235, 0.4);
        }

        header h1 { margin: 0; font-size: 2.2rem; font-weight: 800; }
        header p { margin: 10px 0 0; opacity: 0.9; font-size: 1.1rem; }

        /* QUESTION CARD */
        .question-card {
            background: var(--card);
            border-radius: 12px;
            padding: 25px;
            margin-bottom: 25px;
            box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1);
            border: 1px solid var(--border);
            position: relative;
        }

        .q-header {
            font-weight: 700;
            color: var(--primary);
            margin-bottom: 15px;
            font-size: 1rem;
            text-transform: uppercase;
            letter-spacing: 0.5px;
            border-bottom: 2px solid var(--bg);
            padding-bottom: 10px;
        }

        .q-text {
            font-size: 1.15rem;
            font-weight: 600;
            margin-bottom: 20px;
            color: #0f172a;
        }

        /* READING PASSAGE BOX */
        .passage-box {
            background-color: #f8fafc;
            border-left: 5px solid var(--primary);
            padding: 20px;
            margin-bottom: 25px;
            border-radius: 0 8px 8px 0;
            font-size: 1.05rem;
            line-height: 1.8;
            border: 1px solid var(--border);
            border-left-width: 5px;
        }

        /* OPTIONS GRID */
        .options-grid {
            display: grid;
            grid-template-columns: 1fr;
            gap: 12px;
        }
        @media(min-width: 640px) { .options-grid { grid-template-columns: 1fr 1fr; } }

        .option-label {
            display: flex;
            align-items: flex-start;
            padding: 12px 15px;
            border: 2px solid var(--border);
            border-radius: 8px;
            cursor: pointer;
            transition: all 0.2s;
            background: white;
        }
        .option-label:hover { border-color: var(--primary); background-color: #eff6ff; }
        .option-input { margin-top: 5px; margin-right: 12px; transform: scale(1.2); flex-shrink: 0; }

        /* FEEDBACK STYLES */
        .correct { background-color: var(--success-bg) !important; border-color: var(--success) !important; color: #14532d; }
        .wrong { background-color: var(--danger-bg) !important; border-color: var(--danger) !important; color: #7f1d1d; }

        /* EXPLANATION BOX */
        .explanation {
            display: none;
            margin-top: 20px;
            padding: 20px;
            background-color: #f0fdf4;
            border: 1px solid #bbf7d0;
            border-radius: 8px;
            animation: fadeIn 0.3s ease-in;
        }
        .explanation.show { display: block; }
        .exp-header { font-weight: 800; color: var(--success); margin-bottom: 10px; display: flex; align-items: center; gap: 8px; }
        .pos-tag { 
            display: inline-block; 
            background: #e2e8f0; 
            color: #475569; 
            font-size: 0.75rem; 
            padding: 2px 6px; 
            border-radius: 4px; 
            margin-right: 5px; 
            font-weight: bold;
            vertical-align: middle;
        }
        .trans-text { color: #0f172a; font-style: italic; }

        /* BUTTONS */
        .btn-check {
            background-color: #334155;
            color: white;
            border: none;
            padding: 10px 24px;
            border-radius: 6px;
            cursor: pointer;
            font-weight: 600;
            margin-top: 20px;
            transition: 0.2s;
        }
        .btn-check:hover { background-color: #1e293b; transform: translateY(-1px); }

        .btn-submit {
            background-color: var(--primary);
            color: white;
            border: none;
            padding: 15px 40px;
            border-radius: 50px;
            font-size: 1.2rem;
            font-weight: bold;
            cursor: pointer;
            box-shadow: 0 4px 15px rgba(37, 99, 235, 0.4);
            transition: 0.2s;
        }
        .btn-submit:hover { background-color: var(--primary-dark); transform: translateY(-2px); }

        /* FOOTER */
        .footer-bar {
            position: fixed;
            bottom: 0;
            left: 0;
            right: 0;
            background: white;
            padding: 15px 20px;
            box-shadow: 0 -4px 20px rgba(0,0,0,0.1);
            display: flex;
            justify-content: space-between;
            align-items: center;
            z-index: 100;
            border-top: 1px solid var(--border);
        }

        /* SPECIAL BLOCKS (SIGNS, GAP FILL) */
        .sign-img {
            width: 180px;
            border: 4px solid #000;
            padding: 10px;
            text-align: center;
            font-weight: 900;
            margin: 10px 0;
            background: #facc15;
            color: black;
            text-transform: uppercase;
        }
        .notice-img {
            border: 2px solid #ef4444;
            color: #ef4444;
            padding: 15px;
            font-weight: bold;
            background: #fff;
            font-family: monospace;
            margin: 10px 0;
        }

        /* GAP FILL BOX STYLES (Q37-40) */
        .gap-fill-container {
            border: 2px solid var(--primary);
            border-radius: 8px;
            overflow: hidden;
            margin-bottom: 20px;
        }
        .gap-fill-options-box {
            background-color: #eff6ff;
            padding: 20px;
            border-bottom: 2px solid var(--primary);
        }
        .gap-fill-options-box h4 { margin-top: 0; color: var(--primary-dark); }
        .gap-option-item { margin-bottom: 8px; font-weight: 500; }
        .gap-fill-text-content {
            padding: 25px;
            background-color: white;
            font-size: 1.1rem;
            line-height: 1.8;
            white-space: pre-wrap;
        }
        .gap-question-row {
            margin-top: 20px;
            padding-top: 20px;
            border-top: 1px solid var(--border);
        }

        @keyframes fadeIn { from { opacity: 0; transform: translateY(10px); } to { opacity: 1; transform: translateY(0); } }

    </style>
</head>
<body>

<div class="container">
    <header>
        <h1>UNIT 8: SHOPPING</h1>
        <p>TEST 01 - Interactive Master Key</p>
        <p style="font-size: 0.9rem; margin-top: 5px">Teacher: Gemini (IELTS 8.0 Expert)</p>
    </header>

    <div id="quiz-content">
        </div>
</div>

<div class="footer-bar">
    <div class="container" style="display:flex; justify-content:space-between; width:100%; align-items:center;">
        <div style="font-weight:bold; font-size:1.1rem" id="score-text">Progress: 0/40</div>
        <button class="btn-submit" onclick="submitExam()">N·ªòP B√ÄI & XEM ƒêI·ªÇM</button>
    </div>
</div>

<script>
const quizData = [
    // --- PHONETICS ---
    {
        id: 1, type: "Phonetics",
        q: "Mark the letter A, B, C or D to indicate the word whose underlined part differs in pronunciation.",
        text: "A. br<u>a</u>nd &nbsp; B. r<u>a</u>nge &nbsp; C. s<u>a</u>le &nbsp; D. b<u>a</u>ke",
        opts: ["A", "B", "C", "D"], ans: 0,
        expl: "<b>Ph√¢n t√≠ch:</b><br>‚Ä¢ A. brand <span class='pos-tag'>n</span> /br√¶nd/ (√¢m √¶)<br>‚Ä¢ B. range <span class='pos-tag'>n</span> /re…™nd í/ (√¢m e…™)<br>‚Ä¢ C. sale <span class='pos-tag'>n</span> /se…™l/ (√¢m e…™)<br>‚Ä¢ D. bake <span class='pos-tag'>v</span> /be…™k/ (√¢m e…™)<br>‚ûî <b>Ch·ªçn A</b> v√¨ ph√°t √¢m l√† /√¶/, c√≤n l·∫°i l√† /e…™/."
    },
    {
        id: 2, type: "Phonetics",
        q: "Mark the letter A, B, C or D to indicate the word whose underlined part differs in pronunciation.",
        text: "A. s<u>t</u>adium &nbsp; B. of<u>t</u>en &nbsp; C. cas<u>t</u>le &nbsp; D. whis<u>t</u>le",
        opts: ["A", "B", "C", "D"], ans: 0,
        expl: "<b>Ph√¢n t√≠ch √¢m c√¢m (Silent letters):</b><br>‚Ä¢ A. stadium <span class='pos-tag'>n</span> /Ààste…™.di.…ôm/ (√¢m 't' ph√°t √¢m r√µ)<br>‚Ä¢ B. often <span class='pos-tag'>adv</span> /Àà…íf.…ôn/ (√¢m 't' c√¢m)<br>‚Ä¢ C. castle <span class='pos-tag'>n</span> /Ààk…ëÀê.slÃ©/ (√¢m 't' c√¢m)<br>‚Ä¢ D. whistle <span class='pos-tag'>v</span> /Ààw…™s.lÃ©/ (√¢m 't' c√¢m)<br>‚ûî <b>Ch·ªçn A</b>."
    },
    // --- STRESS ---
    {
        id: 3, type: "Stress",
        q: "Indicate the word that differs in the position of primary stress.",
        text: "A. episode &nbsp; B. addicted &nbsp; C. excitement &nbsp; D. assistant",
        opts: ["A", "B", "C", "D"], ans: 0,
        expl: "<b>Ph√¢n t√≠ch tr·ªçng √¢m:</b><br>‚Ä¢ A. episode <span class='pos-tag'>n</span> /Ààep.…™.s…ô äd/ (Nh·∫•n √¢m 1)<br>‚Ä¢ B. addicted <span class='pos-tag'>adj</span> /…ôÀàd…™k.t…™d/ (Nh·∫•n √¢m 2)<br>‚Ä¢ C. excitement <span class='pos-tag'>n</span> /…™kÀàsa…™t.m…ônt/ (Nh·∫•n √¢m 2)<br>‚Ä¢ D. assistant <span class='pos-tag'>n</span> /…ôÀàs…™s.t…ônt/ (Nh·∫•n √¢m 2)<br>‚ûî <b>Ch·ªçn A</b>."
    },
    {
        id: 4, type: "Stress",
        q: "Indicate the word that differs in the position of primary stress.",
        text: "A. receive &nbsp; B. repeat &nbsp; C. private &nbsp; D. provide",
        opts: ["A", "B", "C", "D"], ans: 2,
        expl: "<b>Ph√¢n t√≠ch tr·ªçng √¢m:</b><br>‚Ä¢ A. receive <span class='pos-tag'>v</span> /r…™ÀàsiÀêv/ (Nh·∫•n √¢m 2)<br>‚Ä¢ B. repeat <span class='pos-tag'>v</span> /r…™ÀàpiÀêt/ (Nh·∫•n √¢m 2)<br>‚Ä¢ C. private <span class='pos-tag'>adj</span> /Ààpra…™.v…ôt/ (Nh·∫•n √¢m 1)<br>‚Ä¢ D. provide <span class='pos-tag'>v</span> /pr…ôÀàva…™d/ (Nh·∫•n √¢m 2)<br>‚ûî <b>Ch·ªçn C</b>."
    },
    // --- GRAMMAR & VOCAB ---
    {
        id: 5, type: "Vocabulary",
        q: "The responsibility of a _____ is to provide customers with help and sell goods.",
        opts: ["A. Shop assistant", "B. dealer", "C. customer service", "D. cashier"], ans: 0,
        expl: "<b>Gi·∫£i th√≠ch t·ª´ v·ª±ng:</b><br>‚Ä¢ A. Shop assistant <span class='pos-tag'>n</span>: Nh√¢n vi√™n b√°n h√†ng (Ng∆∞·ªùi tr·ª±c ti·∫øp gi√∫p kh√°ch v√† b√°n h√†ng - ƒê√∫ng ng·ªØ c·∫£nh).<br>‚Ä¢ B. dealer <span class='pos-tag'>n</span>: Nh√† bu√¥n/ƒê·∫°i l√Ω.<br>‚Ä¢ C. customer service <span class='pos-tag'>n</span>: D·ªãch v·ª• kh√°ch h√†ng (B·ªô ph·∫≠n/kh√°i ni·ªám, kh√¥ng ph·∫£i t√™n ngh·ªÅ nghi·ªáp c·ª• th·ªÉ trong c√¢u n√†y).<br>‚Ä¢ D. cashier <span class='pos-tag'>n</span>: Thu ng√¢n (Ch·ªâ t√≠nh ti·ªÅn)."
    },
    {
        id: 6, type: "Vocabulary",
        q: "I don‚Äôt know how to ______ for lower prices so I shop in supermarkets as they have fixed prices.",
        opts: ["A. Bargain", "B. negotiate", "C. discuss", "D. beg"], ans: 0,
        expl: "<b>Gi·∫£i th√≠ch ng·ªØ c·∫£nh:</b><br>Ng·ªØ c·∫£nh l√† 'lower prices' (gi√° th·∫•p h∆°n) v√† ƒë·ªëi l·∫≠p v·ªõi 'fixed prices' (gi√° ni√™m y·∫øt).<br>‚Ä¢ A. Bargain <span class='pos-tag'>v</span>: M·∫∑c c·∫£, tr·∫£ gi√° (D√πng ph·ªï bi·∫øn trong mua s·∫Øm).<br>‚Ä¢ B. negotiate <span class='pos-tag'>v</span>: ƒê√†m ph√°n (Th∆∞·ªùng d√πng trong kinh doanh, h·ª£p ƒë·ªìng trang tr·ªçng).<br>‚Ä¢ C. discuss <span class='pos-tag'>v</span>: Th·∫£o lu·∫≠n.<br>‚Ä¢ D. beg <span class='pos-tag'>v</span>: C·∫ßu xin."
    },
    {
        id: 7, type: "Grammar",
        q: "The factory outlets _____ a special offer for all items next week as planned.",
        opts: ["A. will give", "B. give", "C. are giving", "D. are going to give"], ans: 2,
        expl: "<b>Ng·ªØ ph√°p: Th√¨ hi·ªán t·∫°i ti·∫øp di·ªÖn (Present Continuous)</b><br>D·∫•u hi·ªáu: 'next week' (t∆∞∆°ng lai) v√† 'as planned' (theo k·∫ø ho·∫°ch ƒë√£ ƒë·ªãnh).<br>Khi di·ªÖn t·∫£ m·ªôt k·∫ø ho·∫°ch ƒë√£ ƒë∆∞·ª£c s·∫Øp x·∫øp c·ªë ƒë·ªãnh (arrangement) trong t∆∞∆°ng lai, ta d√πng th√¨ Hi·ªán t·∫°i ti·∫øp di·ªÖn.<br>‚ûî <b>Ch·ªçn C. are giving</b>."
    },
    {
        id: 8, type: "Grammar",
        q: "The Community Fair _______ this Spring, and we have all decided to attend it.",
        opts: ["A. is held", "B. will be held", "C. will take place", "D. is taking place"], ans: 3,
        expl: "<b>Ng·ªØ ph√°p: Future Arrangements</b><br>S·ª± ki·ªán 'H·ªôi ch·ª£' ƒë√£ ƒë∆∞·ª£c l√™n l·ªãch ('this Spring') v√† m·ªçi ng∆∞·ªùi ƒë√£ quy·∫øt ƒë·ªãnh tham gia ('decided to attend').<br>‚Ä¢ A. is held: B·ªã ƒë·ªông hi·ªán t·∫°i ƒë∆°n (ch·ªâ th√≥i quen/s·ª± th·∫≠t).<br>‚Ä¢ B. will be held: B·ªã ƒë·ªông t∆∞∆°ng lai ƒë∆°n (d·ª± ƒëo√°n).<br>‚Ä¢ C. will take place: T∆∞∆°ng lai ƒë∆°n (d·ª± ƒëo√°n).<br>‚Ä¢ D. is taking place: Hi·ªán t·∫°i ti·∫øp di·ªÖn (K·∫ø ho·∫°ch ch·∫Øc ch·∫Øn di·ªÖn ra).<br>‚ûî <b>Ch·ªçn D</b> (Active voice - Di·ªÖn ra theo k·∫ø ho·∫°ch)."
    },
    {
        id: 9, type: "Grammar",
        q: "________ they took their laptops to the shop, they asked for their receipts.",
        opts: ["A. If", "B. When", "C. Since", "D. Because"], ans: 1,
        expl: "<b>Li√™n t·ª´ ch·ªâ th·ªùi gian:</b><br>‚Ä¢ A. If <span class='pos-tag'>conj</span>: N·∫øu (C√¢u ƒëi·ªÅu ki·ªán - sai nghƒ©a).<br>‚Ä¢ B. When <span class='pos-tag'>conj</span>: Khi (Di·ªÖn t·∫£ h√†nh ƒë·ªông x·∫£y ra n·ªëi ti·∫øp nhau: Khi mang m√°y ƒë·∫øn th√¨ h·ªèi h√≥a ƒë∆°n).<br>‚Ä¢ C. Since <span class='pos-tag'>conj</span>: K·ªÉ t·ª´ khi/B·ªüi v√¨.<br>‚Ä¢ D. Because <span class='pos-tag'>conj</span>: B·ªüi v√¨.<br>‚ûî <b>Ch·ªçn B</b> h·ª£p l√Ω nh·∫•t v·ªÅ m·∫∑t ng·ªØ nghƒ©a th·ªùi gian."
    },
    {
        id: 10, type: "Vocabulary",
        q: "Tom: ‚ÄúDo you ever drink coffee?‚Äù ‚Äì Lan: ‚ÄúYes, but only _____, not often. Just a few times a week.‚Äú",
        opts: ["A. usually", "B. sometimes", "C. rarely", "D. never"], ans: 1,
        expl: "<b>Tr·∫°ng t·ª´ ch·ªâ t·∫ßn su·∫•t:</b><br>Lan n√≥i 'not often' (kh√¥ng th∆∞·ªùng xuy√™n) v√† 'a few times a week' (v√†i l·∫ßn m·ªôt tu·∫ßn).<br>‚Ä¢ A. usually <span class='pos-tag'>adv</span>: th∆∞·ªùng xuy√™n (Sai).<br>‚Ä¢ B. sometimes <span class='pos-tag'>adv</span>: th·ªânh tho·∫£ng (ƒê√∫ng v·ªõi t·∫ßn su·∫•t v√†i l·∫ßn/tu·∫ßn).<br>‚Ä¢ C. rarely <span class='pos-tag'>adv</span>: hi·∫øm khi (Qu√° √≠t so v·ªõi 'a few times').<br>‚Ä¢ D. never <span class='pos-tag'>adv</span>: kh√¥ng bao gi·ªù."
    },
    {
        id: 11, type: "Grammar",
        q: "I went through about 4 years of being addicted ________ video games.",
        opts: ["A. play", "B. to play", "C. to playing", "D. playing"], ans: 2,
        expl: "<b>C·∫•u tr√∫c c√¢u:</b><br>‚Ä¢ Be addicted to + V-ing/Noun: Nghi·ªán c√°i g√¨/l√†m g√¨.<br>‚Ä¢ ·ªû ƒë√¢y 'to' l√† gi·ªõi t·ª´, n√™n ƒë·ªông t·ª´ theo sau ph·∫£i th√™m -ing.<br>‚ûî <b>Ch·ªçn C. to playing</b>."
    },
    {
        id: 12, type: "Grammar",
        q: "You are still responsible _____ paying the shipping costs if you return an item.",
        opts: ["A. on", "B. off", "C. for", "D. in"], ans: 2,
        expl: "<b>Collocation (C·ª•m t·ª´ c·ªë ƒë·ªãnh):</b><br>‚Ä¢ Responsible for + V-ing/Noun: Ch·ªãu tr√°ch nhi·ªám v·ªÅ vi·ªác g√¨.<br>‚ûî <b>Ch·ªçn C. for</b>."
    },
    // --- CLOZE 1 (Party) ---
    {
        id: 13, type: "Cloze Test",
        q: "Question 13: You are invited to (13) ____ us.",
        passage: "<b>YEAR-END PARTY</b>\nYou are invited to (13) ____ us\nJanuary 09, 2024. 17:00 P.M School Hall.\nHo! Ho! Ho! It‚Äôs that time of year (14) ____.\nWe‚Äôre so excited (15) ____ no one will be absent.\nPlease contact if you (16) _____ your friends to the party.",
        opts: ["A. enjoy", "B. join", "C. participate", "D. take part"], ans: 1,
        expl: "<b>T·ª´ v·ª±ng:</b><br>‚Ä¢ A. enjoy <span class='pos-tag'>v</span>: Th∆∞·ªüng th·ª©c.<br>‚Ä¢ B. join <span class='pos-tag'>v</span>: Tham gia c√πng ai (Join someone/us - Kh√¥ng c·∫ßn gi·ªõi t·ª´).<br>‚Ä¢ C. participate <span class='pos-tag'>v</span>: C·∫ßn gi·ªõi t·ª´ 'in'.<br>‚Ä¢ D. take part <span class='pos-tag'>v</span>: C·∫ßn gi·ªõi t·ª´ 'in'.<br>‚ûî <b>Ch·ªçn B</b>."
    },
    {
        id: 14, type: "Cloze Test",
        q: "Question 14: It‚Äôs that time of year (14) ____.",
        opts: ["A. about", "B. above", "C. alike", "D. again"], ans: 3,
        expl: "<b>Th√†nh ng·ªØ:</b><br>‚Ä¢ 'It‚Äôs that time of year again': L·∫°i ƒë·∫øn th·ªùi ƒëi·ªÉm ƒë√≥ trong nƒÉm r·ªìi (C√¢u n√≥i quen thu·ªôc d·ªãp l·ªÖ t·∫øt).<br>‚ûî <b>Ch·ªçn D. again</b>."
    },
    {
        id: 15, type: "Cloze Test",
        q: "Question 15: We‚Äôre so excited (15) ____ no one will be absent.",
        opts: ["A. why", "B. if", "C. that", "D. whether"], ans: 2,
        expl: "<b>C·∫•u tr√∫c ng·ªØ ph√°p:</b><br>‚Ä¢ S + be + so + Adj + THAT + clause: Qu√° ... ƒë·∫øn n·ªói m√† ...<br>D·ªãch: Ch√∫ng t√¥i h√†o h·ª©ng ƒë·∫øn n·ªói mong r·∫±ng s·∫Ω kh√¥ng ai v·∫Øng m·∫∑t.<br>‚ûî <b>Ch·ªçn C. that</b>."
    },
    {
        id: 16, type: "Cloze Test",
        q: "Question 16: Please contact if you (16) _____ your friends to the party.",
        opts: ["A. brings", "B. bringing", "C. bring", "D. to bring"], ans: 2,
        expl: "<b>Ng·ªØ ph√°p: C√¢u ƒëi·ªÅu ki·ªán lo·∫°i 1</b><br>‚Ä¢ If + S + V(hi·ªán t·∫°i ƒë∆°n).<br>Ch·ªß ng·ªØ l√† 'you' n√™n ƒë·ªông t·ª´ 'bring' gi·ªØ nguy√™n m·∫´u.<br>‚ûî <b>Ch·ªçn C. bring</b>."
    },
    // --- REARRANGE ---
    {
        id: 17, type: "Rearrangement",
        q: "Arrange the sentences to make a complete paragraph:",
        text: `(a) Then, destinations include the Grand Canyon... Also, these locations are famous...
(b) Finally, to join the trip, please register by June 15th...
(c) First, an upcoming trip will take you to see some of the world‚Äôs most incredible natural wonders.
(d) Additionally, this adventure will provide a unique experience.
(e) Next, the trip starts on July 1st...`,
        opts: ["A. c-d-a-b", "B. c-a-d-b", "C. a-c-d-b", "D. c-d-b-a"], ans: 0,
        expl: "<b>Logic ƒëo·∫°n vƒÉn:</b><br>1. <b>(c) First:</b> M·ªü ƒë·∫ßu, gi·ªõi thi·ªáu chuy·∫øn ƒëi.<br>2. <b>(d) Additionally:</b> Th√™m th√¥ng tin b·ªï tr·ª£ v·ªÅ tr·∫£i nghi·ªám.<br>3. <b>(a) Then:</b> Li·ªát k√™ c√°c ƒë·ªãa ƒëi·ªÉm.<br>4. <b>(b) Finally:</b> Th√¥ng tin ƒëƒÉng k√Ω v√† k·∫øt th√∫c.<br>*(ƒê√°p √°n A l∆∞·ª£c b·ªè √Ω 'e' trong t√πy ch·ªçn nh∆∞ng gi·ªØ ƒë√∫ng tr·∫≠t t·ª± logic nh·∫•t: First -> Additionally -> Then -> Finally)*."
    },
    {
        id: 18, type: "Rearrangement",
        q: "Arrange the sentences to make a complete report:",
        text: `(a) More than 300 students attended the fair...
(b) In my view, the day was a great success. All the attendees felt happy.
(c) There were 30 stalls where various activities were offered.
(d) Yesterday, our school organized the Spring Fair in the playground.
(e) However, it would be better if we could make Banh Chung during the night.`,
        opts: ["A. d-a-c-b-e", "B. d-b-a-c-e", "C. b-d-a-e-c", "D. b-c-d-e-a"], ans: 0,
        expl: "<b>Logic b√°o c√°o:</b><br>1. <b>(d) Yesterday...:</b> Gi·ªõi thi·ªáu s·ª± ki·ªán (Th·ªùi gian, ƒë·ªãa ƒëi·ªÉm).<br>2. <b>(a) 300 students...:</b> S·ªë li·ªáu ng∆∞·ªùi tham gia.<br>3. <b>(c) 30 stalls...:</b> Chi ti·∫øt ho·∫°t ƒë·ªông.<br>4. <b>(b) In my view...:</b> ƒê√°nh gi√° t·ªïng quan/K·∫øt lu·∫≠n.<br>5. <b>(e) However...:</b> √ù ki·∫øn ƒë√≥ng g√≥p th√™m.<br>‚ûî <b>Ch·ªçn A</b>."
    },
    // --- CLOZE 2 ---
    {
        id: 19, type: "Cloze Test",
        passage: "The most important (19) _____ that influences a person to go shopping is the needs or wants of the individual or people related (20) ____ him/ her. For example, everyone goes to the mall to buy basic necessities like food, clothes... They will ship less if they have (21) ____ mouth to feed and shop more if the number of dependents is (22) _____. Secondly, a person cannot purchase anything (23) _____ he/ she has the monetary means to do so. This means that if one has more money... On the other hand, a person with less (24) _____ stability will focus more on vital merchandise.",
        q: "Question 19:",
        opts: ["A. effect", "B. factor", "C. reaction", "D. person"], ans: 1,
        expl: "<b>T·ª´ v·ª±ng:</b><br>‚Ä¢ A. effect <span class='pos-tag'>n</span>: Hi·ªáu ·ª©ng.<br>‚Ä¢ B. factor <span class='pos-tag'>n</span>: Y·∫øu t·ªë (Y·∫øu t·ªë quan tr·ªçng nh·∫•t ·∫£nh h∆∞·ªüng ƒë·∫øn...).<br>‚Ä¢ C. reaction <span class='pos-tag'>n</span>: Ph·∫£n ·ª©ng.<br>‚Ä¢ D. person <span class='pos-tag'>n</span>: Ng∆∞·ªùi.<br>‚ûî <b>Ch·ªçn B</b>."
    },
    {
        id: 20, type: "Cloze Test",
        q: "Question 20: ...people related (20) ____ him/ her.",
        opts: ["A. to", "B. with", "C. about", "D. within"], ans: 0,
        expl: "<b>Collocation:</b><br>‚Ä¢ Related TO someone/something: C√≥ li√™n quan ƒë·∫øn, c√≥ quan h·ªá v·ªõi.<br>‚ûî <b>Ch·ªçn A</b>."
    },
    {
        id: 21, type: "Cloze Test",
        q: "Question 21: They will shop less if they have (21) ____ mouth to feed...",
        opts: ["A. less", "B. more", "C. much", "D. many"], ans: 0,
        expl: "<b>Ng·ªØ c·∫£nh & Th√†nh ng·ªØ:</b><br>‚Ä¢ 'Less mouths to feed': √çt mi·ªáng ƒÉn h∆°n (√çt ng∆∞·ªùi ph·ª• thu·ªôc h∆°n).<br>‚Ä¢ M·∫∑c d√π 'mouths' ƒë·∫øm ƒë∆∞·ª£c (ƒë√°ng l·∫Ω d√πng fewer), nh∆∞ng trong th√†nh ng·ªØ n√†y 'less' ƒë∆∞·ª£c ch·∫•p nh·∫≠n r·ªông r√£i ƒë·ªÉ ch·ªâ s·ªë l∆∞·ª£ng gi·∫£m ƒëi.<br>‚ûî <b>Ch·ªçn A</b>."
    },
    {
        id: 22, type: "Cloze Test",
        q: "Question 22: ...and shop more if the number of dependents is (22) _____.",
        opts: ["A. least", "B. less", "C. many", "D. more"], ans: 3,
        expl: "<b>C·∫•u tr√∫c so s√°nh song song:</b><br>V·∫ø tr∆∞·ªõc: Shop less - less mouths.<br>V·∫ø sau: Shop more - number of dependents is <b>more</b> (nhi·ªÅu h∆°n).<br>‚ûî <b>Ch·ªçn D</b>."
    },
    {
        id: 23, type: "Cloze Test",
        q: "Question 23: Secondly, a person cannot purchase anything (23) _____ he/ she has the monetary means to do so.",
        opts: ["A. when", "B. if", "C. unless", "D. whether"], ans: 2,
        expl: "<b>Li√™n t·ª´ ƒëi·ªÅu ki·ªán:</b><br>‚Ä¢ C. Unless <span class='pos-tag'>conj</span>: Tr·ª´ khi (= If... not).<br>D·ªãch: M·ªôt ng∆∞·ªùi kh√¥ng th·ªÉ mua g√¨ <b>tr·ª´ khi</b> h·ªç c√≥ ti·ªÅn.<br>‚ûî <b>Ch·ªçn C</b>."
    },
    {
        id: 24, type: "Cloze Test",
        q: "Question 24: On the other hand, a person with less (24) _____ stability will focus more on vital merchandise.",
        opts: ["A. finance", "B. financial", "C. financials", "D. financially"], ans: 1,
        expl: "<b>T·ª´ lo·∫°i:</b><br>C·∫ßn m·ªôt T√≠nh t·ª´ (Adj) ƒë·ªÉ b·ªï nghƒ©a cho danh t·ª´ 'stability' (s·ª± ·ªïn ƒë·ªãnh).<br>‚Ä¢ A. finance <span class='pos-tag'>n</span>.<br>‚Ä¢ B. financial <span class='pos-tag'>adj</span>: Thu·ªôc v·ªÅ t√†i ch√≠nh.<br>‚Ä¢ C. financials <span class='pos-tag'>n</span> (s·ªë nhi·ªÅu).<br>‚Ä¢ D. financially <span class='pos-tag'>adv</span>.<br>‚ûî <b>Ch·ªçn B</b>."
    },
    // --- TRANSFORM ---
    {
        id: 25, type: "Transformation",
        q: "Closest meaning: I like spending time with my sister over the weekend to browse instead of buying.",
        opts: [
            "A. I enjoy getting out with my sister on the weekends to browse and buy.",
            "B. I prefer getting out with my sister on the weekends to buy something.",
            "C. I‚Äôm interested in spending time with my sister to browse",
            "D. On the weekends, I like to spend time with my sister to browse instead of making purchases."
        ], ans: 3,
        expl: "<b>Ph√¢n t√≠ch nghƒ©a:</b><br>C√¢u g·ªëc: Th√≠ch ƒëi xem (browse) <b>thay v√¨</b> mua (instead of buying).<br>‚Ä¢ A: browse AND buy (Sai nghƒ©a).<br>‚Ä¢ D: browse instead of <b>making purchases</b> (ƒê·ªìng nghƒ©a v·ªõi buying).<br>‚ûî <b>Ch·ªçn D</b>."
    },
    {
        id: 26, type: "Transformation",
        q: "Closest meaning: Due to the supermarket‚Äôs set prices, I am unable to bargain there.",
        opts: [
            "A. Because of the fixed prices at supermarkets, I can never haggle there.",
            "B. Since grocery pricing are set, I can never haggle there.",
            "C. I can never bargain at a supermarket because the prices is fixed.",
            "D. Since grocery pricing are fixed, I never can haggle there."
        ], ans: 0,
        expl: "<b>ƒê·ªìng nghƒ©a t·ª´ v·ª±ng:</b><br>‚Ä¢ Set prices = Fixed prices (Gi√° c·ªë ƒë·ªãnh).<br>‚Ä¢ Bargain = Haggle (M·∫∑c c·∫£).<br>‚Ä¢ Due to = Because of.<br>‚ûî <b>Ch·ªçn A</b>. (C√°c c√¢u kh√°c sai ng·ªØ ph√°p: 'pricing are', 'prices is')."
    },
    {
        id: 27, type: "Sentence Building",
        q: "Build sentence: They/ often/ spend/ hours/ bargain/ shop/ for discounts.",
        opts: [
            "A. They often spend hours bargaining and shopping for discounts",
            "B. They often spend hours to bargain and shopping for discounts",
            "C. They often spend hours to bargain and shop for discounts",
            "D. They often spend hours bargain and shop for discounts."
        ], ans: 0,
        expl: "<b>C·∫•u tr√∫c Spend:</b><br>‚Ä¢ Spend + time + V-ing: D√†nh th·ªùi gian l√†m g√¨.<br>‚ûî C·∫ßn d√πng 'bargaining' v√† 'shopping'.<br>‚ûî <b>Ch·ªçn A</b>."
    },
    {
        id: 28, type: "Sentence Building",
        q: "Build sentence: Online shopping/ convenient/ it/ sometimes/ disappoint/ quality.",
        opts: [
            "A. Online shopping is convenient, but it sometimes disappoints in quality",
            "B. Online shopping is convenient, but it sometimes disappoint in quality",
            "C. Online shopping is convenient, it sometimes disappoints in quality",
            "D. Online shopping is convenient, and it sometimes disappoint in quality."
        ], ans: 0,
        expl: "<b>Ph√¢n t√≠ch:</b><br>‚Ä¢ Hai v·∫ø ƒë·ªëi l·∫≠p (Ti·ªán l·ª£i >< Th·∫•t v·ªçng) d√πng li√™n t·ª´ 'but'.<br>‚Ä¢ Ch·ªß ng·ªØ 'it' s·ªë √≠t ‚ûî ƒê·ªông t·ª´ 'disappoints' th√™m s.<br>‚ûî <b>Ch·ªçn A</b>."
    },
    // --- SIGNS ---
    {
        id: 29, type: "Sign Reading",
        q: "What does the sign mean?",
        text: "<div class='sign-img'>CAUTION<br>‚û°<br>USE OTHER DOOR</div>",
        opts: [
            "A. You should use this door if you want to enter",
            "B. Please use a different door to go inside the building",
            "C. This door can only be used for emergencies",
            "D. This door cannot be opened because it is blocked"
        ], ans: 1,
        expl: "<b>Gi·∫£i th√≠ch bi·ªÉn b√°o:</b><br>Bi·ªÉn ghi 'USE OTHER DOOR' (D√πng c·ª≠a kh√°c).<br>‚ûî ƒê·ªìng nghƒ©a: B. Please use a different door (Vui l√≤ng d√πng c·ª≠a kh√°c)."
    },
    {
        id: 30, type: "Sign Reading",
        q: "What does the notice say?",
        text: "<div class='notice-img'>The parking lot will be full on Saturday due to a big event. Please park on the street.</div>",
        opts: [
            "A. Please don‚Äôt park on Saturday, we have an event.",
            "B. You can park in the parking lot on Saturday without any problems.",
            "C. There will be more parking on Saturday.",
            "D. There will be more cars in the parking lot on Saturday, park on the street."
        ], ans: 3,
        expl: "<b>Gi·∫£i th√≠ch th√¥ng b√°o:</b><br>Th√¥ng b√°o: B√£i xe s·∫Ω ƒë·∫ßy (full)... vui l√≤ng ƒë·ªó ngo√†i ƒë∆∞·ªùng (park on the street).<br>‚ûî <b>Ch·ªçn D</b>: C√≥ nhi·ªÅu xe trong b√£i (full), h√£y ƒë·ªó ngo√†i ƒë∆∞·ªùng."
    },
    // --- READING 3 ---
    {
        id: 31, type: "Reading Comprehension",
        passage: "<b>Online shopping</b>\nMy name is Sara, and I love shopping online. I prefer mobile phone apps, but sometimes I use my computer. The phone is more convenient for me, and I can even do my shopping from bed.\n\nI love shopping so much that I buy everything I need at home. I get food, electronics, books, and even large pieces of furniture like my sofa and bookshelves all online! But I still prefer getting clothes from a store so I can try them on to be sure they fit me fine.\n\nYesterday, I bought a birthday present for my mother, and it arrived today! That saves me a lot of time. I am a very busy person, and I am a little forgetful too. If I think of something I need, then it is wonderful that I can buy it that moment.\n\nMy friends aren't as comfortable with buying things online as I am because they think that it can be dangerous. Of course, bad things sometimes happen, but I am very careful with all of my personal details. I think the biggest fear that people have with using their credit cards online is that someone will steal their number. It is important to be sure that the web page is secure. You can see this if the address has got an 's' in it, like https://.\n\nPeople should not be afraid of shopping online. I think it will be the only way we will do our shopping in the future!",
        q: "Question 31: What is Sara‚Äôs favorite way of shopping?",
        opts: ["A. On her computer", "B. On her phone", "C. In a shop", "D. In an open-air market"], ans: 1,
        expl: "<b>D·∫´n ch·ª©ng ƒëo·∫°n 1:</b><br>'I prefer mobile phone apps... The phone is more convenient for me'.<br>‚ûî <b>Ch·ªçn B</b>."
    },
    {
        id: 32, type: "Reading Comprehension",
        q: "Question 32: What doesn‚Äôt Sara buy online?",
        opts: ["A. Books", "B. Clothes", "C. Furniture", "D. Electronics"], ans: 1,
        expl: "<b>D·∫´n ch·ª©ng ƒëo·∫°n 2:</b><br>'But I still prefer getting clothes from a store so I can try them on...'<br>‚ûî <b>Ch·ªçn B</b>."
    },
    {
        id: 33, type: "Reading Comprehension",
        q: "Question 33: Why does Sara think online shopping is very convenient?",
        opts: ["A. It‚Äôs cheap", "B. It‚Äôs slow", "C. It‚Äôs fast", "D. It‚Äôs beautiful"], ans: 2,
        expl: "<b>D·∫´n ch·ª©ng ƒëo·∫°n 3:</b><br>'...it arrived today! That saves me a lot of time.' (Ti·∫øt ki·ªám th·ªùi gian = Nhanh).<br>‚ûî <b>Ch·ªçn C</b>."
    },
    {
        id: 34, type: "Reading Comprehension",
        q: "Question 34: What does ‚ÄúSteal‚Äù mean in paragraph 4?",
        opts: ["A. To shop online", "B. To make public", "C. To use something that is not yours", "D. To take without permission"], ans: 3,
        expl: "<b>T·ª´ v·ª±ng:</b><br>Steal <span class='pos-tag'>v</span> = ƒÇn tr·ªôm.<br>‚ûî <b>Ch·ªçn D. To take without permission</b> (L·∫•y m√† kh√¥ng xin ph√©p)."
    },
    {
        id: 35, type: "Reading Comprehension",
        q: "Question 35: Sara thinks that shopping online _____.",
        opts: ["A. is complex", "B. is often dangerous", "C. is always safe", "D. is safe if you are careful"], ans: 3,
        expl: "<b>D·∫´n ch·ª©ng ƒëo·∫°n 4:</b><br>'...but I am very careful... It is important to be sure that the web page is secure.'<br>‚ûî <b>Ch·ªçn D</b> (An to√†n n·∫øu c·∫©n th·∫≠n)."
    },
    {
        id: 36, type: "Reading Comprehension",
        q: "Question 36: Sara thinks that in the future ________.",
        opts: ["A. Everybody will only shop online", "B. Nobody will shop online", "C. Only shopping will be safer", "D. A lot of people will shop online"], ans: 0,
        expl: "<b>D·∫´n ch·ª©ng ƒëo·∫°n cu·ªëi:</b><br>'I think it will be the only way we will do our shopping in the future!' (C√°ch duy nh·∫•t).<br>‚ûî <b>Ch·ªçn A</b>."
    },
    // --- SPECIAL GAP FILL (Q37-40) ---
    // Using a special object structure to render the box layout
    {
        id: 37, type: "GapFillGroup",
        optionsList: [
            "A - especially when selecting gifts for others on special occasions",
            "B - Online shopping is a popular choice for those with busy schedules",
            "C - but they can cause frustration when technical issues arise and assistance is unavailable",
            "D - leading to disappointment and the need to return items at the customer‚Äôs expense"
        ],
        text: "Shopping can sometimes be a challenging experience, (37) ______. Many people choose to give gift vouchers, allowing recipients to shop at their convenience. (38) _____ , as it lets them purchase essential or luxury items from home or while on the go. Deliveries are often free, and prices are usually lower than those in physical stores. However, the description or quality of online products may differ from expectations, (39) _____. For in-store shopping, self-service payment machines are commonly used to save time by avoiding long queues, (40) _____.",
        questions: [
            {
                subId: 37,
                q: "Question 37:",
                opts: ["A", "B", "C", "D"],
                ans: 0,
                expl: "<b>Gi·∫£i th√≠ch Q37:</b><br>C√¢u tr∆∞·ªõc: Mua s·∫Øm ƒë√¥i khi l√† tr·∫£i nghi·ªám kh√≥ khƒÉn...<br>C√¢u sau: Nhi·ªÅu ng∆∞·ªùi ch·ªçn t·∫∑ng vouchers.<br>‚ûî <b>ƒêi·ªÅn A:</b> '...nh·∫•t l√† khi ch·ªçn qu√† cho ng∆∞·ªùi kh√°c' (L√Ω do kh√≥ khƒÉn ‚ûî d·∫´n ƒë·∫øn gi·∫£i ph√°p t·∫∑ng voucher)."
            },
            {
                subId: 38,
                q: "Question 38:",
                opts: ["A", "B", "C", "D"],
                ans: 1,
                expl: "<b>Gi·∫£i th√≠ch Q38:</b><br>V·ªã tr√≠ ƒë·∫ßu c√¢u, c·∫ßn c√¢u ch·ªß ƒë·ªÅ cho ƒëo·∫°n n√≥i v·ªÅ mua s·∫Øm online (mua t·∫°i nh√†, ti·ªán l·ª£i).<br>‚ûî <b>ƒêi·ªÅn B:</b> 'Mua s·∫Øm tr·ª±c tuy·∫øn l√† l·ª±a ch·ªçn ph·ªï bi·∫øn cho ng∆∞·ªùi b·∫≠n r·ªôn...'."
            },
            {
                subId: 39,
                q: "Question 39:",
                opts: ["A", "B", "C", "D"],
                ans: 3,
                expl: "<b>Gi·∫£i th√≠ch Q39:</b><br>C√¢u tr∆∞·ªõc: Ch·∫•t l∆∞·ª£ng online c√≥ th·ªÉ kh√°c mong ƒë·ª£i...<br>‚ûî C·∫ßn m·ªôt m·ªánh ƒë·ªÅ ch·ªâ h·∫≠u qu·∫£ ti√™u c·ª±c.<br>‚ûî <b>ƒêi·ªÅn D:</b> '...d·∫´n ƒë·∫øn th·∫•t v·ªçng v√† ph·∫£i tr·∫£ h√†ng...'."
            },
            {
                subId: 40,
                q: "Question 40:",
                opts: ["A", "B", "C", "D"],
                ans: 2,
                expl: "<b>Gi·∫£i th√≠ch Q40:</b><br>C√¢u tr∆∞·ªõc: M√°y thanh to√°n t·ª± ƒë·ªông gi√∫p ti·∫øt ki·ªám th·ªùi gian...<br>‚ûî C·∫ßn m·ªôt √Ω t∆∞∆°ng ph·∫£n (nh∆∞·ª£c ƒëi·ªÉm) ƒë·ªÉ k·∫øt ƒëo·∫°n.<br>‚ûî <b>ƒêi·ªÅn C:</b> '...nh∆∞ng ch√∫ng c√≥ th·ªÉ g√¢y b·ª±c b·ªôi khi l·ªói k·ªπ thu·∫≠t...'."
            }
        ]
    }
];

// RENDER FUNCTION
const quizContent = document.getElementById('quiz-content');

quizData.forEach((item, index) => {
    // Handling Standard Questions
    if (item.type !== "GapFillGroup") {
        const card = document.createElement('div');
        card.className = 'question-card';
        card.id = `q-card-${item.id}`;

        let html = `<div class="q-header">${item.q}</div>`;
        
        // Show Passage only if it's new (or for Reading 3, Q31)
        if (item.passage && (item.id === 13 || item.id === 19 || item.id === 31)) {
            html += `<div class="passage-box">${item.passage.replace(/\n/g, '<br>')}</div>`;
        }

        html += `<div class="q-text">${item.text || item.q}</div>`;
        
        // Options
        html += `<div class="options-grid">`;
        item.opts.forEach((opt, i) => {
            html += `
                <label class="option-label" id="opt-${item.id}-${i}">
                    <input type="radio" name="q${item.id}" value="${i}" class="option-input">
                    <span>${opt}</span>
                </label>
            `;
        });
        html += `</div>`;

        // Check Button
        html += `<button class="btn-check" onclick="checkAnswer(${index})">Check Answer</button>`;

        // Explanation
        html += `
            <div class="explanation" id="expl-${item.id}">
                <div class="exp-header">üîç EXPLANATION:</div>
                ${item.expl}
            </div>
        `;

        card.innerHTML = html;
        quizContent.appendChild(card);
    } 
    // Handling Special Gap Fill Group (Q37-40)
    else {
        const card = document.createElement('div');
        card.className = 'question-card';
        card.style.border = "none";
        card.style.boxShadow = "none";
        card.style.background = "transparent";
        card.style.padding = "0";

        let html = `
            <div class="gap-fill-container">
                <div class="gap-fill-options-box">
                    <h4>OPTIONS:</h4>
                    ${item.optionsList.map(opt => `<div class="gap-option-item">${opt}</div>`).join('')}
                </div>
                <div class="gap-fill-text-content">
                    <b>Text:</b><br>
                    ${item.text}
                </div>
            </div>
        `;

        // Render sub-questions
        item.questions.forEach((subQ, subIndex) => {
            html += `
                <div class="question-card" id="q-card-${subQ.subId}" style="border-left: 5px solid var(--primary);">
                    <div class="q-header">${subQ.q}</div>
                    <div class="options-grid">
                        ${subQ.opts.map((opt, i) => `
                            <label class="option-label" id="opt-${subQ.subId}-${i}">
                                <input type="radio" name="q${subQ.subId}" value="${i}" class="option-input">
                                <span>${opt}</span>
                            </label>
                        `).join('')}
                    </div>
                    <button class="btn-check" onclick="checkSubAnswer(${index}, ${subIndex})">Check Answer</button>
                    <div class="explanation" id="expl-${subQ.subId}">
                        <div class="exp-header">üîç EXPLANATION:</div>
                        ${subQ.expl}
                    </div>
                </div>
            `;
        });

        card.innerHTML = html;
        quizContent.appendChild(card);
    }
});

// CHECK FUNCTIONS
function checkAnswer(dataIndex) {
    const item = quizData[dataIndex];
    const selected = document.querySelector(`input[name="q${item.id}"]:checked`);
    
    if (!selected) { alert("Please select an answer!"); return; }
    
    const userVal = parseInt(selected.value);
    const explDiv = document.getElementById(`expl-${item.id}`);
    const labels = document.querySelectorAll(`#q-card-${item.id} .option-label`);

    // Reset
    labels.forEach(l => l.classList.remove('correct', 'wrong'));

    // Highlight
    labels[item.ans].classList.add('correct');
    if (userVal !== item.ans) {
        labels[userVal].classList.add('wrong');
    }

    // Show Explain
    explDiv.classList.add('show');
}

function checkSubAnswer(parentIndex, subIndex) {
    const parentItem = quizData[parentIndex];
    const subQ = parentItem.questions[subIndex];
    const selected = document.querySelector(`input[name="q${subQ.subId}"]:checked`);

    if (!selected) { alert("Please select an answer!"); return; }

    const userVal = parseInt(selected.value);
    const explDiv = document.getElementById(`expl-${subQ.subId}`);
    const labels = document.querySelectorAll(`#q-card-${subQ.subId} .option-label`);

    labels.forEach(l => l.classList.remove('correct', 'wrong'));
    labels[subQ.ans].classList.add('correct');
    if (userVal !== subQ.ans) {
        labels[userVal].classList.add('wrong');
    }
    explDiv.classList.add('show');
}

// SUBMIT EXAM
function submitExam() {
    let score = 0;
    let total = 40;
    let answered = 0;

    // Standard items
    quizData.forEach((item, idx) => {
        if (item.type !== "GapFillGroup") {
            const selected = document.querySelector(`input[name="q${item.id}"]:checked`);
            document.getElementById(`expl-${item.id}`).classList.add('show');
            document.querySelectorAll(`#q-card-${item.id} .option-label`)[item.ans].classList.add('correct');
            
            if (selected) {
                answered++;
                if (parseInt(selected.value) === item.ans) score++;
                else document.getElementById(`opt-${item.id}-${selected.value}`).classList.add('wrong');
            }
        } else {
            // Group items
            item.questions.forEach(subQ => {
                const selected = document.querySelector(`input[name="q${subQ.subId}"]:checked`);
                document.getElementById(`expl-${subQ.subId}`).classList.add('show');
                document.querySelectorAll(`#q-card-${subQ.subId} .option-label`)[subQ.ans].classList.add('correct');

                if (selected) {
                    answered++;
                    if (parseInt(selected.value) === subQ.ans) score++;
                    else document.getElementById(`opt-${subQ.subId}-${selected.value}`).classList.add('wrong');
                }
            });
        }
    });

    const scoreText = document.getElementById('score-text');
    scoreText.innerHTML = `Final Score: <span style="color:${score >= 20 ? 'green' : 'red'}">${score}/${total}</span>`;
    
    alert(`B·∫°n ƒë√£ ho√†n th√†nh b√†i thi!\nS·ªë c√¢u ƒë√∫ng: ${score}/${total}\n(B·∫°n ƒë√£ l√†m ${answered} c√¢u)`);
    window.scrollTo({ top: 0, behavior: 'smooth' });
}

</script>

</body>
</html>
