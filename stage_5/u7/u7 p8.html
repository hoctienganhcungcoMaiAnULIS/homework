<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>B√†i T·∫≠p Gi·ªõi T·ª´ (Part 2) - Ms Mai An ULIS</title>
    <link href="https://fonts.googleapis.com/css2?family=Nunito:wght@400;600;700;800&family=Quicksand:wght@500;700&display=swap" rel="stylesheet">
    <style>
        /* GI·ªÆ NGUY√äN GIAO DI·ªÜN C≈® - KH√îNG ƒê·ªîI */
        :root {
            --primary-purple: #8854C0;
            --primary-teal: #00C9A7;
            --correct-green: #00D26A;
            --wrong-red: #FF4757;
            --bg-color: #f0f3fa;
            --card-bg: #ffffff;
            --text-color: #2c3e50;
        }

        body {
            font-family: 'Nunito', sans-serif;
            background-color: var(--bg-color);
            background-image: radial-gradient(var(--primary-purple) 1px, transparent 1px), radial-gradient(var(--primary-teal) 1px, transparent 1px);
            background-size: 20px 20px;
            background-position: 0 0, 10px 10px;
            margin: 0;
            padding: 20px;
            color: var(--text-color);
            overflow-x: hidden;
        }

        .container {
            max-width: 800px;
            margin: 0 auto;
        }

        header {
            text-align: center;
            margin-bottom: 30px;
            background: white;
            padding: 20px;
            border-radius: 20px;
            box-shadow: 0 8px 0 rgba(0,0,0,0.1);
            border: 2px solid var(--primary-purple);
        }

        h1 {
            color: var(--primary-purple);
            margin: 0;
            font-family: 'Quicksand', sans-serif;
            font-weight: 800;
            font-size: 2rem;
            text-transform: uppercase;
        }

        .sub-header {
            font-size: 1rem;
            color: #777;
            margin-top: 5px;
            font-weight: 600;
        }

        /* Question Card Style */
        .question-card {
            background: var(--card-bg);
            border-radius: 20px;
            padding: 25px;
            margin-bottom: 30px;
            box-shadow: 0 6px 0 #e0e0e0, 0 10px 10px rgba(0,0,0,0.1);
            position: relative;
            transition: transform 0.3s ease;
            border: 2px solid #eee;
        }

        .question-number {
            display: inline-block;
            background: var(--primary-purple);
            color: white;
            padding: 5px 15px;
            border-radius: 15px;
            font-weight: bold;
            font-size: 0.9rem;
            margin-bottom: 15px;
            box-shadow: 0 3px 0 rgba(0,0,0,0.2);
        }

        .question-text {
            font-size: 1.3rem;
            font-weight: 700;
            margin-bottom: 25px;
            line-height: 1.5;
        }

        .options-grid {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 15px;
        }

        @media (max-width: 600px) {
            .options-grid {
                grid-template-columns: 1fr;
            }
        }

        .option-btn {
            background: white;
            border: 2px solid #e0e0e0;
            border-radius: 15px;
            padding: 15px 20px;
            font-size: 1.1rem;
            font-family: 'Nunito', sans-serif;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.2s;
            text-align: left;
            position: relative;
            box-shadow: 0 4px 0 #ccc;
            color: var(--text-color);
        }

        .option-btn:hover:not(:disabled) {
            transform: scale(1.02);
            border-color: var(--primary-teal);
            background-color: #f0fffa;
        }

        .option-btn:active:not(:disabled) {
            transform: translateY(4px);
            box-shadow: 0 0 0 #ccc;
        }

        /* Correct/Wrong States */
        .option-btn.correct {
            background-color: var(--correct-green) !important;
            color: white !important;
            border-color: var(--correct-green) !important;
            box-shadow: 0 4px 0 #008f48 !important;
        }

        .option-btn.wrong {
            background-color: var(--wrong-red) !important;
            color: white !important;
            border-color: var(--wrong-red) !important;
            box-shadow: 0 4px 0 #b3202d !important;
            animation: shake 0.5s;
        }

        /* Explanation Section */
        .explanation-box {
            display: none; /* Hidden by default */
            margin-top: 20px;
            background: #fff9e6;
            border: 2px solid #ffd700;
            border-radius: 15px;
            padding: 20px;
            animation: slideDown 0.4s ease-out;
        }

        .explanation-box.visible {
            display: block;
        }

        .exp-header {
            display: flex;
            align-items: center;
            gap: 10px;
            font-weight: 800;
            color: #d35400;
            margin-bottom: 10px;
            font-size: 1.1rem;
        }

        .exp-content {
            font-size: 1rem;
            line-height: 1.6;
        }

        .exp-step {
            margin-bottom: 10px;
        }

        .exp-label {
            font-weight: 700;
            color: var(--primary-purple);
            text-decoration: underline;
        }

        /* Animations */
        @keyframes shake {
            0% { transform: translateX(0); }
            25% { transform: translateX(-5px) rotate(-2deg); }
            50% { transform: translateX(5px) rotate(2deg); }
            75% { transform: translateX(-5px) rotate(-2deg); }
            100% { transform: translateX(0); }
        }

        @keyframes slideDown {
            from { opacity: 0; transform: translateY(-10px); }
            to { opacity: 1; transform: translateY(0); }
        }

        /* Submit Button */
        #submit-btn {
            display: block;
            width: 100%;
            background: var(--primary-teal);
            color: white;
            border: none;
            padding: 20px;
            font-size: 1.5rem;
            font-weight: 800;
            border-radius: 20px;
            box-shadow: 0 6px 0 #00917c;
            cursor: pointer;
            margin-top: 40px;
            transition: all 0.2s;
            font-family: 'Quicksand', sans-serif;
            text-transform: uppercase;
        }

        #submit-btn:hover {
            filter: brightness(1.1);
            transform: translateY(-2px);
        }

        #submit-btn:active {
            transform: translateY(4px);
            box-shadow: 0 0 0 #00917c;
        }

        /* Result Modal */
        .modal-overlay {
            display: none;
            position: fixed;
            top: 0; left: 0; width: 100%; height: 100%;
            background: rgba(0,0,0,0.7);
            z-index: 1000;
            justify-content: center;
            align-items: center;
            backdrop-filter: blur(5px);
        }

        .modal-content {
            background: white;
            padding: 40px;
            border-radius: 30px;
            text-align: center;
            max-width: 500px;
            width: 90%;
            border: 5px solid var(--primary-purple);
            animation: popUp 0.5s cubic-bezier(0.175, 0.885, 0.32, 1.275);
        }

        @keyframes popUp {
            from { transform: scale(0.5); opacity: 0; }
            to { transform: scale(1); opacity: 1; }
        }

        .score-display {
            font-size: 3rem;
            font-weight: 900;
            color: var(--primary-teal);
            margin: 20px 0;
        }

        /* Confetti Canvas */
        #confetti-canvas {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            pointer-events: none;
            z-index: 999;
        }
         /* Phonetics Underline */
        u {
            text-decoration: none;
            border-bottom: 2px solid var(--primary-purple);
            padding-bottom: 2px;
        }
    </style>
</head>
<body>

    <div class="container">
        <header>
            <div class="sub-header">Gi√°o vi√™n t·∫°o: Ms Mai An ULIS</div>
            <h1>B√ÄI T·∫¨P GI·ªöI T·ª™ (PART 2)</h1>
            <div style="font-size: 0.9rem; color: #555; margin-top:5px;">Ch·ªß ƒë·ªÅ: C√¥ng ngh·ªá, S·ª± ki·ªán & C√°c v·ªã tr√≠ ƒë·∫∑c bi·ªát</div>
        </header>

        <div id="quiz-container">
            </div>

        <button id="submit-btn" onclick="submitQuiz()">N·ªòP B√ÄI üöÄ</button>
    </div>

    <div class="modal-overlay" id="result-modal">
        <div class="modal-content">
            <h2>K·∫æT QU·∫¢ C·ª¶A CON</h2>
            <div class="score-display" id="final-score">0/30</div>
            <p id="feedback-text" style="font-size: 1.2rem; color: #555;">...</p>
            <button class="option-btn" style="background: var(--primary-purple); color: white; border-color: #6c429c; margin-top: 20px; width: 100%; text-align: center;" onclick="location.reload()">L√†m l·∫°i b√†i</button>
        </div>
    </div>

    <canvas id="confetti-canvas"></canvas>

<script>
    // --- DATABASE: 30 NEW Questions (Different Contexts) ---
    const quizData = [
        // GROUP 1: MEDIA & TECHNOLOGY (C√¥ng ngh·ªá & Truy·ªÅn th√¥ng)
        {
            question: "I found this interesting article _____ the Internet.",
            options: [
                { text: "A. in", type: "prep", meaning: "trong" },
                { text: "B. at", type: "prep", meaning: "t·∫°i" },
                { text: "C. on", type: "prep", meaning: "tr√™n" },
                { text: "D. to", type: "prep", meaning: "t·ªõi" }
            ],
            correct: 2, // C
            explanation: `
                <div class="exp-step"><strong>1. D·ªãch c√¢u:</strong> T√¥i t√¨m th·∫•y b√†i b√°o th√∫ v·ªã n√†y tr√™n m·∫°ng Internet.</div>
                <div class="exp-step"><strong>2. Ph√¢n t√≠ch:</strong>
                    <br>A. in: trong.
                    <br>B. at: t·∫°i.
                    <br>C. on: tr√™n (b·ªÅ m·∫∑t/n·ªÅn t·∫£ng).
                    <br>D. to: t·ªõi.
                </div>
                <div class="exp-step"><strong>3. T·∫°i sao ƒê√öNG (C):</strong> V·ªõi Internet, Website, TV, Radio, M·∫°ng x√£ h·ªôi (Facebook, Youtube), ta lu√¥n d√πng gi·ªõi t·ª´ <strong>"on"</strong>. ƒê√¢y l√† n·ªÅn t·∫£ng k·ªπ thu·∫≠t s·ªë.</div>
                <div class="exp-step"><strong>4. T·∫°i sao SAI:</strong> "In the Internet" l√† l·ªói sai r·∫•t ph·ªï bi·∫øn c·ªßa ng∆∞·ªùi Vi·ªát (d·ªãch word-by-word 'trong m·∫°ng'), nh∆∞ng ti·∫øng Anh chu·∫©n ph·∫£i l√† "on".</div>
            `
        },
        {
            question: "Click on the icon _____ the top of the screen.",
            options: [
                { text: "A. on", type: "prep", meaning: "tr√™n" },
                { text: "B. at", type: "prep", meaning: "t·∫°i" },
                { text: "C. in", type: "prep", meaning: "trong" },
                { text: "D. above", type: "prep", meaning: "ph√≠a tr√™n" }
            ],
            correct: 1, // B
            explanation: `
                <div class="exp-step"><strong>1. D·ªãch c√¢u:</strong> H√£y nh·∫•p v√†o bi·ªÉu t∆∞·ª£ng ·ªü ph√≠a tr√™n c√πng c·ªßa m√†n h√¨nh.</div>
                <div class="exp-step"><strong>2. Ph√¢n t√≠ch:</strong> "The top" (ƒë·ªânh/ph·∫ßn tr√™n c√πng).</div>
                <div class="exp-step"><strong>3. T·∫°i sao ƒê√öNG (B):</strong> C·∫•u tr√∫c c·ªë ƒë·ªãnh: <strong>at the top of</strong> (·ªü tr√™n c√πng), <strong>at the bottom of</strong> (·ªü d∆∞·ªõi c√πng). N√≥ ch·ªâ m·ªôt ƒëi·ªÉm v·ªã tr√≠ c·ª• th·ªÉ.</div>
                <div class="exp-step"><strong>4. T·∫°i sao SAI:</strong> "On the top" th∆∞·ªùng d√πng cho nghƒ©a ƒëen l√† ƒë·∫∑t v·∫≠t g√¨ l√™n ƒë·ªânh v·∫≠t kh√°c (Put a star on the top of the tree). C√≤n v·ªã tr√≠ tr√™n trang gi·∫•y/m√†n h√¨nh d√πng "at".</div>
            `
        },
        {
            question: "There is too much sugar _____ the ingredients list.",
            options: [
                { text: "A. at", type: "prep", meaning: "t·∫°i" },
                { text: "B. on", type: "prep", meaning: "tr√™n" },
                { text: "C. in", type: "prep", meaning: "trong" },
                { text: "D. with", type: "prep", meaning: "v·ªõi" }
            ],
            correct: 2, // C (Wait, "in the list" or "on the list"? Usually "on the list".)
            // Correction: "Sugar in the ingredients" is correct, but "on the list". Context: "There is sugar ON the list".
            // Let's refine the question to be clear. "Is your name _____ the list?" -> ON.
            // Let's change question to: "Is your name _____ the list?" for clarity.
        },
        { // REPLACING QUESTION 3 for clarity
            question: "I checked the guest list but your name wasn't _____ it.",
            options: [
                { text: "A. in", type: "prep", meaning: "trong" },
                { text: "B. at", type: "prep", meaning: "t·∫°i" },
                { text: "C. on", type: "prep", meaning: "tr√™n" },
                { text: "D. to", type: "prep", meaning: "t·ªõi" }
            ],
            correct: 2, // C
            explanation: `
                <div class="exp-step"><strong>1. D·ªãch c√¢u:</strong> T√¥i ƒë√£ ki·ªÉm tra danh s√°ch kh√°ch m·ªùi nh∆∞ng t√™n b·∫°n kh√¥ng c√≥ trong (tr√™n) ƒë√≥.</div>
                <div class="exp-step"><strong>2. Ph√¢n t√≠ch:</strong> "The list" (danh s√°ch), "The menu" (th·ª±c ƒë∆°n).</div>
                <div class="exp-step"><strong>3. T·∫°i sao ƒê√öNG (C):</strong> Ta d√πng <strong>"on a list"</strong>, <strong>"on a menu"</strong>. H√£y t∆∞·ªüng t∆∞·ª£ng danh s√°ch l√† m·ªôt b·ªÅ m·∫∑t ch·ª©a c√°c d√≤ng ch·ªØ.</div>
                <div class="exp-step"><strong>4. T·∫°i sao SAI:</strong> Ng∆∞·ªùi Vi·ªát hay n√≥i "trong danh s√°ch" n√™n d·ªÖ ch·ªçn "in". ƒê√¢y l√† b·∫´y! Ti·∫øng Anh d√πng "on".</div>
            `
        },
        {
            question: "Look at the woman _____ the picture.",
            options: [
                { text: "A. on", type: "prep", meaning: "tr√™n" },
                { text: "B. at", type: "prep", meaning: "t·∫°i" },
                { text: "C. in", type: "prep", meaning: "trong" },
                { text: "D. with", type: "prep", meaning: "v·ªõi" }
            ],
            correct: 2, // C
            explanation: `
                <div class="exp-step"><strong>1. D·ªãch c√¢u:</strong> H√£y nh√¨n ng∆∞·ªùi ph·ª• n·ªØ trong b·ª©c tranh.</div>
                <div class="exp-step"><strong>2. Ph√¢n t√≠ch:</strong> Picture/Photo (Tranh/·∫¢nh) l√† m·ªôt kh√¥ng gian h√¨nh ·∫£nh 2D.</div>
                <div class="exp-step"><strong>3. T·∫°i sao ƒê√öNG (C):</strong> Quy t·∫Øc: <strong>In a picture/In a photo</strong>. Ng∆∞·ªùi/v·∫≠t n·∫±m b√™n trong khung c·∫£nh c·ªßa b·ª©c tranh.</div>
                <div class="exp-step"><strong>4. T·∫°i sao SAI:</strong> "On the picture" nghƒ©a l√† c√≥ v·∫øt b·∫©n ho·∫∑c v·∫≠t g√¨ ƒë√® l√™n b·ªÅ m·∫∑t t·ªù gi·∫•y tranh.</div>
            `
        },
        {
            question: "I saw my face _____ the mirror.",
            options: [
                { text: "A. on", type: "prep", meaning: "tr√™n" },
                { text: "B. in", type: "prep", meaning: "trong" },
                { text: "C. at", type: "prep", meaning: "t·∫°i" },
                { text: "D. opposite", type: "prep", meaning: "ƒë·ªëi di·ªán" }
            ],
            correct: 1, // B
            explanation: `
                <div class="exp-step"><strong>1. D·ªãch c√¢u:</strong> T√¥i nh√¨n th·∫•y khu√¥n m·∫∑t m√¨nh trong g∆∞∆°ng.</div>
                <div class="exp-step"><strong>2. Ph√¢n t√≠ch:</strong> Mirror (G∆∞∆°ng). H√¨nh ·∫£nh ph·∫£n chi·∫øu n·∫±m "s√¢u" b√™n trong m·∫∑t g∆∞∆°ng.</div>
                <div class="exp-step"><strong>3. T·∫°i sao ƒê√öNG (B):</strong> Quy t·∫Øc: <strong>In the mirror</strong>.</div>
                <div class="exp-step"><strong>4. T·∫°i sao SAI:</strong> "On the mirror" l√† khi c√≥ con ru·ªìi ƒë·∫≠u tr√™n m·∫∑t k√≠nh c·ªßa g∆∞∆°ng.</div>
            `
        },

        // GROUP 2: SPECIFIC POSITIONS (V·ªã tr√≠ c·ª• th·ªÉ)
        {
            question: "Please sign your name _____ the bottom of the page.",
            options: [
                { text: "A. in", type: "prep", meaning: "trong" },
                { text: "B. on", type: "prep", meaning: "tr√™n" },
                { text: "C. at", type: "prep", meaning: "t·∫°i" },
                { text: "D. under", type: "prep", meaning: "d∆∞·ªõi" }
            ],
            correct: 2, // C
            explanation: `
                <div class="exp-step"><strong>1. D·ªãch c√¢u:</strong> Vui l√≤ng k√Ω t√™n ·ªü cu·ªëi trang.</div>
                <div class="exp-step"><strong>2. Ph√¢n t√≠ch:</strong> "The bottom" (ph·∫ßn ƒë√°y/cu·ªëi).</div>
                <div class="exp-step"><strong>3. T·∫°i sao ƒê√öNG (C):</strong> C·∫•u tr√∫c: <strong>At the bottom of...</strong> (T·∫°i ƒëi·ªÉm cu·ªëi c√πng). T∆∞∆°ng t·ª± "At the top of".</div>
                <div class="exp-step"><strong>4. T·∫°i sao SAI:</strong> "On the bottom" th∆∞·ªùng d√πng cho ƒë√°y c·ªßa v·∫≠t th·ªÉ 3D (ƒë√°y chai, ƒë√°y n·ªìi). V·ªõi trang gi·∫•y d√πng "at".</div>
            `
        },
        {
            question: "Turn left _____ the traffic lights.",
            options: [
                { text: "A. in", type: "prep", meaning: "trong" },
                { text: "B. on", type: "prep", meaning: "tr√™n" },
                { text: "C. by", type: "prep", meaning: "b·ªüi" },
                { text: "D. at", type: "prep", meaning: "t·∫°i" }
            ],
            correct: 3, // D
            explanation: `
                <div class="exp-step"><strong>1. D·ªãch c√¢u:</strong> R·∫Ω tr√°i t·∫°i ƒë√®n giao th√¥ng.</div>
                <div class="exp-step"><strong>2. Ph√¢n t√≠ch:</strong> Traffic lights (ƒë√®n giao th√¥ng) l√† m·ªôt c·ªôt m·ªëc/ƒëi·ªÉm m·ªëc tr√™n ƒë∆∞·ªùng.</div>
                <div class="exp-step"><strong>3. T·∫°i sao ƒê√öNG (D):</strong> V·ªõi c√°c ƒëi·ªÉm m·ªëc tr√™n h√†nh tr√¨nh (traffic lights, roundabout, junction), ta d√πng <strong>"at"</strong>.</div>
                <div class="exp-step"><strong>4. T·∫°i sao SAI:</strong> Kh√¥ng ai n√≥i "on the traffic lights" (tr·ª´ khi con chim ƒë·∫≠u tr√™n ƒë√≥).</div>
            `
        },
        {
            question: "My shop is _____ the end of the street.",
            options: [
                { text: "A. in", type: "prep", meaning: "trong" },
                { text: "B. at", type: "prep", meaning: "t·∫°i" },
                { text: "C. on", type: "prep", meaning: "tr√™n" },
                { text: "D. to", type: "prep", meaning: "t·ªõi" }
            ],
            correct: 1, // B
            explanation: `
                <div class="exp-step"><strong>1. D·ªãch c√¢u:</strong> C·ª≠a h√†ng c·ªßa t√¥i ·ªü cu·ªëi ƒë∆∞·ªùng.</div>
                <div class="exp-step"><strong>2. Ph√¢n t√≠ch:</strong> "The end" (ƒëi·ªÉm k·∫øt th√∫c).</div>
                <div class="exp-step"><strong>3. T·∫°i sao ƒê√öNG (B):</strong> C·ª•m c·ªë ƒë·ªãnh: <strong>At the end of...</strong> (T·∫°i ƒëi·ªÉm cu·ªëi c·ªßa c√°i g√¨ ƒë√≥).</div>
                <div class="exp-step"><strong>4. T·∫°i sao SAI:</strong> "In the end" l√† c·ª•m t·ª´ ch·ªâ th·ªùi gian (Cu·ªëi c√πng th√¨...), kh√¥ng ch·ªâ v·ªã tr√≠.</div>
            `
        },
        {
            question: "The children are playing _____ the corner of the room.",
            options: [
                { text: "A. on", type: "prep", meaning: "tr√™n" },
                { text: "B. at", type: "prep", meaning: "t·∫°i" },
                { text: "C. in", type: "prep", meaning: "trong" },
                { text: "D. to", type: "prep", meaning: "t·ªõi" }
            ],
            correct: 2, // C
            explanation: `
                <div class="exp-step"><strong>1. D·ªãch c√¢u:</strong> L≈© tr·∫ª ƒëang ch∆°i ·ªü trong g√≥c ph√≤ng.</div>
                <div class="exp-step"><strong>2. Ph√¢n t√≠ch:</strong> G√≥c ph√≤ng (g√≥c trong - inside corner).</div>
                <div class="exp-step"><strong>3. T·∫°i sao ƒê√öNG (C):</strong> V·ªõi g√≥c nh√†, g√≥c ph√≤ng (kh√©p k√≠n), ta d√πng <strong>"in the corner"</strong>.</div>
                <div class="exp-step"><strong>4. T·∫°i sao SAI:</strong> N·∫øu l√† g√≥c ƒë∆∞·ªùng (b√™n ngo√†i), ta d√πng "at/on the corner of the street". Nh∆∞ng trong ph√≤ng ph·∫£i l√† "in".</div>
            `
        },
        {
            question: "Let's meet _____ the corner of Pho Hue Street.",
            options: [
                { text: "A. in", type: "prep", meaning: "trong" },
                { text: "B. at", type: "prep", meaning: "t·∫°i" },
                { text: "C. inside", type: "prep", meaning: "b√™n trong" },
                { text: "D. through", type: "prep", meaning: "xuy√™n qua" }
            ],
            correct: 1, // B
            explanation: `
                <div class="exp-step"><strong>1. D·ªãch c√¢u:</strong> H√£y g·∫∑p nhau ·ªü g√≥c ƒë∆∞·ªùng Ph·ªë Hu·∫ø nh√©.</div>
                <div class="exp-step"><strong>2. Ph√¢n t√≠ch:</strong> G√≥c ph·ªë (g√≥c ngo√†i - outside corner).</div>
                <div class="exp-step"><strong>3. T·∫°i sao ƒê√öNG (B):</strong> V·ªõi g√≥c ph·ªë/ng√£ r·∫Ω ngo√†i ƒë∆∞·ªùng, ta d√πng <strong>"at the corner"</strong> (ho·∫∑c "on the corner" trong Anh-M·ªπ). "At" ph·ªï bi·∫øn h∆°n khi coi n√≥ l√† ƒëi·ªÉm h·∫πn.</div>
                <div class="exp-step"><strong>4. T·∫°i sao SAI:</strong> "In the corner" d√πng cho g√≥c ph√≤ng (xem c√¢u tr√™n).</div>
            `
        },

        // GROUP 3: EVENTS & SOCIAL (S·ª± ki·ªán x√£ h·ªôi)
        {
            question: "I met my old teacher _____ a wedding last week.",
            options: [
                { text: "A. in", type: "prep", meaning: "trong" },
                { text: "B. on", type: "prep", meaning: "tr√™n" },
                { text: "C. at", type: "prep", meaning: "t·∫°i" },
                { text: "D. to", type: "prep", meaning: "t·ªõi" }
            ],
            correct: 2, // C
            explanation: `
                <div class="exp-step"><strong>1. D·ªãch c√¢u:</strong> T√¥i g·∫∑p gi√°o vi√™n c≈© t·∫°i m·ªôt ƒë√°m c∆∞·ªõi tu·∫ßn tr∆∞·ªõc.</div>
                <div class="exp-step"><strong>2. Ph√¢n t√≠ch:</strong> Wedding (ƒë√°m c∆∞·ªõi) l√† m·ªôt s·ª± ki·ªán.</div>
                <div class="exp-step"><strong>3. T·∫°i sao ƒê√öNG (C):</strong> Lu√¥n d√πng <strong>"at"</strong> cho c√°c s·ª± ki·ªán: at a wedding, at a concert, at a meeting, at a party.</div>
                <div class="exp-step"><strong>4. T·∫°i sao SAI:</strong> Kh√¥ng d√πng "in a wedding" (tr·ª´ khi n√≥i v·ªÅ vi·ªác tham gia v√†o nghi l·ªÖ).</div>
            `
        },
        {
            question: "Were there many people _____ the concert?",
            options: [
                { text: "A. on", type: "prep", meaning: "tr√™n" },
                { text: "B. in", type: "prep", meaning: "trong" },
                { text: "C. at", type: "prep", meaning: "t·∫°i" },
                { text: "D. from", type: "prep", meaning: "t·ª´" }
            ],
            correct: 2, // C
            explanation: `
                <div class="exp-step"><strong>1. D·ªãch c√¢u:</strong> C√≥ nhi·ªÅu ng∆∞·ªùi ·ªü bu·ªïi h√≤a nh·∫°c kh√¥ng?</div>
                <div class="exp-step"><strong>2. Ph√¢n t√≠ch:</strong> Concert (bu·ªïi h√≤a nh·∫°c) l√† s·ª± ki·ªán.</div>
                <div class="exp-step"><strong>3. T·∫°i sao ƒê√öNG (C):</strong> Ti·∫øp t·ª•c quy t·∫Øc s·ª± ki·ªán -> <strong>At the concert</strong>.</div>
                <div class="exp-step"><strong>4. T·∫°i sao SAI:</strong> "In the concert" √≠t d√πng, th∆∞·ªùng d√πng "at" ƒë·ªÉ ch·ªâ s·ª± hi·ªán di·ªán t·∫°i ƒë·ªãa ƒëi·ªÉm t·ªï ch·ª©c s·ª± ki·ªán ƒë√≥.</div>
            `
        },
        {
            question: "We waited for hours _____ a queue.",
            options: [
                { text: "A. at", type: "prep", meaning: "t·∫°i" },
                { text: "B. in", type: "prep", meaning: "trong" },
                { text: "C. on", type: "prep", meaning: "tr√™n" },
                { text: "D. with", type: "prep", meaning: "v·ªõi" }
            ],
            correct: 1, // B
            explanation: `
                <div class="exp-step"><strong>1. D·ªãch c√¢u:</strong> Ch√∫ng t√¥i ƒë√£ ƒë·ª£i h√†ng gi·ªù trong h√†ng (x·∫øp h√†ng).</div>
                <div class="exp-step"><strong>2. Ph√¢n t√≠ch:</strong> Queue (h√†ng ng∆∞·ªùi/xe). B·∫°n ƒë·ª©ng "trong" m·ªôt d√≤ng ng∆∞·ªùi.</div>
                <div class="exp-step"><strong>3. T·∫°i sao ƒê√öNG (B):</strong> C·ª•m c·ªë ƒë·ªãnh: <strong>In a queue</strong> (x·∫øp h√†ng), <strong>In a line</strong>.</div>
                <div class="exp-step"><strong>4. T·∫°i sao SAI:</strong> "On a queue" l√† sai gi·ªõi t·ª´.</div>
            `
        },
        {
            question: "They sat _____ the front row.",
            options: [
                { text: "A. at", type: "prep", meaning: "t·∫°i" },
                { text: "B. on", type: "prep", meaning: "tr√™n" },
                { text: "C. in", type: "prep", meaning: "trong" },
                { text: "D. to", type: "prep", meaning: "t·ªõi" }
            ],
            correct: 2, // C
            explanation: `
                <div class="exp-step"><strong>1. D·ªãch c√¢u:</strong> H·ªç ng·ªìi ·ªü h√†ng gh·∫ø ƒë·∫ßu.</div>
                <div class="exp-step"><strong>2. Ph√¢n t√≠ch:</strong> Row (h√†ng gh·∫ø).</div>
                <div class="exp-step"><strong>3. T·∫°i sao ƒê√öNG (C):</strong> C·ª•m c·ªë ƒë·ªãnh: <strong>In the front row / In the back row</strong>.</div>
                <div class="exp-step"><strong>4. T·∫°i sao SAI:</strong> D√π gh·∫ø c√≥ b·ªÅ m·∫∑t, nh∆∞ng "row" l√† m·ªôt d√£y s·∫Øp x·∫øp, ta coi l√† ng·ªìi "trong" d√£y ƒë√≥.</div>
            `
        },

        // GROUP 4: NATURE & GEOGRAPHY (Thi√™n nhi√™n & ƒê·ªãa l√Ω)
        {
            question: "Look at the beautiful stars _____ the sky.",
            options: [
                { text: "A. on", type: "prep", meaning: "tr√™n" },
                { text: "B. at", type: "prep", meaning: "t·∫°i" },
                { text: "C. in", type: "prep", meaning: "trong" },
                { text: "D. over", type: "prep", meaning: "b√™n tr√™n" }
            ],
            correct: 2, // C
            explanation: `
                <div class="exp-step"><strong>1. D·ªãch c√¢u:</strong> H√£y nh√¨n nh·ªØng ng√¥i sao tuy·ªát ƒë·∫πp tr√™n b·∫ßu tr·ªùi.</div>
                <div class="exp-step"><strong>2. Ph√¢n t√≠ch:</strong> Sky (b·∫ßu tr·ªùi) l√† kh√¥ng gian 3 chi·ªÅu bao tr√πm.</div>
                <div class="exp-step"><strong>3. T·∫°i sao ƒê√öNG (C):</strong> Trong ti·∫øng Anh, b·∫ßu tr·ªùi l√† kh√¥ng gian, n√™n d√πng <strong>"in the sky"</strong>.</div>
                <div class="exp-step"><strong>4. T·∫°i sao SAI:</strong> Ti·∫øng Vi·ªát n√≥i "tr√™n tr·ªùi" n√™n h·ªçc sinh hay ch·ªçn "on". ƒê√¢y l√† l·ªói sai ƒëi·ªÉn h√¨nh. Nh·ªõ nh√©: In the sky!</div>
            `
        },
        {
            question: "London is located _____ the River Thames.",
            options: [
                { text: "A. in", type: "prep", meaning: "trong" },
                { text: "B. on", type: "prep", meaning: "tr√™n" },
                { text: "C. at", type: "prep", meaning: "t·∫°i" },
                { text: "D. inside", type: "prep", meaning: "b√™n trong" }
            ],
            correct: 1, // B
            explanation: `
                <div class="exp-step"><strong>1. D·ªãch c√¢u:</strong> London n·∫±m tr√™n (b·ªù) s√¥ng Thames.</div>
                <div class="exp-step"><strong>2. Ph√¢n t√≠ch:</strong> Khi n√≥i th√†nh ph·ªë n·∫±m c·∫°nh s√¥ng/bi·ªÉn/b·ªù bi·ªÉn.</div>
                <div class="exp-step"><strong>3. T·∫°i sao ƒê√öNG (B):</strong> D√πng <strong>"on the river"</strong>, <strong>"on the coast"</strong> ƒë·ªÉ ch·ªâ v·ªã tr√≠ n·∫±m d·ªçc theo/b√™n c·∫°nh.</div>
                <div class="exp-step"><strong>4. T·∫°i sao SAI:</strong> "In the river" nghƒ©a l√† ƒëang b∆°i d∆∞·ªõi n∆∞·ªõc (ch√¨m trong n∆∞·ªõc).</div>
            `
        },
        {
            question: "They live _____ a farm in the countryside.",
            options: [
                { text: "A. in", type: "prep", meaning: "trong" },
                { text: "B. at", type: "prep", meaning: "t·∫°i" },
                { text: "C. on", type: "prep", meaning: "tr√™n" },
                { text: "D. with", type: "prep", meaning: "v·ªõi" }
            ],
            correct: 2, // C
            explanation: `
                <div class="exp-step"><strong>1. D·ªãch c√¢u:</strong> H·ªç s·ªëng trong m·ªôt trang tr·∫°i ·ªü n√¥ng th√¥n.</div>
                <div class="exp-step"><strong>2. Ph√¢n t√≠ch:</strong> Farm (N√¥ng tr·∫°i).</div>
                <div class="exp-step"><strong>3. T·∫°i sao ƒê√öNG (C):</strong> ƒê√¢y l√† ngo·∫°i l·ªá th√∫ v·ªã. Ta d√πng <strong>"on a farm"</strong> (v√¨ trang tr·∫°i l√† m·ªôt v√πng ƒë·∫•t b·ªÅ m·∫∑t r·ªông ƒë·ªÉ canh t√°c).</div>
                <div class="exp-step"><strong>4. T·∫°i sao SAI:</strong> Ta n√≥i "in a factory", "in an office", nh∆∞ng l·∫°i n√≥i "on a farm".</div>
            `
        },
        {
            question: "Mount Everest is the highest mountain _____ the world.",
            options: [
                { text: "A. of", type: "prep", meaning: "c·ªßa" },
                { text: "B. on", type: "prep", meaning: "tr√™n" },
                { text: "C. at", type: "prep", meaning: "t·∫°i" },
                { text: "D. in", type: "prep", meaning: "trong" }
            ],
            correct: 3, // D
            explanation: `
                <div class="exp-step"><strong>1. D·ªãch c√¢u:</strong> ƒê·ªânh Everest l√† ng·ªçn n√∫i cao nh·∫•t th·∫ø gi·ªõi.</div>
                <div class="exp-step"><strong>2. Ph√¢n t√≠ch:</strong> The world (Th·∫ø gi·ªõi).</div>
                <div class="exp-step"><strong>3. T·∫°i sao ƒê√öNG (D):</strong> C·ª•m c·ªë ƒë·ªãnh: <strong>In the world</strong>.</div>
                <div class="exp-step"><strong>4. T·∫°i sao SAI:</strong> "On the world" l√† sai (tr·ª´ khi n√≥i "on Earth" - tr√™n Tr√°i ƒê·∫•t).</div>
            `
        },
        {
            question: "Oh no! There is a fly _____ my soup.",
            options: [
                { text: "A. on", type: "prep", meaning: "tr√™n" },
                { text: "B. in", type: "prep", meaning: "trong" },
                { text: "C. at", type: "prep", meaning: "t·∫°i" },
                { text: "D. above", type: "prep", meaning: "ph√≠a tr√™n" }
            ],
            correct: 1, // B
            explanation: `
                <div class="exp-step"><strong>1. D·ªãch c√¢u:</strong> √îi kh√¥ng! C√≥ m·ªôt con ru·ªìi trong b√°t s√∫p c·ªßa t√¥i.</div>
                <div class="exp-step"><strong>2. Ph√¢n t√≠ch:</strong> Soup (ch·∫•t l·ªèng). Con ru·ªìi b·ªã ch√¨m ho·∫∑c n·∫±m trong dung d·ªãch ƒë√≥.</div>
                <div class="exp-step"><strong>3. T·∫°i sao ƒê√öNG (B):</strong> V·ªõi ch·∫•t l·ªèng/ƒë·ªì ƒÉn trong b√°t, ta d√πng <strong>"in"</strong>.</div>
                <div class="exp-step"><strong>4. T·∫°i sao SAI:</strong> "On" ch·ªâ ƒë√∫ng n·∫øu con ru·ªìi ƒë·∫≠u tr√™n v√†nh b√°t, c√≤n ƒë√£ v√†o s√∫p th√¨ l√† "in".</div>
            `
        },

        // GROUP 5: ARRIVE & TRAVEL (N√¢ng cao)
        {
            question: "The delegation arrived _____ the Embassy at 9 a.m.",
            options: [
                { text: "A. in", type: "prep", meaning: "trong" },
                { text: "B. to", type: "prep", meaning: "t·ªõi" },
                { text: "C. at", type: "prep", meaning: "t·∫°i" },
                { text: "D. on", type: "prep", meaning: "tr√™n" }
            ],
            correct: 2, // C
            explanation: `
                <div class="exp-step"><strong>1. D·ªãch c√¢u:</strong> Ph√°i ƒëo√†n ƒë√£ ƒë·∫øn ƒê·∫°i s·ª© qu√°n l√∫c 9 gi·ªù s√°ng.</div>
                <div class="exp-step"><strong>2. Ph√¢n t√≠ch:</strong> The Embassy (ƒê·∫°i s·ª© qu√°n) l√† m·ªôt t√≤a nh√†/ƒë·ªãa ƒëi·ªÉm c·ª• th·ªÉ.</div>
                <div class="exp-step"><strong>3. T·∫°i sao ƒê√öNG (C):</strong> ƒê·ªãa ƒëi·ªÉm t√≤a nh√† -> D√πng <strong>"Arrive at"</strong>.</div>
                <div class="exp-step"><strong>4. T·∫°i sao SAI:</strong> "Arrive in" d√πng cho th√†nh ph·ªë/qu·ªëc gia.</div>
            `
        },
        {
            question: "When do you expect to arrive _____ Singapore?",
            options: [
                { text: "A. at", type: "prep", meaning: "t·∫°i" },
                { text: "B. on", type: "prep", meaning: "tr√™n" },
                { text: "C. in", type: "prep", meaning: "trong" },
                { text: "D. to", type: "prep", meaning: "t·ªõi" }
            ],
            correct: 2, // C
            explanation: `
                <div class="exp-step"><strong>1. D·ªãch c√¢u:</strong> B·∫°n d·ª± ki·∫øn khi n√†o s·∫Ω t·ªõi Singapore?</div>
                <div class="exp-step"><strong>2. Ph√¢n t√≠ch:</strong> Singapore l√† m·ªôt qu·ªëc gia (ƒë·∫£o qu·ªëc).</div>
                <div class="exp-step"><strong>3. T·∫°i sao ƒê√öNG (C):</strong> Qu·ªëc gia -> D√πng <strong>"Arrive in"</strong>.</div>
                <div class="exp-step"><strong>4. T·∫°i sao SAI:</strong> Kh√¥ng d√πng "Arrive to".</div>
            `
        },
        {
            question: "He arrived _____ the airport just in time.",
            options: [
                { text: "A. in", type: "prep", meaning: "trong" },
                { text: "B. at", type: "prep", meaning: "t·∫°i" },
                { text: "C. on", type: "prep", meaning: "tr√™n" },
                { text: "D. for", type: "prep", meaning: "cho" }
            ],
            correct: 1, // B
            explanation: `
                <div class="exp-step"><strong>1. D·ªãch c√¢u:</strong> Anh ·∫•y ƒë·∫øn s√¢n bay v·ª´a k·ªãp gi·ªù.</div>
                <div class="exp-step"><strong>2. Ph√¢n t√≠ch:</strong> Airport (s√¢n bay) l√† ƒë·ªãa ƒëi·ªÉm trung chuy·ªÉn (point).</div>
                <div class="exp-step"><strong>3. T·∫°i sao ƒê√öNG (B):</strong> Quy t·∫Øc kinh ƒëi·ªÉn: <strong>Arrive at the airport</strong>.</div>
                <div class="exp-step"><strong>4. T·∫°i sao SAI:</strong> R·∫•t hi·∫øm khi d√πng "arrive in the airport" tr·ª´ ng·ªØ c·∫£nh ƒë·∫∑c bi·ªát nh·∫•n m·∫°nh b√™n trong nh√† ga.</div>
            `
        },
        {
            question: "Welcome _____ Vietnam!",
            options: [
                { text: "A. in", type: "prep", meaning: "trong" },
                { text: "B. at", type: "prep", meaning: "t·∫°i" },
                { text: "C. to", type: "prep", meaning: "t·ªõi" },
                { text: "D. on", type: "prep", meaning: "tr√™n" }
            ],
            correct: 2, // C
            explanation: `
                <div class="exp-step"><strong>1. D·ªãch c√¢u:</strong> Ch√†o m·ª´ng ƒë·∫øn v·ªõi Vi·ªát Nam!</div>
                <div class="exp-step"><strong>2. Ph√¢n t√≠ch:</strong> C·∫•u tr√∫c Welcome.</div>
                <div class="exp-step"><strong>3. T·∫°i sao ƒê√öNG (C):</strong> Kh√°c v·ªõi Arrive (kh√¥ng d√πng to), Welcome lu√¥n ƒëi v·ªõi <strong>"to"</strong>. (Welcome to my house, Welcome to the show).</div>
                <div class="exp-step"><strong>4. T·∫°i sao SAI:</strong> ƒê·ª´ng nh·∫ßm l·∫´n v·ªõi quy t·∫Øc c·ªßa "Arrive in".</div>
            `
        },

        // GROUP 6: DAILY OBJECTS & CLOTHING (ƒê·ªì v·∫≠t & Trang ph·ª•c)
        {
            question: "She always carries a photo _____ her wallet.",
            options: [
                { text: "A. on", type: "prep", meaning: "tr√™n" },
                { text: "B. at", type: "prep", meaning: "t·∫°i" },
                { text: "C. in", type: "prep", meaning: "trong" },
                { text: "D. with", type: "prep", meaning: "v·ªõi" }
            ],
            correct: 2, // C
            explanation: `
                <div class="exp-step"><strong>1. D·ªãch c√¢u:</strong> C√¥ ·∫•y lu√¥n mang theo m·ªôt t·∫•m ·∫£nh trong v√≠.</div>
                <div class="exp-step"><strong>2. Ph√¢n t√≠ch:</strong> Wallet (v√≠ ti·ªÅn) l√† v·∫≠t ch·ª©a (container).</div>
                <div class="exp-step"><strong>3. T·∫°i sao ƒê√öNG (C):</strong> D√πng <strong>"in"</strong> cho v√≠, t√∫i (pocket), t√∫i x√°ch (bag).</div>
                <div class="exp-step"><strong>4. T·∫°i sao SAI:</strong> "On her wallet" l√† ƒë·ªÉ l√™n m·∫∑t ngo√†i c·ªßa c√°i v√≠.</div>
            `
        },
        {
            question: "She wears a beautiful diamond ring _____ her finger.",
            options: [
                { text: "A. in", type: "prep", meaning: "trong" },
                { text: "B. at", type: "prep", meaning: "t·∫°i" },
                { text: "C. on", type: "prep", meaning: "tr√™n" },
                { text: "D. round", type: "prep", meaning: "quanh" }
            ],
            correct: 2, // C
            explanation: `
                <div class="exp-step"><strong>1. D·ªãch c√¢u:</strong> C√¥ ·∫•y ƒëeo m·ªôt chi·∫øc nh·∫´n kim c∆∞∆°ng tuy·ªát ƒë·∫πp tr√™n ng√≥n tay.</div>
                <div class="exp-step"><strong>2. Ph√¢n t√≠ch:</strong> Finger (ng√≥n tay). Nh·∫´n bao quanh ng√≥n tay nh∆∞ng ƒë∆∞·ª£c coi l√† "tr√™n" b·ªÅ m·∫∑t da.</div>
                <div class="exp-step"><strong>3. T·∫°i sao ƒê√öNG (C):</strong> V·ªõi ƒë·ªì trang s·ª©c ƒëeo tr√™n c∆° th·ªÉ (tr·ª´ khuy√™n), ta d√πng <strong>"on"</strong> (ring on finger, bracelet on wrist).</div>
                <div class="exp-step"><strong>4. T·∫°i sao SAI:</strong> "In her finger" nghe r·∫•t ƒëau ƒë·ªõn (trong x∆∞∆°ng/th·ªãt)!</div>
            `
        },
        {
            question: "There is a 'No Smoking' sign _____ the door.",
            options: [
                { text: "A. in", type: "prep", meaning: "trong" },
                { text: "B. at", type: "prep", meaning: "t·∫°i" },
                { text: "C. on", type: "prep", meaning: "tr√™n" },
                { text: "D. through", type: "prep", meaning: "xuy√™n qua" }
            ],
            correct: 2, // C
            explanation: `
                <div class="exp-step"><strong>1. D·ªãch c√¢u:</strong> C√≥ m·ªôt bi·ªÉn b√°o 'C·∫•m h√∫t thu·ªëc' ·ªü tr√™n c·ª≠a.</div>
                <div class="exp-step"><strong>2. Ph√¢n t√≠ch:</strong> The door (c√°nh c·ª≠a) ·ªü ƒë√¢y l√† b·ªÅ m·∫∑t ƒë·ªÉ d√°n th√¥ng b√°o.</div>
                <div class="exp-step"><strong>3. T·∫°i sao ƒê√öNG (C):</strong> Khi d√°n/treo v·∫≠t g√¨ l√™n b·ªÅ m·∫∑t c·ª≠a, d√πng <strong>"on the door"</strong>.</div>
                <div class="exp-step"><strong>4. T·∫°i sao SAI:</strong> C√¢u n√†y kh√°c v·ªõi "standing at the door" (ƒë·ª©ng c·∫°nh c·ª≠a). ·ªû ƒë√¢y bi·ªÉn b√°o ti·∫øp x√∫c tr·ª±c ti·∫øp v·ªõi m·∫∑t c·ª≠a.</div>
            `
        },
        {
            question: "I like reading books _____ bed before sleeping.",
            options: [
                { text: "A. on", type: "prep", meaning: "tr√™n" },
                { text: "B. in", type: "prep", meaning: "trong" },
                { text: "C. at", type: "prep", meaning: "t·∫°i" },
                { text: "D. to", type: "prep", meaning: "t·ªõi" }
            ],
            correct: 1, // B
            explanation: `
                <div class="exp-step"><strong>1. D·ªãch c√¢u:</strong> T√¥i th√≠ch ƒë·ªçc s√°ch tr√™n gi∆∞·ªùng tr∆∞·ªõc khi ng·ªß.</div>
                <div class="exp-step"><strong>2. Ph√¢n t√≠ch:</strong> Bed (gi∆∞·ªùng). Khi b·∫°n n·∫±m ƒë·∫Øp chƒÉn, b·∫°n n·∫±m "trong" s·ª± √™m √°i ƒë√≥.</div>
                <div class="exp-step"><strong>3. T·∫°i sao ƒê√öNG (B):</strong> C·ª•m ph·ªï bi·∫øn nh·∫•t l√† <strong>"in bed"</strong> (ƒëang n·∫±m ngh·ªâ ng∆°i/ng·ªß).</div>
                <div class="exp-step"><strong>4. T·∫°i sao SAI:</strong> "On the bed" c≈©ng ƒë√∫ng ng·ªØ ph√°p nh∆∞ng th∆∞·ªùng ch·ªâ vi·ªác ng·ªìi l√™n ho·∫∑c ƒë·∫∑t ƒë·ªì v·∫≠t l√™n m·∫∑t gi∆∞·ªùng (ch∆∞a ƒë·∫Øp chƒÉn). Nh∆∞ng "in bed" t·ª± nhi√™n h∆°n cho ng·ªØ c·∫£nh ƒëi ng·ªß.</div>
            `
        },
        {
            question: "Is Mr. Smith _____ the office right now?",
            options: [
                { text: "A. on", type: "prep", meaning: "tr√™n" },
                { text: "B. at", type: "prep", meaning: "t·∫°i" },
                { text: "C. in", type: "prep", meaning: "trong" },
                { text: "D. to", type: "prep", meaning: "t·ªõi" }
            ],
            correct: 2, // C
            explanation: `
                <div class="exp-step"><strong>1. D·ªãch c√¢u:</strong> √îng Smith c√≥ ·ªü trong vƒÉn ph√≤ng ngay l√∫c n√†y kh√¥ng?</div>
                <div class="exp-step"><strong>2. Ph√¢n t√≠ch:</strong> Office (ph√≤ng l√†m vi·ªác).</div>
                <div class="exp-step"><strong>3. T·∫°i sao ƒê√öNG (C):</strong> Khi mu·ªën h·ªèi ai ƒë√≥ c√≥ m·∫∑t b√™n trong ph√≤ng kh√¥ng, d√πng <strong>"in the office"</strong>.</div>
                <div class="exp-step"><strong>4. T·∫°i sao SAI:</strong> "At the office" (·ªü ch·ªó l√†m n√≥i chung - c√≥ th·ªÉ ƒëang ·ªü canteen c·ªßa c√¥ng ty). Nh∆∞ng "in" nh·∫•n m·∫°nh v·ªã tr√≠ c·ª• th·ªÉ trong ph√≤ng. C·∫£ 2 ƒë·ªÅu d√πng ƒë∆∞·ª£c nh∆∞ng "in" s√°t nghƒ©a "inside" h∆°n.</div>
            `
        },
        {
            question: "The answers are _____ the back of the book.",
            options: [
                { text: "A. in", type: "prep", meaning: "trong" },
                { text: "B. on", type: "prep", meaning: "tr√™n" },
                { text: "C. at", type: "prep", meaning: "t·∫°i" },
                { text: "D. to", type: "prep", meaning: "t·ªõi" }
            ],
            correct: 2, // C
            explanation: `
                <div class="exp-step"><strong>1. D·ªãch c√¢u:</strong> C√°c ƒë√°p √°n n·∫±m ·ªü ph√≠a sau cu·ªën s√°ch.</div>
                <div class="exp-step"><strong>2. Ph√¢n t√≠ch:</strong> The back/The front (M·∫∑t sau/M·∫∑t tr∆∞·ªõc ho·∫∑c Ph·∫ßn cu·ªëi/Ph·∫ßn ƒë·∫ßu).</div>
                <div class="exp-step"><strong>3. T·∫°i sao ƒê√öNG (C):</strong> C·∫•u tr√∫c: <strong>At the back of... / At the front of...</strong></div>
                <div class="exp-step"><strong>4. T·∫°i sao SAI:</strong> "In the back" th∆∞·ªùng d√πng cho xe h∆°i (ng·ªìi gh·∫ø sau). V·ªõi s√°ch v·ªü, d√πng "at".</div>
            `
        },
        {
            question: "Don't sit _____ the grass. It's wet.",
            options: [
                { text: "A. in", type: "prep", meaning: "trong" },
                { text: "B. at", type: "prep", meaning: "t·∫°i" },
                { text: "C. on", type: "prep", meaning: "tr√™n" },
                { text: "D. above", type: "prep", meaning: "ph√≠a tr√™n" }
            ],
            correct: 2, // C
            explanation: `
                <div class="exp-step"><strong>1. D·ªãch c√¢u:</strong> ƒê·ª´ng ng·ªìi tr√™n c·ªè. N√≥ ∆∞·ªõt ƒë·∫•y.</div>
                <div class="exp-step"><strong>2. Ph√¢n t√≠ch:</strong> Grass (b√£i c·ªè) l√† b·ªÅ m·∫∑t.</div>
                <div class="exp-step"><strong>3. T·∫°i sao ƒê√öNG (C):</strong> Ng·ªìi tr√™n b·ªÅ m·∫∑t -> D√πng <strong>"on"</strong>.</div>
                <div class="exp-step"><strong>4. T·∫°i sao SAI:</strong> "In the grass" th∆∞·ªùng d√πng cho c√¥n tr√πng ho·∫∑c v·∫≠t nh·ªè l·∫©n khu·∫•t trong b·ª•i c·ªè cao. Ng∆∞·ªùi ng·ªìi th√¨ d√πng "on".</div>
            `
        }
    ];

    // --- GAME LOGIC (Keep exactly the same) ---

    let currentScore = 0;
    const totalQuestions = quizData.length;
    let answeredCount = 0;

    function shuffleArray(array) {
        for (let i = array.length - 1; i > 0; i--) {
            const j = Math.floor(Math.random() * (i + 1));
            [array[i], array[j]] = [array[j], array[i]];
        }
    }

    const audioCtx = new (window.AudioContext || window.webkitAudioContext)();

    function playSound(type) {
        if (audioCtx.state === 'suspended') audioCtx.resume();
        const oscillator = audioCtx.createOscillator();
        const gainNode = audioCtx.createGain();
        oscillator.connect(gainNode);
        gainNode.connect(audioCtx.destination);

        if (type === 'correct') {
            oscillator.type = 'sine';
            oscillator.frequency.setValueAtTime(800, audioCtx.currentTime);
            oscillator.frequency.exponentialRampToValueAtTime(1200, audioCtx.currentTime + 0.1);
            gainNode.gain.setValueAtTime(0.5, audioCtx.currentTime);
            gainNode.gain.exponentialRampToValueAtTime(0.01, audioCtx.currentTime + 0.5);
            oscillator.start();
            oscillator.stop(audioCtx.currentTime + 0.5);
        } else {
            oscillator.type = 'sawtooth';
            oscillator.frequency.setValueAtTime(150, audioCtx.currentTime);
            oscillator.frequency.linearRampToValueAtTime(100, audioCtx.currentTime + 0.3);
            gainNode.gain.setValueAtTime(0.5, audioCtx.currentTime);
            gainNode.gain.linearRampToValueAtTime(0.01, audioCtx.currentTime + 0.3);
            oscillator.start();
            oscillator.stop(audioCtx.currentTime + 0.3);
        }
    }

    function renderQuiz() {
        const container = document.getElementById('quiz-container');
        shuffleArray(quizData);

        quizData.forEach((item, index) => {
            const card = document.createElement('div');
            card.className = 'question-card';
            card.id = `q-${index}`;

            let optionIndices = [0, 1, 2, 3];
            shuffleArray(optionIndices);
            let mappedCorrectIndex = optionIndices.indexOf(item.correct);
            
            let optionsHtml = '';
            optionIndices.forEach((originalIndex, displayIndex) => {
                const opt = item.options[originalIndex];
                optionsHtml += `
                    <button class="option-btn" onclick="checkAnswer(${index}, ${displayIndex}, ${mappedCorrectIndex}, this)">
                        ${opt.text} <br> <span style="font-size:0.8rem; color:#666; font-weight:normal;">(${opt.type} - ${opt.meaning})</span>
                    </button>
                `;
            });

            card.innerHTML = `
                <div class="question-number">C√¢u ${index + 1}</div>
                <div class="question-text">${item.question}</div>
                <div class="options-grid">
                    ${optionsHtml}
                </div>
                <div class="explanation-box" id="exp-${index}">
                    <div class="exp-header">
                        <span>üí° GI·∫¢I TH√çCH CHI TI·∫æT (C√¥ Mai An)</span>
                    </div>
                    <div class="exp-content">
                        ${item.explanation}
                    </div>
                </div>
            `;
            container.appendChild(card);
        });
    }

    window.checkAnswer = function(qIndex, selectedIndex, correctIndex, btnElement) {
        const card = document.getElementById(`q-${qIndex}`);
        const buttons = card.querySelectorAll('.option-btn');
        if (card.getAttribute('data-answered') === 'true') return;

        card.setAttribute('data-answered', 'true');
        answeredCount++;

        document.getElementById(`exp-${qIndex}`).classList.add('visible');

        if (selectedIndex === correctIndex) {
            btnElement.classList.add('correct');
            currentScore++;
            playSound('correct');
            triggerConfetti(btnElement);
        } else {
            btnElement.classList.add('wrong');
            buttons[correctIndex].classList.add('correct');
            playSound('wrong');
        }
        buttons.forEach(btn => btn.disabled = true);
    };

    window.submitQuiz = function() {
        const modal = document.getElementById('result-modal');
        const scoreText = document.getElementById('final-score');
        const feedback = document.getElementById('feedback-text');

        modal.style.display = 'flex';
        scoreText.innerText = `${currentScore}/${totalQuestions}`;

        if (currentScore === totalQuestions) {
            feedback.innerText = "üåü Xu·∫•t s·∫Øc! Con ƒë√£ l√†m ch·ªß m·ªçi ng·ªØ c·∫£nh kh√≥ nh·∫•t!";
            startConfettiLoop();
        } else if (currentScore >= totalQuestions * 0.8) {
            feedback.innerText = "üëè R·∫•t t·ªët! Ch·ªâ m·ªôt v√†i l·ªói nh·ªè x√≠u th√¥i.";
        } else if (currentScore >= totalQuestions * 0.5) {
            feedback.innerText = "üí™ T·∫°m ·ªïn, nh∆∞ng c·∫ßn ch√∫ √Ω k·ªπ h∆°n c√°c tr∆∞·ªùng h·ª£p ngo·∫°i l·ªá nh√©.";
        } else {
            feedback.innerText = "üìö Con h√£y xem l·∫°i ph·∫ßn gi·∫£i th√≠ch th·∫≠t k·ªπ nh√©!";
        }
    };

    const canvas = document.getElementById('confetti-canvas');
    const ctx = canvas.getContext('2d');
    canvas.width = window.innerWidth;
    canvas.height = window.innerHeight;

    let particles = [];
    const colors = ['#8854C0', '#00C9A7', '#FF4757', '#FFD700', '#00D26A'];

    function triggerConfetti(element) {
        const rect = element.getBoundingClientRect();
        const x = rect.left + rect.width / 2;
        const y = rect.top + rect.height / 2;

        for (let i = 0; i < 30; i++) {
            particles.push({
                x: x, y: y,
                vx: (Math.random() - 0.5) * 10,
                vy: (Math.random() - 0.5) * 10 - 5,
                color: colors[Math.floor(Math.random() * colors.length)],
                size: Math.random() * 8 + 4,
                life: 100
            });
        }
        requestAnimationFrame(updateConfetti);
    }

    function startConfettiLoop() {
        setInterval(() => {
            const x = Math.random() * canvas.width;
            const y = -10;
            for (let i = 0; i < 10; i++) {
                particles.push({
                    x: x, y: y,
                    vx: (Math.random() - 0.5) * 5,
                    vy: Math.random() * 5 + 2,
                    color: colors[Math.floor(Math.random() * colors.length)],
                    size: Math.random() * 8 + 4,
                    life: 200
                });
            }
        }, 100);
        updateConfetti();
    }

    function updateConfetti() {
        ctx.clearRect(0, 0, canvas.width, canvas.height);
        for (let i = 0; i < particles.length; i++) {
            let p = particles[i];
            p.x += p.vx; p.y += p.vy; p.vy += 0.2; p.life--; p.size *= 0.98;
            ctx.fillStyle = p.color;
            ctx.fillRect(p.x, p.y, p.size, p.size);
            if (p.life <= 0) { particles.splice(i, 1); i--; }
        }
        if (particles.length > 0) requestAnimationFrame(updateConfetti);
    }

    window.onload = renderQuiz;
</script>
</body>
</html>