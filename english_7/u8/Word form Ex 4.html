<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>B√†i t·∫≠p Word Form L·ªõp 7 - Exercise 4 | Ms Mai An ULIS</title>
    <!-- Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>
    <!-- Font Awesome -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <!-- Google Fonts: Nunito -->
    <link href="https://fonts.googleapis.com/css2?family=Nunito:wght@400;600;700;800&display=swap" rel="stylesheet">
    <!-- Canvas Confetti -->
    <script src="https://cdn.jsdelivr.net/npm/canvas-confetti@1.6.0/dist/confetti.browser.min.js"></script>

    <style>
        /* Custom Styles for Gamification */
        body {
            font-family: 'Nunito', sans-serif;
            background-color: #f0fdf4; /* Light green tint */
            background-image: radial-gradient(#00C9A7 1px, transparent 1px), radial-gradient(#00C9A7 1px, transparent 1px);
            background-size: 20px 20px;
            background-position: 0 0, 10px 10px;
            color: #2d3748;
        }

        .header-bg {
            background: linear-gradient(135deg, #8854C0 0%, #6c5ce7 100%);
            box-shadow: 0 4px 20px rgba(108, 92, 231, 0.4);
        }

        .card-container {
            background: white;
            border-radius: 20px;
            box-shadow: 0 10px 25px rgba(0,0,0,0.1);
            border-bottom: 6px solid #e2e8f0;
            transition: transform 0.3s ease;
        }

        /* 3D Button Styles */
        .btn-option {
            transition: all 0.1s;
            border: 2px solid #e2e8f0;
            background-color: white;
            box-shadow: 0 5px 0 #cbd5e0;
            border-radius: 16px;
            font-weight: 700;
            color: #4a5568;
            position: relative;
            overflow: hidden;
        }

        .btn-option:active {
            transform: translateY(5px);
            box-shadow: none;
        }

        .btn-option.correct {
            background-color: #00D26A !important;
            border-color: #00b85c !important;
            box-shadow: 0 5px 0 #009e4f !important;
            color: white !important;
        }
        
        .btn-option.correct:active {
            box-shadow: none !important;
        }

        .btn-option.incorrect {
            background-color: #FF4757 !important;
            border-color: #ff2e40 !important;
            box-shadow: 0 5px 0 #d61c2e !important;
            color: white !important;
        }

        .btn-option.incorrect:active {
            box-shadow: none !important;
        }

        /* Animations */
        @keyframes shake {
            0%, 100% { transform: translateX(0); }
            25% { transform: translateX(-8px); }
            75% { transform: translateX(8px); }
        }

        .shake-anim {
            animation: shake 0.4s ease-in-out;
        }

        @keyframes popIn {
            0% { transform: scale(0.8); opacity: 0; }
            100% { transform: scale(1); opacity: 1; }
        }

        .explanation-box {
            animation: popIn 0.4s cubic-bezier(0.175, 0.885, 0.32, 1.275);
            border-left: 5px solid #8854C0;
        }

        .marker-badge {
            display: inline-block;
            padding: 2px 8px;
            border-radius: 6px;
            font-size: 0.8em;
            font-weight: 800;
            margin-right: 5px;
        }
        
        .badge-A { background: #FF9F43; color: white; }
        .badge-B { background: #54a0ff; color: white; }
        .badge-C { background: #5f27cd; color: white; }
        .badge-D { background: #ff6b6b; color: white; }

        .submit-btn {
            background: #00C9A7;
            color: white;
            box-shadow: 0 6px 0 #009e86;
        }
        .submit-btn:hover { background: #00b899; }
        .submit-btn:active { transform: translateY(6px); box-shadow: none; }

        /* Custom Scrollbar */
        ::-webkit-scrollbar { width: 10px; }
        ::-webkit-scrollbar-track { background: #f1f1f1; }
        ::-webkit-scrollbar-thumb { background: #8854C0; border-radius: 5px; }
        ::-webkit-scrollbar-thumb:hover { background: #6c5ce7; }
        
        /* Teacher Badge */
        .teacher-badge {
            background: rgba(255,255,255,0.2);
            border: 1px solid rgba(255,255,255,0.4);
            backdrop-filter: blur(5px);
        }
    </style>
</head>
<body class="min-h-screen flex flex-col">

    <!-- Header -->
    <header class="header-bg text-white py-6 sticky top-0 z-50">
        <div class="container mx-auto px-4 flex justify-between items-center">
            <div class="flex items-center gap-4">
                <div class="bg-white text-purple-600 w-12 h-12 rounded-full flex items-center justify-center font-bold text-2xl shadow-lg border-4 border-purple-200">
                    <i class="fa-solid fa-graduation-cap"></i>
                </div>
                <div>
                    <h1 class="text-2xl font-extrabold tracking-tight">B√†i t·∫≠p Word Form L·ªõp 7</h1>
                    <p class="text-sm opacity-90 font-semibold"><i class="fa-solid fa-book-open mr-1"></i> Exercise 4</p>
                </div>
            </div>
            <div class="teacher-badge px-4 py-2 rounded-full flex items-center gap-2 shadow-sm">
                <i class="fa-solid fa-chalkboard-user"></i>
                <span class="font-bold text-sm">Gi√°o vi√™n t·∫°o: Ms Mai An ULIS</span>
            </div>
        </div>
    </header>

    <!-- Main Content -->
    <main class="container mx-auto px-4 py-8 flex-grow max-w-4xl">
        
        <!-- Progress Bar -->
        <div class="w-full bg-gray-300 rounded-full h-4 mb-8 shadow-inner overflow-hidden">
            <div id="progress-bar" class="bg-[#00C9A7] h-4 rounded-full transition-all duration-500 ease-out" style="width: 0%"></div>
        </div>

        <!-- Questions List -->
        <div id="quiz-container" class="space-y-8">
            <!-- Questions will be injected here by JS -->
        </div>

        <!-- Submit Button Area -->
        <div class="mt-12 text-center pb-12">
            <button onclick="calculateResult()" class="submit-btn px-12 py-4 rounded-2xl text-2xl font-bold uppercase tracking-wider transition-transform w-full md:w-auto">
                <i class="fa-solid fa-flag-checkered mr-2"></i> N·ªôp b√†i & Xem ƒëi·ªÉm
            </button>
        </div>
    </main>

    <!-- Modal Result -->
    <div id="result-modal" class="fixed inset-0 bg-black bg-opacity-60 flex items-center justify-center z-50 hidden backdrop-blur-sm">
        <div class="bg-white rounded-3xl p-8 max-w-md w-full mx-4 text-center shadow-2xl transform scale-100 transition-transform duration-300" style="border-bottom: 8px solid #8854C0;">
            <div class="mb-6">
                <i id="modal-icon" class="fa-solid fa-trophy text-6xl text-yellow-400 drop-shadow-md"></i>
            </div>
            <h2 class="text-3xl font-extrabold text-[#8854C0] mb-2">K·∫øt qu·∫£ c·ªßa b·∫°n</h2>
            <p class="text-gray-600 mb-6 font-medium">B·∫°n ƒë√£ l√†m r·∫•t t·ªët!</p>
            
            <div class="bg-gray-100 rounded-xl p-6 mb-6">
                <div class="text-5xl font-black text-[#00C9A7]" id="score-text">0/12</div>
                <div class="text-sm text-gray-500 font-bold mt-2 uppercase tracking-wide">C√¢u tr·∫£ l·ªùi ƒë√∫ng</div>
            </div>

            <p id="feedback-text" class="text-lg font-bold text-gray-700 mb-8 italic">"C·ªë g·∫Øng l√™n nh√©!"</p>

            <button onclick="closeModal()" class="bg-[#8854C0] text-white px-8 py-3 rounded-xl font-bold text-lg hover:bg-purple-700 transition w-full shadow-lg border-b-4 border-purple-800 active:translate-y-1 active:border-0 active:shadow-none">
                <i class="fa-solid fa-rotate-right mr-2"></i> L√†m l·∫°i
            </button>
        </div>
    </div>

    <!-- Script -->
    <script>
        // --- DATA ---
        const quizData = {
          "questions": [
            {
              "questionNumber": 1,
              "question": "It's bad for young kids to see ________ on TV.",
              "answerOptions": [
                { "text": "violent", "type": "adj", "meaning": "b·∫°o l·ª±c, hung d·ªØ" },
                { "text": "violence", "type": "n", "meaning": "s·ª± b·∫°o l·ª±c, h√†nh vi b·∫°o l·ª±c" },
                { "text": "violently", "type": "adv", "meaning": "m·ªôt c√°ch b·∫°o l·ª±c" },
                { "text": "violates", "type": "v", "meaning": "vi ph·∫°m" }
              ],
              "correctIndex": 1,
              "explanation": {
                "translation": "Th·∫≠t kh√¥ng t·ªët cho tr·∫ª nh·ªè khi xem nh·ªØng c·∫£nh b·∫°o l·ª±c tr√™n TV.",
                "whyCorrect": "Sau ƒë·ªông t·ª´ 'see' v√† ƒë·ªÉ ch·ªâ m·ªôt kh√°i ni·ªám chung tr√™n TV, ta c·∫ßn m·ªôt Danh t·ª´ (Noun) ƒë√≥ng vai tr√≤ t√¢n ng·ªØ tr·∫£ l·ªùi cho c√¢u h·ªèi 'see what?'. C·ª•m 'violence on TV' l√† m·ªôt collocation ph·ªï bi·∫øn.",
                "whyWrong": "<b>violent</b> l√† t√≠nh t·ª´. <b>violently</b> l√† tr·∫°ng t·ª´. <b>violates</b> l√† ƒë·ªông t·ª´ chia ng√¥i th·ª© 3. T·∫•t c·∫£ ƒë·ªÅu kh√¥ng ƒë·ª©ng l√†m t√¢n ng·ªØ tr·ª±c ti·∫øp ƒë∆∞·ª£c trong ng·ªØ c·∫£nh n√†y."
              }
            },
            {
              "questionNumber": 2,
              "question": "This is a ________ story, you shouldn't read it alone.",
              "answerOptions": [
                { "text": "frighten", "type": "v", "meaning": "l√†m ho·∫£ng s·ª£" },
                { "text": "frightened", "type": "adj", "meaning": "b·ªã l√†m cho ho·∫£ng s·ª£ (c·∫£m x√∫c)" },
                { "text": "frightening", "type": "adj", "meaning": "ƒë√°ng s·ª£ (t√≠nh ch·∫•t)" },
                { "text": "fright", "type": "n", "meaning": "s·ª± ho·∫£ng s·ª£" }
              ],
              "correctIndex": 2,
              "explanation": {
                "translation": "ƒê√¢y l√† m·ªôt c√¢u chuy·ªán ƒë√°ng s·ª£, b·∫°n kh√¥ng n√™n ƒë·ªçc n√≥ m·ªôt m√¨nh.",
                "whyCorrect": "C·∫ßn m·ªôt t√≠nh t·ª´ b·ªï nghƒ©a cho danh t·ª´ 'story' (c√¢u chuy·ªán). V√¨ c√¢u chuy·ªán G√ÇY RA n·ªói s·ª£ (t√≠nh ch·∫•t ch·ªß ƒë·ªông), ta d√πng t√≠nh t·ª´ ƒëu√¥i -ing (frightening).",
                "whyWrong": "<b>frightened</b> (ƒëu√¥i -ed) d√πng ƒë·ªÉ ch·ªâ c·∫£m x√∫c c·ªßa ng∆∞·ªùi b·ªã t√°c ƒë·ªông (V√≠ d·ª•: I am frightened). <b>frighten</b> l√† ƒë·ªông t·ª´. <b>fright</b> l√† danh t·ª´."
              }
            },
            {
              "questionNumber": 3,
              "question": "Titanic is a ________ movie. It has a sad ending and everyone cries watching it.",
              "answerOptions": [
                { "text": "moving", "type": "adj", "meaning": "c·∫£m ƒë·ªông (g√¢y x√∫c ƒë·ªông)" },
                { "text": "moved", "type": "adj", "meaning": "b·ªã c·∫£m ƒë·ªông (c·∫£m x√∫c)" },
                { "text": "movement", "type": "n", "meaning": "s·ª± chuy·ªÉn ƒë·ªông" },
                { "text": "move", "type": "v", "meaning": "di chuy·ªÉn" }
              ],
              "correctIndex": 0,
              "explanation": {
                "translation": "Titanic l√† m·ªôt b·ªô phim c·∫£m ƒë·ªông. N√≥ c√≥ k·∫øt th√∫c bu·ªìn v√† m·ªçi ng∆∞·ªùi ƒë·ªÅu kh√≥c khi xem.",
                "whyCorrect": "C·∫ßn t√≠nh t·ª´ ch·ªâ t√≠nh ch·∫•t c·ªßa b·ªô phim (ch·ªß ng·ªØ g√¢y ra c·∫£m x√∫c). B·ªô phim l√†m ng∆∞·ªùi kh√°c x√∫c ƒë·ªông n√™n d√πng t√≠nh t·ª´ ƒëu√¥i -ing (moving).",
                "whyWrong": "<b>moved</b> d√πng cho c·∫£m x√∫c ng∆∞·ªùi xem. <b>movement</b> l√† danh t·ª´ ch·ªâ s·ª± di chuy·ªÉn v·∫≠t l√Ω. <b>move</b> l√† ƒë·ªông t·ª´."
              }
            },
            {
              "questionNumber": 4,
              "question": "Paul Walker has won Oscar for the best ________.",
              "answerOptions": [
                { "text": "acting", "type": "n/v", "meaning": "di·ªÖn xu·∫•t" },
                { "text": "actor", "type": "n", "meaning": "nam di·ªÖn vi√™n" },
                { "text": "action", "type": "n", "meaning": "h√†nh ƒë·ªông" },
                { "text": "active", "type": "adj", "meaning": "nƒÉng ƒë·ªông" }
              ],
              "correctIndex": 1,
              "explanation": {
                "translation": "Paul Walker ƒë√£ gi√†nh gi·∫£i Oscar cho nam di·ªÖn vi√™n xu·∫•t s·∫Øc nh·∫•t.",
                "whyCorrect": "Paul Walker l√† ng∆∞·ªùi. Gi·∫£i th∆∞·ªüng Oscar th∆∞·ªùng trao cho c√°c h·∫°ng m·ª•c nh∆∞ 'Best Actor' (Nam di·ªÖn vi√™n xu·∫•t s·∫Øc nh·∫•t) ho·∫∑c 'Best Actress'. ƒê√¢y l√† c·ª•m t·ª´ c·ªë ƒë·ªãnh.",
                "whyWrong": "<b>acting</b> l√† k·ªπ nƒÉng di·ªÖn xu·∫•t, gi·∫£i th∆∞·ªüng th∆∞·ªùng g·ªçi t√™n ng∆∞·ªùi nh·∫≠n (Actor). <b>action</b> (phim h√†nh ƒë·ªông). <b>active</b> l√† t√≠nh t·ª´."
              }
            },
            {
              "questionNumber": 5,
              "question": "This girl sings ________ although she is a ________.",
              "answerOptions": [
                { "text": "bad / singer", "type": "adj / n", "meaning": "t·ªá / ca sƒ©" },
                { "text": "badly / sing", "type": "adv / v", "meaning": "t·ªá / h√°t" },
                { "text": "badly / singer", "type": "adv / n", "meaning": "m·ªôt c√°ch t·ªìi t·ªá / ca sƒ©" },
                { "text": "bad / song", "type": "adj / n", "meaning": "t·ªá / b√†i h√°t" }
              ],
              "correctIndex": 2,
              "explanation": {
                "translation": "C√¥ g√°i n√†y h√°t d·ªü t·ªá m·∫∑c d√π c√¥ ·∫•y l√† m·ªôt ca sƒ©.",
                "whyCorrect": "V·ªã tr√≠ 1: B·ªï nghƒ©a cho ƒë·ªông t·ª´ th∆∞·ªùng 'sings' c·∫ßn m·ªôt Tr·∫°ng t·ª´ (Adv) -> <b>badly</b>. V·ªã tr√≠ 2: Sau m·∫°o t·ª´ 'a' c·∫ßn m·ªôt Danh t·ª´ ch·ªâ ng∆∞·ªùi (ngh·ªÅ nghi·ªáp) ph√π h·ª£p ng·ªØ c·∫£nh -> <b>singer</b>.",
                "whyWrong": "<b>bad</b> l√† t√≠nh t·ª´ kh√¥ng b·ªï nghƒ©a cho ƒë·ªông t·ª´ 'sing'. <b>sing</b> l√† ƒë·ªông t·ª´ kh√¥ng ƒë·ª©ng sau 'a'. <b>song</b> kh√¥ng h·ª£p l√Ω v·ªÅ nghƒ©a (c√¥ ·∫•y l√† m·ªôt b√†i h√°t)."
              }
            },
            {
              "questionNumber": 6,
              "question": "This film made a strong ________ on me.",
              "answerOptions": [
                { "text": "impress", "type": "v", "meaning": "g√¢y ·∫•n t∆∞·ª£ng" },
                { "text": "impression", "type": "n", "meaning": "s·ª± ·∫•n t∆∞·ª£ng" },
                { "text": "impressive", "type": "adj", "meaning": "ƒë·∫ßy ·∫•n t∆∞·ª£ng" },
                { "text": "impressively", "type": "adv", "meaning": "m·ªôt c√°ch ·∫•n t∆∞·ª£ng" }
              ],
              "correctIndex": 1,
              "explanation": {
                "translation": "B·ªô phim n√†y ƒë√£ t·∫°o m·ªôt ·∫•n t∆∞·ª£ng m·∫°nh m·∫Ω ƒë·ªëi v·ªõi t√¥i.",
                "whyCorrect": "C·∫•u tr√∫c Collocation: 'make an impression on somebody' (g√¢y ·∫•n t∆∞·ª£ng v·ªõi ai). Sau t√≠nh t·ª´ 'strong' ta c·∫ßn m·ªôt danh t·ª´.",
                "whyWrong": "<b>impress</b> l√† ƒë·ªông t·ª´. <b>impressive</b> l√† t√≠nh t·ª´ (kh√¥ng ƒë·ª©ng sau 'strong' n·∫øu kh√¥ng c√≥ danh t·ª´ ƒëi k√®m). <b>impressively</b> l√† tr·∫°ng t·ª´."
              }
            },
            {
              "questionNumber": 7,
              "question": "Have you ever seen this comedy? It's really ________.",
              "answerOptions": [
                { "text": "funny", "type": "adj", "meaning": "bu·ªìn c∆∞·ªùi, h√†i h∆∞·ªõc" },
                { "text": "funnily", "type": "adv", "meaning": "m·ªôt c√°ch bu·ªìn c∆∞·ªùi" },
                { "text": "fun", "type": "n/adj", "meaning": "ni·ªÅm vui" },
                { "text": "funs", "type": "n", "meaning": "kh√¥ng d√πng d·∫°ng n√†y" }
              ],
              "correctIndex": 0,
              "explanation": {
                "translation": "B·∫°n ƒë√£ xem phim h√†i n√†y ch∆∞a? N√≥ th·ª±c s·ª± r·∫•t bu·ªìn c∆∞·ªùi.",
                "whyCorrect": "ƒêang n√≥i v·ªÅ 'comedy' (phim h√†i), n√™n t√≠nh t·ª´ 'funny' (g√¢y c∆∞·ªùi/h√†i h∆∞·ªõc) l√† t·ª´ ch√≠nh x√°c nh·∫•t ƒë·ªÉ mi√™u t·∫£ t√≠nh ch·∫•t ƒë·∫∑c tr∆∞ng c·ªßa n√≥.",
                "whyWrong": "<b>funnily</b> l√† tr·∫°ng t·ª´. <b>fun</b> th∆∞·ªùng ch·ªâ s·ª± vui v·∫ª chung chung (enjoyable), c√≤n phim h√†i th√¨ ph·∫£i l√† <b>funny</b> (humorous)."
              }
            },
            {
              "questionNumber": 8,
              "question": "The film was ________ though they spent millions of dollars making it.",
              "answerOptions": [
                { "text": "successful", "type": "adj", "meaning": "th√†nh c√¥ng" },
                { "text": "success", "type": "n", "meaning": "s·ª± th√†nh c√¥ng" },
                { "text": "unsuccessful", "type": "adj", "meaning": "kh√¥ng th√†nh c√¥ng, th·∫•t b·∫°i" },
                { "text": "succeed", "type": "v", "meaning": "th√†nh c√¥ng" }
              ],
              "correctIndex": 2,
              "explanation": {
                "translation": "B·ªô phim ƒë√£ kh√¥ng th√†nh c√¥ng m·∫∑c d√π h·ªç ƒë√£ ti√™u h√†ng tri·ªáu ƒë√¥ la ƒë·ªÉ l√†m n√≥.",
                "whyCorrect": "T·ª´ 'though' (m·∫∑c d√π) b√°o hi·ªáu s·ª± t∆∞∆°ng ph·∫£n. Ti√™u h√†ng tri·ªáu ƒë√¥ (k·ª≥ v·ªçng cao) NH∆ØNG k·∫øt qu·∫£ t·ªá -> C·∫ßn t√≠nh t·ª´ mang nghƒ©a ph·ªß ƒë·ªãnh 'unsuccessful'.",
                "whyWrong": "<b>successful</b> (th√†nh c√¥ng) kh√¥ng t·∫°o ra s·ª± t∆∞∆°ng ph·∫£n v·ªõi 'though'. <b>success</b> l√† danh t·ª´ (sau tobe 'was' c·∫ßn t√≠nh t·ª´). <b>succeed</b> l√† ƒë·ªông t·ª´."
              }
            },
            {
              "questionNumber": 9,
              "question": "I love action films. They're very ________.",
              "answerOptions": [
                { "text": "excited", "type": "adj", "meaning": "h√†o h·ª©ng (c·∫£m x√∫c)" },
                { "text": "exciting", "type": "adj", "meaning": "th√∫ v·ªã, k·ªãch t√≠nh (t√≠nh ch·∫•t)" },
                { "text": "excitement", "type": "n", "meaning": "s·ª± h√†o h·ª©ng" },
                { "text": "excite", "type": "v", "meaning": "k√≠ch th√≠ch" }
              ],
              "correctIndex": 1,
              "explanation": {
                "translation": "T√¥i th√≠ch phim h√†nh ƒë·ªông. Ch√∫ng r·∫•t k·ªãch t√≠nh/th√∫ v·ªã.",
                "whyCorrect": "Ch·ªß ng·ªØ l√† 'They' (thay cho action films). Phim h√†nh ƒë·ªông mang l·∫°i s·ª± h√†o h·ª©ng cho ng∆∞·ªùi xem (t√≠nh ch·∫•t ch·ªß ƒë·ªông) n√™n d√πng t√≠nh t·ª´ ƒëu√¥i -ing (exciting).",
                "whyWrong": "<b>excited</b> d√πng cho ng∆∞·ªùi (I am excited). <b>excitement</b> l√† danh t·ª´. <b>excite</b> l√† ƒë·ªông t·ª´."
              }
            },
            {
              "questionNumber": 10,
              "question": "Big Ben Down is about a group of ________ who take control of Big Ben.",
              "answerOptions": [
                { "text": "terror", "type": "n", "meaning": "s·ª± kinh ho√†ng" },
                { "text": "terrorists", "type": "n", "meaning": "nh·ªØng k·∫ª kh·ªßng b·ªë" },
                { "text": "terrorism", "type": "n", "meaning": "ch·ªß nghƒ©a kh·ªßng b·ªë" },
                { "text": "terrifies", "type": "v", "meaning": "l√†m khi·∫øp s·ª£" }
              ],
              "correctIndex": 1,
              "explanation": {
                "translation": "Big Ben Down n√≥i v·ªÅ m·ªôt nh√≥m nh·ªØng k·∫ª kh·ªßng b·ªë chi·∫øm quy·ªÅn ki·ªÉm so√°t th√°p Big Ben.",
                "whyCorrect": "C·ª•m 'a group of...' (m·ªôt nh√≥m...) c·∫ßn danh t·ª´ ƒë·∫øm ƒë∆∞·ª£c s·ªë nhi·ªÅu ch·ªâ NG∆Ø·ªúI th·ª±c hi·ªán h√†nh ƒë·ªông 'take control'.",
                "whyWrong": "<b>terror</b> v√† <b>terrorism</b> l√† danh t·ª´ tr·ª´u t∆∞·ª£ng, kh√¥ng ph·∫£i ng∆∞·ªùi. <b>terrifies</b> l√† ƒë·ªông t·ª´."
              }
            },
            {
              "questionNumber": 11,
              "question": "We were ________ with the service at the cinema. Everything was terrible.",
              "answerOptions": [
                { "text": "satisfied", "type": "adj", "meaning": "h√†i l√≤ng" },
                { "text": "satisfying", "type": "adj", "meaning": "l√†m th·ªèa m√£n" },
                { "text": "dissatisfied", "type": "adj", "meaning": "kh√¥ng h√†i l√≤ng, b·∫•t m√£n" },
                { "text": "satisfaction", "type": "n", "meaning": "s·ª± h√†i l√≤ng" }
              ],
              "correctIndex": 2,
              "explanation": {
                "translation": "Ch√∫ng t√¥i ƒë√£ kh√¥ng h√†i l√≤ng v·ªõi d·ªãch v·ª• t·∫°i r·∫°p chi·∫øu phim. M·ªçi th·ª© ƒë·ªÅu t·ªìi t·ªá.",
                "whyCorrect": "Ch·ªß ng·ªØ 'We' ch·ªâ ng∆∞·ªùi -> d√πng t√≠nh t·ª´ ƒëu√¥i -ed. Ng·ªØ c·∫£nh 'terrible' (t·ªìi t·ªá) -> c·∫ßn t√≠nh t·ª´ mang nghƒ©a ph·ªß ƒë·ªãnh (dissatisfied).",
                "whyWrong": "<b>satisfied</b> (h√†i l√≤ng) m√¢u thu·∫´n v·ªõi 'terrible'. <b>satisfying</b> d√πng cho v·∫≠t. <b>satisfaction</b> l√† danh t·ª´."
              }
            },
            {
              "questionNumber": 12,
              "question": "The film is a big ________. It is boring from beginning to end.",
              "answerOptions": [
                { "text": "disappointing", "type": "adj", "meaning": "g√¢y th·∫•t v·ªçng" },
                { "text": "disappointment", "type": "n", "meaning": "s·ª± th·∫•t v·ªçng, n·ªói th·∫•t v·ªçng" },
                { "text": "disappointed", "type": "adj", "meaning": "b·ªã th·∫•t v·ªçng" },
                { "text": "disappoint", "type": "v", "meaning": "g√¢y th·∫•t v·ªçng" }
              ],
              "correctIndex": 1,
              "explanation": {
                "translation": "B·ªô phim l√† m·ªôt n·ªói th·∫•t v·ªçng l·ªõn. N√≥ nh√†m ch√°n t·ª´ ƒë·∫ßu ƒë·∫øn cu·ªëi.",
                "whyCorrect": "C·∫•u tr√∫c 'a big + Noun'. 'Disappointment' ·ªü ƒë√¢y √°m ch·ªâ b·ªô phim (v·∫≠t) l√† m·ªôt 'n·ªói th·∫•t v·ªçng'.",
                "whyWrong": "<b>disappointing</b> l√† t√≠nh t·ª´, thi·∫øu danh t·ª´ theo sau. <b>disappointed</b> ch·ªâ c·∫£m x√∫c ng∆∞·ªùi. <b>disappoint</b> l√† ƒë·ªông t·ª´."
              }
            }
          ]
        };

        let userAnswers = {};
        const audioCtx = new (window.AudioContext || window.webkitAudioContext)();

        // --- SOUND SYSTEM (Synthesized) ---
        function playSound(type) {
            if (audioCtx.state === 'suspended') audioCtx.resume();
            const osc = audioCtx.createOscillator();
            const gainNode = audioCtx.createGain();
            osc.connect(gainNode);
            gainNode.connect(audioCtx.destination);

            if (type === 'correct') {
                // Ding sound (High pitch sine wave fade out)
                osc.type = 'sine';
                osc.frequency.setValueAtTime(800, audioCtx.currentTime);
                osc.frequency.exponentialRampToValueAtTime(1200, audioCtx.currentTime + 0.1);
                gainNode.gain.setValueAtTime(0.3, audioCtx.currentTime);
                gainNode.gain.exponentialRampToValueAtTime(0.01, audioCtx.currentTime + 0.5);
                osc.start();
                osc.stop(audioCtx.currentTime + 0.5);
            } else {
                // Buzz sound (Low pitch sawtooth)
                osc.type = 'sawtooth';
                osc.frequency.setValueAtTime(150, audioCtx.currentTime);
                osc.frequency.linearRampToValueAtTime(100, audioCtx.currentTime + 0.3);
                gainNode.gain.setValueAtTime(0.3, audioCtx.currentTime);
                gainNode.gain.exponentialRampToValueAtTime(0.01, audioCtx.currentTime + 0.3);
                osc.start();
                osc.stop(audioCtx.currentTime + 0.3);
            }
        }

        // --- RENDER LOGIC ---
        function renderQuiz() {
            const container = document.getElementById('quiz-container');
            container.innerHTML = '';

            quizData.questions.forEach((q, index) => {
                const card = document.createElement('div');
                card.className = "card-container p-6 relative";
                card.id = `q-card-${index}`;

                // Question Header
                const qHeader = `
                    <div class="flex items-start mb-6">
                        <div class="bg-[#8854C0] text-white rounded-lg w-10 h-10 flex-shrink-0 flex items-center justify-center font-bold text-lg mr-4 shadow-md">
                            ${index + 1}
                        </div>
                        <h3 class="text-xl font-bold text-gray-800 leading-snug pt-1">${q.question}</h3>
                    </div>
                `;

                // Options Grid
                let optionsHtml = '<div class="grid grid-cols-1 md:grid-cols-2 gap-4 mb-6">';
                q.answerOptions.forEach((opt, optIndex) => {
                    const badge = optIndex === 0 ? 'A' : optIndex === 1 ? 'B' : optIndex === 2 ? 'C' : 'D';
                    optionsHtml += `
                        <button id="btn-${index}-${optIndex}" onclick="checkAnswer(${index}, ${optIndex})" 
                            class="btn-option w-full py-4 px-6 text-left flex items-center group">
                            <span class="marker-badge badge-${badge} w-8 h-8 flex items-center justify-center rounded-md mr-3 shadow-sm text-sm">${badge}</span>
                            <span class="text-lg">${opt.text}</span>
                        </button>
                    `;
                });
                optionsHtml += '</div>';

                // Explanation Area (Hidden by default)
                const explanationHtml = `
                    <div id="explanation-${index}" class="hidden explanation-box bg-purple-50 p-6 rounded-r-xl rounded-bl-xl mt-4">
                        <div class="flex items-center mb-3">
                            <div class="bg-[#00C9A7] text-white text-xs font-bold px-3 py-1 rounded-full uppercase tracking-wider mr-2">
                                <i class="fa-solid fa-lightbulb mr-1"></i> Gi·∫£i th√≠ch chi ti·∫øt
                            </div>
                            <span class="text-xs text-gray-500 font-semibold italic">Ms Mai An ULIS</span>
                        </div>
                        
                        <!-- 1. Translation -->
                        <div class="mb-4 pb-3 border-b border-purple-100">
                            <p class="font-bold text-[#8854C0] text-sm uppercase mb-1"><i class="fa-solid fa-language mr-1"></i> D·ªãch c√¢u h·ªèi:</p>
                            <p class="text-gray-700 italic">"${q.explanation.translation}"</p>
                        </div>

                        <!-- 2. Option Analysis -->
                        <div class="mb-4">
                            <p class="font-bold text-[#8854C0] text-sm uppercase mb-2"><i class="fa-solid fa-magnifying-glass mr-1"></i> Ph√¢n t√≠ch t·ª´ v·ª±ng:</p>
                            <div class="grid grid-cols-1 sm:grid-cols-2 gap-2 text-sm">
                                ${q.answerOptions.map((opt, i) => {
                                    const label = i === 0 ? 'A' : i === 1 ? 'B' : i === 2 ? 'C' : 'D';
                                    const isCorrect = i === q.correctIndex;
                                    const colorClass = isCorrect ? "text-green-600 font-bold bg-green-50" : "text-gray-600";
                                    return `<div class="${colorClass} p-1 rounded"><span class="font-extrabold mr-1">${label}.</span> ${opt.text} <span class="text-xs text-gray-500">(${opt.type}):</span> ${opt.meaning}</div>`;
                                }).join('')}
                            </div>
                        </div>

                        <!-- 3. Why Correct -->
                        <div class="mb-3">
                            <p class="font-bold text-green-600 text-sm uppercase mb-1"><i class="fa-solid fa-check-circle mr-1"></i> T·∫°i sao ƒê√öNG?</p>
                            <p class="text-gray-700 text-sm leading-relaxed">${q.explanation.whyCorrect}</p>
                        </div>

                        <!-- 4. Why Wrong -->
                        <div>
                            <p class="font-bold text-red-500 text-sm uppercase mb-1"><i class="fa-solid fa-circle-xmark mr-1"></i> T·∫°i sao SAI?</p>
                            <p class="text-gray-700 text-sm leading-relaxed">${q.explanation.whyWrong}</p>
                        </div>
                    </div>
                `;

                card.innerHTML = qHeader + optionsHtml + explanationHtml;
                container.appendChild(card);
            });
            
            updateProgressBar();
        }

        // --- INTERACTION LOGIC ---
        function checkAnswer(questionIndex, selectedIndex) {
            // Prevent re-answering
            if (userAnswers[questionIndex] !== undefined) return;

            const question = quizData.questions[questionIndex];
            const isCorrect = selectedIndex === question.correctIndex;
            userAnswers[questionIndex] = isCorrect;

            const btnSelected = document.getElementById(`btn-${questionIndex}-${selectedIndex}`);
            const btnCorrect = document.getElementById(`btn-${questionIndex}-${question.correctIndex}`);
            const card = document.getElementById(`q-card-${questionIndex}`);

            // Visual Feedback & Sound
            if (isCorrect) {
                btnSelected.classList.add('correct');
                playSound('correct');
                // Confetti specific to this card position (approximate)
                confetti({
                    particleCount: 50,
                    spread: 70,
                    origin: { y: 0.6 },
                    colors: ['#00C9A7', '#8854C0', '#ffbe76']
                });
            } else {
                btnSelected.classList.add('incorrect');
                btnCorrect.classList.add('correct'); // Show correct answer
                playSound('incorrect');
                // Shake animation
                card.classList.add('shake-anim');
                setTimeout(() => card.classList.remove('shake-anim'), 500);
            }

            // Disable all buttons in this question
            for(let i=0; i<4; i++) {
                const btn = document.getElementById(`btn-${questionIndex}-${i}`);
                btn.classList.add('cursor-default');
                btn.onclick = null; // Remove handler
                if (i !== selectedIndex && i !== question.correctIndex) {
                    btn.classList.add('opacity-50');
                }
            }

            // Show Explanation immediately
            const expBox = document.getElementById(`explanation-${questionIndex}`);
            expBox.classList.remove('hidden');

            updateProgressBar();
        }

        function updateProgressBar() {
            const total = quizData.questions.length;
            const answered = Object.keys(userAnswers).length;
            const pct = (answered / total) * 100;
            document.getElementById('progress-bar').style.width = `${pct}%`;
        }

        function calculateResult() {
            const total = quizData.questions.length;
            const answered = Object.keys(userAnswers).length;

            if (answered < total) {
                const confirmSubmit = confirm(`B·∫°n m·ªõi l√†m ${answered}/${total} c√¢u. B·∫°n c√≥ ch·∫Øc ch·∫Øn mu·ªën n·ªôp b√†i kh√¥ng?`);
                if (!confirmSubmit) return;
            }

            let score = 0;
            for (let i = 0; i < total; i++) {
                if (userAnswers[i] === true) score++;
            }

            // Feedback Logic
            const percentage = (score / total) * 100;
            let feedback = "";
            let iconClass = "fa-trophy text-yellow-400";
            
            if (percentage === 100) {
                feedback = "Xu·∫•t s·∫Øc! B·∫°n l√† thi√™n t√†i Word Form! üåü";
                confetti({ particleCount: 200, spread: 100, origin: { y: 0.6 } });
            } else if (percentage >= 80) {
                feedback = "R·∫•t t·ªët! B·∫°n n·∫Øm r·∫•t ch·∫Øc ki·∫øn th·ª©c! üî•";
            } else if (percentage >= 50) {
                feedback = "Kh√° l·∫Øm! C·ªë g·∫Øng th√™m m·ªôt ch√∫t n·ªØa nh√©! üí™";
                iconClass = "fa-thumbs-up text-blue-400";
            } else {
                feedback = "ƒê·ª´ng bu·ªìn! H√£y xem l·∫°i ph·∫ßn gi·∫£i th√≠ch k·ªπ h∆°n nh√©! üìö";
                iconClass = "fa-book-open-reader text-gray-400";
            }

            document.getElementById('score-text').innerText = `${score}/${total}`;
            document.getElementById('feedback-text').innerText = feedback;
            document.getElementById('modal-icon').className = `fa-solid ${iconClass} text-6xl drop-shadow-md`;
            
            document.getElementById('result-modal').classList.remove('hidden');
            playSound('correct'); // Final ding
        }

        function closeModal() {
            // Reload page to reset
            window.scrollTo(0, 0);
            location.reload();
        }

        // Initial Render
        renderQuiz();

    </script>
</body>
</html>
