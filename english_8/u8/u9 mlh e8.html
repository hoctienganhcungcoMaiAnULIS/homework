<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>B√†i Ki·ªÉm Tra - Ms Mai An ULIS</title>
    <link href="https://fonts.googleapis.com/css2?family=Nunito:wght@400;600;700;800&display=swap" rel="stylesheet">
    <style>
        :root {
            --primary: #8854C0; /* H·ªìng t√≠m */
            --secondary: #00C9A7; /* Xanh ng·ªçc */
            --correct: #00D26A; /* Xanh l√° */
            --wrong: #FF4757; /* ƒê·ªè cam */
            --bg-pattern: #f0f3f9;
            --text-main: #2d3436;
        }

        body {
            font-family: 'Nunito', sans-serif;
            background-color: var(--bg-pattern);
            background-image: radial-gradient(#d1d8e0 2px, transparent 2px);
            background-size: 20px 20px;
            color: var(--text-main);
            margin: 0;
            padding: 20px;
        }

        .container {
            max-width: 900px;
            margin: 0 auto;
        }

        /* HEADER */
        header {
            text-align: center;
            margin-bottom: 30px;
            background: white;
            padding: 20px;
            border-radius: 20px;
            box-shadow: 0 8px 0 rgba(0,0,0,0.1);
            border: 2px solid #eee;
        }

        h1 {
            color: var(--primary);
            font-weight: 800;
            margin: 0;
            text-transform: uppercase;
            letter-spacing: 1px;
            font-size: 24px;
        }

        .teacher-name {
            font-size: 16px;
            color: #888;
            font-weight: 600;
        }

        /* CARDS */
        .card {
            background: white;
            border-radius: 20px;
            padding: 30px;
            margin-bottom: 30px;
            box-shadow: 0 10px 0 #dfe4ea;
            position: relative;
            border: 2px solid #f1f2f6;
        }

        h2 {
            color: var(--secondary);
            font-weight: 800;
            border-bottom: 3px dashed #eee;
            padding-bottom: 10px;
        }

        /* GAP FILL STYLES */
        .word-bank {
            display: flex;
            flex-wrap: wrap;
            gap: 10px;
            background: #f8f9fa;
            padding: 15px;
            border-radius: 15px;
            border: 2px dashed var(--primary);
            justify-content: center;
            margin-bottom: 20px;
        }

        .bank-item {
            background: white;
            padding: 8px 15px;
            border-radius: 10px;
            font-weight: bold;
            color: var(--primary);
            box-shadow: 0 4px 0 #ddd;
            cursor: default;
        }

        .gap-input {
            display: inline-block;
            min-width: 100px;
            padding: 5px 10px;
            margin: 0 5px;
            border-bottom: 3px solid #ccc;
            background: #f1f2f6;
            border-radius: 5px;
            cursor: pointer;
            text-align: center;
            font-weight: bold;
            color: var(--primary);
            transition: 0.2s;
        }

        .gap-input:hover {
            background: #e1e2e6;
            transform: scale(1.05);
        }

        .gap-input.correct {
            background-color: var(--correct);
            color: white;
            border-color: #00b85c;
        }

        .gap-input.wrong {
            background-color: var(--wrong);
            color: white;
            border-color: #e04050;
        }

        /* READING PASSAGE */
        .reading-text {
            line-height: 1.8;
            font-size: 17px;
            background: #fff8e1; /* M√†u gi·∫•y c≈© nh·∫π */
            padding: 20px;
            border-radius: 15px;
            border-left: 5px solid var(--secondary);
        }

        /* GLOSSARY TABLE */
        .glossary-table {
            width: 100%;
            border-collapse: collapse;
            margin-top: 20px;
            background: white;
            border-radius: 10px;
            overflow: hidden;
            box-shadow: 0 4px 0 #eee;
        }

        .glossary-table th {
            background: var(--primary);
            color: white;
            padding: 12px;
            text-align: left;
        }

        .glossary-table td {
            padding: 12px;
            border-bottom: 1px solid #eee;
        }

        .glossary-table tr:nth-child(even) {
            background-color: #f9f9f9;
        }

        /* MULTIPLE CHOICE & TF */
        .question-block {
            margin-bottom: 30px;
            padding-bottom: 20px;
            border-bottom: 1px solid #eee;
        }

        .question-text {
            font-weight: 700;
            font-size: 18px;
            margin-bottom: 15px;
        }

        .options-grid {
            display: grid;
            grid-template-columns: 1fr 1fr; /* 2 c·ªôt */
            gap: 15px;
        }
        
        @media (max-width: 600px) {
            .options-grid { grid-template-columns: 1fr; }
        }

        .option-btn {
            background: white;
            border: 2px solid #eee;
            padding: 15px;
            border-radius: 15px;
            font-family: 'Nunito', sans-serif;
            font-size: 16px;
            font-weight: 600;
            color: var(--text-main);
            cursor: pointer;
            text-align: left;
            transition: all 0.2s;
            box-shadow: 0 5px 0 #ddd;
            position: relative;
        }

        .option-btn:hover {
            transform: scale(1.02);
            border-color: var(--primary);
        }

        .option-btn:active {
            transform: translateY(4px);
            box-shadow: 0 1px 0 #ddd;
        }

        .option-btn.correct {
            background-color: var(--correct);
            color: white;
            border-color: #00b85c;
            box-shadow: 0 5px 0 #00b85c;
        }

        .option-btn.wrong {
            background-color: var(--wrong);
            color: white;
            border-color: #e04050;
            box-shadow: 0 5px 0 #e04050;
            animation: shake 0.5s;
        }

        /* EXPLANATION BOX */
        .explanation-box {
            display: none; /* Hi·ªán khi ƒë√£ tr·∫£ l·ªùi */
            margin-top: 15px;
            background: #f0f3ff;
            border: 2px solid #dbe4ff;
            border-radius: 12px;
            padding: 20px;
            animation: slideDown 0.3s ease-out;
        }

        .exp-title {
            font-weight: 800;
            color: var(--primary);
            margin-bottom: 10px;
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .exp-content p {
            margin: 5px 0;
            line-height: 1.5;
        }

        .exp-step {
            margin-bottom: 10px;
        }

        .exp-label {
            font-weight: bold;
            color: #555;
            text-decoration: underline;
        }

        /* MODAL FOR GAP FILL */
        .modal-overlay {
            display: none;
            position: fixed;
            top: 0; left: 0; width: 100%; height: 100%;
            background: rgba(0,0,0,0.5);
            z-index: 1000;
            justify-content: center;
            align-items: center;
        }

        .modal-content {
            background: white;
            padding: 25px;
            border-radius: 20px;
            width: 90%;
            max-width: 400px;
            text-align: center;
            box-shadow: 0 10px 25px rgba(0,0,0,0.2);
            animation: popIn 0.3s;
        }

        .modal-options {
            display: flex;
            flex-wrap: wrap;
            gap: 10px;
            justify-content: center;
            margin-top: 15px;
        }

        .modal-btn {
            background: var(--secondary);
            color: white;
            border: none;
            padding: 10px 20px;
            border-radius: 10px;
            font-size: 16px;
            cursor: pointer;
            box-shadow: 0 4px 0 #00a88a;
            font-family: 'Nunito', sans-serif;
        }
        .modal-btn:active { transform: translateY(3px); box-shadow: none; }

        /* SUBMIT BUTTON */
        .submit-section {
            text-align: center;
            margin-top: 40px;
            margin-bottom: 60px;
        }

        .btn-finish {
            background: var(--primary);
            color: white;
            font-size: 20px;
            padding: 15px 40px;
            border: none;
            border-radius: 50px;
            font-weight: 800;
            cursor: pointer;
            box-shadow: 0 8px 0 #6a3da1;
            transition: 0.2s;
        }
        .btn-finish:hover { transform: scale(1.05); }
        .btn-finish:active { transform: translateY(5px); box-shadow: 0 3px 0 #6a3da1; }

        /* ANIMATIONS */
        @keyframes shake {
            0% { transform: translateX(0); }
            25% { transform: translateX(-5px); }
            50% { transform: translateX(5px); }
            75% { transform: translateX(-5px); }
            100% { transform: translateX(0); }
        }

        @keyframes slideDown {
            from { opacity: 0; transform: translateY(-10px); }
            to { opacity: 1; transform: translateY(0); }
        }

        @keyframes popIn {
            from { transform: scale(0.8); opacity: 0; }
            to { transform: scale(1); opacity: 1; }
        }
        
        /* CONFETTI CANVAS */
        #confetti-canvas {
            position: fixed;
            top: 0; left: 0;
            width: 100vw; height: 100vh;
            pointer-events: none;
            z-index: 9999;
        }
        
        u { text-decoration: underline; text-decoration-thickness: 2px; text-underline-offset: 3px; }

    </style>
</head>
<body>

<canvas id="confetti-canvas"></canvas>

<div class="container">
    <header>
        <h1>English Test Practice</h1>
        <div class="teacher-name">Designed by: Ms Mai An ULIS</div>
    </header>

    <div class="card">
        <h2>I. GAP FILL: Mother Nature</h2>
        <p>Complete the passage with the words from the box.</p>
        
        <div class="word-bank">
            <span class="bank-item">flooding</span>
            <span class="bank-item">mudslide</span>
            <span class="bank-item">avalanche</span>
            <span class="bank-item">twister</span>
            <span class="bank-item">result</span>
            <span class="bank-item">famine</span>
            <span class="bank-item">volcanic</span>
            <span class="bank-item">plates</span>
        </div>

        <div class="reading-text">
            Mother nature can be a bit scary at times. These days there seem to be more and more occurrences of natural disasters happening around the world.<br><br>
            
            An <span class="gap-input" data-id="g1" onclick="openGapModal('g1', 'avalanche')">(1) ______</span> is the large movement of snow down the side of a mountain. They occur when the snow becomes too loose and as it slides down it mixes with air and water to cause a powerful and dangerous disaster.
            <div id="exp-g1" class="explanation-box"></div>

            <br><br>A drought happens when there has been no rain in a place for a long time. A drought may result in a <span class="gap-input" data-id="g2" onclick="openGapModal('g2', 'famine')">(2) ______</span>; this is when there is not enough food to feed the people and they start to starve.
            <div id="exp-g2" class="explanation-box"></div>

            <br><br>An earthquake occurs when the <span class="gap-input" data-id="g3" onclick="openGapModal('g3', 'plates')">(3) ______</span> of the earth start to move and the ground begins to move and shake. The size of earthquakes is measured on the Richter scale.
            <div id="exp-g3" class="explanation-box"></div>

            <br><br>A flood occurs when a large amount of water covers the land. Too much rain usually causes floods. As sea levels continue to rise, the risk of <span class="gap-input" data-id="g4" onclick="openGapModal('g4', 'flooding')">(4) ______</span> increases.
            <div id="exp-g4" class="explanation-box"></div>

            <br><br>A hurricane originally means ‚Äòbig wind‚Äô. Hurricanes are caused by low air pressure and thunderstorms and <span class="gap-input" data-id="g5" onclick="openGapModal('g5', 'result')">(5) ______</span> in strong winds and heavy rain. When they happen in the Atlantic Ocean we call them Hurricanes; however, they are called Typhoons when they happen in the Pacific Ocean.
            <div id="exp-g5" class="explanation-box"></div>

            <br><br>A landslide happens on a slope like a mountain or a hill. The rocks and earth become loose and fall down the slope. When soil on the slope is wet, a <span class="gap-input" data-id="g6" onclick="openGapModal('g6', 'mudslide')">(6) ______</span> may occur.
            <div id="exp-g6" class="explanation-box"></div>

            <br><br>A tornado, which is casually known as a <span class="gap-input" data-id="g7" onclick="openGapModal('g7', 'twister')">(7) ______</span>, is a very large column of wind that spins around very quickly. The power of a Tornado can cause the winds to destroy houses and pick up and throw heavy items.
            <div id="exp-g7" class="explanation-box"></div>

            <br><br><span class="gap-input" data-id="g8" onclick="openGapModal('g8', 'volcanic')">(8) ______</span> eruptions are caused by the plates of the earth moving and the pressure makes magma push up through the cracks in the earth.
            <div id="exp-g8" class="explanation-box"></div>
        </div>
    </div>

    <div class="card">
        <h2>II. READING COMPREHENSION</h2>
        <div class="reading-text">
            Vietnam usually has a dozen storms every year from June through the end of November, and most of which occur in the central and northern provinces. November 2<sup>nd</sup>, 1997, however, was an unexpected day when the major storm Linda raged in the south. Linda was the worst typhoon in southern Vietnam over 100 years. Formed in the sea of the Philippines, Linda strengthened as it moved westward. Later, it struck extreme southern Vietnam with winds of 100 kilometres an hour. Over 3000 people were reported lost and died. Ca Mau province, suffered a direct hit by the storm, had the most damage. Gusts and heavy rainfalls caused flooding, destroyed crops, damaged about 200,000 houses and left about 383,000 people homeless. Linda later struck Thailand, causing flash flooding and at least 164 deaths. The storm also affected Myanmar, Indonesia, Malaysia, and Cambodia to a lesser degree.<br><br>
            Today, residents in Mekong Delta still remember Linda after 20 years. The duration of the time is enough for a kid to grow up from an unforgettable event. The memory of a particular typhoon improves everyone‚Äôs awareness of natural disasters.
        </div>

        <h3>üìö Academic Glossary (T·ª´ v·ª±ng n√¢ng cao)</h3>
        <table class="glossary-table">
            <thead>
                <tr>
                    <th>Word (T·ª´)</th>
                    <th>Type (Lo·∫°i)</th>
                    <th>Meaning (Nghƒ©a ti·∫øng Vi·ªát)</th>
                </tr>
            </thead>
            <tbody>
                <tr><td>Rage</td><td>(v)</td><td>Ho√†nh h√†nh, di·ªÖn ra d·ªØ d·ªôi</td></tr>
                <tr><td>Strengthen</td><td>(v)</td><td>M·∫°nh l√™n, tƒÉng c∆∞·ªùng</td></tr>
                <tr><td>Westward</td><td>(adv)</td><td>V·ªÅ ph√≠a t√¢y</td></tr>
                <tr><td>Extreme</td><td>(adj)</td><td>C·ª±c ƒë·ªô, (ƒë·ªãa l√Ω) t·∫≠n c√πng</td></tr>
                <tr><td>Direct hit</td><td>(n)</td><td>ƒê√°nh tr·ª±c di·ªán</td></tr>
                <tr><td>Gust</td><td>(n)</td><td>C∆°n gi√≥ gi·∫≠t m·∫°nh</td></tr>
                <tr><td>Flash flooding</td><td>(n)</td><td>L≈© qu√©t</td></tr>
                <tr><td>Resident</td><td>(n)</td><td>C∆∞ d√¢n</td></tr>
                <tr><td>Duration</td><td>(n)</td><td>Kho·∫£ng th·ªùi gian</td></tr>
                <tr><td>Awareness</td><td>(n)</td><td>S·ª± nh·∫≠n th·ª©c</td></tr>
            </tbody>
        </table>

        <h3 style="margin-top: 30px; color: var(--primary);">A. True (T) or False (F)</h3>
        
        <div id="tf-questions">
            <div class="question-block" data-correct="F">
                <p class="question-text">1. The tropical storm Linda hit northern Vietnam on November 2<sup>nd</sup>, 1997.</p>
                <div class="options-grid">
                    <button class="option-btn" onclick="checkMCQ(this, 'F', 'tf1')">True</button>
                    <button class="option-btn" onclick="checkMCQ(this, 'F', 'tf1')">False</button>
                </div>
                <div id="exp-tf1" class="explanation-box"></div>
            </div>

            <div class="question-block" data-correct="F">
                <p class="question-text">2. Linda was the worst typhoon in Vietnam for the last 100 years.</p>
                <div class="options-grid">
                    <button class="option-btn" onclick="checkMCQ(this, 'F', 'tf2')">True</button>
                    <button class="option-btn" onclick="checkMCQ(this, 'F', 'tf2')">False</button>
                </div>
                <div id="exp-tf2" class="explanation-box"></div>
            </div>

            <div class="question-block" data-correct="T">
                <p class="question-text">3. From the Philippines, the storm moved west and struck southern Vietnam with winds of 100 km/h.</p>
                <div class="options-grid">
                    <button class="option-btn" onclick="checkMCQ(this, 'T', 'tf3')">True</button>
                    <button class="option-btn" onclick="checkMCQ(this, 'T', 'tf3')">False</button>
                </div>
                <div id="exp-tf3" class="explanation-box"></div>
            </div>

             <div class="question-block" data-correct="T">
                <p class="question-text">4. Approximately 3,000 people were killed during the disaster.</p>
                <div class="options-grid">
                    <button class="option-btn" onclick="checkMCQ(this, 'T', 'tf4')">True</button>
                    <button class="option-btn" onclick="checkMCQ(this, 'T', 'tf4')">False</button>
                </div>
                <div id="exp-tf4" class="explanation-box"></div>
            </div>

            <div class="question-block" data-correct="T">
                <p class="question-text">5. Ca Mau province was directly affected by the typhoon.</p>
                <div class="options-grid">
                    <button class="option-btn" onclick="checkMCQ(this, 'T', 'tf5')">True</button>
                    <button class="option-btn" onclick="checkMCQ(this, 'T', 'tf5')">False</button>
                </div>
                <div id="exp-tf5" class="explanation-box"></div>
            </div>

            <div class="question-block" data-correct="T">
                <p class="question-text">6. Typhoon Linda caused extensive damage to both property and human.</p>
                <div class="options-grid">
                    <button class="option-btn" onclick="checkMCQ(this, 'T', 'tf6')">True</button>
                    <button class="option-btn" onclick="checkMCQ(this, 'T', 'tf6')">False</button>
                </div>
                <div id="exp-tf6" class="explanation-box"></div>
            </div>

            <div class="question-block" data-correct="F">
                <p class="question-text">7. Typhoon Linda only struck Vietnam and Thailand.</p>
                <div class="options-grid">
                    <button class="option-btn" onclick="checkMCQ(this, 'F', 'tf7')">True</button>
                    <button class="option-btn" onclick="checkMCQ(this, 'F', 'tf7')">False</button>
                </div>
                <div id="exp-tf7" class="explanation-box"></div>
            </div>

            <div class="question-block" data-correct="F">
                <p class="question-text">8. The storm gradually weakened as it passed over Myanmar.</p>
                <div class="options-grid">
                    <button class="option-btn" onclick="checkMCQ(this, 'F', 'tf8')">True</button>
                    <button class="option-btn" onclick="checkMCQ(this, 'F', 'tf8')">False</button>
                </div>
                <div id="exp-tf8" class="explanation-box"></div>
            </div>
        </div>

        <h3 style="margin-top: 30px; color: var(--primary);">B. Multiple Choice Questions</h3>

        <div class="question-block" data-correct="B">
            <p class="question-text">1. When is the typhoon season in Vietnam?</p>
            <div class="options-grid">
                <button class="option-btn" onclick="checkMCQ(this, 'A', 'mc1')">A. From January to April</button>
                <button class="option-btn" onclick="checkMCQ(this, 'B', 'mc1')">B. From June through the end of November</button>
                <button class="option-btn" onclick="checkMCQ(this, 'C', 'mc1')">C. From May to October</button>
                <button class="option-btn" onclick="checkMCQ(this, 'D', 'mc1')">D. From December to February</button>
            </div>
            <div id="exp-mc1" class="explanation-box"></div>
        </div>

        <div class="question-block" data-correct="C">
            <p class="question-text">2. Where in Vietnam did Typhoon Linda strike?</p>
            <div class="options-grid">
                <button class="option-btn" onclick="checkMCQ(this, 'A', 'mc2')">A. The northern provinces</button>
                <button class="option-btn" onclick="checkMCQ(this, 'B', 'mc2')">B. The central provinces</button>
                <button class="option-btn" onclick="checkMCQ(this, 'C', 'mc2')">C. The extreme southern provinces</button>
                <button class="option-btn" onclick="checkMCQ(this, 'D', 'mc2')">D. The Mekong Delta only</button>
            </div>
            <div id="exp-mc2" class="explanation-box"></div>
        </div>

        <div class="question-block" data-correct="C">
            <p class="question-text">3. What was the wind speed of Typhoon Linda when it hit southern Vietnam?</p>
            <div class="options-grid">
                <button class="option-btn" onclick="checkMCQ(this, 'A', 'mc3')">A. 200 kilometers an hour</button>
                <button class="option-btn" onclick="checkMCQ(this, 'B', 'mc3')">B. 164 kilometers an hour</button>
                <button class="option-btn" onclick="checkMCQ(this, 'C', 'mc3')">C. 100 kilometers an hour</button>
                <button class="option-btn" onclick="checkMCQ(this, 'D', 'mc3')">D. 3000 kilometers an hour</button>
            </div>
            <div id="exp-mc3" class="explanation-box"></div>
        </div>

        <div class="question-block" data-correct="B">
            <p class="question-text">4. How many homes were damaged or destroyed by Typhoon Linda?</p>
            <div class="options-grid">
                <button class="option-btn" onclick="checkMCQ(this, 'A', 'mc4')">A. About 3,000</button>
                <button class="option-btn" onclick="checkMCQ(this, 'B', 'mc4')">B. About 200,000</button>
                <button class="option-btn" onclick="checkMCQ(this, 'C', 'mc4')">C. About 383,000</button>
                <button class="option-btn" onclick="checkMCQ(this, 'D', 'mc4')">D. About 100</button>
            </div>
            <div id="exp-mc4" class="explanation-box"></div>
        </div>

        <div class="question-block" data-correct="C">
            <p class="question-text">5. Where did Typhoon Linda pass over after striking Vietnam?</p>
            <div class="options-grid">
                <button class="option-btn" onclick="checkMCQ(this, 'A', 'mc5')">A. The Philippines</button>
                <button class="option-btn" onclick="checkMCQ(this, 'B', 'mc5')">B. Indonesia</button>
                <button class="option-btn" onclick="checkMCQ(this, 'C', 'mc5')">C. Thailand</button>
                <button class="option-btn" onclick="checkMCQ(this, 'D', 'mc5')">D. Malaysia</button>
            </div>
            <div id="exp-mc5" class="explanation-box"></div>
        </div>

        <div class="question-block" data-correct="B">
            <p class="question-text">6. What did people learn from Typhoon Linda?</p>
            <div class="options-grid">
                <button class="option-btn" onclick="checkMCQ(this, 'A', 'mc6')">A. How to stop natural disasters</button>
                <button class="option-btn" onclick="checkMCQ(this, 'B', 'mc6')">B. It improved everyone‚Äôs awareness</button>
                <button class="option-btn" onclick="checkMCQ(this, 'C', 'mc6')">C. That typhoons never happen in the south</button>
                <button class="option-btn" onclick="checkMCQ(this, 'D', 'mc6')">D. How to predict the weather</button>
            </div>
            <div id="exp-mc6" class="explanation-box"></div>
        </div>
    </div>

    <div class="submit-section">
        <button class="btn-finish" onclick="finishTest()">N·ªôp B√†i (Submit)</button>
    </div>

</div>

<div class="modal-overlay" id="gapModal">
    <div class="modal-content">
        <h3>Choose the correct word</h3>
        <div class="modal-options" id="modalOptions">
            </div>
        <br>
        <button class="modal-btn" style="background:#999" onclick="document.getElementById('gapModal').style.display='none'">Cancel</button>
    </div>
</div>

<script>
    // --- DATA & EXPLANATIONS ---
    const allWords = ['flooding', 'mudslide', 'avalanche', 'twister', 'result', 'famine', 'volcanic', 'plates'];
    
    const explanations = {
        // Gap Fill
        'g1': `<b>D·ªãch:</b> M·ªôt <u>tuy·∫øt l·ªü</u> l√† s·ª± di chuy·ªÉn l·ªõn c·ªßa tuy·∫øt xu·ªëng s∆∞·ªùn n√∫i.<br>
               <b>T·∫°i sao ƒê√öNG:</b> <i>Avalanche</i> (tuy·∫øt l·ªü). Ng·ªØ c·∫£nh "large movement of snow" (s·ª± di chuy·ªÉn l·ªõn c·ªßa tuy·∫øt) -> Ch·ªçn Avalanche.<br>
               <b>T·ª´ kh√°c:</b> Flooding (l≈© l·ª•t), Mudslide (l≈© b√πn), Twister (l·ªëc xo√°y).`,
        'g2': `<b>D·ªãch:</b> H·∫°n h√°n c√≥ th·ªÉ d·∫´n ƒë·∫øn <u>n·∫°n ƒë√≥i</u>; ƒë√¢y l√† khi kh√¥ng c√≥ ƒë·ªß th·ª©c ƒÉn...<br>
               <b>T·∫°i sao ƒê√öNG:</b> <i>Famine</i> (n·∫°n ƒë√≥i). Ng·ªØ c·∫£nh "not enough food" (kh√¥ng ƒë·ªß th·ª©c ƒÉn) v√† "starve" (ch·∫øt ƒë√≥i).<br>
               <b>T·ª´ kh√°c:</b> Result (k·∫øt qu·∫£), Volcanic (thu·ªôc n√∫i l·ª≠a).`,
        'g3': `<b>D·ªãch:</b> ƒê·ªông ƒë·∫•t x·∫£y ra khi c√°c <u>m·∫£ng</u> ki·∫øn t·∫°o c·ªßa tr√°i ƒë·∫•t b·∫Øt ƒë·∫ßu di chuy·ªÉn...<br>
               <b>T·∫°i sao ƒê√öNG:</b> <i>Plates</i> (m·∫£ng ki·∫øn t·∫°o). Collocation: "Tectonic plates" (m·∫£ng ki·∫øn t·∫°o) g√¢y ra ƒë·ªông ƒë·∫•t.<br>
               <b>T·ª´ kh√°c:</b> Twister (l·ªëc xo√°y), Mudslide (l≈© b√πn).`,
        'g4': `<b>D·ªãch:</b> Khi m·ª±c n∆∞·ªõc bi·ªÉn d√¢ng, nguy c∆° <u>l≈© l·ª•t</u> tƒÉng l√™n.<br>
               <b>T·∫°i sao ƒê√öNG:</b> <i>Flooding</i> (ng·∫≠p l·ª•t). Ng·ªØ c·∫£nh "water covers the land" (n∆∞·ªõc bao ph·ªß ƒë·∫•t) v√† "sea levels rise".<br>
               <b>T·ª´ kh√°c:</b> Avalanche (tuy·∫øt l·ªü), Famine (n·∫°n ƒë√≥i).`,
        'g5': `<b>D·ªãch:</b> B√£o ƒë∆∞·ª£c g√¢y ra b·ªüi √°p su·∫•t th·∫•p... v√† <u>d·∫´n ƒë·∫øn</u> gi√≥ m·∫°nh.<br>
               <b>T·∫°i sao ƒê√öNG:</b> C·∫•u tr√∫c <i>result in</i> (d·∫´n ƒë·∫øn, g√¢y ra).<br>
               <b>T·ª´ kh√°c:</b> C√°c danh t·ª´ kh√°c kh√¥ng h·ª£p ng·ªØ ph√°p ƒë·ªông t·ª´ ·ªü ƒë√¢y.`,
        'g6': `<b>D·ªãch:</b> Khi ƒë·∫•t tr√™n s∆∞·ªùn d·ªëc b·ªã ∆∞·ªõt, m·ªôt tr·∫≠n <u>l≈© b√πn</u> c√≥ th·ªÉ x·∫£y ra.<br>
               <b>T·∫°i sao ƒê√öNG:</b> <i>Mudslide</i> (l≈© b√πn). Ng·ªØ c·∫£nh "soil... is wet" (ƒë·∫•t ∆∞·ªõt) v√† "slope" (s∆∞·ªùn d·ªëc).<br>
               <b>T·ª´ kh√°c:</b> Volcanic (n√∫i l·ª≠a), Twister (l·ªëc xo√°y).`,
        'g7': `<b>D·ªãch:</b> M·ªôt c∆°n l·ªëc xo√°y, th∆∞·ªùng ƒë∆∞·ª£c g·ªçi l√† <u>twister</u>...<br>
               <b>T·∫°i sao ƒê√öNG:</b> <i>Twister</i> l√† t√™n g·ªçi th√¥ng th∆∞·ªùng (informal) c·ªßa <i>Tornado</i>.<br>
               <b>T·ª´ kh√°c:</b> Plates (m·∫£ng), Famine (n·∫°n ƒë√≥i).`,
        'g8': `<b>D·ªãch:</b> Nh·ªØng s·ª± phun tr√†o <u>n√∫i l·ª≠a</u> g√¢y ra b·ªüi c√°c m·∫£ng ki·∫øn t·∫°o...<br>
               <b>T·∫°i sao ƒê√öNG:</b> <i>Volcanic eruptions</i> (phun tr√†o n√∫i l·ª≠a). Ng·ªØ c·∫£nh "magma" (dung nham).<br>
               <b>T·ª´ kh√°c:</b> C√°c t·ª´ kh√°c kh√¥ng ƒëi v·ªõi "eruptions".`,
        
        // True/False
        'tf1': `<b>D·ªãch c√¢u h·ªèi:</b> B√£o Linda ƒë√°nh v√†o mi·ªÅn B·∫Øc ng√†y 2/11/1997.<br>
                <b>ƒê√°p √°n: FALSE</b>.<br>
                <b>D·∫´n ch·ª©ng:</b> B√†i ƒë·ªçc n√≥i "storm Linda raged in the <u>south</u>" (ho√†nh h√†nh ·ªü mi·ªÅn Nam), v√† "most of which occur in the central and northern... HOWEVER... Linda raged in the south".`,
        'tf2': `<b>D·ªãch c√¢u h·ªèi:</b> Linda l√† c∆°n b√£o t·ªá nh·∫•t ·ªü Vi·ªát Nam trong 100 nƒÉm qua.<br>
                <b>ƒê√°p √°n: FALSE</b> (Ch√≠nh x√°c ph·∫£i l√† Nam Vi·ªát Nam).<br>
                <b>D·∫´n ch·ª©ng:</b> "Linda was the worst typhoon in <u>southern Vietnam</u> over 100 years." (Ch·ªâ t√≠nh ri√™ng mi·ªÅn Nam, kh√¥ng ph·∫£i to√†n b·ªô VN).`,
        'tf3': `<b>D·ªãch c√¢u h·ªèi:</b> T·ª´ Philippines, b√£o di chuy·ªÉn v·ªÅ ph√≠a t√¢y v√† ƒë√°nh v√†o Nam VN v·ªõi gi√≥ 100km/h.<br>
                <b>ƒê√°p √°n: TRUE</b>.<br>
                <b>D·∫´n ch·ª©ng:</b> "Formed in the sea of the Philippines... moved westward... struck extreme southern Vietnam with winds of 100 kilometres an hour."`,
        'tf4': `<b>D·ªãch c√¢u h·ªèi:</b> Kho·∫£ng 3,000 ng∆∞·ªùi ƒë√£ thi·ªát m·∫°ng.<br>
                <b>ƒê√°p √°n: TRUE</b>.<br>
                <b>D·∫´n ch·ª©ng:</b> "Over 3000 people were reported lost and died."`,
        'tf5': `<b>D·ªãch c√¢u h·ªèi:</b> T·ªânh C√† Mau b·ªã ·∫£nh h∆∞·ªüng tr·ª±c ti·∫øp.<br>
                <b>ƒê√°p √°n: TRUE</b>.<br>
                <b>D·∫´n ch·ª©ng:</b> "Ca Mau province, suffered a direct hit by the storm..."`,
        'tf6': `<b>D·ªãch c√¢u h·ªèi:</b> B√£o Linda g√¢y thi·ªát h·∫°i l·ªõn c·∫£ v·ªÅ t√†i s·∫£n v√† con ng∆∞·ªùi.<br>
                <b>ƒê√°p √°n: TRUE</b>.<br>
                <b>D·∫´n ch·ª©ng:</b> B√†i li·ªát k√™: destroyed crops, damaged houses (t√†i s·∫£n) v√† died, homeless (con ng∆∞·ªùi).`,
        'tf7': `<b>D·ªãch c√¢u h·ªèi:</b> B√£o Linda ch·ªâ ƒë√°nh v√†o Vi·ªát Nam v√† Th√°i Lan.<br>
                <b>ƒê√°p √°n: FALSE</b>.<br>
                <b>D·∫´n ch·ª©ng:</b> "The storm also affected Myanmar, Indonesia, Malaysia, and Cambodia..." (N√≥ c≈©ng ·∫£nh h∆∞·ªüng c√°c n∆∞·ªõc kh√°c).`,
        'tf8': `<b>D·ªãch c√¢u h·ªèi:</b> C∆°n b√£o y·∫øu d·∫ßn khi ƒëi qua Myanmar.<br>
                <b>ƒê√°p √°n: FALSE</b>.<br>
                <b>Gi·∫£i th√≠ch:</b> B√†i ƒë·ªçc ch·ªâ n√≥i "affected Myanmar... to a lesser degree" (·∫£nh h∆∞·ªüng m·ª©c ƒë·ªô nh·∫π h∆°n), kh√¥ng kh·∫≥ng ƒë·ªãnh b√£o "gradually weakened" (y·∫øu d·∫ßn) khi ƒëi qua ƒë√≥. Th√¥ng tin kh√¥ng ƒë·ªß ho·∫∑c sai ng·ªØ c·∫£nh.`,

        // MCQ
        'mc1': `<b>D·ªãch:</b> M√πa b√£o ·ªü Vi·ªát Nam l√† khi n√†o?<br>
                <b>A.</b> 1-4; <b>B.</b> 6 ƒë·∫øn cu·ªëi 11; <b>C.</b> 5-10; <b>D.</b> 12-2.<br>
                <b>Ch·ªçn B.</b> D·∫´n ch·ª©ng: "Vietnam usually has a dozen storms every year <u>from June through the end of November</u>".`,
        'mc2': `<b>D·ªãch:</b> B√£o Linda ƒë√°nh v√†o ƒë√¢u?<br>
                <b>A.</b> Mi·ªÅn B·∫Øc; <b>B.</b> Mi·ªÅn Trung; <b>C.</b> C·ª±c Nam; <b>D.</b> Ch·ªâ ƒêBSCL.<br>
                <b>Ch·ªçn C.</b> D·∫´n ch·ª©ng: "it struck <u>extreme southern</u> Vietnam".`,
        'mc3': `<b>D·ªãch:</b> T·ªëc ƒë·ªô gi√≥ c·ªßa b√£o Linda khi v√†o mi·ªÅn Nam?<br>
                <b>A.</b> 200km/h; <b>B.</b> 164km/h; <b>C.</b> 100km/h; <b>D.</b> 3000km/h.<br>
                <b>Ch·ªçn C.</b> D·∫´n ch·ª©ng: "winds of <u>100 kilometres</u> an hour". (S·ªë 164 l√† s·ªë ng∆∞·ªùi ch·∫øt ·ªü Th√°i Lan, 3000 l√† ng∆∞·ªùi ch·∫øt ·ªü VN).`,
        'mc4': `<b>D·ªãch:</b> Bao nhi√™u ng√¥i nh√† b·ªã h∆∞ h·∫°i/ph√° h·ªßy?<br>
                <b>A.</b> 3,000; <b>B.</b> 200,000; <b>C.</b> 383,000; <b>D.</b> 100.<br>
                <b>Ch·ªçn B.</b> D·∫´n ch·ª©ng: "damaged about <u>200,000 houses</u>". (383,000 l√† s·ªë ng∆∞·ªùi m·∫•t nh√†).`,
        'mc5': `<b>D·ªãch:</b> B√£o Linda ƒëi qua ƒë√¢u sau khi ƒë√°nh v√†o VN?<br>
                <b>A.</b> Philippines; <b>B.</b> Indonesia; <b>C.</b> Th√°i Lan; <b>D.</b> Malaysia.<br>
                <b>Ch·ªçn C.</b> D·∫´n ch·ª©ng: "Linda later struck <u>Thailand</u>".`,
        'mc6': `<b>D·ªãch:</b> M·ªçi ng∆∞·ªùi h·ªçc ƒë∆∞·ª£c g√¨ t·ª´ b√£o Linda?<br>
                <b>A.</b> C√°ch d·ª´ng thi√™n tai; <b>B.</b> N√¢ng cao nh·∫≠n th·ª©c; <b>C.</b> B√£o kh√¥ng bao gi·ªù v√†o mi·ªÅn Nam; <b>D.</b> D·ª± b√°o th·ªùi ti·∫øt.<br>
                <b>Ch·ªçn B.</b> D·∫´n ch·ª©ng: "The memory... <u>improves everyone‚Äôs awareness</u> of natural disasters".`
    };

    let currentGapId = '';

    // --- SOUND EFFECTS (Web Audio API) ---
    const audioCtx = new (window.AudioContext || window.webkitAudioContext)();
    function playSound(type) {
        if (audioCtx.state === 'suspended') audioCtx.resume();
        const osc = audioCtx.createOscillator();
        const gain = audioCtx.createGain();
        osc.connect(gain);
        gain.connect(audioCtx.destination);

        if (type === 'correct') {
            osc.type = 'sine';
            osc.frequency.setValueAtTime(600, audioCtx.currentTime);
            osc.frequency.exponentialRampToValueAtTime(1200, audioCtx.currentTime + 0.1);
            gain.gain.setValueAtTime(0.3, audioCtx.currentTime);
            gain.gain.exponentialRampToValueAtTime(0.01, audioCtx.currentTime + 0.5);
            osc.start();
            osc.stop(audioCtx.currentTime + 0.5);
        } else {
            osc.type = 'sawtooth';
            osc.frequency.setValueAtTime(150, audioCtx.currentTime);
            osc.frequency.linearRampToValueAtTime(100, audioCtx.currentTime + 0.3);
            gain.gain.setValueAtTime(0.3, audioCtx.currentTime);
            gain.gain.linearRampToValueAtTime(0.01, audioCtx.currentTime + 0.3);
            osc.start();
            osc.stop(audioCtx.currentTime + 0.3);
        }
    }

    // --- CONFETTI ---
    const canvas = document.getElementById('confetti-canvas');
    const ctx = canvas.getContext('2d');
    canvas.width = window.innerWidth;
    canvas.height = window.innerHeight;
    let confetti = [];

    function fireConfetti() {
        for(let i=0; i<50; i++) {
            confetti.push({
                x: Math.random() * canvas.width,
                y: Math.random() * canvas.height - canvas.height,
                color: ['#ff4757', '#2ed573', '#1e90ff', '#ffa502'][Math.floor(Math.random()*4)],
                size: Math.random() * 10 + 5,
                speed: Math.random() * 5 + 2,
                angle: Math.random() * 6
            });
        }
        animateConfetti();
    }

    function animateConfetti() {
        ctx.clearRect(0,0, canvas.width, canvas.height);
        confetti.forEach((p, index) => {
            p.y += p.speed;
            p.x += Math.sin(p.angle);
            ctx.fillStyle = p.color;
            ctx.fillRect(p.x, p.y, p.size, p.size);
            if(p.y > canvas.height) confetti.splice(index, 1);
        });
        if(confetti.length > 0) requestAnimationFrame(animateConfetti);
    }

    // --- GAP FILL LOGIC ---
    function openGapModal(id, correctAnswer) {
        currentGapId = id;
        const modal = document.getElementById('gapModal');
        const container = document.getElementById('modalOptions');
        container.innerHTML = '';
        
        allWords.forEach(word => {
            const btn = document.createElement('button');
            btn.className = 'modal-btn';
            btn.innerText = word;
            btn.onclick = () => fillGap(word, correctAnswer);
            container.appendChild(btn);
        });
        
        modal.style.display = 'flex';
    }

    function fillGap(selectedWord, correctAnswer) {
        document.getElementById('gapModal').style.display = 'none';
        const gap = document.querySelector(`.gap-input[data-id="${currentGapId}"]`);
        gap.innerText = selectedWord;
        
        const expBox = document.getElementById(`exp-${currentGapId}`);
        expBox.style.display = 'block';
        
        if (selectedWord === correctAnswer) {
            gap.classList.add('correct');
            gap.classList.remove('wrong');
            playSound('correct');
            fireConfetti();
            expBox.innerHTML = `<div class="exp-title" style="color:#00D26A">‚úÖ Ch√≠nh x√°c!</div>` + explanations[currentGapId];
        } else {
            gap.classList.add('wrong');
            gap.classList.remove('correct');
            playSound('wrong');
            expBox.innerHTML = `<div class="exp-title" style="color:#FF4757">‚ùå Ch∆∞a ƒë√∫ng r·ªìi!</div>` + explanations[currentGapId];
        }
    }

    // --- MCQ & TF LOGIC ---
    function checkMCQ(btn, choice, qId) {
        const parent = btn.parentElement.parentElement; // .question-block
        const correctAnswer = parent.getAttribute('data-correct');
        const expBox = document.getElementById(`exp-${qId}`);
        const allBtns = parent.querySelectorAll('.option-btn');

        // Disable clicks immediately to prevent multiple selects if desired, 
        // OR allow changing mind. Request implies immediate feedback.
        // Let's reset styles first to allow re-selection
        allBtns.forEach(b => {
            b.classList.remove('correct', 'wrong');
            // b.disabled = true; // Uncomment if one-time choice
        });

        expBox.style.display = 'block';

        if (choice === correctAnswer) {
            btn.classList.add('correct');
            playSound('correct');
            fireConfetti();
            expBox.innerHTML = `<div class="exp-title" style="color:#00D26A">‚úÖ Ch√≠nh x√°c! (C√¥ Mai An khen em)</div>` + explanations[qId];
        } else {
            btn.classList.add('wrong');
            playSound('wrong');
            // Highlight correct answer if wrong? Maybe better to let them try again or just show explain.
            // Requirement says "Show explanation immediately". The explanation contains the answer.
            expBox.innerHTML = `<div class="exp-title" style="color:#FF4757">‚ùå ·ªí ti·∫øc qu√°! (C√¥ Mai An gi·∫£i th√≠ch n√®)</div>` + explanations[qId];
        }
    }

    // --- FINISH ---
    function finishTest() {
        const correctCount = document.querySelectorAll('.correct').length;
        // Total questions: 8 gaps + 8 TF + 6 MCQ = 22
        const total = 22;
        let msg = "";
        if (correctCount === total) msg = "ƒê·ªânh c·ªßa ch√≥p! Em l√† thi√™n t√†i! üèÜ";
        else if (correctCount > 15) msg = "L√†m r·∫•t t·ªët! C·ªë th√™m ch√∫t n·ªØa l√† ho√†n h·∫£o! üåü";
        else msg = "C·∫ßn c·ªë g·∫Øng h∆°n nh√©! ƒê·ªçc k·ªπ gi·∫£i th√≠ch c·ªßa c√¥ nha! üí™";

        alert(`Em ƒë√£ ho√†n th√†nh b√†i thi!\nƒêi·ªÉm s·ªë: ${correctCount}/${total}\n${msg}`);
    }

</script>

</body>
</html>