<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>B√†i Ki·ªÉm Tra Ti·∫øng Anh - Ms Mai An ULIS</title>
    <link href="https://fonts.googleapis.com/css2?family=Nunito:wght@400;600;800&display=swap" rel="stylesheet">
    <style>
        :root {
            /* T·ª± ƒë·ªông t·∫°o b·∫£ng m√†u theo ch·ªß ƒë·ªÅ M√¥i tr∆∞·ªùng (Environment/Trees) */
            --primary-color: #2e7d32; /* Xanh l√° r·ª´ng */
            --secondary-color: #0288d1; /* Xanh da tr·ªùi */
            --correct-color: #00D26A; /* Xanh l√° - ƒê√∫ng */
            --wrong-color: #FF4757; /* ƒê·ªè - Sai */
            --bg-light: #e8f5e9;
            --text-dark: #2d3436;
            --card-bg: #ffffff;
        }

        * {
            box-sizing: border-box;
            margin: 0;
            padding: 0;
            font-family: 'Nunito', sans-serif;
        }

        body {
            /* T·ª± ƒë·ªông t·∫°o n·ªÅn SVG Background ch·ªß ƒë·ªÅ M√¥i tr∆∞·ªùng */
            background: radial-gradient(circle at top left, rgba(2, 136, 209, 0.8) 0%, rgba(46, 125, 50, 0.9) 100%),
                        url('data:image/svg+xml;utf8,<svg xmlns="http://www.w3.org/2000/svg" width="120" height="120" opacity="0.15"><text x="10" y="40" font-size="30">üåç</text><text x="70" y="80" font-size="30">üå≥</text><text x="30" y="100" font-size="25">‚òÄÔ∏è</text></svg>');
            color: var(--text-dark);
            height: 100vh;
            overflow: hidden;
            display: flex;
            flex-direction: column;
        }

        /* Top Control Bar */
        .top-bar {
            background-color: var(--card-bg);
            padding: 12px 25px;
            display: flex;
            justify-content: space-between;
            align-items: center;
            box-shadow: 0 4px 15px rgba(0,0,0,0.15);
            z-index: 10;
        }

        .header-title {
            font-size: 15px;
            font-weight: 800;
            color: var(--primary-color);
            background: #c8e6c9;
            padding: 6px 18px;
            border-radius: 20px;
            text-transform: uppercase;
            letter-spacing: 1px;
            border: 2px solid #a5d6a7;
        }

        .timer-container {
            display: flex;
            align-items: center;
            gap: 15px;
        }

        .timer-display {
            font-size: 24px;
            font-weight: 800;
            color: #d35400;
            background: #ffeaa7;
            padding: 5px 20px;
            border-radius: 12px;
            border: 2px solid #fdcb6e;
            box-shadow: inset 0 2px 5px rgba(0,0,0,0.1);
        }

        .btn-timer {
            background: var(--secondary-color);
            color: white;
            border: none;
            padding: 10px 20px;
            font-size: 15px;
            font-weight: 800;
            border-radius: 12px;
            cursor: pointer;
            box-shadow: 0 5px 0 #01579b;
            transition: all 0.1s;
        }

        .btn-timer:active {
            transform: translateY(5px);
            box-shadow: 0 0 0 #01579b;
        }

        /* Split Screen Layout */
        .split-container {
            display: flex;
            flex: 1;
            overflow: hidden;
        }

        .panel {
            flex: 1;
            padding: 25px;
            overflow-y: auto;
            scroll-behavior: smooth;
        }

        .left-panel {
            background-color: rgba(255, 255, 255, 0.95);
            border-right: 5px dashed var(--primary-color);
        }

        .right-panel {
            background-color: transparent;
            padding: 20px 40px;
        }

        /* Reading Passage Styles */
        .passage-title {
            font-size: 24px;
            color: var(--primary-color);
            margin-bottom: 15px;
            text-transform: uppercase;
            border-bottom: 3px solid var(--secondary-color);
            display: inline-block;
            padding-bottom: 5px;
            margin-top: 20px;
        }

        .passage-content p {
            font-size: 18px;
            line-height: 1.8;
            margin-bottom: 15px;
            text-align: justify;
        }

        .btn-translate {
            background: #f1c40f;
            color: #2c3e50;
            border: none;
            padding: 8px 15px;
            font-size: 13px;
            font-weight: 800;
            border-radius: 12px;
            cursor: pointer;
            box-shadow: 0 4px 0 #f39c12;
            margin-bottom: 20px;
            transition: transform 0.1s;
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .btn-translate:active {
            transform: translateY(4px);
            box-shadow: none;
        }

        .translation-box {
            display: none;
            background: #fff9c4;
            padding: 18px;
            border-left: 6px solid #fbc02d;
            border-radius: 10px;
            font-size: 16px;
            margin-bottom: 25px;
            font-style: italic;
            line-height: 1.6;
        }

        /* Glossary Table */
        .glossary-container {
            margin-top: 40px;
            background: white;
            border-radius: 15px;
            padding: 20px;
            box-shadow: 0 5px 20px rgba(0,0,0,0.1);
            border: 2px solid var(--primary-color);
        }

        .glossary-title {
            font-size: 22px;
            font-weight: 800;
            color: var(--primary-color);
            margin-bottom: 15px;
            text-align: center;
        }

        table {
            width: 100%;
            border-collapse: collapse;
            font-size: 16px;
        }

        th, td {
            padding: 12px;
            border: 1px solid #e0e0e0;
            text-align: left;
        }

        th {
            background-color: var(--primary-color);
            color: white;
            font-weight: 800;
        }
        
        tr:nth-child(even) {
            background-color: #f1f8e9;
        }

        /* Exercise Cards (Right Panel) */
        .question-card {
            background: var(--card-bg);
            border-radius: 20px;
            padding: 25px;
            margin-bottom: 30px;
            box-shadow: 0 8px 0 rgba(0,0,0,0.1);
            position: relative;
            border: 2px solid transparent;
        }

        .question-text {
            font-size: 20px;
            font-weight: 800;
            margin-bottom: 20px;
            color: var(--text-dark);
        }

        .options-grid {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 15px;
        }

        .option-btn {
            background: #f5f6fa;
            border: 2px solid #dcdde1;
            padding: 15px;
            font-size: 18px;
            font-weight: 700;
            border-radius: 15px;
            cursor: pointer;
            text-align: left;
            box-shadow: 0 5px 0 #dcdde1;
            transition: all 0.2s ease;
            color: var(--text-dark);
        }

        .option-btn:hover {
            transform: scale(1.02);
            border-color: var(--secondary-color);
        }

        .option-btn:active {
            transform: translateY(5px) scale(1);
            box-shadow: 0 0 0 transparent;
        }

        .option-btn.correct {
            background: var(--correct-color);
            border-color: #00b85c;
            color: white;
            box-shadow: 0 5px 0 #00b85c;
        }

        .option-btn.wrong {
            background: var(--wrong-color);
            border-color: #ff3040;
            color: white;
            box-shadow: 0 5px 0 #ff3040;
        }
        
        /* Interactive Reveal Blanks */
        .reveal-btn {
            display: inline-block;
            background: #dfe6e9;
            color: #636e72;
            border: 2px dashed #b2bec3;
            padding: 5px 15px;
            border-radius: 10px;
            cursor: pointer;
            font-weight: 800;
            margin: 0 5px;
            transition: all 0.3s;
            box-shadow: 0 3px 0 #b2bec3;
        }
        
        .reveal-btn:hover {
            background: #ffeaa7;
            border-color: #fdcb6e;
            color: #d35400;
        }
        
        .reveal-btn.revealed {
            background: var(--correct-color);
            color: white;
            border: 2px solid #00b85c;
            box-shadow: 0 3px 0 #00b85c;
            transform: scale(1.1);
            cursor: default;
        }

        /* Shake Animation */
        @keyframes shake {
            0% { transform: translateX(0); }
            25% { transform: translateX(-8px); }
            50% { transform: translateX(8px); }
            75% { transform: translateX(-8px); }
            100% { transform: translateX(0); }
        }

        .shake {
            animation: shake 0.4s ease-in-out;
        }

        /* Explanations */
        .explanation-box {
            display: none;
            margin-top: 20px;
            padding: 20px;
            background: #f1f8e9;
            border: 2px solid var(--primary-color);
            border-radius: 15px;
            animation: fadeIn 0.5s ease-in;
        }

        .explanation-box h4 {
            color: var(--primary-color);
            margin-bottom: 10px;
            font-size: 18px;
            font-weight: 800;
        }

        .explanation-box p, .explanation-box ul {
            font-size: 16px;
            line-height: 1.6;
            margin-bottom: 10px;
        }

        .explanation-box ul {
            padding-left: 20px;
        }

        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(-10px); }
            to { opacity: 1; transform: translateY(0); }
        }

        /* Submit Button */
        .btn-submit {
            display: block;
            width: 100%;
            background: linear-gradient(135deg, #ff9f43, #ff6b6b);
            color: white;
            border: none;
            padding: 20px;
            font-size: 24px;
            font-weight: 800;
            border-radius: 20px;
            cursor: pointer;
            box-shadow: 0 8px 0 #ee5253;
            margin-top: 20px;
            margin-bottom: 50px;
            transition: all 0.2s;
            text-transform: uppercase;
            letter-spacing: 2px;
        }

        .btn-submit:active {
            transform: translateY(8px);
            box-shadow: none;
        }

        /* Modal Overlay */
        .modal-overlay {
            display: none;
            position: fixed;
            top: 0; left: 0; width: 100%; height: 100%;
            background: rgba(0,0,0,0.85);
            z-index: 100;
            justify-content: center;
            align-items: center;
        }

        .modal-content {
            background: white;
            padding: 40px;
            border-radius: 30px;
            text-align: center;
            max-width: 500px;
            box-shadow: 0 10px 40px rgba(0,0,0,0.6);
            animation: scaleUp 0.4s cubic-bezier(0.175, 0.885, 0.32, 1.275);
            border: 5px solid var(--primary-color);
        }

        @keyframes scaleUp {
            from { transform: scale(0.5); opacity: 0; }
            to { transform: scale(1); opacity: 1; }
        }

        .modal-content h2 {
            font-size: 36px;
            color: var(--primary-color);
            margin-bottom: 15px;
            font-weight: 800;
        }

        .score-display {
            font-size: 65px;
            font-weight: 900;
            color: var(--secondary-color);
            margin: 20px 0;
            text-shadow: 2px 2px 0px #b2bec3;
        }

        .feedback-msg {
            font-size: 20px;
            color: #2d3436;
            margin-bottom: 30px;
            font-weight: 600;
        }

        .btn-close-modal {
            background: var(--correct-color);
            color: white;
            border: none;
            padding: 15px 35px;
            font-size: 20px;
            font-weight: 800;
            border-radius: 15px;
            cursor: pointer;
            box-shadow: 0 6px 0 #00b85c;
            text-transform: uppercase;
        }

        /* Canvas for Confetti */
        #confetti-canvas {
            position: fixed;
            top: 0; left: 0; width: 100%; height: 100%;
            pointer-events: none;
            z-index: 999;
        }
        
        /* Section Dividers in Quiz */
        .quiz-section-title {
            background: var(--secondary-color);
            color: white;
            padding: 10px 20px;
            border-radius: 15px;
            margin: 30px 0 20px 0;
            font-size: 22px;
            font-weight: 800;
            text-align: center;
            box-shadow: 0 4px 0 #01579b;
        }

        @media (max-width: 900px) {
            .split-container { flex-direction: column; overflow-y: auto; }
            .panel { width: 100%; overflow-y: visible; }
            .left-panel { border-right: none; border-bottom: 5px dashed var(--primary-color); }
        }
    </style>
</head>
<body>

    <canvas id="confetti-canvas"></canvas>

    <div class="top-bar">
        <div class="header-title">üë®‚Äçüè´ Gi√°o vi√™n t·∫°o: Ms Mai An ULIS</div>
        <div class="timer-container">
            <div class="timer-display" id="timer">10:00</div>
            <button class="btn-timer" id="btn-timer-toggle" onclick="toggleTimer()">‚ñ∂ B·∫ÆT ƒê·∫¶U T√çNH GI·ªú</button>
        </div>
    </div>

    <div class="split-container">
        <div class="panel left-panel">
            
            <h1 class="passage-title">üåø Passage 1: Global Warming</h1>
            <div class="passage-content">
                <p>One of the most important reasons for global warming is air (1) .......... . More and more factories are being built in different countries. By burning oil, coal, gasoline, even natural gas, they add more carbon dioxide to the (2) .......... . Cars also influence the atmosphere badly (3) .......... burning many liters of oil and releasing (4) .......... gases into the air. As a result, the ozone layer of our Earth is being (5) .......... .</p>
                <p>All these activities unfavourably change (6) .......... Earth‚Äôs heat balance. This is (7) .......... we get in return: the (8) .......... becomes very dry, a lot of rivers and lakes dry up, the forests start burning, the glaciers melt, people and animals start to faint. And these are not all the outcomes of global (9) .......... . Nature becomes really angry with us. We need to be more attentive and caring to it if we want to (10) .......... our planet.</p>
                
                <button class="btn-translate" onclick="toggleTranslate('trans1')">üáªüá≥ M·ªû KH√ìA B·∫¢N D·ªäCH ƒêO·∫†N 1</button>
                <div id="trans1" class="translation-box">
                    M·ªôt trong nh·ªØng nguy√™n nh√¢n quan tr·ªçng nh·∫•t g√¢y ra hi·ªán t∆∞·ª£ng n√≥ng l√™n to√†n c·∫ßu l√† √¥ nhi·ªÖm kh√¥ng kh√≠. Ng√†y c√†ng c√≥ nhi·ªÅu nh√† m√°y ƒë∆∞·ª£c x√¢y d·ª±ng ·ªü c√°c qu·ªëc gia kh√°c nhau. B·∫±ng c√°ch ƒë·ªët d·∫ßu, than ƒë√°, xƒÉng, th·∫≠m ch√≠ c·∫£ kh√≠ t·ª± nhi√™n, ch√∫ng th·∫£i th√™m nhi·ªÅu kh√≠ cacbonic v√†o b·∫ßu kh√≠ quy·ªÉn. √î t√¥ c≈©ng ·∫£nh h∆∞·ªüng x·∫•u ƒë·∫øn b·∫ßu kh√≠ quy·ªÉn b·∫±ng vi·ªác ƒë·ªët ch√°y nhi·ªÅu l√≠t d·∫ßu v√† th·∫£i ra c√°c kh√≠ ƒë·ªôc h·∫°i v√†o kh√¥ng kh√≠. H·∫≠u qu·∫£ l√†, t·∫ßng √¥-z√¥n c·ªßa Tr√°i ƒë·∫•t ch√∫ng ta ƒëang b·ªã ph√° h·ªßy.<br><br>
                    T·∫•t c·∫£ nh·ªØng ho·∫°t ƒë·ªông n√†y l√†m thay ƒë·ªïi m·ªôt c√°ch b·∫•t l·ª£i s·ª± c√¢n b·∫±ng nhi·ªát c·ªßa Tr√°i ƒë·∫•t. ƒê√¢y l√† nh·ªØng g√¨ ch√∫ng ta nh·∫≠n l·∫°i: m·∫∑t ƒë·∫•t tr·ªü n√™n r·∫•t kh√¥ c·∫±n, nhi·ªÅu s√¥ng h·ªì c·∫°n ki·ªát, r·ª´ng b·∫Øt ƒë·∫ßu b·ªëc ch√°y, c√°c d√≤ng s√¥ng bƒÉng tan ch·∫£y, con ng∆∞·ªùi v√† ƒë·ªông v·∫≠t b·∫Øt ƒë·∫ßu ng·∫•t ƒëi v√¨ ki·ªát s·ª©c. V√† ƒë√≥ ch∆∞a ph·∫£i l√† t·∫•t c·∫£ h·∫≠u qu·∫£ c·ªßa hi·ªán t∆∞·ª£ng n√≥ng l√™n to√†n c·∫ßu. Thi√™n nhi√™n ƒëang th·ª±c s·ª± n·ªïi gi·∫≠n v·ªõi ch√∫ng ta. Ch√∫ng ta c·∫ßn ph·∫£i ch√∫ √Ω v√† quan t√¢m ƒë·∫øn n√≥ nhi·ªÅu h∆°n n·∫øu mu·ªën c·ª©u l·∫•y h√†nh tinh c·ªßa m√¨nh.
                </div>
            </div>

            <h1 class="passage-title" style="margin-top: 30px;">üå≥ Passage 2: The Power of Trees</h1>
            <div class="passage-content">
                <p>Nothing on earth is more majestic than a tall, spreading tree. Trees are our friends in our fight for a healthier planet. This is how they help us. First, trees are the Earth‚Äôs lungs. They remove pollutants from the air and significantly improve air quality. Research shows that with billions of trees, we could remove two-thirds of all the carbon dioxide created by human activities. Second, trees reduce the run off of rainwater, so they can reduce flooding. Moreover, if you enjoy sitting in the shade of a tree in the summer, you know that trees can also lower air temperatures too. Trees growing beside a home can cool the root and the air around the house. Therefore, it reduces air conditioning costs. And don‚Äôt forget that trees create habitats for many species of plants and animals. If you want to plant trees to help save the planet, there are simple ways to get started. Plant trees around your house. If enough people did that, it would make a big difference.</p>
                
                <button class="btn-translate" onclick="toggleTranslate('trans2')">üáªüá≥ M·ªû KH√ìA B·∫¢N D·ªäCH ƒêO·∫†N 2</button>
                <div id="trans2" class="translation-box">
                    Kh√¥ng c√≥ g√¨ tr√™n tr√°i ƒë·∫•t n√†y tr√°ng l·ªá h∆°n m·ªôt c√°i c√¢y cao l·ªõn, t·ªèa b√≥ng m√°t. C√¢y c·ªëi l√† nh·ªØng ng∆∞·ªùi b·∫°n c·ªßa ch√∫ng ta trong cu·ªôc chi·∫øn v√¨ m·ªôt h√†nh tinh kh·ªèe m·∫°nh h∆°n. ƒê√¢y l√† c√°ch ch√∫ng gi√∫p ƒë·ª° ch√∫ng ta. ƒê·∫ßu ti√™n, c√¢y xanh l√† l√° ph·ªïi c·ªßa Tr√°i ƒë·∫•t. Ch√∫ng lo·∫°i b·ªè c√°c ch·∫•t √¥ nhi·ªÖm kh·ªèi kh√¥ng kh√≠ v√† c·∫£i thi·ªán ƒë√°ng k·ªÉ ch·∫•t l∆∞·ª£ng kh√¥ng kh√≠. Nghi√™n c·ª©u cho th·∫•y v·ªõi h√†ng t·ª∑ c√¢y xanh, ch√∫ng ta c√≥ th·ªÉ lo·∫°i b·ªè 2/3 l∆∞·ª£ng kh√≠ cacbonic do c√°c ho·∫°t ƒë·ªông c·ªßa con ng∆∞·ªùi t·∫°o ra. Th·ª© hai, c√¢y c·ªëi l√†m gi·∫£m d√≤ng ch·∫£y tr√†n c·ªßa n∆∞·ªõc m∆∞a, v√¨ v·∫≠y ch√∫ng c√≥ th·ªÉ l√†m gi·∫£m ng·∫≠p l·ª•t. H∆°n n·ªØa, n·∫øu b·∫°n th√≠ch ng·ªìi d∆∞·ªõi b√≥ng r√¢m c·ªßa m·ªôt c√°i c√¢y v√†o m√πa h√®, b·∫°n s·∫Ω bi·∫øt r·∫±ng c√¢y c·ªëi c≈©ng c√≥ th·ªÉ l√†m gi·∫£m nhi·ªát ƒë·ªô kh√¥ng kh√≠. C√¢y m·ªçc b√™n c·∫°nh nh√† c√≥ th·ªÉ l√†m m√°t r·ªÖ c√¢y v√† kh√¥ng kh√≠ xung quanh ng√¥i nh√†. Do ƒë√≥, n√≥ l√†m gi·∫£m chi ph√≠ d√πng ƒëi·ªÅu h√≤a kh√¥ng kh√≠. V√† ƒë·ª´ng qu√™n r·∫±ng c√¢y c·ªëi t·∫°o ra m√¥i tr∆∞·ªùng s·ªëng cho nhi·ªÅu lo√†i th·ª±c v·∫≠t v√† ƒë·ªông v·∫≠t. N·∫øu b·∫°n mu·ªën tr·ªìng c√¢y ƒë·ªÉ gi√∫p c·ª©u h√†nh tinh, c√≥ nh·ªØng c√°ch ƒë∆°n gi·∫£n ƒë·ªÉ b·∫Øt ƒë·∫ßu. H√£y tr·ªìng c√¢y xung quanh nh√† b·∫°n. N·∫øu c√≥ ƒë·ªß s·ªë ng∆∞·ªùi l√†m ƒëi·ªÅu ƒë√≥, n√≥ s·∫Ω t·∫°o ra m·ªôt s·ª± kh√°c bi·ªát l·ªõn.
                </div>
            </div>

            <div class="glossary-container">
                <div class="glossary-title">üìö Academic Glossary (B1-C2)</div>
                <table>
                    <thead>
                        <tr>
                            <th>T·ª´ v·ª±ng</th>
                            <th>T·ª´ lo·∫°i</th>
                            <th>Nghƒ©a ti·∫øng Vi·ªát</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr><td>1. Global warming</td><td>Noun Phrase</td><td>Hi·ªán t∆∞·ª£ng ·∫•m l√™n to√†n c·∫ßu</td></tr>
                        <tr><td>2. Atmosphere</td><td>Noun (n)</td><td>B·∫ßu kh√≠ quy·ªÉn</td></tr>
                        <tr><td>3. Carbon dioxide</td><td>Noun (n)</td><td>Kh√≠ CO2 (Cacbonic)</td></tr>
                        <tr><td>4. Ozone layer</td><td>Noun Phrase</td><td>T·∫ßng √¥-z√¥n</td></tr>
                        <tr><td>5. Glacier</td><td>Noun (n)</td><td>S√¥ng bƒÉng, t·∫£ng bƒÉng</td></tr>
                        <tr><td>6. Attentive</td><td>Adjective (adj)</td><td>Ch√∫ √Ω, l∆∞u t√¢m, √¢n c·∫ßn</td></tr>
                        <tr><td>7. Majestic</td><td>Adjective (adj)</td><td>Tr√°ng l·ªá, h√πng vƒ©</td></tr>
                        <tr><td>8. Pollutant</td><td>Noun (n)</td><td>Ch·∫•t g√¢y √¥ nhi·ªÖm</td></tr>
                        <tr><td>9. Significantly</td><td>Adverb (adv)</td><td>M·ªôt c√°ch ƒë√°ng k·ªÉ</td></tr>
                        <tr><td>10. Run-off</td><td>Noun (n)</td><td>D√≤ng ch·∫£y tr√†n (nh∆∞ n∆∞·ªõc m∆∞a)</td></tr>
                        <tr><td>11. Habitat</td><td>Noun (n)</td><td>M√¥i tr∆∞·ªùng s·ªëng t·ª± nhi√™n</td></tr>
                        <tr><td>12. Species</td><td>Noun (n)</td><td>Lo√†i (ƒë·ªông/th·ª±c v·∫≠t)</td></tr>
                    </tbody>
                </table>
            </div>
        </div>

        <div class="panel right-panel" id="quiz-container">
            </div>
    </div>

    <div class="modal-overlay" id="result-modal">
        <div class="modal-content">
            <h2>üéâ XU·∫§T S·∫ÆC! üéâ</h2>
            <div class="score-display" id="final-score">0/25</div>
            <div class="feedback-msg" id="feedback-msg">Loading...</div>
            <button class="btn-close-modal" onclick="closeModal()">Xem L·∫°i ƒê√°p √Ån</button>
        </div>
    </div>

    <script>
        // --- DATA B√ÄI T·∫¨P ---
        const clozeQuestions = [
            { id: 1, type: 'mcq', text: "1. One of the most important reasons for global warming is air (1) __________ .", options: [ {text: "pollute", correct: false}, {text: "polluted", correct: false}, {text: "pollution", correct: true}, {text: "polluting", correct: false} ], explanation: "<h4>Gi·∫£i th√≠ch:</h4><ul><li><b>T·ª´ v·ª±ng/Ng·ªØ ph√°p:</b> Ch√∫ng ta c·∫ßn m·ªôt danh t·ª´ ƒë·ªÉ k·∫øt h·ª£p v·ªõi 'air' t·∫°o th√†nh c·ª•m danh t·ª´. <b>Air pollution</b> (S·ª± √¥ nhi·ªÖm kh√¥ng kh√≠).</li><li>'Pollute' l√† ƒë·ªông t·ª´, 'polluted' l√† t√≠nh t·ª´ ph√¢n t·ª´ 2.</li></ul>" },
            { id: 2, type: 'mcq', text: "2. ...they add more carbon dioxide to the (2) __________ .", options: [ {text: "oil", correct: false}, {text: "coal", correct: false}, {text: "gasoline", correct: false}, {text: "atmosphere", correct: true} ], explanation: "<h4>Gi·∫£i th√≠ch:</h4><ul><li><b>Ng·ªØ nghƒ©a:</b> ƒê·ªët nhi√™n li·ªáu s·∫Ω th·∫£i kh√≠ CO2 v√†o <b>b·∫ßu kh√≠ quy·ªÉn (atmosphere)</b>. C√°c t·ª´ kh√°c: oil (d·∫ßu), coal (than), gasoline (xƒÉng) l√† ch·∫•t b·ªã ƒë·ªët, kh√¥ng ph·∫£i n∆°i ch·ª©a kh√≠ th·∫£i.</li></ul>" },
            { id: 3, type: 'mcq', text: "3. Cars also influence the atmosphere badly (3) __________ burning many liters of oil...", options: [ {text: "by", correct: true}, {text: "with", correct: false}, {text: "to", correct: false}, {text: "towards", correct: false} ], explanation: "<h4>Gi·∫£i th√≠ch:</h4><ul><li><b>Ng·ªØ ph√°p:</b> Gi·ªõi t·ª´ <b>By + V-ing</b> (B·∫±ng c√°ch l√†m g√¨ ƒë√≥). ·ªû ƒë√¢y l√† 'b·∫±ng c√°ch ƒë·ªët ch√°y...'.</li></ul>" },
            { id: 4, type: 'mcq', text: "4. ...and releasing (4) __________ gases into the air.", options: [ {text: "useful", correct: false}, {text: "harmful", correct: true}, {text: "delicious", correct: false}, {text: "good", correct: false} ], explanation: "<h4>Gi·∫£i th√≠ch:</h4><ul><li><b>Ng·ªØ nghƒ©a:</b> Xe c·ªô th·∫£i ra kh√≠ <b>ƒë·ªôc h·∫°i (harmful)</b> v√†o kh√¥ng kh√≠. C√°c t·ª´ kh√°c: useful (h·ªØu √≠ch), delicious (ngon mi·ªáng), good (t·ªët) mang nghƒ©a t√≠ch c·ª±c, kh√¥ng ph√π h·ª£p ng·ªØ c·∫£nh.</li></ul>" },
            { id: 5, type: 'mcq', text: "5. As a result, the ozone layer of our Earth is being (5) __________ .", options: [ {text: "destroyed", correct: true}, {text: "created", correct: false}, {text: "caused", correct: false}, {text: "increased", correct: false} ], explanation: "<h4>Gi·∫£i th√≠ch:</h4><ul><li><b>Ng·ªØ nghƒ©a:</b> T·∫ßng √¥-z√¥n ƒëang b·ªã <b>ph√° h·ªßy (destroyed)</b> do kh√≠ th·∫£i. (Created = t·∫°o ra, caused = g√¢y ra, increased = tƒÉng l√™n -> kh√¥ng h·ª£p l√Ω).</li></ul>" },
            { id: 6, type: 'mcq', text: "6. All these activities unfavourably change (6) __________ Earth‚Äôs heat balance.", options: [ {text: "an", correct: false}, {text: "a", correct: false}, {text: "√ò", correct: false}, {text: "the", correct: true} ], explanation: "<h4>Gi·∫£i th√≠ch:</h4><ul><li><b>Ng·ªØ ph√°p (M·∫°o t·ª´):</b> Tr√°i ƒë·∫•t (Earth) l√† danh t·ª´ duy nh·∫•t, do ƒë√≥ lu√¥n ph·∫£i d√πng m·∫°o t·ª´ x√°c ƒë·ªãnh <b>'the'</b> ƒë·ª©ng tr∆∞·ªõc. -> <i>the Earth</i>.</li></ul>" },
            { id: 7, type: 'mcq', text: "7. This is (7)__________ we get in return:", options: [ {text: "who", correct: false}, {text: "when", correct: false}, {text: "what", correct: true}, {text: "which", correct: false} ], explanation: "<h4>Gi·∫£i th√≠ch:</h4><ul><li><b>Ng·ªØ ph√°p (M·ªánh ƒë·ªÅ danh ng·ªØ):</b> 'This is <b>what</b> we get...' d·ªãch l√† 'ƒê√¢y l√† <b>nh·ªØng g√¨</b> ch√∫ng ta nh·∫≠n l·∫°i'. ƒê·∫°i t·ª´ 'what' ƒë√≥ng vai tr√≤ l√†m t√¢n ng·ªØ cho ƒë·ªông t·ª´ 'get'.</li></ul>" },
            { id: 8, type: 'mcq', text: "8. ...the (8) __________ becomes very dry, a lot of rivers and lakes dry up...", options: [ {text: "ground", correct: true}, {text: "water", correct: false}, {text: "air", correct: false}, {text: "economy", correct: false} ], explanation: "<h4>Gi·∫£i th√≠ch:</h4><ul><li><b>Ng·ªØ nghƒ©a:</b> N∆°i n√†o tr·ªü n√™n kh√¥ c·∫±n (dry)? ƒê√≥ ch√≠nh l√† <b>m·∫∑t ƒë·∫•t (ground)</b>. N∆∞·ªõc (water) hay kh√¥ng kh√≠ (air) kh√¥ng d√πng t√≠nh t·ª´ 'kh√¥ c·∫±n' trong ng·ªØ c·∫£nh n√†y.</li></ul>" },
            { id: 9, type: 'mcq', text: "9. And these are not all the outcomes of global (9) __________ .", options: [ {text: "damage", correct: false}, {text: "destroyment", correct: false}, {text: "raining", correct: false}, {text: "warming", correct: true} ], explanation: "<h4>Gi·∫£i th√≠ch:</h4><ul><li><b>Collocation:</b> C·ª•m t·ª´ c·ªë ƒë·ªãnh ch·ªâ hi·ªán t∆∞·ª£ng n√≥ng l√™n to√†n c·∫ßu l√† <b>global warming</b>.</li></ul>" },
            { id: 10, type: 'mcq', text: "10. We need to be more attentive and caring to it if we want to (10) __________ our planet.", options: [ {text: "build", correct: false}, {text: "save", correct: true}, {text: "live", correct: false}, {text: "destroy", correct: false} ], explanation: "<h4>Gi·∫£i th√≠ch:</h4><ul><li><b>Ng·ªØ nghƒ©a:</b> Ch√∫ √Ω v√† quan t√¢m ƒë·∫øn thi√™n nhi√™n ƒë·ªÉ <b>c·ª©u (save)</b> h√†nh tinh c·ªßa ch√∫ng ta. Destroy (ph√° h·ªßy) b·ªã sai nghƒ©a.</li></ul>" }
        ];

        const tfPassage1 = [
            { id: 11, type: 'tf', text: "1. The number of factories built in countries is decreasing.", ans: false, explanation: "<h4>Gi·∫£i th√≠ch:</h4><ul><li><b>Sai (False).</b> D·∫´n ch·ª©ng trong b√†i: <i>'<b>More and more</b> factories are being built...'</i> (Ng√†y c√†ng c√≥ <b>nhi·ªÅu</b> nh√† m√°y ƒë∆∞·ª£c x√¢y d·ª±ng...). B√†i n√≥i l√† tƒÉng l√™n (more and more) ch·ª© kh√¥ng ph·∫£i gi·∫£m ƒëi (decreasing).</li></ul>" },
            { id: 12, type: 'tf', text: "2. Carbon dioxide is created by burning oil, coal, gasoline, even natural gas.", ans: true, explanation: "<h4>Gi·∫£i th√≠ch:</h4><ul><li><b>ƒê√∫ng (True).</b> D·∫´n ch·ª©ng: <i>'By burning oil, coal, gasoline, even natural gas, they add more <b>carbon dioxide</b>...'</i> (ƒê√∫ng y nh∆∞ n·ªôi dung c√¢u h·ªèi).</li></ul>" },
            { id: 13, type: 'tf', text: "3. Cars don‚Äôt influence the atmosphere.", ans: false, explanation: "<h4>Gi·∫£i th√≠ch:</h4><ul><li><b>Sai (False).</b> D·∫´n ch·ª©ng: <i>'Cars <b>also influence</b> the atmosphere badly...'</i> (Xe h∆°i c≈©ng ·∫£nh h∆∞·ªüng x·∫•u ƒë·∫øn kh√≠ quy·ªÉn). C√¢u h·ªèi c√≥ ch·ªØ 'don't' l√† sai s·ª± th·∫≠t.</li></ul>" },
            { id: 14, type: 'tf', text: "4. The ozone layer of our Earth is being destroyed.", ans: true, explanation: "<h4>Gi·∫£i th√≠ch:</h4><ul><li><b>ƒê√∫ng (True).</b> D·∫´n ch·ª©ng n·∫±m ngay cu·ªëi ƒëo·∫°n 1: <i>'As a result, the ozone layer of our Earth is being destroyed.'</i></li></ul>" },
            { id: 15, type: 'tf', text: "5. Few rivers and lakes dry up.", ans: false, explanation: "<h4>Gi·∫£i th√≠ch:</h4><ul><li><b>Sai (False).</b> D·∫´n ch·ª©ng: <i>'...<b>a lot of</b> rivers and lakes dry up'</i> (R·∫•t nhi·ªÅu s√¥ng h·ªì b·ªã c·∫°n). C√¢u h·ªèi d√πng t·ª´ 'Few' (R·∫•t √≠t) l√† sai tr√°i ho√†n to√†n.</li></ul>" },
            { id: 16, type: 'tf', text: "6. We don‚Äôt need to care about nature if we want to save our planet.", ans: false, explanation: "<h4>Gi·∫£i th√≠ch:</h4><ul><li><b>Sai (False).</b> D·∫´n ch·ª©ng c√¢u cu·ªëi b√†i: <i>'We <b>need to be more attentive and caring</b> to it if we want to save our planet.'</i> (Ch√∫ng ta C·∫¶N ph·∫£i ch√∫ √Ω v√† quan t√¢m...).</li></ul>" }
        ];

        const tfPassage2 = [
            { id: 17, type: 'tf', text: "1. Trees help remove pollutants from water.", ans: false, explanation: "<h4>Gi·∫£i th√≠ch:</h4><ul><li><b>Sai (False).</b> D·∫´n ch·ª©ng: <i>'They remove pollutants <b>from the air</b>...'</i>. C√¢y lo·∫°i b·ªè √¥ nhi·ªÖm t·ª´ kh√¥ng kh√≠ (air), kh√¥ng ph·∫£i t·ª´ n∆∞·ªõc (water).</li></ul>" },
            { id: 18, type: 'tf', text: "2. Trees help remove carbon dioxide from the air.", ans: true, explanation: "<h4>Gi·∫£i th√≠ch:</h4><ul><li><b>ƒê√∫ng (True).</b> D·∫´n ch·ª©ng: <i>'...we could remove two-thirds of all the <b>carbon dioxide</b> created by human activities.'</i></li></ul>" },
            { id: 19, type: 'tf', text: "3. There is less flooding thanks to trees.", ans: true, explanation: "<h4>Gi·∫£i th√≠ch:</h4><ul><li><b>ƒê√∫ng (True).</b> D·∫´n ch·ª©ng: <i>'Second, trees reduce the run off of rainwater, so they can <b>reduce flooding</b>.'</i> (L√†m gi·∫£m ng·∫≠p l·ª•t = c√≥ √≠t ng·∫≠p l·ª•t h∆°n).</li></ul>" },
            { id: 20, type: 'tf', text: "4. You pay less for air conditioning if you plant trees.", ans: true, explanation: "<h4>Gi·∫£i th√≠ch:</h4><ul><li><b>ƒê√∫ng (True).</b> D·∫´n ch·ª©ng: <i>'Trees growing beside a home can cool the root and the air... Therefore, it <b>reduces air conditioning costs</b>.'</i> (L√†m gi·∫£m chi ph√≠ ƒëi·ªÅu h√≤a = tr·∫£ √≠t ti·ªÅn h∆°n).</li></ul>" },
            { id: 21, type: 'tf', text: "5. If everybody plants trees around their homes, it will improve the planet", ans: true, explanation: "<h4>Gi·∫£i th√≠ch:</h4><ul><li><b>ƒê√∫ng (True).</b> D·∫´n ch·ª©ng: <i>'Plant trees around your house. If enough people did that, it would <b>make a big difference</b>'</i> (S·∫Ω t·∫°o ra s·ª± kh√°c bi·ªát l·ªõn / c·∫£i thi·ªán h√†nh tinh).</li></ul>" }
        ];

        const fillBlanks = [
            { id: 22, type: 'fill', text: "1. Trees are seen as the ", blank: "lungs", after: " of the Earth.", explanation: "<h4>Gi·∫£i th√≠ch:</h4><ul><li><b>D·∫´n ch·ª©ng:</b> 'First, trees are the Earth‚Äôs <b>lungs</b>.' (ƒê·∫ßu ti√™n, c√¢y c·ªëi l√† l√° ph·ªïi c·ªßa Tr√°i ƒë·∫•t).</li></ul>" },
            { id: 23, type: 'fill', text: "2. Human activities create ", blank: "carbon dioxide", after: " .", explanation: "<h4>Gi·∫£i th√≠ch:</h4><ul><li><b>D·∫´n ch·ª©ng:</b> '...created by human activities' ƒë·ª©ng ngay sau t·ª´ <b>carbon dioxide</b> (kh√≠ cacbonic do ho·∫°t ƒë·ªông c·ªßa con ng∆∞·ªùi t·∫°o ra).</li></ul>" },
            { id: 24, type: 'fill', text: "3. Thanks to trees, many different species have good ", blank: "habitats", after: " .", explanation: "<h4>Gi·∫£i th√≠ch:</h4><ul><li><b>D·∫´n ch·ª©ng:</b> 'And don‚Äôt forget that trees create <b>habitats</b> for many species...' (C√¢y c·ªëi t·∫°o ra m√¥i tr∆∞·ªùng s·ªëng...).</li></ul>" },
            { id: 25, type: 'fill', text: "4. We can save the planet by ", blank: "planting", after: " trees.", explanation: "<h4>Gi·∫£i th√≠ch:</h4><ul><li><b>D·∫´n ch·ª©ng:</b> 'If you want to <b>plant trees</b> to help save the planet...' Sau gi·ªõi t·ª´ 'by' ƒë·ªông t·ª´ ph·∫£i th√™m V-ing -> <b>planting</b>.</li></ul>" }
        ];

        let state = {
            answered: {},
            score: 0,
            totalQuestions: clozeQuestions.length + tfPassage1.length + tfPassage2.length + fillBlanks.length
        };

        // --- H·ªÜ TH·ªêNG √ÇM THANH ---
        const AudioContext = window.AudioContext || window.webkitAudioContext;
        let audioCtx;

        function initAudio() {
            if (!audioCtx) audioCtx = new AudioContext();
            if (audioCtx.state === 'suspended') audioCtx.resume();
        }

        function playSound(type) {
            initAudio();
            const osc = audioCtx.createOscillator();
            const gain = audioCtx.createGain();
            osc.connect(gain);
            gain.connect(audioCtx.destination);
            const now = audioCtx.currentTime;

            if (type === 'correct' || type === 'reveal') {
                osc.type = 'sine';
                osc.frequency.setValueAtTime(type==='reveal' ? 800 : 600, now);
                osc.frequency.exponentialRampToValueAtTime(1200, now + 0.1);
                gain.gain.setValueAtTime(0.5, now);
                gain.gain.exponentialRampToValueAtTime(0.01, now + 0.5);
                osc.start(now);
                osc.stop(now + 0.5);
            } else if (type === 'wrong') {
                osc.type = 'sawtooth';
                osc.frequency.setValueAtTime(300, now);
                osc.frequency.setValueAtTime(200, now + 0.2);
                gain.gain.setValueAtTime(0.3, now);
                gain.gain.linearRampToValueAtTime(0.01, now + 0.4);
                osc.start(now);
                osc.stop(now + 0.4);
            }
        }

        // --- CONFEETI ---
        const canvas = document.getElementById('confetti-canvas');
        const ctx = canvas.getContext('2d');
        canvas.width = window.innerWidth;
        canvas.height = window.innerHeight;
        let particles = [];

        function fireConfetti() {
            particles = [];
            for(let i=0; i<120; i++){
                particles.push({
                    x: Math.random() * canvas.width,
                    y: Math.random() * canvas.height - canvas.height,
                    size: Math.random() * 10 + 5,
                    color: `hsl(${Math.random() * 360}, 100%, 50%)`,
                    speedY: Math.random() * 3 + 2,
                    speedX: Math.random() * 2 - 1,
                    rotation: Math.random() * 360,
                    rotationSpeed: Math.random() * 10 - 5
                });
            }
            animateConfetti();
        }

        function animateConfetti() {
            ctx.clearRect(0, 0, canvas.width, canvas.height);
            let active = false;
            particles.forEach(p => {
                p.y += p.speedY;
                p.x += p.speedX;
                p.rotation += p.rotationSpeed;
                if (p.y < canvas.height) active = true;

                ctx.save();
                ctx.translate(p.x, p.y);
                ctx.rotate(p.rotation * Math.PI / 180);
                ctx.fillStyle = p.color;
                ctx.fillRect(-p.size/2, -p.size/2, p.size, p.size);
                ctx.restore();
            });
            if(active) requestAnimationFrame(animateConfetti);
            else ctx.clearRect(0, 0, canvas.width, canvas.height);
        }

        window.addEventListener('resize', () => {
            canvas.width = window.innerWidth;
            canvas.height = window.innerHeight;
        });

        // --- RENDER B√ÄI T·∫¨P ---
        function shuffleArray(array) {
            let arr = [...array];
            for (let i = arr.length - 1; i > 0; i--) {
                const j = Math.floor(Math.random() * (i + 1));
                [arr[i], arr[j]] = [arr[j], arr[i]];
            }
            return arr;
        }

        function renderQuiz() {
            const container = document.getElementById('quiz-container');
            let html = '';

            // Section 1: Cloze
            html += `<div class="quiz-section-title">Ph·∫ßn 1: Multiple Choice (Global Warming)</div>`;
            clozeQuestions.forEach(q => {
                let shuffled = shuffleArray(q.options);
                let optsHtml = '';
                const labels = ['A', 'B', 'C', 'D'];
                shuffled.forEach((opt, i) => {
                    optsHtml += `<button class="option-btn" id="btn-${q.id}-${i}" onclick="selectAnswer(${q.id}, ${i}, ${opt.correct}, 'mcq')"><b>${labels[i]}.</b> ${opt.text}</button>`;
                });
                html += `
                    <div class="question-card" id="card-${q.id}">
                        <div class="question-text">${q.text}</div>
                        <div class="options-grid">${optsHtml}</div>
                        <div class="explanation-box" id="expl-${q.id}">${q.explanation}</div>
                    </div>`;
            });

            // Section 2: T/F Passage 1
            html += `<div class="quiz-section-title">Ph·∫ßn 2: True or False (Global Warming)</div>`;
            tfPassage1.forEach(q => {
                html += `
                    <div class="question-card" id="card-${q.id}">
                        <div class="question-text">${q.text}</div>
                        <div class="options-grid" style="grid-template-columns: 1fr 1fr;">
                            <button class="option-btn" id="btn-${q.id}-true" style="text-align: center; font-size: 22px; color: #27ae60;" onclick="selectAnswer(${q.id}, 'true', ${q.ans === true}, 'tf')"><b>‚úì TRUE</b></button>
                            <button class="option-btn" id="btn-${q.id}-false" style="text-align: center; font-size: 22px; color: #e74c3c;" onclick="selectAnswer(${q.id}, 'false', ${q.ans === false}, 'tf')"><b>‚úó FALSE</b></button>
                        </div>
                        <div class="explanation-box" id="expl-${q.id}">${q.explanation}</div>
                    </div>`;
            });

            // Section 3: T/F Passage 2
            html += `<div class="quiz-section-title">Ph·∫ßn 3: True or False (The Power of Trees)</div>`;
            tfPassage2.forEach(q => {
                html += `
                    <div class="question-card" id="card-${q.id}">
                        <div class="question-text">${q.text}</div>
                        <div class="options-grid" style="grid-template-columns: 1fr 1fr;">
                            <button class="option-btn" id="btn-${q.id}-true" style="text-align: center; font-size: 22px; color: #27ae60;" onclick="selectAnswer(${q.id}, 'true', ${q.ans === true}, 'tf')"><b>‚úì TRUE</b></button>
                            <button class="option-btn" id="btn-${q.id}-false" style="text-align: center; font-size: 22px; color: #e74c3c;" onclick="selectAnswer(${q.id}, 'false', ${q.ans === false}, 'tf')"><b>‚úó FALSE</b></button>
                        </div>
                        <div class="explanation-box" id="expl-${q.id}">${q.explanation}</div>
                    </div>`;
            });

            // Section 4: Fill in the Blanks (Click to Reveal)
            html += `<div class="quiz-section-title">Ph·∫ßn 4: Ch·∫°m v√†o d·∫•u ch·∫•m l·ª≠ng ƒë·ªÉ l·∫≠t m·ªü ƒë√°p √°n</div>`;
            fillBlanks.forEach(q => {
                html += `
                    <div class="question-card" id="card-${q.id}">
                        <div class="question-text">
                            ${q.text} 
                            <span class="reveal-btn" id="reveal-${q.id}" onclick="revealAnswer(${q.id}, '${q.blank}')">[ ........................ ]</span> 
                            ${q.after}
                        </div>
                        <div class="explanation-box" id="expl-${q.id}">${q.explanation}</div>
                    </div>`;
            });

            html += `<button class="btn-submit" onclick="submitQuiz()">üöÄ N·ªòP B√ÄI</button>`;
            container.innerHTML = html;
        }

        // --- X·ª¨ L√ù LOGIC ---
        function selectAnswer(qId, btnIndex, isCorrect, type) {
            if (state.answered[qId]) return;
            state.answered[qId] = true;

            const clickedBtn = document.getElementById(`btn-${qId}-${btnIndex}`);
            const card = document.getElementById(`card-${qId}`);
            const expl = document.getElementById(`expl-${qId}`);
            const allBtns = card.querySelectorAll('.option-btn');
            
            if (isCorrect) {
                clickedBtn.classList.add('correct');
                playSound('correct');
                fireConfetti();
                state.score++;
            } else {
                clickedBtn.classList.add('wrong');
                clickedBtn.classList.add('shake');
                playSound('wrong');
                
                // T√¥ m√†u n√∫t ƒë√∫ng (D√†nh cho c·∫£ MCQ v√† TF)
                allBtns.forEach(btn => {
                    if (btn.getAttribute('onclick').includes('true,') || btn.getAttribute('onclick').includes('true)')) {
                        btn.classList.add('correct');
                    }
                });
            }

            expl.style.display = 'block';
            allBtns.forEach(btn => {
                btn.style.cursor = 'not-allowed';
                btn.onclick = null;
            });
        }

        // Logic ch·∫°m ƒë·ªÉ l·∫≠t m·ªü ƒë√°p √°n (Fill in the blanks)
        function revealAnswer(qId, text) {
            if (state.answered[qId]) return;
            state.answered[qId] = true;
            
            const btn = document.getElementById(`reveal-${qId}`);
            const expl = document.getElementById(`expl-${qId}`);
            
            // L·∫≠t m·ªü
            btn.innerHTML = text;
            btn.classList.add('revealed');
            playSound('reveal');
            
            // Auto c·ªông ƒëi·ªÉm do h√¨nh th·ª©c n√†y l√† h·ªçc sinh t·ª± check
            state.score++;
            
            // Hi·ªán gi·∫£i th√≠ch
            expl.style.display = 'block';
            fireConfetti();
        }

        function toggleTranslate(id) {
            const box = document.getElementById(id);
            box.style.display = box.style.display === 'block' ? 'none' : 'block';
        }

        // --- H·∫∏N GI·ªú ---
        let timerInterval;
        let timeLeft = 600; 
        let isRunning = false;

        function updateTimer() {
            let m = Math.floor(timeLeft / 60);
            let s = timeLeft % 60;
            document.getElementById('timer').innerText = `${m < 10 ? '0'+m : m}:${s < 10 ? '0'+s : s}`;
        }

        function toggleTimer() {
            const btn = document.getElementById('btn-timer-toggle');
            if (isRunning) {
                clearInterval(timerInterval);
                btn.innerText = "‚ñ∂ TI·∫æP T·ª§C L√ÄM B√ÄI";
                btn.style.background = "#f39c12";
                isRunning = false;
            } else {
                btn.innerText = "‚è∏ T·∫†M D·ª™NG";
                btn.style.background = "#e74c3c";
                isRunning = true;
                timerInterval = setInterval(() => {
                    if (timeLeft > 0) {
                        timeLeft--;
                        updateTimer();
                    } else {
                        clearInterval(timerInterval);
                        isRunning = false;
                        alert("H·∫æT GI·ªú! B·∫°n h√£y n·ªôp b√†i ho·∫∑c ti·∫øp t·ª•c l√†m nh√©.");
                    }
                }, 1000);
            }
        }

        // --- N·ªòP B√ÄI ---
        function submitQuiz() {
            const modal = document.getElementById('result-modal');
            const scoreDisplay = document.getElementById('final-score');
            const msgDisplay = document.getElementById('feedback-msg');
            
            scoreDisplay.innerText = `${state.score}/${state.totalQuestions}`;

            let ratio = state.score / state.totalQuestions;
            let msg = "";

            if (ratio === 1) msg = "Qu√° xu·∫•t s·∫Øc! B·∫°n l√† ƒê·∫°i s·ª© M√¥i tr∆∞·ªùng! üåçüèÜ";
            else if (ratio >= 0.8) msg = "L√†m t·ªët l·∫Øm! V·ªØng ng·ªØ ph√°p, th·∫°o t·ª´ v·ª±ng! üåü";
            else if (ratio >= 0.5) msg = "Kh√° khen nha! Xem k·ªπ l·∫°i c√°c c√¢u sai ƒë·ªÉ r√∫t kinh nghi·ªám nh√©! üí™";
            else msg = "ƒê·ª´ng n·∫£n ch√≠! H√£y ƒë·ªçc ph·∫ßn gi·∫£i th√≠ch si√™u chi ti·∫øt c·ªßa c√¥ Mai An nh√©! ‚ù§Ô∏è";

            msgDisplay.innerText = msg;
            modal.style.display = 'flex';
            if(ratio >= 0.5) fireConfetti();
        }

        function closeModal() {
            document.getElementById('result-modal').style.display = 'none';
        }

        window.onload = () => {
            renderQuiz();
            updateTimer();
        };

    </script>
</body>
</html>